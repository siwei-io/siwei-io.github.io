[{"categories":["Nebula Graph","LLM"],"content":"Graph RAGï¼Œ LLM å¼€å‘çš„å›¾è°±é©±åŠ¨æ–°æŠ€æœ¯æ ˆä¸ä¸Šä¸‹æ–‡å­¦ä¹ æ–¹å¼","date":"2023-08-15","objectID":"/graph-rag/","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹","RAG","Graph RAG"],"title":"Graph RAG: çŸ¥è¯†å›¾è°±ç»“åˆ LLM çš„æ£€ç´¢å¢å¼º","uri":"/graph-rag/"},{"categories":["Nebula Graph","LLM"],"content":" æœ¬æ–‡ä¸ºå¤§å®¶æ­ç¤ºæˆ‘ä»¬ä¼˜å…ˆæå‡ºçš„ Graph RAG æ–¹æ³•ï¼Œè¿™ç§ç»“åˆçŸ¥è¯†å›¾è°±ã€å›¾æ•°æ®åº“ä½œä¸ºå¤§æ¨¡å‹ç»“åˆç§æœ‰çŸ¥è¯†ç³»ç»Ÿæœ€æ–°çš„æŠ€æœ¯æ ˆï¼Œä½œä¸ºä¹‹å‰çš„å›¾ä¸Šä¸‹æ–‡å­¦ä¹ ã€text2cypher æ–‡ç« çš„ç¬¬ä¸‰ç¯‡æ–‡ç« ã€‚ æœ¬æ–‡ä¸ºå¤§å®¶æ­ç¤ºæˆ‘ä»¬ä¼˜å…ˆæå‡ºçš„ Graph RAG æ–¹æ³•ï¼Œè¿™ç§ç»“åˆçŸ¥è¯†å›¾è°±ã€å›¾æ•°æ®åº“ä½œä¸ºå¤§æ¨¡å‹ç»“åˆç§æœ‰çŸ¥è¯†ç³»ç»Ÿæœ€æ–°çš„æŠ€æœ¯æ ˆï¼Œä½œä¸ºä¹‹å‰çš„å›¾ä¸Šä¸‹æ–‡å­¦ä¹ ã€text2cypher æ–‡ç« çš„ç¬¬ä¸‰ç¯‡æ–‡ç« ã€‚ ","date":"2023-08-15","objectID":"/graph-rag/:0:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹","RAG","Graph RAG"],"title":"Graph RAG: çŸ¥è¯†å›¾è°±ç»“åˆ LLM çš„æ£€ç´¢å¢å¼º","uri":"/graph-rag/#"},{"categories":["Nebula Graph","LLM"],"content":" 1 Graph RAGåœ¨ç¬¬ä¸€ç¯‡å…³äºä¸Šä¸‹æ–‡å­¦ä¹ çš„åšå®¢ä¸­æˆ‘ä»¬ä»‹ç»è¿‡ï¼Œ RAGï¼ˆRetrieval Argumented Generationï¼‰è¿™ç§åŸºäºç‰¹å®šä»»åŠ¡/é—®é¢˜çš„æ–‡æ¡£æ£€ç´¢èŒƒå¼ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å…ˆæ”¶é›†å¿…è¦çš„ä¸Šä¸‹æ–‡ï¼Œç„¶ååˆ©ç”¨å…·æœ‰è®¤çŸ¥èƒ½åŠ›çš„æœºå™¨å­¦ä¹ æ¨¡å‹è¿›è¡Œä¸Šä¸‹æ–‡å­¦ä¹ ï¼ˆin-context learningï¼‰ï¼Œæ¥åˆæˆä»»åŠ¡çš„ç­”æ¡ˆã€‚ å€ŸåŠ© LLM è¿™ä¸ªåªéœ€è¦â€œè¯´è¯â€å°±å¯ä»¥çµæ´»å¤„ç†å¤æ‚é—®é¢˜çš„æ„ŸçŸ¥å±‚ï¼Œåªéœ€è¦ä¸¤æ­¥ï¼Œå°±èƒ½æ­å»ºä¸€ä¸ªåŸºäºç§æœ‰çŸ¥è¯†çš„æ™ºèƒ½åº”ç”¨ï¼š åˆ©ç”¨å„ç§æœç´¢æ–¹å¼ï¼ˆæ¯”å¦‚ Embedding ä¸å‘é‡æ•°æ®åº“ï¼‰ä»ç»™å®šçš„æ–‡æ¡£ä¸­æ£€ç´¢ç›¸å…³çŸ¥è¯†ã€‚ åˆ©ç”¨ LLM ç†è§£å¹¶æ™ºèƒ½åœ°åˆæˆç­”æ¡ˆã€‚ è€Œè¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬ç»“åˆæœ€æ–°çš„æ¢ç´¢è¿›å±•å’Œæ€è€ƒï¼Œå°è¯•æŠŠ Graph RAG å’Œå…¶ä»–æ–¹æ³•è¿›è¡Œæ¯”è¾ƒï¼Œè¯´å¾—æ›´é€ä¸€ç‚¹ã€‚å¹¶ä¸”ï¼Œæˆ‘ä»¬å†³å®šå¼€å§‹ç”¨ Graph RAG è¿™ä¸ªå«æ³•æ¥æè¿°å®ƒã€‚ å®é™…ä¸Šï¼ŒGraph RAGï¼Œæ˜¯æœ€å…ˆåˆæˆ‘å’Œ Jerry Liu çš„ç›´æ’­ç ”è®¨ä¼šè®¨è®ºå’Œç›¸å…³çš„è®¨è®ºçš„ Twitter Threadä¸­æåˆ°çš„ï¼Œå·®ä¸å¤šçš„å†…å®¹æˆ‘åœ¨ NebulaGraph ç¤¾åŒºç›´æ’­ ä¸­ä¹Ÿç”¨ä¸­æ–‡ä»‹ç»è¿‡ã€‚ ","date":"2023-08-15","objectID":"/graph-rag/:1:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹","RAG","Graph RAG"],"title":"Graph RAG: çŸ¥è¯†å›¾è°±ç»“åˆ LLM çš„æ£€ç´¢å¢å¼º","uri":"/graph-rag/#graph-rag"},{"categories":["Nebula Graph","LLM"],"content":" 2 åœ¨ RAG ä¸­çŸ¥è¯†å›¾è°±çš„ä»·å€¼è¿™éƒ¨åˆ†å†…å®¹æˆ‘ä»¬åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­é˜è¿°è¿‡ï¼Œæ¯”å¦‚ä¸€ä¸ªæŸ¥è¯¢ï¼šâ€œå‘Šè¯‰æˆ‘æ‰€æœ‰å…³äºè‹¹æœå’Œä¹”å¸ƒæ–¯çš„äº‹â€ï¼ŒåŸºäºä¹”å¸ƒæ–¯è‡ªä¼ è¿™æœ¬ä¹¦è¿›è¡Œé—®ç­”ï¼Œè€Œè¿™ä¸ªé—®é¢˜æ¶‰åŠåˆ°çš„ä¸Šä¸‹æ–‡åˆ†å¸ƒåœ¨è‡ªä¼ è¿™æœ¬ä¹¦çš„ 30 é¡µï¼ˆåˆ†å—ï¼‰çš„æ—¶å€™ï¼Œä¼ ç»Ÿçš„â€œåˆ†å‰²æ•°æ®ï¼ŒEmbedding å†å‘é‡æœç´¢â€æ–¹æ³•åœ¨å¤šä¸ªæ–‡æ¡£å—é‡Œç”¨ top-k å»æœç´¢çš„æ–¹æ³•å¾ˆéš¾å¾—åˆ°è¿™ç§åˆ†æ•£ï¼Œç»†ç²’çš„å®Œæ•´ä¿¡æ¯ã€‚è€Œä¸”ï¼Œè¿™ç§æ–¹æ³•è¿˜å¾ˆå®¹æ˜“é—æ¼äº’ç›¸å…³è”çš„æ–‡æ¡£å—ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ£€ç´¢ä¸å®Œæ•´ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ä¹‹åä¸€æ¬¡æŠ€æœ¯ä¼šè®®ä¸­ï¼Œæˆ‘æœ‰å¹¸å’Œ leadscloud.com çš„å¾æ—­è®¨è®ºä¹‹åï¼ˆä»–ä»¬å› ä¸ºæœ‰çŸ¥è¯†å›¾è°±çš„æŠ€æœ¯èƒŒæ™¯ï¼Œä¹Ÿåšäº†å’Œæˆ‘ä»¬ç±»ä¼¼çš„æ¢ç´¢å’Œå°è¯•ï¼ï¼‰ï¼Œè®©æˆ‘æ„è¯†åˆ°çŸ¥è¯†å›¾è°±å¯ä»¥å‡å°‘åŸºäºåµŒå…¥çš„è¯­ä¹‰æœç´¢æ‰€å¯¼è‡´çš„ä¸å‡†ç¡®æ€§ã€‚å¾æ—­ç»™å‡ºçš„ä¸€ä¸ªæœ‰è¶£çš„ä¾‹å­æ˜¯â€œä¿æ¸©å¤§æ£šâ€ä¸â€œä¿æ¸©æ¯â€ï¼Œå°½ç®¡åœ¨è¯­ä¹‰ä¸Šä¸¤è€…æ˜¯å­˜åœ¨ç›¸å…³æ€§çš„ï¼Œä½†åœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œè¿™ç§é€šç”¨è¯­ä¹‰ï¼ˆEmbeddingï¼‰ä¸‹çš„ç›¸å…³æ€§å¸¸å¸¸æ˜¯æˆ‘ä»¬ä¸å¸Œæœ›äº§ç”Ÿçš„ï¼Œè¿›è€Œä½œä¸ºé”™è¯¯çš„ä¸Šä¸‹æ–‡è€Œå¼•å…¥â€œå¹»è§‰â€ã€‚ è¿™æ—¶å€™ï¼Œä¿æœ‰é¢†åŸŸçŸ¥è¯†çš„çŸ¥è¯†å›¾è°±åˆ™æ˜¯éå¸¸ç›´æ¥å¯ä»¥ç¼“è§£ã€æ¶ˆé™¤è¿™ç§å¹»è§‰çš„æ‰‹æ®µã€‚ ","date":"2023-08-15","objectID":"/graph-rag/:2:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹","RAG","Graph RAG"],"title":"Graph RAG: çŸ¥è¯†å›¾è°±ç»“åˆ LLM çš„æ£€ç´¢å¢å¼º","uri":"/graph-rag/#åœ¨-rag-ä¸­çŸ¥è¯†å›¾è°±çš„ä»·å€¼"},{"categories":["Nebula Graph","LLM"],"content":" 3 ç”¨ NebulaGraph å®ç° Graph RAGä¸€ä¸ªç®€å•çš„ Graph RAG å¯ä»¥å¦‚ä¸‹å»ç®€å•å®ç°ï¼š ä½¿ç”¨LLM(æˆ–å…¶ä»–)æ¨¡å‹ä»é—®é¢˜ä¸­æå–å…³é”®å®ä½“ã€‚ æ ¹æ®è¿™äº›å®ä½“æ£€ç´¢å­å›¾ï¼Œæ·±å…¥åˆ°ä¸€å®šçš„æ·±åº¦ï¼ˆä¾‹å¦‚ï¼Œ2ï¼‰ã€‚ åˆ©ç”¨è·å¾—çš„ä¸Šä¸‹æ–‡åˆ©ç”¨LLMäº§ç”Ÿç­”æ¡ˆã€‚ # ä¼ªä»£ç  def _get_key_entities(query_str, llm=None ,with_llm=True): ... return _expand_synonyms(entities) def _retrieve_subgraph_context(entities, depth=2, limit=30): ... return nebulagraph_store.get_relations(entities, depth, limit) def _synthesize_answer(query_str, graph_rag_context, llm): return llm.predict(PROMPT_SYNTHESIZE_AND_REFINE, query_str, graph_rag_context) def simple_graph_rag(query_str, nebulagraph_store, llm): entities = _get_key_entities(query_str, llm) graph_rag_context = _retrieve_subgraph_context(entities) return _synthesize_answer( query_str, graph_rag_context, llm) ç„¶è€Œï¼Œæœ‰äº†åƒ Llama Index è¿™æ ·æ–¹ä¾¿çš„ LLM ç¼–æ’å·¥å…·ï¼Œå¼€å‘è€…å¯ä»¥ä¸“æ³¨äº LLM çš„ç¼–æ’é€»è¾‘å’Œ pipeline è®¾è®¡ï¼Œè€Œä¸ç”¨äº²è‡ªå¤„ç†å¾ˆå¤šç»†èŠ‚çš„æŠ½è±¡ä¸å®ç°ã€‚ æ‰€ä»¥ï¼Œç”¨ Llama Indexï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾æ­å»º Graph RAGï¼Œç”šè‡³æ•´åˆæ›´å¤æ‚çš„ RAG é€»è¾‘ï¼Œæ¯”å¦‚ Graph+Vector RAGã€‚ åœ¨ Llama Index ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•å®ç° Graph RAGï¼š KnowledgeGraphIndex ç”¨æ¥ä»ä»»ä½•ç§æœ‰æ•°æ®åªæ˜¯ä»é›¶æ„å»ºçŸ¥è¯†å›¾è°±ï¼ˆåŸºäº LLM æˆ–è€…å…¶ä»–è¯­è¨€æ¨¡å‹ï¼‰ï¼Œç„¶å 4 è¡Œä»£ç è¿›è¡Œ Graph RAGã€‚ graph_store = NebulaGraphStore( space_name=space_name, edge_types=edge_types, rel_prop_names=rel_prop_names, tags=tags, ) storage_context = StorageContext.from_defaults(graph_store=graph_store) # Build KG kg_index = KnowledgeGraphIndex.from_documents( documents, storage_context=storage_context, max_triplets_per_chunk=10, space_name=space_name, edge_types=edge_types, rel_prop_names=rel_prop_names, tags=tags, ) kg_query_engine = kg_index.as_query_engine() KnowledgeGraphRAGQueryEngine åˆ™å¯ä»¥åœ¨ä»»ä½•å·²ç»å­˜åœ¨çš„çŸ¥è¯†å›¾è°±ä¸Šè¿›è¡Œ Graph RAGï¼Œä¸è¿‡æˆ‘è¿˜æ²¡æœ‰å®Œæˆè¿™ä¸ª PRã€‚ graph_store = NebulaGraphStore( space_name=space_name, edge_types=edge_types, rel_prop_names=rel_prop_names, tags=tags, ) storage_context = StorageContext.from_defaults(graph_store=graph_store) graph_rag_query_engine = KnowledgeGraphRAGQueryEngine( storage_context=storage_context, ) æœ€åï¼Œæˆ‘åšäº†ä¸€ä¸ª streamlit çš„ demoæ¥æ¯”è¾ƒ Graph RAG ä¸ Vector RAGï¼Œä»ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ° Graph RAG å¹¶æ²¡æœ‰å–ä»£ Embeddingã€å‘é‡æœç´¢çš„æ–¹æ³•ï¼Œè€Œæ˜¯å¢å¼ºäº†/è¡¥å……äº†å®ƒçš„ä¸è¶³ã€‚ ","date":"2023-08-15","objectID":"/graph-rag/:3:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹","RAG","Graph RAG"],"title":"Graph RAG: çŸ¥è¯†å›¾è°±ç»“åˆ LLM çš„æ£€ç´¢å¢å¼º","uri":"/graph-rag/#ç”¨-nebulagraph-å®ç°-graph-rag"},{"categories":["Nebula Graph","LLM"],"content":" 4 text2cypheråŸºäºå›¾è°±çš„ LLM çš„å¦ä¸€ç§æœ‰è¶£æ–¹æ³•æ˜¯text2cypherã€‚è¿™ç§æ–¹æ³•ä¸ä¾èµ–äºå®ä½“çš„å­å›¾æ£€ç´¢ï¼Œè€Œæ˜¯å°†ä»»åŠ¡/é—®é¢˜ç¿»è¯‘æˆä¸€ä¸ªé¢å‘ç­”æ¡ˆçš„ç‰¹å®šå›¾æŸ¥è¯¢ï¼Œå’Œæˆ‘ä»¬å¸¸è¯´çš„ text2sql æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‚ ","date":"2023-08-15","objectID":"/graph-rag/:4:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹","RAG","Graph RAG"],"title":"Graph RAG: çŸ¥è¯†å›¾è°±ç»“åˆ LLM çš„æ£€ç´¢å¢å¼º","uri":"/graph-rag/#text2cypher"},{"categories":["Nebula Graph","LLM"],"content":" 4.1 åœ¨ NebulaGraph ä¸Šè¿›è¡Œ text2cypheråœ¨ä¹‹å‰çš„æ–‡ç« ä¸­æˆ‘ä»¬å·²ç»ä»‹ç»è¿‡ï¼Œå¾—ç›Šäº LLMï¼Œå®ç° text2cypher æ¯”ä¼ ç»Ÿçš„ ML æ–¹æ³•æ›´ä¸ºç®€å•å’Œä¾¿å®œã€‚ æ¯”å¦‚ï¼ŒLangChain: NebulaGraphQAChain å’Œ Llama Index: KnowledgeGraphQueryEngine è®©æˆ‘ä»¬ 3 è¡Œä»£ç å°±èƒ½è·‘èµ·æ¥ text2cypherã€‚ ","date":"2023-08-15","objectID":"/graph-rag/:4:1","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹","RAG","Graph RAG"],"title":"Graph RAG: çŸ¥è¯†å›¾è°±ç»“åˆ LLM çš„æ£€ç´¢å¢å¼º","uri":"/graph-rag/#åœ¨-nebulagraph-ä¸Šè¿›è¡Œ-text2cypher"},{"categories":["Nebula Graph","LLM"],"content":" 4.2 æ¯”è¾ƒ text2cypher å’Œ (Sub)Graph RAGè¿™ä¸¤ç§æ–¹æ³•ä¸»è¦åœ¨å…¶æ£€ç´¢æœºåˆ¶ä¸Šæœ‰æ‰€ä¸åŒã€‚text2cypher æ ¹æ® KG çš„ Schema å’Œç»™å®šçš„ä»»åŠ¡ç”Ÿæˆå›¾å½¢æ¨¡å¼æŸ¥è¯¢ï¼Œè€ŒSubGraph RAGè·å–ç›¸å…³çš„å­å›¾ä»¥æä¾›ä¸Šä¸‹æ–‡ã€‚ ä¸¤è€…éƒ½æœ‰å…¶ä¼˜ç‚¹ï¼Œä¸ºäº†å¤§å®¶æ›´ç›´è§‚ç†è§£ä»–ä»¬çš„ç‰¹ç‚¹ï¼Œæˆ‘åšäº†è¿™ä¸ª demo è§†é¢‘ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤è€…çš„å›¾æŸ¥è¯¢æ¨¡å¼åœ¨å¯è§†åŒ–ä¸‹æ˜¯æœ‰éå¸¸æ¸…æ™°çš„å·®å¼‚çš„ã€‚ ","date":"2023-08-15","objectID":"/graph-rag/:4:2","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹","RAG","Graph RAG"],"title":"Graph RAG: çŸ¥è¯†å›¾è°±ç»“åˆ LLM çš„æ£€ç´¢å¢å¼º","uri":"/graph-rag/#æ¯”è¾ƒ-text2cypher-å’Œ-subgraph-rag"},{"categories":["Nebula Graph","LLM"],"content":" 4.3 ç»“åˆtext2cypherçš„Graph RAGç„¶è€Œï¼Œä¸¤è€…å¹¶æ²¡æœ‰ç»å¯¹çš„å¥½ä¸åï¼Œä¸åŒåœºæ™¯ä¸‹ï¼Œå®ƒä»¬å„æœ‰ä¼˜åŠ£ã€‚ åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œæˆ‘ä»¬å¯èƒ½å¹¶ä¸æ€»æ˜¯çŸ¥é“å“ªç§æ–¹æ³•æ›´æœ‰æ•ˆï¼ˆå¥½å¸®åŠ©åŒºåˆ†åº”è¯¥ç”¨å“ªä¸€ç§ï¼‰ï¼Œå› æ­¤ï¼Œæˆ‘å€¾å‘äºè€ƒè™‘åŒæ—¶åˆ©ç”¨ä¸¤è€…ï¼Œè¿™æ ·è·å–çš„ä¸¤ç§æ£€ç´¢ç»“æœä½œä¸ºä¸Šä¸‹æ–‡ï¼Œä¸€èµ·æ¥ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆçš„æ•ˆæœå¯èƒ½æ˜¯æœ€å¥½çš„ã€‚ å…·ä½“çš„å®ç°æ–¹æ³•åœ¨è¿™ä¸ª PRä¸­å·²ç»å¯ä»¥åšåˆ°äº†ï¼Œåªéœ€è¦è®¾ç½®with_text2cypher=Trueï¼ŒGraph RAG å°±ä¼šåŒ…å«text2cypher ä¸Šä¸‹æ–‡ï¼Œæ•¬è¯·æœŸå¾…å®ƒçš„åˆå¹¶ã€‚ ","date":"2023-08-15","objectID":"/graph-rag/:4:3","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹","RAG","Graph RAG"],"title":"Graph RAG: çŸ¥è¯†å›¾è°±ç»“åˆ LLM çš„æ£€ç´¢å¢å¼º","uri":"/graph-rag/#ç»“åˆtext2cypherçš„graph-rag"},{"categories":["Nebula Graph","LLM"],"content":" 5 ç»“è®ºé€šè¿‡å°†çŸ¥è¯†å›¾è°±ã€å›¾å­˜å‚¨é›†æˆåˆ° LLM æŠ€æœ¯æ ˆä¸­ï¼ŒGraph RAG æŠŠ RAG çš„ä¸Šä¸‹æ–‡å­¦ä¹ æ¨å‘äº†ä¸€ä¸ªæ–°çš„é«˜åº¦ã€‚å®ƒèƒ½åœ¨ LLM åº”ç”¨ä¸­ï¼Œé€šè¿‡åˆ©ç”¨ç°æœ‰ï¼ˆæˆ–æ–°å»ºï¼‰çš„çŸ¥è¯†å›¾è°±ï¼Œæå–ç»†ç²’åº¦ã€ç²¾ç¡®è°ƒæ•´ã€é¢†åŸŸç‰¹å®šä¸”äº’è”çš„çŸ¥è¯†ã€‚ è¯·ç»§ç»­å…³æ³¨å›¾è°±å’ŒLLMé¢†åŸŸçš„æ›´æ·±å…¥çš„æ¢ç´¢å’Œè¿›ä¸€æ­¥çš„å‘å±•ã€‚ é¢˜å›¾ promptï¼š A vast open book serves as the backdrop, with intricately interwoven nodes and lines forming a Graph on its pages. At the center of this graph, thereâ€™s a glowing brain symbolizing the Knowledge Graph. Rays of light emanate from the brain, reaching every corner of the graph, mirroring neural connections linking diverse information. On the right side of the illustration, a robotic arm with a pen is swiftly writing, representing the input and output of the AI large language model. ","date":"2023-08-15","objectID":"/graph-rag/:5:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹","RAG","Graph RAG"],"title":"Graph RAG: çŸ¥è¯†å›¾è°±ç»“åˆ LLM çš„æ£€ç´¢å¢å¼º","uri":"/graph-rag/#ç»“è®º"},{"categories":null,"content":" NebulaGraph æ˜Ÿçƒ å¼€æºé¢å¯¹é¢ ","date":"2023-07-19","objectID":"/podcast/:0:0","series":null,"tags":null,"title":"æ’­å®¢","uri":"/podcast/#"},{"categories":["Nebula Graph","LLM"],"content":"å¦‚ä½•åœ¨ NebulaGraph ä¸Šå¯¹çŸ¥è¯†å›¾è°±çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢ã€‚","date":"2023-07-17","objectID":"/llm-text-to-nebulagraph-query/","series":null,"tags":["Nebula Graph","LLM","LlamaIndex","Langchain","å¤§æ¨¡å‹","text2cypher","çŸ¥è¯†å›¾è°±"],"title":"Text2Cypherï¼šå¤§è¯­è¨€æ¨¡å‹é©±åŠ¨çš„å›¾è°±æŸ¥è¯¢ç”Ÿæˆ","uri":"/llm-text-to-nebulagraph-query/"},{"categories":["Nebula Graph","LLM"],"content":"ä» GPT-3 å¼€å§‹å±•ç°å‡ºè¶…å‡ºé¢„æœŸçš„â€ç†è§£èƒ½åŠ›â€œå¼€å§‹ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨åš Graph + LLM æŠ€æœ¯ç»„åˆã€äº’è¡¥çš„ç ”ç©¶ã€æ¢ç´¢å’Œé˜œåˆ†äº«ï¼Œæˆªæ­¢åˆ°ç°åœ¨ NebulaGraph å·²ç»åœ¨ LlamaIndex ä¸ Langchain é¡¹ç›®åšå‡ºäº†ä¸å°‘é¢†å…ˆçš„è´¡çŒ®ï¼Œä»æœ¬æ–‡å¼€å§‹ï¼Œæˆ‘ä»¬å°±æŠŠå…¶ä¸­ä¸€äº›é˜¶æ®µæ€§çš„æˆåŠŸã€æ–¹æ³•å•ç‹¬åˆ†äº«ç»™å¤§å®¶ã€‚ æœ¬æ–‡çš„ä¸»é¢˜æ˜¯æˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªé¢†åŸŸæœ€ä½å‚çš„æœå®ï¼Œtext2cypherï¼šè‡ªç„¶è¯­è¨€ç”Ÿæˆå›¾æŸ¥è¯¢ã€‚ ","date":"2023-07-17","objectID":"/llm-text-to-nebulagraph-query/:0:0","series":null,"tags":["Nebula Graph","LLM","LlamaIndex","Langchain","å¤§æ¨¡å‹","text2cypher","çŸ¥è¯†å›¾è°±"],"title":"Text2Cypherï¼šå¤§è¯­è¨€æ¨¡å‹é©±åŠ¨çš„å›¾è°±æŸ¥è¯¢ç”Ÿæˆ","uri":"/llm-text-to-nebulagraph-query/#"},{"categories":["Nebula Graph","LLM"],"content":" 1 Text2Cypheré¡¾åæ€ä¹‰ï¼Œ Text2Cypher åšçš„å°±æ˜¯æŠŠè‡ªç„¶è¯­è¨€çš„æ–‡æœ¬è½¬æ¢æˆ Cypher æŸ¥è¯¢è¯­å¥çš„è¿™ä»¶äº‹å„¿ï¼Œå’Œå¦ä¸€ä¸ªå¤§å®¶å¯èƒ½å·²ç»æ¯”è¾ƒç†Ÿæ‚‰çš„åœºæ™¯ Text2SQLï¼šæ–‡æœ¬è½¬æ¢ SQL åœ¨å½¢å¼ä¸Šæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚è€Œæœ¬è´¨ä¸Šï¼Œå¤§å¤šæ•°çŸ¥è¯†å›¾è°±ã€å›¾æ•°æ®åº“çš„åº”ç”¨éƒ½æ˜¯åœ¨å›¾ä¸ŠæŒ‰ç…§äººç±»æ„æ„¿è¿›è¡ŒæŸ¥è¯¢ï¼Œæˆ‘ä»¬åœ¨å›¾æ•°æ®åº“ä¸Šæ„é€ æ–¹ä¾¿çš„å¯è§†åŒ–å·¥å…·ã€å°è£…æ–¹ä¾¿çš„ API çš„å·¥ä½œéƒ½æ˜¯ä¸ºè¿™ä¸ªç›®æ ‡æœåŠ¡çš„ã€‚ ä¸€ç›´ä»¥æ¥ï¼Œé˜»ç¢å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±è¢«æ›´å¹¿æ³›åº”ç”¨çš„ä¸»è¦å› ç´ å¯èƒ½å°±æ˜¯æŸ¥è¯¢å›¾æ•°æ®åº“çš„é—¨æ§›äº†ã€‚é‚£ä¹ˆï¼Œåœ¨æ²¡æœ‰å¤§è¯­è¨€æ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿ ","date":"2023-07-17","objectID":"/llm-text-to-nebulagraph-query/:1:0","series":null,"tags":["Nebula Graph","LLM","LlamaIndex","Langchain","å¤§æ¨¡å‹","text2cypher","çŸ¥è¯†å›¾è°±"],"title":"Text2Cypherï¼šå¤§è¯­è¨€æ¨¡å‹é©±åŠ¨çš„å›¾è°±æŸ¥è¯¢ç”Ÿæˆ","uri":"/llm-text-to-nebulagraph-query/#text2cypher"},{"categories":["Nebula Graph","LLM"],"content":" 2 ä¼ ç»Ÿçš„ Text2Cypheræ–‡æœ¬åˆ°æŸ¥è¯¢çš„è¿™ä¸ªé¢†åŸŸåœ¨å¤§è¯­è¨€æ¨¡å‹ä¹‹å‰å°±ä¸€ç›´å­˜åœ¨è¿™æ ·çš„éœ€æ±‚ï¼Œä¸€ç›´æ˜¯çŸ¥è¯†å›¾è°±æœ€å¸¸è§çš„åº”ç”¨ä¹‹ä¸€ï¼Œæ¯”å¦‚ KBQAï¼ˆåŸºäºçŸ¥è¯†åº“çš„é—®ç­”ç³»ç»Ÿï¼‰çš„ç³»ç»Ÿå†…éƒ¨æœ¬è´¨ä¸Šå°±æ˜¯ text2cypherã€‚ è¿™é‡Œä»¥æˆ‘ä¹‹å‰å†™çš„é¡¹ç›® Siwi ï¼ˆå‘éŸ³ï¼š/ËˆsÉªwi/ï¼Œ ä¸€ä¸ªåŸºäºç¯®çƒè¿åŠ¨å‘˜æ•°æ®é›†çš„é—®ç­”åº”ç”¨ï¼‰ä¸ºä¾‹ï¼Œäº†è§£ä¸€ä¸‹å®ƒçš„åç«¯æ¶æ„ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Speech â”‚ Frontend â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Siwi, /ËˆsÉªwi/ â”‚ â”‚ â”‚ Web_Speech_API â”‚ A PoC of Dialog System â”‚ â”‚ â”‚ Vue.JS â”‚ With Graph Database â”‚ â”‚ â”‚ â”‚ Backed Knowledge Graph â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Sentence Backend â”‚ â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚â”‚ â”‚ Web API, Flask â”‚ ./app/ â”‚ â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚â”‚ â”‚ Sentence ./bot/ â”‚ â”‚ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚â”‚ â”‚ Intent Matching, â”‚ ./bot/classifierâ”‚ â”‚ â”‚â”‚ â”‚ Symentic Processing â”‚ â”‚ â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚â”‚ â”‚ Intent, Enties â”‚ â”‚ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚â”‚ â”‚ Intent Actor â”‚ ./bot/actions â”‚ â”‚ â”‚â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Graph Query â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Graph Database â”‚ NebulaGraph â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å½“ä¸€ä¸ªé—®é¢˜è¯­å¥å‘é€è¿‡æ¥ä¹‹åï¼Œå®ƒé¦–å…ˆè¦åšæ„å›¾è¯†åˆ«ï¼ˆIntentï¼‰ã€å®ä½“è¯†åˆ«ï¼ˆEntityï¼‰ï¼Œç„¶åå†åˆ©ç”¨ NLP æ¨¡å‹æˆ–è€…ä»£ç æŠŠç›¸åº”çš„æ„å›¾å’Œå®ä½“æ„é€ æˆçŸ¥è¯†å›¾è°±çš„æŸ¥è¯¢è¯­å¥ï¼Œæœ€ç»ˆæŸ¥è¯¢å›¾æ•°æ®åº“ï¼Œå¹¶æ ¹æ®è¿”å›ç»“æ„æ„é€ ç­”æ¡ˆã€‚ å¯ä»¥æƒ³è±¡ï¼Œè®©ç¨‹åºèƒ½å¤Ÿï¼š ä»è‡ªç„¶è¯­è¨€ä¸­ç†è§£æ„å›¾ï¼šå¯¹åº”åˆ°å“ªä¸€ç±»æ”¯æŒå›ç­”çš„é—®é¢˜ æ‰¾å‡ºå®ä½“ï¼šé—®é¢˜ä¸­æ¶‰åŠåˆ°çš„ä¸»è¦ä¸ªä½“ ä»æ„å›¾å’Œå®ä½“æ„é€ æŸ¥è¯¢è¯­å¥ ä¸å¯èƒ½æ˜¯ä¸€ä¸ªå®¹æ˜“çš„å¼€å‘å·¥ä½œï¼Œä¸€ä¸ªçœŸæ­£èƒ½å¤Ÿè½åœ°çš„å®ç°è¦è®­ç»ƒçš„æ¨¡å‹æˆ–è€…å®ç°çš„è§„åˆ™ä»£ç æ‰€è€ƒè™‘çš„è¾¹ç•Œæ¡ä»¶å¯èƒ½éå¸¸å¤šã€‚ ","date":"2023-07-17","objectID":"/llm-text-to-nebulagraph-query/:2:0","series":null,"tags":["Nebula Graph","LLM","LlamaIndex","Langchain","å¤§æ¨¡å‹","text2cypher","çŸ¥è¯†å›¾è°±"],"title":"Text2Cypherï¼šå¤§è¯­è¨€æ¨¡å‹é©±åŠ¨çš„å›¾è°±æŸ¥è¯¢ç”Ÿæˆ","uri":"/llm-text-to-nebulagraph-query/#ä¼ ç»Ÿçš„-text2cypher"},{"categories":["Nebula Graph","LLM"],"content":" 3 ç”¨è¯­è¨€æ¨¡å‹åš Text2Cypherè€Œåœ¨â€åå¤§è¯­è¨€æ¨¡å‹â€œæ—¶ä»£ï¼Œè¿™ç§ä»å‰éœ€è¦ä¸“é—¨è®­ç»ƒæˆ–è€…å†™è§„åˆ™çš„â€æ™ºèƒ½â€œåº”ç”¨åœºæ™¯æˆäº†é€šç”¨æ¨¡å‹+æç¤ºå·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰å°±èƒ½å®Œæˆçš„ä»»åŠ¡ã€‚ æ³¨ï¼šæç¤ºå·¥ç¨‹æŒ‡é€šè¿‡è‡ªç„¶è¯­è¨€æè¿°ï¼Œè®©ç”Ÿæˆæ¨¡å‹ã€è¯­è¨€æ¨¡å‹å®Œæˆâ€æ™ºèƒ½â€œä»»åŠ¡çš„æ–¹æ³•ã€‚ äº‹å®ä¸Šï¼Œåœ¨ GPT-3 åˆšå‘å¸ƒä¹‹åï¼Œæˆ‘å°±å¼€å§‹åˆ©ç”¨å®ƒå¸®åŠ©æˆ‘å†™å¾ˆå¤šéå¸¸å¤æ‚çš„ Cypher æŸ¥è¯¢è¯­å¥äº†ï¼Œæˆ‘å‘ç°å®ƒå¯ä»¥å†™å¾ˆå¤šéå¸¸å¤æ‚çš„æ¨¡å¼åŒ¹é…ã€å¤šæ­¥æ¡ä»¶é‚£ç§ä¹‹å‰æˆ‘éœ€è¦ä¸€ç‚¹ç‚¹è°ƒè¯•åŠå¤©æ‰èƒ½å†™å‡ºæ¥çš„è¯­å¥ï¼Œé€šå¸¸åœ¨å®ƒçš„ç­”æ¡ˆä¹‹ä¸Šï¼Œæˆ‘åªéœ€è¦ç¨å¾®ä¿®æ”¹å°±å¯ä»¥äº†ï¼Œè€Œä¸”å¾€å¾€æˆ‘è¿˜èƒ½ä»å®ƒçš„ç­”æ¡ˆé‡ŒçŸ¥é“æˆ‘ä¹‹å‰æ²¡äº†è§£åˆ°çš„ Cypher è¯­æ³•ç›²åŒºã€‚ åæ¥ï¼Œåœ¨ä»Šå¹´äºŒæœˆä»½çš„æ—¶å€™ï¼Œæˆ‘å°±è¯•ç€å®ç°äº†ä¸€ä¸ªåŸºäº GPT-3 ï¼ˆå› ä¸ºé‚£æ—¶å€™è¿˜æ²¡æœ‰ GPT-3.5ï¼‰çš„é¡¹ç›®ï¼šngql-GPTï¼ˆä»£ç ä»“åº“ï¼‰ã€‚ å®ƒçš„å·¥ä½œåŸç†éå¸¸ç®€å•ï¼Œå’Œ Text2SQL æ²¡æœ‰åŒºåˆ«ï¼Œè¯­è¨€æ¨¡å‹å·²ç»é€šè¿‡å…¬å…±é¢†åŸŸå­¦ä¹ äº† Cypher çš„è¯­æ³•è¡¨è¾¾ï¼Œæˆ‘ä»¬åœ¨æå‡ºä»»åŠ¡çš„æ—¶å€™ï¼Œåªéœ€è¦è®©å¤§æ¨¡å‹çŸ¥é“æˆ‘ä»¬è¦æŸ¥è¯¢çš„å›¾çš„ Schema ä½œä¸ºä¸Šä¸‹æ–‡å°±å¯ä»¥äº†ã€‚ æ‰€ä»¥ï¼ŒåŸºæœ¬ä¸Š Prompt å°±æ˜¯ï¼š ä½ æ˜¯ä¸€ä½ NebulaGraph Cypher ä¸“å®¶ï¼Œè¯·æ ¹æ®ç»™å®šçš„å›¾ Schema å’Œé—®é¢˜ï¼Œå†™å‡ºæŸ¥è¯¢è¯­å¥ã€‚ schema å¦‚ä¸‹ï¼š --- {schema} --- é—®é¢˜å¦‚ä¸‹ï¼š --- {question} --- ä¸‹é¢å†™å‡ºæŸ¥è¯¢è¯­å¥ï¼š ç„¶è€Œï¼ŒçœŸå®ä¸–ç•Œçš„ prompt å¾€å¾€è¿˜éœ€è¦å¢åŠ é¢å¤–çš„è¦æ±‚ï¼š åªè¿”å›è¯­å¥ï¼Œä¸ç”¨ç»™å‡ºè§£é‡Šï¼Œä¸ç”¨é“æ­‰ å¼ºè°ƒä¸è¦å†™è¶…å‡º schema ä¹‹å¤–çš„ç‚¹ã€è¾¹ç±»å‹ æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒæˆ‘åœ¨ LlamaIndex çš„ KnowlegeGraph Query Engine ä¸­çš„å®ç°ã€‚ åœ¨çœŸå®åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬æƒ³å¿«é€Ÿå­¦ä¹ ã€æ„å»ºå¤§è¯­è¨€æ¨¡å‹åº”ç”¨çš„æ—¶å€™ï¼Œå¸¸å¸¸ä¼šç”¨åˆ° Langchain æˆ–è€… LlamaIndex è¿™æ ·çš„ç¼–æ’ï¼ˆOrchestratorï¼‰å·¥å…·ï¼Œå®ƒä»¬å¯ä»¥å¸®æˆ‘ä»¬åšå¾ˆå¤šåˆç†çš„æŠ½è±¡ï¼Œä»è€Œé¿å…ä»å¤´å»å®ç°å¾ˆå¤šé€šç”¨çš„è„šæ‰‹æ¶ä»£ç ï¼š å’Œä¸åŒè¯­è¨€æ¨¡å‹äº¤äº’ å’Œä¸åŒå‘é‡æ•°æ®åº“äº¤äº’ æ•°æ®åˆ†å‰² è€Œä¸”ï¼Œè¿™äº›ç¼–æ’å·¥å…·è¿˜å†…ç½®äº†å¾ˆå¤šå·¥ç¨‹æ–¹æ³•çš„æœ€ä½³å®è·µï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å¸¸å¸¸è°ƒç”¨ä¸€ä¸ªæ–¹æ³•å°±å¯ä»¥ç”¨åˆ°æœ€æ–°æœ€å¥½ç”¨çš„å¤§è¯­è¨€æ¨¡å‹ç ”ç©¶è®ºæ–‡çš„æ–¹æ³•äº†ï¼Œæ¯”å¦‚ FLAREã€Guidenceã€‚ ä¸ºæ­¤ï¼Œæˆ‘åœ¨ LlamaIndex å’Œ Langchain ä¸­éƒ½è´¡çŒ®äº†å¯ä»¥æ–¹ä¾¿è¿›è¡Œ NebulaGraph ä¸Š Text2Cypher çš„å·¥å…·ï¼ŒçœŸæ­£åšåˆ° 3 è¡Œä»£ç ï¼ŒText2Cypherã€‚ ","date":"2023-07-17","objectID":"/llm-text-to-nebulagraph-query/:3:0","series":null,"tags":["Nebula Graph","LLM","LlamaIndex","Langchain","å¤§æ¨¡å‹","text2cypher","çŸ¥è¯†å›¾è°±"],"title":"Text2Cypherï¼šå¤§è¯­è¨€æ¨¡å‹é©±åŠ¨çš„å›¾è°±æŸ¥è¯¢ç”Ÿæˆ","uri":"/llm-text-to-nebulagraph-query/#ç”¨è¯­è¨€æ¨¡å‹åš-text2cypher"},{"categories":["Nebula Graph","LLM"],"content":" 4 NebulaGraph ä¸Šçš„ Text2Cypheråœ¨ LlamaIndex çš„ KnowledgeQueryEngine å’Œ LangChain çš„ NebulaGraphQAChain ä¸­ï¼šNebulaGraph å›¾æ•°æ®åº“çš„ Schema è·å–ã€Cypher è¯­å¥ç”Ÿæˆçš„ Promptã€å„ç§ LLM çš„è°ƒç”¨ã€ç»“æœçš„å¤„ç†ã€è¡”æ¥æˆ‘ä»¬å¯ä»¥å…¨éƒ½ä¸ç”¨å…³å¿ƒï¼Œå¼€ç®±å³ç”¨ï¼ ","date":"2023-07-17","objectID":"/llm-text-to-nebulagraph-query/:4:0","series":null,"tags":["Nebula Graph","LLM","LlamaIndex","Langchain","å¤§æ¨¡å‹","text2cypher","çŸ¥è¯†å›¾è°±"],"title":"Text2Cypherï¼šå¤§è¯­è¨€æ¨¡å‹é©±åŠ¨çš„å›¾è°±æŸ¥è¯¢ç”Ÿæˆ","uri":"/llm-text-to-nebulagraph-query/#nebulagraph-ä¸Šçš„-text2cypher"},{"categories":["Nebula Graph","LLM"],"content":" 4.1 ä½¿ç”¨ LlamaIndexç”¨ LlamaIndexï¼Œæˆ‘ä»¬åªéœ€è¦ï¼š åˆ›å»ºä¸€ä¸ª NebulaGraphStore å®ä¾‹ åˆ›å»ºä¸€ä¸ª KnowledgeQueryEngine å°±å¯ä»¥ç›´æ¥è¿›è¡Œé—®ç­”äº†ï¼Œæ˜¯ä¸æ˜¯è¶…çº§ç®€å•ï¼Ÿ å‚è€ƒæ–‡æ¡£ï¼šhttps://gpt-index.readthedocs.io/en/latest/examples/query_engine/knowledge_graph_query_engine.html from llama_index.query_engine import KnowledgeGraphQueryEngine from llama_index.storage.storage_context import StorageContext from llama_index.graph_stores import NebulaGraphStore graph_store = NebulaGraphStore( space_name=space_name, edge_types=edge_types, rel_prop_names=rel_prop_names, tags=tags) storage_context = StorageContext.from_defaults(graph_store=graph_store) nl2kg_query_engine = KnowledgeGraphQueryEngine( storage_context=storage_context, service_context=service_context, llm=llm, verbose=True, ) # é—®ç­” response = nl2kg_query_engine.query( \"Tell me about Peter Quill?\", ) # åªç”Ÿæˆè¯­å¥ graph_query = nl2kg_query_engine.generate_query( \"Tell me about Peter Quill?\", ) ","date":"2023-07-17","objectID":"/llm-text-to-nebulagraph-query/:4:1","series":null,"tags":["Nebula Graph","LLM","LlamaIndex","Langchain","å¤§æ¨¡å‹","text2cypher","çŸ¥è¯†å›¾è°±"],"title":"Text2Cypherï¼šå¤§è¯­è¨€æ¨¡å‹é©±åŠ¨çš„å›¾è°±æŸ¥è¯¢ç”Ÿæˆ","uri":"/llm-text-to-nebulagraph-query/#ä½¿ç”¨-llamaindex"},{"categories":["Nebula Graph","LLM"],"content":" 4.2 ä½¿ç”¨ Langchainç±»ä¼¼çš„ï¼Œåœ¨ Langchain é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦ï¼š åˆ›å»ºä¸€ä¸ª NebulaGraphå®ä¾‹ åˆ›å»ºä¸€ä¸ª NebulaGraphQAChain å®ä¾‹ å°±å¯ä»¥ç›´æ¥æé—®äº†ã€‚ å‚è€ƒæ–‡æ¡£ï¼šhttps://python.langchain.com/docs/modules/chains/additional/graph_nebula_qa from langchain.chat_models import ChatOpenAI from langchain.chains import NebulaGraphQAChain from langchain.graphs import NebulaGraph graph = NebulaGraph( space=space_name, username=\"root\", password=\"nebula\", address=\"127.0.0.1\", port=9669, session_pool_size=30, ) chain = NebulaGraphQAChain.from_llm( llm, graph=graph, verbose=True ) chain.run( \"Tell me about Peter Quill?\", ) ","date":"2023-07-17","objectID":"/llm-text-to-nebulagraph-query/:4:2","series":null,"tags":["Nebula Graph","LLM","LlamaIndex","Langchain","å¤§æ¨¡å‹","text2cypher","çŸ¥è¯†å›¾è°±"],"title":"Text2Cypherï¼šå¤§è¯­è¨€æ¨¡å‹é©±åŠ¨çš„å›¾è°±æŸ¥è¯¢ç”Ÿæˆ","uri":"/llm-text-to-nebulagraph-query/#ä½¿ç”¨-langchain"},{"categories":["Nebula Graph","LLM"],"content":" 5 Demodemo åœ°å€ è¿™ä¸ª Demo å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ LLM ä»ä¸åŒç±»å‹çš„ä¿¡æ¯æºï¼ˆä»¥ç»´åŸºç™¾ç§‘ä¸ºä¾‹ï¼‰ä¸­æŠ½å–çŸ¥è¯†ä¸‰å…ƒç»„ï¼Œå¹¶å­˜å‚¨åˆ°å›¾æ•°æ®åº“ NebulaGraph ä¸­ã€‚ æœ¬ Demo ä¸­ï¼Œæˆ‘ä»¬å…ˆæŠ½å–äº†ç»´åŸºç™¾ç§‘ä¸­å…³äºã€Šé“¶æ²³æŠ¤å«é˜Ÿ3ã€‹çš„ä¿¡æ¯ï¼Œç„¶ååˆ©ç”¨ LLM ç”Ÿæˆçš„çŸ¥è¯†ä¸‰å…ƒç»„ï¼Œæ„å»ºäº†ä¸€ä¸ªå›¾è°±ã€‚ ç„¶ååˆ©ç”¨ Cypher æŸ¥è¯¢å›¾è°±ï¼Œæœ€ååˆ©ç”¨ LlamaIndex å’Œ Langchain ä¸­çš„ Text2Cypherï¼Œå®ç°äº†è‡ªç„¶è¯­è¨€æŸ¥è¯¢å›¾è°±çš„åŠŸèƒ½ã€‚ æ‚¨å¯ä»¥ç‚¹å‡»å…¶ä»–æ ‡ç­¾äº²è‡ªè¯•ç©å›¾è°±çš„å¯è§†åŒ–ã€Cypher æŸ¥è¯¢ã€è‡ªç„¶è¯­è¨€æŸ¥è¯¢ï¼ˆText2Cypherï¼‰ç­‰åŠŸèƒ½ã€‚ è¿™é‡Œå¯ä»¥ä¸‹è½½ å®Œæ•´çš„ Notebookã€‚ ","date":"2023-07-17","objectID":"/llm-text-to-nebulagraph-query/:5:0","series":null,"tags":["Nebula Graph","LLM","LlamaIndex","Langchain","å¤§æ¨¡å‹","text2cypher","çŸ¥è¯†å›¾è°±"],"title":"Text2Cypherï¼šå¤§è¯­è¨€æ¨¡å‹é©±åŠ¨çš„å›¾è°±æŸ¥è¯¢ç”Ÿæˆ","uri":"/llm-text-to-nebulagraph-query/#demo"},{"categories":["Nebula Graph","LLM"],"content":" 6 ç»“è®ºæœ‰äº† LLMï¼ŒçŸ¥è¯†å›¾è°±ã€NebulaGraph å›¾æ•°æ®åº“ä¸­çš„çš„æ•°æ®ä¸­è¿›è¡Œ Text2Cypher ä»æ¥æ²¡æœ‰è¿™ä¹ˆç®€å•è¿‡ã€‚ ä¸€ä¸ªå…·æœ‰æ›´å¼ºäººæœºã€æœºå™¨æ¥å…¥çš„çŸ¥è¯†å›¾è°±å¯ä»¥ä»£è¡¨äº†å…¨æ–°çš„æ—¶ä»£ï¼Œæˆ‘ä»¬å¯èƒ½ä¸éœ€è¦ä»å‰é‚£æ ·é«˜é¢æˆæœ¬å»å®ç°å›¾åº“ä¹‹ä¸Šçš„åç«¯æœåŠ¡ï¼Œä¹Ÿä¸å†éœ€è¦åŸ¹è®­æ‰èƒ½è®©é¢†åŸŸä¸“å®¶ä»å›¾ä¸­è·å–é‡è¦çš„æ´å¯Ÿäº†ã€‚ åˆ©ç”¨ LlamaIndex æˆ–è€… Langchain ä¸­çš„ç”Ÿæ€é›†æˆï¼Œæˆ‘ä»¬å¯ä»¥å‡ ä¹æ²¡æœ‰å¼€å‘æˆæœ¬åœ°å‡ è¡Œä»£ç æŠŠè‡ªå·±çš„åº”ç”¨ã€å›¾æ•°æ®æ™ºèƒ½åŒ–ã€‚ ç„¶è€Œï¼ŒText2Cypher åªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œè¯·å¤§å®¶å…³æ³¨æˆ‘ä»¬åç»­çš„æ–‡ç« ï¼Œå±•ç°æ›´å¤šçŸ¥è¯†å›¾è°±ã€å›¾æ•°æ®åº“ä¸ºå¤§è¯­è¨€æ¨¡å‹ç”Ÿæ€å¸¦æ¥çš„å˜é©ã€‚ é¢˜å›¾ promptï¼š In an artful fusion of language and AI, this minimalist oil painting captures the essence of technological advancement. Delicate brushstrokes depict a harmony of binary code and flowing words, converging into a central point. With a refined color palette and clean composition, the artwork represents the symbiotic relationship between language and artificial intelligence, inviting contemplation and appreciation. ","date":"2023-07-17","objectID":"/llm-text-to-nebulagraph-query/:6:0","series":null,"tags":["Nebula Graph","LLM","LlamaIndex","Langchain","å¤§æ¨¡å‹","text2cypher","çŸ¥è¯†å›¾è°±"],"title":"Text2Cypherï¼šå¤§è¯­è¨€æ¨¡å‹é©±åŠ¨çš„å›¾è°±æŸ¥è¯¢ç”Ÿæˆ","uri":"/llm-text-to-nebulagraph-query/#ç»“è®º"},{"categories":["Nebula Graph"],"content":"åœ¨ Jupyter Notebook ä¸­ç©è½¬ NebulaGraph","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/"},{"categories":["Nebula Graph"],"content":" ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Jupyter Notebook ä¸­æ›´æ–¹ä¾¿åœ°ç© NebulaGraph å›¾æ•°æ®åº“äº†ï¼Œåªéœ€è¦%ngql MATCH p=(n:player)-\u003e() RETURN p å°±å¯ä»¥ç›´æ¥æŸ¥è¯¢ ï¼Œ%ng_draw å°±å¯ä»¥ç”»å‡ºè¿”å›ç»“æœã€‚ English version æœ€è¿‘ï¼Œæˆ‘æŠŠä¸¤å¹´å‰ä¸€ç›´æ²¡å®Œæˆçš„ NebulaGraph çš„ Jupyter Notebook æ‰©å±•ï¼š ipython-ngql é‡æ„ï¼Œæ­£å¼å‘å¸ƒäº†ï¼Œç°åœ¨å®ƒé™¤äº†å®Œå…¨é€‚é… NebulaGrpah 3.x æ‰€æœ‰æŸ¥è¯¢ä¹‹å¤–ï¼Œè¿˜æ”¯æŒäº† Notebook å†…çš„è¿”å›ç»“æœå¯è§†åŒ–ï¼Œæœ¬æ–‡ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ ipython-ngql ï¼ ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:0:0","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#"},{"categories":["Nebula Graph"],"content":" 1 å®‰è£…å®‰è£…éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ Jupyter Notebook é‡Œè¾¹æ‰§è¡Œ %pip install ipython-ngql ç„¶åå†åŠ è½½å®ƒå°±å¥½ï¼š %pip install ipython-ngql %load_ext ngql ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ %ngql è¿™ä¸ª Jupyter Magic word è¿æ¥ NebulaGraph äº†ï¼š %ngql --address 127.0.0.1 --port 9669 --user root --password nebula å½“è¿æ¥æˆåŠŸä¹‹åï¼ŒSHOW SPACES çš„ç»“æœä¼šè¿”å›åœ¨è¿™ä¸ª notebook cell ä¸‹ã€‚ ğŸ’¡ æ³¨ï¼šä½ å¯ä»¥ä» Docker æ¡Œé¢ç‰ˆçš„æ‰©å±•å¸‚åœºé‡Œæœç´¢ NebulaGraph ä¸€é”®å®‰è£…æœ¬åœ°å¼€å‘ç¯å¢ƒï¼Œè¿›å…¥ NebulaGraph Docker æ‰©å±•å†…éƒ¨ï¼Œç‚¹å‡» NebulaGraph AI ï¼Œç‚¹å‡» Install NX Mode å®‰è£…æœ¬åœ°çš„ NebulaGraph + Jupyter Notebook å¼€å‘ç¯å¢ƒã€‚ ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:1:0","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#å®‰è£…"},{"categories":["Nebula Graph"],"content":" 2 æŸ¥è¯¢ç°åœ¨æ”¯æŒä¸¤ç§è¯­æ³• %ngql æ¥å•è¡ŒæŸ¥è¯¢å’Œ %%ngql æ¥å¤šè¡ŒæŸ¥è¯¢ã€‚ ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:2:0","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#æŸ¥è¯¢"},{"categories":["Nebula Graph"],"content":" 2.1 å•è¡ŒæŸ¥è¯¢ä¾‹å¦‚ï¼š %ngql USE basketballplayer; %ngql MATCH (v:player{name:\"Tim Duncan\"})--\u003e(v2:player) RETURN v2.player.name AS Name; ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:2:1","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#å•è¡ŒæŸ¥è¯¢"},{"categories":["Nebula Graph"],"content":" 2.2 å¤šè¡ŒæŸ¥è¯¢ä¾‹å¦‚ï¼š %%ngql ADD HOSTS \"storaged3\":9779,\"storaged4\":9779; SHOW HOSTS; ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:2:2","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#å¤šè¡ŒæŸ¥è¯¢"},{"categories":["Nebula Graph"],"content":" 3 æ¸²æŸ“ç»“æœè€Œåœ¨ä»»æ„ä¸€ä¸ªæŸ¥è¯¢ä¹‹åï¼Œç´§è·Ÿç€ä¸€ä¸ª %ng_draw å°±å¯ä»¥æŠŠç»“æœå¯è§†åŒ–æ¸²æŸ“å‡ºæ¥ï¼š # one query %ngql GET SUBGRAPH 2 STEPS FROM \"player101\" YIELD VERTICES AS nodes, EDGES AS relationships; %ng_draw # another query %ngql match p=(:player)-[]-\u003e() return p LIMIT 5 %ng_draw æ•ˆæœï¼š å¹¶ä¸”ï¼Œæ¸²æŸ“çš„ç»“æœè¿˜ä¼šè¢«ä¿å­˜ä¸ºå•æ–‡ä»¶ html ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å†…åµŒåˆ°ä»»æ„ç½‘é¡µä¸­ï¼Œåƒæ˜¯ï¼š ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:3:0","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#æ¸²æŸ“ç»“æœ"},{"categories":["Nebula Graph"],"content":" 4 é«˜çº§åº”ç”¨ä¸‹é¢è¿˜æœ‰ä¸€äº›æ–¹ä¾¿çš„é«˜çº§åº”ç”¨ã€‚æ¯”å¦‚ %ngql help å¯ä»¥è·å¾—æ›´å¤šå¸®åŠ©ä¿¡æ¯ã€‚ ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:4:0","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#é«˜çº§åº”ç”¨"},{"categories":["Nebula Graph"],"content":" 4.1 æ“ä½œæŸ¥è¯¢ç»“æœä¸º pandas dfæ¯ä¸€æ¬¡ query ä¹‹åï¼Œè¿”å›çš„ç»“æœä¼šè¢«å­˜åˆ° _ å˜é‡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å®ƒè¿›è¡Œè¯»å–ï¼š ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:4:1","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#æ“ä½œæŸ¥è¯¢ç»“æœä¸º-pandas-df"},{"categories":["Nebula Graph"],"content":" 4.2 è¿”å›åŸå§‹ ResultSeté»˜è®¤ï¼Œè¿”å›çš„ç»“æœçš„æ ¼å¼æ˜¯ pandas dfï¼Œè€Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨ Jupyter Notebook ä¸­äº¤äº’è°ƒè¯• Python çš„ NebulaGraph åº”ç”¨ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è¿”å›ç»“æœè®¾ç½®ä¸ºåŸå§‹çš„ ResultSet æ ¼å¼ï¼Œæ–¹ä¾¿ç›´è§‚è¿›è¡Œ Query ä¸ç»“æœè§£æï¼Œä¾‹å¦‚ï¼š In [1] : %config IPythonNGQL.ngql_result_style=\"raw\" In [2] : %%ngql USE pokemon_club; ...: GO FROM \"Tom\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id ...: | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: ...: Out[3]: ResultSet(ExecutionResponse( error_code=0, latency_in_us=3270, data=DataSet( column_names=[b'Trainer_Name'], rows=[Row( values=[Value( sVal=b'Tom')]), ... Row( values=[Value( sVal=b'Wey')])]), space_name=b'pokemon_club')) In [4]: r = _ In [5]: r.column_values(key='Trainer_Name')[0].cast() Out[5]: 'Tom' ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:4:2","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#è¿”å›åŸå§‹-resultset"},{"categories":["Nebula Graph"],"content":" 4.3 æŸ¥è¯¢æ¨¡æ¿æ­¤å¤–ï¼Œæˆ‘è¿˜ç»™å¤§å®¶æ”¯æŒäº†æ¨¡æ¿åŠŸèƒ½ï¼Œè¯­æ³•æ²¿ç”¨äº† Jinja2 çš„ {{ variable }} ï¼Œè¯¦è§è¿™ä¸ªä¾‹å­ï¼š ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:4:3","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#æŸ¥è¯¢æ¨¡æ¿"},{"categories":["Nebula Graph"],"content":" 5 æœªæ¥ä¹‹åï¼Œæˆ‘æ‰“ç®—å¢å¼ºå¯è§†åŒ–çš„è‡ªå®šä¹‰é€‰é¡¹ï¼Œä¹Ÿæ¬¢è¿ç¤¾åŒºé‡Œçš„å¤§ä¼™æ¥è´¡çŒ®æ–°çš„ featureã€ideaã€‚ é¡¹ç›®çš„ repo åœ¨ ğŸ‘‰ğŸ» https://github.com/wey-gu/ipython-ngql ","date":"2023-06-06","objectID":"/nebulagraph-in-jupyter-notebook/:5:0","series":null,"tags":["Nebula Graph","Jupyter","Python","å›¾æ•°æ®åº“","å¯è§†åŒ–"],"title":"NebulaGraph in Jupyter Notebook","uri":"/nebulagraph-in-jupyter-notebook/#æœªæ¥"},{"categories":["Nebula Graph","LLM"],"content":"å¦‚ä½•åˆ©ç”¨å›¾è°±æ„å»ºæ›´å¥½çš„ In-context Learning å¤§è¯­è¨€æ¨¡å‹åº”ç”¨ã€‚","date":"2023-06-01","objectID":"/graph-enabled-llama-index/","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/"},{"categories":["Nebula Graph","LLM"],"content":" å¦‚ä½•åˆ©ç”¨å›¾è°±æ„å»ºæ›´å¥½çš„ In-context Learning å¤§è¯­è¨€æ¨¡å‹åº”ç”¨ã€‚ English version æ³¨ï¼šæœ¬æ–‡æ˜¯æˆ‘æœ€åˆä»¥è‹±æ–‡æ’°å†™çš„ï¼Œç„¶åéº»çƒ¦ ChatGPT å¸®æˆ‘ç¿»è¯‘æˆäº†è‹±æ–‡ï¼Œç¿»è¯‘çš„ prompt æ˜¯ï¼š In this thread, you are a Chinese Tech blogger to help translate my blog in markdown from English into Chinese, the blog style is clear, fun yet professional. I will paste chapters in markdown to you and you will send back the translated and polished version. ","date":"2023-06-01","objectID":"/graph-enabled-llama-index/:0:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/#"},{"categories":["Nebula Graph","LLM"],"content":" 1 LLM åº”ç”¨çš„èŒƒå¼ä½œä¸ºè®¤çŸ¥æ™ºèƒ½çš„ä¸€å¤§çªç ´ï¼ŒLLM å·²ç»æ”¹å˜äº†è®¸å¤šè¡Œä¸šï¼Œä»¥ä¸€ç§æˆ‘ä»¬æ²¡æœ‰é¢„æ–™åˆ°çš„æ–¹å¼è¿›è¡Œè‡ªåŠ¨åŒ–ã€åŠ é€Ÿå’Œå¯ç”¨ã€‚æ¯å¤©éƒ½ä¼šçœ‹åˆ°æ–°çš„ LLN åº”ç”¨è¢«åˆ›å»ºå‡ºæ¥ï¼Œæˆ‘ä»¬ä»ç„¶åœ¨æ¢ç´¢å¦‚ä½•åˆ©ç”¨è¿™ç§é­”åŠ›çš„æ–°æ–¹æ³•å’Œç”¨ä¾‹ã€‚ å°† LLM å¼•å…¥æµç¨‹çš„æœ€å…¸å‹æ¨¡å¼ä¹‹ä¸€æ˜¯è¦æ±‚ LLM æ ¹æ®ä¸“æœ‰çš„/ç‰¹å®šé¢†åŸŸçš„çŸ¥è¯†ç†è§£äº‹ç‰©ã€‚ç›®å‰ï¼Œæˆ‘ä»¬å¯ä»¥å‘ LLM æ·»åŠ ä¸¤ç§èŒƒå¼ä»¥è·å–è¿™äº›çŸ¥è¯†ï¼šå¾®è°ƒâ€”â€”fine-tuneå’Œä¸Šä¸‹æ–‡å­¦ä¹ â€”â€” in-context learningã€‚ å¾®è°ƒæ˜¯æŒ‡å¯¹ LLM æ¨¡å‹è¿›è¡Œé™„åŠ è®­ç»ƒï¼Œä»¥å¢åŠ é¢å¤–çš„çŸ¥è¯†ï¼›è€Œä¸Šä¸‹æ–‡å­¦ä¹ æ˜¯åœ¨æŸ¥è¯¢æç¤ºä¸­æ·»åŠ ä¸€äº›é¢å¤–çš„çŸ¥è¯†ã€‚æˆ‘ä»¬ç›®å‰è§‚å¯Ÿåˆ°ï¼Œç”±äºå…¶ç®€å•æ€§ï¼Œä¸Šä¸‹æ–‡å­¦ä¹ æ¯”å¾®è°ƒæ›´å—æ¬¢è¿ã€‚ åœ¨æœ¬åšå®¢ä¸­ï¼Œæˆ‘å°†åˆ†äº«æˆ‘ä»¬åœ¨ä¸Šä¸‹æ–‡å­¦ä¹ æ–¹æ³•æ–¹é¢æ‰€åšçš„å·¥ä½œã€‚ ","date":"2023-06-01","objectID":"/graph-enabled-llama-index/:1:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/#llm-åº”ç”¨çš„èŒƒå¼"},{"categories":["Nebula Graph","LLM"],"content":" 2 Llama Indexï¼šæ•°æ®ä¸ LLM ä¹‹é—´çš„æ¥å£","date":"2023-06-01","objectID":"/graph-enabled-llama-index/:2:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/#llama-indexæ•°æ®ä¸-llm-ä¹‹é—´çš„æ¥å£"},{"categories":["Nebula Graph","LLM"],"content":" 2.1 ä¸Šä¸‹æ–‡å­¦ä¹ ä¸Šä¸‹æ–‡å­¦ä¹ çš„åŸºæœ¬æ€æƒ³æ˜¯ä½¿ç”¨ç°æœ‰çš„ LLMï¼ˆæœªæ›´æ–°ï¼‰æ¥å¤„ç†ç‰¹å®šçŸ¥è¯†æ•°æ®é›†çš„ç‰¹æ®Šä»»åŠ¡ã€‚ ä¾‹å¦‚ï¼Œè¦æ„å»ºä¸€ä¸ªå¯ä»¥å›ç­”å…³äºæŸä¸ªäººçš„ä»»ä½•é—®é¢˜ï¼Œç”šè‡³æ‰®æ¼”ä¸€ä¸ªäººçš„æ•°å­—åŒ–åŒ–èº«çš„åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸Šä¸‹æ–‡å­¦ä¹ åº”ç”¨äºä¸€æœ¬è‡ªä¼ ä¹¦ç±å’Œ LLMã€‚åœ¨å®è·µä¸­ï¼Œåº”ç”¨ç¨‹åºå°†ä½¿ç”¨ç”¨æˆ·çš„é—®é¢˜å’Œä»ä¹¦ä¸­\"æœç´¢\"åˆ°çš„ä¸€äº›ä¿¡æ¯æ„å»ºæç¤ºï¼Œç„¶åæŸ¥è¯¢ LLM æ¥è·å–ç­”æ¡ˆã€‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Docs/Knowledge â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ User â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ LLM â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ åœ¨è¿™ç§æœç´¢æ–¹æ³•ä¸­ï¼Œå®ç°ä»æ–‡æ¡£/çŸ¥è¯†ï¼ˆä¸Šè¿°ç¤ºä¾‹ä¸­çš„é‚£æœ¬ä¹¦ï¼‰ä¸­è·å–ä¸ç‰¹å®šä»»åŠ¡ç›¸å…³ä¿¡æ¯çš„æœ€æœ‰æ•ˆæ–¹å¼ä¹‹ä¸€æ˜¯åˆ©ç”¨åµŒå…¥ï¼ˆEmbeddingï¼‰ã€‚ ","date":"2023-06-01","objectID":"/graph-enabled-llama-index/:2:1","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/#ä¸Šä¸‹æ–‡å­¦ä¹ "},{"categories":["Nebula Graph","LLM"],"content":" 2.2 åµŒå…¥ï¼ˆEmbeddingï¼‰åµŒå…¥é€šå¸¸æŒ‡çš„æ˜¯å°†ç°å®ä¸–ç•Œçš„äº‹ç‰©æ˜ å°„åˆ°å¤šç»´ç©ºé—´ä¸­çš„å‘é‡çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†å›¾åƒæ˜ å°„åˆ°ä¸€ä¸ªï¼ˆ64 x 64ï¼‰ç»´åº¦çš„ç©ºé—´ä¸­ï¼Œå¦‚æœæ˜ å°„è¶³å¤Ÿå¥½ï¼Œä¸¤ä¸ªå›¾åƒä¹‹é—´çš„è·ç¦»å¯ä»¥åæ˜ å®ƒä»¬çš„ç›¸ä¼¼æ€§ã€‚ åµŒå…¥çš„å¦ä¸€ä¸ªä¾‹å­æ˜¯ word2vec ç®—æ³•ï¼Œå®ƒå°†æ¯ä¸ªå•è¯éƒ½æ˜ å°„åˆ°ä¸€ä¸ªå‘é‡ä¸­ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåµŒå…¥è¶³å¤Ÿå¥½ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å®ƒä»¬è¿›è¡ŒåŠ æ³•å’Œå‡æ³•æ“ä½œï¼Œå¯èƒ½ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š vec(apple) + vec(pie) =~ vec(\"apple apie\") æˆ–è€…å‘é‡æµ‹é‡å€¼ vec(apple) + vec(pie) - vec(\"apple apie\") è¶‹è¿‘äº0ï¼š |vec(apple) + vec(pie) - vec(\"apple apie\")| =~ 0 ç±»ä¼¼åœ°ï¼Œâ€œpearâ€ åº”è¯¥æ¯” â€œdinosaurâ€ æ›´æ¥è¿‘ â€œappleâ€ï¼š |vec(apple) - vec(pear)| \u003c |vec(apple) - vec(dinosaur)| æœ‰äº†è¿™ä¸ªåŸºç¡€ï¼Œç†è®ºä¸Šæˆ‘ä»¬å¯ä»¥æœç´¢ä¸ç»™å®šé—®é¢˜æ›´ç›¸å…³çš„ä¹¦ç±ç‰‡æ®µã€‚åŸºæœ¬è¿‡ç¨‹å¦‚ä¸‹ï¼š å°†ä¹¦ç±åˆ†å‰²ä¸ºå°ç‰‡æ®µï¼Œä¸ºæ¯ä¸ªç‰‡æ®µåˆ›å»ºåµŒå…¥å¹¶å­˜å‚¨å®ƒä»¬ å½“æœ‰ä¸€ä¸ªé—®é¢˜æ—¶ï¼Œè®¡ç®—é—®é¢˜çš„åµŒå…¥ é€šè¿‡è®¡ç®—è·ç¦»æ‰¾åˆ°ä¸ä¹¦ç±ç‰‡æ®µæœ€ç›¸ä¼¼çš„å‰ K ä¸ªåµŒå…¥ ä½¿ç”¨é—®é¢˜å’Œä¹¦ç±ç‰‡æ®µæ„å»ºæç¤º ä½¿ç”¨æç¤ºæŸ¥è¯¢ LLM â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â” â”‚ 1 â”‚ 2 â”‚ 3 â”‚ 4 â”‚ â”œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¤ â”‚ Docs/Knowledge â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚ ... â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ â”‚ â”‚ 95 â”‚ 96 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ User â”‚â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€â–¶ LLM â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â” â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â–² â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â–¶â”‚ Tell me ....., please â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”‚ â”‚ 3 â”‚ â”‚ 96 â”‚ â”‚ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â”‚ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ ","date":"2023-06-01","objectID":"/graph-enabled-llama-index/:2:2","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/#åµŒå…¥embedding"},{"categories":["Nebula Graph","LLM"],"content":" 2.3 Llama IndexLlama Index æ˜¯ä¸€ä¸ªå¼€æºå·¥å…·åŒ…ï¼Œå®ƒèƒ½å¸®åŠ©æˆ‘ä»¬ä»¥æœ€ä½³å®è·µå»åš in-context learningï¼š å®ƒæä¾›äº†å„ç§æ•°æ®åŠ è½½å™¨ï¼Œä»¥ç»Ÿä¸€æ ¼å¼åºåˆ—åŒ–æ–‡æ¡£/çŸ¥è¯†ï¼Œä¾‹å¦‚ PDFã€ç»´åŸºç™¾ç§‘é¡µé¢ã€Notionã€Twitter ç­‰ç­‰ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ— éœ€è‡ªè¡Œå¤„ç†é¢„å¤„ç†ã€å°†æ•°æ®åˆ†å‰²ä¸ºç‰‡æ®µç­‰æ“ä½œã€‚ å®ƒè¿˜å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ›å»ºåµŒå…¥ï¼ˆä»¥åŠå…¶ä»–å½¢å¼çš„ç´¢å¼•ï¼‰ï¼Œå¹¶ä»¥ä¸€è¡Œä»£ç çš„æ–¹å¼å­˜å‚¨åµŒå…¥ï¼ˆåœ¨å†…å­˜ä¸­æˆ–å‘é‡æ•°æ®åº“ä¸­ï¼‰ã€‚ å®ƒå†…ç½®äº†æç¤ºå’Œå…¶ä»–å·¥ç¨‹å®ç°ï¼Œå› æ­¤æˆ‘ä»¬æ— éœ€ä»å¤´å¼€å§‹åˆ›å»ºå’Œç ”ç©¶ï¼Œä¾‹å¦‚ï¼Œç”¨4è¡Œä»£ç åœ¨ç°æœ‰æ•°æ®ä¸Šåˆ›å»ºä¸€ä¸ªèŠå¤©æœºå™¨äººã€‚ ","date":"2023-06-01","objectID":"/graph-enabled-llama-index/:2:3","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/#llama-index"},{"categories":["Nebula Graph","LLM"],"content":" 3 æ–‡æ¡£åˆ†å‰²å’ŒåµŒå…¥çš„é—®é¢˜åµŒå…¥å’Œå‘é‡æœç´¢åœ¨è®¸å¤šæƒ…å†µä¸‹æ•ˆæœè‰¯å¥½ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ä»å­˜åœ¨æŒ‘æˆ˜ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯å¯èƒ½ä¸¢å¤±å…¨å±€ä¸Šä¸‹æ–‡/è·¨èŠ‚ç‚¹ä¸Šä¸‹æ–‡ã€‚ æƒ³è±¡ä¸€ä¸‹ï¼Œå½“æŸ¥è¯¢\"è¯·å‘Šè¯‰æˆ‘å…³äºä½œè€…å’Œ foo çš„äº‹æƒ…\"ï¼Œåœ¨è¿™æœ¬ä¹¦ä¸­ï¼Œå‡è®¾ç¼–å·ä¸º 1ã€3ã€6ã€19~25ã€30~44 å’Œ 96~99 çš„åˆ†æ®µéƒ½æ¶‰åŠåˆ° foo è¿™ä¸ªä¸»é¢˜ã€‚åˆ™åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç®€å•åœ°æœç´¢ä¸ä¹¦ç±ç‰‡æ®µç›¸å…³çš„å‰ k ä¸ªåµŒå…¥å¯èƒ½æ•ˆæœä¸å°½äººæ„ï¼Œå› ä¸ºè¿™æ—¶å€™åªè€ƒè™‘ä¸ä¹‹æœ€ç›¸å…³çš„å‡ ä¸ªç‰‡æ®µï¼ˆæ¯”å¦‚ k = 3ï¼‰ï¼Œä»è€Œä¸¢å¤±äº†è®¸å¤šä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â” â”‚ 1 â”‚ 2 â”‚ 3 â”‚ 4 â”‚ â”œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¤ â”‚ Docs/Knowledge â”‚ â”‚ ... â”‚ â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¤ â”‚ 95 â”‚ 96 â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜ è€Œè§£å†³ã€ç¼“è§£è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ï¼Œåœ¨ Llama Index å·¥å…·çš„è¯­å¢ƒä¸‹ï¼Œå°±æ˜¯åˆ›å»ºç»„åˆç´¢å¼•å’Œç»¼åˆç´¢å¼•ã€‚ å…¶ä¸­ï¼Œå‘é‡å­˜å‚¨ï¼ˆVectorStoreï¼‰åªæ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ‘˜è¦ç´¢å¼•å’Œ/æˆ–æ ‘å½¢ç´¢å¼•ç­‰ï¼Œä»¥å°†ä¸åŒç±»å‹çš„é—®é¢˜è·¯ç”±åˆ°ä¸åŒçš„ç´¢å¼•ï¼Œä»è€Œé¿å…åœ¨éœ€è¦å…¨å±€ä¸Šä¸‹æ–‡æ—¶ä¸§å¤±å®ƒã€‚ ç„¶è€Œï¼Œå€ŸåŠ©çŸ¥è¯†å›¾è°±ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–æ›´æœ‰æ„æ€çš„æ–¹æ³•ï¼š ","date":"2023-06-01","objectID":"/graph-enabled-llama-index/:3:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/#æ–‡æ¡£åˆ†å‰²å’ŒåµŒå…¥çš„é—®é¢˜"},{"categories":["Nebula Graph","LLM"],"content":" 4 çŸ¥è¯†å›¾è°±çŸ¥è¯†å›¾è°±è¿™ä¸ªæœ¯è¯­æœ€åˆç”±è°·æ­Œåœ¨2012å¹´5æœˆæå‡ºï¼Œä½œä¸ºå…¶å¢å¼ºæœç´¢ç»“æœå’Œå‘ç”¨æˆ·æä¾›æ›´å¤šä¸Šä¸‹æ–‡ä¿¡æ¯çš„åŠªåŠ›çš„ä¸€éƒ¨åˆ†ã€‚çŸ¥è¯†å›¾è°±æ—¨åœ¨ç†è§£å®ä½“ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶ç›´æ¥æä¾›æŸ¥è¯¢çš„ç­”æ¡ˆï¼Œè€Œä¸ä»…ä»…è¿”å›ç›¸å…³ç½‘é¡µçš„åˆ—è¡¨ã€‚ çŸ¥è¯†å›¾è°±æ˜¯ä¸€ç§ä»¥å›¾å½¢æ ¼å¼ç»„ç»‡å’Œè¿æ¥ä¿¡æ¯çš„æ–¹å¼ï¼Œå…¶ä¸­èŠ‚ç‚¹è¡¨ç¤ºå®ä½“ï¼Œè¾¹è¡¨ç¤ºå®ä½“ä¹‹é—´çš„å…³ç³»ã€‚å›¾å½¢ç»“æ„å…è®¸é«˜æ•ˆåœ°å­˜å‚¨ã€æ£€ç´¢å’Œåˆ†ææ•°æ®ã€‚ å®ƒçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é‚£ä¹ˆçŸ¥è¯†å›¾è°±åˆ°åº•èƒ½æ€ä¹ˆå¸®åˆ°æˆ‘ä»¬å‘¢ï¼Ÿ ","date":"2023-06-01","objectID":"/graph-enabled-llama-index/:4:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/#çŸ¥è¯†å›¾è°±"},{"categories":["Nebula Graph","LLM"],"content":" 5 åµŒå…¥å’ŒçŸ¥è¯†å›¾è°±çš„ç»“åˆè¿™é‡Œçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œä½œä¸ºä¿¡æ¯çš„ç²¾ç‚¼æ ¼å¼ï¼ŒçŸ¥è¯†å›¾è°±å¯ä»¥ä»¥æ¯”æˆ‘ä»¬å¯¹åŸå§‹æ•°æ®/æ–‡æ¡£è¿›è¡Œçš„åˆ†å‰²æ›´å°çš„ç²’åº¦è¿›è¡ŒæŸ¥è¯¢/æœç´¢ã€‚å› æ­¤ï¼Œé€šè¿‡ä¸æ›¿æ¢å¤§å—çš„æ•°æ®ï¼Œè€Œæ˜¯å°†ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°æœç´¢éœ€è¦å…¨å±€/è·¨èŠ‚ç‚¹ä¸Šä¸‹æ–‡çš„æŸ¥è¯¢ã€‚ è¯·çœ‹ä¸‹é¢çš„å›¾ç¤ºï¼Œå‡è®¾é—®é¢˜æ˜¯å…³äº x çš„ï¼Œæ‰€æœ‰æ•°æ®ç‰‡æ®µä¸­æœ‰20ä¸ªä¸å®ƒé«˜åº¦ç›¸å…³ã€‚ç°åœ¨ï¼Œé™¤äº†è·å–ä¸»è¦ä¸Šä¸‹æ–‡çš„å‰3ä¸ªæ–‡æ¡£ç‰‡æ®µï¼ˆæ¯”å¦‚ç¼–å·ä¸º 1ã€2 å’Œ 96 çš„æ–‡æ¡£ç‰‡æ®µï¼‰ï¼Œæˆ‘ä»¬è¿˜ä»çŸ¥è¯†å›¾è°±ä¸­å¯¹ x è¿›è¡Œä¸¤æ¬¡è·³è½¬æŸ¥è¯¢ï¼Œé‚£ä¹ˆå®Œæ•´çš„ä¸Šä¸‹æ–‡å°†åŒ…æ‹¬ï¼š é—®é¢˜ï¼šâ€œTell me things about the author and xâ€ æ¥è‡ªæ–‡æ¡£ç‰‡æ®µç¼–å· 1ã€2 å’Œ 96 çš„åŸå§‹æ–‡æ¡£ï¼Œåœ¨ Llama Index ä¸­ï¼Œå®ƒä»¬è¢«ç§°ä¸ºèŠ‚ç‚¹ 1ã€èŠ‚ç‚¹ 2 å’ŒèŠ‚ç‚¹ 96ã€‚ åŒ…å« â€œxâ€ çš„çŸ¥è¯†å›¾è°±ä¸­çš„ 10 ä¸ªä¸‰å…ƒç»„ï¼Œé€šè¿‡å¯¹ x è¿›è¡Œä¸¤å±‚æ·±åº¦çš„å›¾éå†å¾—åˆ°ï¼š x -\u003e yï¼ˆæ¥è‡ªèŠ‚ç‚¹ 1ï¼‰ x -\u003e aï¼ˆæ¥è‡ªèŠ‚ç‚¹ 2ï¼‰ x -\u003e mï¼ˆæ¥è‡ªèŠ‚ç‚¹ 4ï¼‰ x \u003c- b-\u003e cï¼ˆæ¥è‡ªèŠ‚ç‚¹ 95ï¼‰ x -\u003e dï¼ˆæ¥è‡ªèŠ‚ç‚¹ 96ï¼‰ n -\u003e xï¼ˆæ¥è‡ªèŠ‚ç‚¹ 98ï¼‰ x \u003c- z \u003c- iï¼ˆæ¥è‡ªèŠ‚ç‚¹ 1 å’ŒèŠ‚ç‚¹ 3ï¼‰ x \u003c- z \u003c- bï¼ˆæ¥è‡ªèŠ‚ç‚¹ 1 å’ŒèŠ‚ç‚¹ 95ï¼‰ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ .â”€. .â”€. â”‚ .â”€. .â”€. â”‚ .â”€. â”‚ .â”€. .â”€. â”‚ â”‚( x )â”€â”€â”€â”€â”€â–¶ y ) â”‚ ( x )â”€â”€â”€â”€â”€â–¶ a ) â”‚ ( j ) â”‚ ( m )â—€â”€â”€â”€â”€( x ) â”‚ â”‚ `â–²' `â”€' â”‚ `â”€' `â”€' â”‚ `â”€' â”‚ `â”€' `â”€' â”‚ â”‚ â”‚ 1 â”‚ 2 â”‚ 3 â”‚ â”‚ 4 â”‚ â”‚ .â”€. â”‚ â”‚ .â–¼. â”‚ â”‚ â”‚( z )â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶( i )â”€â”â”‚ â”‚ â”‚ `â—€â”€â”€â”€â”€â” â”‚ â”‚ `â”€' â”‚â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ Docs/Knowledge â”‚ â”‚ â”‚ â”‚ ... â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ .â”€. â””â”€â”€â”€â”€â”€â”€. â”‚ .â”€. â”‚ â”‚â”‚ .â”€. â”‚ â”‚ ( x â—€â”€â”€â”€â”€â”€( b ) â”‚ ( x ) â”‚ â””â”¼â–¶( n ) â”‚ â”‚ `â”€' `â”€' â”‚ `â”€' â”‚ â”‚ `â”€' â”‚ â”‚ 95 â”‚ â”‚ â”‚ 96 â”‚ â”‚ â”‚ 98 â”‚ â”‚ .â–¼. â”‚ .â–¼. â”‚ â”‚ â–¼ â”‚ â”‚ ( c ) â”‚ ( d ) â”‚ â”‚ .â”€. â”‚ â”‚ `â”€' â”‚ `â”€' â”‚ â”‚ ( x ) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€`â”€'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æ˜¾ç„¶ï¼Œé‚£äº›ï¼ˆå¯èƒ½å¾ˆå®è´µçš„ï¼‰æ¶‰åŠåˆ°ä¸»é¢˜ x çš„ç²¾ç‚¼ä¿¡æ¯æ¥è‡ªäºå…¶ä»–èŠ‚ç‚¹ä»¥åŠè·¨èŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œéƒ½å› ä¸ºæˆ‘ä»¬å¼•å…¥çŸ¥è¯†å›¾è°±çš„æ­¥éª¤ï¼Œè€Œèƒ½å¤Ÿè¢«åŒ…å«åœ¨ prompt ä¸­ï¼Œç”¨äºè¿›è¡Œä¸Šä¸‹æ–‡å­¦ä¹ ï¼Œä»è€Œå…‹æœäº†å‰è¾¹æåˆ°çš„é—®é¢˜ã€‚ ","date":"2023-06-01","objectID":"/graph-enabled-llama-index/:5:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/#åµŒå…¥å’ŒçŸ¥è¯†å›¾è°±çš„ç»“åˆ"},{"categories":["Nebula Graph","LLM"],"content":" 6 Llama Index ä¸­çš„çŸ¥è¯†å›¾è°±è¿›å±•æœ€åˆï¼ŒWilliam F.H.å°†çŸ¥è¯†å›¾è°±çš„æŠ½è±¡æ¦‚å¿µå¼•å…¥äº† Llama Indexï¼Œå…¶ä¸­çŸ¥è¯†å›¾è°±ä¸­çš„ä¸‰å…ƒç»„ä¸å…³é”®è¯ç›¸å…³è”ï¼Œå¹¶å­˜å‚¨åœ¨å†…å­˜ä¸­çš„æ–‡æ¡£ä¸­ï¼ŒéšåLogan Markewichè¿˜å¢åŠ äº†æ¯ä¸ªä¸‰å…ƒç»„çš„åµŒå…¥ã€‚ æœ€è¿‘çš„å‡ å‘¨ä¸­ï¼Œæˆ‘ä¸€ç›´åœ¨ä¸ç¤¾åŒºåˆä½œï¼Œè‡´åŠ›äºå°† â€œGraphStoreâ€ å­˜å‚¨ä¸Šä¸‹æ–‡å¼•å…¥ Llama Indexï¼Œä»è€Œå¼•å…¥äº†çŸ¥è¯†å›¾è°±çš„å¤–éƒ¨å­˜å‚¨ã€‚é¦–ä¸ªå®ç°æ˜¯ä½¿ç”¨æˆ‘è‡ªä» 2021 å¹´ä»¥æ¥ä¸€ç›´åœ¨å¼€å‘çš„å¼€æºåˆ†å¸ƒå¼å›¾æ•°æ®åº“ NebulaGraphã€‚ åœ¨å®ç°è¿‡ç¨‹ä¸­ï¼Œè¿˜å¼•å…¥äº†éå†å›¾çš„å¤šä¸ªè·³æ•°é€‰é¡¹ä»¥åŠåœ¨å‰ k ä¸ªèŠ‚ç‚¹ä¸­æ”¶é›†æ›´å¤šå…³é”®å®ä½“çš„é€‰é¡¹ï¼ˆç”¨äºåœ¨çŸ¥è¯†å›¾è°±ä¸­æœç´¢ä»¥è·å¾—æ›´å¤šå…¨å±€ä¸Šä¸‹æ–‡ï¼‰ï¼Œæˆ‘ä»¬ä»åœ¨å¯¹è¿™äº›å˜æ›´è¿›è¡Œå®Œå–„ã€‚ å¼•å…¥ GraphStore åï¼Œè¿˜å¯ä»¥ä»ç°æœ‰çš„çŸ¥è¯†å›¾è°±ä¸­è¿›è¡Œä¸Šä¸‹æ–‡å­¦ä¹ ï¼Œå¹¶ä¸å…¶ä»–ç´¢å¼•ç»“åˆä½¿ç”¨ï¼Œè¿™ä¹Ÿéå¸¸æœ‰å‰æ™¯ï¼Œå› ä¸ºçŸ¥è¯†å›¾è°±è¢«è®¤ä¸ºå…·æœ‰æ¯”å…¶ä»–ç»“æ„åŒ–æ•°æ®æ›´é«˜çš„ä¿¡æ¯å¯†åº¦ã€‚ åœ¨æ¥ä¸‹æ¥çš„å‡ å‘¨é‡Œï¼Œæˆ‘å°†åœ¨æœ¬åšå®¢ä¸­æ›´æ–°æœ‰å…³ Llama Index ä¸­çš„çŸ¥è¯†å›¾è°±ç›¸å…³å·¥ä½œçš„å†…å®¹ï¼Œç„¶ååœ¨ PR åˆå¹¶åï¼Œåˆ†äº«ç«¯åˆ°ç«¯çš„æ¼”ç¤ºé¡¹ç›®å’Œæ•™ç¨‹ã€‚è¯·ç»§ç»­å…³æ³¨ï¼ ","date":"2023-06-01","objectID":"/graph-enabled-llama-index/:6:0","series":null,"tags":["Nebula Graph","LLM","Llama-Index","In-context Learning","å¤§è¯­è¨€æ¨¡å‹"],"title":"å›¾è°±é©±åŠ¨çš„å¤§è¯­è¨€æ¨¡å‹ Llama Index","uri":"/graph-enabled-llama-index/#llama-index-ä¸­çš„çŸ¥è¯†å›¾è°±è¿›å±•"},{"categories":["Nebula Graph"],"content":"ä»‹ç»æ–°é¡¹ç›®ï¼ ng_aiï¼šNebulaGraph çš„å›¾ç®—æ³•å¥—ä»¶ï¼Œå¥½ç”¨çš„ NebulaGraph çš„ high-level Python Algorithm APIï¼Œå®ƒçš„ç›®æ ‡æ˜¯è®© NebulaGraph çš„æ•°æ®ç§‘å­¦å®¶ç”¨æˆ·èƒ½å¤Ÿç”¨å¾ˆå°‘çš„ä»£ç é‡æ‰§è¡Œå›¾ä¸Šçš„ç®—æ³•ç›¸å…³çš„ä»»åŠ¡ã€‚","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/"},{"categories":["Nebula Graph"],"content":" ä»‹ç»æ–°é¡¹ç›®ï¼ ng_aiï¼šNebulaGraph çš„å›¾ç®—æ³•å¥—ä»¶ï¼Œå¥½ç”¨çš„ NebulaGraph çš„ high-level Python Algorithm APIï¼Œå®ƒçš„ç›®æ ‡æ˜¯è®© NebulaGraph çš„æ•°æ®ç§‘å­¦å®¶ç”¨æˆ·èƒ½å¤Ÿç”¨å¾ˆå°‘çš„ä»£ç é‡æ‰§è¡Œå›¾ä¸Šçš„ç®—æ³•ç›¸å…³çš„ä»»åŠ¡ã€‚ ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:0:0","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#"},{"categories":["Nebula Graph"],"content":" 1 Nebulagraph AI å¥—ä»¶è¿™å‘¨ï¼ŒNebulaGraph 3.5.0 å‘å¸ƒå•¦ï¼Œ@whitewum å´è€å¸ˆå»ºè®®æˆ‘ä»¬æŠŠè€Œä¹‹å‰ä¸€æ®µæ—¶é—´ NebulaGraph ç¤¾åŒºé‡Œå¼€å¯çš„æ–°é¡¹ç›® ng_ai å…¬å¼€ç»™å¤§å®¶ï¼Œæœ¬æ–‡å°±æ˜¯ç¬¬ä¸€ç¯‡ä»‹ç» ng_ai çš„æ–‡ç« ï¼ ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:1:0","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#nebulagraph-ai-å¥—ä»¶"},{"categories":["Nebula Graph"],"content":" 1.1 ng_ai æ˜¯ä»€ä¹ˆng_ai çš„å…¨åæ˜¯ï¼šNebulagraph AI Suiteï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒæ˜¯åœ¨ NebulaGraph ä¹‹ä¸Šè·‘ç®—æ³•çš„ Python å¥—ä»¶ï¼Œå¸Œæœ›èƒ½ç»™ NebulaGraph çš„æ•°æ®ç§‘å­¦å®¶ç”¨æˆ·ä¸€ä¸ªè‡ªç„¶ã€ç®€æ´çš„é«˜çº§ APIï¼Œç”¨å¾ˆå°‘çš„ä»£ç é‡æ‰§è¡Œå›¾ä¸Šçš„ç®—æ³•ç›¸å…³çš„ä»»åŠ¡ã€‚ åœ¨ ng_ai è¿™ä¸ªå¼€æºé¡¹ç›®é‡Œï¼Œæˆ‘ä»¬å¸Œæœ›å¿«é€Ÿè¿­ä»£ã€å…¬å¼€è®¨è®ºã€æ¼”è¿›å®ƒï¼Œè€Œè¿™èƒŒåçš„ç›®æ ‡æ˜¯ï¼š Simplifying things in surprising ways. ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:1:1","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#ng_ai-æ˜¯ä»€ä¹ˆ"},{"categories":["Nebula Graph"],"content":" 1.2 ng_ai çš„ç‰¹ç‚¹ä¸ºäº†è®© NebulaGraph ç¤¾åŒºçš„åŒå­¦æ‹¥æœ‰é¡ºæ»‘çš„ç®—æ³•ä½“éªŒï¼Œng_ai æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š ä¸ NebulaGraph ç´§å¯†ç»“åˆï¼Œæ–¹ä¾¿ä»å…¶ä¸­è¯»ã€å†™å›¾æ•°æ® æ”¯æŒå¤šå¼•æ“ã€åç«¯ï¼Œç›®å‰æ”¯æŒ Sparkï¼ˆNebulaGraph Algorithmï¼‰ã€NetworkXï¼Œä¹‹åä¼šæ”¯æŒ DGLã€PyG å‹å¥½ã€ç¬¦åˆç›´è§‰çš„ API è®¾è®¡ ä¸ NebulaGraph çš„ UDF æ— ç¼ç»“åˆï¼Œæ”¯æŒä» Query ä¸­è°ƒç”¨ ng_ai ä»»åŠ¡ å‹å¥½çš„è‡ªå®šä¹‰ç®—æ³•æ¥å£ï¼Œæ–¹ä¾¿ç”¨æˆ·è‡ªå·±å®ç°ç®—æ³•ï¼ˆå°šæœªå®Œæˆï¼‰ ä¸€é”®è¯•ç©ç¯å¢ƒï¼ˆåŸºäº Docker Extentionï¼‰ ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:1:2","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#ng_ai-çš„ç‰¹ç‚¹"},{"categories":["Nebula Graph"],"content":" 2 æˆ‘å¯ä»¥ç”¨ ng_ai å¹²ä»€ä¹ˆ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:2:0","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#æˆ‘å¯ä»¥ç”¨-ng_ai-å¹²ä»€ä¹ˆ"},{"categories":["Nebula Graph"],"content":" 2.1 è·‘åˆ†å¸ƒå¼ pagerank ç®—æ³•å¦‚æœåœ¨ä¸€ä¸ªå¤§å›¾ä¸Šï¼ŒåŸºäº Nebula-Algorithms åˆ†å¸ƒå¼åœ°è·‘ pagerank ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š from ng_ai import NebulaReader # read data with spark engine, scan mode reader = NebulaReader(engine=\"spark\") reader.scan(edge=\"follow\", props=\"degree\") df = reader.read() # run pagerank algorithm pr_result = df.algo.pagerank(reset_prob=0.15, max_iter=10) ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:2:1","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#è·‘åˆ†å¸ƒå¼-pagerank-ç®—æ³•"},{"categories":["Nebula Graph"],"content":" 2.2 å†™å›ç®—æ³•ç»“æœåˆ° NebulaGraphå‡è®¾æˆ‘ä»¬è¦è·‘ä¸€ä¸ª label propagation ç®—æ³•ï¼Œç„¶åæŠŠç»“æœå†™å› NebulaGraphï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š å…ˆç¡®ä¿è¦å†™å› TAG çš„ schema å·²ç»åˆ›å»ºå¥½äº†ï¼Œå†™åˆ° label_propagation.cluster_id å­—æ®µé‡Œï¼š CREATE TAG IF NOT EXISTS label_propagation ( cluster_id string NOT NULL ); æˆ‘ä»¬å…ˆæ‰§è¡Œç®—æ³•ï¼š df_result = df.algo.label_propagation() å†çœ‹ä¸€ä¸‹ç»“æœçš„ schemaï¼š df_result.printSchema() root |-- _id: string (nullable = false) |-- lpa: string (nullable = false) ç„¶åï¼Œä»£ç é‡Œè¿™ä¹ˆå†™ï¼Œæˆ‘ä»¬æŠŠ lpa çš„ç»“æœå†™å› NebulaGraph ä¸­çš„ cluster_id å­—æ®µé‡Œï¼ˆ{\"lpa\": \"cluster_id\"}ï¼‰ï¼š from ng_ai import NebulaWriter from ng_ai.config import NebulaGraphConfig config = NebulaGraphConfig() writer = NebulaWriter( data=df_result, sink=\"nebulagraph_vertex\", config=config, engine=\"spark\" ) # map column louvain into property cluster_id properties = {\"lpa\": \"cluster_id\"} writer.set_options( tag=\"label_propagation\", vid_field=\"_id\", properties=properties, batch_size=256, write_mode=\"insert\", ) # write back to NebulaGraph writer.write() æœ€åï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯ä¸€ä¸‹ç»“æœå•¦ï¼š USE basketballplayer; MATCH (v:label_propagation) RETURN id(v), v.label_propagation.cluster_id LIMIT 3; ç»“æœï¼š +-------------+--------------------------------+ | id(v) | v.label_propagation.cluster_id | +-------------+--------------------------------+ | \"player103\" | \"player101\" | | \"player113\" | \"player129\" | | \"player121\" | \"player129\" | +-------------+--------------------------------+ æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.1 é€šè¿‡ nGQL è°ƒç”¨ç®—æ³•ä» NebulaGraph 3.5.0 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å†™è‡ªå·±çš„ UDF æ¥ä» nGQL é‡Œè°ƒç”¨è‡ªå·±å®ç°çš„å‡½æ•°ï¼Œng_ai ä¹Ÿç”¨è¿™ä¸ªèƒ½åŠ›æ¥å®ç°äº†ä¸€ä¸ª ng_ai å‡½æ•°ï¼Œå®ƒå¯ä»¥ä» nGQL é‡Œè°ƒç”¨ ng_ai çš„ç®—æ³•ï¼Œä¾‹å¦‚ï¼š -- Prepare the write schema USE basketballplayer; CREATE TAG IF NOT EXISTS pagerank(pagerank string); :sleep 20; -- Call with ng_ai() RETURN ng_ai(\"pagerank\", [\"follow\"], [\"degree\"], \"spark\", {space: \"basketballplayer\", max_iter: 10}, {write_mode: \"insert\"}) æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.2 å•æœºè¿è¡Œç®—æ³•åœ¨å•æœºã€æœ¬åœ°çš„ç¯å¢ƒé‡Œï¼Œng_ai æ”¯æŒåŸºäº NetworkX è¿è¡Œç®—æ³•ï¼Œä¾‹å¦‚ï¼š è¯»å–å›¾ä¸º ng_ai graph å¯¹è±¡ï¼š from ng_ai import NebulaReader from ng_ai.config import NebulaGraphConfig # read data with nebula/networkx engine, query mode config_dict = { \"graphd_hosts\": \"graphd:9669\", \"user\": \"root\", \"password\": \"nebula\", \"space\": \"basketballplayer\", } config = NebulaGraphConfig(**config_dict) reader = NebulaReader(engine=\"nebula\", config=config) reader.query(edges=[\"follow\", \"serve\"], props=[[\"degree\"], []]) g = reader.read() æŸ¥çœ‹ã€ç”»å›¾ï¼š g.show(10) g.draw() è¿è¡Œç®—æ³•ï¼š pr_result = g.algo.pagerank(reset_prob=0.15, max_iter=10) å†™å› NebulaGraphï¼š from ng_ai import NebulaWriter writer = NebulaWriter( data=pr_result, sink=\"nebulagraph_vertex\", config=config, engine=\"nebula\", ) # properties to write properties = [\"pagerank\"] writer.set_options( tag=\"pagerank\", properties=properties, batch_size=256, write_mode=\"insert\", ) # write back to NebulaGraph writer.write() å…¶ä»–ç®—æ³•ï¼š # get all algorithms g.algo.get_all_algo() # get help of each algo help(g.algo.node2vec) # call the algo g.algo.node2vec() æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.3 å¯è§†åŒ–å›¾ç®—æ³•ç»“æœå†æ¼”ç¤ºä¸€ä¸ª NetworkX å¼•æ“æƒ…å†µä¸‹ï¼Œè®¡ç®— Louvainã€PageRank å¹¶å¯è§†åŒ–çš„ä¾‹å­ï¼š å…ˆæ‰§è¡Œä¸¤ä¸ªç®—æ³•ï¼š pr_result = g.algo.pagerank(reset_prob=0.15, max_iter=10) louvain_result = g.algo.louvain() è¿™æ¬¡æˆ‘ä»¬æ‰‹å†™ä¸€ä¸ªå¥½çœ‹ä¸€ç‚¹çš„ç”»å›¾å‡½æ•°ï¼š from matplotlib.colors import ListedColormap def draw_graph_louvain_pr(G, pr_result, louvain_result, colors=[\"#1984c5\", \"#22a7f0\", \"#63bff0\", \"#a7d5ed\", \"#e2e2e2\", \"#e1a692\", \"#de6e56\", \"#e14b31\", \"#c23728\"]): # Define positions for the nodes pos = nx.spring_layout(G) # Create a figure and set the axis limits fig, ax = plt.subplots(figsize=(35, 15)) ax.set_xlim(-1, 1) ax.set_ylim(-1, 1) # Create a colormap from the colors list cmap = ListedColormap(colors) # Draw the nodes and edges of the graph node_colors = [louvain_result[node] for node in G.nodes()] node_sizes = [70000 * pr_result[node] for node in G.nodes()] nx.draw_networkx_nodes(G, pos=pos, ax=ax, node_color=node_colors, node_size=node_sizes, cmap=cmap, vmin=0, vmax=max(louvain_result.values())) nx.draw_networkx_edges(G, pos=pos, ax=ax, edge_color='gray', width=1, connectionstyle='arc3, rad=0.2', arrowstyle='-|\u003e', arrows=True) # Extract edge labels as a dictionary edge_labels = nx.get_edge_attributes(G, 'label') # Add ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:2:2","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#å†™å›ç®—æ³•ç»“æœåˆ°-nebulagraph"},{"categories":["Nebula Graph"],"content":" 2.2 å†™å›ç®—æ³•ç»“æœåˆ° NebulaGraphå‡è®¾æˆ‘ä»¬è¦è·‘ä¸€ä¸ª label propagation ç®—æ³•ï¼Œç„¶åæŠŠç»“æœå†™å› NebulaGraphï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š å…ˆç¡®ä¿è¦å†™å› TAG çš„ schema å·²ç»åˆ›å»ºå¥½äº†ï¼Œå†™åˆ° label_propagation.cluster_id å­—æ®µé‡Œï¼š CREATE TAG IF NOT EXISTS label_propagation ( cluster_id string NOT NULL ); æˆ‘ä»¬å…ˆæ‰§è¡Œç®—æ³•ï¼š df_result = df.algo.label_propagation() å†çœ‹ä¸€ä¸‹ç»“æœçš„ schemaï¼š df_result.printSchema() root |-- _id: string (nullable = false) |-- lpa: string (nullable = false) ç„¶åï¼Œä»£ç é‡Œè¿™ä¹ˆå†™ï¼Œæˆ‘ä»¬æŠŠ lpa çš„ç»“æœå†™å› NebulaGraph ä¸­çš„ cluster_id å­—æ®µé‡Œï¼ˆ{\"lpa\": \"cluster_id\"}ï¼‰ï¼š from ng_ai import NebulaWriter from ng_ai.config import NebulaGraphConfig config = NebulaGraphConfig() writer = NebulaWriter( data=df_result, sink=\"nebulagraph_vertex\", config=config, engine=\"spark\" ) # map column louvain into property cluster_id properties = {\"lpa\": \"cluster_id\"} writer.set_options( tag=\"label_propagation\", vid_field=\"_id\", properties=properties, batch_size=256, write_mode=\"insert\", ) # write back to NebulaGraph writer.write() æœ€åï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯ä¸€ä¸‹ç»“æœå•¦ï¼š USE basketballplayer; MATCH (v:label_propagation) RETURN id(v), v.label_propagation.cluster_id LIMIT 3; ç»“æœï¼š +-------------+--------------------------------+ | id(v) | v.label_propagation.cluster_id | +-------------+--------------------------------+ | \"player103\" | \"player101\" | | \"player113\" | \"player129\" | | \"player121\" | \"player129\" | +-------------+--------------------------------+ æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.1 é€šè¿‡ nGQL è°ƒç”¨ç®—æ³•ä» NebulaGraph 3.5.0 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å†™è‡ªå·±çš„ UDF æ¥ä» nGQL é‡Œè°ƒç”¨è‡ªå·±å®ç°çš„å‡½æ•°ï¼Œng_ai ä¹Ÿç”¨è¿™ä¸ªèƒ½åŠ›æ¥å®ç°äº†ä¸€ä¸ª ng_ai å‡½æ•°ï¼Œå®ƒå¯ä»¥ä» nGQL é‡Œè°ƒç”¨ ng_ai çš„ç®—æ³•ï¼Œä¾‹å¦‚ï¼š -- Prepare the write schema USE basketballplayer; CREATE TAG IF NOT EXISTS pagerank(pagerank string); :sleep 20; -- Call with ng_ai() RETURN ng_ai(\"pagerank\", [\"follow\"], [\"degree\"], \"spark\", {space: \"basketballplayer\", max_iter: 10}, {write_mode: \"insert\"}) æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.2 å•æœºè¿è¡Œç®—æ³•åœ¨å•æœºã€æœ¬åœ°çš„ç¯å¢ƒé‡Œï¼Œng_ai æ”¯æŒåŸºäº NetworkX è¿è¡Œç®—æ³•ï¼Œä¾‹å¦‚ï¼š è¯»å–å›¾ä¸º ng_ai graph å¯¹è±¡ï¼š from ng_ai import NebulaReader from ng_ai.config import NebulaGraphConfig # read data with nebula/networkx engine, query mode config_dict = { \"graphd_hosts\": \"graphd:9669\", \"user\": \"root\", \"password\": \"nebula\", \"space\": \"basketballplayer\", } config = NebulaGraphConfig(**config_dict) reader = NebulaReader(engine=\"nebula\", config=config) reader.query(edges=[\"follow\", \"serve\"], props=[[\"degree\"], []]) g = reader.read() æŸ¥çœ‹ã€ç”»å›¾ï¼š g.show(10) g.draw() è¿è¡Œç®—æ³•ï¼š pr_result = g.algo.pagerank(reset_prob=0.15, max_iter=10) å†™å› NebulaGraphï¼š from ng_ai import NebulaWriter writer = NebulaWriter( data=pr_result, sink=\"nebulagraph_vertex\", config=config, engine=\"nebula\", ) # properties to write properties = [\"pagerank\"] writer.set_options( tag=\"pagerank\", properties=properties, batch_size=256, write_mode=\"insert\", ) # write back to NebulaGraph writer.write() å…¶ä»–ç®—æ³•ï¼š # get all algorithms g.algo.get_all_algo() # get help of each algo help(g.algo.node2vec) # call the algo g.algo.node2vec() æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.3 å¯è§†åŒ–å›¾ç®—æ³•ç»“æœå†æ¼”ç¤ºä¸€ä¸ª NetworkX å¼•æ“æƒ…å†µä¸‹ï¼Œè®¡ç®— Louvainã€PageRank å¹¶å¯è§†åŒ–çš„ä¾‹å­ï¼š å…ˆæ‰§è¡Œä¸¤ä¸ªç®—æ³•ï¼š pr_result = g.algo.pagerank(reset_prob=0.15, max_iter=10) louvain_result = g.algo.louvain() è¿™æ¬¡æˆ‘ä»¬æ‰‹å†™ä¸€ä¸ªå¥½çœ‹ä¸€ç‚¹çš„ç”»å›¾å‡½æ•°ï¼š from matplotlib.colors import ListedColormap def draw_graph_louvain_pr(G, pr_result, louvain_result, colors=[\"#1984c5\", \"#22a7f0\", \"#63bff0\", \"#a7d5ed\", \"#e2e2e2\", \"#e1a692\", \"#de6e56\", \"#e14b31\", \"#c23728\"]): # Define positions for the nodes pos = nx.spring_layout(G) # Create a figure and set the axis limits fig, ax = plt.subplots(figsize=(35, 15)) ax.set_xlim(-1, 1) ax.set_ylim(-1, 1) # Create a colormap from the colors list cmap = ListedColormap(colors) # Draw the nodes and edges of the graph node_colors = [louvain_result[node] for node in G.nodes()] node_sizes = [70000 * pr_result[node] for node in G.nodes()] nx.draw_networkx_nodes(G, pos=pos, ax=ax, node_color=node_colors, node_size=node_sizes, cmap=cmap, vmin=0, vmax=max(louvain_result.values())) nx.draw_networkx_edges(G, pos=pos, ax=ax, edge_color='gray', width=1, connectionstyle='arc3, rad=0.2', arrowstyle='-|\u003e', arrows=True) # Extract edge labels as a dictionary edge_labels = nx.get_edge_attributes(G, 'label') # Add ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:2:2","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#é€šè¿‡-ngql-è°ƒç”¨ç®—æ³•"},{"categories":["Nebula Graph"],"content":" 2.2 å†™å›ç®—æ³•ç»“æœåˆ° NebulaGraphå‡è®¾æˆ‘ä»¬è¦è·‘ä¸€ä¸ª label propagation ç®—æ³•ï¼Œç„¶åæŠŠç»“æœå†™å› NebulaGraphï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š å…ˆç¡®ä¿è¦å†™å› TAG çš„ schema å·²ç»åˆ›å»ºå¥½äº†ï¼Œå†™åˆ° label_propagation.cluster_id å­—æ®µé‡Œï¼š CREATE TAG IF NOT EXISTS label_propagation ( cluster_id string NOT NULL ); æˆ‘ä»¬å…ˆæ‰§è¡Œç®—æ³•ï¼š df_result = df.algo.label_propagation() å†çœ‹ä¸€ä¸‹ç»“æœçš„ schemaï¼š df_result.printSchema() root |-- _id: string (nullable = false) |-- lpa: string (nullable = false) ç„¶åï¼Œä»£ç é‡Œè¿™ä¹ˆå†™ï¼Œæˆ‘ä»¬æŠŠ lpa çš„ç»“æœå†™å› NebulaGraph ä¸­çš„ cluster_id å­—æ®µé‡Œï¼ˆ{\"lpa\": \"cluster_id\"}ï¼‰ï¼š from ng_ai import NebulaWriter from ng_ai.config import NebulaGraphConfig config = NebulaGraphConfig() writer = NebulaWriter( data=df_result, sink=\"nebulagraph_vertex\", config=config, engine=\"spark\" ) # map column louvain into property cluster_id properties = {\"lpa\": \"cluster_id\"} writer.set_options( tag=\"label_propagation\", vid_field=\"_id\", properties=properties, batch_size=256, write_mode=\"insert\", ) # write back to NebulaGraph writer.write() æœ€åï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯ä¸€ä¸‹ç»“æœå•¦ï¼š USE basketballplayer; MATCH (v:label_propagation) RETURN id(v), v.label_propagation.cluster_id LIMIT 3; ç»“æœï¼š +-------------+--------------------------------+ | id(v) | v.label_propagation.cluster_id | +-------------+--------------------------------+ | \"player103\" | \"player101\" | | \"player113\" | \"player129\" | | \"player121\" | \"player129\" | +-------------+--------------------------------+ æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.1 é€šè¿‡ nGQL è°ƒç”¨ç®—æ³•ä» NebulaGraph 3.5.0 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å†™è‡ªå·±çš„ UDF æ¥ä» nGQL é‡Œè°ƒç”¨è‡ªå·±å®ç°çš„å‡½æ•°ï¼Œng_ai ä¹Ÿç”¨è¿™ä¸ªèƒ½åŠ›æ¥å®ç°äº†ä¸€ä¸ª ng_ai å‡½æ•°ï¼Œå®ƒå¯ä»¥ä» nGQL é‡Œè°ƒç”¨ ng_ai çš„ç®—æ³•ï¼Œä¾‹å¦‚ï¼š -- Prepare the write schema USE basketballplayer; CREATE TAG IF NOT EXISTS pagerank(pagerank string); :sleep 20; -- Call with ng_ai() RETURN ng_ai(\"pagerank\", [\"follow\"], [\"degree\"], \"spark\", {space: \"basketballplayer\", max_iter: 10}, {write_mode: \"insert\"}) æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.2 å•æœºè¿è¡Œç®—æ³•åœ¨å•æœºã€æœ¬åœ°çš„ç¯å¢ƒé‡Œï¼Œng_ai æ”¯æŒåŸºäº NetworkX è¿è¡Œç®—æ³•ï¼Œä¾‹å¦‚ï¼š è¯»å–å›¾ä¸º ng_ai graph å¯¹è±¡ï¼š from ng_ai import NebulaReader from ng_ai.config import NebulaGraphConfig # read data with nebula/networkx engine, query mode config_dict = { \"graphd_hosts\": \"graphd:9669\", \"user\": \"root\", \"password\": \"nebula\", \"space\": \"basketballplayer\", } config = NebulaGraphConfig(**config_dict) reader = NebulaReader(engine=\"nebula\", config=config) reader.query(edges=[\"follow\", \"serve\"], props=[[\"degree\"], []]) g = reader.read() æŸ¥çœ‹ã€ç”»å›¾ï¼š g.show(10) g.draw() è¿è¡Œç®—æ³•ï¼š pr_result = g.algo.pagerank(reset_prob=0.15, max_iter=10) å†™å› NebulaGraphï¼š from ng_ai import NebulaWriter writer = NebulaWriter( data=pr_result, sink=\"nebulagraph_vertex\", config=config, engine=\"nebula\", ) # properties to write properties = [\"pagerank\"] writer.set_options( tag=\"pagerank\", properties=properties, batch_size=256, write_mode=\"insert\", ) # write back to NebulaGraph writer.write() å…¶ä»–ç®—æ³•ï¼š # get all algorithms g.algo.get_all_algo() # get help of each algo help(g.algo.node2vec) # call the algo g.algo.node2vec() æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.3 å¯è§†åŒ–å›¾ç®—æ³•ç»“æœå†æ¼”ç¤ºä¸€ä¸ª NetworkX å¼•æ“æƒ…å†µä¸‹ï¼Œè®¡ç®— Louvainã€PageRank å¹¶å¯è§†åŒ–çš„ä¾‹å­ï¼š å…ˆæ‰§è¡Œä¸¤ä¸ªç®—æ³•ï¼š pr_result = g.algo.pagerank(reset_prob=0.15, max_iter=10) louvain_result = g.algo.louvain() è¿™æ¬¡æˆ‘ä»¬æ‰‹å†™ä¸€ä¸ªå¥½çœ‹ä¸€ç‚¹çš„ç”»å›¾å‡½æ•°ï¼š from matplotlib.colors import ListedColormap def draw_graph_louvain_pr(G, pr_result, louvain_result, colors=[\"#1984c5\", \"#22a7f0\", \"#63bff0\", \"#a7d5ed\", \"#e2e2e2\", \"#e1a692\", \"#de6e56\", \"#e14b31\", \"#c23728\"]): # Define positions for the nodes pos = nx.spring_layout(G) # Create a figure and set the axis limits fig, ax = plt.subplots(figsize=(35, 15)) ax.set_xlim(-1, 1) ax.set_ylim(-1, 1) # Create a colormap from the colors list cmap = ListedColormap(colors) # Draw the nodes and edges of the graph node_colors = [louvain_result[node] for node in G.nodes()] node_sizes = [70000 * pr_result[node] for node in G.nodes()] nx.draw_networkx_nodes(G, pos=pos, ax=ax, node_color=node_colors, node_size=node_sizes, cmap=cmap, vmin=0, vmax=max(louvain_result.values())) nx.draw_networkx_edges(G, pos=pos, ax=ax, edge_color='gray', width=1, connectionstyle='arc3, rad=0.2', arrowstyle='-|\u003e', arrows=True) # Extract edge labels as a dictionary edge_labels = nx.get_edge_attributes(G, 'label') # Add ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:2:2","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#å•æœºè¿è¡Œç®—æ³•"},{"categories":["Nebula Graph"],"content":" 2.2 å†™å›ç®—æ³•ç»“æœåˆ° NebulaGraphå‡è®¾æˆ‘ä»¬è¦è·‘ä¸€ä¸ª label propagation ç®—æ³•ï¼Œç„¶åæŠŠç»“æœå†™å› NebulaGraphï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š å…ˆç¡®ä¿è¦å†™å› TAG çš„ schema å·²ç»åˆ›å»ºå¥½äº†ï¼Œå†™åˆ° label_propagation.cluster_id å­—æ®µé‡Œï¼š CREATE TAG IF NOT EXISTS label_propagation ( cluster_id string NOT NULL ); æˆ‘ä»¬å…ˆæ‰§è¡Œç®—æ³•ï¼š df_result = df.algo.label_propagation() å†çœ‹ä¸€ä¸‹ç»“æœçš„ schemaï¼š df_result.printSchema() root |-- _id: string (nullable = false) |-- lpa: string (nullable = false) ç„¶åï¼Œä»£ç é‡Œè¿™ä¹ˆå†™ï¼Œæˆ‘ä»¬æŠŠ lpa çš„ç»“æœå†™å› NebulaGraph ä¸­çš„ cluster_id å­—æ®µé‡Œï¼ˆ{\"lpa\": \"cluster_id\"}ï¼‰ï¼š from ng_ai import NebulaWriter from ng_ai.config import NebulaGraphConfig config = NebulaGraphConfig() writer = NebulaWriter( data=df_result, sink=\"nebulagraph_vertex\", config=config, engine=\"spark\" ) # map column louvain into property cluster_id properties = {\"lpa\": \"cluster_id\"} writer.set_options( tag=\"label_propagation\", vid_field=\"_id\", properties=properties, batch_size=256, write_mode=\"insert\", ) # write back to NebulaGraph writer.write() æœ€åï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯ä¸€ä¸‹ç»“æœå•¦ï¼š USE basketballplayer; MATCH (v:label_propagation) RETURN id(v), v.label_propagation.cluster_id LIMIT 3; ç»“æœï¼š +-------------+--------------------------------+ | id(v) | v.label_propagation.cluster_id | +-------------+--------------------------------+ | \"player103\" | \"player101\" | | \"player113\" | \"player129\" | | \"player121\" | \"player129\" | +-------------+--------------------------------+ æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.1 é€šè¿‡ nGQL è°ƒç”¨ç®—æ³•ä» NebulaGraph 3.5.0 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å†™è‡ªå·±çš„ UDF æ¥ä» nGQL é‡Œè°ƒç”¨è‡ªå·±å®ç°çš„å‡½æ•°ï¼Œng_ai ä¹Ÿç”¨è¿™ä¸ªèƒ½åŠ›æ¥å®ç°äº†ä¸€ä¸ª ng_ai å‡½æ•°ï¼Œå®ƒå¯ä»¥ä» nGQL é‡Œè°ƒç”¨ ng_ai çš„ç®—æ³•ï¼Œä¾‹å¦‚ï¼š -- Prepare the write schema USE basketballplayer; CREATE TAG IF NOT EXISTS pagerank(pagerank string); :sleep 20; -- Call with ng_ai() RETURN ng_ai(\"pagerank\", [\"follow\"], [\"degree\"], \"spark\", {space: \"basketballplayer\", max_iter: 10}, {write_mode: \"insert\"}) æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.2 å•æœºè¿è¡Œç®—æ³•åœ¨å•æœºã€æœ¬åœ°çš„ç¯å¢ƒé‡Œï¼Œng_ai æ”¯æŒåŸºäº NetworkX è¿è¡Œç®—æ³•ï¼Œä¾‹å¦‚ï¼š è¯»å–å›¾ä¸º ng_ai graph å¯¹è±¡ï¼š from ng_ai import NebulaReader from ng_ai.config import NebulaGraphConfig # read data with nebula/networkx engine, query mode config_dict = { \"graphd_hosts\": \"graphd:9669\", \"user\": \"root\", \"password\": \"nebula\", \"space\": \"basketballplayer\", } config = NebulaGraphConfig(**config_dict) reader = NebulaReader(engine=\"nebula\", config=config) reader.query(edges=[\"follow\", \"serve\"], props=[[\"degree\"], []]) g = reader.read() æŸ¥çœ‹ã€ç”»å›¾ï¼š g.show(10) g.draw() è¿è¡Œç®—æ³•ï¼š pr_result = g.algo.pagerank(reset_prob=0.15, max_iter=10) å†™å› NebulaGraphï¼š from ng_ai import NebulaWriter writer = NebulaWriter( data=pr_result, sink=\"nebulagraph_vertex\", config=config, engine=\"nebula\", ) # properties to write properties = [\"pagerank\"] writer.set_options( tag=\"pagerank\", properties=properties, batch_size=256, write_mode=\"insert\", ) # write back to NebulaGraph writer.write() å…¶ä»–ç®—æ³•ï¼š # get all algorithms g.algo.get_all_algo() # get help of each algo help(g.algo.node2vec) # call the algo g.algo.node2vec() æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.3 å¯è§†åŒ–å›¾ç®—æ³•ç»“æœå†æ¼”ç¤ºä¸€ä¸ª NetworkX å¼•æ“æƒ…å†µä¸‹ï¼Œè®¡ç®— Louvainã€PageRank å¹¶å¯è§†åŒ–çš„ä¾‹å­ï¼š å…ˆæ‰§è¡Œä¸¤ä¸ªç®—æ³•ï¼š pr_result = g.algo.pagerank(reset_prob=0.15, max_iter=10) louvain_result = g.algo.louvain() è¿™æ¬¡æˆ‘ä»¬æ‰‹å†™ä¸€ä¸ªå¥½çœ‹ä¸€ç‚¹çš„ç”»å›¾å‡½æ•°ï¼š from matplotlib.colors import ListedColormap def draw_graph_louvain_pr(G, pr_result, louvain_result, colors=[\"#1984c5\", \"#22a7f0\", \"#63bff0\", \"#a7d5ed\", \"#e2e2e2\", \"#e1a692\", \"#de6e56\", \"#e14b31\", \"#c23728\"]): # Define positions for the nodes pos = nx.spring_layout(G) # Create a figure and set the axis limits fig, ax = plt.subplots(figsize=(35, 15)) ax.set_xlim(-1, 1) ax.set_ylim(-1, 1) # Create a colormap from the colors list cmap = ListedColormap(colors) # Draw the nodes and edges of the graph node_colors = [louvain_result[node] for node in G.nodes()] node_sizes = [70000 * pr_result[node] for node in G.nodes()] nx.draw_networkx_nodes(G, pos=pos, ax=ax, node_color=node_colors, node_size=node_sizes, cmap=cmap, vmin=0, vmax=max(louvain_result.values())) nx.draw_networkx_edges(G, pos=pos, ax=ax, edge_color='gray', width=1, connectionstyle='arc3, rad=0.2', arrowstyle='-|\u003e', arrows=True) # Extract edge labels as a dictionary edge_labels = nx.get_edge_attributes(G, 'label') # Add ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:2:2","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#å¯è§†åŒ–å›¾ç®—æ³•ç»“æœ"},{"categories":["Nebula Graph"],"content":" 2.2 å†™å›ç®—æ³•ç»“æœåˆ° NebulaGraphå‡è®¾æˆ‘ä»¬è¦è·‘ä¸€ä¸ª label propagation ç®—æ³•ï¼Œç„¶åæŠŠç»“æœå†™å› NebulaGraphï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š å…ˆç¡®ä¿è¦å†™å› TAG çš„ schema å·²ç»åˆ›å»ºå¥½äº†ï¼Œå†™åˆ° label_propagation.cluster_id å­—æ®µé‡Œï¼š CREATE TAG IF NOT EXISTS label_propagation ( cluster_id string NOT NULL ); æˆ‘ä»¬å…ˆæ‰§è¡Œç®—æ³•ï¼š df_result = df.algo.label_propagation() å†çœ‹ä¸€ä¸‹ç»“æœçš„ schemaï¼š df_result.printSchema() root |-- _id: string (nullable = false) |-- lpa: string (nullable = false) ç„¶åï¼Œä»£ç é‡Œè¿™ä¹ˆå†™ï¼Œæˆ‘ä»¬æŠŠ lpa çš„ç»“æœå†™å› NebulaGraph ä¸­çš„ cluster_id å­—æ®µé‡Œï¼ˆ{\"lpa\": \"cluster_id\"}ï¼‰ï¼š from ng_ai import NebulaWriter from ng_ai.config import NebulaGraphConfig config = NebulaGraphConfig() writer = NebulaWriter( data=df_result, sink=\"nebulagraph_vertex\", config=config, engine=\"spark\" ) # map column louvain into property cluster_id properties = {\"lpa\": \"cluster_id\"} writer.set_options( tag=\"label_propagation\", vid_field=\"_id\", properties=properties, batch_size=256, write_mode=\"insert\", ) # write back to NebulaGraph writer.write() æœ€åï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯ä¸€ä¸‹ç»“æœå•¦ï¼š USE basketballplayer; MATCH (v:label_propagation) RETURN id(v), v.label_propagation.cluster_id LIMIT 3; ç»“æœï¼š +-------------+--------------------------------+ | id(v) | v.label_propagation.cluster_id | +-------------+--------------------------------+ | \"player103\" | \"player101\" | | \"player113\" | \"player129\" | | \"player121\" | \"player129\" | +-------------+--------------------------------+ æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.1 é€šè¿‡ nGQL è°ƒç”¨ç®—æ³•ä» NebulaGraph 3.5.0 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å†™è‡ªå·±çš„ UDF æ¥ä» nGQL é‡Œè°ƒç”¨è‡ªå·±å®ç°çš„å‡½æ•°ï¼Œng_ai ä¹Ÿç”¨è¿™ä¸ªèƒ½åŠ›æ¥å®ç°äº†ä¸€ä¸ª ng_ai å‡½æ•°ï¼Œå®ƒå¯ä»¥ä» nGQL é‡Œè°ƒç”¨ ng_ai çš„ç®—æ³•ï¼Œä¾‹å¦‚ï¼š -- Prepare the write schema USE basketballplayer; CREATE TAG IF NOT EXISTS pagerank(pagerank string); :sleep 20; -- Call with ng_ai() RETURN ng_ai(\"pagerank\", [\"follow\"], [\"degree\"], \"spark\", {space: \"basketballplayer\", max_iter: 10}, {write_mode: \"insert\"}) æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.2 å•æœºè¿è¡Œç®—æ³•åœ¨å•æœºã€æœ¬åœ°çš„ç¯å¢ƒé‡Œï¼Œng_ai æ”¯æŒåŸºäº NetworkX è¿è¡Œç®—æ³•ï¼Œä¾‹å¦‚ï¼š è¯»å–å›¾ä¸º ng_ai graph å¯¹è±¡ï¼š from ng_ai import NebulaReader from ng_ai.config import NebulaGraphConfig # read data with nebula/networkx engine, query mode config_dict = { \"graphd_hosts\": \"graphd:9669\", \"user\": \"root\", \"password\": \"nebula\", \"space\": \"basketballplayer\", } config = NebulaGraphConfig(**config_dict) reader = NebulaReader(engine=\"nebula\", config=config) reader.query(edges=[\"follow\", \"serve\"], props=[[\"degree\"], []]) g = reader.read() æŸ¥çœ‹ã€ç”»å›¾ï¼š g.show(10) g.draw() è¿è¡Œç®—æ³•ï¼š pr_result = g.algo.pagerank(reset_prob=0.15, max_iter=10) å†™å› NebulaGraphï¼š from ng_ai import NebulaWriter writer = NebulaWriter( data=pr_result, sink=\"nebulagraph_vertex\", config=config, engine=\"nebula\", ) # properties to write properties = [\"pagerank\"] writer.set_options( tag=\"pagerank\", properties=properties, batch_size=256, write_mode=\"insert\", ) # write back to NebulaGraph writer.write() å…¶ä»–ç®—æ³•ï¼š # get all algorithms g.algo.get_all_algo() # get help of each algo help(g.algo.node2vec) # call the algo g.algo.node2vec() æ›´è¯¦ç»†çš„ä¾‹å­å‚è€ƒï¼šng_ai/examples 2.2.3 å¯è§†åŒ–å›¾ç®—æ³•ç»“æœå†æ¼”ç¤ºä¸€ä¸ª NetworkX å¼•æ“æƒ…å†µä¸‹ï¼Œè®¡ç®— Louvainã€PageRank å¹¶å¯è§†åŒ–çš„ä¾‹å­ï¼š å…ˆæ‰§è¡Œä¸¤ä¸ªç®—æ³•ï¼š pr_result = g.algo.pagerank(reset_prob=0.15, max_iter=10) louvain_result = g.algo.louvain() è¿™æ¬¡æˆ‘ä»¬æ‰‹å†™ä¸€ä¸ªå¥½çœ‹ä¸€ç‚¹çš„ç”»å›¾å‡½æ•°ï¼š from matplotlib.colors import ListedColormap def draw_graph_louvain_pr(G, pr_result, louvain_result, colors=[\"#1984c5\", \"#22a7f0\", \"#63bff0\", \"#a7d5ed\", \"#e2e2e2\", \"#e1a692\", \"#de6e56\", \"#e14b31\", \"#c23728\"]): # Define positions for the nodes pos = nx.spring_layout(G) # Create a figure and set the axis limits fig, ax = plt.subplots(figsize=(35, 15)) ax.set_xlim(-1, 1) ax.set_ylim(-1, 1) # Create a colormap from the colors list cmap = ListedColormap(colors) # Draw the nodes and edges of the graph node_colors = [louvain_result[node] for node in G.nodes()] node_sizes = [70000 * pr_result[node] for node in G.nodes()] nx.draw_networkx_nodes(G, pos=pos, ax=ax, node_color=node_colors, node_size=node_sizes, cmap=cmap, vmin=0, vmax=max(louvain_result.values())) nx.draw_networkx_edges(G, pos=pos, ax=ax, edge_color='gray', width=1, connectionstyle='arc3, rad=0.2', arrowstyle='-|\u003e', arrows=True) # Extract edge labels as a dictionary edge_labels = nx.get_edge_attributes(G, 'label') # Add ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:2:2","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#æ›´æ–¹ä¾¿çš„-notebook-æ“ä½œ-nebulagraph"},{"categories":["Nebula Graph"],"content":" 3 æœªæ¥å·¥ä½œç°åœ¨ ng_ai è¿˜åœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šå·¥ä½œè¦åšï¼š å®Œå–„ reader æ¨¡å¼ï¼Œç°åœ¨ NebulaGraph/NetworkX çš„è¯»å–æ•°æ®åªæ”¯æŒ Query-Modeï¼Œè¿˜éœ€è¦æ”¯æŒ Scan-Mode å®ç°åŸºäº dgl(GNN) çš„é“¾è·¯é¢„æµ‹ã€èŠ‚ç‚¹åˆ†ç±»ç­‰ç®—æ³•ï¼Œä¾‹å¦‚ï¼š model = g.algo.gnn_link_prediction() result = model.train() # query src, dst to be predicted model.predict(src_vertex, dst_vertices) UDAï¼Œè‡ªå®šä¹‰ç®—æ³• å¿«é€Ÿéƒ¨ç½²å·¥å…· ng_ai æ˜¯å®Œå…¨ build in public çš„ï¼Œæ¬¢è¿ç¤¾åŒºçš„å¤§å®¶ä»¬æ¥å‚ä¸ï¼Œä¸€èµ·æ¥å®Œå–„ ng_aiï¼Œè®© NebulaGraph ä¸Šçš„ AI ç®—æ³•æ›´åŠ ç®€å•æ˜“ç”¨ï¼ ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:3:0","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#æœªæ¥å·¥ä½œ"},{"categories":["Nebula Graph"],"content":" 4 è¯•ç© ng_aiæˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†ä¸€é”®éƒ¨ç½²çš„ NebulaGraph + Studio + ng_ai in Jupyter çš„ç¯å¢ƒï¼Œåªéœ€è¦å¤§å®¶ä» Docker Desktop çš„ Extensionï¼ˆæ‰©å±•ï¼‰ä¸­æœç´¢ NebulaGraphï¼Œå°±å¯ä»¥è¯•å®Œäº†ã€‚ å®‰è£… NebulaGraph Docker æ’ä»¶ åœ¨ Docker Desktop çš„æ’ä»¶å¸‚åœºæœç´¢ NebulaGraphï¼Œç‚¹å‡»å®‰è£… å®‰è£… ng_ai playground è¿›å…¥ NebulaGraph æ’ä»¶ï¼Œç‚¹å‡»Install NX Modeï¼Œå®‰è£… ng_ai çš„ NetworkX playgroundï¼Œé€šå¸¸è¦ç­‰å‡ åˆ†é’Ÿç­‰å¾…å®‰è£…å®Œæˆã€‚ è¿›å…¥ NetworkX playground ç‚¹å‡»Jupyter NB NetworkXï¼Œè¿›å…¥ NetworkX playgroundã€‚ ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:4:0","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#è¯•ç©-ng_ai"},{"categories":["Nebula Graph"],"content":" 5 ng_ai çš„æ¶æ„ng_ai çš„æ¶æ„å¦‚ä¸‹ï¼Œå®ƒçš„æ ¸å¿ƒæ¨¡å—æœ‰ï¼š Readerï¼šè´Ÿè´£ä» NebulaGraph è¯»å–æ•°æ® Writerï¼šè´Ÿè´£å°†æ•°æ®å†™å…¥ NebulaGraph *Engineï¼šè´Ÿè´£é€‚é…ä¸åŒè¿è¡Œæ—¶ï¼Œä¾‹å¦‚ Sparkã€DGLã€NetowrkX ç­‰ Algoï¼šç®—æ³•æ¨¡å—ï¼Œä¾‹å¦‚ PageRankã€Louvainã€GNN_Link_Predict ç­‰ æ­¤å¤–ï¼Œä¸ºäº†æ”¯æŒ nGQL ä¸­çš„è°ƒç”¨ï¼Œè¿˜æœ‰ä¸¤ä¸ªæ¨¡å—ï¼š ng_ai-udfï¼šè´Ÿè´£å°† UDF æ³¨å†Œåˆ° NebulaGraphï¼Œæ¥å— ng_ai çš„ query è°ƒç”¨ï¼Œè®¿é—® ng_ai API ng_ai-apiï¼šng_ai çš„ API æœåŠ¡ï¼Œæ¥å— UDF çš„è°ƒç”¨ï¼Œè®¿é—® ng_ai æ ¸å¿ƒæ¨¡å— â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Spark Cluster â”‚ â”‚ .â”€â”€â”€â”€â”€. .â”€â”€â”€â”€â”€. .â”€â”€â”€â”€â”€. .â”€â”€â”€â”€â”€. â”‚ â”‚ ; : ; : ; : ; : â”‚ â”Œâ”€â–¶â”‚ : ; : ; : ; : ; â”‚ â”‚ â”‚ â•² â•± â•² â•± â•² â•± â•² â•± â”‚ â”‚ â”‚ `â”€â”€â”€' `â”€â”€â”€' `â”€â”€â”€' `â”€â”€â”€' â”‚ Algo Spark â”‚ Engineâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”€â”¤ â”‚ â”‚ â”‚ NebulaGraph AI Suite(ngai) â”‚ ngai-api â”‚â—€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ Reader â”‚ â”‚ Algo â”‚ â”‚ Writer â”‚ â”‚ GNN â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â””â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â–¼ â–¼ â–¼ â–¼ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”¤ â”‚ SparkEngine â”‚ â”‚ NebulaEngine â”‚ â”‚ NetworkX â”‚ â”‚ DGLEngineâ”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ Spark â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€Reader â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ Spark Query Mode â”‚ â”‚ â”‚ Reader â”‚ â”‚ â”‚Scan Mode â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ ngai-udfâ”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ â”‚ NebulaGraph Graph Engine Nebula-GraphD â”‚ ngai-GraphD â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ NebulaGraph Storage Engine â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â–¶â”‚ Nebula-StorageD â”‚ Nebula-Metad â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ RETURN ng_ai(\"pagerank\", [\"follow\"], [\"degree\"], \"spark\", {space:\"basketballplayer\"}) â”‚â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ from ng_ai import NebulaReader â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ # read data with spark engine, scan mode â”‚ â”‚ â”‚ reader = NebulaReader(engine=\"spark\") â”‚ â”‚ â”‚ reader.scan(edge=\"follow\", props=\"degree\") â”‚ â””â”€â”€â”‚ df = reader.read() â”‚ â”‚ â”‚ â”‚ # run pagerank algorithm â”‚ â”‚ pr_result = df.algo.pagerank(reset_prob=0.15, max_iter=10) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ","date":"2023-05-02","objectID":"/nebulagraph-ai-suite/:5:0","series":null,"tags":["Nebula Graph","Algorithm","å›¾ç®—æ³•","å›¾è®¡ç®—","Python"],"title":"Nebulagraph Artificial Intelligence Suite","uri":"/nebulagraph-ai-suite/#ng_ai-çš„æ¶æ„"},{"categories":["Nebula Graph"],"content":"å›¾æŠ€æœ¯åœ¨å¤§å‹ã€å¤æ‚åŸºç¡€è®¾æ–½ä¹‹ä¸­ SRE/DevOps çš„å®è·µå‚è€ƒï¼Œæœ¬æ–‡ä»¥ OpenStack ç³»ç»Ÿä¹‹ä¸Šçš„å›¾æ•°æ®åº“å¢å¼ºçš„è¿ç»´æ¡ˆä¾‹ä¸ºä¾‹ï¼Œæ­ç¤ºå›¾æ•°æ®åº“ã€å›¾ç®—æ³•çš„æ™ºèƒ½è¿ç»´æ–¹æ³•ï¼Œå…¨æµç¨‹ç¤ºä¾‹ä»£ç å¼€æºã€‚","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/"},{"categories":["Nebula Graph"],"content":" å›¾æŠ€æœ¯åœ¨å¤§å‹ã€å¤æ‚åŸºç¡€è®¾æ–½ä¹‹ä¸­ SRE/DevOps çš„å®è·µå‚è€ƒï¼Œæœ¬æ–‡ä»¥ OpenStack ç³»ç»Ÿä¹‹ä¸Šçš„å›¾æ•°æ®åº“å¢å¼ºçš„è¿ç»´æ¡ˆä¾‹ä¸ºä¾‹ï¼Œæ­ç¤ºå›¾æ•°æ®åº“ã€å›¾ç®—æ³•çš„æ™ºèƒ½è¿ç»´æ–¹æ³•ï¼Œå…¨æµç¨‹ç¤ºä¾‹ä»£ç å¼€æºã€‚ å› ä¸ºæœ‰ä¸€äº›è¿˜æœªé‡‡ç”¨å›¾æŠ€æœ¯çš„ DevOps/Infra é¢†åŸŸåŒå­¦åœ¨ NebulaGraph ç¤¾åŒºè¯¢é—®å‚è€ƒçš„æ¡ˆä¾‹ï¼Œæˆ‘æœ€è¿‘è¯•ç€å®è·µäº†ä¸€ä¸‹å¦‚ä½•åˆ©ç”¨å›¾çš„èƒ½åŠ›ä¸ä¼˜åŠ¿å»å¸®åŠ©åœ¨å¤æ‚åŸºç¡€è®¾æ–½ä¸Šæ„å»ºè¾…åŠ©è¿ç»´ç³»ç»Ÿï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°æ„Ÿå…´è¶£ Infra Ops é¢†åŸŸã€åŒæ—¶æ„Ÿå…´è¶£å›¾æ•°æ®åº“ã€å›¾ç®—æ³•çš„å¤§å®¶ï¼Œå…¨è¿‡ç¨‹éƒ½æ˜¯å¯ä»¥å¤ç°ã€å¹¶ä¸”å¼€æºçš„ã€‚ å¤æ‚çš„åŸºç¡€è®¾æ–½è¿ç»´ç¯å¢ƒé€šå¸¸åŒ…å«éå¸¸å¤šã€ä¸åŒå±‚é¢çš„èµ„æºï¼ˆmanifest)ï¼Œä¸ºäº†èƒ½å¤Ÿå°½é‡è¿˜åŸçœŸå®ä¸–ç•Œçš„å¤æ‚ç¯å¢ƒã€åˆä¿æŒè¿™ä¸ªå®ä¾‹é¡¹ç›®çš„å¤æ‚åº¦ä¸ä¼šå¤±æ§ï¼Œæˆ‘é€‰æ‹©äº†ç”¨ä¸€ä¸ªåŸºç¡€è®¾æ–½å¹³å°ï¼šOpenStack ä½œä¸ºä¾‹å­ã€‚ æœ¬æ–‡å®ç°äº† OpenStack ç³»ç»Ÿä¸Šåˆ†åˆ«åˆ©ç”¨ Push å’Œ Pull ä¸¤ç§æ¨¡å¼å°†èµ„æºä¹‹ä¸­è¢«å›¾è°±å»ºæ¨¡çš„å›¾ä¸­ç‚¹ã€è¾¹ä¿¡æ¯åŠ è½½åˆ° NebulaGraph é‡Œçš„ Graph ETL ç®¡é“çš„è·¯å¾„ã€‚ åœ¨å›¾è°±ä¹‹ä¸Šï¼Œæœ¬æ–‡æ¢ç´¢å¦‚ä¸‹ç”¨ä¾‹ï¼š å‘Šè­¦ã€çŠ¶æ€çš„æ¨ç†ä¸ä¼ å¯¼ï¼› ç½‘ç»œç›´è¿ä¸äº’è”å…³ç³»ï¼› é•œåƒã€äº‘ç›˜ã€å¿«ç…§è¡€ç¼˜ç®¡ç†ï¼› é«˜ç›¸å…³æ€§è™šæœºé¢„è­¦ï¼› ç§˜é’¥æ³„æ¼çš„å›¾ä¸Šé£æ§åˆ†æï¼› é•œåƒã€äº‘ç›˜æ¼æ´èŒƒå›´åˆ†æï¼› å®¿ä¸»æœºé€ƒç¦»å½±å“èŒƒå›´åˆ†æï¼› è„†å¼±ä¾èµ–èµ„æºæ£€æµ‹ï¼› ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:0:0","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#"},{"categories":["Nebula Graph"],"content":" 1 è¯•éªŒç¯å¢ƒæ­å»º","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:1:0","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#è¯•éªŒç¯å¢ƒæ­å»º"},{"categories":["Nebula Graph"],"content":" 1.1 èƒŒæ™¯çŸ¥è¯†OpenStack æ˜¯ä¸€ä¸ªå¼€æºçš„äº‘è®¡ç®—å¹³å°ï¼Œæä¾›äº†ç±»ä¼¼äº AWS çš„äº‘æœåŠ¡ã€‚å®ƒæä¾›äº†ä¸€ç»„å¯æ’æ‹”çš„æ¨¡å—ï¼ŒåŒ…æ‹¬äº†è®¡ç®—ï¼Œå­˜å‚¨å’Œç½‘ç»œç­‰åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·æ„å»ºå’Œç®¡ç†äº‘ç¯å¢ƒã€‚OpenStacké‡‡ç”¨åˆ†å¸ƒå¼æ¶æ„ï¼Œæ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å¹³å°ï¼Œå¯ä»¥åœ¨ä¼ä¸šçº§å’ŒæœåŠ¡æä¾›å•†çº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ æœ€åˆç”± NASA å’Œ Rackspace Inc. å‘èµ·çš„ nova ï¼ˆè™šæ‹ŸåŒ–è®¡ç®—é¡¹ç›®ï¼‰å’Œ swift ï¼ˆå…¼å®¹ S3 çš„å¯¹è±¡å­˜å‚¨ï¼‰é¡¹ç›®ç»„æˆï¼ŒOpenStack ç°åœ¨ç”±éå¸¸å¤šä¸åŒçš„å­é¡¹ç›®ç»„æˆï¼š æœ¬å®éªŒä¸­ï¼Œæˆ‘ä»¬è®¾è®¡çš„ OpenStack ä¸»è¦é¡¹ç›®æœ‰ï¼š Nova æ˜¯ OpenStack çš„è®¡ç®—æœåŠ¡ï¼Œç”¨äºç®¡ç†è™šæ‹Ÿæœºã€‚ Cinder æ˜¯ OpenStack çš„å—å­˜å‚¨æœåŠ¡ï¼Œç”¨äºç®¡ç†äº‘å­˜å‚¨ã€‚ Neutron æ˜¯ OpenStack çš„ç½‘ç»œæœåŠ¡ï¼Œç”¨äºç®¡ç†äº‘ç½‘ç»œã€‚ Glance æ˜¯ OpenStack çš„é•œåƒæœåŠ¡ï¼Œç”¨äºç®¡ç†äº‘é•œåƒã€‚ Horizon æ˜¯ OpenStack çš„å¯è§†åŒ–æ§åˆ¶å°æœåŠ¡ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è¿˜å¼•å…¥äº† Vitrage é¡¹ç›®è¾…åŠ©æˆ‘ä»¬æ”¶é›†éƒ¨åˆ†èµ„æºæ•°æ®ï¼š Vitrage æ˜¯ OpenStack ä¸­çš„ä¸€ä¸ªé«˜çº§åˆ†æå’Œå¯è§†åŒ–å·¥å…·ï¼Œç”¨äºåˆ†æå’Œå¯è§†åŒ– OpenStack ç¯å¢ƒä¸­çš„èµ„æºå’Œäº‹ä»¶ã€‚å®ƒå¯ä»¥æ±‡é›†æ¥è‡ª OpenStack å„ä¸ªæœåŠ¡çš„æ•°æ®ï¼Œå¹¶ä½¿ç”¨å›¾å½¢åŒ–æ–¹å¼å±•ç¤ºå‡ºæ¥ã€‚Vitrage å‘ç°å’Œè¯Šæ–­é—®é¢˜ï¼Œæé«˜ OpenStack ç¯å¢ƒçš„å¯ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ å¾—ç›Šäº OpenStack Decouple çš„è®¾è®¡ç†å¿µï¼ŒVitrage å¯ä»¥å¾ˆå®¹æ˜“ã€æ— ä¾µå…¥å¼ï¼ˆåªéœ€è¦ä¿®æ”¹éœ€è¦æ”¶é›†çš„æœåŠ¡ä¸¤è¡Œé…ç½®ï¼‰å°±å¯ä»¥åœ¨ OpenStack çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­è®¢é˜…èµ„æºä¿¡æ¯çš„ push æ¶ˆæ¯ã€‚ ä¸è¿‡æ¯”è¾ƒé—æ†¾çš„æ˜¯ Vitrage è¿™ä¸ªé¡¹ç›®å·²ç»æœ‰å¥½å¤šä¸ª release cycle æ²¡æœ‰ä»€ä¹ˆå¤§çš„æ›´æ–°äº†ï¼Œåº”è¯¥æ˜¯æ¯”è¾ƒä¸æ´»è·ƒçš„çŠ¶æ€äº†ï¼Œæ¯”å¦‚åœ¨ zed é‡Œï¼Œå®ƒçš„ Vitrage Dashboard ä½œä¸º Horizon æ’ä»¶å·²ç»æ— æ³•æ­£å¸¸å·¥ä½œäº†ï¼Œæœ¬å®éªŒåªåˆ©ç”¨å®ƒçš„èµ„æºæ”¶é›†èƒ½åŠ›ã€‚ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:1:1","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#èƒŒæ™¯çŸ¥è¯†"},{"categories":["Nebula Graph"],"content":" 1.2 ç¯å¢ƒå‡†å¤‡æ­å»º 1.2.1 NebulaGraph é›†ç¾¤é¦–æ¬¡å¿«é€Ÿè¯•ç©å®‰è£… NebulaGraph çš„è¯ï¼Œæœ‰è¿™ä¹ˆå‡ ä¸ªé€‰é¡¹ï¼š é˜¿é‡Œäº‘ä¸Šçš„ NebulaGraph ä¼ä¸šç‰ˆï¼ˆå¸¦æœ‰ä¼ä¸šç‰ˆç‹¬æœ‰çš„æ»¡è¡€ç‰ˆå¯è§†åŒ–å·¥å…·ï¼šExplorerï¼Œå¯ä»¥å›¾æ¢ç´¢ã€ç”»å¸ƒå†…è·‘å›¾ç®—æ³•ï¼‰ï¼Œå¯ä»¥è·å¾—ä¸€ä¸ªæœˆæ‰€æœ‰èµ„æºå…è´¹ä½¿ç”¨èµ„æ ¼ï¼š è®¿é—® https://www.siwei.io/try-aliyun è·å¾— Nebula-Up ä¸€é”®å®‰è£… NebulaGraph å¼€æºç¤¾åŒºç‰ˆæœ¬ï¼Œéœ€è¦ä¸€ä¸ªå¸¦æœ‰ Dockerã€Docker Desktop ç¯å¢ƒçš„æœºå™¨ è®¿é—® https://github.com/wey-gu/nebula-up æœ‰ç»éªŒçš„åŒå­¦å¯ä»¥å‚è€ƒæ–‡æ¡£è¿›è¡Œéƒ¨ç½²ï¼š è®¿é—® https://docs.nebula-graph.com.cn/ 1.2.2 OpenStack é›†ç¾¤ æ³¨æ„ï¼šå¦‚æœå¤§å®¶å·²ç»æœ‰ç°æˆçš„ OpenStack é›†ç¾¤ï¼Œè¿™ä¸€æ­¥å¯ä»¥å¿½ç•¥ï¼Œæ‚¨åªéœ€è¦å†å»å®‰è£… OpenStack Vitrage å°±å¥½äº†ã€‚ æœ¬æ–‡éœ€è¦çš„ OpenStack é›†ç¾¤æ˜¯ä¸€ä¸ªå¤šæœºçš„ç¯å¢ƒï¼Œä¸ºæ­¤ï¼Œæˆ‘å‡†å¤‡äº†åœ¨ Linux Server ä¸Šåˆ©ç”¨ Libvirt å’Œ Linux Bridge æ­å»ºå¤šä¸ªè™šæ‹Ÿæœºç”¨æ¥æ¨¡æ‹Ÿ OpenStack çš„ç‰©ç†æœºï¼Œå¾—ç›Šäº CPU çš„åµŒå¥—è™šæ‹ŸåŒ–å’Œ qemuï¼Œåè¾¹æˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨è™šæ‹Ÿæœºæ­å»ºçš„å®éªŒç¯å¢ƒä¸­æ¨¡æ‹Ÿå¯æ­£å¸¸å·¥ä½œçš„ OpenStack nova instance è™šæœºã€‚ æ•´ä¸ªæµç¨‹æˆ‘éƒ½æ”¾åœ¨ https://github.com/wey-gu/openstack-graph/#environment-setup è¿™é‡Œäº†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—®ã€è·å–ã€‚ è™šæ‹Ÿæœºæ­å»ºä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ¨¡æ‹ŸçœŸå®çš„ Infra ç¯å¢ƒï¼Œåˆ›å»ºå¾ˆå¤šèµ„æºï¼šæ•´ä¸ªè¿‡ç¨‹ä¹Ÿåœ¨ https://github.com/wey-gu/openstack-graph/#create-resources-on-openstack æœ‰è¯¦ç»†åˆ—å‡ºï¼Œæƒ³è¦åŠ¨æ‰‹æ“ä½œçš„åŒå­¦å¯ä»¥å‚è€ƒæ¥äº²è‡ªä¸Šæ‰‹ä¸€ä¸‹ã€‚ å‚è€ƒå¦‚ä¸Šæ­¥éª¤æ“ä½œä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥é€šè¿‡ Horizon Dashboard æŸ¥çœ‹é›†ç¾¤å’Œèµ„æºï¼š æˆ‘ä»¬åˆ›å»ºäº†å‡ ä¸ªè™šæ‹Ÿæœºï¼š å‡ ä¸ªç½‘ç›˜ï¼Œå…¶ä¸­å››ä¸ªæŒ‚è½½åœ¨ä¸åŒçš„è™šæ‹Ÿæœºä¸Š é›†ç¾¤ç§Ÿæˆ·çš„ç½‘ç»œæ‹“æ‰‘ï¼š æˆ‘ä»¬è¿˜èƒ½é€šè¿‡ OpenStack Vitrage çš„ API/CLI è·å¾—éƒ¨åˆ†ä¸»è¦èµ„æºçš„æ‹“æ‰‘ï¼š source openrc admin admin vitrage topology show --all-tenants å®ƒçš„ç»“æœæ˜¯ä¸€ä¸ª JSONï¼Œé‡Œè¾¹å·²ç»æŒ‰ç…§è¾¹ï¼ˆlinksï¼‰å’Œç‚¹ï¼ˆnodesï¼‰åºåˆ—åŒ–å›¾ç»“æ„çš„æ•°æ®äº†ã€‚ { \"directed\": true, \"graph\": {}, \"links\": [ { \"vitrage_is_deleted\": false, \"relationship_type\": \"contains\", \"source\": 0, \"target\": 11, \"key\": \"contains\" }, { \"vitrage_is_deleted\": false, \"relationship_type\": \"contains\", \"source\": 0, \"target\": 13, \"key\": \"contains\" }, ... { \"vitrage_is_deleted\": false, \"relationship_type\": \"attached\", \"source\": 27, \"target\": 28, \"key\": \"attached\" } ], \"multigraph\": true, \"nodes\": [ { \"id\": \"node0\", \"vitrage_type\": \"nova.host\", \"vitrage_category\": \"RESOURCE\", \"vitrage_is_deleted\": false, \"update_timestamp\": \"2023-01-13T08:06:48Z\", \"vitrage_sample_timestamp\": \"2023-01-13T08:06:49Z\", \"vitrage_is_placeholder\": false, \"vitrage_id\": \"630b4c2c-5347-4073-91a3-255ec18dadfc\", \"name\": \"node0\", \"vitrage_cached_id\": \"d043d278a6a712909e30e50ca8ec2364\", \"is_real_vitrage_id\": true, \"vitrage_aggregated_state\": \"AVAILABLE\", \"vitrage_operational_state\": \"OK\", \"vitrage_datasource_name\": \"nova.host\", \"state\": \"available\", \"graph_index\": 0 }, { \"id\": \"nova\", \"vitrage_type\": \"nova.zone\", \"vitrage_category\": \"RESOURCE\", \"vitrage_is_deleted\": false, \"vitrage_sample_timestamp\": \"2023-01-12T03:06:48Z\", \"vitrage_is_placeholder\": false, \"vitrage_id\": \"a1e9c808-dac8-4b59-8f80-f21a90e9869d\", \"vitrage_cached_id\": \"125f1d8c4451a6385cc2cfa2b0ba45be\", \"is_real_vitrage_id\": true, \"vitrage_aggregated_state\": \"AVAILABLE\", \"vitrage_operational_state\": \"OK\", \"state\": \"available\", \"update_timestamp\": \"2023-01-12T03:06:48Z\", \"name\": \"nova\", \"vitrage_datasource_name\": \"nova.zone\", \"graph_index\": 1 }, ... \"raw\": true } ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:1:2","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#ç¯å¢ƒå‡†å¤‡æ­å»º"},{"categories":["Nebula Graph"],"content":" 1.2 ç¯å¢ƒå‡†å¤‡æ­å»º 1.2.1 NebulaGraph é›†ç¾¤é¦–æ¬¡å¿«é€Ÿè¯•ç©å®‰è£… NebulaGraph çš„è¯ï¼Œæœ‰è¿™ä¹ˆå‡ ä¸ªé€‰é¡¹ï¼š é˜¿é‡Œäº‘ä¸Šçš„ NebulaGraph ä¼ä¸šç‰ˆï¼ˆå¸¦æœ‰ä¼ä¸šç‰ˆç‹¬æœ‰çš„æ»¡è¡€ç‰ˆå¯è§†åŒ–å·¥å…·ï¼šExplorerï¼Œå¯ä»¥å›¾æ¢ç´¢ã€ç”»å¸ƒå†…è·‘å›¾ç®—æ³•ï¼‰ï¼Œå¯ä»¥è·å¾—ä¸€ä¸ªæœˆæ‰€æœ‰èµ„æºå…è´¹ä½¿ç”¨èµ„æ ¼ï¼š è®¿é—® https://www.siwei.io/try-aliyun è·å¾— Nebula-Up ä¸€é”®å®‰è£… NebulaGraph å¼€æºç¤¾åŒºç‰ˆæœ¬ï¼Œéœ€è¦ä¸€ä¸ªå¸¦æœ‰ Dockerã€Docker Desktop ç¯å¢ƒçš„æœºå™¨ è®¿é—® https://github.com/wey-gu/nebula-up æœ‰ç»éªŒçš„åŒå­¦å¯ä»¥å‚è€ƒæ–‡æ¡£è¿›è¡Œéƒ¨ç½²ï¼š è®¿é—® https://docs.nebula-graph.com.cn/ 1.2.2 OpenStack é›†ç¾¤ æ³¨æ„ï¼šå¦‚æœå¤§å®¶å·²ç»æœ‰ç°æˆçš„ OpenStack é›†ç¾¤ï¼Œè¿™ä¸€æ­¥å¯ä»¥å¿½ç•¥ï¼Œæ‚¨åªéœ€è¦å†å»å®‰è£… OpenStack Vitrage å°±å¥½äº†ã€‚ æœ¬æ–‡éœ€è¦çš„ OpenStack é›†ç¾¤æ˜¯ä¸€ä¸ªå¤šæœºçš„ç¯å¢ƒï¼Œä¸ºæ­¤ï¼Œæˆ‘å‡†å¤‡äº†åœ¨ Linux Server ä¸Šåˆ©ç”¨ Libvirt å’Œ Linux Bridge æ­å»ºå¤šä¸ªè™šæ‹Ÿæœºç”¨æ¥æ¨¡æ‹Ÿ OpenStack çš„ç‰©ç†æœºï¼Œå¾—ç›Šäº CPU çš„åµŒå¥—è™šæ‹ŸåŒ–å’Œ qemuï¼Œåè¾¹æˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨è™šæ‹Ÿæœºæ­å»ºçš„å®éªŒç¯å¢ƒä¸­æ¨¡æ‹Ÿå¯æ­£å¸¸å·¥ä½œçš„ OpenStack nova instance è™šæœºã€‚ æ•´ä¸ªæµç¨‹æˆ‘éƒ½æ”¾åœ¨ https://github.com/wey-gu/openstack-graph/#environment-setup è¿™é‡Œäº†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—®ã€è·å–ã€‚ è™šæ‹Ÿæœºæ­å»ºä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ¨¡æ‹ŸçœŸå®çš„ Infra ç¯å¢ƒï¼Œåˆ›å»ºå¾ˆå¤šèµ„æºï¼šæ•´ä¸ªè¿‡ç¨‹ä¹Ÿåœ¨ https://github.com/wey-gu/openstack-graph/#create-resources-on-openstack æœ‰è¯¦ç»†åˆ—å‡ºï¼Œæƒ³è¦åŠ¨æ‰‹æ“ä½œçš„åŒå­¦å¯ä»¥å‚è€ƒæ¥äº²è‡ªä¸Šæ‰‹ä¸€ä¸‹ã€‚ å‚è€ƒå¦‚ä¸Šæ­¥éª¤æ“ä½œä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥é€šè¿‡ Horizon Dashboard æŸ¥çœ‹é›†ç¾¤å’Œèµ„æºï¼š æˆ‘ä»¬åˆ›å»ºäº†å‡ ä¸ªè™šæ‹Ÿæœºï¼š å‡ ä¸ªç½‘ç›˜ï¼Œå…¶ä¸­å››ä¸ªæŒ‚è½½åœ¨ä¸åŒçš„è™šæ‹Ÿæœºä¸Š é›†ç¾¤ç§Ÿæˆ·çš„ç½‘ç»œæ‹“æ‰‘ï¼š æˆ‘ä»¬è¿˜èƒ½é€šè¿‡ OpenStack Vitrage çš„ API/CLI è·å¾—éƒ¨åˆ†ä¸»è¦èµ„æºçš„æ‹“æ‰‘ï¼š source openrc admin admin vitrage topology show --all-tenants å®ƒçš„ç»“æœæ˜¯ä¸€ä¸ª JSONï¼Œé‡Œè¾¹å·²ç»æŒ‰ç…§è¾¹ï¼ˆlinksï¼‰å’Œç‚¹ï¼ˆnodesï¼‰åºåˆ—åŒ–å›¾ç»“æ„çš„æ•°æ®äº†ã€‚ { \"directed\": true, \"graph\": {}, \"links\": [ { \"vitrage_is_deleted\": false, \"relationship_type\": \"contains\", \"source\": 0, \"target\": 11, \"key\": \"contains\" }, { \"vitrage_is_deleted\": false, \"relationship_type\": \"contains\", \"source\": 0, \"target\": 13, \"key\": \"contains\" }, ... { \"vitrage_is_deleted\": false, \"relationship_type\": \"attached\", \"source\": 27, \"target\": 28, \"key\": \"attached\" } ], \"multigraph\": true, \"nodes\": [ { \"id\": \"node0\", \"vitrage_type\": \"nova.host\", \"vitrage_category\": \"RESOURCE\", \"vitrage_is_deleted\": false, \"update_timestamp\": \"2023-01-13T08:06:48Z\", \"vitrage_sample_timestamp\": \"2023-01-13T08:06:49Z\", \"vitrage_is_placeholder\": false, \"vitrage_id\": \"630b4c2c-5347-4073-91a3-255ec18dadfc\", \"name\": \"node0\", \"vitrage_cached_id\": \"d043d278a6a712909e30e50ca8ec2364\", \"is_real_vitrage_id\": true, \"vitrage_aggregated_state\": \"AVAILABLE\", \"vitrage_operational_state\": \"OK\", \"vitrage_datasource_name\": \"nova.host\", \"state\": \"available\", \"graph_index\": 0 }, { \"id\": \"nova\", \"vitrage_type\": \"nova.zone\", \"vitrage_category\": \"RESOURCE\", \"vitrage_is_deleted\": false, \"vitrage_sample_timestamp\": \"2023-01-12T03:06:48Z\", \"vitrage_is_placeholder\": false, \"vitrage_id\": \"a1e9c808-dac8-4b59-8f80-f21a90e9869d\", \"vitrage_cached_id\": \"125f1d8c4451a6385cc2cfa2b0ba45be\", \"is_real_vitrage_id\": true, \"vitrage_aggregated_state\": \"AVAILABLE\", \"vitrage_operational_state\": \"OK\", \"state\": \"available\", \"update_timestamp\": \"2023-01-12T03:06:48Z\", \"name\": \"nova\", \"vitrage_datasource_name\": \"nova.zone\", \"graph_index\": 1 }, ... \"raw\": true } ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:1:2","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#nebulagraph-é›†ç¾¤"},{"categories":["Nebula Graph"],"content":" 1.2 ç¯å¢ƒå‡†å¤‡æ­å»º 1.2.1 NebulaGraph é›†ç¾¤é¦–æ¬¡å¿«é€Ÿè¯•ç©å®‰è£… NebulaGraph çš„è¯ï¼Œæœ‰è¿™ä¹ˆå‡ ä¸ªé€‰é¡¹ï¼š é˜¿é‡Œäº‘ä¸Šçš„ NebulaGraph ä¼ä¸šç‰ˆï¼ˆå¸¦æœ‰ä¼ä¸šç‰ˆç‹¬æœ‰çš„æ»¡è¡€ç‰ˆå¯è§†åŒ–å·¥å…·ï¼šExplorerï¼Œå¯ä»¥å›¾æ¢ç´¢ã€ç”»å¸ƒå†…è·‘å›¾ç®—æ³•ï¼‰ï¼Œå¯ä»¥è·å¾—ä¸€ä¸ªæœˆæ‰€æœ‰èµ„æºå…è´¹ä½¿ç”¨èµ„æ ¼ï¼š è®¿é—® https://www.siwei.io/try-aliyun è·å¾— Nebula-Up ä¸€é”®å®‰è£… NebulaGraph å¼€æºç¤¾åŒºç‰ˆæœ¬ï¼Œéœ€è¦ä¸€ä¸ªå¸¦æœ‰ Dockerã€Docker Desktop ç¯å¢ƒçš„æœºå™¨ è®¿é—® https://github.com/wey-gu/nebula-up æœ‰ç»éªŒçš„åŒå­¦å¯ä»¥å‚è€ƒæ–‡æ¡£è¿›è¡Œéƒ¨ç½²ï¼š è®¿é—® https://docs.nebula-graph.com.cn/ 1.2.2 OpenStack é›†ç¾¤ æ³¨æ„ï¼šå¦‚æœå¤§å®¶å·²ç»æœ‰ç°æˆçš„ OpenStack é›†ç¾¤ï¼Œè¿™ä¸€æ­¥å¯ä»¥å¿½ç•¥ï¼Œæ‚¨åªéœ€è¦å†å»å®‰è£… OpenStack Vitrage å°±å¥½äº†ã€‚ æœ¬æ–‡éœ€è¦çš„ OpenStack é›†ç¾¤æ˜¯ä¸€ä¸ªå¤šæœºçš„ç¯å¢ƒï¼Œä¸ºæ­¤ï¼Œæˆ‘å‡†å¤‡äº†åœ¨ Linux Server ä¸Šåˆ©ç”¨ Libvirt å’Œ Linux Bridge æ­å»ºå¤šä¸ªè™šæ‹Ÿæœºç”¨æ¥æ¨¡æ‹Ÿ OpenStack çš„ç‰©ç†æœºï¼Œå¾—ç›Šäº CPU çš„åµŒå¥—è™šæ‹ŸåŒ–å’Œ qemuï¼Œåè¾¹æˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨è™šæ‹Ÿæœºæ­å»ºçš„å®éªŒç¯å¢ƒä¸­æ¨¡æ‹Ÿå¯æ­£å¸¸å·¥ä½œçš„ OpenStack nova instance è™šæœºã€‚ æ•´ä¸ªæµç¨‹æˆ‘éƒ½æ”¾åœ¨ https://github.com/wey-gu/openstack-graph/#environment-setup è¿™é‡Œäº†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—®ã€è·å–ã€‚ è™šæ‹Ÿæœºæ­å»ºä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ¨¡æ‹ŸçœŸå®çš„ Infra ç¯å¢ƒï¼Œåˆ›å»ºå¾ˆå¤šèµ„æºï¼šæ•´ä¸ªè¿‡ç¨‹ä¹Ÿåœ¨ https://github.com/wey-gu/openstack-graph/#create-resources-on-openstack æœ‰è¯¦ç»†åˆ—å‡ºï¼Œæƒ³è¦åŠ¨æ‰‹æ“ä½œçš„åŒå­¦å¯ä»¥å‚è€ƒæ¥äº²è‡ªä¸Šæ‰‹ä¸€ä¸‹ã€‚ å‚è€ƒå¦‚ä¸Šæ­¥éª¤æ“ä½œä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥é€šè¿‡ Horizon Dashboard æŸ¥çœ‹é›†ç¾¤å’Œèµ„æºï¼š æˆ‘ä»¬åˆ›å»ºäº†å‡ ä¸ªè™šæ‹Ÿæœºï¼š å‡ ä¸ªç½‘ç›˜ï¼Œå…¶ä¸­å››ä¸ªæŒ‚è½½åœ¨ä¸åŒçš„è™šæ‹Ÿæœºä¸Š é›†ç¾¤ç§Ÿæˆ·çš„ç½‘ç»œæ‹“æ‰‘ï¼š æˆ‘ä»¬è¿˜èƒ½é€šè¿‡ OpenStack Vitrage çš„ API/CLI è·å¾—éƒ¨åˆ†ä¸»è¦èµ„æºçš„æ‹“æ‰‘ï¼š source openrc admin admin vitrage topology show --all-tenants å®ƒçš„ç»“æœæ˜¯ä¸€ä¸ª JSONï¼Œé‡Œè¾¹å·²ç»æŒ‰ç…§è¾¹ï¼ˆlinksï¼‰å’Œç‚¹ï¼ˆnodesï¼‰åºåˆ—åŒ–å›¾ç»“æ„çš„æ•°æ®äº†ã€‚ { \"directed\": true, \"graph\": {}, \"links\": [ { \"vitrage_is_deleted\": false, \"relationship_type\": \"contains\", \"source\": 0, \"target\": 11, \"key\": \"contains\" }, { \"vitrage_is_deleted\": false, \"relationship_type\": \"contains\", \"source\": 0, \"target\": 13, \"key\": \"contains\" }, ... { \"vitrage_is_deleted\": false, \"relationship_type\": \"attached\", \"source\": 27, \"target\": 28, \"key\": \"attached\" } ], \"multigraph\": true, \"nodes\": [ { \"id\": \"node0\", \"vitrage_type\": \"nova.host\", \"vitrage_category\": \"RESOURCE\", \"vitrage_is_deleted\": false, \"update_timestamp\": \"2023-01-13T08:06:48Z\", \"vitrage_sample_timestamp\": \"2023-01-13T08:06:49Z\", \"vitrage_is_placeholder\": false, \"vitrage_id\": \"630b4c2c-5347-4073-91a3-255ec18dadfc\", \"name\": \"node0\", \"vitrage_cached_id\": \"d043d278a6a712909e30e50ca8ec2364\", \"is_real_vitrage_id\": true, \"vitrage_aggregated_state\": \"AVAILABLE\", \"vitrage_operational_state\": \"OK\", \"vitrage_datasource_name\": \"nova.host\", \"state\": \"available\", \"graph_index\": 0 }, { \"id\": \"nova\", \"vitrage_type\": \"nova.zone\", \"vitrage_category\": \"RESOURCE\", \"vitrage_is_deleted\": false, \"vitrage_sample_timestamp\": \"2023-01-12T03:06:48Z\", \"vitrage_is_placeholder\": false, \"vitrage_id\": \"a1e9c808-dac8-4b59-8f80-f21a90e9869d\", \"vitrage_cached_id\": \"125f1d8c4451a6385cc2cfa2b0ba45be\", \"is_real_vitrage_id\": true, \"vitrage_aggregated_state\": \"AVAILABLE\", \"vitrage_operational_state\": \"OK\", \"state\": \"available\", \"update_timestamp\": \"2023-01-12T03:06:48Z\", \"name\": \"nova\", \"vitrage_datasource_name\": \"nova.zone\", \"graph_index\": 1 }, ... \"raw\": true } ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:1:2","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#openstack-é›†ç¾¤"},{"categories":["Nebula Graph"],"content":" 2 å›¾è°±å»ºæ¨¡æœ¬å®éªŒç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘çº³å…¥å¦‚ä¸‹èµ„æºè¿›å…¥å›¾è°±ï¼š nova instance: æ˜¯NovaæœåŠ¡ä¸­çš„è™šæ‹Ÿæœºå®ä¾‹ï¼Œæ¯ä¸ªnova instanceéƒ½æœ‰è‡ªå·±çš„é…ç½®ä¿¡æ¯ï¼ˆå¦‚CPUã€å†…å­˜ã€ç£ç›˜ç­‰ï¼‰ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å°±å«å®ƒ server æˆ–è€… VMã€è™šæœºã€‚ nova hostæ˜¯NovaæœåŠ¡ä¸­çš„ç‰©ç†ä¸»æœºï¼Œæ˜¯nova instanceè¿è¡Œçš„ç‰©ç†ç¯å¢ƒã€‚nova hostä¸Šé¢ä¼šè¿è¡Œnova-computeæœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡è´Ÿè´£ç®¡ç†å’Œè°ƒåº¦nova instanceã€‚nova hostä¸Šé¢è¿˜å¯èƒ½è¿è¡Œå…¶ä»–æœåŠ¡ï¼Œå¦‚ç½‘ç»œæœåŠ¡ç­‰ã€‚ nova keypair: æ˜¯NovaæœåŠ¡ä¸­çš„å¯†é’¥å¯¹ï¼Œç”¨äºè®¿é—®nova instance cinder volume: æ˜¯CinderæœåŠ¡ä¸­çš„äº‘å­˜å‚¨å·ï¼Œå¯ä»¥ attach åˆ°nova instanceä¸Šåšä¸ºç¡¬ç›˜ cinder snapshot: æ˜¯CinderæœåŠ¡ä¸­çš„äº‘å­˜å‚¨å¿«ç…§ï¼Œå¯ä»¥åœ¨cinder volumeä¸Šåšå¿«ç…§ glance image: æ˜¯GlanceæœåŠ¡ä¸­çš„é•œåƒï¼Œå¯ä»¥ä½œä¸ºåˆ›å»ºnova instanceæ—¶å€™çš„å¯åŠ¨ç¡¬ç›˜ neutron network: æ˜¯NeutronæœåŠ¡ä¸­çš„ç½‘ç»œï¼Œå¯ä»¥ç”¨äºé…ç½®nova instanceçš„ç½‘ç»œè¿æ¥ neutron port: æ˜¯NeutronæœåŠ¡ä¸­çš„ç«¯å£ï¼Œç”¨æ¥è¿æ¥nova instanceå’Œneutron networkä¹‹é—´ï¼Œåœ¨ nova instance è™šæ‹Ÿæœºä¸Šï¼Œä¸€ä¸ª port å¸¸å¸¸å¯¹åº”ä¸€ä¸ªç½‘å¡ï¼ˆå¦‚æœä¸æ˜¯ trunk port çš„è¯ï¼‰ã€‚ ä»–ä»¬ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼š ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:2:0","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#å›¾è°±å»ºæ¨¡"},{"categories":["Nebula Graph"],"content":" 3 åŸºç¡€è®¾æ–½å›¾ ETLæ¥ä¸‹æ¥æˆ‘ä»¬è§£å†³ä»åŸºç¡€è®¾æ–½ä¸­æŠ½å–èµ„æºå…ƒæ•°æ®çš„é—®é¢˜ï¼Œ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:3:0","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#åŸºç¡€è®¾æ–½å›¾-etl"},{"categories":["Nebula Graph"],"content":" 3.1 push æ¨¡å¼è¿™é‡Œçš„ push æŒ‡çš„æ˜¯åŸºç¡€è®¾æ–½ä¸ºä¸»è¯­ï¼Œä»èµ„æºæ–¹å‘æˆ‘ä»¬çš„å›¾è°±ç³»ç»Ÿä¸»åŠ¨ã€äº‹ä»¶é©±åŠ¨åœ°å‘å‡ºèµ„æºå˜åŠ¨çš„ä¿¡æ¯ã€‚å®ƒçš„å¥½å¤„æ˜¯èµ„æºä¸­çš„å®æ—¶æ€§å¥½ï¼Œä½†æ˜¯åå¤„æ˜¯ä¾èµ–åŸºç¡€è®¾æ–½è‡ªèº«ï¼Œå¾ˆå¤šéå¸¸ç˜¦çš„ã€è½¯ä»¶å®šä¹‰/å¯ç¼–ç¨‹ç¨‹åº¦ä¸é«˜çš„ç»„ä»¶ã€æ¯”å¦‚æŸäº›ç¡¬ä»¶è®¾å¤‡æ²¡æœ‰ push æœºåˆ¶ï¼Œæˆ–è€…åƒæ˜¯å¤è€çš„è½¯ä»¶ç³»ç»Ÿä¸ä¸€å®šèƒ½å­˜åœ¨ push çš„æ¥å£ï¼Œæ”¹é€ èµ·æ¥æœ‰ä¾µå…¥æ€§ã€‚ å‰è¾¹æåŠè¿‡ï¼ŒOpenStack è‡ªèº«æ˜¯å­˜åœ¨ Push hook çš„æœºåˆ¶çš„ï¼Œå®ƒçš„å­é¡¹ç›® vitrage å°±åˆ©ç”¨è¿™ä¸ªæœºåˆ¶å¾ˆä¼˜é›…åœ°æ”¶é›†ç³»ç»Ÿèµ„æºã€å‘Šè­¦ç­‰ä¿¡æ¯è¿›å…¥å›¾ä¸­ï¼Œç±»ä¼¼çš„æœºåˆ¶åœ¨å…¶ä»–å¹³å°ä¸­ä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ã€‚ æœ¬å®éªŒä¸­æˆ‘ä»¬å°±åˆ©ç”¨ vitrage çš„æœºåˆ¶å»æ”¶é›†ä¸€éƒ¨åˆ†å›¾è°±ä¸­çš„èµ„æºä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ï¼Œå¯ä»¥çœ‹åˆ° vitrage ä¼šåœ¨ OpenStack message bus ä¸­è®¢é˜… nova/cinder/neutron ç­‰æœåŠ¡ä¸­çš„èµ„æºæ—¶é—´ï¼ŒæŠŠäº‹ä»¶ä¼ å…¥ Entity Queueï¼Œç»è¿‡å¤„ç†ï¼Œå­˜å‚¨åˆ° Entity Graph ä¸­ã€‚ åœ¨æ­¤ä¹‹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ vitrage API è·å–å›¾è°±çš„æ‹“æ‰‘ï¼Œæ¥æ¶ˆè´¹å®ƒã€‚ æ³¨æ„ï¼šå®é™…ä¸Š Vitrage æœåŠ¡è¿˜æä¾›äº†æ¨ç†å‘Šè­¦ã€æ¨ç†çŠ¶æ€ã€å®šä¹‰å†³ç­–äº‹ä»¶çš„èƒ½åŠ›ï¼Œè¿™é‡Œæˆ‘ä»¬å¹¶æ²¡æœ‰é‡‡ç”¨ï¼Œåè¾¹æˆ‘ä»¬åœ¨å›¾ä¸Šåšçš„ä¸€äº›äº‹æƒ…ç”šè‡³è¿˜å’Œå®ƒçš„èƒ½åŠ›æœ‰ä¸€äº›é‡å ã€‚ è¿™é‡Œæˆ‘åªæ˜¯ç”¨å®ƒæ¥å±•ç¤º push æ¨¡å¼çš„å·¥ä½œæœºåˆ¶ï¼Œå¦‚æœæ²¡æœ‰ Virtrage è¿™ä¸ªé¡¹ç›®å­˜åœ¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ¯”è¾ƒå®¹æ˜“é€šè¿‡ OpenStack çš„ oslo.messaging è¿™ä¸ªåº“å¾ˆå®¹æ˜“å†™å‡ºåœ¨ Message Busï¼ˆå¯èƒ½æ˜¯ Kafka, RabbitMQ ç­‰ä¸åŒåº•å±‚å®ç°ï¼‰ä¸Šè®¢é˜…èµ„æºæ—¶é—´çš„åº”ç”¨ï¼Œç„¶åæŠŠäº‹ä»¶é€šè¿‡ Flink/ Kafka/ Pulsar ç­‰æ–¹å¼æ¥é©³ NebulaGraphã€‚ å› ä¸º Vitrage çš„å­˜åœ¨ï¼Œæˆ‘å°±å·æ‡’ä¸ç”¨å»å®ç°è¿™éƒ¨åˆ†é€»è¾‘ï¼Œåªæ¶ˆå†™ä¸€å°éƒ¨åˆ†ä»£ç è°ƒç”¨ Vitrage API å–è¿™ä¸ªæ•°æ®å°±å¯ä»¥äº†ï¼Œè®½åˆºçš„æ˜¯ï¼Œä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œè¿™å…¶å®æ˜¯ä¸€ç§ pull çš„æ¨¡å¼äº†ï¼Œä¸ç”¨æ‹˜æ³¥å®ƒæœ¬è´¨ä¸Šç®—æ˜¯å“ªä¸€ç§æ–¹å¼ï¼Œè‡³å°‘åœ¨èµ„æºå‘èµ·æµ‹ï¼Œæˆ‘ä»¬æŠŠå®ƒå½“åš push æ¨¡å¼çš„ä¾‹å­çœ‹å¾…å§ã€‚ è¿™éƒ¨åˆ†ä» Vitrage æŠ“å–çš„ä»£ç æˆ‘æ”¾åœ¨ https://github.com/wey-gu/openstack-graph/blob/main/utils/vitrage_to_graph.py äº†ï¼Œè°ƒç”¨æ–¹å¼å¾ˆç®€å•ï¼Œåœ¨æœ‰ OpenStack å®¢æˆ·ç«¯çš„ç¯å¢ƒä¸­ï¼Œæ‰§è¡Œå®ƒå°±å¯ä»¥äº†ï¼Œæ¯”å¦‚ï¼š # è¿åˆ° node0 ä¸Š ssh stack@node0_ip # è¿›å…¥ devstack ç›®å½• cd devstack # ä¸‹è½½ vitrage ä¸­å›¾æ•°æ®ï¼Œè§£æä¸º NeublaGraph DML/DQL çš„å·¥å…· wget https://raw.githubusercontent.com/wey-gu/openstack-graph/main/utils/vitrage_to_graph.py # æ‰§è¡Œå®ƒ python3 vitrage_to_graph.py æ‰§è¡Œä¹‹åï¼Œä¼šç”Ÿæˆå¦‚ä¸‹æ–‡ä»¶ï¼š schema.ngql å›¾æ•°æ®çš„ Schema å®šä¹‰ vertices/ ç‚¹æ•°æ®çš„æ–‡ä»¶å¤¹ edges/ è¾¹æ•°æ®çš„æ–‡ä»¶å¤¹ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:3:1","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#push-æ¨¡å¼"},{"categories":["Nebula Graph"],"content":" 3.2 pull æ¨¡å¼åè¿‡æ¥ï¼Œpull æ¨¡å¼æ˜¯ä»èµ„æºå¤–éƒ¨å®šæœŸæˆ–è€…äº‹ä»¶é©±åŠ¨åœ°æ‹‰å–èµ„æºï¼Œå­˜å…¥å›¾è°±çš„æ–¹å¼ã€‚åˆšå¥½æœ¬å®éªŒä¸­ vitrage æŠ“å–çš„èµ„æºæ˜¯æœ‰é™çš„ï¼Œæœ‰ä¸€äº›é¢å¤–çš„èµ„æºæˆ‘å•ç‹¬å†™äº† python çš„ä»£ç æ¥ä¸»åŠ¨å…¨é‡æŠ“å–ï¼Œpull æ¨¡å¼çš„å¥½å¤„æ˜¯å¯¹èµ„æºæ–¹æ²¡æœ‰ä»»ä½•ä¾µå…¥æ€§ï¼Œåªéœ€è¦è°ƒç”¨å®ƒçš„æ¥å£è·å–ä¿¡æ¯å°±å¯ä»¥äº†ï¼Œåå¤„åˆ™æ˜¯æœ‰çš„ç³»ç»Ÿä¸å¤ªå®¹æ˜“è·å¾—å¢é‡å˜åŒ–ï¼Œå¯èƒ½åªèƒ½å…¨é‡å»å–ã€‚ è¿™éƒ¨åˆ†æˆ‘æŠ“å–çš„å…³ç³»å¦‚ä¸‹ï¼š glance_used_by: image -[:used_by]-\u003e instance (get from instance) glance_created_from: image -[:created_from]-\u003e volume (get from image) nova_keypair_used_by: keypair -[:used_by]-\u003e instance (get from instance) cinder_snapshot_created_from: volume snapshot -[:created_from]-\u003e volume (get from snapshot) cinder_volume_created_from: volume -[:created_from]-\u003e volume snapshot (get from volume) cinder_volume_created_from: volume -[:created_from]-\u003e image (get from volume) ç±»ä¼¼çš„ï¼Œå®ƒçš„ä»£ç æ”¾åœ¨ https://github.com/wey-gu/openstack-graph/blob/main/utils/pull_resources_to_graph.py ä¹‹ä¸­ï¼Œåœ¨çœŸå®åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç”¨ Apache Airflowã€dagster ç”šè‡³æ˜¯ cron job ç­‰æ–¹å¼å®šæœŸæ‰§è¡Œå®ƒã€‚ æˆ‘ä»¬æ‰‹åŠ¨æ‰§è¡Œçš„æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼š # è¿åˆ° node0 ä¸Š ssh stack@node0_ip # è¿›å…¥ devstack ç›®å½• cd devstack # ä¸‹è½½æŠ“å– OpenStack èµ„æºï¼Œç”Ÿæˆ NeublaGraph DML/DQL çš„å·¥å…· wget https://raw.githubusercontent.com/wey-gu/openstack-graph/main/utils/pull_resources_to_graph.py.py # æ‰§è¡Œå®ƒ python3 pull_resources_to_graph.py æ‰§è¡Œä¹‹åï¼Œä¼šç”Ÿæˆç‚¹ã€è¾¹çš„ ngql è¯­å¥åœ¨ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼š vertices/ ç‚¹æ•°æ®çš„æ–‡ä»¶å¤¹ edges/ è¾¹æ•°æ®çš„æ–‡ä»¶å¤¹ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:3:2","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#pull-æ¨¡å¼"},{"categories":["Nebula Graph"],"content":" 3.3 åŠ è½½æ•°æ®åˆ° NebulaGraphæˆ‘ä»¬åªéœ€è¦åœ¨ NebulaGraph Studio Console, Explorer Console æˆ–è€… NebulaGraph å‘½ä»¤è¡Œ Console ä¸­æ‰§è¡Œä¸Šè¾¹ç”Ÿæˆçš„ .ngql æ–‡ä»¶å°±å¥½äº†ï¼š # DDL from vitrage cat schema.ngql # DDL and DML for both push and pull mode data cat edges/*.ngql cat vertices/*.ngql ä¹‹åï¼Œåœ¨ NebulaGraph ä¸­æˆ‘ä»¬ä¼šæœ‰ä¸€ä¸ªå«åš openstack çš„å›¾ç©ºé—´ï¼Œç”¨è¿™ä¸ªæŸ¥è¯¢å¯ä»¥æŸ¥åˆ°æ‰€æœ‰æ•°æ®ï¼š MATCH (n) WITH n LIMIT 1000 OPTIONAL MATCH p=(n)--() RETURN p, n ç„¶åæ¸²æŸ“åœ¨ explorer ä¸­ï¼Œæ‰‹åŠ¨è®¾ç½®ä¸€ä¸‹æ•°æ®çš„å›¾æ ‡ï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ OpenStack é›†ç¾¤é‡Œçš„æ‰€æœ‰ç§Ÿæˆ·çš„èµ„æºå›¾äº†ï¼š æ¥ä¸‹æ¥æˆ‘ä»¬ç»ˆäºå¯ä»¥åœ¨å›¾ä¸Šçœ‹çœ‹æœ‰æ„æ€çš„æ´å¯Ÿäº†ã€‚ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:3:3","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#åŠ è½½æ•°æ®åˆ°-nebulagraph"},{"categories":["Nebula Graph"],"content":" 4 åŸºäºå›¾è°±çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹ä½œä¸ºé SREã€DevOps äººå‘˜ï¼Œæˆ‘å°è¯•è—‰ç”±è‡ªå·±åœ¨ OpenStack å’Œå›¾æŠ€æœ¯çš„ç†è§£æƒ³è±¡å‡ºä¸‹è¾¹çš„ä¸€äº›å®ä¾‹ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°éœ€è¦çš„è¯»è€…ä»¬ã€‚ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:0","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#åŸºäºå›¾è°±çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹"},{"categories":["Nebula Graph"],"content":" 4.1 å‘Šè­¦ã€çŠ¶æ€çš„æ¨ç†ä¸ä¼ å¯¼è¿™éƒ¨åˆ†æˆ‘æ”¶åˆ°äº† vitrage é¡¹ç›®çš„å¯å‘ï¼Œå‚è€ƒå®ƒä»¬ç»™å‡ºçš„å®ä¾‹æ–‡æ¡£ï¼šè¿™é‡Œã€‚ å€ŸåŠ©èµ„æºå›¾è°±å®æ—¶å›¾æŸ¥è¯¢ã€å›¾è®¡ç®—ç”šè‡³å›¾å¯è§†åŒ–èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å›¾ä¸Šæ¨ç†ã€ä¼ å¯¼ä¸€äº›ä¿¡æ¯ï¼ŒæŠŠé‡è¦çš„æ—¶é—´è—‰ç”±å›¾ä¸Šç»„ç»‡å¥½çš„çŸ¥è¯†åˆ†å‘åˆ°éœ€è¦æ”¶åˆ°é€šçŸ¥çš„äººã€ç»„ç»‡ã€ç³»ç»Ÿã€‚ ä¸€ä¸ªç®€å•çš„ä¾‹å­æ˜¯ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ nova hostï¼ˆè™šæ‹Ÿæœºçš„å®¿ä¸»æœºã€hypervisor æœºå™¨ï¼Œä»¥ä¸‹ç®€ç§°å®¿ä¸»æœºï¼‰ï¼Œä¸­è·å¾—äº†ä¸€ä¸ªå‘Šè­¦ã€äº‹ä»¶çš„æ—¶å€™ï¼Œå¯èƒ½æ˜¯ç½‘å¡å¤±è´¥ã€ç‰©ç†ç¡¬ç›˜é¢„è­¦ã€CPUå ç”¨è¿‡é«˜ä¹‹ç±»çš„å‘Šè­¦ã€‚æˆ‘ä»¬å¯ä»¥å€ŸåŠ©å›¾è°±æŸ¥è¯¢è·å¾—æ‰€æœ‰ç›¸å…³è”çš„è™šæœºï¼Œç„¶åæŠŠï¼ˆWARNï¼‰çº§åˆ«çš„å‘Šè­¦å‘å‡ºå»æˆ–è€…è®¾ç½®å®ƒä»¬ä¸ºï¼ˆäºšå¥åº·ï¼‰çš„çŠ¶æ€ã€‚ è¿™æ ·ï¼Œè·å¾—é€šçŸ¥çš„å¯¹è±¡ï¼Œå¾€å¾€æ˜¯ä¸€äº›ç”¨æˆ·çš„ç³»ç»Ÿï¼Œå°±å¯ä»¥æ ¹æ®ä»–ä»¬é¢„å…ˆå®šä¹‰å¥½çš„ç­–ç•¥åšä¸€äº›è‡ªåŠ¨åŒ–è¿ç»´ï¼Œæˆ–è€…é€šçŸ¥çš„ hookï¼š æ”¶åˆ°â€œå®¿ä¸»æœº CPU è¿‡é«˜â€çš„å‘Šè­¦çš„æƒ…å½¢ä¸‹ï¼Œå¯ä»¥æ ¹æ®ç”¨æˆ·è‡ªå·±è®¾å®šçš„ä¸åŒç­–ç•¥æŠŠè™šæœºè¿ç§»èµ°ï¼Œæˆ–è€…æ›´é«˜çº§å¤æ‚çš„æ’¤ç¦»æ–¹å¼ï¼ˆå¼€å§‹ä¸æ¥å—æ–°çš„ trafficï¼Œåˆ›å»ºæ–°çš„æ›¿ä»£ workloadï¼Œç„¶å gracefully å…³é—­è¿™ä¸ª workloadï¼‰ â€œæ§åˆ¶é¢ç½‘ç»œæ•…éšœâ€å‘Šè­¦æƒ…å†µä¸‹ï¼Œè¿™æ—¶å€™å¾€å¾€æ— æ³•æˆåŠŸè¿›è¡Œä¸»æœºçš„è½¦é‡Œã€è¿ç§»ï¼Œæ•…å¯ä»¥è€ƒè™‘è§¦å‘å¤‡ä»½ä¸»æœºã€å¯åŠ¨æ–° workloadã€å…³æœº å…¶ä»–â€œï¼ˆäºšå¥åº·ï¼‰çŠ¶æ€â€ï¼Œå¯ä»¥ä½œä¸ºè´Ÿè½½å±‚é¢å‡ºé—®é¢˜çš„æ ¹å› åˆ†æï¼ˆRCAï¼‰ä¾æ® ä¸‹è¾¹ï¼Œæˆ‘ä»¬ç»™å‡ºä¸€ä¸ªåœ¨å›¾è°±ä¸Šè¿›è¡Œå‘Šè­¦ã€çŠ¶æ€ä¼ å¯¼çš„æŸ¥è¯¢ä¾‹å­ï¼Œæˆ‘ä»¬å‡è®¾ vid ä¸º node0 çš„å®¿ä¸»æœºå‡ºç°äº†é«˜ CPU çš„å‘Šè­¦ï¼Œåˆ™è¿™ä¸ªæŸ¥è¯¢å¯ä»¥å¾—åˆ°æ‰€æœ‰å…¶ä¸Šçš„è™šæœºï¼Œè·å¾—æ—¶é—´ã€å‘Šè­¦é€šçŸ¥åˆ—è¡¨ï¼š MATCH (vm:nova_instance)\u003c-[:`contains`]-(host_CPU_high:nova_host) WHERE id(host_CPU_high) == \"node0\" RETURN vm.nova_instance.name AS VM_to_raise_CPU_alarms è¿™å…¶ä¸­æŸ¥è¯¢çš„å›¾æ¨¡å¼æ˜¯ä» host_CPU_high è¿™ä¸ª nova_host å‘å¤–ç»ç”± contains è¿™ä¸ªå…³ç³»æŒ‡å‘ vm è¿™ä¸ª nova_instance çš„ï¼š (vm:nova_instance)\u003c-[:`contains`]-(host_CPU_high:nova_host) å®ƒçš„ç»“æœæ˜¯ï¼š VM_to_raise_CPU_alarms server-4 server-3 server-1 server-0 å¦‚æœæˆ‘ä»¬æŠŠæŸ¥è¯¢æ”¹åŠ¨ä¸€ä¸‹ï¼Œé€‰æ‹©è¾“å‡ºå…¨è·¯å¾„ï¼Œåˆ™å¯ä»¥çœ‹åˆ°è¿™ä¸ªä¿¡æ¯ä¼ å¯¼çš„æ–¹å‘ï¼š MATCH p=(vm:nova_instance)\u003c-[:`contains`]-(host_CPU_high:nova_host) WHERE id(host_CPU_high) == \"node0\" RETURN p åœ¨ Explorer ä¸­æ¸²æŸ“ï¼Œç‚¹å‡» N è·³æ£€æµ‹ï¼š ç¬¬ä¸€ä¸ªä¾‹å­æ¯”è¾ƒç®€å•ï¼Œç”šè‡³ä¸æ˜¯å¾ˆæœ‰å¿…è¦ç”¨å›¾çš„èƒ½åŠ›ï¼ˆè¿™ç§å› ä¸ºä¸€è·³æŸ¥è¯¢è¡¨ç»“æ„ä¸­ä¹Ÿæ˜¯å¾ˆè½»æ¾åœ°ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸¤ä¸ª nova API call å°±å¯ä»¥æå®šç­‰ä»·çš„ä¿¡æ¯è·å–äº†ï¼‰ï¼Œè¿™é‡Œåªæ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨å›¾ä¸Šå¯ä»¥åšå¾ˆå¤šæ›´ Graphyï¼ˆå…·æœ‰å›¾å±æ€§çš„ï¼‰ã€å¤æ‚ã€ç‹¬ç‰¹çš„å·¥ä½œï¼Œæˆ‘ä»¬æ…¢æ…¢æ¥çœ‹ã€‚ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:1","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#å‘Šè­¦çŠ¶æ€çš„æ¨ç†ä¸ä¼ å¯¼"},{"categories":["Nebula Graph"],"content":" 4.2 ç½‘ç»œå¯è¾¾æ£€æµ‹æˆ‘ä»¬æ¥è€ƒè™‘è¿™æ ·çš„åœºæ™¯ï¼Œåœ¨ OpenStack ä¸­ï¼Œä¸åŒçš„ä¸»æœºå¯ä»¥è¿æ¥åˆ°ç›¸åŒçš„å­ç½‘ï¼ˆVPCï¼‰ï¼Œä¸»æœºä¹Ÿå¯ä»¥è¿æ¥åˆ°å¤šä¸ªå­ç½‘ä¹‹ä¸­ï¼Œè¿™æ ·ï¼Œä¸»æœºä¹‹é—´çš„ç½‘ç»œè¿é€šæ€§ä¿¡æ¯ã€ä¸ç½‘ç»œè”é€šç›¸å…³çš„æ¨ç†ã€ä¼ å¯¼éƒ½å¯ä»¥åœ¨å›¾ä¸Šè¿›è¡Œã€‚ æ³¨ï¼šåœ¨çœŸå®ä¸–ç•Œä¸­ï¼Œè¿™é‡Œå¯èƒ½è¿˜è¦è€ƒè™‘ Security Groupã€Routerã€Switch ç­‰å› ç´ ï¼Œæœ¬åˆ©ä¸­æˆ‘ä»¬ç”¨åˆ°çš„ OpenStack æ˜¯ L2 only çš„ Setupï¼Œæ¯”è¾ƒç®€åŒ–ã€‚ è·å¾—ä¸è™šæœº server_a åŒä¸€ VPC çš„æ‰€æœ‰å…¶ä»–è™šæœºçœ‹èµ·æ¥å¾ˆå®¹æ˜“è¡¨è¾¾äº†ï¼š MATCH (server_a)--(:neutron_port)--(:neutron_network)--(:neutron_port)--(server_b:`nova_instance`) WHERE id(server_a) == \"server-0\" RETURN server_b.nova_instance.name AS L2_connected_server ç»“æœå¦‚ä¸‹ï¼š L2_connected_server server-1 çœ‹èµ·æ¥å¾ˆåˆçº§å‘€ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†æŸ¥è¯¢ä¸è™šæœº server_a åŒä¸€ VPCã€æˆ–è€…æœ‰å¯èƒ½é€šè¿‡è·¨ç½‘ç»œè™šæœºè€Œäº’è”çš„ä¸»æœºçš„æ‰€æœ‰å…¶ä»–è™šæœºï¼Œè¿™æ—¶å€™ï¼Œæˆ‘ä»¬é™¤äº†å…±äº« neutron network(VPC) çš„æƒ…å†µï¼Œè¿˜è¦æŸ¥è¯¢æ‰€æœ‰äºŒå±‚ç›´è¿çš„è™šæœºå¯èƒ½é€šè¿‡å…¶ä»– VPC è¿å‡ºå»çš„çš„è™šæœºï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ç”¨åˆ°äº† OPTIONAL MATCH çš„è¡¨è¾¾ï¼Œè¡¨ç¤ºå¯èƒ½åŒ¹é…åˆ°çš„æ¨¡å¼ï¼š MATCH (server_a)--(:neutron_port)--(net:neutron_network)--(:neutron_port)--(server_b:`nova_instance`) WHERE id(server_a) == \"server-0\" OPTIONAL MATCH (server_b)--()--(other_net:neutron_network)--(:neutron_port)--(server_c:`nova_instance`) WITH server_a, server_b AS same_subnet_machines, server_c AS routeable_machines WHERE routeable_machines != server_a RETURN same_subnet_machines.nova_instance.name AS L2_connected_server, routeable_machines.nova_instance.name AS cross_vpc_server å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼Œè·¨ç½‘ç»œæ½œåœ¨çš„ç›¸è¿ä¸»æœºè¿˜æœ‰ server-3ï¼š L2_connected_server cross_vpc_server server-1 server-3 æˆ‘ä»¬å°†å…¶å¯è§†åŒ–ï¼ŒåŒæ ·ï¼Œä¿®æ”¹è¾“å‡ºä¸ºè·¯å¾„ p å’Œ p1ã€‚ MATCH p=(server_a)--(:neutron_port)--(net:neutron_network)--(:neutron_port)--(server_b:`nova_instance`) WHERE id(server_a) == \"server-0\" OPTIONAL MATCH p1=(server_b)--()--(other_net:neutron_network)--(:neutron_port)--(server_c:`nova_instance`) RETURN p, p1 å®ƒå¯èƒ½çš„è¿æ¥è·¯å¾„ä¸€ç›®äº†ç„¶ æœ‰äº†è·å¾—è¿™äº›ä¿¡æ¯çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥å¯ç¼–ç¨‹åœ°è¿æ¥å‘Šè­¦ã€çŠ¶æ€ã€å®‰å…¨é£æ§ã€ç½‘ç»œç­‰æ–¹æ–¹é¢é¢ç³»ç»Ÿäº†ï¼Œå› ä¸ºè¿™ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œè¿™é‡Œå°±ä¸åŠ ä»¥èµ˜è¿°äº†ï¼Œæ¬¢è¿å¤§å®¶æ¥ NebulaGraph ç¤¾åŒºåˆ†äº«ä½ ä»¬çš„å›¾æ´å¯Ÿä½¿ç”¨æ–¹å¼ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹å­˜å‚¨ç›¸å…³çš„ä¾‹å­ã€‚ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:2","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#ç½‘ç»œå¯è¾¾æ£€æµ‹"},{"categories":["Nebula Graph"],"content":" 4.3 é•œåƒã€äº‘ç›˜ã€å¿«ç…§çš„è¡€ç¼˜åœ¨åŸºç¡€è®¾æ–½ä¸­ï¼Œäº‘ç›˜ï¼ˆiSCSIã€Cephã€NFSï¼‰ã€é•œåƒã€å¿«ç…§ä¹‹é—´æœ‰å¤šé‡å¤æ‚çš„å…³ç³»ï¼Œæ¯”å¦‚ï¼š ä¸€ä¸ªç³»ç»Ÿé•œåƒå¯èƒ½ä»æŸä¸€ä¸ªè™šæ‹ŸæœºæŒ‚è½½çš„äº‘ç›˜æˆ–è€…ä¸€ä¸ªå¿«ç…§åˆ›å»º ä¸€ä¸ªäº‘ç›˜å¯èƒ½æ˜¯ä»ä¸€ä¸ªç³»ç»Ÿé•œåƒã€ä¸€ä¸ªå¿«ç…§æˆ–è€…å¦ä¸€ä¸ªäº‘ç›˜åˆ›å»º ä¸€ä¸ªå¿«ç…§æ˜¯ä»ä¸€ä¸ªäº‘ç›˜åˆ›å»ºçš„ è¿™ç§è¡€ç¼˜ä¿¡æ¯çš„è¯†åˆ«å’Œç®¡ç†æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ä¸‹è¾¹çš„æŸ¥è¯¢å¯ä»¥è·å¾—ç»™å®šçš„è™šæœº server-0 çš„æ‰€æœ‰å­˜å‚¨è¡€ç¼˜ï¼š MATCH p=(server_a)-[:`attached`|created_from|used_by]-(step1) WHERE id(server_a) == \"server-0\" OPTIONAL MATCH p1=(step1)-[:created_from*1..5]-(step2) RETURN p, p1 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœä¸­ï¼š server-0 çš„å¯åŠ¨é•œåƒï¼ˆè¿™é‡Œå®ƒæ˜¯ä»æœ¬åœ°ç›˜å¯åŠ¨çš„ï¼Œæ²¡æœ‰æŒ‚è½½äº‘ç›˜ï¼‰æ˜¯ä» volume-1 åˆ›å»ºçš„ volume-1 æ˜¯ä» cirros-0.5.2-x86_64-disk è¿™ä¸ªé•œåƒåˆ›å»ºçš„ æ­¤å¤–ï¼Œè¿˜æœ‰å…¶ä»–æœ‰åˆ†å‰å…³ç³»çš„å­˜å‚¨èµ„æºå’Œä»–ä»¬ä¹Ÿæ¯æ¯ç›¸å…³ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸åªè€ƒè™‘å­˜å‚¨èµ„æºï¼Œå†çœ‹çœ‹æ¶‰åŠäº‘ç›˜ï¼ˆcinder_volumeï¼‰æŒ‚è½½ï¼ˆattachedï¼‰è¿™å±‚å…³ç³»ä¸‹çš„è¡€ç¼˜å…³ç³»ï¼š MATCH p=(server_a)-[:`attached`|created_from|used_by]-(step1) WHERE id(server_a) == \"server-4\" OPTIONAL MATCH p1=(step1)-[:created_from|attached*1..5]-(step2) RETURN p, p1 è¿™æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥ä»æ¸²æŸ“å›¾ä¸­è¯»å‡ºè¿™æ ·çš„æ´å¯Ÿï¼š server-4 çš„å¯åŠ¨é•œåƒï¼ˆè¿™é‡Œå®ƒæ˜¯ä»æœ¬åœ°ç›˜å¯åŠ¨çš„ï¼‰æ˜¯ä» volume-1 åˆ›å»ºçš„ è€Œ volume-1 ç°åœ¨æŒ‚è½½åœ¨ server-6 ä¸Š volume-1 æ˜¯ä» cirros-0.5.2-x86_64-disk è¿™ä¸ªé•œåƒåˆ›å»ºçš„ åŒæ · cirros-0.5.2-x86_64-disk é•œåƒè¢«å¾ˆå¤šå…¶ä»–è™šæœºåœ¨é‡‡ç”¨ server-4 åŒæ—¶æŒ‚è½½äº†æ•°æ®ç›˜ volume-2 è€Œ volume-2 æ˜¯ä¸€ä¸ªå¤šæŒ‚è½½çš„ç›˜ï¼Œå®ƒåŒæ—¶æŒ‚è½½åœ¨ server-3 ä¹‹ä¸Š server-3 çš„ç³»ç»Ÿå¯åŠ¨ç›˜æ˜¯ä»å¿«ç…§ snapshot-202301111800-volume-1 å…‹éš†åˆ›å»ºçš„ å¿«ç…§ snapshot-202301111800-volume-1 æ˜¯æ›¾ç»ä» volume-1 åˆ›å»ºçš„ volume-1 ç°åœ¨æŒ‚è½½åœ¨ server-6 ä¸Š å¿«ç…§ä¸ä¸€å®šæ˜¯ä» server-6 è€Œæ¥ï¼Œå› ä¸ºé•œåƒå¯èƒ½è¢«é‡æ–°æŒ‚è½½è¿‡ è€Œè¿™äº›è¡€ç¼˜ä¿¡æ¯å¯ä»¥è¢«ç”¨åœ¨èµ„æºç”Ÿå‘½å‘¨æœŸç®¡ç†ã€æ ¹å› åˆ†æã€å®‰å…¨å‘Šè­¦ã€çŠ¶æ€ä¼ å¯¼ä¸Šï¼Œè¿™é‡Œä¸åŠ ä»¥èµ˜è¿°ã€‚ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:3","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#é•œåƒäº‘ç›˜å¿«ç…§çš„è¡€ç¼˜"},{"categories":["Nebula Graph"],"content":" 4.4 é«˜ç›¸å…³æ€§è™šæœºé¢„è­¦ä¸‹é¢å†ç»™ä¸€ä¸ªèŠ‚ç‚¹ç›¸ä¼¼åº¦çš„åº”ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¨å›¾æˆ–è€…å­å›¾ä¸Šï¼Œåˆ©ç”¨å›¾ç®—æ³•æ‰¾åˆ°ä¸ä¸€ä¸ªè™šæœºåœ¨å›¾ä¸Šå…³ç³»çš„ç»´åº¦ä¸Šæœ€ç›¸ä¼¼çš„å…¶ä»–è™šæœºï¼ŒåŸºäºåœ¨è¿™ç§ç›¸å…³æ€§å¢åŠ æ–°çš„å…³ç³»ï¼Œå¹¶åœ¨å…³ç³»ä¸Šåšé£é™©äº‹ä»¶é¢„è­¦ã€‚ è¿™æ¬¡çš„å›¾ç®—æ³•åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸€ä¸ªå…¸å‹çš„ä»[å¿«é€Ÿå­å›¾éªŒè¯]åˆ°[å…¨å›¾ç”Ÿäº§åº”ç”¨çš„]å·¥ä½œæµã€‚ 4.4.1 åœ¨å­å›¾ä¸Šå¿«é€ŸéªŒè¯ï¼šæµè§ˆå™¨å†…ç®—æ³•é¦–å…ˆï¼Œæˆ‘ä»¬è¯•ç€ä» server-0 çš„ä¸‰åº¦å­å›¾ä¸Šåšç®—æ³•çš„éªŒè¯ã€‚ GET SUBGRAPH 3 STEPS FROM \"server-0\" YIELD VERTICES AS nodes, EDGES AS relationships; å°†ç»“æœæ¸²æŸ“åœ¨ç”»å¸ƒä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å­å›¾ä¸­åŒ…å«äº†å…¶ä»–å‡ ä¸ªè™šæœºï¼š ç„¶åï¼Œæˆ‘ä»¬åˆ©ç”¨ explorer ä¸­çš„æµè§ˆå™¨å†…å›¾ç®—æ³•ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ Jaccard SImilarity ç›¸ä¼¼æ€§ç®—æ³•ï¼Œè¿›è¡Œ server-0 ä¸ server-1,server-3,server-4,server-6 è¿­ä»£åˆ†åˆ«å¾—åˆ°ç›¸ä¼¼æ€§ï¼š å¯ä»¥çœ‹å‡ºï¼Œåœ¨ 3 æ­¥å­å›¾å†…ï¼Œå’Œ server-0 æœ€è¿‘æ¥çš„è™šæœºæ˜¯ server-4ã€‚è¿›ä¸€æ­¥æˆ‘ä»¬å¯ä»¥ç®€å•åœ¨å­å›¾ä¸Šçœ‹çœ‹ä¸¤è€…ä¹‹é—´çš„è·¯å¾„ä½œä¸ºç›¸ä¼¼æ€§çš„è§£é‡Šï¼š åœ¨è¿™ä¸ªå¯è§£é‡Šç»“æœä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ server-0 ä¸ server-4 ç›¸ä¼¼çš„åŸå› å¯èƒ½æ˜¯ï¼š åè½åœ¨åŒä¸€ä¸ªå®¿ä¸»æœºï¼šnode-0 ä½¿ç”¨åŒä¸€ä¸ªé•œåƒï¼šcirros_mod_from_volume-1 å¦‚æ­¤ï¼Œæˆ‘ä»¬æœ€ç»ˆè½åœ°çš„é¢„è­¦æœºåˆ¶å¯èƒ½æ˜¯ï¼Œå½“ server-0 å‡ºç°æŸä¸€é—®é¢˜ã€å‘Šè­¦æ—¶å€™ï¼Œç»™ç›¸ä¼¼çš„ server-4 ä¹Ÿè®¾å®šé¢„è­¦ï¼Œé¢„è­¦ç†ç”±å°±æ˜¯å®ƒä»¬åœ¨åŒæ ·ä¸»æœºã€åŒæ ·é•œåƒã€‚ 4.4.2 è½åœ°ç®—æ³•ä¸ºåº”ç”¨ï¼šWorkflow+Analyticsæœ‰äº†å‰è¾¹çš„å¿«é€Ÿå®éªŒï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© workflow + NebulaGraph Analytics æŠŠå®ƒè½åœ°ä¸ºå…¨å›¾ä¸Šçš„ç®—æ³•ï¼Œåˆ©ç”¨ Analytics åˆ†å¸ƒå¼èƒ½åŠ›å»æ‰§è¡Œã€‚ åœ¨ç”Ÿäº§ä¸Šï¼Œæˆ‘ä»¬åˆ©ç”¨ Workflow çš„ DAG ç¼–æ’èƒ½åŠ›åˆ›å»ºä¸¤ä¸ªå‰åç›¸è¿çš„ä»»åŠ¡ï¼š å–ä¸´è¿‘è™šæœº å…¨å›¾ç®—ç›¸ä¼¼åº¦ ç¬¬ä¸€ä¸ªä»»åŠ¡å¦‚ä¸‹ï¼Œå®ƒå®æ—¶ä»ç»™å®šçš„è™šæœºï¼ˆè¿™é‡Œå†™æ­»äº† server-0ï¼Œä½†æ˜¯ workflow å¯ä»¥æŠŠè¿™é‡Œä½œä¸ºå‚æ•°åŒ–ï¼Œå¹¶å°è£…ä»»åŠ¡ä¸ºå¯ä»¥è¢« API è§¦å‘çš„å¼‚æ­¥æœåŠ¡ï¼‰ï¼š MATCH (n)-[*1..5]-(m:`nova_instance`) WHERE id(n) == \"server-0\" AND n != m RETURN distinct id(m) è¿™é‡Œ Query job æˆ‘ä»¬è¾“å‡ºå¾…æ¯”è¾ƒçš„å…¶ä»–è™šæœºçš„ vidã€‚ æ¥ç€ï¼ŒJaccardSImilarity job ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹© ids1 ä¸º server-0ï¼ˆè¿™é‡Œå¦‚ä¸Šï¼Œä¸Šçº¿æ—¶æ˜¯å‚æ•°åŒ–çš„ï¼‰ï¼Œids2 ä»ä¸Šæ¸¸å–ï¼ˆå‰è¾¹çš„ Query jobï¼‰ï¼Œé€‰æ‹©åœ¨ openstack å…¨å›¾æ‰«ææ‰€æœ‰ç±»å‹çš„è¾¹ã€‚ ä¿å­˜ã€è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç»“æœå¦‚ä¸‹ï¼ŒåŒºåˆ«æ˜¯è¿™æ¬¡å®ƒè¿ç®—äº†æ›´å¤šçš„ç›®æ ‡è™šæœºï¼Œå¹¶ä¸”è¿­ä»£ä½œç”¨èŒƒå›´æ˜¯å…¨å›¾è€Œéä¸€ä¸ªå­å›¾ï¼Œå¯ä»¥çœ‹åˆ°ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œè¿™æ˜¯å› ä¸ºå­å›¾ä¸Šå…³è”åº¦å¤§çš„ç‚¹å’Œç›¸è¿‘çš„è¾¹åœ¨ Jaccard ç®—æ³•é‡Œèµ·åˆ°äº†æ›´ä¸»è¦çš„ä½œç”¨ã€‚ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:4","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#é«˜ç›¸å…³æ€§è™šæœºé¢„è­¦"},{"categories":["Nebula Graph"],"content":" 4.4 é«˜ç›¸å…³æ€§è™šæœºé¢„è­¦ä¸‹é¢å†ç»™ä¸€ä¸ªèŠ‚ç‚¹ç›¸ä¼¼åº¦çš„åº”ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¨å›¾æˆ–è€…å­å›¾ä¸Šï¼Œåˆ©ç”¨å›¾ç®—æ³•æ‰¾åˆ°ä¸ä¸€ä¸ªè™šæœºåœ¨å›¾ä¸Šå…³ç³»çš„ç»´åº¦ä¸Šæœ€ç›¸ä¼¼çš„å…¶ä»–è™šæœºï¼ŒåŸºäºåœ¨è¿™ç§ç›¸å…³æ€§å¢åŠ æ–°çš„å…³ç³»ï¼Œå¹¶åœ¨å…³ç³»ä¸Šåšé£é™©äº‹ä»¶é¢„è­¦ã€‚ è¿™æ¬¡çš„å›¾ç®—æ³•åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸€ä¸ªå…¸å‹çš„ä»[å¿«é€Ÿå­å›¾éªŒè¯]åˆ°[å…¨å›¾ç”Ÿäº§åº”ç”¨çš„]å·¥ä½œæµã€‚ 4.4.1 åœ¨å­å›¾ä¸Šå¿«é€ŸéªŒè¯ï¼šæµè§ˆå™¨å†…ç®—æ³•é¦–å…ˆï¼Œæˆ‘ä»¬è¯•ç€ä» server-0 çš„ä¸‰åº¦å­å›¾ä¸Šåšç®—æ³•çš„éªŒè¯ã€‚ GET SUBGRAPH 3 STEPS FROM \"server-0\" YIELD VERTICES AS nodes, EDGES AS relationships; å°†ç»“æœæ¸²æŸ“åœ¨ç”»å¸ƒä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å­å›¾ä¸­åŒ…å«äº†å…¶ä»–å‡ ä¸ªè™šæœºï¼š ç„¶åï¼Œæˆ‘ä»¬åˆ©ç”¨ explorer ä¸­çš„æµè§ˆå™¨å†…å›¾ç®—æ³•ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ Jaccard SImilarity ç›¸ä¼¼æ€§ç®—æ³•ï¼Œè¿›è¡Œ server-0 ä¸ server-1,server-3,server-4,server-6 è¿­ä»£åˆ†åˆ«å¾—åˆ°ç›¸ä¼¼æ€§ï¼š å¯ä»¥çœ‹å‡ºï¼Œåœ¨ 3 æ­¥å­å›¾å†…ï¼Œå’Œ server-0 æœ€è¿‘æ¥çš„è™šæœºæ˜¯ server-4ã€‚è¿›ä¸€æ­¥æˆ‘ä»¬å¯ä»¥ç®€å•åœ¨å­å›¾ä¸Šçœ‹çœ‹ä¸¤è€…ä¹‹é—´çš„è·¯å¾„ä½œä¸ºç›¸ä¼¼æ€§çš„è§£é‡Šï¼š åœ¨è¿™ä¸ªå¯è§£é‡Šç»“æœä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ server-0 ä¸ server-4 ç›¸ä¼¼çš„åŸå› å¯èƒ½æ˜¯ï¼š åè½åœ¨åŒä¸€ä¸ªå®¿ä¸»æœºï¼šnode-0 ä½¿ç”¨åŒä¸€ä¸ªé•œåƒï¼šcirros_mod_from_volume-1 å¦‚æ­¤ï¼Œæˆ‘ä»¬æœ€ç»ˆè½åœ°çš„é¢„è­¦æœºåˆ¶å¯èƒ½æ˜¯ï¼Œå½“ server-0 å‡ºç°æŸä¸€é—®é¢˜ã€å‘Šè­¦æ—¶å€™ï¼Œç»™ç›¸ä¼¼çš„ server-4 ä¹Ÿè®¾å®šé¢„è­¦ï¼Œé¢„è­¦ç†ç”±å°±æ˜¯å®ƒä»¬åœ¨åŒæ ·ä¸»æœºã€åŒæ ·é•œåƒã€‚ 4.4.2 è½åœ°ç®—æ³•ä¸ºåº”ç”¨ï¼šWorkflow+Analyticsæœ‰äº†å‰è¾¹çš„å¿«é€Ÿå®éªŒï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© workflow + NebulaGraph Analytics æŠŠå®ƒè½åœ°ä¸ºå…¨å›¾ä¸Šçš„ç®—æ³•ï¼Œåˆ©ç”¨ Analytics åˆ†å¸ƒå¼èƒ½åŠ›å»æ‰§è¡Œã€‚ åœ¨ç”Ÿäº§ä¸Šï¼Œæˆ‘ä»¬åˆ©ç”¨ Workflow çš„ DAG ç¼–æ’èƒ½åŠ›åˆ›å»ºä¸¤ä¸ªå‰åç›¸è¿çš„ä»»åŠ¡ï¼š å–ä¸´è¿‘è™šæœº å…¨å›¾ç®—ç›¸ä¼¼åº¦ ç¬¬ä¸€ä¸ªä»»åŠ¡å¦‚ä¸‹ï¼Œå®ƒå®æ—¶ä»ç»™å®šçš„è™šæœºï¼ˆè¿™é‡Œå†™æ­»äº† server-0ï¼Œä½†æ˜¯ workflow å¯ä»¥æŠŠè¿™é‡Œä½œä¸ºå‚æ•°åŒ–ï¼Œå¹¶å°è£…ä»»åŠ¡ä¸ºå¯ä»¥è¢« API è§¦å‘çš„å¼‚æ­¥æœåŠ¡ï¼‰ï¼š MATCH (n)-[*1..5]-(m:`nova_instance`) WHERE id(n) == \"server-0\" AND n != m RETURN distinct id(m) è¿™é‡Œ Query job æˆ‘ä»¬è¾“å‡ºå¾…æ¯”è¾ƒçš„å…¶ä»–è™šæœºçš„ vidã€‚ æ¥ç€ï¼ŒJaccardSImilarity job ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹© ids1 ä¸º server-0ï¼ˆè¿™é‡Œå¦‚ä¸Šï¼Œä¸Šçº¿æ—¶æ˜¯å‚æ•°åŒ–çš„ï¼‰ï¼Œids2 ä»ä¸Šæ¸¸å–ï¼ˆå‰è¾¹çš„ Query jobï¼‰ï¼Œé€‰æ‹©åœ¨ openstack å…¨å›¾æ‰«ææ‰€æœ‰ç±»å‹çš„è¾¹ã€‚ ä¿å­˜ã€è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç»“æœå¦‚ä¸‹ï¼ŒåŒºåˆ«æ˜¯è¿™æ¬¡å®ƒè¿ç®—äº†æ›´å¤šçš„ç›®æ ‡è™šæœºï¼Œå¹¶ä¸”è¿­ä»£ä½œç”¨èŒƒå›´æ˜¯å…¨å›¾è€Œéä¸€ä¸ªå­å›¾ï¼Œå¯ä»¥çœ‹åˆ°ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œè¿™æ˜¯å› ä¸ºå­å›¾ä¸Šå…³è”åº¦å¤§çš„ç‚¹å’Œç›¸è¿‘çš„è¾¹åœ¨ Jaccard ç®—æ³•é‡Œèµ·åˆ°äº†æ›´ä¸»è¦çš„ä½œç”¨ã€‚ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:4","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#åœ¨å­å›¾ä¸Šå¿«é€ŸéªŒè¯æµè§ˆå™¨å†…ç®—æ³•"},{"categories":["Nebula Graph"],"content":" 4.4 é«˜ç›¸å…³æ€§è™šæœºé¢„è­¦ä¸‹é¢å†ç»™ä¸€ä¸ªèŠ‚ç‚¹ç›¸ä¼¼åº¦çš„åº”ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¨å›¾æˆ–è€…å­å›¾ä¸Šï¼Œåˆ©ç”¨å›¾ç®—æ³•æ‰¾åˆ°ä¸ä¸€ä¸ªè™šæœºåœ¨å›¾ä¸Šå…³ç³»çš„ç»´åº¦ä¸Šæœ€ç›¸ä¼¼çš„å…¶ä»–è™šæœºï¼ŒåŸºäºåœ¨è¿™ç§ç›¸å…³æ€§å¢åŠ æ–°çš„å…³ç³»ï¼Œå¹¶åœ¨å…³ç³»ä¸Šåšé£é™©äº‹ä»¶é¢„è­¦ã€‚ è¿™æ¬¡çš„å›¾ç®—æ³•åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸€ä¸ªå…¸å‹çš„ä»[å¿«é€Ÿå­å›¾éªŒè¯]åˆ°[å…¨å›¾ç”Ÿäº§åº”ç”¨çš„]å·¥ä½œæµã€‚ 4.4.1 åœ¨å­å›¾ä¸Šå¿«é€ŸéªŒè¯ï¼šæµè§ˆå™¨å†…ç®—æ³•é¦–å…ˆï¼Œæˆ‘ä»¬è¯•ç€ä» server-0 çš„ä¸‰åº¦å­å›¾ä¸Šåšç®—æ³•çš„éªŒè¯ã€‚ GET SUBGRAPH 3 STEPS FROM \"server-0\" YIELD VERTICES AS nodes, EDGES AS relationships; å°†ç»“æœæ¸²æŸ“åœ¨ç”»å¸ƒä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å­å›¾ä¸­åŒ…å«äº†å…¶ä»–å‡ ä¸ªè™šæœºï¼š ç„¶åï¼Œæˆ‘ä»¬åˆ©ç”¨ explorer ä¸­çš„æµè§ˆå™¨å†…å›¾ç®—æ³•ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ Jaccard SImilarity ç›¸ä¼¼æ€§ç®—æ³•ï¼Œè¿›è¡Œ server-0 ä¸ server-1,server-3,server-4,server-6 è¿­ä»£åˆ†åˆ«å¾—åˆ°ç›¸ä¼¼æ€§ï¼š å¯ä»¥çœ‹å‡ºï¼Œåœ¨ 3 æ­¥å­å›¾å†…ï¼Œå’Œ server-0 æœ€è¿‘æ¥çš„è™šæœºæ˜¯ server-4ã€‚è¿›ä¸€æ­¥æˆ‘ä»¬å¯ä»¥ç®€å•åœ¨å­å›¾ä¸Šçœ‹çœ‹ä¸¤è€…ä¹‹é—´çš„è·¯å¾„ä½œä¸ºç›¸ä¼¼æ€§çš„è§£é‡Šï¼š åœ¨è¿™ä¸ªå¯è§£é‡Šç»“æœä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ server-0 ä¸ server-4 ç›¸ä¼¼çš„åŸå› å¯èƒ½æ˜¯ï¼š åè½åœ¨åŒä¸€ä¸ªå®¿ä¸»æœºï¼šnode-0 ä½¿ç”¨åŒä¸€ä¸ªé•œåƒï¼šcirros_mod_from_volume-1 å¦‚æ­¤ï¼Œæˆ‘ä»¬æœ€ç»ˆè½åœ°çš„é¢„è­¦æœºåˆ¶å¯èƒ½æ˜¯ï¼Œå½“ server-0 å‡ºç°æŸä¸€é—®é¢˜ã€å‘Šè­¦æ—¶å€™ï¼Œç»™ç›¸ä¼¼çš„ server-4 ä¹Ÿè®¾å®šé¢„è­¦ï¼Œé¢„è­¦ç†ç”±å°±æ˜¯å®ƒä»¬åœ¨åŒæ ·ä¸»æœºã€åŒæ ·é•œåƒã€‚ 4.4.2 è½åœ°ç®—æ³•ä¸ºåº”ç”¨ï¼šWorkflow+Analyticsæœ‰äº†å‰è¾¹çš„å¿«é€Ÿå®éªŒï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© workflow + NebulaGraph Analytics æŠŠå®ƒè½åœ°ä¸ºå…¨å›¾ä¸Šçš„ç®—æ³•ï¼Œåˆ©ç”¨ Analytics åˆ†å¸ƒå¼èƒ½åŠ›å»æ‰§è¡Œã€‚ åœ¨ç”Ÿäº§ä¸Šï¼Œæˆ‘ä»¬åˆ©ç”¨ Workflow çš„ DAG ç¼–æ’èƒ½åŠ›åˆ›å»ºä¸¤ä¸ªå‰åç›¸è¿çš„ä»»åŠ¡ï¼š å–ä¸´è¿‘è™šæœº å…¨å›¾ç®—ç›¸ä¼¼åº¦ ç¬¬ä¸€ä¸ªä»»åŠ¡å¦‚ä¸‹ï¼Œå®ƒå®æ—¶ä»ç»™å®šçš„è™šæœºï¼ˆè¿™é‡Œå†™æ­»äº† server-0ï¼Œä½†æ˜¯ workflow å¯ä»¥æŠŠè¿™é‡Œä½œä¸ºå‚æ•°åŒ–ï¼Œå¹¶å°è£…ä»»åŠ¡ä¸ºå¯ä»¥è¢« API è§¦å‘çš„å¼‚æ­¥æœåŠ¡ï¼‰ï¼š MATCH (n)-[*1..5]-(m:`nova_instance`) WHERE id(n) == \"server-0\" AND n != m RETURN distinct id(m) è¿™é‡Œ Query job æˆ‘ä»¬è¾“å‡ºå¾…æ¯”è¾ƒçš„å…¶ä»–è™šæœºçš„ vidã€‚ æ¥ç€ï¼ŒJaccardSImilarity job ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹© ids1 ä¸º server-0ï¼ˆè¿™é‡Œå¦‚ä¸Šï¼Œä¸Šçº¿æ—¶æ˜¯å‚æ•°åŒ–çš„ï¼‰ï¼Œids2 ä»ä¸Šæ¸¸å–ï¼ˆå‰è¾¹çš„ Query jobï¼‰ï¼Œé€‰æ‹©åœ¨ openstack å…¨å›¾æ‰«ææ‰€æœ‰ç±»å‹çš„è¾¹ã€‚ ä¿å­˜ã€è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç»“æœå¦‚ä¸‹ï¼ŒåŒºåˆ«æ˜¯è¿™æ¬¡å®ƒè¿ç®—äº†æ›´å¤šçš„ç›®æ ‡è™šæœºï¼Œå¹¶ä¸”è¿­ä»£ä½œç”¨èŒƒå›´æ˜¯å…¨å›¾è€Œéä¸€ä¸ªå­å›¾ï¼Œå¯ä»¥çœ‹åˆ°ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œè¿™æ˜¯å› ä¸ºå­å›¾ä¸Šå…³è”åº¦å¤§çš„ç‚¹å’Œç›¸è¿‘çš„è¾¹åœ¨ Jaccard ç®—æ³•é‡Œèµ·åˆ°äº†æ›´ä¸»è¦çš„ä½œç”¨ã€‚ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:4","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#è½åœ°ç®—æ³•ä¸ºåº”ç”¨workflowanalytics"},{"categories":["Nebula Graph"],"content":" 4.5 å®‰å…¨ç›¸å…³åœºæ™¯åŸºç¡€è®¾æ–½èµ„æºä¸­çš„å…³è”å…³ç³»å’Œé‡‘èã€å†…å®¹ç³»ç»Ÿã€ç”µå•†é¢†åŸŸçš„é£æ§åœºæ™¯æœ‰ç›¸ä¼¼çš„åœ°æ–¹ï¼Œå¾ˆå¤šåœºæ™¯æœ¬è´¨ä¸Šåˆ©ç”¨åˆ°äº†å›¾è°±å…³ç³»ä¸­çš„çŸ¥è¯†ï¼Œåœ¨å›¾åº“ä¸Šå®æ—¶è·å–è¿™äº›å¤æ‚å¤šè·³å¤©ç„¶å¸¦æœ‰å¯è§£é‡Šæ€§çš„å®‰å…¨æ´å¯Ÿéå¸¸é€‚åˆã€‚ 4.5.1 ç§˜é’¥æ³„æ¼é£æ§åˆ†æå…ˆçœ‹ä¸€ä¸ªç§˜é’¥æ³„æ¼çš„åœºæ™¯ï¼šå‡è®¾ key-0 è¢«å®‰å…¨éƒ¨é—¨ç¡®å®šè¢«æ³„æ¼äº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯«ç§’æ—¶é—´å†…è·å¾—å¦‚ä¸‹æŸ¥è¯¢ï¼š ç›´æ¥é‡‡ç”¨äº†å¯†é’¥çš„è™šæœº ä¸é‡‡ç”¨ç§˜é’¥çš„è™šæœºç½‘ç»œç›´è¿çš„æœºå™¨ ä¸é‡‡ç”¨ç§˜é’¥çš„è™šæœºè·¨ç½‘ç»œç›¸è¿çš„æœºå™¨ MATCH (key_leaked)-[:`used_by`]-\u003e(involved_server:nova_instance)--(:neutron_port)--(net:neutron_network)--(:neutron_port)--(server_b:nova_instance) WHERE id(key_leaked) == \"key-0\" OPTIONAL MATCH (server_b)--()--(other_net:neutron_network)--(:neutron_port)--(server_c:nova_instance) WITH involved_server, server_b AS same_subnet_machines, server_c AS cross_net_machines WHERE cross_net_machines != involved_server RETURN involved_server.nova_instance.name AS with_key, same_subnet_machines.nova_instance.name AS l2_vms, cross_net_machines.nova_instance.name AS cross_vpc_vms è´´ä¸€ä¸‹éƒ¨åˆ†ç»“æœï¼Œæˆ‘ä»¬çŸ¥é“ server-4 é‡‡ç”¨äº†è¿™ä¸ª keypairï¼Œå¹¶ä¸” server-6 å’Œå®ƒåœ¨åŒä¸€ä¸ªç½‘ç»œï¼ŒåŒæ—¶ï¼Œæœ‰ä¸€å®šå¯èƒ½ï¼Œé€šè¿‡ server-6ï¼Œserver-1,2,0,5 ä¹Ÿå—åˆ°äº†å¨èƒã€å½±å“ï¼Œç›¸å…³çš„æœºå™¨å¯ä»¥è¢«è§¦å‘ä¸åŒçº§åˆ«çš„å‘Šè­¦æ¥é™ä½å®‰å…¨äº‹æ•…çš„å½±å“ã€‚ with_key l2_vms cross_vpc_vms server-4 server-6 server-1 server-4 server-6 server-2 server-4 server-6 server-0 server-4 server-6 server-5 è¿™ä¸ªæŸ¥è¯¢æ”¹é€ ä¸ºå¯è§†åŒ–ç»“æœï¼š MATCH p=(key_leaked)-[:`used_by`]-\u003e(involved_server:nova_instance)--(:neutron_port)--(net:neutron_network)--(:neutron_port)--(server_b:nova_instance) WHERE id(key_leaked) == \"key-0\" OPTIONAL MATCH p1=(server_b)--()--(other_net:neutron_network)--(:neutron_port)--(server_c:nova_instance) RETURN p,p1 åœ¨ explorer é‡Œ åº”ç”¨ Dagre-LR çš„å¸ƒå±€ï¼Œä¸€å…³è”å…³ç³»å¾ˆæ¸…æ™°çš„è¢«å±•ç¤ºå‡ºæ¥ï¼Œä¹Ÿè®¸å¯ä»¥è€ƒè™‘æŠŠå®ƒå¼•ç”¨åœ¨å®‰å…¨äº‹æ•…çš„æŠ¥å‘Šåˆ†å‘ç»™è™šæœºç§Ÿæˆ·ã€‚ 4.5.2 é•œåƒã€äº‘ç›˜æ¼æ´èŒƒå›´åˆ†æç±»ä¼¼çš„ï¼Œä¸€ä¸ªé•œåƒè¢«æ‰«å‡ºæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥ç¬é—´æŸ¥åˆ°æ¶‰åŠåˆ°çš„èµ„æºï¼Œå¹¶åšå‡ºç›¸åº” é•œåƒæ–‡ä»¶æœ‰æ¼æ´ MATCH p=(image_risky)-[:`created_from`]-(step1) WHERE id(image_risky) == \"cirros-0.5.2-x86_64-disk\" OPTIONAL MATCH p1=(step1)-[:created_from*1..5]-(step2) RETURN p, p1 ä¸€ä¸ªäº‘ç›˜æœ‰æ¼æ´ MATCH p=(volume_risky)-[:`created_from`]-(step1) WHERE id(volume_risky) == \"volume-1\" OPTIONAL MATCH p1=(step1)-[:created_from*1..5]-(step2) RETURN p, p1 4.5.3 æ½œåœ¨å®¿ä¸»æœºé€ƒç¦»å½±å“èŒƒå›´åˆ†ææœ€åï¼Œæˆ‘ä»¬è®¨è®ºä¸€ä¸ªæ¯”è¾ƒä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼šå®¿ä¸»æœºé€ƒç¦»ã€‚ åœ¨æç«¯çš„æƒ…å†µä¸‹å¦‚æœåœ¨æˆ‘ä»¬å¾—åˆ°æ¶ˆæ¯ï¼Œserver-0 å‘ç”Ÿäº†æœ‰å¯èƒ½å½±å“å®¿ä¸»æœºçš„å®‰å…¨æ—¶é—´çš„æ—¶å€™ï¼Œä»…ä»…å…³é—­è¿™ä¸ªå®¿ä¸»æœºæ˜¯ä¸å¤Ÿçš„ï¼Œå—å½±å“çš„èŒƒå›´å¯èƒ½å·²ç»æ‰©å¤§äº†ï¼Œç„¶è€Œï¼Œæˆ‘ä»¬ä¸å¯èƒ½å› ä¸ºè¿™æ ·å…³é—­æ•´ä¸ªæœºæˆ¿ï¼Œæ‰€ä»¥ï¼Œåˆ©ç”¨å›¾è°±è¾…åŠ©æ‰¾å‡ºå—å½±å“èŒƒå›´ä¼šæœ‰ä¸€äº›å¸®åŠ©ã€‚ ä¸‹é¢çš„æŸ¥è¯¢æ¨¡å¼æ˜¯ï¼š æ‰¾å‡ºå¯èƒ½è¢«å½±å“çš„å­ç½‘ï¼ˆVPCï¼‰ï¼Œæ ‡è®°æœ€é«˜çº§åˆ«é£é™©å­ç½‘ä¸ºåç»­å®šä½åšå‡†å¤‡ æ‰¾åˆ°å¯èƒ½è¢«æ§åˆ¶äº†çš„å®¿ä¸»æœº ä»å®¿ä¸»æœºè§¦å‘ï¼Œæ‰¾å‡ºåŒä¸»æœºçš„å…¶ä»–è™šæœº ä»å…¶ä»–è™šæœºè§¦å‘ï¼Œæ‰¾åˆ°å®ƒä»¬çš„å­ç½‘ï¼ˆVPCï¼‰ ä»å…¶ä»–è™šæœºè§¦å‘ï¼Œæ‰¾åˆ°å¯èƒ½å·²ç»è¢«å½±å“çš„ç½‘ç›˜ï¼ˆé˜²æ­¢è¢«æŒ‚è½½åˆ°å…¶ä»–æœºå™¨ï¼Œæ‰©å¤§å½±å“ï¼‰ MATCH (server_escaping_hypervisor)\u003c-[:`contains`]-(hypervisor_compromised:nova_host) WHERE id(server_escaping_hypervisor) == \"server-0\" OPTIONAL MATCH (server_escaping_hypervisor)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet_high:neutron_network) OPTIONAL MATCH (hypervisor_compromised)-[:`contains`]-\u003e(server_same_host:nova_instance) OPTIONAL MATCH (server_same_host)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet:neutron_network) OPTIONAL MATCH (server_same_host)\u003c-[:attached]-(impacted_volume:cinder_volume) RETURN impacted_subnet_high.neutron_network.name AS impacted_subnet_high, hypervisor_compromised.nova_host.name AS hypervisor_compromised, impacted_subnet.neutron_network.name AS impacted_subnet, [server_same_host.nova_instance.name, server_same_host.nova_instance.instance_name] AS server_same_host, impacted_volume.cinder_volume.name AS impacted_volume ç»“æœä¸­åˆ—å‡ºäº† server-0 è¢«æ§åˆ¶ä¹‹åï¼Œè€ƒè™‘å®¿ä¸»æœºé€ƒç¦»çš„æƒ…å†µä¸‹å¯èƒ½å—å½±å“çš„æ‰©æ•£èŒƒå›´ã€‚ impacted_subnet_high hypervisor_compromised impacted_subnet server_same_host impacted_volume shared node0 shared [â€œserver-0â€, â€œinstance-00000001â€] Empty shared node0 shared [â€œserver-1â€, â€œinstance-00000002â€] ffaeb199-47f4-4d95-89b2-97fba3c1bcfe shared node0 private [â€œserver-1â€, â€œinstance-00000002â€] ffaeb199-47f4-4d95-89b2-97fba3c1bcfe shared node0 private [â€œserver-3â€, â€œinstance-00000005â€] c9db7c2e-c712-49d6-8019-14b82de8542d shared node0 private [â€œserver-3â€, â€œinstance-00000005â€] volume-2 shared node0 public [â€œserver-4â€, â€œinstance-00000006â€] volume-2 å’±ä»¬å†çœ‹çœ‹å®ƒçš„å¯è§†åŒ–ç»“æœã€‚ MATCH p=(server_escaping_hypervisor)\u003c-[:`contains`]-(hypervisor_compromised:nova_host) WHERE id(server_escaping_hypervisor) == \"server-0\" OPTIONAL MATCH p0=(server_escaping_hypervisor)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet_high:neutron_network) OPTIONAL MATCH p1=(hypervisor_compromised)-[:`contains`]-\u003e(server_same_host:nova_instance) OPTIONAL MA","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:5","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#å®‰å…¨ç›¸å…³åœºæ™¯"},{"categories":["Nebula Graph"],"content":" 4.5 å®‰å…¨ç›¸å…³åœºæ™¯åŸºç¡€è®¾æ–½èµ„æºä¸­çš„å…³è”å…³ç³»å’Œé‡‘èã€å†…å®¹ç³»ç»Ÿã€ç”µå•†é¢†åŸŸçš„é£æ§åœºæ™¯æœ‰ç›¸ä¼¼çš„åœ°æ–¹ï¼Œå¾ˆå¤šåœºæ™¯æœ¬è´¨ä¸Šåˆ©ç”¨åˆ°äº†å›¾è°±å…³ç³»ä¸­çš„çŸ¥è¯†ï¼Œåœ¨å›¾åº“ä¸Šå®æ—¶è·å–è¿™äº›å¤æ‚å¤šè·³å¤©ç„¶å¸¦æœ‰å¯è§£é‡Šæ€§çš„å®‰å…¨æ´å¯Ÿéå¸¸é€‚åˆã€‚ 4.5.1 ç§˜é’¥æ³„æ¼é£æ§åˆ†æå…ˆçœ‹ä¸€ä¸ªç§˜é’¥æ³„æ¼çš„åœºæ™¯ï¼šå‡è®¾ key-0 è¢«å®‰å…¨éƒ¨é—¨ç¡®å®šè¢«æ³„æ¼äº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯«ç§’æ—¶é—´å†…è·å¾—å¦‚ä¸‹æŸ¥è¯¢ï¼š ç›´æ¥é‡‡ç”¨äº†å¯†é’¥çš„è™šæœº ä¸é‡‡ç”¨ç§˜é’¥çš„è™šæœºç½‘ç»œç›´è¿çš„æœºå™¨ ä¸é‡‡ç”¨ç§˜é’¥çš„è™šæœºè·¨ç½‘ç»œç›¸è¿çš„æœºå™¨ MATCH (key_leaked)-[:`used_by`]-\u003e(involved_server:nova_instance)--(:neutron_port)--(net:neutron_network)--(:neutron_port)--(server_b:nova_instance) WHERE id(key_leaked) == \"key-0\" OPTIONAL MATCH (server_b)--()--(other_net:neutron_network)--(:neutron_port)--(server_c:nova_instance) WITH involved_server, server_b AS same_subnet_machines, server_c AS cross_net_machines WHERE cross_net_machines != involved_server RETURN involved_server.nova_instance.name AS with_key, same_subnet_machines.nova_instance.name AS l2_vms, cross_net_machines.nova_instance.name AS cross_vpc_vms è´´ä¸€ä¸‹éƒ¨åˆ†ç»“æœï¼Œæˆ‘ä»¬çŸ¥é“ server-4 é‡‡ç”¨äº†è¿™ä¸ª keypairï¼Œå¹¶ä¸” server-6 å’Œå®ƒåœ¨åŒä¸€ä¸ªç½‘ç»œï¼ŒåŒæ—¶ï¼Œæœ‰ä¸€å®šå¯èƒ½ï¼Œé€šè¿‡ server-6ï¼Œserver-1,2,0,5 ä¹Ÿå—åˆ°äº†å¨èƒã€å½±å“ï¼Œç›¸å…³çš„æœºå™¨å¯ä»¥è¢«è§¦å‘ä¸åŒçº§åˆ«çš„å‘Šè­¦æ¥é™ä½å®‰å…¨äº‹æ•…çš„å½±å“ã€‚ with_key l2_vms cross_vpc_vms server-4 server-6 server-1 server-4 server-6 server-2 server-4 server-6 server-0 server-4 server-6 server-5 è¿™ä¸ªæŸ¥è¯¢æ”¹é€ ä¸ºå¯è§†åŒ–ç»“æœï¼š MATCH p=(key_leaked)-[:`used_by`]-\u003e(involved_server:nova_instance)--(:neutron_port)--(net:neutron_network)--(:neutron_port)--(server_b:nova_instance) WHERE id(key_leaked) == \"key-0\" OPTIONAL MATCH p1=(server_b)--()--(other_net:neutron_network)--(:neutron_port)--(server_c:nova_instance) RETURN p,p1 åœ¨ explorer é‡Œ åº”ç”¨ Dagre-LR çš„å¸ƒå±€ï¼Œä¸€å…³è”å…³ç³»å¾ˆæ¸…æ™°çš„è¢«å±•ç¤ºå‡ºæ¥ï¼Œä¹Ÿè®¸å¯ä»¥è€ƒè™‘æŠŠå®ƒå¼•ç”¨åœ¨å®‰å…¨äº‹æ•…çš„æŠ¥å‘Šåˆ†å‘ç»™è™šæœºç§Ÿæˆ·ã€‚ 4.5.2 é•œåƒã€äº‘ç›˜æ¼æ´èŒƒå›´åˆ†æç±»ä¼¼çš„ï¼Œä¸€ä¸ªé•œåƒè¢«æ‰«å‡ºæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥ç¬é—´æŸ¥åˆ°æ¶‰åŠåˆ°çš„èµ„æºï¼Œå¹¶åšå‡ºç›¸åº” é•œåƒæ–‡ä»¶æœ‰æ¼æ´ MATCH p=(image_risky)-[:`created_from`]-(step1) WHERE id(image_risky) == \"cirros-0.5.2-x86_64-disk\" OPTIONAL MATCH p1=(step1)-[:created_from*1..5]-(step2) RETURN p, p1 ä¸€ä¸ªäº‘ç›˜æœ‰æ¼æ´ MATCH p=(volume_risky)-[:`created_from`]-(step1) WHERE id(volume_risky) == \"volume-1\" OPTIONAL MATCH p1=(step1)-[:created_from*1..5]-(step2) RETURN p, p1 4.5.3 æ½œåœ¨å®¿ä¸»æœºé€ƒç¦»å½±å“èŒƒå›´åˆ†ææœ€åï¼Œæˆ‘ä»¬è®¨è®ºä¸€ä¸ªæ¯”è¾ƒä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼šå®¿ä¸»æœºé€ƒç¦»ã€‚ åœ¨æç«¯çš„æƒ…å†µä¸‹å¦‚æœåœ¨æˆ‘ä»¬å¾—åˆ°æ¶ˆæ¯ï¼Œserver-0 å‘ç”Ÿäº†æœ‰å¯èƒ½å½±å“å®¿ä¸»æœºçš„å®‰å…¨æ—¶é—´çš„æ—¶å€™ï¼Œä»…ä»…å…³é—­è¿™ä¸ªå®¿ä¸»æœºæ˜¯ä¸å¤Ÿçš„ï¼Œå—å½±å“çš„èŒƒå›´å¯èƒ½å·²ç»æ‰©å¤§äº†ï¼Œç„¶è€Œï¼Œæˆ‘ä»¬ä¸å¯èƒ½å› ä¸ºè¿™æ ·å…³é—­æ•´ä¸ªæœºæˆ¿ï¼Œæ‰€ä»¥ï¼Œåˆ©ç”¨å›¾è°±è¾…åŠ©æ‰¾å‡ºå—å½±å“èŒƒå›´ä¼šæœ‰ä¸€äº›å¸®åŠ©ã€‚ ä¸‹é¢çš„æŸ¥è¯¢æ¨¡å¼æ˜¯ï¼š æ‰¾å‡ºå¯èƒ½è¢«å½±å“çš„å­ç½‘ï¼ˆVPCï¼‰ï¼Œæ ‡è®°æœ€é«˜çº§åˆ«é£é™©å­ç½‘ä¸ºåç»­å®šä½åšå‡†å¤‡ æ‰¾åˆ°å¯èƒ½è¢«æ§åˆ¶äº†çš„å®¿ä¸»æœº ä»å®¿ä¸»æœºè§¦å‘ï¼Œæ‰¾å‡ºåŒä¸»æœºçš„å…¶ä»–è™šæœº ä»å…¶ä»–è™šæœºè§¦å‘ï¼Œæ‰¾åˆ°å®ƒä»¬çš„å­ç½‘ï¼ˆVPCï¼‰ ä»å…¶ä»–è™šæœºè§¦å‘ï¼Œæ‰¾åˆ°å¯èƒ½å·²ç»è¢«å½±å“çš„ç½‘ç›˜ï¼ˆé˜²æ­¢è¢«æŒ‚è½½åˆ°å…¶ä»–æœºå™¨ï¼Œæ‰©å¤§å½±å“ï¼‰ MATCH (server_escaping_hypervisor)\u003c-[:`contains`]-(hypervisor_compromised:nova_host) WHERE id(server_escaping_hypervisor) == \"server-0\" OPTIONAL MATCH (server_escaping_hypervisor)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet_high:neutron_network) OPTIONAL MATCH (hypervisor_compromised)-[:`contains`]-\u003e(server_same_host:nova_instance) OPTIONAL MATCH (server_same_host)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet:neutron_network) OPTIONAL MATCH (server_same_host)\u003c-[:attached]-(impacted_volume:cinder_volume) RETURN impacted_subnet_high.neutron_network.name AS impacted_subnet_high, hypervisor_compromised.nova_host.name AS hypervisor_compromised, impacted_subnet.neutron_network.name AS impacted_subnet, [server_same_host.nova_instance.name, server_same_host.nova_instance.instance_name] AS server_same_host, impacted_volume.cinder_volume.name AS impacted_volume ç»“æœä¸­åˆ—å‡ºäº† server-0 è¢«æ§åˆ¶ä¹‹åï¼Œè€ƒè™‘å®¿ä¸»æœºé€ƒç¦»çš„æƒ…å†µä¸‹å¯èƒ½å—å½±å“çš„æ‰©æ•£èŒƒå›´ã€‚ impacted_subnet_high hypervisor_compromised impacted_subnet server_same_host impacted_volume shared node0 shared [â€œserver-0â€, â€œinstance-00000001â€] Empty shared node0 shared [â€œserver-1â€, â€œinstance-00000002â€] ffaeb199-47f4-4d95-89b2-97fba3c1bcfe shared node0 private [â€œserver-1â€, â€œinstance-00000002â€] ffaeb199-47f4-4d95-89b2-97fba3c1bcfe shared node0 private [â€œserver-3â€, â€œinstance-00000005â€] c9db7c2e-c712-49d6-8019-14b82de8542d shared node0 private [â€œserver-3â€, â€œinstance-00000005â€] volume-2 shared node0 public [â€œserver-4â€, â€œinstance-00000006â€] volume-2 å’±ä»¬å†çœ‹çœ‹å®ƒçš„å¯è§†åŒ–ç»“æœã€‚ MATCH p=(server_escaping_hypervisor)\u003c-[:`contains`]-(hypervisor_compromised:nova_host) WHERE id(server_escaping_hypervisor) == \"server-0\" OPTIONAL MATCH p0=(server_escaping_hypervisor)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet_high:neutron_network) OPTIONAL MATCH p1=(hypervisor_compromised)-[:`contains`]-\u003e(server_same_host:nova_instance) OPTIONAL MA","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:5","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#ç§˜é’¥æ³„æ¼é£æ§åˆ†æ"},{"categories":["Nebula Graph"],"content":" 4.5 å®‰å…¨ç›¸å…³åœºæ™¯åŸºç¡€è®¾æ–½èµ„æºä¸­çš„å…³è”å…³ç³»å’Œé‡‘èã€å†…å®¹ç³»ç»Ÿã€ç”µå•†é¢†åŸŸçš„é£æ§åœºæ™¯æœ‰ç›¸ä¼¼çš„åœ°æ–¹ï¼Œå¾ˆå¤šåœºæ™¯æœ¬è´¨ä¸Šåˆ©ç”¨åˆ°äº†å›¾è°±å…³ç³»ä¸­çš„çŸ¥è¯†ï¼Œåœ¨å›¾åº“ä¸Šå®æ—¶è·å–è¿™äº›å¤æ‚å¤šè·³å¤©ç„¶å¸¦æœ‰å¯è§£é‡Šæ€§çš„å®‰å…¨æ´å¯Ÿéå¸¸é€‚åˆã€‚ 4.5.1 ç§˜é’¥æ³„æ¼é£æ§åˆ†æå…ˆçœ‹ä¸€ä¸ªç§˜é’¥æ³„æ¼çš„åœºæ™¯ï¼šå‡è®¾ key-0 è¢«å®‰å…¨éƒ¨é—¨ç¡®å®šè¢«æ³„æ¼äº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯«ç§’æ—¶é—´å†…è·å¾—å¦‚ä¸‹æŸ¥è¯¢ï¼š ç›´æ¥é‡‡ç”¨äº†å¯†é’¥çš„è™šæœº ä¸é‡‡ç”¨ç§˜é’¥çš„è™šæœºç½‘ç»œç›´è¿çš„æœºå™¨ ä¸é‡‡ç”¨ç§˜é’¥çš„è™šæœºè·¨ç½‘ç»œç›¸è¿çš„æœºå™¨ MATCH (key_leaked)-[:`used_by`]-\u003e(involved_server:nova_instance)--(:neutron_port)--(net:neutron_network)--(:neutron_port)--(server_b:nova_instance) WHERE id(key_leaked) == \"key-0\" OPTIONAL MATCH (server_b)--()--(other_net:neutron_network)--(:neutron_port)--(server_c:nova_instance) WITH involved_server, server_b AS same_subnet_machines, server_c AS cross_net_machines WHERE cross_net_machines != involved_server RETURN involved_server.nova_instance.name AS with_key, same_subnet_machines.nova_instance.name AS l2_vms, cross_net_machines.nova_instance.name AS cross_vpc_vms è´´ä¸€ä¸‹éƒ¨åˆ†ç»“æœï¼Œæˆ‘ä»¬çŸ¥é“ server-4 é‡‡ç”¨äº†è¿™ä¸ª keypairï¼Œå¹¶ä¸” server-6 å’Œå®ƒåœ¨åŒä¸€ä¸ªç½‘ç»œï¼ŒåŒæ—¶ï¼Œæœ‰ä¸€å®šå¯èƒ½ï¼Œé€šè¿‡ server-6ï¼Œserver-1,2,0,5 ä¹Ÿå—åˆ°äº†å¨èƒã€å½±å“ï¼Œç›¸å…³çš„æœºå™¨å¯ä»¥è¢«è§¦å‘ä¸åŒçº§åˆ«çš„å‘Šè­¦æ¥é™ä½å®‰å…¨äº‹æ•…çš„å½±å“ã€‚ with_key l2_vms cross_vpc_vms server-4 server-6 server-1 server-4 server-6 server-2 server-4 server-6 server-0 server-4 server-6 server-5 è¿™ä¸ªæŸ¥è¯¢æ”¹é€ ä¸ºå¯è§†åŒ–ç»“æœï¼š MATCH p=(key_leaked)-[:`used_by`]-\u003e(involved_server:nova_instance)--(:neutron_port)--(net:neutron_network)--(:neutron_port)--(server_b:nova_instance) WHERE id(key_leaked) == \"key-0\" OPTIONAL MATCH p1=(server_b)--()--(other_net:neutron_network)--(:neutron_port)--(server_c:nova_instance) RETURN p,p1 åœ¨ explorer é‡Œ åº”ç”¨ Dagre-LR çš„å¸ƒå±€ï¼Œä¸€å…³è”å…³ç³»å¾ˆæ¸…æ™°çš„è¢«å±•ç¤ºå‡ºæ¥ï¼Œä¹Ÿè®¸å¯ä»¥è€ƒè™‘æŠŠå®ƒå¼•ç”¨åœ¨å®‰å…¨äº‹æ•…çš„æŠ¥å‘Šåˆ†å‘ç»™è™šæœºç§Ÿæˆ·ã€‚ 4.5.2 é•œåƒã€äº‘ç›˜æ¼æ´èŒƒå›´åˆ†æç±»ä¼¼çš„ï¼Œä¸€ä¸ªé•œåƒè¢«æ‰«å‡ºæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥ç¬é—´æŸ¥åˆ°æ¶‰åŠåˆ°çš„èµ„æºï¼Œå¹¶åšå‡ºç›¸åº” é•œåƒæ–‡ä»¶æœ‰æ¼æ´ MATCH p=(image_risky)-[:`created_from`]-(step1) WHERE id(image_risky) == \"cirros-0.5.2-x86_64-disk\" OPTIONAL MATCH p1=(step1)-[:created_from*1..5]-(step2) RETURN p, p1 ä¸€ä¸ªäº‘ç›˜æœ‰æ¼æ´ MATCH p=(volume_risky)-[:`created_from`]-(step1) WHERE id(volume_risky) == \"volume-1\" OPTIONAL MATCH p1=(step1)-[:created_from*1..5]-(step2) RETURN p, p1 4.5.3 æ½œåœ¨å®¿ä¸»æœºé€ƒç¦»å½±å“èŒƒå›´åˆ†ææœ€åï¼Œæˆ‘ä»¬è®¨è®ºä¸€ä¸ªæ¯”è¾ƒä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼šå®¿ä¸»æœºé€ƒç¦»ã€‚ åœ¨æç«¯çš„æƒ…å†µä¸‹å¦‚æœåœ¨æˆ‘ä»¬å¾—åˆ°æ¶ˆæ¯ï¼Œserver-0 å‘ç”Ÿäº†æœ‰å¯èƒ½å½±å“å®¿ä¸»æœºçš„å®‰å…¨æ—¶é—´çš„æ—¶å€™ï¼Œä»…ä»…å…³é—­è¿™ä¸ªå®¿ä¸»æœºæ˜¯ä¸å¤Ÿçš„ï¼Œå—å½±å“çš„èŒƒå›´å¯èƒ½å·²ç»æ‰©å¤§äº†ï¼Œç„¶è€Œï¼Œæˆ‘ä»¬ä¸å¯èƒ½å› ä¸ºè¿™æ ·å…³é—­æ•´ä¸ªæœºæˆ¿ï¼Œæ‰€ä»¥ï¼Œåˆ©ç”¨å›¾è°±è¾…åŠ©æ‰¾å‡ºå—å½±å“èŒƒå›´ä¼šæœ‰ä¸€äº›å¸®åŠ©ã€‚ ä¸‹é¢çš„æŸ¥è¯¢æ¨¡å¼æ˜¯ï¼š æ‰¾å‡ºå¯èƒ½è¢«å½±å“çš„å­ç½‘ï¼ˆVPCï¼‰ï¼Œæ ‡è®°æœ€é«˜çº§åˆ«é£é™©å­ç½‘ä¸ºåç»­å®šä½åšå‡†å¤‡ æ‰¾åˆ°å¯èƒ½è¢«æ§åˆ¶äº†çš„å®¿ä¸»æœº ä»å®¿ä¸»æœºè§¦å‘ï¼Œæ‰¾å‡ºåŒä¸»æœºçš„å…¶ä»–è™šæœº ä»å…¶ä»–è™šæœºè§¦å‘ï¼Œæ‰¾åˆ°å®ƒä»¬çš„å­ç½‘ï¼ˆVPCï¼‰ ä»å…¶ä»–è™šæœºè§¦å‘ï¼Œæ‰¾åˆ°å¯èƒ½å·²ç»è¢«å½±å“çš„ç½‘ç›˜ï¼ˆé˜²æ­¢è¢«æŒ‚è½½åˆ°å…¶ä»–æœºå™¨ï¼Œæ‰©å¤§å½±å“ï¼‰ MATCH (server_escaping_hypervisor)\u003c-[:`contains`]-(hypervisor_compromised:nova_host) WHERE id(server_escaping_hypervisor) == \"server-0\" OPTIONAL MATCH (server_escaping_hypervisor)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet_high:neutron_network) OPTIONAL MATCH (hypervisor_compromised)-[:`contains`]-\u003e(server_same_host:nova_instance) OPTIONAL MATCH (server_same_host)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet:neutron_network) OPTIONAL MATCH (server_same_host)\u003c-[:attached]-(impacted_volume:cinder_volume) RETURN impacted_subnet_high.neutron_network.name AS impacted_subnet_high, hypervisor_compromised.nova_host.name AS hypervisor_compromised, impacted_subnet.neutron_network.name AS impacted_subnet, [server_same_host.nova_instance.name, server_same_host.nova_instance.instance_name] AS server_same_host, impacted_volume.cinder_volume.name AS impacted_volume ç»“æœä¸­åˆ—å‡ºäº† server-0 è¢«æ§åˆ¶ä¹‹åï¼Œè€ƒè™‘å®¿ä¸»æœºé€ƒç¦»çš„æƒ…å†µä¸‹å¯èƒ½å—å½±å“çš„æ‰©æ•£èŒƒå›´ã€‚ impacted_subnet_high hypervisor_compromised impacted_subnet server_same_host impacted_volume shared node0 shared [â€œserver-0â€, â€œinstance-00000001â€] Empty shared node0 shared [â€œserver-1â€, â€œinstance-00000002â€] ffaeb199-47f4-4d95-89b2-97fba3c1bcfe shared node0 private [â€œserver-1â€, â€œinstance-00000002â€] ffaeb199-47f4-4d95-89b2-97fba3c1bcfe shared node0 private [â€œserver-3â€, â€œinstance-00000005â€] c9db7c2e-c712-49d6-8019-14b82de8542d shared node0 private [â€œserver-3â€, â€œinstance-00000005â€] volume-2 shared node0 public [â€œserver-4â€, â€œinstance-00000006â€] volume-2 å’±ä»¬å†çœ‹çœ‹å®ƒçš„å¯è§†åŒ–ç»“æœã€‚ MATCH p=(server_escaping_hypervisor)\u003c-[:`contains`]-(hypervisor_compromised:nova_host) WHERE id(server_escaping_hypervisor) == \"server-0\" OPTIONAL MATCH p0=(server_escaping_hypervisor)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet_high:neutron_network) OPTIONAL MATCH p1=(hypervisor_compromised)-[:`contains`]-\u003e(server_same_host:nova_instance) OPTIONAL MA","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:5","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#é•œåƒäº‘ç›˜æ¼æ´èŒƒå›´åˆ†æ"},{"categories":["Nebula Graph"],"content":" 4.5 å®‰å…¨ç›¸å…³åœºæ™¯åŸºç¡€è®¾æ–½èµ„æºä¸­çš„å…³è”å…³ç³»å’Œé‡‘èã€å†…å®¹ç³»ç»Ÿã€ç”µå•†é¢†åŸŸçš„é£æ§åœºæ™¯æœ‰ç›¸ä¼¼çš„åœ°æ–¹ï¼Œå¾ˆå¤šåœºæ™¯æœ¬è´¨ä¸Šåˆ©ç”¨åˆ°äº†å›¾è°±å…³ç³»ä¸­çš„çŸ¥è¯†ï¼Œåœ¨å›¾åº“ä¸Šå®æ—¶è·å–è¿™äº›å¤æ‚å¤šè·³å¤©ç„¶å¸¦æœ‰å¯è§£é‡Šæ€§çš„å®‰å…¨æ´å¯Ÿéå¸¸é€‚åˆã€‚ 4.5.1 ç§˜é’¥æ³„æ¼é£æ§åˆ†æå…ˆçœ‹ä¸€ä¸ªç§˜é’¥æ³„æ¼çš„åœºæ™¯ï¼šå‡è®¾ key-0 è¢«å®‰å…¨éƒ¨é—¨ç¡®å®šè¢«æ³„æ¼äº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯«ç§’æ—¶é—´å†…è·å¾—å¦‚ä¸‹æŸ¥è¯¢ï¼š ç›´æ¥é‡‡ç”¨äº†å¯†é’¥çš„è™šæœº ä¸é‡‡ç”¨ç§˜é’¥çš„è™šæœºç½‘ç»œç›´è¿çš„æœºå™¨ ä¸é‡‡ç”¨ç§˜é’¥çš„è™šæœºè·¨ç½‘ç»œç›¸è¿çš„æœºå™¨ MATCH (key_leaked)-[:`used_by`]-\u003e(involved_server:nova_instance)--(:neutron_port)--(net:neutron_network)--(:neutron_port)--(server_b:nova_instance) WHERE id(key_leaked) == \"key-0\" OPTIONAL MATCH (server_b)--()--(other_net:neutron_network)--(:neutron_port)--(server_c:nova_instance) WITH involved_server, server_b AS same_subnet_machines, server_c AS cross_net_machines WHERE cross_net_machines != involved_server RETURN involved_server.nova_instance.name AS with_key, same_subnet_machines.nova_instance.name AS l2_vms, cross_net_machines.nova_instance.name AS cross_vpc_vms è´´ä¸€ä¸‹éƒ¨åˆ†ç»“æœï¼Œæˆ‘ä»¬çŸ¥é“ server-4 é‡‡ç”¨äº†è¿™ä¸ª keypairï¼Œå¹¶ä¸” server-6 å’Œå®ƒåœ¨åŒä¸€ä¸ªç½‘ç»œï¼ŒåŒæ—¶ï¼Œæœ‰ä¸€å®šå¯èƒ½ï¼Œé€šè¿‡ server-6ï¼Œserver-1,2,0,5 ä¹Ÿå—åˆ°äº†å¨èƒã€å½±å“ï¼Œç›¸å…³çš„æœºå™¨å¯ä»¥è¢«è§¦å‘ä¸åŒçº§åˆ«çš„å‘Šè­¦æ¥é™ä½å®‰å…¨äº‹æ•…çš„å½±å“ã€‚ with_key l2_vms cross_vpc_vms server-4 server-6 server-1 server-4 server-6 server-2 server-4 server-6 server-0 server-4 server-6 server-5 è¿™ä¸ªæŸ¥è¯¢æ”¹é€ ä¸ºå¯è§†åŒ–ç»“æœï¼š MATCH p=(key_leaked)-[:`used_by`]-\u003e(involved_server:nova_instance)--(:neutron_port)--(net:neutron_network)--(:neutron_port)--(server_b:nova_instance) WHERE id(key_leaked) == \"key-0\" OPTIONAL MATCH p1=(server_b)--()--(other_net:neutron_network)--(:neutron_port)--(server_c:nova_instance) RETURN p,p1 åœ¨ explorer é‡Œ åº”ç”¨ Dagre-LR çš„å¸ƒå±€ï¼Œä¸€å…³è”å…³ç³»å¾ˆæ¸…æ™°çš„è¢«å±•ç¤ºå‡ºæ¥ï¼Œä¹Ÿè®¸å¯ä»¥è€ƒè™‘æŠŠå®ƒå¼•ç”¨åœ¨å®‰å…¨äº‹æ•…çš„æŠ¥å‘Šåˆ†å‘ç»™è™šæœºç§Ÿæˆ·ã€‚ 4.5.2 é•œåƒã€äº‘ç›˜æ¼æ´èŒƒå›´åˆ†æç±»ä¼¼çš„ï¼Œä¸€ä¸ªé•œåƒè¢«æ‰«å‡ºæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥ç¬é—´æŸ¥åˆ°æ¶‰åŠåˆ°çš„èµ„æºï¼Œå¹¶åšå‡ºç›¸åº” é•œåƒæ–‡ä»¶æœ‰æ¼æ´ MATCH p=(image_risky)-[:`created_from`]-(step1) WHERE id(image_risky) == \"cirros-0.5.2-x86_64-disk\" OPTIONAL MATCH p1=(step1)-[:created_from*1..5]-(step2) RETURN p, p1 ä¸€ä¸ªäº‘ç›˜æœ‰æ¼æ´ MATCH p=(volume_risky)-[:`created_from`]-(step1) WHERE id(volume_risky) == \"volume-1\" OPTIONAL MATCH p1=(step1)-[:created_from*1..5]-(step2) RETURN p, p1 4.5.3 æ½œåœ¨å®¿ä¸»æœºé€ƒç¦»å½±å“èŒƒå›´åˆ†ææœ€åï¼Œæˆ‘ä»¬è®¨è®ºä¸€ä¸ªæ¯”è¾ƒä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼šå®¿ä¸»æœºé€ƒç¦»ã€‚ åœ¨æç«¯çš„æƒ…å†µä¸‹å¦‚æœåœ¨æˆ‘ä»¬å¾—åˆ°æ¶ˆæ¯ï¼Œserver-0 å‘ç”Ÿäº†æœ‰å¯èƒ½å½±å“å®¿ä¸»æœºçš„å®‰å…¨æ—¶é—´çš„æ—¶å€™ï¼Œä»…ä»…å…³é—­è¿™ä¸ªå®¿ä¸»æœºæ˜¯ä¸å¤Ÿçš„ï¼Œå—å½±å“çš„èŒƒå›´å¯èƒ½å·²ç»æ‰©å¤§äº†ï¼Œç„¶è€Œï¼Œæˆ‘ä»¬ä¸å¯èƒ½å› ä¸ºè¿™æ ·å…³é—­æ•´ä¸ªæœºæˆ¿ï¼Œæ‰€ä»¥ï¼Œåˆ©ç”¨å›¾è°±è¾…åŠ©æ‰¾å‡ºå—å½±å“èŒƒå›´ä¼šæœ‰ä¸€äº›å¸®åŠ©ã€‚ ä¸‹é¢çš„æŸ¥è¯¢æ¨¡å¼æ˜¯ï¼š æ‰¾å‡ºå¯èƒ½è¢«å½±å“çš„å­ç½‘ï¼ˆVPCï¼‰ï¼Œæ ‡è®°æœ€é«˜çº§åˆ«é£é™©å­ç½‘ä¸ºåç»­å®šä½åšå‡†å¤‡ æ‰¾åˆ°å¯èƒ½è¢«æ§åˆ¶äº†çš„å®¿ä¸»æœº ä»å®¿ä¸»æœºè§¦å‘ï¼Œæ‰¾å‡ºåŒä¸»æœºçš„å…¶ä»–è™šæœº ä»å…¶ä»–è™šæœºè§¦å‘ï¼Œæ‰¾åˆ°å®ƒä»¬çš„å­ç½‘ï¼ˆVPCï¼‰ ä»å…¶ä»–è™šæœºè§¦å‘ï¼Œæ‰¾åˆ°å¯èƒ½å·²ç»è¢«å½±å“çš„ç½‘ç›˜ï¼ˆé˜²æ­¢è¢«æŒ‚è½½åˆ°å…¶ä»–æœºå™¨ï¼Œæ‰©å¤§å½±å“ï¼‰ MATCH (server_escaping_hypervisor)\u003c-[:`contains`]-(hypervisor_compromised:nova_host) WHERE id(server_escaping_hypervisor) == \"server-0\" OPTIONAL MATCH (server_escaping_hypervisor)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet_high:neutron_network) OPTIONAL MATCH (hypervisor_compromised)-[:`contains`]-\u003e(server_same_host:nova_instance) OPTIONAL MATCH (server_same_host)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet:neutron_network) OPTIONAL MATCH (server_same_host)\u003c-[:attached]-(impacted_volume:cinder_volume) RETURN impacted_subnet_high.neutron_network.name AS impacted_subnet_high, hypervisor_compromised.nova_host.name AS hypervisor_compromised, impacted_subnet.neutron_network.name AS impacted_subnet, [server_same_host.nova_instance.name, server_same_host.nova_instance.instance_name] AS server_same_host, impacted_volume.cinder_volume.name AS impacted_volume ç»“æœä¸­åˆ—å‡ºäº† server-0 è¢«æ§åˆ¶ä¹‹åï¼Œè€ƒè™‘å®¿ä¸»æœºé€ƒç¦»çš„æƒ…å†µä¸‹å¯èƒ½å—å½±å“çš„æ‰©æ•£èŒƒå›´ã€‚ impacted_subnet_high hypervisor_compromised impacted_subnet server_same_host impacted_volume shared node0 shared [â€œserver-0â€, â€œinstance-00000001â€] Empty shared node0 shared [â€œserver-1â€, â€œinstance-00000002â€] ffaeb199-47f4-4d95-89b2-97fba3c1bcfe shared node0 private [â€œserver-1â€, â€œinstance-00000002â€] ffaeb199-47f4-4d95-89b2-97fba3c1bcfe shared node0 private [â€œserver-3â€, â€œinstance-00000005â€] c9db7c2e-c712-49d6-8019-14b82de8542d shared node0 private [â€œserver-3â€, â€œinstance-00000005â€] volume-2 shared node0 public [â€œserver-4â€, â€œinstance-00000006â€] volume-2 å’±ä»¬å†çœ‹çœ‹å®ƒçš„å¯è§†åŒ–ç»“æœã€‚ MATCH p=(server_escaping_hypervisor)\u003c-[:`contains`]-(hypervisor_compromised:nova_host) WHERE id(server_escaping_hypervisor) == \"server-0\" OPTIONAL MATCH p0=(server_escaping_hypervisor)\u003c-[:attached]-(:neutron_port)\u003c-[:contains]-(impacted_subnet_high:neutron_network) OPTIONAL MATCH p1=(hypervisor_compromised)-[:`contains`]-\u003e(server_same_host:nova_instance) OPTIONAL MA","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:5","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#æ½œåœ¨å®¿ä¸»æœºé€ƒç¦»å½±å“èŒƒå›´åˆ†æ"},{"categories":["Nebula Graph"],"content":" 4.6 é‡ç‚¹å…³æ³¨èµ„æºæ£€æµ‹æœ€åï¼Œåˆ©ç”¨ Betweenness Centrality ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºåŸºç¡€è®¾æ–½ä¸­å½±å“é¢å¤§çš„é‚£äº›ï¼Œâ€è„†å¼±ç¯èŠ‚â€œï¼Œè¿™äº›èµ„æºä¸ä¸€å®šçœŸçš„å¤„åœ¨å±é™©çš„çŠ¶æ€ï¼Œåªæ˜¯è¯´ï¼Œå®ƒä»¬å¤„åœ¨äº†æ¯”è¾ƒé‡è¦çš„èµ„æºä¹‹é—´çš„äº¤æ±‡å¤„ï¼Œä¸€æ—¦å®ƒä»¬å‡ºé—®é¢˜ï¼Œå‡ºé—®é¢˜çš„ä»£ä»·å¯èƒ½ä¼šéå¸¸å¤§ã€‚ è¯†åˆ«å‡ºè¿™æ ·çš„èµ„æºä¹‹åæˆ‘ä»¬å¯ä»¥è€ƒè™‘ï¼š æœ‰é’ˆå¯¹æ€§é‡‡ç”¨æ›´æ¿€è¿›ã€æ˜‚è´µçš„å¥åº·æ£€æŸ¥ç­–ç•¥ï¼› è®¾å®šæ›´é«˜çš„æ”¯æŒã€å…³åˆ‡çº§åˆ«ï¼› ä¸»åŠ¨è¿ç§»ç›¸å…³è”çš„èµ„æºä»¥é™ä½â€è„†å¼±ç¯èŠ‚â€œå¯¹æ•´ä½“åŸºç¡€è®¾æ–½å¯ç”¨æ€§çš„å½±å“èŒƒå›´ï¼› è¿™æ¬¡ï¼Œæˆ‘ä»¬å°±åªåœ¨æµè§ˆå™¨å†…éƒ¨çš„å­å›¾ä¸Šåšç®—æ³•æµç¨‹éªŒè¯ï¼Œè¯»è€…æœ‹å‹ä»¬å¯ä»¥è‡ªå·±è¯•ç€åˆ©ç”¨å¼€æºçš„ NebulaGraph Algorithm æˆ–è€…ä»˜è´¹çš„ NebulaGraph Workflow+Analytics åšå…¨å›¾ä¸Šçš„ç­‰ä»·æ“ä½œã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨å‰è¾¹ç”¨è¿‡çš„æ–¹å¼å»æ‰«æå›¾ä¸Š 1000 ä¸ªç‚¹ï¼Œå¹¶ä¸”ä»å…¶å‡ºå‘ï¼Œè·³ä¸€è·³ï¼Œè·å¾—ä¸€ä¸ªæ¯”è¾ƒéšæœºçš„å­å›¾ï¼Œåœ¨æˆ‘ä»¬å½“å‰çš„æ•°æ®é›†ä¸‹ï¼Œè¿™å®é™…ä¸Šæå–äº†å…¨å›¾çš„æ•°æ®ï¼š MATCH (n) WITH n LIMIT 1000 OPTIONAL MATCH p=(n)--() RETURN p, n åœ¨å…¶ä¹‹ä¸Šï¼Œæˆ‘ä»¬è¿è¡Œ Betweenness Centrality ä¹‹åï¼Œå¾—åˆ° node0 æ˜¯åˆ†å€¼æœ€å¤§çš„â€è„†å¼±ä¸€ç¯â€œï¼Œçš„ç¡®ï¼Œå®ƒæ˜¯æˆ‘ä»¬å½“å‰å®éªŒä¸­è´Ÿè½½æœ€å¤§çš„å®¿ä¸»æœºï¼Œå¯ä»¥æƒ³è±¡å®ƒç¡®å®æ˜¯æ•…éšœä¹‹åå…¨å±€å½±å“æœ€å¤§çš„ä¸€ä¸ªèµ„æºã€‚ ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:4:6","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#é‡ç‚¹å…³æ³¨èµ„æºæ£€æµ‹"},{"categories":["Nebula Graph"],"content":" 5 æ€»ç»“åœ¨æµ·é‡æ•°æ®ã€ä¼ä¸šäº‘ã€æ··åˆäº‘çš„å¤æ‚åŸºç¡€è®¾æ–½è¿ç»´åœºæ™¯ä¸‹ï¼Œåˆ©ç”¨å›¾æ•°æ®åº“å›¾ç®—æ³•çš„èƒ½åŠ›åšé«˜æ•ˆçš„è¾…åŠ©è¿ç»´å·¥ä½œæ˜¯ä¸€ä¸ªååˆ†å€¼å¾—çš„å°è¯•ä¸æŠ€æœ¯æŠ•èµ„ã€‚ NebulaGraph ä½œä¸ºé«˜æ€§èƒ½ã€å¼€æºã€åˆ†å¸ƒå¼çš„æ–°ä¸€ä»£äº‘åŸç”Ÿå›¾æ•°æ®åº“ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå€¼å¾—è€ƒè™‘çš„å›¾åŸºç¡€è®¾æ–½é€‰å‹ç›®æ ‡ã€‚ æ¬¢è¿å¤§å®¶åœ¨æ–‡æœ«ç•™è¨€è®¨è®ºï¼Œæœ¬æ–‡çš„å¯å¤ç°ç¯å¢ƒå’Œç¤ºä¾‹çš„ ETL ç®¡é“çš„ä»£ç ã€ç¤ºä¾‹æ•°æ®å…¨éƒ½åœ¨ https://github.com/wey-gu/openstack-graph/ å¼€æºï¼Œæ¬¢è¿å¤§å®¶æ¥ä¸€èµ·å®Œå–„ã€‚ é¢˜å›¾ç‰ˆæƒï¼šIvan ","date":"2023-01-13","objectID":"/graph-enabled-infra-ops/:5:0","series":null,"tags":["Nebula Graph","DevOps","OpenStack","æ™ºèƒ½è¿ç»´","RCA"],"title":"å›¾æ•°æ®åº“é©±åŠ¨çš„åŸºç¡€è®¾æ–½è¿ç»´ç¤ºä¾‹","uri":"/graph-enabled-infra-ops/#æ€»ç»“"},{"categories":["open-source"],"content":"NebulaGraph ç¤¾åŒºå¦‚ä½•æ„å»ºå·¥å…·è®© Slackã€WeChat ä¸­å®è´µçš„ç¾¤èŠè®¨è®ºåŒæ­¥åˆ°å…¬å…±é¢†åŸŸ","date":"2022-12-19","objectID":"/build-open-communication-infra/","series":null,"tags":["community","open-source"],"title":"è¿æ¥å¾®ä¿¡ç¾¤ã€Slack å’Œ GitHubï¼šç¤¾åŒºå¼€æ”¾æ²Ÿé€šçš„åŸºç¡€è®¾æ–½æ­å»º","uri":"/build-open-communication-infra/"},{"categories":["open-source"],"content":" NebulaGraph ç¤¾åŒºå¦‚ä½•æ„å»ºå·¥å…·è®© Slackã€WeChat ä¸­å®è´µçš„ç¾¤èŠè®¨è®ºåŒæ­¥åˆ°å…¬å…±é¢†åŸŸ ","date":"2022-12-19","objectID":"/build-open-communication-infra/:0:0","series":null,"tags":["community","open-source"],"title":"è¿æ¥å¾®ä¿¡ç¾¤ã€Slack å’Œ GitHubï¼šç¤¾åŒºå¼€æ”¾æ²Ÿé€šçš„åŸºç¡€è®¾æ–½æ­å»º","uri":"/build-open-communication-infra/#"},{"categories":["open-source"],"content":" 1 è¦å¼€æ”¾ï¼Œä¸è¦å°é—­åœ¨å¼€æºç¤¾åŒºä¸­ï¼Œå¼€æ”¾çš„ä¸€ä¸ªé‡è¦æ„ä¹‰æ˜¯ç¤¾åŒºå†…çš„æ²Ÿé€šã€è®¨è®ºåº”è¯¥æ˜¯é€æ˜ã€åŒ…å®¹å¹¶ä¸”æ–¹ä¾¿æ‰€æœ‰æˆå‘˜è®¿é—®çš„ã€‚è¿™æ„å‘³ç€ç¤¾åŒºä¸­çš„ä»»ä½•äººéƒ½åº”è¯¥èƒ½å¤Ÿå‚ä¸è®¨è®ºå’Œå†³ç­–è¿‡ç¨‹ï¼Œå¹¶ä¸”æ‰€æœ‰ç›¸å…³ä¿¡æ¯åº”è¯¥å…¬å¼€å’Œè‡ªç”±åœ°å…±äº«ã€‚ åœ¨å…¬å…±åœºåˆè¿›è¡Œæ²Ÿé€šåœ¨å¼€æºç†å¿µä¸­æ˜¯é‡è¦çš„ï¼Œæ­£å¼è¿™ç§æ–¹å¼ä½¿å¾—ç¤¾åŒºçš„æˆå‘˜å¯ä»¥è¿›è¡Œæœ‰æ•ˆåœ°å…±åŒå·¥ä½œï¼Œåˆ†äº«æƒ³æ³•å’Œåé¦ˆï¼Œä¸ºé¡¹ç›®æˆ–ç¤¾åŒºåšå‡ºè´¡çŒ®ã€‚ ä¸ºäº†æ›´æ¸…æ¥šè¡¨è¾¾ï¼Œæˆ‘ä¸¾å‡ ä¸ªåé¢çš„ä¾‹å­ï¼š è¦æ±‚è´¡çŒ®è€…ä½¿ç”¨å¯¹ä»–ä»¬æ¥è¯´éš¾ä»¥è®¿é—®æˆ–éš¾ä»¥ä½¿ç”¨çš„å·¥å…·å¯èƒ½ä¼šå¦¨ç¢å¼€æºç¤¾åŒºä¸­çš„å¼€æ”¾æ²Ÿé€šã€‚ è¿™å¯èƒ½æ˜¯ç”±äºå¤šç§åŸå› ï¼Œä¾‹å¦‚ï¼š å·¥å…·å¯èƒ½æ˜‚è´µæˆ–éœ€è¦è®¸å¯è¯ï¼Œè€Œå¹¶éæ‰€æœ‰è´¡çŒ®è€…éƒ½èƒ½è´Ÿæ‹…å¾—èµ·ã€‚ å·¥å…·å¯èƒ½éš¾ä»¥ä½¿ç”¨æˆ–éœ€è¦å¾ˆé«˜çš„æŠ€æœ¯ç»éªŒç§¯ç´¯ï¼Œè€Œå¹¶éæ‰€æœ‰è´¡çŒ®è€…éƒ½å…·å¤‡ã€‚ å·¥å…·å¯èƒ½åœ¨æŸäº›æ“ä½œç³»ç»Ÿæˆ–è®¾å¤‡ä¸Šä¸å…¼å®¹ï¼Œè¿™å¯èƒ½ä½¿ä¸€äº›è´¡çŒ®è€…éš¾ä»¥è®¿é—®å®ƒä»¬ã€‚ åœ¨ä¸ä¸ç¤¾åŒºå…¶ä»–æˆå‘˜åˆ†äº«ä¸Šä¸‹æ–‡ã€è¿‡ç¨‹æˆ–ç»“æœçš„æƒ…å†µä¸‹ï¼Œåªåœ¨çº¿ä¸‹ï¼ˆä¾‹å¦‚é€šè¿‡å½“é¢æ²Ÿé€šã€IM æˆ–ç”µè¯ä¼šè®®ï¼‰è¿›è¡Œå†³ç­–å¯èƒ½ä¼šä½¿å¾ˆé‡è¦çš„çŸ¥è¯†åªè¢«å°‘æ•°è´¡çŒ®è€…æŒæ¡ã€‚ è¿™å¯èƒ½ä¼šé˜»æ­¢å…¶ä»–äººåœ¨è¿™äº›çŸ¥è¯†ä¹‹ä¸Šåšè´¡çŒ®æˆ–ä»ä¸­å­¦ä¹ ï¼Œé˜»ç¢äº†å¼€æºç¤¾åŒºæ‰€å¿…éœ€çš„å¼€æ”¾æ²Ÿé€šå’Œåä½œã€‚ æ²¡æœ‰æŠŠç³»ç»Ÿã€åŠŸèƒ½è®¾è®¡å’Œææ¡ˆä¿¡æ¯ä»¥å…¬å¼€æ–¹å¼æ–‡æ¡£åŒ–ã€å½’æ¡£ä¸‹æ¥ï¼Œä¾‹å¦‚åªæä¾›æŸä¸€ä¸ªå…¬å¸å†…ç½‘çš„é“¾æ¥ï¼Œä»è€Œå¯èƒ½ä¼¤å®³å¼€æºç¤¾åŒºçš„é€æ˜åº¦å’ŒåŒ…å®¹æ€§ã€‚ å› ä¸ºè¿™æ ·çš„ç»“æœæ˜¯ç¤¾åŒºçš„å…¶ä»–æˆå‘˜å¾ˆéš¾ä¿æŒå¯¹ç¤¾åŒºè¿›å±•çš„æ­£å¸¸äº†è§£ã€å°±æ›´ä¸ç”¨è¯´å‚ä¸è¿›æ¥åšè´¡çŒ®äº†ã€‚ä¸ºäº†ä¿ƒè¿›é€æ˜åº¦å’ŒåŒ…å®¹æ€§ï¼Œå¼€æºç¤¾åŒºåº”å°½é‡ç¡®ä¿æ‰€æœ‰é‡è¦çš„ä¿¡æ¯å…¬å¼€å’Œè‡ªç”±åœ°å…±äº«ã€å°½å¯èƒ½ä¿æœ‰ç»†èŠ‚åœ°è¢«å…¬å¼€å½’æ¡£ã€‚ ","date":"2022-12-19","objectID":"/build-open-communication-infra/:1:0","series":null,"tags":["community","open-source"],"title":"è¿æ¥å¾®ä¿¡ç¾¤ã€Slack å’Œ GitHubï¼šç¤¾åŒºå¼€æ”¾æ²Ÿé€šçš„åŸºç¡€è®¾æ–½æ­å»º","uri":"/build-open-communication-infra/#è¦å¼€æ”¾ä¸è¦å°é—­"},{"categories":["open-source"],"content":" 2 æŒ‘æˆ˜ä¸ºäº†ä½¿ç¤¾åŒºï¼ˆæˆ–å·¥ä½œç¯å¢ƒï¼‰çš„æ²Ÿé€šä¿æŒé€æ˜ã€é«˜æ•ˆå’Œå¥åº·ï¼Œå…¶å®å·²ç»å­˜åœ¨ä¸€äº›å…±è¯†ï¼Œå’Œé€šç”¨çš„åšæ³•ï¼š å¼‚æ­¥ä¼˜äºåŒæ­¥ï¼Œåœ¨åˆ†å¸ƒå¼å’Œå…¨çƒåä½œçš„æƒ…å†µä¸‹ï¼ŒåŒæ­¥é€šä¿¡åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æˆæœ¬é«˜ä¸”æ•ˆç‡ä½ã€‚ å› æ­¤ï¼Œæ¨èä½¿ç”¨ GitHub Discussion å’Œ StackOverflow è¿›è¡Œæé—®å¼çš„æ²Ÿé€šã€‚ ä¸“é¢˜ï¼ˆThreadï¼‰è®¨è®ºä¼˜äºå¹¿æ’­ï¼ˆFan out)ï¼Œæ³¨æ„åŠ›æ˜¯å®è´µçš„ï¼Œå‘æ‰€æœ‰äººç¾¤å‘æœ€ç»ˆå¸¸å¸¸å¯¼è‡´é‡è¦ä¿¡æ¯æ²¡æœ‰äººçœŸçš„è¯»ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬åœ¨ GitHub Discussion å’Œ Slack ä¸­è®¾æœ‰åˆ†ç±»ã€é¢‘é“ã€‚å»ºç«‹ SIG æ¥è®¨è®ºä¸€äº›æœ‰è¶£çš„ä¸»é¢˜ï¼ˆå¹¶å½’æ¡£æ²Ÿé€šçš„ç»“æœï¼‰ï¼Œè€Œä¸æ˜¯å°†æ‰€æœ‰äº‹æƒ…å¸¦åˆ°ç¤¾åŒºä¼šè®®å¹¿æ³›è®¨è®ºã€‚ ä¼˜å…ˆé€‰æ‹©å¯æœç´¢/æ–‡æœ¬ã€ç‰ˆæœ¬æ§åˆ¶ã€åä½œçš„æ–¹å¼ä¸å·¥å…·ï¼Œå¹¶åœ¨å¯èƒ½çš„æƒ…å†µä¸‹é¼“åŠ±æˆå‘˜ä»¬ç»™å…¶ä»–äººåé¦ˆï¼›åœ¨åŸºç¡€è®¾æ–½ä¸Šè·Ÿè¸ªæ–‡æ¡£ã€è®¾è®¡æµç¨‹ï¼Œå¹¶ä¸”æä¾›è¯„è®ºã€review çš„èƒ½åŠ›ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬ç”¨ etherpad.opendev.org æ¥è®°å½•ç¤¾åŒºä¼šè®®æ–‡æ¡£ã€‚ ä½†æ˜¯ï¼Œå°±åƒæˆ‘ä»¬è¿˜æ˜¯éœ€è¦åŒæ­¥çš„æ²Ÿé€šã€æœ‰ IM å’Œä¼šè®®çš„éœ€æ±‚ä¸€æ ·ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›ç‰¹ä¾‹çš„æƒ…å†µï¼Œæˆ‘ä»¬ä¸èƒ½ç›²ç›®è¿½æ±‚å¼‚æ­¥ã€ç»å¯¹çš„å¼€æ”¾çš„ï¼Œæ­£å¦‚å‰è¾¹æåˆ°çš„ï¼Œèƒ½è®©æ›´å¤šå‚ä¸è€…å…¬å¹³ã€æ–¹ä¾¿ä¸ç¤¾åŒºè¿ç»“æœ¬èº«ä¹Ÿæ˜¯å¼€æ”¾çš„ä¸€éƒ¨åˆ†ï¼Œå°½ç®¡ä½¿ç”¨çš„åŸºç¡€è®¾æ–½æ˜¯å¯èƒ½æ˜¯å°é—­çš„ã€‚äº‹å®ä¸Šï¼Œå‡ ä¹æ‰€æœ‰çš„å¼€æºç¤¾åŒºéƒ½åœ¨ç”¨ç±»ä¼¼çš„æ–¹å¼å»ºç«‹ä»–ä»¬çš„å¼€æºç¤¾åŒºæ²Ÿé€šå¹³å°ï¼š Slack åœ¨ IM æ¶ˆæ¯ä¸­ä¸­æ”¯æŒä¸°å¯Œçš„æ ¼å¼åŒ–ï¼ˆæ”¯æŒ markdownï¼ï¼‰å’Œ Thread ç³»ç»Ÿï¼Œå…¶ç°ä»£åŒ–è®¾è®¡å’Œå¼€æ”¾/è½¯å®šä¹‰æ¥å£ä½¿æˆ‘ä»¬çš„å·¥ä½œæµç¨‹å¯èƒ½éå¸¸ä¼˜ç¾æµç•…ã€‚ ä¸ Slack ç›¸æ¯”ï¼Œå¾®ä¿¡åœ¨æŠ€æœ¯ç¤¾åŒºä¸­åœ¨è®¸å¤šæ–¹é¢éƒ½å¾ˆä¸ç†æƒ³ï¼ˆåªæ˜¯å› ä¸ºå®ƒä¸æ˜¯ä¸“ä¸ºè¿™æ ·åœºæ™¯è€Œè®¾è®¡çš„ï¼ï¼‰ï¼Œä½†åœ¨å›½å†…ï¼Œå®ƒæ˜¯ç¤¾åŒºä¸­æ‰€æœ‰äººéƒ½å¯ä»¥è®¿é—®çš„å”¯ä¸€å¹³å°ã€‚æ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ªå¾®ä¿¡è´¦å·ï¼Œè€Œåªæœ‰å¾ˆå°‘ä¸€éƒ¨åˆ†äººä¼šæ¯å¤©æŸ¥é‚®ä»¶ã€‚ äºæ˜¯ï¼Œæˆ‘ä»¬é¢ä¸´çš„é—®é¢˜æ˜¯ï¼Œåœ¨ NebulaGraph ç¤¾åŒºä¸­æœ‰ä¸¤ä¸ªå¹³å°æ‰¿æ‹…äº†æ²Ÿé€šçš„é‡è¦éƒ¨åˆ†ï¼Œä½†è¿™äº›ä¿¡æ¯åœ¨å‡ ä¸ªæœˆåå°±ä¼šæ¶ˆå¤±ï¼Œå®ƒä»¬åœ¨çŸ­æ—¶é—´å†…åªèƒ½è¢«å‰²è£‚çš„ä¸€éƒ¨åˆ†è´¡çŒ®è€…çœ‹åˆ°ï¼Œè€Œæœªæ¥æ²¡æœ‰äººæˆ–å…¶ä»–å¹³å°å¯ä»¥è¯»åˆ°ã€æœåˆ°å’Œå‚è€ƒã€å¼•ç”¨è¿™äº›æœ‰ä»·å€¼çš„è®¨è®ºã€‚ ","date":"2022-12-19","objectID":"/build-open-communication-infra/:2:0","series":null,"tags":["community","open-source"],"title":"è¿æ¥å¾®ä¿¡ç¾¤ã€Slack å’Œ GitHubï¼šç¤¾åŒºå¼€æ”¾æ²Ÿé€šçš„åŸºç¡€è®¾æ–½æ­å»º","uri":"/build-open-communication-infra/#æŒ‘æˆ˜"},{"categories":["open-source"],"content":" 3 æˆ‘ä»¬æ‘¸ç´¢çš„æ–¹æ¡ˆæ›¾ç»æœ‰ä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä»¬ä¼šè‡ªå·±æ‰‹åŠ¨æ”¶é›† Slackã€å¾®ä¿¡ç¾¤é‡Œçš„è®¨è®ºæ‘˜è¦ï¼Œå®šæœŸåˆ†äº«ã€å½’æ¡£åœ¨å…¬å…±é¢†åŸŸï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿç¡®å®å¸¦æ¥äº†ä¸€äº›ä»·å€¼ï¼Œç„¶è€Œï¼Œæˆ‘ä»¬æœ€åéƒ½æ²¡åšæŒä¸‹å»ï¼ŒåŸå› å¾ˆç®€å•ï¼š1. è¿™å¤ªè´¹äº‹å„¿äº†ï¼Œå®Œå…¨ä¸ scaleï¼›2. è¿™ç§æ‘˜è¦å…¶å®ä¸å¥½å¹³è¡¡èƒ½è¢«å½’æ¡£ä¿¡æ¯çš„è£å‰ªç¨‹åº¦ï¼Œæœ‰æ—¶å€™ç»†èŠ‚éå¸¸é‡è¦å´ä¸å®¹æ˜“è¢«æ‘˜è¦ä¿ç•™ã€‚ ","date":"2022-12-19","objectID":"/build-open-communication-infra/:3:0","series":null,"tags":["community","open-source"],"title":"è¿æ¥å¾®ä¿¡ç¾¤ã€Slack å’Œ GitHubï¼šç¤¾åŒºå¼€æ”¾æ²Ÿé€šçš„åŸºç¡€è®¾æ–½æ­å»º","uri":"/build-open-communication-infra/#æˆ‘ä»¬æ‘¸ç´¢çš„æ–¹æ¡ˆ"},{"categories":["open-source"],"content":" 3.1 æå®š Slack çš„ä¿¡æ¯å­¤å²›2022 å¹´ 10 æœˆï¼Œæˆ‘æ³¨æ„åˆ°äº† linen.dev è¿™ä¸ªå¼€æºé¡¹ç›®åŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ª SaaS æœåŠ¡ï¼Œæœ‰äº†å®ƒï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ Discord å’Œ Slack ä¸­çš„æ¯ä¸ª thread ä¿ç•™ï¼Œå®ƒæ•´ç«™çœ‹èµ·æ¥å’Œ Discord/ Slack æœºä¼šæ ·ï¼Œä½†æ˜¯ï¼Œå®ƒå®Œå…¨æ˜¯å¯ä»¥åŒ¿åè¢«è®¿é—®ã€å¼•ç”¨å’Œè¢«æœç´¢å¼•æ“æœç´¢çš„ã€‚ ç»è¿‡å‡ ä¸ªæœˆçš„è¯„ä¼°ï¼Œæˆ‘ä»¬æœ€ç»ˆå†³å®šäº†è®¢é˜… linen.dev æœåŠ¡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ï¼š ä¸ç”¨å»ç¢°ç°æœ‰çš„ Slackï¼Œæ‰€æœ‰ Slack çš„å¥½å¤„éƒ½èƒ½å¾—ä»¥ä¿ç•™ æœ‰äº†è¿™æ ·ä¸€ä¸ªç¤¾åŒºçš„ç«™ç‚¹ https://community-chat.nebula-graph.io/ï¼Œå…¶ä¸­ï¼ŒSlack ä¸­çš„æ¯ä¸ªå…¬å…±é¢‘é“å†…å®¹éƒ½èƒ½è¢«åŒ¿åè®¿é—®ã€èƒ½è¢«æœç´¢å¼•æ“æ”¶å½•ï¼Œè€Œè®¿å®¢è¿˜å¯ä»¥å¾ˆå®¹æ˜“çŸ¥é“æ€ä¹ˆåŠ å…¥æˆ‘ä»¬çš„ Slackï¼Œå¦‚å›¾å³ä¸Šè§’ï¼š è¿™ä¸ªç«™ä¼šå®æ—¶åŒæ­¥ Slack é‡Œçš„æ¶ˆæ¯ï¼Œé‡è¦çš„æ˜¯ï¼Œå®ƒæ˜¯é¢å‘æœç´¢å¼•æ“ä¼˜åŒ–çš„ï¼Œä½ å¯ä»¥æœæœ Kotlin ç¤¾åŒºé€šè¿‡ linen è¢«æ”¶å½•çš„ç½‘é¡µæœ‰å¤šå°‘ï¼Œæœè¿™ä¸ªï¼šâ€œsite: slack-chats.kotlinlang.orgâ€ã€‚ æ¯ä¸€ä¸ª thread éƒ½æœ‰ä¸€ä¸ªæ— éœ€ç™»å½•çš„åªè¯» URLï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿å»åˆ†äº«ã€å¼•ç”¨å®ƒï¼Œè™½ç„¶è¿™ä»¶äº‹å„¿æœ¬èº«å°±æ˜¯è¶…é“¾æ¥ã€URLçš„ä½œç”¨ï¼Œä½†æ˜¯åœ¨ç°åœ¨å·²ç»å˜å¾—éå¸¸ä¸å®¹æ˜“äº†ï¼Œæ¯”å¦‚è¿™ä¸ªæ–°é—»é‡Œæåˆ°ç°åœ¨æ–°ä¸€ä»£çš„äººä»¬æ›´å€¾å‘äºåœ¨æŠ–éŸ³é‡Œæœç´¢è€Œä¸æ˜¯åœ¨å…¬å…±é¢†åŸŸé‡Œã€‚ æœ‰äº†å®ƒï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸å¼€å¿ƒåœ°åœ¨ GitHub é‡Œå¼•ç”¨ä»»æ„ä¸€ä¸ª Slack è®¨è®ºè¯é¢˜ï¼š è§£å†³äº† Slack çš„é—®é¢˜ä¹‹åï¼Œå”¯ä¸€å‰©ä¸‹çš„ç—›ç‚¹å°±æ˜¯å¾®ä¿¡ç¾¤äº†ï¼Œæ¯å‘¨éƒ½æœ‰æŒºå¤šéå¸¸å®è´µçš„è®¨è®ºåœ¨ç¤¾åŒºç¾¤ä¸­è¿›è¡Œå´ä¸èƒ½è¢«ä¿ç•™ä¸‹æ¥ï¼ŒçœŸå®å¤ªä»¤äººå¿ƒç–¼äº†ï¼Œç»ˆäºæœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬å†³å®šæŠŠè¿™ä¸ªé—®é¢˜è§£å†³ã€‚ ","date":"2022-12-19","objectID":"/build-open-communication-infra/:3:1","series":null,"tags":["community","open-source"],"title":"è¿æ¥å¾®ä¿¡ç¾¤ã€Slack å’Œ GitHubï¼šç¤¾åŒºå¼€æ”¾æ²Ÿé€šçš„åŸºç¡€è®¾æ–½æ­å»º","uri":"/build-open-communication-infra/#æå®š-slack-çš„ä¿¡æ¯å­¤å²›"},{"categories":["open-source"],"content":" 3.2 è§£å†³å¾®ä¿¡ç¾¤çš„ä¿¡æ¯å…¬å¼€åŒ–é¦–å…ˆï¼Œèƒ½ä¸èƒ½ç›´æ¥ç”¨ Linen ä¸€æŠŠæ¢­ï¼ŒåŒæ­¥ç¾¤æ¶ˆæ¯å‘¢ï¼Ÿæˆ‘ç¡®å®åœ¨ Linen ç¤¾åŒºå’Œä»–ä»¬çš„ Kam è®¨è®ºç›´æ¥è§£å†³ IM åŒæ­¥çš„å¯èƒ½ï¼Œä¸è¿‡åˆ°ç°åœ¨ï¼Œä»–ä»¬éƒ½æ²¡æœ‰ä¼˜å…ˆè€ƒè™‘ğŸ˜­ã€‚ ç„¶åï¼Œæˆ‘å°±åœ¨æƒ³å¦‚æœç›´æ¥æŠŠå¾®ä¿¡åŒæ­¥åˆ° Slackï¼ŒLinen ä¸å°±èƒ½æŠŠå¾®ä¿¡çš„ä¿¡æ¯ä¹Ÿæ”¶å½•äº†å—ï¼Ÿ åœ¨ Twitter ä¸Š æ±‚åŠ©é»‘å®¢/å¼€æºç¤¾åŒº + ä¸€ç•ªè°ƒç ”ç¡®å®šäº†æ²¡æœ‰è¿™æ ·çš„ä¸œè¥¿å­˜åœ¨ä¹‹åï¼Œæˆ‘å†³å®šæä¸€ä¸ªï¼Œåšæˆå¼€æºé¡¹ç›®ï¼Œæˆ‘èŠ±äº†ä¸€ç‚¹æ—¶é—´å®ç°äº†æœ€åˆçš„ç‰ˆæœ¬ã€‚ çŸ³å¤´æ±¤æ¥äº† ğŸ‘‰ğŸ»ï¼šhttps://t.co/Fdhm9MkoBb#NebulaGraph ç¤¾åŒºå¾®ä¿¡ç¾¤ç°åœ¨å·²ç»ä¼šè¢«åŒæ­¥åˆ° slack äº†ã€‚ â€” Wey Gu å¤æ€ä¸º (@wey_gu) December 15, 2022 ä¸‡ä¸‡æ²¡æƒ³åˆ°ï¼Œå½“æˆ‘åšåˆ°æŠŠæ¶ˆæ¯ä»å¾®ä¿¡åŒæ­¥åˆ° Slack ä¹‹åï¼Œéšä¹‹è€Œæ¥çš„é—®é¢˜æ˜¯ï¼Œé€šè¿‡ Slack API å‘å‡ºçš„æ¶ˆæ¯ Linen å¹¶ä¸ä¼šæ”¶å½•ã€‚ ä¸ºæ­¤ï¼Œæˆ‘æ”¾å¼ƒäº† linen ä¸€æŠŠæ¢­çš„ç¾å¥½æ„¿æœ›ï¼Œè½¬è€Œè€ƒè™‘æŠŠæ¶ˆæ¯åŒæ­¥åˆ°å…¶ä»–å…¬å…±é¢†åŸŸï¼Œè€Œæˆ‘ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å°±æ˜¯ GitHub Discussions ä¹‹ä¸­ï¼ŒåˆèŠ±äº†å‘¨æœ«çš„ä¸‹åˆåŠ æ™šä¸Šï¼ŒæŠŠå®ƒåšå‡ºæ¥äº†ï¼š ç°åœ¨ï¼Œè¿™ä¸ªæœºå™¨äººç¨‹åºä¼šæŠŠé…ç½®å¥½çš„å¾®ä¿¡ç¾¤æ¶ˆæ¯åŒæ—¶åŒæ­¥åˆ° Slack é¢‘é“å’Œ GitHub Discussion ä¸­ç»™å®šçš„æ ‡ç­¾ä¸‹çš„ä¸»é¢˜ä¸­ï¼Œæ¯ä¸€ä¸ªç¾¤ä¸€ä¸ªç¤¼æ‹œæ˜¯ä¸€ä¸ªä¸»é¢˜ï¼Œæ‰€æœ‰çš„æ¶ˆæ¯éƒ½æ˜¯ä¸»é¢˜ä¸‹çš„è¯„è®ºã€‚ ","date":"2022-12-19","objectID":"/build-open-communication-infra/:3:2","series":null,"tags":["community","open-source"],"title":"è¿æ¥å¾®ä¿¡ç¾¤ã€Slack å’Œ GitHubï¼šç¤¾åŒºå¼€æ”¾æ²Ÿé€šçš„åŸºç¡€è®¾æ–½æ­å»º","uri":"/build-open-communication-infra/#è§£å†³å¾®ä¿¡ç¾¤çš„ä¿¡æ¯å…¬å¼€åŒ–"},{"categories":["open-source"],"content":" 3.3 å°ç»“ç°åœ¨ï¼Œæˆ‘ä»¬ä¿ç•™äº†æ‰€æœ‰ Slack/å¾®ä¿¡çš„ç¾å¥½çš„ä¸€é¢çš„åŒæ—¶ï¼ŒæŠŠå®ƒä»¬ä¸­çš„è®¨è®ºæ¶ˆæ¯å†å²å…¨éƒ½å½’æ¡£ã€ç´¢å¼•å¹¶å…¬å¼€åˆ°è¿™ä¸¤ä¸ªåŸŸä¹‹ä¸‹äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆé…·å‘¢ï¼Ÿ https://community-chat.nebula-graph.io/ https://github.com/vesoft-inc/nebula-community/discussions/categories/wechat-chat-history ","date":"2022-12-19","objectID":"/build-open-communication-infra/:3:3","series":null,"tags":["community","open-source"],"title":"è¿æ¥å¾®ä¿¡ç¾¤ã€Slack å’Œ GitHubï¼šç¤¾åŒºå¼€æ”¾æ²Ÿé€šçš„åŸºç¡€è®¾æ–½æ­å»º","uri":"/build-open-communication-infra/#å°ç»“"},{"categories":["open-source"],"content":" 3.4 åç»­å·¥ä½œè¿™ä¸ªåŒæ­¥å¾®ä¿¡çš„é¡¹ç›®æ˜¯ Apache 2.0 åè®®å¼€æºçš„ï¼Œå¹¶ä¸”ç°åœ¨ç”±æˆ‘å’ŒFrost Mingåœ¨ç»´æŠ¤ï¼Œè¿™é‡Œè¿˜æœ‰å¾ˆå¤šå¾…å¢å¼ºã€å®ç°çš„æ–°åŠŸèƒ½ã€æ–°ä»»åŠ¡ï¼Œæ¬¢è¿å¤§å®¶æ¥è¯•ç©ã€è´¡çŒ®ã€‚è®©æˆ‘ä»¬ä¸€èµ·æŠŠå¼€æºç¤¾åŒºçš„æ²Ÿé€šåšçš„å¤šä¸€ç‚¹å¼€æ”¾ã€å°‘ä¸€ç‚¹å°é—­å§~ é¡¹ç›®åœ°å€ ğŸ‘‰ğŸ» https://github.com/wey-gu/chatroom-syncer. ","date":"2022-12-19","objectID":"/build-open-communication-infra/:3:4","series":null,"tags":["community","open-source"],"title":"è¿æ¥å¾®ä¿¡ç¾¤ã€Slack å’Œ GitHubï¼šç¤¾åŒºå¼€æ”¾æ²Ÿé€šçš„åŸºç¡€è®¾æ–½æ­å»º","uri":"/build-open-communication-infra/#åç»­å·¥ä½œ"},{"categories":["open-source"],"content":" 4 ç»“è®ºæœ‰æ•ˆçš„æ²Ÿé€šæ˜¯æˆåŠŸçš„å¼€æºç¤¾åŒºçš„åŸºçŸ³ï¼Œå› ä¸ºå®ƒè®©åä½œã€åˆ†äº«æ€æƒ³ä¸çŸ¥è¯†ã€ä»¥åŠæ‰€æœ‰æˆå‘˜çš„å‚ä¸æˆä¸ºå¯èƒ½ã€‚ä¸ºäº†ç¡®ä¿æ²Ÿé€šé€æ˜ã€åŒ…å®¹å’Œæœ‰æ•ˆï¼Œå¯¹äºå¼€æºç¤¾åŒºæ¥è¯´ï¼Œè®©æ‰€æœ‰æˆå‘˜æœ‰æœºä¼šå‚ä¸è®¨è®ºå’Œå†³ç­–ä»¥åŠå…¬å¼€è‡ªç”±åœ°åˆ†äº«ç›¸å…³ä¿¡æ¯æ˜¯éå¸¸é‡è¦çš„ã€‚ æˆ‘ä»¬ NebulaGraph ç¤¾åŒºçš„å»ºè®¾è€…/è´¡çŒ®è€…å°†ç»§ç»­å¯»æ‰¾å’Œé»‘å®¢æ–¹æ³•ï¼Œä»¥å¼€æ”¾å’Œè‰¯å¥½çš„æ–¹å¼ä½¿äººä»¬è¿æ¥åœ¨ä¸€èµ·ï¼Œå’Œå¤§å®¶å…±å»ºæ›´å¥½çš„å¼€æºã€æŠ€æœ¯ç¤¾åŒºã€‚ é¢˜å›¾ç‰ˆæƒï¼šArtem Beliaikin ","date":"2022-12-19","objectID":"/build-open-communication-infra/:4:0","series":null,"tags":["community","open-source"],"title":"è¿æ¥å¾®ä¿¡ç¾¤ã€Slack å’Œ GitHubï¼šç¤¾åŒºå¼€æ”¾æ²Ÿé€šçš„åŸºç¡€è®¾æ–½æ­å»º","uri":"/build-open-communication-infra/#ç»“è®º"},{"categories":["Nebula Graph"],"content":"æœ¬æ–‡æ˜¯ä¸€ä¸ªåŸºäº NebulaGraph ä¸Šè§£å†³ç¤¾äº¤ç½‘ç»œé—®é¢˜çš„å¸¸è§„æ–¹æ³•ç»¼è¿°ã€‚å…¶ä¸­ä»‹ç»çš„æ–¹æ³•æä¾›éƒ½äº† Playground ä¾›å¤§å®¶å­¦ä¹ ã€ç©è€ã€‚","date":"2022-12-08","objectID":"/nebulagraph-sns/","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/"},{"categories":["Nebula Graph"],"content":" å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨ æœ¬æ–‡æ˜¯ä¸€ä¸ªåŸºäº NebulaGraph ä¸Šè§£å†³ç¤¾äº¤ç½‘ç»œé—®é¢˜çš„å¸¸è§„æ–¹æ³•ç»¼è¿°ã€‚å…¶ä¸­ä»‹ç»çš„æ–¹æ³•æä¾›éƒ½äº† Playground ä¾›å¤§å®¶å­¦ä¹ ã€ç©è€ã€‚ ç¤¾äº¤ç½‘ç»œå¤§å®¶éƒ½ä¸é™Œç”Ÿï¼Œæ— è®ºæ˜¯å¾®ä¿¡ã€å¾®åšã€B ç«™è¿˜æ˜¯å¤§ä¼—ç‚¹è¯„ã€çŸ¥ä¹ã€é™Œé™Œç­‰æœåŠ¡ï¼Œå…¶æœ¬è´¨ä¸Šçš„ç”¨æˆ·éƒ½å½¢æˆäº†ç¤¾äº¤ç½‘ç»œã€‚ åœ¨ä¸€ä¸ªç¤¾äº¤ç½‘ç»œç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å›¾æ•°æ®åº“æ¥è¡¨ç¤ºç”¨æˆ·å’Œä»–ä»¬çš„è¿æ¥å…³ç³»ã€‚å›¾æ•°æ®åº“èƒ½å…è®¸å¯¹ç”¨æˆ·ä¹‹é—´çš„å…³ç³»è¿›è¡Œæœ‰æ•ˆçš„æŸ¥è¯¢ï¼Œä½¿å¾—å„ç§åŸºäºè¿æ¥æŸ¥æ‰¾ã€ç»Ÿè®¡ã€åˆ†æçš„ç¤¾äº¤ç½‘ç»œä¸Šçš„ä¸šåŠ¡å®ç°å˜å¾—å¯è¡Œã€é«˜æ•ˆã€‚ ä¾‹å¦‚ï¼Œå›¾å½¢æ•°æ®åº“å¯ä»¥ç”¨æ¥è¯†åˆ«ç½‘ç»œä¸­çš„â€œæœ‰å½±å“åŠ›ç”¨æˆ·â€ï¼Œæˆ–è€…æ ¹æ®ç”¨æˆ·ä¹‹é—´çš„å…±åŒç‚¹å¯¹æ–°çš„è¿æ¥ï¼ˆå¥½å‹å…³ç³»ã€å…³å¿ƒçš„å†…å®¹ï¼‰è¿›è¡Œæ¨èï¼Œå†æˆ–è€…å¯»æ‰¾ç¤¾ç¾¤ä¸­ç›¸èšé›†çš„ä¸åŒäººç¾¤ã€ç¤¾åŒºï¼Œè¿›è¡Œç”¨æˆ·ç”»åƒã€‚å›¾å½¢æ•°æ®åº“å› ä¸ºåœ¨èƒ½æ”¯æ’‘å¤æ‚å¤šè·³æŸ¥è¯¢çš„åŒæ—¶ä¹Ÿèƒ½æ”¯æŒå®æ—¶å†™å…¥ã€æ›´æ–°ï¼Œä½¿å…¶éå¸¸é€‚åˆåº”ç”¨åœ¨ç”¨æˆ·å…³ç³»ä¸æ–­å˜åŒ–çš„ç¤¾äº¤ç½‘ç»œç³»ç»Ÿä¹‹ä¸Šã€‚ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:0:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨"},{"categories":["Nebula Graph"],"content":" 1 å›¾å»ºæ¨¡ä¸ºäº†ç»™å‡ºä¸€äº›å¸¸è§ç¤¾äº¤åœºæ™¯çš„åº”ç”¨ç¤ºä¾‹ï¼Œæˆ‘ä¼šæŠŠå¤§å¤šæ•°ä¾‹å­å»ºç«‹åœ¨ä¸€ä¸ªå…¸å‹çš„å°å‹ç¤¾äº¤ç½‘ç»œä¸Šï¼Œç¤¾äº¤ç½‘ç»œå¤©ç„¶å°±æ˜¯ä¸€å¼ ç½‘ç»œã€å›¾çš„å½¢æ€ã€‚ ä¸ºæ­¤ï¼Œæˆ‘åœ¨ NebulaGraph å®˜æ–¹ç¤ºä¾‹æ•°æ®é›†ï¼šç¯®çƒè¿åŠ¨å‘˜ä¹‹ä¸Šï¼Œå¢åŠ äº†ä¸‰ç§ç‚¹ï¼š åœ°å€ åœ°ç‚¹ æ–‡ç«  äº”ç§è¾¹ï¼š å‘æ–‡ è¯„è®º ä½åœ¨ å±äºï¼ˆåœ°ç‚¹ï¼‰ å®ƒçš„å»ºæ¨¡éå¸¸è‡ªç„¶ï¼š ","date":"2022-12-08","objectID":"/nebulagraph-sns/:1:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#å›¾å»ºæ¨¡"},{"categories":["Nebula Graph"],"content":" 2 æ•°æ®å¯¼å…¥","date":"2022-12-08","objectID":"/nebulagraph-sns/:2:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æ•°æ®å¯¼å…¥"},{"categories":["Nebula Graph"],"content":" 2.1 åŠ è½½é»˜è®¤æ•°æ®é›†é¦–å…ˆï¼Œæˆ‘ä»¬åŠ è½½é»˜è®¤çš„ basketballplayer æ•°æ®é›†ã€‚ åœ¨å‘½ä»¤è¡Œ console ä¹‹ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰§è¡Œ :play basketballplayer å°±å¯ä»¥ã€‚ è€Œåœ¨ NebulaGraph Studio/Explorer ä¹‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¬¢è¿é¡µç‚¹å‡»ä¸‹è½½å°±éƒ¨ç½²è¿™ä»½åŸºç¡€æ•°æ®é›†ã€‚ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:2:1","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#åŠ è½½é»˜è®¤æ•°æ®é›†"},{"categories":["Nebula Graph"],"content":" 2.2 åŠ è½½ç¤¾äº¤ç½‘ç»œ schemaå…¶æ¬¡æˆ‘ä»¬æ‰§è¡Œä¸‹è¾¹çš„è¯­å¥ï¼Œé¦–å…ˆæ˜¯ Schema å®šä¹‰çš„è¯­å¥ï¼š CREATE TAG IF NOT EXISTS post(title string NOT NULL); CREATE EDGE created_post(post_time timestamp); CREATE EDGE commented_at(post_time timestamp); CREATE TAG address(address string NOT NULL, `geo_point` geography(point)); CREATE TAG place(name string NOT NULL, `geo_point` geography(point)); CREATE EDGE belong_to(); CREATE EDGE lived_in(); ","date":"2022-12-08","objectID":"/nebulagraph-sns/:2:2","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#åŠ è½½ç¤¾äº¤ç½‘ç»œ-schema"},{"categories":["Nebula Graph"],"content":" 2.3 åŠ è½½æ•°æ®ç„¶åï¼Œåœ¨ç­‰ä¸¤ä¸ªå¿ƒè·³æ—¶é—´ä»¥ä¸Šä¹‹åï¼ˆ20ç§’ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œæ•°æ®æ’å…¥ï¼š INSERT VERTEX post(title) values \\ \"post1\":(\"a beautify flower\"), \"post2\":(\"my first bike\"), \"post3\":(\"I can swim\"), \\ \"post4\":(\"I love you, Dad\"), \"post5\":(\"I hate coriander\"), \"post6\":(\"my best friend, tom\"), \\ \"post7\":(\"my best friend, jerry\"), \"post8\":(\"Frank, the cat\"), \"post9\":(\"sushi rocks\"), \\ \"post10\":(\"I love you, Mom\"), \"post11\":(\"Let's have a party!\"); INSERT EDGE created_post(post_time) values \\ \"player100\"-\u003e\"post1\":(timestamp(\"2019-01-01 00:30:06\")), \\ \"player111\"-\u003e\"post2\":(timestamp(\"2016-11-23 10:04:50\")), \\ \"player101\"-\u003e\"post3\":(timestamp(\"2019-11-11 10:44:06\")), \\ \"player103\"-\u003e\"post4\":(timestamp(\"2014-12-01 20:45:11\")), \\ \"player102\"-\u003e\"post5\":(timestamp(\"2015-03-01 00:30:06\")), \\ \"player104\"-\u003e\"post6\":(timestamp(\"2017-09-21 23:30:06\")), \\ \"player125\"-\u003e\"post7\":(timestamp(\"2018-01-01 00:44:23\")), \\ \"player106\"-\u003e\"post8\":(timestamp(\"2019-01-01 00:30:06\")), \\ \"player117\"-\u003e\"post9\":(timestamp(\"2022-01-01 22:23:30\")), \\ \"player108\"-\u003e\"post10\":(timestamp(\"2011-01-01 10:00:30\")), \\ \"player100\"-\u003e\"post11\":(timestamp(\"2021-11-01 11:10:30\")); INSERT EDGE commented_at(post_time) values \\ \"player105\"-\u003e\"post1\":(timestamp(\"2019-01-02 00:30:06\")), \\ \"player109\"-\u003e\"post1\":(timestamp(\"2016-11-24 10:04:50\")), \\ \"player113\"-\u003e\"post3\":(timestamp(\"2019-11-13 10:44:06\")), \\ \"player101\"-\u003e\"post4\":(timestamp(\"2014-12-04 20:45:11\")), \\ \"player102\"-\u003e\"post1\":(timestamp(\"2015-03-03 00:30:06\")), \\ \"player103\"-\u003e\"post1\":(timestamp(\"2017-09-23 23:30:06\")), \\ \"player102\"-\u003e\"post7\":(timestamp(\"2018-01-04 00:44:23\")), \\ \"player101\"-\u003e\"post8\":(timestamp(\"2019-01-04 00:30:06\")), \\ \"player106\"-\u003e\"post9\":(timestamp(\"2022-01-02 22:23:30\")), \\ \"player105\"-\u003e\"post10\":(timestamp(\"2011-01-11 10:00:30\")), \\ \"player130\"-\u003e\"post1\":(timestamp(\"2019-01-02 00:30:06\")), \\ \"player131\"-\u003e\"post2\":(timestamp(\"2016-11-24 10:04:50\")), \\ \"player131\"-\u003e\"post3\":(timestamp(\"2019-11-13 10:44:06\")), \\ \"player133\"-\u003e\"post4\":(timestamp(\"2014-12-04 20:45:11\")), \\ \"player132\"-\u003e\"post5\":(timestamp(\"2015-03-03 00:30:06\")), \\ \"player134\"-\u003e\"post6\":(timestamp(\"2017-09-23 23:30:06\")), \\ \"player135\"-\u003e\"post7\":(timestamp(\"2018-01-04 00:44:23\")), \\ \"player136\"-\u003e\"post8\":(timestamp(\"2019-01-04 00:30:06\")), \\ \"player137\"-\u003e\"post9\":(timestamp(\"2022-01-02 22:23:30\")), \\ \"player138\"-\u003e\"post10\":(timestamp(\"2011-01-11 10:00:30\")), \\ \"player141\"-\u003e\"post1\":(timestamp(\"2019-01-03 00:30:06\")), \\ \"player142\"-\u003e\"post2\":(timestamp(\"2016-11-25 10:04:50\")), \\ \"player143\"-\u003e\"post3\":(timestamp(\"2019-11-14 10:44:06\")), \\ \"player144\"-\u003e\"post4\":(timestamp(\"2014-12-05 20:45:11\")), \\ \"player145\"-\u003e\"post5\":(timestamp(\"2015-03-04 00:30:06\")), \\ \"player146\"-\u003e\"post6\":(timestamp(\"2017-09-24 23:30:06\")), \\ \"player147\"-\u003e\"post7\":(timestamp(\"2018-01-05 00:44:23\")), \\ \"player148\"-\u003e\"post8\":(timestamp(\"2019-01-05 00:30:06\")), \\ \"player139\"-\u003e\"post9\":(timestamp(\"2022-01-03 22:23:30\")), \\ \"player140\"-\u003e\"post10\":(timestamp(\"2011-01-12 10:01:30\")), \\ \"player141\"-\u003e\"post1\":(timestamp(\"2019-01-04 00:34:06\")), \\ \"player102\"-\u003e\"post2\":(timestamp(\"2016-11-26 10:06:50\")), \\ \"player103\"-\u003e\"post3\":(timestamp(\"2019-11-15 10:45:06\")), \\ \"player104\"-\u003e\"post4\":(timestamp(\"2014-12-06 20:47:11\")), \\ \"player105\"-\u003e\"post5\":(timestamp(\"2015-03-05 00:32:06\")), \\ \"player106\"-\u003e\"post6\":(timestamp(\"2017-09-25 23:31:06\")), \\ \"player107\"-\u003e\"post7\":(timestamp(\"2018-01-06 00:46:23\")), \\ \"player118\"-\u003e\"post8\":(timestamp(\"2019-01-06 00:35:06\")), \\ \"player119\"-\u003e\"post9\":(timestamp(\"2022-01-04 22:26:30\")), \\ \"player110\"-\u003e\"post10\":(timestamp(\"2011-01-15 10:00:30\")), \\ \"player111\"-\u003e\"post1\":(timestamp(\"2019-01-06 00:30:06\")), \\ \"player104\"-\u003e\"post11\":(timestamp(\"2022-01-15 10:00:30\")), \\ \"player125\"-\u003e\"post11\":(timestamp(\"2022-02-15 10:00:30\")), \\ \"player113\"-\u003e\"post11\":(timestamp(\"2022-03-15 10:00:30\")), \\ \"player102\"-\u003e\"post11\":(timestamp(\"2022-04-15 10:00:30\")), \\ \"player108\"-\u003e\"post11\":(timestamp(\"2022-05-15 10:00:30\")); INSERT VERTEX `address` (`address`, `geo_point`) VALUES \\ \"addr_0\":(\"Brittany Forge Apt. 718 East Eric WV 97881\", ST_Point(1,2)),\\ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:2:3","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#åŠ è½½æ•°æ®"},{"categories":["Nebula Graph"],"content":" 2.4 æ•°æ®åˆæ¢é¦–å…ˆï¼Œæˆ‘ä»¬çœ‹çœ‹æ•°æ®ç»Ÿè®¡ [basketballplayer]\u003e SUBMIT JOB STATS; +------------+ | New Job Id | +------------+ | 10 | +------------+ [basketballplayer]\u003e SHOW STATS; +---------+----------------+-------+ | Type | Name | Count | +---------+----------------+-------+ | \"Tag\" | \"address\" | 19 | | \"Tag\" | \"place\" | 14 | | \"Tag\" | \"player\" | 51 | | \"Tag\" | \"post\" | 10 | | \"Tag\" | \"team\" | 30 | | \"Edge\" | \"belong_to\" | 19 | | \"Edge\" | \"commented_at\" | 40 | | \"Edge\" | \"created_post\" | 10 | | \"Edge\" | \"follow\" | 81 | | \"Edge\" | \"lived_in\" | 19 | | \"Edge\" | \"serve\" | 152 | | \"Space\" | \"vertices\" | 124 | | \"Space\" | \"edges\" | 321 | +---------+----------------+-------+ Got 13 rows (time spent 1038/51372 us) æŸ¥ä¸€ä¸‹æ‰€æœ‰çš„æ•°æ® MATCH ()-[e]-\u003e() RETURN e LIMIT 10000 å› ä¸ºæ•°æ®é‡å¤ªå°äº†ï¼Œæ‰€ä»¥å¯ä»¥æŠŠæ‰€æœ‰æ•°æ®åœ¨ NebulaGraph Explorer ä¸­æ¸²æŸ“å‡ºæ¥ï¼š ","date":"2022-12-08","objectID":"/nebulagraph-sns/:2:4","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æ•°æ®åˆæ¢"},{"categories":["Nebula Graph"],"content":" 3 æ‰¾å‡ºç½‘ç»œä¸­çš„å…³é”®äººç‰©è¯†åˆ«ç¤¾äº¤ç½‘ç»œä¸­çš„æœ‰å½±å“çš„å…³é”®äººç‰©ä»¬ï¼ˆinfluencersï¼‰æ¶‰åŠä½¿ç”¨å„ç§æŒ‡æ ‡å’Œæ–¹æ³•æ¥è¯†åˆ«åœ¨ç‰¹å®šç½‘ç»œä¸­æ‹¥æœ‰å¤§é‡å½±å“åŠ›çš„ä¸ªäººã€‚è¿™å¯¹å¾ˆå¤šä¸šåŠ¡åœºæ™¯éƒ½æœ‰å¸®åŠ©éƒ½å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ç”¨äºè¥é”€æˆ–ç ”ç©¶ç½‘ç»œä¸­çš„ä¿¡æ¯ä¼ æ’­ã€‚ è¯†åˆ«ä»–ä»¬çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå…·ä½“çš„æ–¹æ³•å’Œè€ƒé‡çš„ä¿¡æ¯ã€å…³ç³»ã€è§’åº¦ä¹Ÿå–å†³äºè¿™äº›å…³é”®äººç‰©çš„ç±»å‹ã€å’Œè·å–ä»–ä»¬çš„ç›®çš„ã€‚ ä¸€äº›å¸¸è§çš„æ–¹æ³•åŒ…æ‹¬çœ‹ä¸€ä¸ªäººæ‹¥æœ‰çš„ç²‰ä¸æˆ–å†…å®¹è¢«æ¶ˆè´¹çš„æ•°é‡ï¼Œä»–ä»¬åœ¨å…¶å¸–å­ã€è§†é¢‘ä¸Šè¯»è€…çš„å‚ä¸åº¦ï¼Œä»¥åŠä»–ä»¬çš„å†…å®¹çš„å½±å“åŠ›ï¼ˆè½¬å‘ã€å¼•ç”¨ï¼‰ã€‚è¿™äº›æ–¹æ³•åœ¨å›¾ä¸Šä¹Ÿæ˜¯å¯ä»¥åšçš„ï¼Œä½†æ˜¯æ¯”è¾ƒå¹³å‡¡ï¼Œæˆ‘å°±ä¸ä¸¾ä¾‹äº†ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥è¯•ç€ç”¨è¯„ä¼°ã€è®¡ç®—èŠ‚ç‚¹é‡è¦æ€§çš„å›¾ç®—æ³•ï¼Œåœ¨å›¾ä¸Šå¾—å‡ºè¿™äº›å…³é”®äººç‰©ã€‚ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:3:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æ‰¾å‡ºç½‘ç»œä¸­çš„å…³é”®äººç‰©"},{"categories":["Nebula Graph"],"content":" 3.1 PageRankPageRank æ˜¯ä¸€ä¸ªéå¸¸â€œå¤è€çš„â€å›¾ç®—æ³•ï¼Œå®ƒé€šè¿‡è€ƒè™‘å›¾ä¸Šç‚¹ä¹‹é—´çš„å…³ç³»æ•°é‡å»è¿­ä»£ï¼Œå¾—åˆ°æ¯ä¸€ä¸ªç‚¹çš„å¾—åˆ†ï¼ˆRankï¼‰ï¼Œæœ€åˆç”± Google çš„åˆ›å§‹äºº Larry Page å’Œ Sergey Brin æå‡ºå¹¶åº”ç”¨åœ¨æ—©æœŸçš„ Google æœç´¢å¼•æ“ä¸­ï¼Œç”¨æ¥æ’åºæœç´¢ç»“æœï¼Œè¿™é‡Œçš„ Page å¯ä»¥æ˜¯ Larry Page çš„å§“å’Œ Web Page çš„åŒå…³äº†ã€‚ åœ¨ç°ä»£ã€å¤æ‚çš„æœç´¢å¼•æ“ä¸­ï¼ŒPageRank æ—©å°±å› ä¸ºå…¶è¿‡äºç®€å•è€Œè¢«å¼ƒç”¨ï¼Œä½†æ˜¯åœ¨å…¶ä»–å›¾ç»“æ„ç½‘ç»œåœºæ™¯ä¸­ï¼ŒPageRank ä»ç„¶åœ¨å‘å…‰å‘çƒ­ï¼Œç¤¾äº¤ç½‘ç»œä¸­æˆ‘ä»¬å¯ä»¥ç²—ç•¥åœ°è®¤ä¸ºæ‰€æœ‰é“¾æ¥çš„é‡è¦ç¨‹åº¦ç±»ä¼¼ï¼Œå»è¿è¡Œè¿™ä¸ªç®—æ³•æ‰¾å‡ºé‚£äº›å…³é”®çš„ç”¨æˆ·ã€‚ åœ¨ NebulaGraph ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ NebulaGraph Algorithmã€NebulaGraph Analytics å»åœ¨å¤§çš„å…¨å›¾ä¸Šè¿è¡Œ PageRankï¼Œè€Œåœ¨æ—¥å¸¸çš„åˆ†æã€éªŒè¯ã€è®¾è®¡é˜¶æ®µï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨å…¨é‡æ•°æ®ä¸Šè·‘ç»“æœï¼Œè€Œåœ¨å¾ˆå°çš„å­å›¾ä¸Šï¼ˆæœ€å¤šä¸Šä¸‡ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åœ¨æµè§ˆå™¨é‡Œè¾¹è¿è¡Œå„ç§å›¾ç®—æ³•å»å¾—å‡ºçº¿ä¸Šä¸šåŠ¡å¯ä»¥ç”¨çš„æ–¹æ³•ã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ç”¨ NebulaGraph Explorer å†…ç½®çš„æµè§ˆå™¨å†…å›¾ç®—æ³•åŠŸèƒ½æ‰§è¡Œä¸€ä¸‹ PageRank çœ‹çœ‹ï¼ˆå…·ä½“æ–¹æ³•è¿™é‡Œç•¥å»ï¼Œå¯ä»¥å‚è€ƒæ–‡æ¡£ï¼Œä¸è¿‡å…¶å®å°±æ˜¯ç‚¹ä¸€ä¸‹é¼ æ ‡çš„äº‹å„¿ï¼‰ï¼š æˆ‘ä»¬å¯ä»¥ä»ä¸Šè¾¹çœ‹åˆ°ï¼ŒPageRank è®¡ç®—ä¹‹åæ‰€æœ‰ç»¿è‰²çš„ playerï¼ˆäººï¼‰ä¸­ï¼Œâ€œplayer.name: Tim Duncanâ€ æ˜¯æœ€å¤§çš„ä¸€ä¸ªç‚¹ï¼Œä¸ä¹‹ç›¸å…³è”çš„å…³ç³»çœ‹èµ·æ¥çš„ç¡®ä¸å°‘ï¼Œæˆ‘ä»¬åœ¨å›¾ä¸Šé€‰æ‹©ä»–ï¼Œå†å³é”®åé€‰ï¼Œé€‰æ‹©é™¤äº† Tim Duncan ä¹‹å¤–çš„æ‰€æœ‰ç‚¹ï¼Œç”¨é€€æ ¼é”®åˆ é™¤æ‰€æœ‰å…¶ä»–çš„ç‚¹ï¼Œç„¶ååœ¨ä»–ä½œä¸ºèµ·ç‚¹åŒå‘æ¢ç´¢å‡º1åˆ°5æ­¥ï¼Œå¯ä»¥å¾—åˆ° Tim Duncan çš„å­å›¾ï¼š ä»å­å›¾ä¸­å¯ä»¥çœ‹åˆ° Tim Duncan å’Œéå¸¸å¤šå…¶ä»–çƒå‘˜æœ‰å…³æ³¨çš„å…³ç³»çš„åŒæ—¶ï¼Œä¸€äº›å…¶ä»–å¾ˆå—æ¬¢è¿çš„é˜Ÿå‘˜å’Œä»–ä¸€èµ·ä¸€æ ·æœå½¹è¿‡éå¸¸çƒ­é—¨çš„çƒ­åˆºï¼ˆSpursï¼‰é˜Ÿï¼Œè¿™äº›éƒ½å°è¯äº† PageRank çš„è¯„ä¼°æ–¹å¼ã€‚ ç°åœ¨æˆ‘ä»¬å†çœ‹çœ‹å…¶ä»–åˆ¤å®šç»´åº¦ä¸‹çš„ç®—æ³•ä¼šä¸ä¼šå¾—å‡ºä¸€æ ·çš„ç»“è®ºå‘¢ï¼Ÿ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:3:1","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#pagerank"},{"categories":["Nebula Graph"],"content":" 3.2 Betweenness Centralityä½œä¸ºå¦ä¸€ä¸ªæµè¡Œçš„èŠ‚ç‚¹é‡è¦æ€§ç®—æ³•ï¼Œé€šè¿‡è®¡ç®—ä¸€ä¸ªèŠ‚ç‚¹å¯¹äºå›¾ä¸­çš„ä¸­ä»‹ã€æ¡¥æ¢ä½œç”¨æ¥è¡¡é‡èŠ‚ç‚¹çš„é‡è¦æ€§ï¼Œè¿™é‡Œçš„æ¡¥æ¢ä½œç”¨æ˜¯æœ‰æ•°å­¦å®šä¹‰çš„é‡åŒ–ç®—æ³•ï¼Œè¿™é‡Œå°±ä¸å±•å¼€è¯´äº†ï¼Œä¸è¿‡ä»æ„Ÿå®˜ä¸Šå¯ä»¥çœ‹å‡ºå®ƒæ˜¯å¦ä¸€ä¸ªè§’åº¦å¾ˆç¬¦åˆç›´è§‰åœ°å»è¯„ä¼°é‡è¦æ€§çš„æ–¹æ³•ã€‚ æˆ‘ä»¬é‡æ–°åœ¨ç”»å¸ƒä¸ŠæŸ¥è¯¢æ‰€æœ‰çš„ç‚¹è¾¹ä¹‹åï¼Œåœ¨æµè§ˆå™¨é‡Œè¿è¡Œ Betweenness Centrality ç®—æ³•ï¼Œè¿™æ¬¡çš„ç»“æœæ˜¯ï¼š ä»å®ƒçš„äº”è·³å†…å­å›¾å¯ä»¥çœ‹å‡ºï¼Œä¸ä¹‹å‰ PageRank æ‰€å¾—çš„å…³é”®äººç‰© Tim Duncan å‘ˆç°çš„æ˜Ÿæ˜ŸçŠ¶æ€ä¸åŒï¼ŒDejounte Murray çš„å­å›¾å‘ˆç°ç°‡çŠ¶ï¼Œåœ¨æ„Ÿå®˜ã€ç›´è§‰ä¸Šå¯ä»¥æƒ³è±¡ Dejounte Murray çœŸçš„åœ¨å¾ˆå¤šèŠ‚ç‚¹ä¹‹é—´çš„æœ€å°è·¯å¾„çš„å¿…ç»ä¹‹è·¯ä¸Šï¼Œè€Œ Tim Duncan åˆ™ä¼¼ä¹å’Œæ›´å¤šçš„é‡è¦è¿æ¥è€…äº§ç”Ÿäº†å…³è”ã€‚ åœ¨å®é™…çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸è¦é€šè¿‡ä¸åŒæ–¹å¼çš„å®šä¹‰çš„ç†è§£ã€ä¸åŒæ‰§è¡Œç»“æœçš„è¯•éªŒã€åˆ†æå»æ‰¾åˆ°æˆ‘ä»¬å…³æ³¨çš„å…³é”®äººç‰©äº§ç”Ÿå½±å“çš„ç»“æ„ç‰¹å¾ï¼Œç”¨æ¥é’ˆå¯¹ä¸åŒéœ€æ±‚é€‰æ‹©ä¸åŒçš„ç®—æ³•ã€‚ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:3:2","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#betweenness-centrality"},{"categories":["Nebula Graph"],"content":" 4 æ‰¾å‡ºç¤¾åŒºã€èšé›†ç¾¤ä½“ç¤¾äº¤ç½‘ç»œä¸­çš„ç¤¾åŒºæ£€æµ‹æ˜¯ä¸€ç§é€šè¿‡åˆ†æç¤¾äº¤å…³ç³»æ¥å‘ç°ç¤¾åŒºç»“æ„çš„æŠ€æœ¯ã€‚ç¤¾åŒºç»“æ„æ˜¯æŒ‡åœ¨ç¤¾äº¤ç½‘ç»œã€å›¾è°±ä¸­ç›¸äº’è”ç³»å¯†åˆ‡çš„ä¸€ç»„èŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹é€šå¸¸å…·æœ‰ç›¸ä¼¼çš„ç‰¹å¾æˆ–å…´è¶£ã€‚ä¾‹å¦‚ï¼Œç¤¾åŒºç»“æ„å¯èƒ½è¡¨ç°ä¸ºç”¨æˆ·æ ¹æ®å…±åŒçš„è¯é¢˜æˆ–å…´è¶£èšé›†åœ¨ä¸€èµ·çš„ä¸€ç»„ç”¨æˆ·ã€‚ ç¤¾åŒºæ£€æµ‹çš„ç›®çš„æ˜¯é€šè¿‡å¯¹ç¤¾äº¤ç½‘ç»œè¿›è¡Œåˆ†æï¼Œæ‰¾å‡ºä¸åŒç¤¾åŒºçš„è¾¹ç•Œï¼Œå¹¶ç¡®å®šæ¯ä¸ªç¤¾åŒºä¸­çš„èŠ‚ç‚¹ã€‚è¿™ä¸€è¿‡ç¨‹å¯ä»¥é€šè¿‡ä½¿ç”¨å„ç§ç®—æ³•æ¥å®Œæˆï¼Œä¾‹å¦‚æ ‡ç­¾ä¼ æ’­ç®—æ³•ã€å¼±è”é€šåˆ†é‡ç®—æ³•å’Œ Louvain ç®—æ³•ç­‰ã€‚é€šè¿‡å‘ç°ç¤¾åŒºç»“æ„ï¼Œå¯ä»¥æ›´å¥½åœ°äº†è§£ç¤¾äº¤ç½‘ç»œçš„ç»“æ„å’Œç‰¹å¾ï¼Œå¹¶æœ‰åŠ©äºç¤¾äº¤ç½‘ç»œæœåŠ¡æä¾›æ–¹æ›´å¥½åœ°æ¨æ–­å’Œé¢„æµ‹ç¤¾äº¤ç½‘ç»œä¸­çš„è¡Œä¸ºï¼Œå¸®åŠ©åšå¥½ç¤¾äº¤ç½‘ç»œçš„æ²»ç†ã€å¹¿å‘ŠæŠ•æ”¾ã€å¸‚åœºè¥é”€ç­‰ã€‚ ç”±äºæˆ‘ä»¬çš„æ•°æ®é›†æ˜¯éçœŸå®çš„ï¼Œæˆ‘åœ¨ä¸åŒçš„ç®—æ³•ä¹‹ä¸‹å¾—å‡ºçš„ç»“æœå¹¶ä¸èƒ½å±•ç°å‡ºçœŸå®çš„æ„æ¶µï¼Œæ‰€ä»¥æœ¬ç« åªæ˜¯å±•ç¤ºä¸€ä¸‹åˆ©ç”¨å‡ ä¸ªå›¾ç®—æ³•è¿›è¡Œç¤¾åŒºè¯†åˆ«ä¹‹åçš„ç»“æœï¼Œåœ¨çœŸå®ä¸–ç•Œçš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬è¿˜åº”è¯¥åœ¨æ­¤åŸºç¡€ä¹‹ä¸Šåˆ©ç”¨é¢†åŸŸçŸ¥è¯†æˆ–è€…å…¶ä»–æŠ€æœ¯æ‰‹æ®µååŒç»™å‡ºä¸åŒç¾¤ä½“ã€ç¤¾åŒºçš„ç”»åƒã€æ ‡ç­¾ã€‚ æ ‡ç­¾ä¼ æ’­ç®—æ³•æ•ˆæœï¼š Louvain ç®—æ³•æ•ˆæœï¼š å¼±è”é€šåˆ†é‡ç®—æ³•æ•ˆæœï¼š åœ¨åè¾¹çš„ç« èŠ‚ï¼Œæˆ‘ä»¬æœ‰æœºä¼šå¯ä»¥åœ¨æ›´å°ã€æ›´ç®€å•çš„å­å›¾ä¸Šå†æ¬¡éªŒè¯è¿™å‡ ä¸ªç®—æ³•ï¼Œç»“æœä¼šæ›´æœ‰å¯è§£é‡Šæ€§ä¸€äº›ã€‚ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:4:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æ‰¾å‡ºç¤¾åŒºèšé›†ç¾¤ä½“"},{"categories":["Nebula Graph"],"content":" 5 å¥½å‹äº²å¯†åº¦é€šè¿‡ç¤¾åŒºè¯†åˆ«ç®—æ³•ï¼Œå…¶å®æ˜¯èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šï¼Œåœ¨å…¨å±€è®¡ç®—è·å¾—å…´è¶£ç›¸è¿‘ã€å…³è”ç´§å¯†çš„å¥½å‹çš„ã€‚é‚£ä¹ˆå¦‚ä½•è·å¾—ä¸€ä¸ªç»™å®šç”¨æˆ·çš„å…¶ä»–äº²å¯†å¥½å‹å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—è¿™ä¸ªç”¨æˆ·çš„å¥½å‹ä¸­ï¼Œå’Œä»–å…±åŒå¥½å‹çš„ä¸ªæ•°æ¥æ’åºè·å¾—è¿™ä¸€ä¿¡æ¯ï¼ æˆ‘ä»¬æ‹¿ â€œTim Duncanâ€ ä¸¾ä¾‹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œä»–çš„ä¸¤åº¦å¥½å‹ï¼ˆå¥½å‹çš„å¥½å‹ï¼š(:player{name: \"Tim Duncan\"})-[:follow]-(f:player)-[:follow]-(fof:player)ï¼‰å¦‚æœåŒæ—¶ä¹Ÿæ˜¯ä»–çš„å¥½å‹çš„è¯ï¼Œé‚£ä¹ˆä»–ä»¬è¿™ä¸ªä¸­é—´çš„å¥½å‹å°±æ˜¯ä»–å’Œè¿™ä¸ªæœ‹å‹çš„å…±åŒå¥½å‹ï¼ˆMutual Friendï¼‰ï¼Œé‚£ä¹ˆæœ‰ç†ç”±ç›¸ä¿¡é‚£äº›å’Œ Tim Duncan æœ‰æ›´å¤šå…±åŒå¥½å‹çš„äººå¯èƒ½è·Ÿä»–æœ‰æ›´é«˜äº²å¯†åº¦ï¼š MATCH (start:`player`{name: \"Tim Duncan\"})-[:`follow`]-(f:`player`)-[:`follow`]-(fof:`player`), (start:`player`)-[:`follow`]-(fof:`player`) RETURN fof.`player`.name, count(DISTINCT f) AS NrOfMutualF ORDER BY NrOfMutualF DESC; è¿™ä¸ªè®¡ç®—ç»“æœæ˜¯ï¼Œâ€œTony Parkerâ€ å’Œ Tim æœ‰ 5 ä¸ªå…±åŒå¥½å‹ï¼Œæœ€ä¸ºäº²å¯†ã€‚ fof.player.name NrOfMutualF Tony Parker 5 Dejounte Murray 4 Manu Ginobili 3 Marco Belinelli 3 Danny Green 2 Boris Diaw 1 LaMarcus Aldridge 1 Tiago Splitter 1 ä¸‹é¢ï¼Œå’±ä»¬é€šè¿‡å¯è§†åŒ–æ¥éªŒè¯ä¸€ä¸‹è¿™ä¸ªç»“æœå§ï¼ å…ˆçœ‹çœ‹æ¯ä¸€ä¸ªå¥½å‹çš„å…±åŒå¥½å‹(f:)éƒ½æ˜¯è°ï¼Ÿ MATCH (start:player{name: \"Tim Duncan\"})-[:`follow`]-(f:player)-[:`follow`]-(fof:player), (start:player)-[:`follow`]-(fof:player) RETURN fof.player.name, collect(DISTINCT f.player.name); ç»“æœå¦‚ä¸‹ï¼š fof.player.name collect(distinct f.player.name) Boris Diaw [â€œTony Parkerâ€] Manu Ginobili [â€œDejounte Murrayâ€, â€œTiago Splitterâ€, â€œTony Parkerâ€] LaMarcus Aldridge [â€œTony Parkerâ€] Tiago Splitter [â€œManu Ginobiliâ€] Tony Parker [â€œDejounte Murrayâ€, â€œBoris Diawâ€, â€œManu Ginobiliâ€, â€œMarco Belinelliâ€, â€œLaMarcus Aldridgeâ€] Dejounte Murray [â€œDanny Greenâ€, â€œTony Parkerâ€, â€œManu Ginobiliâ€, â€œMarco Belinelliâ€] Danny Green [â€œDejounte Murrayâ€, â€œMarco Belinelliâ€] Marco Belinelli [â€œDejounte Murrayâ€, â€œDanny Greenâ€, â€œTony Parkerâ€] ç„¶åæˆ‘ä»¬åœ¨ Explorer ä¸Šå¯è§†åŒ–ä¸€ä¸‹è¿™ä¸ªç»“æœï¼š é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠ Tim çš„é‡åº¦å¥½å‹è·¯å¾„å…¨æŸ¥å‡ºæ¥ MATCH p=(start:player{name: \"Tim Duncan\"})-[:`follow`]-(f:player)-[:follow]-(fof:player) RETURN p ç„¶åæˆ‘ä»¬åœ¨å…¶ä¸­æŒ‰ç…§åº¦å»æ¸²æŸ“èŠ‚ç‚¹å¤§å°ï¼Œå¹¶é€‰ä¸­ Tim å’Œ Tonyï¼Œå¹¶åœ¨ä¸¤è€…ä¹‹é—´æŸ¥è¯¢ follow ç±»å‹è¾¹ã€åŒå‘ã€æœ€å¤š 2 è·³çš„å…¨éƒ¨è·¯å¾„ï¼š å¯ä»¥çœ‹å‡ºä»–ä»¬ä¹‹é—´æ˜¯æœ€äº²å¯†çš„æœ‹å‹æ²¡è·‘äº†ï¼Œè€Œä¸”ä»–ä»¬çš„å…±åŒå¥½å‹ä¹Ÿåœ¨è·¯å¾„ä¹‹ä¸­ï¼š [\"Dejounte Murray\", \"Boris Diaw\", \"Manu Ginobili\", \"Marco Belinelli\", \"LaMarcus Aldridge\"] ","date":"2022-12-08","objectID":"/nebulagraph-sns/:5:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#å¥½å‹äº²å¯†åº¦"},{"categories":["Nebula Graph"],"content":" 5.1 æœ‹å‹åœˆå­é‡Œçš„å°ç¾¤ä½“è¿™æ—¶å€™ï¼Œå¦‚å‰è¾¹æåˆ°ï¼Œè¿™ä»½æ•°æ®é›†æœ¬èº«çš„éçœŸå®æ€§ï¼Œä½¿å¾—ç¤¾åŒºå‘ç°ç®—æ³•çš„ç»“æœä¸èƒ½å¾—åˆ°å…¶ä¸­æ´å¯Ÿçš„å†…æ¶µï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ¥ç€è¿™ä¸ªå°çš„å­å›¾ï¼Œçœ‹çœ‹ Tim çš„å¥½å‹ä¸­å¯ä»¥å¦‚ä½•åŒºåˆ†ç¾¤ç»„ã€ç¤¾åŒºå‘¢ï¼Œå’±ä»¬è·‘ä¸€ä¸ª Louvain ã€å¼±è”é€šåˆ†é‡ã€æ ‡ç­¾ä¼ æ’­çœ‹çœ‹ï¼š å¼±è”é€šåˆ†é‡ï¼Œå¯ä»¥æŠŠ Tim ç­‰æœ‹å‹ä»¬å¤§ä½“åˆ†å‰²å‡ºä¸¤ä¸‰ä¸ªç›¸äº’ä¸è¿é€šçš„éƒ¨åˆ†ï¼Œéå¸¸ç¬¦åˆè¿é€šåˆ†é‡çš„ç›´è§‚ç†è§£å’Œå®šä¹‰ã€‚ æ ‡ç­¾ä¼ æ’­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶è¿­ä»£æ¬¡æ•°æŒ‰éœ€å»é€šè¿‡éšæœºçš„ä¼ æ’­åˆ’å®šå‡ºä¸åŒçš„åˆ’åˆ†åº¦ï¼Œç»“æœå¯ä»¥æœ‰ä¸€å®šçš„åŒºåˆ†åº¦ï¼š 20 æ¬¡è¿­ä»£ 1000 æ¬¡è¿­ä»£ Louvainï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒé«˜æ•ˆã€ç¨³å®šçš„ç®—æ³•ï¼ŒåŸºæœ¬ä¸Šåœ¨è¿™ä¸ªå­å›¾ä¸‹æˆ‘ä»¬å¯ä»¥åœ¨å¾ˆå°çš„è¿­ä»£æ¬¡æ•°ä¸‹å¾—åˆ°å¾ˆç¬¦åˆç›´è§‰çš„åˆ’åˆ†ï¼š ","date":"2022-12-08","objectID":"/nebulagraph-sns/:5:1","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æœ‹å‹åœˆå­é‡Œçš„å°ç¾¤ä½“"},{"categories":["Nebula Graph"],"content":" 6 æ–°æœ‹å‹æ¨èæ¥ç€å‰è¾¹äºŒåº¦æœ‹å‹ï¼ˆæœ‹å‹çš„æœ‹å‹ï¼‰çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“æŠŠé‚£äº›è¿˜ä¸æ˜¯æœ‹å‹çš„äºŒåº¦æœ‹å‹ä½œä¸ºæ¨èæ·»åŠ çš„å¥½å‹ï¼Œè€Œæ’åºè§„åˆ™åˆ™æ˜¯ä»–ä»¬ä¹‹é—´çš„å…±åŒå¥½å‹æ•°é‡ï¼š MATCH (start:player{name: \"Tim Duncan\"})-[:`follow`]-(f:player)-[:`follow`]-(fof:player) WHERE NOT (start:player)-[:`follow`]-(fof:player) AND fof != start RETURN fof.player.name, count(DISTINCT f) AS NrOfMutualF ORDER BY NrOfMutualF DESC; fof.player.name NrOfMutualF LeBron James 2 James Harden 1 Chris Paul 1 Yao Ming 1 Damian Lillard 1 JaVale McGee 1 Kevin Durant 1 Kyle Anderson 1 Rudy Gay 1 Russell Westbrook 1 æ˜¾ç„¶ï¼ŒLeBron æœ€å€¼å¾—æ¨èï¼å†çœ‹çœ‹è¿™äº›å…±åŒå¥½å‹éƒ½æ˜¯è°ï¼Ÿ fof.player.name collect(distinct f.player.name) James Harden [â€œDejounte Murrayâ€] LeBron James [â€œDanny Greenâ€, â€œDejounte Murrayâ€] Chris Paul [â€œDejounte Murrayâ€] Yao Ming [â€œShaquille Oâ€™Nealâ€] Damian Lillard [â€œLaMarcus Aldridgeâ€] JaVale McGee [â€œShaquille Oâ€™Nealâ€] Kevin Durant [â€œDejounte Murrayâ€] Kyle Anderson [â€œDejounte Murrayâ€] Rudy Gay [â€œLaMarcus Aldridgeâ€] Russell Westbrook [â€œDejounte Murrayâ€] åŒæ ·ï¼Œæˆ‘ä»¬åœ¨åˆšæ‰çš„å­å›¾é‡Œæ‰¾æ‰¾ LeBron James å§ï¼æˆ‘ä»¬æŠŠå®ƒä¿©ä¹‹é—´çš„ä¸¤æ­¥ã€åŒå‘è·¯å¾„æ‰¾å‡ºæ¥ï¼Œæœç„¶åªä¼šç»è¿‡ [\"Danny Green\", \"Dejounte Murray\"] å¹¶ä¸”ï¼Œæ²¡æœ‰ç›´æ¥çš„è¿æ¥ï¼š ç°åœ¨ï¼Œç³»ç»Ÿä¼šç»™ä¸¤è¾¹å‘æé†’ï¼šâ€œheyï¼Œä¹Ÿè®¸ä½ ä»¬åº”è¯¥äº¤ä¸ªæœ‹å‹ï¼â€ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:6:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æ–°æœ‹å‹æ¨è"},{"categories":["Nebula Graph"],"content":" 7 å…±åŒé‚»å±…æŸ¥æ‰¾å…±åŒé‚»å±…æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„å›¾åº“æŸ¥è¯¢ï¼Œå®ƒçš„åœºæ™¯å¯èƒ½æ ¹æ®ä¸åŒçš„é‚»å±…å…³ç³»ï¼ŒèŠ‚ç‚¹ç±»å‹ï¼ŒåŒæ„ã€å¼‚æ„ï¼Œå¸¦æ¥ä¸åŒçš„åœºæ™¯ï¼Œå‰è¾¹ä¸¤ä¸ªåœºæ™¯ä¸‹çš„å…±åŒå¥½å‹æœ¬è´¨ä¸Šæ˜¯ä¸¤ç‚¹ä¹‹é—´çš„å…±åŒé‚»å±…ï¼Œç›´æ¥æŸ¥è¯¢è¿™æ ·çš„å…³ç³»ç”¨ OpenCypher çš„è¡¨è¾¾éå¸¸ç®€å•ã€‚ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:7:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#å…±åŒé‚»å±…"},{"categories":["Nebula Graph"],"content":" 7.1 ä¸¤ç‚¹ä¹‹é—´çš„å…±åŒé‚»å±…æ¯”å¦‚è¿™ä¸ªè¡¨è¾¾å¯ä»¥æŸ¥è¯¢ä¸¤ä¸ªç”¨æˆ·ä¹‹é—´çš„å…±æ€§ã€äº¤é›†ï¼Œç»“æœå¯èƒ½æ˜¯å…±åŒå›¢é˜Ÿã€å»è¿‡çš„åœ°æ–¹ã€å…´è¶£çˆ±å¥½ã€å…±åŒå‚ä¸çš„å¸–å­å›å¤ç­‰ç­‰ï¼š MATCH p = (`v0`)--()--(`v1`) WHERE id(`v0`) == \"player100\" AND id(`v1`) == \"player104\" RETURN p è€Œé™å®šäº†è¾¹çš„ç±»å‹ä¹‹åï¼Œè¿™ä¸ªæŸ¥è¯¢å°±é™å®šåœ¨å…±åŒå¥½å‹çš„æŸ¥è¯¢äº†ã€‚ MATCH p = (v0)--(:`follow`)--(v1) WHERE id(v0) == \"player100\" AND id(v1) == \"player104\" RETURN p ","date":"2022-12-08","objectID":"/nebulagraph-sns/:7:1","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#ä¸¤ç‚¹ä¹‹é—´çš„å…±åŒé‚»å±…"},{"categories":["Nebula Graph"],"content":" 7.2 å¤šç‚¹ä¹‹é—´çš„å…±åŒé‚»å±…ï¼šå†…å®¹æ¨é€ä¸‹é¢ï¼Œæˆ‘ä»¬ç»™å‡ºä¸€ä¸ªå¤šç‚¹å…±åŒé‚»å±…çš„åœºæ™¯ï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªæ–‡ç« è§¦å‘ï¼ŒæŸ¥å‡ºæ‰€æœ‰åœ¨è¿™ä¸ªæ–‡ç« ä¸Šæœ‰äº’åŠ¨çš„ç”¨æˆ·ï¼Œæ‰¾åˆ°è¿™ä¸€ç¾¤ä½“ä¸­çš„å…±åŒé‚»å±…ã€‚ è¿™ä¸ªå…±åŒé‚»å±…æœ‰ä»€ä¹ˆç”¨å¤„å‘¢ï¼Ÿå¾ˆè‡ªç„¶ï¼Œå¦‚æœè¿™ä¸ªå…±åŒé‚»å±…è¿˜æ²¡æœ‰å’Œè¿™ä¸ªæ–‡ç« æœ‰ä»»ä½•äº¤äº’ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ–‡ç« æ¨èç»™ä»–ã€‚ è¿™ä¸ªæŸ¥è¯¢çš„å®ç°å¾ˆæœ‰æ„æ€ï¼š ç¬¬ä¸€ä¸ª MATCH æ˜¯æŸ¥åˆ°æ‰€æœ‰ post11 æ–‡ç« ä¸‹ç•™è¨€å’Œä½œè€…è¿™äº›äººçš„æ€»äººæ•° åœ¨ç¬¬äºŒä¸ª MATCH ä¹‹åï¼Œæˆ‘ä»¬æŸ¥åˆ°æ‰€æœ‰è¿™ç¾¤äººçš„ä¸€åº¦å¥½å‹è·¯å¾„ä¸­ï¼Œè¿™äº›æ–‡ç« è¿‡çš„äº¤äº’ç”¨æˆ·çš„ä¸€åº¦å¥½å‹çš„å‚ä¸è¿‡æ–‡ç« çš„æœ‹å‹æ•°é‡åˆšå¥½ç­‰äºè¿™ä¸ªå‚ä¸æ–‡ç« çš„ç”¨æˆ·çš„æ•°é‡çš„è¿™äº›äººï¼Œä»–ä»¬å…¶å®å°±æ˜¯è¿™äº›æ‰€æœ‰å‚ä¸ç”¨æˆ·çš„å…±åŒå¥½å‹ã€‚ MATCH (blog:post)\u003c-[e]-(:player) WHERE id(blog) == \"post11\" WITH blog, count(e) AS invoved_user_count MATCH (blog:post)\u003c-[]-(users:player)-[:`follow`]-(common_neighbor:player) WITH toSet(collect(users)) AS users, common_neighbor, invoved_user_count WHERE size(users) == invoved_user_count RETURN common_neighbor è€Œè¿™ä¸ªäººå°±æ˜¯â€¦Tonyï¼ +-----------------------------------------------------+ | common_neighbor | +-----------------------------------------------------+ | (\"player101\" :player{age: 36, name: \"Tony Parker\"}) | +-----------------------------------------------------+ è€Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ¨å¯è§†åŒ–ä¸­å›½éªŒè¯å®ƒï¼š MATCH p=(blog:post)\u003c-[]-(users:player)-[:`follow`]-(common_neighbor:player) WHERE id(blog) == \"post11\" RETURN p æ¸²æŸ“è¿™ä¸ªæŸ¥è¯¢ç»“æœï¼Œç„¶åå†è¿™ç¯‡å«åš â€œLetâ€™s have a party!â€ çš„æ–‡ç« ä¸ Tony ä¹‹é—´æŸ¥æ‰¾è¯„è®ºã€poæ–‡ã€å…³æ³¨ä¸‰ç±»è¾¹çš„åŒå‘ã€ä¸¤è·³æŸ¥è¯¢ï¼Œå°±å¯ä»¥çœ‹åˆ°è¿™äº›å‚ä¸æ–‡ç« çš„äººä»¬æ— ä¸€ä¾‹å¤–ï¼Œéƒ½æ˜¯ Tony çš„å¥½å‹ï¼Œè€Œåªæœ‰ Tony è‡ªå·±è¿˜æ²¡å»æ–‡ç« é‡Œç•™è¨€ï¼ è€Œ Party æ€ä¹ˆå¯ä»¥å°‘äº† Tony å‘¢ï¼Ÿéš¾é“æ˜¯ä»–çš„æƒŠå–œç”Ÿæ—¥ Partyï¼ŒOppsï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯ä¸åº”è¯¥å‘Šè¯‰ä»–ï¼Ÿ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:7:2","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#å¤šç‚¹ä¹‹é—´çš„å…±åŒé‚»å±…å†…å®¹æ¨é€"},{"categories":["Nebula Graph"],"content":" 8 ä¿¡æ¯æµæˆ‘åœ¨ä¹‹å‰å†™è¿‡åŸºäºå›¾æŠ€æœ¯çš„æ¨èç³»ç»Ÿå®ç°æ–¹æ³•ï¼Œå…¶ä¸­æè¿°äº†ç°ä»£æ¨èç³»ç»Ÿä¸­å†…å®¹è¿‡æ»¤ã€æ’åºæ–¹æ³•å¯ä»¥åœ¨å›¾è°±ä¸Šè¿›è¡Œï¼Œç¤¾äº¤ç½‘ç»œä¸­æœ‰ä¸€ç‚¹ç›¸ä¼¼ä½†åˆä¸åŒçš„åœºæ™¯æ˜¯ä¿¡æ¯æµï¼ˆFeedï¼‰ï¼Œå®ƒçš„äº§ç”Ÿç±»ä¼¼äºæ¨èç³»ç»Ÿä¸­çš„ä¸ªæ€§åŒ–ï¼ŒåŒæ—¶æœ‰å…·æœ‰å¾ˆé«˜çš„æ—¶æ•ˆæ€§ï¼Œå€ŸåŠ©äºåŒ…å«äº†å†…å®¹è¡Œä¸ºçŸ¥è¯†çš„ç¤¾äº¤å›¾è°±å¯ä»¥å¾ˆç›´è§‚ã€é«˜æ•ˆå»å®ç°ä¸ªæ€§åŒ–çš„ä¿¡æ¯æµç”Ÿæˆã€‚ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:8:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#ä¿¡æ¯æµ"},{"categories":["Nebula Graph"],"content":" 8.1 å¥½å‹å‚ä¸çš„å†…å®¹æœ€ç®€å•ã€ç›´æ¥çš„ä¿¡æ¯æµå®šä¹‰å¯èƒ½å°±æ˜¯åœ¨æœ‹å‹åœˆã€å¾®åš feed ä¸Šåˆ·ä¸€ä¸‹å…³æ³¨çš„äººåˆ›å»ºã€å‚ä¸çš„å†…å®¹åˆ—è¡¨äº†ï¼Œå…ˆä¸è€ƒè™‘æ’åºçš„é—®é¢˜ï¼Œè¿™äº›å†…å®¹ä¸€å®šæ˜¯ï¼š ä¸€å®šæ—¶é—´æ®µå†…å¥½å‹åˆ›å»ºçš„å†…å®¹ ä¸€å®šæ—¶é—´ç«¯å†…å¥½å‹è¯„è®ºçš„å†…å®¹ æˆ‘ä»¬å¯ä»¥ç”¨ cypher è¡¨è¾¾è¿™ä¸ªæŸ¥è¯¢ç”¨æˆ· id ä¸º player100 çš„ä¿¡æ¯æµï¼š MATCH (feed_owner:player)-[:`follow`]-(friend:player) WHERE id(feed_owner) == \"player100\" OPTIONAL MATCH (friend:player)-[newly_commented:commented_at]-\u003e(:post)\u003c-[:created_post]-(feed_owner:player) WHERE newly_commented.post_time \u003e timestamp(\"2010-01-01 00:00:00\") OPTIONAL MATCH (friend:player)-[newly_created:created_post]-\u003e(po:post) WHERE newly_created.post_time \u003e timestamp(\"2010-01-01 00:00:00\") WITH DISTINCT friend, collect(DISTINCT po.post.title) + collect(\"comment of \" + dst(newly_commented)) AS feeds WHERE size(feeds) \u003e 0 RETURN friend.player.name, feeds friend.player.name feeds Boris Diaw [â€œI love you, Momâ€, â€œcomment of post11â€] Marco Belinelli [â€œmy best friend, tomâ€, â€œcomment of post11â€] Danny Green [â€œcomment of post1â€] Tiago Splitter [â€œcomment of post1â€] Dejounte Murray [â€œcomment of post11â€] Tony Parker [â€œI can swimâ€] LaMarcus Aldridge [â€œI hate corianderâ€, â€œcomment of post11â€, â€œcomment of post1â€] Manu Ginobili [â€œmy best friend, jerryâ€, â€œcomment of post11â€, â€œcomment of post11â€] äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›è¯„è®ºã€æ–‡ç« å‘é€åˆ°ç”¨æˆ·çš„ feed ä¹‹ä¸Šäº†ã€‚ æˆ‘ä»¬ä¹Ÿæ¥çœ‹çœ‹ä»–ä»¬åœ¨å›¾ä¸Šçš„æ ·å­å§ï¼Œæˆ‘ä»¬è¾“å‡ºæ‰€æœ‰æŸ¥åˆ°çš„è·¯å¾„ï¼š MATCH p=(feed_owner:player)-[:`follow`]-(friend:player) WHERE id(feed_owner) == \"player100\" OPTIONAL MATCH p_comment=(friend:player)-[newly_commented:commented_at]-\u003e(:post)\u003c-[:created_post]-(feed_owner:player) WHERE newly_commented.post_time \u003e timestamp(\"2010-01-01 00:00:00\") OPTIONAL MATCH p_post=(friend:player)-[newly_created:created_post]-\u003e(po:post) WHERE newly_created.post_time \u003e timestamp(\"2010-01-01 00:00:00\") RETURN p, p_comment, p_post æ¸²æŸ“åœ¨ Explorer ä¸Šï¼Œé€‰æ‹©â€œç¥ç»ç½‘ç»œâ€è¿™ä¸ªå¸ƒå±€ï¼Œå¯ä»¥å¾ˆæ¸…æ™°çœ‹å‡ºè¿™äº›ç²‰è‰²çš„æ–‡ç« èŠ‚ç‚¹ï¼Œè¿˜æœ‰ä»£è¡¨è¯„è®ºçš„è¾¹ã€‚ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:8:1","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#å¥½å‹å‚ä¸çš„å†…å®¹"},{"categories":["Nebula Graph"],"content":" 8.2 é™„è¿‘å¥½å‹çš„å†…å®¹æˆ‘ä»¬å†è¿›ä¸€æ­¥ï¼ŒæŠŠåœ°ç†ä¿¡æ¯è€ƒè™‘è¿›æ¥ï¼Œè·å–é‚£äº›ä½å€çš„ç»çº¬åº¦å°äºä¸€å®šè·ç¦»æœ‹å‹ç›¸å…³çš„å†…å®¹ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬ç”¨åˆ°äº† NebulaGraph çš„ GeoSpatial åœ°ç†åŠŸèƒ½ï¼ŒST_Distance(home.address.geo_point, friend_addr.address.geo_point) AS distance WHERE distance \u003c 1000000 çš„çº¦æŸæ¡ä»¶å¸®æˆ‘ä»¬è¡¨è¾¾äº†è·ç¦»çš„é™åˆ¶ã€‚ MATCH (home:address)-[:lived_in]-(feed_owner:player)-[:`follow`]-(friend:player)-[:lived_in]-(friend_addr:address) WHERE id(feed_owner) == \"player100\" WITH feed_owner, friend, ST_Distance(home.address.geo_point, friend_addr.address.geo_point) AS distance WHERE distance \u003c 1000000 OPTIONAL MATCH (friend:player)-[newly_commented:commented_at]-\u003e(:post)\u003c-[:created_post]-(feed_owner:player) WHERE newly_commented.post_time \u003e timestamp(\"2010-01-01 00:00:00\") OPTIONAL MATCH (friend:player)-[newly_created:created_post]-\u003e(po:post) WHERE newly_created.post_time \u003e timestamp(\"2010-01-01 00:00:00\") WITH DISTINCT friend, collect(DISTINCT po.post.title) + collect(\"comment of \" + dst(newly_commented)) AS feeds WHERE size(feeds) \u003e 0 RETURN friend.player.name, feeds friend.player.name feeds Marco Belinelli [â€œmy best friend, tomâ€, â€œcomment of post11â€] Tony Parker [â€œI can swimâ€] Danny Green [â€œcomment of post1â€] è¿™æ—¶å€™ï¼Œä»å¯è§†åŒ–è¿™ä¸ªç»“æœä¹Ÿå¯ä»¥çœ‹åˆ°ä½å€è¿™ä¸€å…³ç³»ï¼Œä»¥åŠå®ƒä»¬çš„ç»çº¬åº¦ä¿¡æ¯ï¼Œæˆ‘æ‰‹åŠ¨æ ¹æ®å®ƒä»¬çš„ç»çº¬åº¦ï¼ŒæŠŠåœ°å€çš„èŠ‚ç‚¹åœ¨å›¾ä¸Šæ’å¸ƒäº†ä¸€ä¸‹å¯ä»¥çœ‹åˆ°è¿™ä¸ª feed çš„ä¸»äºº Tim(player100) çš„ä½å€ï¼ˆ7ï¼Œ8ï¼‰åˆšå¥½åœ¨å…¶ä»–å¥½å‹ä½å€çš„ä¸­é—´ä½ç½®ï¼Œè¿™äº›ä¸´è¿‘å¥½å‹çš„ç›¸å…³çš„æ–‡ç« å’Œå‚ä¸è¯„è®ºçš„å†…å®¹å°†è¢«ä½œä¸ºä¿¡æ¯æµæ¨é€ç»™ Timï¼š ","date":"2022-12-08","objectID":"/nebulagraph-sns/:8:2","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#é™„è¿‘å¥½å‹çš„å†…å®¹"},{"categories":["Nebula Graph"],"content":" 9 æ—¶ç©ºå…³ç³»è¿½è¸ªæ—¶ç©ºå…³ç³»è¿½è¸ªè¿™ä¸ªå›¾è°±åº”ç”¨æ˜¯åœ¨å…¬å…±å®‰å…¨ã€ç‰©æµã€ç–«æƒ…é˜²æ§ç­‰åœºæ™¯ä¸‹ï¼Œåˆ©ç”¨å›¾éå†å°†ç¹æ‚ã€å‡Œä¹±çš„ä¿¡æ¯å……åˆ†åˆ©ç”¨èµ·æ¥çš„å…¸å‹åº”ç”¨ã€‚å½“æˆ‘ä»¬å»ºç«‹èµ·è¿™æ ·çš„å›¾è°±ä¹‹åå¾€å¾€åªéœ€è¦ç®€å•çš„å›¾æŸ¥è¯¢å°±å¯ä»¥è·å¾—éå¸¸æœ‰ç”¨çš„æ´å¯Ÿã€‚æœ¬ç« èŠ‚æˆ‘ç»™å¤§å®¶è·ç¦»ä¸€ä¸‹è¿™ä¸ªåº”ç”¨åœºæ™¯ã€‚ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:9:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æ—¶ç©ºå…³ç³»è¿½è¸ª"},{"categories":["Nebula Graph"],"content":" 9.1 æ•°æ®é›†ä¸ºæ­¤ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®é›†ç”±æ¥æ„å»ºä¸€ä¸ªæ—¶ç©ºå…³ç³»å›¾è°±ã€‚æ•°æ®é›†çš„ç”Ÿæˆç¨‹åºå’Œä¸€ä»½å¯ä»¥ç›´æ¥ç”¨çš„æ–‡ä»¶éƒ½æ”¾åœ¨äº† GitHub ä¸Šï¼Œä»“åº“åœ°å€æ˜¯ï¼š https://github.com/wey-gu/covid-track-graph-datagen ã€‚ å®ƒçš„æ•°æ®å»ºæ¨¡å¦‚ä¸‹ï¼š åœ¨ä¸€ä¸ªå…¨æ–°çš„ç¯å¢ƒé‡Œï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹è¾¹çš„ 3 è¡Œå‘½ä»¤å°±å‡†å¤‡å¥½è¿™ä¸ªå›¾è°±ï¼š # å®‰è£… NebulaGraph + NebulaGraph Studio curl -fsSL nebula-up.siwei.io/install.sh | bash -s -- v3 # ä¸‹è½½æ•°æ®é›† git clone https://github.com/wey-gu/covid-track-graph-datagen \u0026\u0026 cd covid-track-graph-datagen # å¯¼å…¥æ•°æ®é›† docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}/:/root \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer-config.yaml ç„¶åæˆ‘ä»¬åœ¨ console é‡ŒæŸ¥çœ‹ä¸€ä¸‹æ•°æ® ~/.nebula-up/console.sh # è¿›å…¥ console äº†ï¼Œè¿›åˆ° covid_trace å›¾ç©ºé—´ï¼ˆåˆšæ‰åˆ›å»ºçš„ï¼‰ USE covid_trace; # æ‰§è¡Œæ•°æ®ç»Ÿè®¡çš„ä»»åŠ¡ SHOW JOB STATS ç»“æœï¼š (root@nebula) [covid_trace]\u003e SHOW STATS +---------+------------+--------+ | Type | Name | Count | +---------+------------+--------+ | \"Tag\" | \"äºº\" | 10000 | | \"Tag\" | \"åœ°å€\" | 1000 | | \"Tag\" | \"åŸå¸‚\" | 341 | | \"Tag\" | \"æ‘é•‡\" | 42950 | | \"Tag\" | \"çœä»½\" | 32 | | \"Tag\" | \"è”ç³»æ–¹å¼\" | 0 | | \"Tag\" | \"è¡Œæ”¿åŒº\" | 3134 | | \"Tag\" | \"è¡—é“\" | 667911 | | \"Edge\" | \"ä½å€\" | 0 | | \"Edge\" | \"åˆ°è®¿\" | 19986 | | \"Edge\" | \"åŒä½\" | 19998 | | \"Edge\" | \"å±äº\" | 715336 | | \"Space\" | \"vertices\" | 725368 | | \"Space\" | \"edges\" | 755320 | +---------+------------+--------+ Got 14 rows (time spent 1087/46271 us) ","date":"2022-12-08","objectID":"/nebulagraph-sns/:9:1","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æ•°æ®é›†"},{"categories":["Nebula Graph"],"content":" 9.2 ä¸¤äººä¹‹é—´çš„å…³è”å¾ˆè‡ªç„¶ï¼Œåˆ©ç”¨è·¯å¾„æŸ¥è¯¢å°±å¯ä»¥äº†ï¼š # æœ€çŸ­ FIND SHORTEST PATH FROM \"p_100\" TO \"p_101\" OVER * BIDIRECT YIELD PATH AS paths # æ‰€æœ‰è·¯å¾„ FIND ALL PATH FROM \"p_100\" TO \"p_101\" OVER * BIDIRECT YIELD PATH AS paths | LIMIT 10 æœ€çŸ­è·¯å¾„ç»“æœï¼š paths \u003c(â€œp_100â€)\u003c-[:åŒä½@0 {}]-(â€œp_2136â€)\u003c-[:åŒä½@0 {}]-(â€œp_3708â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_125â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e æ‰€æœ‰è·¯å¾„ç»“æœï¼š paths \u003c(â€œp_100â€)\u003c-[:åŒä½@0 {}]-(â€œp_2136â€)\u003c-[:åŒä½@0 {}]-(â€œp_3708â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_125â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e \u003c(â€œp_100â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_328â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_6976â€)\u003c-[:åŒä½@0 {}]-(â€œp_261â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_352â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e \u003c(â€œp_100â€)-[:åŒä½@0 {}]-\u003e(â€œp_8709â€)-[:åŒä½@0 {}]-\u003e(â€œp_9315â€)-[:åŒä½@0 {}]-\u003e(â€œp_261â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_352â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e \u003c(â€œp_100â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_328â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_6311â€)-[:åŒä½@0 {}]-\u003e(â€œp_3941â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_345â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e \u003c(â€œp_100â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_328â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_5046â€)-[:åŒä½@0 {}]-\u003e(â€œp_3993â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_144â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e \u003c(â€œp_100â€)-[:åŒä½@0 {}]-\u003e(â€œp_3457â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_199â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_6771â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_458â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e \u003c(â€œp_100â€)\u003c-[:åŒä½@0 {}]-(â€œp_1462â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_922â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_5869â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_345â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e \u003c(â€œp_100â€)\u003c-[:åŒä½@0 {}]-(â€œp_9489â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_985â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_2733â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_458â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e \u003c(â€œp_100â€)\u003c-[:åŒä½@0 {}]-(â€œp_9489â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_905â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_2733â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_458â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e \u003c(â€œp_100â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_89â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_1333â€)\u003c-[:åŒä½@0 {}]-(â€œp_1683â€)-[:åˆ°è®¿@0 {}]-\u003e(â€œa_345â€)\u003c-[:åˆ°è®¿@0 {}]-(â€œp_101â€)\u003e æˆ‘ä»¬æŠŠæ‰€æœ‰è·¯å¾„è¿›è¡Œå¯è§†åŒ–æ¸²æŸ“ï¼Œæ ‡è®°å‡ºèµ·ç‚¹ç»ˆç‚¹çš„ä¸¤äººï¼Œå¹¶åœ¨å…¶ä¸­æŸ¥åˆ°ä»–ä»¬çš„æœ€çŸ­è·¯å¾„ï¼Œä»–ä»¬ä¹‹é—´çš„åƒä¸ä¸‡ç¼•å…³ç³»å°±ä¸€ç›®äº†ç„¶äº†ï¼Œæ— è®ºæ˜¯å•†ä¸šæ´å¯Ÿã€å…¬å…±å®‰å…¨è¿˜æ˜¯ç–«æƒ…é˜²æ§çš„ç›®çš„ï¼Œæœ‰äº†è¿™ä¸ªä¿¡æ¯ï¼Œç›¸åº”çš„å·¥ä½œéƒ½å¯ä»¥å¦‚è™æ·»ç¿¼åœ°å‘ä¸‹è¿›å±•ã€‚ å½“ç„¶ï¼Œåœ¨çœŸå®çš„ç³»ç»Ÿä¸Šï¼Œå¯èƒ½æˆ‘ä»¬åªéœ€è¦å…³å¿ƒä¸¤ä¸ªç”¨æˆ·ä¹‹é—´çš„å…³è”è¿œè¿‘ï¼Œå¾—å‡ºé‡åŒ–çš„è¯„ä¼°ï¼š FIND SHORTEST PATH FROM \"p_100\" TO \"p_101\" OVER * BIDIRECT YIELD PATH AS paths | YIELD collect(length($-.paths)) AS len | YIELD coalesce($-.len[0], -1) AS len ç»“æœä¸­æˆ‘ä»¬åªå…³å¿ƒä»–ä»¬ä¹‹é—´æœ€çŸ­è·¯å¾„çš„é•¿åº¦ä¸ºï¼š4ã€‚ len 4 ","date":"2022-12-08","objectID":"/nebulagraph-sns/:9:2","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#ä¸¤äººä¹‹é—´çš„å…³è”"},{"categories":["Nebula Graph"],"content":" 9.3 æ—¶ç©ºç›¸äº¤çš„äººè¿›ä¸€æ­¥æˆ‘ä»¬å¯ä»¥ç”¨å›¾è¯­ä¹‰å‹¾å‹’å‡ºæˆ‘ä»¬æƒ³ç¡®å®šçš„ä»»ä½•å¸¦æœ‰æ—¶é—´ä¸ç©ºé—´ä¿¡æ¯çš„æ¨¡å¼ï¼Œåœ¨å›¾è°±ä¸­å®æ—¶æŸ¥è¯¢å‡ºæ¥ï¼Œæ¯”å¦‚å¯¹ç»™å®šçš„äººï¼Œä»–çš„ id æ˜¯ p_101ï¼Œæˆ‘ä»¬ç›¸å·®åœ¨ç‰¹å®šæ—¶é—´é‡Œæ‰€æœ‰å’Œä»–æœ‰æ—¶ç©ºç›¸äº¤çš„äººï¼Œè¿™æ„å‘³ç€é‚£äº›äººåœ¨ p_101 è®¿é—®æŸä¸€åœ°æ–¹çš„æ—¶é—´æ®µä¹‹å†…ä¹Ÿé€—ç•™ã€è®¿é—®äº†è¿™äº›åœ°æ–¹ï¼š MATCH (p:äºº)-[`visit0`:åˆ°è®¿]-\u003e(`addr`:åœ°å€)\u003c-[`visit1`:åˆ°è®¿]-(p1:äºº) WHERE id(p) == \"p_101\" AND `visit0`.`start_time` \u003c `visit1`.`end_time` AND `visit0`.`end_time` \u003e `visit1`.`start_time` RETURN `addr`.åœ°å€.`name`, collect(p1.äºº.`name`) æˆ‘ä»¬å¾—åˆ°äº†å†æ¯ä¸€ä¸ªåˆ°è®¿åœ°ç‚¹çš„æ—¶ç©ºç›¸äº¤äººåˆ—è¡¨å¦‚ä¸‹ï¼š addr.åœ°å€.name collect(p1.äºº.name) é—µè¡Œä»‡è·¯qåº§ 255960 [â€œå¾ç•…â€, â€œç‹ä½³â€, â€œæ›¾äº®â€, â€œå§œæ¡‚é¦™â€, â€œé‚µç§€è‹±â€, â€œéŸ¦å©·å©·â€, â€œé™¶ç‰â€, â€œé©¬å¤â€, â€œé»„æƒ³â€, â€œå¼ ç§€èŠ³â€, â€œé¢œæ¡‚èŠ³â€, â€œå¼ æ´‹â€] ä¸°éƒ½åŒ—äº¬è·¯Jåº§ 725701 [â€œé™ˆæ˜¥æ¢…â€, â€œæ–½å©·å©·â€, â€œäº•æˆâ€, â€œèŒƒæ–‡â€, â€œç‹æ¥ â€, â€œå°šæ˜â€, â€œè–›ç§€çâ€, â€œå®‹é‡‘å‡¤â€, â€œæ¨é›ªâ€, â€œé‚“ä¸½åâ€, â€œææ¨â€, â€œæ¸©ä½³â€, â€œå¶ç‰â€, â€œå‘¨æ˜â€, â€œç‹æ¡‚çâ€, â€œæ®µç‰åâ€, â€œé‡‘æˆâ€, â€œé»„é‘«â€, â€œé‚¬å…µâ€, â€œé­æŸ³â€, â€œç‹å…°è‹±â€, â€œæ¨æŸ³â€] æ™®é™€æ½œæ±Ÿè·¯Påº§ 210730 [â€œå‚¨å¹³â€, â€œæ´ªçº¢éœâ€, â€œæ²ˆç‰è‹±â€, â€œç‹æ´â€, â€œè‘£ç‰è‹±â€, â€œé‚“å‡¤è‹±â€, â€œè°¢æµ·ç‡•â€, â€œæ¢é›·â€, â€œå¼ ç•…â€, â€œä»»ç‰å…°â€, â€œè´¾å®‡â€, â€œæ±ªæˆâ€, â€œå­™ç´â€, â€œçºªçº¢æ¢…â€, â€œç‹æ¬£â€, â€œé™ˆå…µâ€, â€œå¼ æˆâ€, â€œç‹ä¸œâ€, â€œè°·éœâ€, â€œæ—æˆâ€] æ™®é™€æ­¦è¡—fåº§ 706352 [â€œé‚¢æˆâ€, â€œå¼ å»ºå†›â€, â€œå¼ é‘«â€, â€œæˆ´æ¶›â€, â€œè”¡æ´‹â€, â€œæ±ªç‡•â€, â€œå°¹äº®â€, â€œä½•åˆ©â€, â€œä½•ç‰â€, â€œå‘¨æ³¢â€, â€œé‡‘ç§€çâ€, â€œæ¨æ³¢â€, â€œå¼ å¸…â€, â€œå‘¨æŸ³â€, â€œé©¬äº‘â€, â€œå¼ å»ºåâ€, â€œç‹ä¸½ä¸½â€, â€œé™ˆä¸½â€, â€œä¸‡èâ€] åŸä¸œè´µé˜³è¡—Oåº§ 110567 [â€œææ´â€, â€œé™ˆé™â€, â€œç‹å»ºå›½â€, â€œæ–¹æ·‘åâ€, â€œå¤æƒ³â€, â€œæ¼†èâ€, â€œè©¹æ¡‚èŠ±â€, â€œç‹æˆâ€, â€œææ…§â€, â€œå­™å¨œâ€, â€œé©¬ä¼Ÿâ€, â€œè°¢æ°â€, â€œç‹é¹â€, â€œé æ¡‚è‹±â€, â€œè«æ¡‚è‹±â€, â€œæ±ªé›·â€, â€œé»„å½¬â€, â€œæç‰æ¢…â€, â€œç¥çº¢æ¢…â€] ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨å›¾ä¸Šå¯è§†åŒ–è¿™ä¸ªç»“æœçœ‹çœ‹ï¼š MATCH (p:äºº)-[`visit0`:åˆ°è®¿]-\u003e(`addr`:åœ°å€)\u003c-[`visit1`:åˆ°è®¿]-(p1:äºº) WHERE id(p) == \"p_101\" AND `visit0`.`start_time` \u003c `visit1`.`end_time` AND `visit0`.`end_time` \u003e `visit1`.`start_time` RETURN paths; ç»“æœä¸­æˆ‘ä»¬æ ‡è®°äº† p_101 ä¸ºä¸åŒçš„å›¾æ ‡ï¼Œåœ¨ç”¨æ ‡ç­¾ä¼ æ’­ç®—æ³•è¯†åˆ«ä¸€ä¸‹èšé›†ç¤¾åŒºï¼Œæ˜¯ä¸æ˜¯ä¸€å›¾èƒœåƒè¨€å‘¢ï¼Ÿ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:9:3","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æ—¶ç©ºç›¸äº¤çš„äºº"},{"categories":["Nebula Graph"],"content":" 9.4 æœ€è¿‘å»è¿‡çš„çœä»½æœ€åï¼Œæˆ‘ä»¬å†ç”¨ç®€å•çš„æŸ¥è¯¢æ¨¡å¼è¡¨è¾¾å‡ºä¸€ä¸ªäººåœ¨ç»™å®šæ—¶é—´å†…ï¼Œæ¯”å¦‚ä»ä¸€ä¸ªæ—¶é—´ç‚¹å¼€å§‹ï¼Œåˆ°è®¿è¿‡çš„æ‰€æœ‰çœä»½ MATCH (p:äºº)-[visit:åˆ°è®¿]-\u003e(`addr`:åœ°å€)-[:å±äº*5]-(province:çœä»½) WHERE id(p) == \"p_101\" AND visit.start_time \u003e 1625469000 RETURN province.çœä»½.name, collect(addr.åœ°å€.name); çœ‹èµ·æ¥ä»–/å¥¹å»è¿‡ä¸å°‘åœ°æ–¹å‘¢ï¼š province.çœä»½.name collect(addr.åœ°å€.name) å››å·çœ [â€œé—µè¡Œä»‡è·¯qåº§ 255960â€] å±±ä¸œçœ [â€œåŸä¸œè´µé˜³è¡—Oåº§ 110567â€] äº‘å—çœ [â€œä¸°éƒ½åŒ—äº¬è·¯Jåº§ 725701â€] ç¦å»ºçœ [â€œæ™®é™€æ½œæ±Ÿè·¯Påº§ 210730â€] å†…è’™å¤è‡ªæ²»åŒº [â€œæ™®é™€æ­¦è¡—fåº§ 706352â€] è€è½¨è¿¹ï¼Œæˆ‘ä»¬åœ¨å›¾ä¸Šçœ‹çœ‹è¿™ä¸ªç»“æœå§ï¼Œè¿™æ¬¡ï¼Œæˆ‘ä»¬é€‰æ‹© Dagre-LR è¿™ä¸ªå¸ƒå±€æ¸²æŸ“ï¼Œç»“æœæ˜¯ä¸æ˜¯éå¸¸æ¸…æ™°å‘¢ï¼Ÿ ","date":"2022-12-08","objectID":"/nebulagraph-sns/:9:4","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æœ€è¿‘å»è¿‡çš„çœä»½"},{"categories":["Nebula Graph"],"content":" 10 æ€»ç»“æˆ‘ä»¬ç»™å‡ºäº†ä¸å°‘ç¤¾äº¤ç½‘ç»œé‡Œçš„åº”ç”¨æ¡ˆä¾‹ï¼ŒåŒ…æ‹¬ï¼š æŸ¥æ‰¾å…³é”®çš„äºº è¯†åˆ«èšé›†çš„äººç¾¤ã€ç¤¾ç¾¤ åˆ¤å®šä¸¤ä¸ªç”¨æˆ·ä¹‹é—´çš„äº²å¯†åº¦ æ¨èæ–°æœ‹å‹ åˆ©ç”¨å…±åŒé‚»å±…ç²¾å‡†æ¨é€é‡è¦å†…å®¹ æ ¹æ®å¥½å‹å…³ç³»ã€åœ°ç†ä½ç½®æ¨é€ä¿¡æ¯æµ åˆ©ç”¨æ—¶ç©ºå…³ç³»å›¾è°±æŸ¥è¯¢äººä¸äººä¹‹é—´å…³ç³»ã€è·å–æ—¶ç©ºç›¸äº¤çš„äººã€è®¿é—®è¿‡çš„çœä»½ ç¤¾äº¤ç½‘ç»œä½œä¸ºå¤©ç„¶çš„å›¾ç»“æ„ï¼Œéå¸¸é€‚åˆç”¨å›¾çš„æŠ€æœ¯æ¥å­˜å‚¨ã€æŸ¥è¯¢ã€è®¡ç®—ã€åˆ†æä¸å¯è§†åŒ–å»è§£å†³å…¶ä¸Šçš„å„å¼å„æ ·çš„é—®é¢˜ï¼ŒNebulaGraph çš„å¼ºå¤§å¤„ç†èƒ½åŠ›å’Œå¯è§†åŒ–èƒ½åŠ›ä½¿å¾—æˆ‘ä»¬å·²çŸ¥å¾ˆå¤šå…¬å¸åœ¨ä½¿ç”¨å®ƒä½œä¸ºç¤¾äº¤é¢†åŸŸçš„å›¾å­˜å‚¨ã€è®¡ç®—å±‚ï¼Œè¿™å…¶ä¸­åŒ…æ‹¬ï¼šç½‘æ˜“æ¸¸æˆã€å¾®ä¿¡ã€Lineã€Soulã€å¿«æ‰‹å’ŒçŸ¥ä¹ç­‰ç­‰å¾ˆå¤šè¡Œä¸šé¢†å…ˆçš„å›¢é˜Ÿï¼Œå¸Œæœ›å¤§å®¶é€šè¿‡æœ¬ç« èƒ½å¯¹ç¤¾äº¤é¢†åŸŸçš„å›¾æŠ€æœ¯åº”æœ‰æœ‰ä¸€ä¸ªåˆæ­¥çš„è®¤è¯†ã€‚ é¢˜å›¾ç‰ˆæƒï¼šby Ryoji ","date":"2022-12-08","objectID":"/nebulagraph-sns/:10:0","series":null,"tags":["Nebula Graph","SNS","ç¤¾äº¤ç½‘ç»œ","å›¾ç®—æ³•"],"title":"å›¾æ•°æ®åº“çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨","uri":"/nebulagraph-sns/#æ€»ç»“"},{"categories":["Nebula Graph"],"content":"ä¸€æ¬¡åˆ©ç”¨ chatGPT ç»™å‡ºæ•°æ®æŠ“å–ä»£ç ï¼Œå€ŸåŠ© NebulaGraph å›¾æ•°æ®åº“ä¸å›¾ç®—æ³•é¢„æµ‹ä½“è‚²èµ›äº‹çš„å°è¯•ã€‚","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/"},{"categories":["Nebula Graph"],"content":" ä¸€æ¬¡åˆ©ç”¨ chatGPT ç»™å‡ºæ•°æ®æŠ“å–ä»£ç ï¼Œå€ŸåŠ© NebulaGraph å›¾æ•°æ®åº“ä¸å›¾ç®—æ³•é¢„æµ‹ä½“è‚²èµ›äº‹çš„å°è¯•ã€‚ ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:0:0","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#"},{"categories":["Nebula Graph"],"content":" 1 è¹­çƒ­åº¦æœ€è¿‘å› ä¸ºä¸–ç•Œæ¯è¿›è¡Œæ—¶ï¼Œè¢«è¿™ç¯‡ Cambridge Intelligence çš„æ–‡ç« å¯å‘ï¼ˆä»…ä»…åˆ©ç”¨æœ‰é™çš„ä¿¡æ¯é‡å’Œæ¡ä»¶ï¼Œå€ŸåŠ©å›¾ç®—æ³•çš„æ–¹æ³•åšåˆç†çš„å† å†›é¢„æµ‹ï¼‰ï¼Œè®¨è®ºåˆ°ä¹Ÿå¯ä»¥è¯•ç€ç”¨ NebulaGraph ç©ç©å† å†›é¢„æµ‹ï¼Œè¿˜èƒ½é¡ºé“ç§‘æ™®ä¸€æ³¢å›¾åº“æŠ€æœ¯å’Œå›¾ç®—æ³•ã€‚ æœ¬æ¥æƒ³ç€å‡ ä¸ªå°æ—¶æ’¸å‡ºæ¥ä¸€ä¸ªæ–¹æ¡ˆï¼Œè¢«æ•°æ®é›†çš„æ”¶é›†åŠé€€äº†ï¼Œæˆ‘æ˜¯æ˜¯åœ¨æ‡’å¾—å» wikepedia é‡ŒæŠ“å–å‡ºæ¥éœ€è¦çš„æ•°æ®ï¼Œç´¢æ€§å°±æŒ‰ä¸‹æ”¾äº†å‡ å¤©ã€‚ åŒæ—¶ï¼Œå¦ä¸€ä¸ªçƒ­æ½®æ˜¯æœ€è¿‘ OpenAI å‘å¸ƒäº† chatGPT æœåŠ¡ï¼Œå®ƒå¯ä»¥å®ç°å„ç§è¯­è¨€å¯æ˜¯å®ç°çš„å¤æ‚ä»»åŠ¡è®¾è®¡åŒ…æ‹¬ï¼š éšæ—¶å¸®ä½ å®ç°ä¸€æ®µä»€ä¹ˆæ ·çš„ä»£ç  æ¨¡æ‹Ÿæˆä»»æ„ä¸€ä¸ª prompt ç•Œé¢ï¼šshellã€pythonã€virtual machineã€ç”šè‡³ä½ åˆ›é€ çš„è¯­è¨€ å‡è®¾ã€å¸¦å…¥ä½ ç»™å®šçš„äººè®¾ï¼Œå’Œä½ èŠå¤© å†™è¯—æ­Œã€rapã€æ•£æ–‡ æ‰¾å‡ºä¸€æ®µä»£ç çš„ bug è§£é‡Šä¸€æ®µå¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼çš„å«ä¹‰ chatGPT çš„ä¸Šä¸‹æ–‡èƒ½åŠ›ã€ç†è§£åŠ›åˆ°çš„å‰æ‰€æœªæœ‰çš„ç¨‹åº¦ä»¥è‡³äºæ‰€æœ‰äººéƒ½åœ¨è®¨è®ºæ–°çš„å·¥ä½œæ–¹å¼ï¼šå¦‚ä½•æŒæ¡è®©æœºå™¨å¸®åŠ©æˆ‘ä»¬å®Œæˆä»»åŠ¡ã€‚ æ‰€ä»¥ï¼Œå½“æˆ‘è¯•è¿‡è®© chatGPT å¸®æˆ‘å†™å¤æ‚çš„å›¾æ•°æ®åº“æŸ¥è¯¢è¯­å¥ã€è§£é‡Šå¤æ‚å›¾æŸ¥è¯¢è¯­å¥çš„å«ä¹‰ã€è§£é‡Šä¸€å¤§æ®µ Bison ä»£ç å«ä¹‰ä¹‹åæˆ‘æ‰æ„è¯†åˆ°ï¼šä¸ºä»€ä¹ˆä¸è®© chatGPT å¸®æˆ‘å†™å¥½æŠ“å–æ•°æ®çš„ä»£ç å‘¢ï¼Ÿ ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:1:0","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#è¹­çƒ­åº¦"},{"categories":["Nebula Graph"],"content":" 2 æŠ“å–æ•°æ®æˆ‘çœŸè¯•äº†ä¸€ä¸‹ï¼Œç»“æœæ˜¯ï¼šå®Œå…¨å¯ä»¥ï¼Œè€Œä¸”ä¼¼ä¹çœŸçš„å¾ˆå®¹æ˜“ã€‚ æ•´ä¸ªè¿‡ç¨‹åŸºæœ¬ä¸Šæˆ‘åƒæ˜¯ä¸€ä¸ªä»£ç è€ƒè¯•çš„é¢è¯•å®˜ã€æˆ–è€…æ˜¯ä¸€ä¸ªäº§å“ç»ç†ï¼Œæå‡ºæˆ‘çš„éœ€æ±‚ï¼ŒchatGPT ç»™å‡ºä»£ç çš„å®ç°ã€‚æˆ‘ä»¬å†è¯•ç€è·‘èµ·æ¥ä»£ç ï¼Œæ‰¾åˆ°ä»£ç ä¸­ä¸åˆç†çš„åœ°æ–¹ï¼ŒæŒ‡å‡ºæ¥ã€ç»™å‡ºå»ºè®®ï¼ŒchatGPT å°±çœŸçš„èƒ½ç†è§£æˆ‘æŒ‡å‡ºçš„ç‚¹ï¼Œå¹¶ç»™å‡ºç›¸åº”çš„ä¿®æ­£ï¼Œåƒæ˜¯ï¼š è¿™ä¸€å…¨è¿‡ç¨‹æˆ‘å°±ä¸åœ¨è¿™é‡Œåˆ—å‡ºæ¥äº†ï¼Œä¸è¿‡æˆ‘æŠŠç”Ÿæˆçš„ä»£ç å’Œæ•´ä¸ªè®¨è®ºçš„è¿‡ç¨‹éƒ½åˆ†äº«åœ¨è¿™é‡Œï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»çœ‹çœ‹ã€‚ æœ€ç»ˆç”Ÿæˆçš„æ•°æ®æ˜¯ä¸€ä¸ª CSV æ–‡ä»¶ï¼š ä»£ç ç”Ÿæˆçš„æ–‡ä»¶ world_cup_squads.csv æ‰‹åŠ¨ä¿®æ”¹ã€åˆ†å¼€äº†ç”Ÿæ—¥å’Œå¹´é¾„çš„åˆ— world_cup_squads_v0.csv å®ƒåƒè¿™æ ·ï¼ŒåŒ…å«çš„ä¿¡æ¯æœ‰ï¼šçƒé˜Ÿã€å°ç»„ã€ç¼–å·ã€ä½ç½®ã€çƒå‘˜åå­—ã€ç”Ÿæ—¥ã€å¹´é¾„ã€å‚åŠ å›½é™…æ¯”èµ›åœºæ¬¡ã€è¿›çƒæ•°ã€æœå½¹ä¿±ä¹éƒ¨ã€‚ Team,Group,No.,Pos.,Player,DOB,Age,Caps,Goals,Club Ecuador,A,1,1GK,HernÃ¡n GalÃ­ndez,(1987-03-30)30 March 1987,35,12,0,Aucas Ecuador,A,2,2DF,FÃ©lix Torres,(1997-01-11)11 January 1997,25,17,2,Santos Laguna Ecuador,A,3,2DF,Piero HincapiÃ©,(2002-01-09)9 January 2002,20,21,1,Bayer Leverkusen Ecuador,A,4,2DF,Robert Arboleda,(1991-10-22)22 October 1991,31,33,2,SÃ£o Paulo Ecuador,A,5,3MF,JosÃ© Cifuentes,(1999-03-12)12 March 1999,23,11,0,Los Angeles FC æ‰‹åŠ¨åˆ é™¤äº† CSV è¡¨å¤´ world_cup_squads_no_headers.csv ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:2:0","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#æŠ“å–æ•°æ®"},{"categories":["Nebula Graph"],"content":" 3 å›¾æ–¹æ³•é¢„æµ‹2022ä¸–ç•Œæ¯","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:3:0","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#å›¾æ–¹æ³•é¢„æµ‹2022ä¸–ç•Œæ¯"},{"categories":["Nebula Graph"],"content":" 3.1 å›¾å»ºæ¨¡ å‰æï¼Œæœ¬æ–‡ä½¿ç”¨ NebulaGraph å’Œ NebulaGraph Explorerï¼Œä½ å¯ä»¥åœ¨é˜¿é‡Œäº‘ä¸Šå…è´¹ç”³è¯·åŠä¸ªæœˆçš„è¯•ç”¨ï¼Œå…¥å£é“¾æ¥æ˜¯ğŸ‘‰ğŸ» http://c.nxw.so/d52oz ï¼Œä¸è¦è¢«è¿™ä¸ªé™Œç”Ÿçš„çŸ­é“¾æ¥åŸŸåå“åˆ°ï¼Œå®ƒåªæ˜¯å¸®åŠ©æˆ‘ä»¬ç»Ÿè®¡æœ‰å¤šå°‘åŒå­¦é€šè¿‡è¿™é‡Œè®¿é—®åˆ° https://market.aliyun.com è€Œå·²ã€‚ å›¾å»ºæ¨¡ï¼ˆGraph Modelingï¼‰æ˜¯æŠŠçœŸå®ä¸–ç•Œä¿¡æ¯ä»¥â€ç‚¹â€“\u003eè¾¹â€œçš„å›¾å½¢å¼å»æŠ½è±¡ä¸è¡¨ç¤ºã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬æ ¹æ®å…¬å…±é¢†åŸŸèƒ½å¤Ÿå®¹æ˜“è·å¾—ä¿¡æ¯ã€æŠŠå®ƒæ˜ å°„æˆå¦‚ä¸‹çš„ç‚¹ä¸è¾¹ï¼š ç‚¹ï¼š playerï¼ˆçƒå‘˜ï¼‰ teamï¼ˆçƒé˜Ÿï¼‰ groupï¼ˆå°ç»„ï¼‰ clubï¼ˆä¿±ä¹éƒ¨ï¼‰ è¾¹ï¼š groupedinï¼ˆçƒé˜Ÿå±äºå“ªä¸€å°ç»„ï¼‰ belongtoï¼ˆé˜Ÿå‘˜å±äºå›½å®¶é˜Ÿï¼‰ serveï¼ˆé˜Ÿå‘˜åœ¨ä¿±ä¹éƒ¨æœå½¹ï¼‰ è€Œé˜Ÿå‘˜çš„å¹´é¾„ã€å‚åŠ å›½é™…åœºæ¬¡ï¼ˆcapsï¼‰ã€è¿›çƒæ•°ï¼ˆgoalsï¼‰åˆ™å¾ˆè‡ªç„¶ä½œä¸º player è¿™ä¸€ç±»ç‚¹çš„å±æ€§ã€‚ ä¸‹å›¾æ˜¯è¿™ä¸ª schema åœ¨ NebulaGraph Studio/Explorerï¼ˆåè¾¹ç§° Studio/Explorerï¼‰ ä¸­çš„æˆªå›¾ï¼š ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å³ä¸Šè§’æŠŠå®ƒä¿å­˜ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å›¾ç©ºé—´ï¼Œåº”ç”¨è¿™ä¸ªå›¾å»ºæ¨¡åˆ°å›¾ç©ºé—´é‡Œã€‚ æ³¨ï¼šå‚è€ƒæ–‡æ¡£ https://docs.nebula-graph.com.cn/3.3.0/nebula-explorer/db-management/draft/ ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:3:1","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#å›¾å»ºæ¨¡"},{"categories":["Nebula Graph"],"content":" 3.2 å¯¼å…¥æ•°æ®è¿› NebulaGraphæœ‰äº†å›¾å»ºæ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¹‹å‰çš„ CSV æ–‡ä»¶ï¼ˆæ— è¡¨å¤´ç‰ˆæœ¬ï¼‰ä¸Šä¼ åˆ° Studio æˆ–è€… Explorer é‡Œï¼Œé€šè¿‡ç‚¹ã€é€‰å…³è”ä¸åŒçš„åˆ—åˆ°ç‚¹è¾¹ä¸­çš„ vid å’Œå±æ€§ï¼š ä¹‹åç‚¹å‡»å¯¼å…¥ï¼Œå°±æŠŠæ•´ä¸ªå›¾å¯¼å…¥åˆ° NebulaGraph äº†ï¼ŒæˆåŠŸä¹‹åï¼Œæˆ‘ä»¬è¿˜å¾—åˆ°äº†æ•´ä¸ªcsv â€“\u003e Nebula Importer çš„å…³è”é…ç½®æ–‡ä»¶ï¼šnebula_importer_config_fifa.ymlï¼Œä½ å¯ä»¥ç›´æ¥æ‹–æ‹½æ•´ä¸ªé…ç½®ï¼Œä¸ç”¨è‡ªå·±å»é…ç½®å®ƒäº†ã€‚ æ³¨ï¼šå‚è€ƒæ–‡æ¡£ https://docs.nebula-graph.com.cn/3.3.0/nebula-explorer/db-management/11.import-data/ å¯¼å…¥ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ schema ç•Œé¢é‡ŒæŸ¥çœ‹æ•°æ®ç»Ÿè®¡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ 831 åçƒå‘˜å‚åŠ äº† 2022 å¡å¡”å°”ä¸–ç•Œæ¯ï¼Œä»–ä»¬æœå½¹åœ¨ 295 ä¸ªä¸åŒçš„ä¿±ä¹éƒ¨ï¼š æ³¨ï¼šå‚è€ƒæ–‡æ¡£ https://docs.nebula-graph.com.cn/3.3.0/nebula-explorer/db-management/10.create-schema/#_6 ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:3:2","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#å¯¼å…¥æ•°æ®è¿›-nebulagraph"},{"categories":["Nebula Graph"],"content":" 3.3 æ¢ç´¢æ•°æ® 3.3.1 æŸ¥è¯¢æ•°æ®ä¸‹é¢ï¼Œæˆ‘ä»¬è¯•ç€æŠŠæ‰€æœ‰çš„æ•°æ®å±•ç¤ºå‡ºæ¥çœ‹çœ‹å§ï¼Œé¦–å…ˆï¼Œå€ŸåŠ© NebulaGraph Explorerï¼Œæˆ‘ç”¨æ‹–æ‹½çš„æ–¹å¼ç”»å‡ºæ¥ä»»æ„ç±»å‹çš„ç‚¹ï¼ˆTAGï¼‰å’Œä»»æ„ç±»å‹ç‚¹ï¼ˆTAGï¼‰ä¹‹é—´çš„è¾¹ï¼Œè¿™é‡Œæˆ‘ä»¬çŸ¥é“æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯è‡³å°‘åŒ…å«åœ¨ä¸€ä¸ªè¾¹é‡Œçš„ï¼Œæ‰€ä»¥ä¸ä¼šæ¼æ‰ä»»ä½•å­¤ç«‹çš„ç‚¹ã€‚ è®©å®ƒå¸®æˆ‘ç”ŸæˆæŸ¥è¯¢çš„è¯­å¥ï¼Œè¿™é‡Œï¼Œå®ƒé»˜è®¤ LIMIT 100 äº†ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ”¹å¤§ä¸€äº›ï¼ˆ LIMIT 10000ï¼‰ï¼Œè®©å®ƒåœ¨ Console é‡Œæ‰§è¡Œã€‚ 3.3.2 åˆæ­¥è§‚å¯Ÿæ•°æ®ç»“æœæ¸²æŸ“å‡ºæ¥æ˜¯è¿™æ ·å­ï¼Œå¯ä»¥çœ‹åˆ°å®ƒå¤©ç„¶å½¢æˆäº†ä¸€ç°‡ä¸€ç°‡çš„æ¨¡å¼ã€‚ è¿™äº›å¤–å›´ã€å½¢æˆçš„ç°‡å¤šæ˜¯ä¸€äº›ç”±éä¼ ç»Ÿæ„ä¹‰ä¸Šçš„æœ‰å…¨çƒå½±å“åŠ›çš„ä¿±ä¹éƒ¨ï¼Œå’Œéä¼ ç»Ÿçš„è¶³çƒå‰å®³çš„å›½å®¶é˜Ÿçš„çƒå‘˜ç»„æˆï¼Œå› ä¸ºé€šå¸¸è¿™äº›ä¿±ä¹éƒ¨åªæœ‰ä¸€ä¸¤ä¸ªçƒå‘˜ï¼Œè€Œä¸”ä»–ä»¬è¿˜é›†ä¸­åœ¨ä¸€ä¸ªå›½å®¶é˜Ÿã€åœ°åŒºï¼Œæ‰€ä»¥æ²¡æœ‰å’Œå¾ˆå¤šå…¶ä»–çƒå‘˜ã€å›½å®¶é˜Ÿäº§ç”Ÿè¿æ¥ã€‚ 3.3.3 å›¾ç®—æ³•è¾…åŠ©åˆ†æåœ¨æˆ‘ç‚¹å‡»äº† Explorer ä¸­çš„ä¸¤ä¸ªæŒ‰é’®ä¹‹åï¼ˆè¯¦ç»†å‚è€ƒåè¾¹çš„æ–‡æ¡£é“¾æ¥ï¼‰ï¼Œåœ¨æµè§ˆå™¨é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•´ä¸ªå›¾å·²ç»å˜æˆï¼š æ³¨ï¼šè¿™éƒ¨åˆ†åŠŸèƒ½å¯ä»¥å‚è€ƒæ–‡æ¡£ https://docs.nebula-graph.com.cn/3.3.0/nebula-explorer/graph-explorer/graph-algorithm/ è¿™é‡Œï¼Œåˆ©ç”¨åˆ°äº†ä¸¤ä¸ªå›¾ç®—æ³•æ¥åˆ†æè¿™é‡Œçš„æ´å¯Ÿï¼š åˆ©ç”¨ç‚¹çš„å‡ºå…¥åº¦ï¼Œæ”¹å˜ä»–ä»¬çš„æ˜¾ç¤ºå¤§å°çªå‡ºé‡è¦ç¨‹åº¦ åˆ©ç”¨ Louvain ç®—æ³•åŒºåˆ†ç‚¹çš„ç¤¾åŒºåˆ†å‰² å¯ä»¥çœ‹åˆ°çº¢è‰²çš„å¤§ç‚¹æ˜¯é¼é¼å¤§åçš„å·´å¡ç½—é‚£ï¼Œè€Œå®ƒçš„çƒå‘˜ä»¬ä¹Ÿè¢«çº¢è‰²æ ‡è®°äº†ã€‚ ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:3:3","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#æ¢ç´¢æ•°æ®"},{"categories":["Nebula Graph"],"content":" 3.3 æ¢ç´¢æ•°æ® 3.3.1 æŸ¥è¯¢æ•°æ®ä¸‹é¢ï¼Œæˆ‘ä»¬è¯•ç€æŠŠæ‰€æœ‰çš„æ•°æ®å±•ç¤ºå‡ºæ¥çœ‹çœ‹å§ï¼Œé¦–å…ˆï¼Œå€ŸåŠ© NebulaGraph Explorerï¼Œæˆ‘ç”¨æ‹–æ‹½çš„æ–¹å¼ç”»å‡ºæ¥ä»»æ„ç±»å‹çš„ç‚¹ï¼ˆTAGï¼‰å’Œä»»æ„ç±»å‹ç‚¹ï¼ˆTAGï¼‰ä¹‹é—´çš„è¾¹ï¼Œè¿™é‡Œæˆ‘ä»¬çŸ¥é“æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯è‡³å°‘åŒ…å«åœ¨ä¸€ä¸ªè¾¹é‡Œçš„ï¼Œæ‰€ä»¥ä¸ä¼šæ¼æ‰ä»»ä½•å­¤ç«‹çš„ç‚¹ã€‚ è®©å®ƒå¸®æˆ‘ç”ŸæˆæŸ¥è¯¢çš„è¯­å¥ï¼Œè¿™é‡Œï¼Œå®ƒé»˜è®¤ LIMIT 100 äº†ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ”¹å¤§ä¸€äº›ï¼ˆ LIMIT 10000ï¼‰ï¼Œè®©å®ƒåœ¨ Console é‡Œæ‰§è¡Œã€‚ 3.3.2 åˆæ­¥è§‚å¯Ÿæ•°æ®ç»“æœæ¸²æŸ“å‡ºæ¥æ˜¯è¿™æ ·å­ï¼Œå¯ä»¥çœ‹åˆ°å®ƒå¤©ç„¶å½¢æˆäº†ä¸€ç°‡ä¸€ç°‡çš„æ¨¡å¼ã€‚ è¿™äº›å¤–å›´ã€å½¢æˆçš„ç°‡å¤šæ˜¯ä¸€äº›ç”±éä¼ ç»Ÿæ„ä¹‰ä¸Šçš„æœ‰å…¨çƒå½±å“åŠ›çš„ä¿±ä¹éƒ¨ï¼Œå’Œéä¼ ç»Ÿçš„è¶³çƒå‰å®³çš„å›½å®¶é˜Ÿçš„çƒå‘˜ç»„æˆï¼Œå› ä¸ºé€šå¸¸è¿™äº›ä¿±ä¹éƒ¨åªæœ‰ä¸€ä¸¤ä¸ªçƒå‘˜ï¼Œè€Œä¸”ä»–ä»¬è¿˜é›†ä¸­åœ¨ä¸€ä¸ªå›½å®¶é˜Ÿã€åœ°åŒºï¼Œæ‰€ä»¥æ²¡æœ‰å’Œå¾ˆå¤šå…¶ä»–çƒå‘˜ã€å›½å®¶é˜Ÿäº§ç”Ÿè¿æ¥ã€‚ 3.3.3 å›¾ç®—æ³•è¾…åŠ©åˆ†æåœ¨æˆ‘ç‚¹å‡»äº† Explorer ä¸­çš„ä¸¤ä¸ªæŒ‰é’®ä¹‹åï¼ˆè¯¦ç»†å‚è€ƒåè¾¹çš„æ–‡æ¡£é“¾æ¥ï¼‰ï¼Œåœ¨æµè§ˆå™¨é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•´ä¸ªå›¾å·²ç»å˜æˆï¼š æ³¨ï¼šè¿™éƒ¨åˆ†åŠŸèƒ½å¯ä»¥å‚è€ƒæ–‡æ¡£ https://docs.nebula-graph.com.cn/3.3.0/nebula-explorer/graph-explorer/graph-algorithm/ è¿™é‡Œï¼Œåˆ©ç”¨åˆ°äº†ä¸¤ä¸ªå›¾ç®—æ³•æ¥åˆ†æè¿™é‡Œçš„æ´å¯Ÿï¼š åˆ©ç”¨ç‚¹çš„å‡ºå…¥åº¦ï¼Œæ”¹å˜ä»–ä»¬çš„æ˜¾ç¤ºå¤§å°çªå‡ºé‡è¦ç¨‹åº¦ åˆ©ç”¨ Louvain ç®—æ³•åŒºåˆ†ç‚¹çš„ç¤¾åŒºåˆ†å‰² å¯ä»¥çœ‹åˆ°çº¢è‰²çš„å¤§ç‚¹æ˜¯é¼é¼å¤§åçš„å·´å¡ç½—é‚£ï¼Œè€Œå®ƒçš„çƒå‘˜ä»¬ä¹Ÿè¢«çº¢è‰²æ ‡è®°äº†ã€‚ ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:3:3","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#æŸ¥è¯¢æ•°æ®"},{"categories":["Nebula Graph"],"content":" 3.3 æ¢ç´¢æ•°æ® 3.3.1 æŸ¥è¯¢æ•°æ®ä¸‹é¢ï¼Œæˆ‘ä»¬è¯•ç€æŠŠæ‰€æœ‰çš„æ•°æ®å±•ç¤ºå‡ºæ¥çœ‹çœ‹å§ï¼Œé¦–å…ˆï¼Œå€ŸåŠ© NebulaGraph Explorerï¼Œæˆ‘ç”¨æ‹–æ‹½çš„æ–¹å¼ç”»å‡ºæ¥ä»»æ„ç±»å‹çš„ç‚¹ï¼ˆTAGï¼‰å’Œä»»æ„ç±»å‹ç‚¹ï¼ˆTAGï¼‰ä¹‹é—´çš„è¾¹ï¼Œè¿™é‡Œæˆ‘ä»¬çŸ¥é“æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯è‡³å°‘åŒ…å«åœ¨ä¸€ä¸ªè¾¹é‡Œçš„ï¼Œæ‰€ä»¥ä¸ä¼šæ¼æ‰ä»»ä½•å­¤ç«‹çš„ç‚¹ã€‚ è®©å®ƒå¸®æˆ‘ç”ŸæˆæŸ¥è¯¢çš„è¯­å¥ï¼Œè¿™é‡Œï¼Œå®ƒé»˜è®¤ LIMIT 100 äº†ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ”¹å¤§ä¸€äº›ï¼ˆ LIMIT 10000ï¼‰ï¼Œè®©å®ƒåœ¨ Console é‡Œæ‰§è¡Œã€‚ 3.3.2 åˆæ­¥è§‚å¯Ÿæ•°æ®ç»“æœæ¸²æŸ“å‡ºæ¥æ˜¯è¿™æ ·å­ï¼Œå¯ä»¥çœ‹åˆ°å®ƒå¤©ç„¶å½¢æˆäº†ä¸€ç°‡ä¸€ç°‡çš„æ¨¡å¼ã€‚ è¿™äº›å¤–å›´ã€å½¢æˆçš„ç°‡å¤šæ˜¯ä¸€äº›ç”±éä¼ ç»Ÿæ„ä¹‰ä¸Šçš„æœ‰å…¨çƒå½±å“åŠ›çš„ä¿±ä¹éƒ¨ï¼Œå’Œéä¼ ç»Ÿçš„è¶³çƒå‰å®³çš„å›½å®¶é˜Ÿçš„çƒå‘˜ç»„æˆï¼Œå› ä¸ºé€šå¸¸è¿™äº›ä¿±ä¹éƒ¨åªæœ‰ä¸€ä¸¤ä¸ªçƒå‘˜ï¼Œè€Œä¸”ä»–ä»¬è¿˜é›†ä¸­åœ¨ä¸€ä¸ªå›½å®¶é˜Ÿã€åœ°åŒºï¼Œæ‰€ä»¥æ²¡æœ‰å’Œå¾ˆå¤šå…¶ä»–çƒå‘˜ã€å›½å®¶é˜Ÿäº§ç”Ÿè¿æ¥ã€‚ 3.3.3 å›¾ç®—æ³•è¾…åŠ©åˆ†æåœ¨æˆ‘ç‚¹å‡»äº† Explorer ä¸­çš„ä¸¤ä¸ªæŒ‰é’®ä¹‹åï¼ˆè¯¦ç»†å‚è€ƒåè¾¹çš„æ–‡æ¡£é“¾æ¥ï¼‰ï¼Œåœ¨æµè§ˆå™¨é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•´ä¸ªå›¾å·²ç»å˜æˆï¼š æ³¨ï¼šè¿™éƒ¨åˆ†åŠŸèƒ½å¯ä»¥å‚è€ƒæ–‡æ¡£ https://docs.nebula-graph.com.cn/3.3.0/nebula-explorer/graph-explorer/graph-algorithm/ è¿™é‡Œï¼Œåˆ©ç”¨åˆ°äº†ä¸¤ä¸ªå›¾ç®—æ³•æ¥åˆ†æè¿™é‡Œçš„æ´å¯Ÿï¼š åˆ©ç”¨ç‚¹çš„å‡ºå…¥åº¦ï¼Œæ”¹å˜ä»–ä»¬çš„æ˜¾ç¤ºå¤§å°çªå‡ºé‡è¦ç¨‹åº¦ åˆ©ç”¨ Louvain ç®—æ³•åŒºåˆ†ç‚¹çš„ç¤¾åŒºåˆ†å‰² å¯ä»¥çœ‹åˆ°çº¢è‰²çš„å¤§ç‚¹æ˜¯é¼é¼å¤§åçš„å·´å¡ç½—é‚£ï¼Œè€Œå®ƒçš„çƒå‘˜ä»¬ä¹Ÿè¢«çº¢è‰²æ ‡è®°äº†ã€‚ ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:3:3","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#åˆæ­¥è§‚å¯Ÿæ•°æ®"},{"categories":["Nebula Graph"],"content":" 3.3 æ¢ç´¢æ•°æ® 3.3.1 æŸ¥è¯¢æ•°æ®ä¸‹é¢ï¼Œæˆ‘ä»¬è¯•ç€æŠŠæ‰€æœ‰çš„æ•°æ®å±•ç¤ºå‡ºæ¥çœ‹çœ‹å§ï¼Œé¦–å…ˆï¼Œå€ŸåŠ© NebulaGraph Explorerï¼Œæˆ‘ç”¨æ‹–æ‹½çš„æ–¹å¼ç”»å‡ºæ¥ä»»æ„ç±»å‹çš„ç‚¹ï¼ˆTAGï¼‰å’Œä»»æ„ç±»å‹ç‚¹ï¼ˆTAGï¼‰ä¹‹é—´çš„è¾¹ï¼Œè¿™é‡Œæˆ‘ä»¬çŸ¥é“æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯è‡³å°‘åŒ…å«åœ¨ä¸€ä¸ªè¾¹é‡Œçš„ï¼Œæ‰€ä»¥ä¸ä¼šæ¼æ‰ä»»ä½•å­¤ç«‹çš„ç‚¹ã€‚ è®©å®ƒå¸®æˆ‘ç”ŸæˆæŸ¥è¯¢çš„è¯­å¥ï¼Œè¿™é‡Œï¼Œå®ƒé»˜è®¤ LIMIT 100 äº†ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ”¹å¤§ä¸€äº›ï¼ˆ LIMIT 10000ï¼‰ï¼Œè®©å®ƒåœ¨ Console é‡Œæ‰§è¡Œã€‚ 3.3.2 åˆæ­¥è§‚å¯Ÿæ•°æ®ç»“æœæ¸²æŸ“å‡ºæ¥æ˜¯è¿™æ ·å­ï¼Œå¯ä»¥çœ‹åˆ°å®ƒå¤©ç„¶å½¢æˆäº†ä¸€ç°‡ä¸€ç°‡çš„æ¨¡å¼ã€‚ è¿™äº›å¤–å›´ã€å½¢æˆçš„ç°‡å¤šæ˜¯ä¸€äº›ç”±éä¼ ç»Ÿæ„ä¹‰ä¸Šçš„æœ‰å…¨çƒå½±å“åŠ›çš„ä¿±ä¹éƒ¨ï¼Œå’Œéä¼ ç»Ÿçš„è¶³çƒå‰å®³çš„å›½å®¶é˜Ÿçš„çƒå‘˜ç»„æˆï¼Œå› ä¸ºé€šå¸¸è¿™äº›ä¿±ä¹éƒ¨åªæœ‰ä¸€ä¸¤ä¸ªçƒå‘˜ï¼Œè€Œä¸”ä»–ä»¬è¿˜é›†ä¸­åœ¨ä¸€ä¸ªå›½å®¶é˜Ÿã€åœ°åŒºï¼Œæ‰€ä»¥æ²¡æœ‰å’Œå¾ˆå¤šå…¶ä»–çƒå‘˜ã€å›½å®¶é˜Ÿäº§ç”Ÿè¿æ¥ã€‚ 3.3.3 å›¾ç®—æ³•è¾…åŠ©åˆ†æåœ¨æˆ‘ç‚¹å‡»äº† Explorer ä¸­çš„ä¸¤ä¸ªæŒ‰é’®ä¹‹åï¼ˆè¯¦ç»†å‚è€ƒåè¾¹çš„æ–‡æ¡£é“¾æ¥ï¼‰ï¼Œåœ¨æµè§ˆå™¨é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•´ä¸ªå›¾å·²ç»å˜æˆï¼š æ³¨ï¼šè¿™éƒ¨åˆ†åŠŸèƒ½å¯ä»¥å‚è€ƒæ–‡æ¡£ https://docs.nebula-graph.com.cn/3.3.0/nebula-explorer/graph-explorer/graph-algorithm/ è¿™é‡Œï¼Œåˆ©ç”¨åˆ°äº†ä¸¤ä¸ªå›¾ç®—æ³•æ¥åˆ†æè¿™é‡Œçš„æ´å¯Ÿï¼š åˆ©ç”¨ç‚¹çš„å‡ºå…¥åº¦ï¼Œæ”¹å˜ä»–ä»¬çš„æ˜¾ç¤ºå¤§å°çªå‡ºé‡è¦ç¨‹åº¦ åˆ©ç”¨ Louvain ç®—æ³•åŒºåˆ†ç‚¹çš„ç¤¾åŒºåˆ†å‰² å¯ä»¥çœ‹åˆ°çº¢è‰²çš„å¤§ç‚¹æ˜¯é¼é¼å¤§åçš„å·´å¡ç½—é‚£ï¼Œè€Œå®ƒçš„çƒå‘˜ä»¬ä¹Ÿè¢«çº¢è‰²æ ‡è®°äº†ã€‚ ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:3:3","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#å›¾ç®—æ³•è¾…åŠ©åˆ†æ"},{"categories":["Nebula Graph"],"content":" 3.4 é¢„æµ‹å† å†›ç®—æ³•ä¸ºäº†èƒ½å……åˆ†åˆ©ç”¨å›¾çš„é­”æ³•ï¼ˆä¸å›¾ä¸Šçš„éšå«æ¡ä»¶ã€ä¿¡æ¯ï¼‰ï¼Œæˆ‘çš„æ€è·¯æ˜¯é€‰æ‹©ä¸€ç§åˆ©ç”¨é“¾æ¥è¿›è¡ŒèŠ‚ç‚¹é‡è¦ç¨‹åº¦åˆ†æçš„å›¾ç®—æ³•ï¼Œæ‰¾å‡ºæ‹¥æœ‰æ›´é«˜é‡è¦æ€§çš„ç‚¹ï¼Œå¯¹ä»–ä»¬å…¨å±€è¿­ä»£ã€æ’åºï¼Œä»è€Œè·å¾—å‰å‡ åçš„å›½å®¶é˜Ÿæ’åã€‚ è¿™äº›æ–¹æ³•å…¶å®å°±ä½“ç°åœ¨å‰å®³çš„çƒå‘˜åŒæ—¶æ‹¥æœ‰æ›´å¤§çš„ç¤¾åŒºã€è¿æ¥åº¦ï¼ŒåŒæ—¶ï¼Œä¸ºäº†å¢åŠ ä¼ ç»Ÿå¼ºé˜Ÿä¹‹é—´çš„åŒºåˆ†åº¦ï¼Œæˆ‘å‡†å¤‡æŠŠå‡ºåœºç‡ã€è¿›çƒæ•°çš„ä¿¡æ¯ä¹Ÿè€ƒè™‘è¿›æ¥ã€‚ æœ€ç»ˆï¼Œæˆ‘çš„ç®—æ³•æ˜¯ï¼š å–å‡ºæ‰€æœ‰çš„ (çƒå‘˜)-æœå½¹-\u003e(ä¿±ä¹éƒ¨) çš„å…³ç³»ï¼Œè¿‡æ»¤å…¶ä¸­è¿›çƒæ•°è¿‡å°‘ã€å•åœºè¿›çƒè¿‡å°‘çš„çƒå‘˜ï¼ˆä»¥å¹³è¡¡ä¸€äº›å¼±é˜Ÿçš„è€çƒå‘˜å¸¦æ¥çš„è¿‡å¤§å½±å“ï¼‰ ä»æ‰€æœ‰è¿‡æ»¤ä¹‹åçš„çƒå‘˜ä¸­å‘å¤–æ¢ç´¢ï¼Œè·å¾—å›½å®¶é˜Ÿ åœ¨ä»¥ä¸Šçš„å­å›¾ä¸Šè¿è¡Œ Betweenness Centrality ç®—æ³•ï¼Œè®¡ç®—èŠ‚ç‚¹é‡è¦åº¦è¯„åˆ† 3.4.1 ç®—æ³•è¿‡ç¨‹é¦–å…ˆï¼Œæˆ‘ä»¬å–å‡ºæ‰€æœ‰è¿›çƒæ•°è¶…è¿‡ 10ï¼Œåœºå‡è¿›çƒè¶…è¿‡ 0.2 çš„ (çƒå‘˜)-æœå½¹-\u003e(ä¿±ä¹éƒ¨) çš„å­å›¾ï¼š MATCH ()-[e]-\u003e() WITH e LIMIT 10000 WITH e AS e WHERE e.goals \u003e 10 AND toFloat(e.goals)/e.caps \u003e 0.2 RETURN e æ³¨ï¼šä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘æŠŠè¿›çƒæ•°å’Œå‡ºåœºæ•°ä¹Ÿä½œä¸ºäº† serve è¾¹ä¸Šçš„å±æ€§äº†ã€‚ ç„¶åï¼Œæˆ‘ä»¬å…¨é€‰å›¾ä¸Šçš„æ‰€æœ‰ç‚¹ï¼Œç‚¹å‡»å·¦è¾¹çš„å·¥å…·æ ï¼Œé€‰æ‹©å‡ºæ–¹å‘çš„ belongto è¾¹ï¼Œå‘å¤–è¿›è¡Œå›¾æ‹“å±•ï¼ˆéå†ï¼‰ï¼ŒåŒæ—¶é€‰æ‹©å°†æ‹“å±•å¾—åˆ°çš„æ–°ç‚¹æ ‡è®°ä¸ºæ——å¸œçš„ iconï¼š ç°åœ¨ï¼Œæˆ‘ä»¬è·å¾—äº†æœ€ç»ˆçš„å­å›¾ï¼Œæˆ‘ä»¬åˆ©ç”¨å·¥å…·æ é‡Œçš„æµè§ˆå™¨å†…çš„å›¾ç®—æ³•åŠŸèƒ½ï¼Œæ‰§è¡Œ BNCï¼ˆBetweenness Centralityï¼‰ ç„¶åï¼Œè¿™ä¸ªå­å›¾å˜æˆäº†è¿™æ ·å­ï¼š ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:3:4","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#é¢„æµ‹å† å†›ç®—æ³•"},{"categories":["Nebula Graph"],"content":" 3.4 é¢„æµ‹å† å†›ç®—æ³•ä¸ºäº†èƒ½å……åˆ†åˆ©ç”¨å›¾çš„é­”æ³•ï¼ˆä¸å›¾ä¸Šçš„éšå«æ¡ä»¶ã€ä¿¡æ¯ï¼‰ï¼Œæˆ‘çš„æ€è·¯æ˜¯é€‰æ‹©ä¸€ç§åˆ©ç”¨é“¾æ¥è¿›è¡ŒèŠ‚ç‚¹é‡è¦ç¨‹åº¦åˆ†æçš„å›¾ç®—æ³•ï¼Œæ‰¾å‡ºæ‹¥æœ‰æ›´é«˜é‡è¦æ€§çš„ç‚¹ï¼Œå¯¹ä»–ä»¬å…¨å±€è¿­ä»£ã€æ’åºï¼Œä»è€Œè·å¾—å‰å‡ åçš„å›½å®¶é˜Ÿæ’åã€‚ è¿™äº›æ–¹æ³•å…¶å®å°±ä½“ç°åœ¨å‰å®³çš„çƒå‘˜åŒæ—¶æ‹¥æœ‰æ›´å¤§çš„ç¤¾åŒºã€è¿æ¥åº¦ï¼ŒåŒæ—¶ï¼Œä¸ºäº†å¢åŠ ä¼ ç»Ÿå¼ºé˜Ÿä¹‹é—´çš„åŒºåˆ†åº¦ï¼Œæˆ‘å‡†å¤‡æŠŠå‡ºåœºç‡ã€è¿›çƒæ•°çš„ä¿¡æ¯ä¹Ÿè€ƒè™‘è¿›æ¥ã€‚ æœ€ç»ˆï¼Œæˆ‘çš„ç®—æ³•æ˜¯ï¼š å–å‡ºæ‰€æœ‰çš„ (çƒå‘˜)-æœå½¹-\u003e(ä¿±ä¹éƒ¨) çš„å…³ç³»ï¼Œè¿‡æ»¤å…¶ä¸­è¿›çƒæ•°è¿‡å°‘ã€å•åœºè¿›çƒè¿‡å°‘çš„çƒå‘˜ï¼ˆä»¥å¹³è¡¡ä¸€äº›å¼±é˜Ÿçš„è€çƒå‘˜å¸¦æ¥çš„è¿‡å¤§å½±å“ï¼‰ ä»æ‰€æœ‰è¿‡æ»¤ä¹‹åçš„çƒå‘˜ä¸­å‘å¤–æ¢ç´¢ï¼Œè·å¾—å›½å®¶é˜Ÿ åœ¨ä»¥ä¸Šçš„å­å›¾ä¸Šè¿è¡Œ Betweenness Centrality ç®—æ³•ï¼Œè®¡ç®—èŠ‚ç‚¹é‡è¦åº¦è¯„åˆ† 3.4.1 ç®—æ³•è¿‡ç¨‹é¦–å…ˆï¼Œæˆ‘ä»¬å–å‡ºæ‰€æœ‰è¿›çƒæ•°è¶…è¿‡ 10ï¼Œåœºå‡è¿›çƒè¶…è¿‡ 0.2 çš„ (çƒå‘˜)-æœå½¹-\u003e(ä¿±ä¹éƒ¨) çš„å­å›¾ï¼š MATCH ()-[e]-\u003e() WITH e LIMIT 10000 WITH e AS e WHERE e.goals \u003e 10 AND toFloat(e.goals)/e.caps \u003e 0.2 RETURN e æ³¨ï¼šä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘æŠŠè¿›çƒæ•°å’Œå‡ºåœºæ•°ä¹Ÿä½œä¸ºäº† serve è¾¹ä¸Šçš„å±æ€§äº†ã€‚ ç„¶åï¼Œæˆ‘ä»¬å…¨é€‰å›¾ä¸Šçš„æ‰€æœ‰ç‚¹ï¼Œç‚¹å‡»å·¦è¾¹çš„å·¥å…·æ ï¼Œé€‰æ‹©å‡ºæ–¹å‘çš„ belongto è¾¹ï¼Œå‘å¤–è¿›è¡Œå›¾æ‹“å±•ï¼ˆéå†ï¼‰ï¼ŒåŒæ—¶é€‰æ‹©å°†æ‹“å±•å¾—åˆ°çš„æ–°ç‚¹æ ‡è®°ä¸ºæ——å¸œçš„ iconï¼š ç°åœ¨ï¼Œæˆ‘ä»¬è·å¾—äº†æœ€ç»ˆçš„å­å›¾ï¼Œæˆ‘ä»¬åˆ©ç”¨å·¥å…·æ é‡Œçš„æµè§ˆå™¨å†…çš„å›¾ç®—æ³•åŠŸèƒ½ï¼Œæ‰§è¡Œ BNCï¼ˆBetweenness Centralityï¼‰ ç„¶åï¼Œè¿™ä¸ªå­å›¾å˜æˆäº†è¿™æ ·å­ï¼š ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:3:4","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#ç®—æ³•è¿‡ç¨‹"},{"categories":["Nebula Graph"],"content":" 4 é¢„æµ‹ç»“æœæœ€ç»ˆï¼Œæˆ‘ä»¬æ ¹æ® Betweenness Centrality çš„å€¼ï¼Œæ’åºï¼Œå¯ä»¥å¾—åˆ°æœ€ç»ˆçš„è·èƒœçƒé˜Ÿåº”è¯¥æ˜¯ï¼šå·´è¥¿ ğŸ‡§ğŸ‡·ï¼ å…¶æ¬¡æ˜¯æ¯”åˆ©æ—¶ã€å¾·å›½ã€è‹±æ ¼å…°ã€æ³•å›½ã€é˜¿æ ¹å»·ï¼Œè®©æˆ‘ä»¬ç­‰ä¸¤ä¸ªç¤¼æ‹œå›æ¥çœ‹çœ‹é¢„æµ‹ç»“æœæ˜¯å¦å‡†ç¡®å§ :Dã€‚ æ³¨ï¼šæ’åºæ•°æ®ï¼ˆå…¶ä¸­è¿˜æœ‰éå‚èµ›çƒé˜Ÿçš„ç‚¹ï¼‰ Vertex Betweenness Centrality BrazilğŸ‡§ğŸ‡· 3499 Paris Saint-Germain 3073.3333333333300 Neymar 3000 Tottenham Hotspur 2740 BelgiumğŸ‡§ğŸ‡ª 2587.833333333330 Richarlison 2541 Kevin De Bruyne 2184 Manchester City 2125 Ä°lkay GÃ¼ndoÄŸan 2064 GermanyğŸ‡©ğŸ‡ª 2046 Harry Kane (captain 1869 EnglandğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿ 1864 FranceğŸ‡«ğŸ‡· 1858.6666666666700 ArgentinağŸ‡¦ğŸ‡· 1834.6666666666700 Bayern Munich 1567 Kylian MbappÃ© 1535.3333333333300 Lionel Messi (captain 1535.3333333333300 Gabriel Jesus 1344 é¢˜å›¾ï¼šè¿™ä¸ªæ–‡ç« çš„å›¾ä¹Ÿæ˜¯ç”¨ OpenAI DALL-E 2 ç”Ÿæˆï¼Œå¹¶ç”¨ DALL-E 2 Outpainting æ‰©å……çš„ï¼ŒåŸå›¾ã€‚ ","date":"2022-12-06","objectID":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/:4:0","series":null,"tags":["Nebula Graph","ä¸–ç•Œæ¯","å›¾å»ºæ¨¡","OpenAI","chatGPT","å›¾ç®—æ³•"],"title":"chatGPT åŠ  NebulaGraph é¢„æµ‹ 2022 ä¸–ç•Œæ¯å† å†›çƒé˜Ÿ","uri":"/chatgpt-and-nebulagraph-predict-fifa-world-cup/#é¢„æµ‹ç»“æœ"},{"categories":["Nebula Graph","Amundsen"],"content":"ä¹Ÿè®¸æˆ‘ä»¬æ²¡æœ‰å¿…è¦ä»å¤´åœ¨ NebulaGraph ä¸Šæ­å»ºè‡ªå·±çš„æ•°æ®è¡€ç¼˜é¡¹ç›®ï¼Œæœ¬æ–‡åˆ†äº«å¦‚ä½•ç”¨å¼€æºã€ç°ä»£çš„ DataOpsã€ETLã€Dashboardã€å…ƒæ•°æ®ã€æ•°æ®è¡€ç¼˜ç®¡ç†ç³»ç»Ÿæ„å»ºå¤§æ•°æ®æ²»ç†åŸºç¡€è®¾æ–½","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/"},{"categories":["Nebula Graph","Amundsen"],"content":" ä¹Ÿè®¸æˆ‘ä»¬æ²¡æœ‰å¿…è¦ä»å¤´åœ¨ NebulaGraph ä¸Šæ­å»ºè‡ªå·±çš„æ•°æ®è¡€ç¼˜é¡¹ç›®ï¼Œæœ¬æ–‡åˆ†äº«å¦‚ä½•ç”¨å¼€æºã€ç°ä»£çš„ DataOpsã€ETLã€Dashboardã€å…ƒæ•°æ®ã€æ•°æ®è¡€ç¼˜ç®¡ç†ç³»ç»Ÿæ„å»ºå¤§æ•°æ®æ²»ç†åŸºç¡€è®¾æ–½ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:0:0","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#"},{"categories":["Nebula Graph","Amundsen"],"content":" 1 å…ƒæ•°æ®æ²»ç†ç³»ç»Ÿå…ƒæ•°æ®æ²»ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªæä¾›äº†æ‰€æœ‰æ•°æ®åœ¨å“ªã€å®ƒä»¬çš„æ ¼å¼åŒ–æ–¹å¼ã€ç”Ÿæˆã€è½¬æ¢ã€ä¾èµ–ã€å‘ˆç°å’Œæ‰€å±çš„ä¸€ç«™å¼è§†å›¾ã€‚ å…ƒæ•°æ®æ²»ç†ç³»ç»Ÿæ˜¯æ‰€æœ‰æ•°æ®ä»“åº“ã€æ•°æ®åº“ã€è¡¨ã€ä»ªè¡¨æ¿ã€ETL ä½œä¸šç­‰çš„ç›®å½•æ¥å£ï¼ˆcatalogï¼‰ï¼Œæœ‰äº†å®ƒï¼Œæˆ‘ä»¬å°±ä¸ç”¨åœ¨ç¾¤é‡Œå–Šâ€œå¤§å®¶å¥½ï¼Œæˆ‘å¯ä»¥æ›´æ”¹è¿™ä¸ªè¡¨çš„ schema å—ï¼Ÿâ€ï¼Œ â€œè¯·é—®è°çŸ¥é“æˆ‘å¦‚ä½•æ‰¾åˆ° table-view-foo-bar çš„åŸå§‹æ•°æ®ï¼Ÿâ€ï¼Œä¸€ä¸ªæˆç†Ÿçš„æ•°æ®æ²»ç†æ–¹æ¡ˆä¸­çš„å…ƒæ•°æ®æ²»ç†ç³»ç»Ÿï¼Œå¯¹æˆè§„æ¨¡çš„æ•°æ®å›¢é˜Ÿæ¥è¯´éå¸¸å¿…è¦ã€‚ å¯¹äºå¦ä¸€ä¸ªè¯ï¼šæ•°æ®è¡€ç¼˜åˆ™æ˜¯ä¼—å¤šéœ€è¦ç®¡ç†çš„å…ƒæ•°æ®ä¹‹ä¸€ï¼Œä¾‹å¦‚ï¼ŒæŸäº› Dashboard æ˜¯ æŸä¸€ä¸ª Table View çš„ä¸‹æ¸¸ï¼Œè€Œè¿™ä¸ª Table View åˆæ˜¯ä»å¦å¤–ä¸¤ä¸ªä¸Šæ¸¸çš„è¡¨ JOIN è€Œæ¥ä¸¤ã€‚ æˆ‘ä»¬æ˜¾ç„¶åº”è¯¥æ¸…æ™°çš„æŒæ¡ã€ç®¡ç†è¿™äº›ä¿¡æ¯ï¼Œå»æ„å»ºä¸€ä¸ªå¯ä¿¡ã€å¯æ§çš„ç³»ç»Ÿå’Œæ•°æ®è´¨é‡æ§åˆ¶ä½“ç³»ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:1:0","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#å…ƒæ•°æ®æ²»ç†ç³»ç»Ÿ"},{"categories":["Nebula Graph","Amundsen"],"content":" 2 å‚è€ƒè§£å†³æ–¹æ¡ˆ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:2:0","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#å‚è€ƒè§£å†³æ–¹æ¡ˆ"},{"categories":["Nebula Graph","Amundsen"],"content":" 2.1 æ–¹æ¡ˆçš„åŠ¨æœºå…ƒæ•°æ®å’Œæ•°æ®è¡€ç¼˜æœ¬è´¨ä¸Šéå¸¸é€‚åˆå›¾æ•°æ®å»ºæ¨¡ã€å›¾æ•°æ®åº“çš„åœºæ™¯ã€‚è¿™é‡Œå…¸å‹çš„æŸ¥è¯¢å°±æ˜¯é¢å‘å›¾å…³ç³»çš„æŸ¥è¯¢äº†ï¼Œåƒâ€œæŸ¥æ‰¾æ¯ä¸ªç»™å®šç»„ä»¶ï¼ˆå³è¡¨ï¼‰çš„æ‰€æœ‰ n æ·±åº¦æ•°æ®è¡€ç¼˜â€å°±æ˜¯ä¸€ä¸ª NebulaGraph ä¸­çš„FIND ALL PATH æŸ¥è¯¢ã€‚ ä½œä¸º NebulaGraph ç¤¾åŒºä¸­çš„ä¸€å‘˜ï¼Œæˆ‘å‘ç°äººä»¬åœ¨è®ºå›ã€ç¾¤é‡Œè®¨è®ºçš„æŸ¥è¯¢å’Œå›¾å»ºæ¨¡æ€»èƒ½çœ‹å‡ºæ¥å¾ˆå¤šäººéƒ½åœ¨ NebulaGraph ä¸Šä»å¤´æ­å»ºè‡ªå·±çš„æ•°æ®è¡€ç¼˜ç³»ç»Ÿï¼Œè€Œè¿™äº›å·¥ä½œçœ‹èµ·æ¥å¤§å¤šæ•°éƒ½æ˜¯é‡å¤é€ è½®å­ï¼ˆè€Œä¸”è½®å­å¹¶ä¸å®¹æ˜“é€ ï¼‰ã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹è¿™æ ·çš„å…ƒæ•°æ®æ²»ç†ç³»ç»Ÿçš„è½®å­é‡Œï¼Œéƒ½éœ€è¦é‚£äº›åŠŸèƒ½ç»„ä»¶ï¼š å…ƒæ•°æ® extractor è¿™éƒ¨åˆ†éœ€è¦ä»æ•°æ®æ ˆçš„ä¸åŒæ–¹ï¼ˆå¦‚æ•°æ®åº“ã€æ•°ä»“ã€Dashboardï¼Œç”šè‡³ä» ETL Pipeline å’Œåº”ç”¨ã€æœåŠ¡ç­‰ç­‰ï¼‰ä¸­ä»¥æ‹‰æˆ–è€…æ¨çš„æ–¹å¼è·å–ã€‚ å…ƒæ•°æ®å­˜å‚¨ å¯ä»¥å­˜åœ¨æ•°æ®åº“ã€å›¾æ•°æ®åº“é‡Œï¼Œæˆ–è€…æœ‰æ—¶å€™å­˜æˆè¶…å¤§çš„ JSON manifest æ–‡ä»¶éƒ½è¡Œ å…ƒæ•°æ®ç›®å½•æ¥å£ç³»ç»Ÿï¼ˆCatalogï¼‰ æä¾› API å’Œ/æˆ– GUI ç•Œé¢ä»¥è¯»å–/å†™å…¥å…ƒæ•°æ®å’Œæ•°æ®è¡€ç¼˜çš„ç³»ç»Ÿ åœ¨ NebulaGraph ç¤¾åŒºä¸­ï¼Œæˆ‘çœ‹åˆ°ä¸å°‘äººå› ä¸ºæé—®çš„æŸ¥è¯¢å’Œå»ºæ¨¡ä¸­æ˜æ˜¾æœ‰æ•°æ®è¡€ç¼˜çš„ç—•è¿¹ï¼Œæ„è¯†åˆ°å¤§å®¶éƒ½åœ¨ä»å¤´æ­å»ºæ•°æ®è¡€ç¼˜ç³»ç»Ÿã€‚è€ƒè™‘åˆ°ç³»ç»Ÿä¸­å…ƒæ•°æ®çš„æå–å¯¹è±¡éƒ½æ˜¯ä»å„ç§çŸ¥åæ•°æ®åº“ã€æ•°ä»“ã€æœ€ç»ˆçš„éœ€æ±‚ä¹Ÿå¤§ç›¸å¾„åº­ï¼Œè¿™ç§é‡å¤çš„å¼€å‘ã€ç ”ç©¶ã€æ¢ç´¢æ˜¯ä¸€ç§å¤§å¤§çš„æµªè´¹ã€‚ æ‰€ä»¥ï¼Œæˆ‘å‡†å¤‡æ­å»ºä¸€ä¸ªèƒ½å¤Ÿå¯å‘å¤§å®¶çš„å‚è€ƒæ•°æ®è¡€ç¼˜ã€æ²»ç†æ–¹æ¡ˆï¼Œåˆ©ç”¨åˆ°å¸‚é¢ä¸Šæœ€å¥½çš„å¼€æºé¡¹ç›®ã€‚å¸Œæœ›èƒ½è®©æ‰“ç®—åœ¨ NebulaGraph ä¸Šå®šä¹‰å’Œè¿­ä»£è‡ªå·±çš„ Graph Model å¹¶åˆ›å»ºå†…éƒ¨å…ƒæ•°æ®å’Œ pipeline çš„äººå¯ä»¥ä»è¿™ä¸ªé¡¹ç›®ä¸­å—ç›Šï¼Œä»è€Œæ‹¥æœ‰ä¸€ä¸ªç›¸å¯¹å®Œå–„ã€è®¾è®¡ç²¾ç¾çš„å¼€ç®±å³ç”¨çš„å…ƒæ•°æ®æ²»ç†ç³»ç»Ÿï¼Œå’Œç›¸å¯¹æ›´å®Œå–„çš„å›¾æ¨¡å‹ã€‚ æˆ‘å°½é‡æŠŠè¿™ä¸ªæ–¹æ¡ˆåšçš„å®Œå¤‡ã€ç«¯åˆ°ç«¯ï¼ˆä¸åªæœ‰å…ƒæ•°æ®ç®¡ç†ï¼‰ï¼Œå¸Œæœ›ä¹Ÿèƒ½ä¸ºè€ƒè™‘åšåŸºäºå›¾åšæ•°æ®æ²»ç†çš„æ–°æ‰‹ä¸€äº›å¯å‘å’Œå‚è€ƒã€‚ ä¸‹å›¾æ˜¯æ•´ä¸ªæ–¹æ¡ˆçš„ç®€å•ç¤ºæ„å›¾ï¼š å…¶ä¸­ä¸Šæ–¹æ˜¯å…ƒæ•°æ®çš„æ¥æºä¸å¯¼å…¥ã€ä¸‹æ–¹æ˜¯å…ƒæ•°æ®çš„å­˜å‚¨ä¸å±•ç¤ºã€å‘ç°ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:2:1","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æ–¹æ¡ˆçš„åŠ¨æœº"},{"categories":["Nebula Graph","Amundsen"],"content":" 2.2 æŠ€æœ¯æ ˆä»‹ç»ä¸‹è¾¹ä»‹ç»ä¸€ä¸‹å…¶ä¸­çš„æ¯ä¸€éƒ¨åˆ†ã€‚ 2.2.1 æ•°æ®åº“å’Œæ•°ä»“ä¸ºäº†å¤„ç†å’Œä½¿ç”¨åŸå§‹å’Œä¸­é—´æ•°æ®ï¼Œè¿™é‡Œä¸€å®šæ¶‰åŠè‡³å°‘ä¸€ä¸ªæ•°æ®åº“æˆ–è€…æ•°ä»“ã€‚ å®ƒå¯ä»¥æ˜¯ Hiveã€Apache Deltaã€TiDBã€Cassandraã€MySQL æˆ– Postgresï¼Œåœ¨è¿™ä¸ªå‚è€ƒé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€‰ä¸€ä¸ªç®€å•ã€æµè¡Œçš„ Postgresã€‚ âœ… - æ•°æ®ä»“åº“ï¼šPostgres 2.2.2 æ•°æ®è¿ç»´ DataOpsæˆ‘ä»¬åº”è¯¥æœ‰æŸç§ DataOps çš„æ–¹æ¡ˆï¼Œè®© Pipeline å’Œç¯å¢ƒå…·æœ‰å¯é‡å¤æ€§ã€å¯æµ‹è¯•æ€§å’Œç‰ˆæœ¬æ§åˆ¶æ€§ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† GitLab åˆ›å»ºçš„ Meltanoã€‚ Meltano æ˜¯ä¸€ä¸ª just-work çš„ DataOps å¹³å°ï¼Œå®ƒä»¥ä¸€ç§ç¥å¥‡è€Œä¼˜é›…çš„æ–¹å¼å°† Singer ä½œä¸º EL å’Œ dbt ä½œä¸º T è¿æ¥èµ·æ¥ï¼Œå®ƒè¿˜è¿æ¥åˆ°å…¶ä»–ä¸€äº› dataInfra å®ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Apache Superset å’Œ Apache Airflow ç­‰ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬åˆçº³å…¥äº†ä¸€ä¸ªæˆå‘˜ï¼š âœ… - GitOpsï¼šMeltano https://gitlab.com/meltano/meltano 2.2.3 ETLå¦‚å‰è¾¹æåˆ°ï¼Œæˆ‘ä»¬è¿˜åˆ©ç”¨ Singer ä¸ Meltano ä¸€èµ·å°†æ¥è‡ªè®¸å¤šä¸åŒæ•°æ®æºçš„æ•°æ® Eï¼ˆæå–ï¼‰å’Œ Lï¼ˆåŠ è½½ï¼‰æ•°æ®ç›®æ ‡ï¼Œå¹¶ä½¿ç”¨ dbt ä½œä¸º Transform çš„å¹³å°ã€‚ âœ… - ELï¼šSinger https://singer.io/ âœ… - T: dbt https://getdbt.com/ 2.2.4 æ•°æ®å¯è§†åŒ–åœ¨æ•°æ®ä¹‹ä¸Šåˆ›å»º Dashboardã€å›¾è¡¨å’Œè¡¨æ ¼æ¥è·å¾—æ´å¯Ÿæ˜¯å¾ˆç›´æ¥çš„éœ€æ±‚ï¼ˆå¯ä»¥æƒ³è±¡ä¸ºæƒ³è±¡å¤§æ•°æ®ä¹‹ä¸Šçš„ excel å›¾æ ‡åŠŸèƒ½ï¼‰ã€‚ Apache Superset æ˜¯æˆ‘å¾ˆå–œæ¬¢çš„å¼€æºæ•°æ®å¯è§†åŒ–é¡¹ç›®ï¼Œæˆ‘å‡†å¤‡ç”¨å®ƒæ¥ä½œä¸ºè¢«æ²»ç†ç®¡ç†çš„ç›®æ ‡ä¹‹ä¸€ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šåˆ©ç”¨å®ƒçš„å¯è§†åŒ–ä½œä¸ºå…ƒæ•°æ®æ´å¯ŸåŠŸèƒ½çš„ä¸€éƒ¨åˆ†ã€‚ âœ… - Dashboardï¼šApache Superset https://superset.apache.org/ 2.2.5 ä»»åŠ¡ç¼–æ’ï¼ˆDAG Job Orchestrationï¼‰åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ DataOps ä½œä¸šã€ä»»åŠ¡ä¼šå¢é•¿åˆ°éœ€è¦ä¸€ä¸ªç¼–æ’ç³»ç»Ÿçš„è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Apache Airflow æ¥è´Ÿè´£è¿™ä¸€å—ã€‚ âœ… - DAGï¼šApache Airflow https://airflow.apache.org/ 2.2.6 å…ƒæ•°æ®æ²»ç†éšç€è¶Šæ¥è¶Šå¤šçš„ç»„ä»¶å’Œæ•°æ®è¢«å¼•å…¥æ•°æ®åŸºç¡€è®¾æ–½ï¼Œåœ¨æ•°æ®åº“ã€è¡¨ã€æ•°æ®å»ºæ¨¡(schema)ã€Dashboardã€DAGï¼ˆç¼–æ’ç³»ç»Ÿä¸­çš„æœ‰å‘æ— ç¯å›¾ï¼‰ã€åº”ç”¨ä¸æœåŠ¡çš„æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸä¸­éƒ½å°†å­˜åœ¨æµ·é‡çš„å…ƒæ•°æ®ï¼Œéœ€è¦å¯¹å®ƒä»¬çš„ç®¡ç†å‘˜å’Œå›¢é˜Ÿè¿›è¡ŒååŒç®¡ç†ã€è¿æ¥å’Œå‘ç°ã€‚ Linux Foundation Amundsen æ˜¯æˆ‘è®¤ä¸ºå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æœ€ä½³é¡¹ç›®ä¹‹ä¸€ã€‚ âœ… - æ•°æ®å‘ç°ï¼šLinux Foundation Amundsen https://www.amundsen.io/amundsen/ Amundsen ç”¨å›¾æ•°æ®åº“ä¸ºäº‹å®æºï¼ˆsingle source of truthï¼‰ä»¥åŠ é€Ÿå¤šè·³æŸ¥è¯¢ï¼ŒElastic Search ä¸ºå…¨æ–‡æœç´¢å¼•æ“ï¼Œå®ƒèƒ½å¯¹æ‰€æœ‰å…ƒæ•°æ®åŠå…¶è¡€ç¼˜è¿›è¡Œäº†é¡ºæ»‘çš„å¤„ç†è¿˜æä¾›äº†ä¼˜é›…çš„ UI å’Œ APIã€‚ Amundsen æ”¯æŒå¤šç§å›¾æ•°æ®åº“ä¸ºåç«¯ï¼Œè¿™é‡Œå’±ä»¬ç”¨ NebulaGraphã€‚ âœ… - å…¨æ–‡æœç´¢ï¼šElastic Search âœ… - å›¾æ•°æ®åº“ï¼šNebulaGraph ç°åœ¨ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½é½æ´»äº†ï¼Œå¼€å§‹ç»„è£…å®ƒä»¬å§ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:2:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æŠ€æœ¯æ ˆä»‹ç»"},{"categories":["Nebula Graph","Amundsen"],"content":" 2.2 æŠ€æœ¯æ ˆä»‹ç»ä¸‹è¾¹ä»‹ç»ä¸€ä¸‹å…¶ä¸­çš„æ¯ä¸€éƒ¨åˆ†ã€‚ 2.2.1 æ•°æ®åº“å’Œæ•°ä»“ä¸ºäº†å¤„ç†å’Œä½¿ç”¨åŸå§‹å’Œä¸­é—´æ•°æ®ï¼Œè¿™é‡Œä¸€å®šæ¶‰åŠè‡³å°‘ä¸€ä¸ªæ•°æ®åº“æˆ–è€…æ•°ä»“ã€‚ å®ƒå¯ä»¥æ˜¯ Hiveã€Apache Deltaã€TiDBã€Cassandraã€MySQL æˆ– Postgresï¼Œåœ¨è¿™ä¸ªå‚è€ƒé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€‰ä¸€ä¸ªç®€å•ã€æµè¡Œçš„ Postgresã€‚ âœ… - æ•°æ®ä»“åº“ï¼šPostgres 2.2.2 æ•°æ®è¿ç»´ DataOpsæˆ‘ä»¬åº”è¯¥æœ‰æŸç§ DataOps çš„æ–¹æ¡ˆï¼Œè®© Pipeline å’Œç¯å¢ƒå…·æœ‰å¯é‡å¤æ€§ã€å¯æµ‹è¯•æ€§å’Œç‰ˆæœ¬æ§åˆ¶æ€§ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† GitLab åˆ›å»ºçš„ Meltanoã€‚ Meltano æ˜¯ä¸€ä¸ª just-work çš„ DataOps å¹³å°ï¼Œå®ƒä»¥ä¸€ç§ç¥å¥‡è€Œä¼˜é›…çš„æ–¹å¼å°† Singer ä½œä¸º EL å’Œ dbt ä½œä¸º T è¿æ¥èµ·æ¥ï¼Œå®ƒè¿˜è¿æ¥åˆ°å…¶ä»–ä¸€äº› dataInfra å®ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Apache Superset å’Œ Apache Airflow ç­‰ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬åˆçº³å…¥äº†ä¸€ä¸ªæˆå‘˜ï¼š âœ… - GitOpsï¼šMeltano https://gitlab.com/meltano/meltano 2.2.3 ETLå¦‚å‰è¾¹æåˆ°ï¼Œæˆ‘ä»¬è¿˜åˆ©ç”¨ Singer ä¸ Meltano ä¸€èµ·å°†æ¥è‡ªè®¸å¤šä¸åŒæ•°æ®æºçš„æ•°æ® Eï¼ˆæå–ï¼‰å’Œ Lï¼ˆåŠ è½½ï¼‰æ•°æ®ç›®æ ‡ï¼Œå¹¶ä½¿ç”¨ dbt ä½œä¸º Transform çš„å¹³å°ã€‚ âœ… - ELï¼šSinger https://singer.io/ âœ… - T: dbt https://getdbt.com/ 2.2.4 æ•°æ®å¯è§†åŒ–åœ¨æ•°æ®ä¹‹ä¸Šåˆ›å»º Dashboardã€å›¾è¡¨å’Œè¡¨æ ¼æ¥è·å¾—æ´å¯Ÿæ˜¯å¾ˆç›´æ¥çš„éœ€æ±‚ï¼ˆå¯ä»¥æƒ³è±¡ä¸ºæƒ³è±¡å¤§æ•°æ®ä¹‹ä¸Šçš„ excel å›¾æ ‡åŠŸèƒ½ï¼‰ã€‚ Apache Superset æ˜¯æˆ‘å¾ˆå–œæ¬¢çš„å¼€æºæ•°æ®å¯è§†åŒ–é¡¹ç›®ï¼Œæˆ‘å‡†å¤‡ç”¨å®ƒæ¥ä½œä¸ºè¢«æ²»ç†ç®¡ç†çš„ç›®æ ‡ä¹‹ä¸€ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šåˆ©ç”¨å®ƒçš„å¯è§†åŒ–ä½œä¸ºå…ƒæ•°æ®æ´å¯ŸåŠŸèƒ½çš„ä¸€éƒ¨åˆ†ã€‚ âœ… - Dashboardï¼šApache Superset https://superset.apache.org/ 2.2.5 ä»»åŠ¡ç¼–æ’ï¼ˆDAG Job Orchestrationï¼‰åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ DataOps ä½œä¸šã€ä»»åŠ¡ä¼šå¢é•¿åˆ°éœ€è¦ä¸€ä¸ªç¼–æ’ç³»ç»Ÿçš„è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Apache Airflow æ¥è´Ÿè´£è¿™ä¸€å—ã€‚ âœ… - DAGï¼šApache Airflow https://airflow.apache.org/ 2.2.6 å…ƒæ•°æ®æ²»ç†éšç€è¶Šæ¥è¶Šå¤šçš„ç»„ä»¶å’Œæ•°æ®è¢«å¼•å…¥æ•°æ®åŸºç¡€è®¾æ–½ï¼Œåœ¨æ•°æ®åº“ã€è¡¨ã€æ•°æ®å»ºæ¨¡(schema)ã€Dashboardã€DAGï¼ˆç¼–æ’ç³»ç»Ÿä¸­çš„æœ‰å‘æ— ç¯å›¾ï¼‰ã€åº”ç”¨ä¸æœåŠ¡çš„æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸä¸­éƒ½å°†å­˜åœ¨æµ·é‡çš„å…ƒæ•°æ®ï¼Œéœ€è¦å¯¹å®ƒä»¬çš„ç®¡ç†å‘˜å’Œå›¢é˜Ÿè¿›è¡ŒååŒç®¡ç†ã€è¿æ¥å’Œå‘ç°ã€‚ Linux Foundation Amundsen æ˜¯æˆ‘è®¤ä¸ºå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æœ€ä½³é¡¹ç›®ä¹‹ä¸€ã€‚ âœ… - æ•°æ®å‘ç°ï¼šLinux Foundation Amundsen https://www.amundsen.io/amundsen/ Amundsen ç”¨å›¾æ•°æ®åº“ä¸ºäº‹å®æºï¼ˆsingle source of truthï¼‰ä»¥åŠ é€Ÿå¤šè·³æŸ¥è¯¢ï¼ŒElastic Search ä¸ºå…¨æ–‡æœç´¢å¼•æ“ï¼Œå®ƒèƒ½å¯¹æ‰€æœ‰å…ƒæ•°æ®åŠå…¶è¡€ç¼˜è¿›è¡Œäº†é¡ºæ»‘çš„å¤„ç†è¿˜æä¾›äº†ä¼˜é›…çš„ UI å’Œ APIã€‚ Amundsen æ”¯æŒå¤šç§å›¾æ•°æ®åº“ä¸ºåç«¯ï¼Œè¿™é‡Œå’±ä»¬ç”¨ NebulaGraphã€‚ âœ… - å…¨æ–‡æœç´¢ï¼šElastic Search âœ… - å›¾æ•°æ®åº“ï¼šNebulaGraph ç°åœ¨ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½é½æ´»äº†ï¼Œå¼€å§‹ç»„è£…å®ƒä»¬å§ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:2:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æ•°æ®åº“å’Œæ•°ä»“"},{"categories":["Nebula Graph","Amundsen"],"content":" 2.2 æŠ€æœ¯æ ˆä»‹ç»ä¸‹è¾¹ä»‹ç»ä¸€ä¸‹å…¶ä¸­çš„æ¯ä¸€éƒ¨åˆ†ã€‚ 2.2.1 æ•°æ®åº“å’Œæ•°ä»“ä¸ºäº†å¤„ç†å’Œä½¿ç”¨åŸå§‹å’Œä¸­é—´æ•°æ®ï¼Œè¿™é‡Œä¸€å®šæ¶‰åŠè‡³å°‘ä¸€ä¸ªæ•°æ®åº“æˆ–è€…æ•°ä»“ã€‚ å®ƒå¯ä»¥æ˜¯ Hiveã€Apache Deltaã€TiDBã€Cassandraã€MySQL æˆ– Postgresï¼Œåœ¨è¿™ä¸ªå‚è€ƒé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€‰ä¸€ä¸ªç®€å•ã€æµè¡Œçš„ Postgresã€‚ âœ… - æ•°æ®ä»“åº“ï¼šPostgres 2.2.2 æ•°æ®è¿ç»´ DataOpsæˆ‘ä»¬åº”è¯¥æœ‰æŸç§ DataOps çš„æ–¹æ¡ˆï¼Œè®© Pipeline å’Œç¯å¢ƒå…·æœ‰å¯é‡å¤æ€§ã€å¯æµ‹è¯•æ€§å’Œç‰ˆæœ¬æ§åˆ¶æ€§ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† GitLab åˆ›å»ºçš„ Meltanoã€‚ Meltano æ˜¯ä¸€ä¸ª just-work çš„ DataOps å¹³å°ï¼Œå®ƒä»¥ä¸€ç§ç¥å¥‡è€Œä¼˜é›…çš„æ–¹å¼å°† Singer ä½œä¸º EL å’Œ dbt ä½œä¸º T è¿æ¥èµ·æ¥ï¼Œå®ƒè¿˜è¿æ¥åˆ°å…¶ä»–ä¸€äº› dataInfra å®ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Apache Superset å’Œ Apache Airflow ç­‰ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬åˆçº³å…¥äº†ä¸€ä¸ªæˆå‘˜ï¼š âœ… - GitOpsï¼šMeltano https://gitlab.com/meltano/meltano 2.2.3 ETLå¦‚å‰è¾¹æåˆ°ï¼Œæˆ‘ä»¬è¿˜åˆ©ç”¨ Singer ä¸ Meltano ä¸€èµ·å°†æ¥è‡ªè®¸å¤šä¸åŒæ•°æ®æºçš„æ•°æ® Eï¼ˆæå–ï¼‰å’Œ Lï¼ˆåŠ è½½ï¼‰æ•°æ®ç›®æ ‡ï¼Œå¹¶ä½¿ç”¨ dbt ä½œä¸º Transform çš„å¹³å°ã€‚ âœ… - ELï¼šSinger https://singer.io/ âœ… - T: dbt https://getdbt.com/ 2.2.4 æ•°æ®å¯è§†åŒ–åœ¨æ•°æ®ä¹‹ä¸Šåˆ›å»º Dashboardã€å›¾è¡¨å’Œè¡¨æ ¼æ¥è·å¾—æ´å¯Ÿæ˜¯å¾ˆç›´æ¥çš„éœ€æ±‚ï¼ˆå¯ä»¥æƒ³è±¡ä¸ºæƒ³è±¡å¤§æ•°æ®ä¹‹ä¸Šçš„ excel å›¾æ ‡åŠŸèƒ½ï¼‰ã€‚ Apache Superset æ˜¯æˆ‘å¾ˆå–œæ¬¢çš„å¼€æºæ•°æ®å¯è§†åŒ–é¡¹ç›®ï¼Œæˆ‘å‡†å¤‡ç”¨å®ƒæ¥ä½œä¸ºè¢«æ²»ç†ç®¡ç†çš„ç›®æ ‡ä¹‹ä¸€ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šåˆ©ç”¨å®ƒçš„å¯è§†åŒ–ä½œä¸ºå…ƒæ•°æ®æ´å¯ŸåŠŸèƒ½çš„ä¸€éƒ¨åˆ†ã€‚ âœ… - Dashboardï¼šApache Superset https://superset.apache.org/ 2.2.5 ä»»åŠ¡ç¼–æ’ï¼ˆDAG Job Orchestrationï¼‰åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ DataOps ä½œä¸šã€ä»»åŠ¡ä¼šå¢é•¿åˆ°éœ€è¦ä¸€ä¸ªç¼–æ’ç³»ç»Ÿçš„è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Apache Airflow æ¥è´Ÿè´£è¿™ä¸€å—ã€‚ âœ… - DAGï¼šApache Airflow https://airflow.apache.org/ 2.2.6 å…ƒæ•°æ®æ²»ç†éšç€è¶Šæ¥è¶Šå¤šçš„ç»„ä»¶å’Œæ•°æ®è¢«å¼•å…¥æ•°æ®åŸºç¡€è®¾æ–½ï¼Œåœ¨æ•°æ®åº“ã€è¡¨ã€æ•°æ®å»ºæ¨¡(schema)ã€Dashboardã€DAGï¼ˆç¼–æ’ç³»ç»Ÿä¸­çš„æœ‰å‘æ— ç¯å›¾ï¼‰ã€åº”ç”¨ä¸æœåŠ¡çš„æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸä¸­éƒ½å°†å­˜åœ¨æµ·é‡çš„å…ƒæ•°æ®ï¼Œéœ€è¦å¯¹å®ƒä»¬çš„ç®¡ç†å‘˜å’Œå›¢é˜Ÿè¿›è¡ŒååŒç®¡ç†ã€è¿æ¥å’Œå‘ç°ã€‚ Linux Foundation Amundsen æ˜¯æˆ‘è®¤ä¸ºå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æœ€ä½³é¡¹ç›®ä¹‹ä¸€ã€‚ âœ… - æ•°æ®å‘ç°ï¼šLinux Foundation Amundsen https://www.amundsen.io/amundsen/ Amundsen ç”¨å›¾æ•°æ®åº“ä¸ºäº‹å®æºï¼ˆsingle source of truthï¼‰ä»¥åŠ é€Ÿå¤šè·³æŸ¥è¯¢ï¼ŒElastic Search ä¸ºå…¨æ–‡æœç´¢å¼•æ“ï¼Œå®ƒèƒ½å¯¹æ‰€æœ‰å…ƒæ•°æ®åŠå…¶è¡€ç¼˜è¿›è¡Œäº†é¡ºæ»‘çš„å¤„ç†è¿˜æä¾›äº†ä¼˜é›…çš„ UI å’Œ APIã€‚ Amundsen æ”¯æŒå¤šç§å›¾æ•°æ®åº“ä¸ºåç«¯ï¼Œè¿™é‡Œå’±ä»¬ç”¨ NebulaGraphã€‚ âœ… - å…¨æ–‡æœç´¢ï¼šElastic Search âœ… - å›¾æ•°æ®åº“ï¼šNebulaGraph ç°åœ¨ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½é½æ´»äº†ï¼Œå¼€å§‹ç»„è£…å®ƒä»¬å§ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:2:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æ•°æ®è¿ç»´-dataops"},{"categories":["Nebula Graph","Amundsen"],"content":" 2.2 æŠ€æœ¯æ ˆä»‹ç»ä¸‹è¾¹ä»‹ç»ä¸€ä¸‹å…¶ä¸­çš„æ¯ä¸€éƒ¨åˆ†ã€‚ 2.2.1 æ•°æ®åº“å’Œæ•°ä»“ä¸ºäº†å¤„ç†å’Œä½¿ç”¨åŸå§‹å’Œä¸­é—´æ•°æ®ï¼Œè¿™é‡Œä¸€å®šæ¶‰åŠè‡³å°‘ä¸€ä¸ªæ•°æ®åº“æˆ–è€…æ•°ä»“ã€‚ å®ƒå¯ä»¥æ˜¯ Hiveã€Apache Deltaã€TiDBã€Cassandraã€MySQL æˆ– Postgresï¼Œåœ¨è¿™ä¸ªå‚è€ƒé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€‰ä¸€ä¸ªç®€å•ã€æµè¡Œçš„ Postgresã€‚ âœ… - æ•°æ®ä»“åº“ï¼šPostgres 2.2.2 æ•°æ®è¿ç»´ DataOpsæˆ‘ä»¬åº”è¯¥æœ‰æŸç§ DataOps çš„æ–¹æ¡ˆï¼Œè®© Pipeline å’Œç¯å¢ƒå…·æœ‰å¯é‡å¤æ€§ã€å¯æµ‹è¯•æ€§å’Œç‰ˆæœ¬æ§åˆ¶æ€§ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† GitLab åˆ›å»ºçš„ Meltanoã€‚ Meltano æ˜¯ä¸€ä¸ª just-work çš„ DataOps å¹³å°ï¼Œå®ƒä»¥ä¸€ç§ç¥å¥‡è€Œä¼˜é›…çš„æ–¹å¼å°† Singer ä½œä¸º EL å’Œ dbt ä½œä¸º T è¿æ¥èµ·æ¥ï¼Œå®ƒè¿˜è¿æ¥åˆ°å…¶ä»–ä¸€äº› dataInfra å®ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Apache Superset å’Œ Apache Airflow ç­‰ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬åˆçº³å…¥äº†ä¸€ä¸ªæˆå‘˜ï¼š âœ… - GitOpsï¼šMeltano https://gitlab.com/meltano/meltano 2.2.3 ETLå¦‚å‰è¾¹æåˆ°ï¼Œæˆ‘ä»¬è¿˜åˆ©ç”¨ Singer ä¸ Meltano ä¸€èµ·å°†æ¥è‡ªè®¸å¤šä¸åŒæ•°æ®æºçš„æ•°æ® Eï¼ˆæå–ï¼‰å’Œ Lï¼ˆåŠ è½½ï¼‰æ•°æ®ç›®æ ‡ï¼Œå¹¶ä½¿ç”¨ dbt ä½œä¸º Transform çš„å¹³å°ã€‚ âœ… - ELï¼šSinger https://singer.io/ âœ… - T: dbt https://getdbt.com/ 2.2.4 æ•°æ®å¯è§†åŒ–åœ¨æ•°æ®ä¹‹ä¸Šåˆ›å»º Dashboardã€å›¾è¡¨å’Œè¡¨æ ¼æ¥è·å¾—æ´å¯Ÿæ˜¯å¾ˆç›´æ¥çš„éœ€æ±‚ï¼ˆå¯ä»¥æƒ³è±¡ä¸ºæƒ³è±¡å¤§æ•°æ®ä¹‹ä¸Šçš„ excel å›¾æ ‡åŠŸèƒ½ï¼‰ã€‚ Apache Superset æ˜¯æˆ‘å¾ˆå–œæ¬¢çš„å¼€æºæ•°æ®å¯è§†åŒ–é¡¹ç›®ï¼Œæˆ‘å‡†å¤‡ç”¨å®ƒæ¥ä½œä¸ºè¢«æ²»ç†ç®¡ç†çš„ç›®æ ‡ä¹‹ä¸€ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šåˆ©ç”¨å®ƒçš„å¯è§†åŒ–ä½œä¸ºå…ƒæ•°æ®æ´å¯ŸåŠŸèƒ½çš„ä¸€éƒ¨åˆ†ã€‚ âœ… - Dashboardï¼šApache Superset https://superset.apache.org/ 2.2.5 ä»»åŠ¡ç¼–æ’ï¼ˆDAG Job Orchestrationï¼‰åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ DataOps ä½œä¸šã€ä»»åŠ¡ä¼šå¢é•¿åˆ°éœ€è¦ä¸€ä¸ªç¼–æ’ç³»ç»Ÿçš„è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Apache Airflow æ¥è´Ÿè´£è¿™ä¸€å—ã€‚ âœ… - DAGï¼šApache Airflow https://airflow.apache.org/ 2.2.6 å…ƒæ•°æ®æ²»ç†éšç€è¶Šæ¥è¶Šå¤šçš„ç»„ä»¶å’Œæ•°æ®è¢«å¼•å…¥æ•°æ®åŸºç¡€è®¾æ–½ï¼Œåœ¨æ•°æ®åº“ã€è¡¨ã€æ•°æ®å»ºæ¨¡(schema)ã€Dashboardã€DAGï¼ˆç¼–æ’ç³»ç»Ÿä¸­çš„æœ‰å‘æ— ç¯å›¾ï¼‰ã€åº”ç”¨ä¸æœåŠ¡çš„æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸä¸­éƒ½å°†å­˜åœ¨æµ·é‡çš„å…ƒæ•°æ®ï¼Œéœ€è¦å¯¹å®ƒä»¬çš„ç®¡ç†å‘˜å’Œå›¢é˜Ÿè¿›è¡ŒååŒç®¡ç†ã€è¿æ¥å’Œå‘ç°ã€‚ Linux Foundation Amundsen æ˜¯æˆ‘è®¤ä¸ºå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æœ€ä½³é¡¹ç›®ä¹‹ä¸€ã€‚ âœ… - æ•°æ®å‘ç°ï¼šLinux Foundation Amundsen https://www.amundsen.io/amundsen/ Amundsen ç”¨å›¾æ•°æ®åº“ä¸ºäº‹å®æºï¼ˆsingle source of truthï¼‰ä»¥åŠ é€Ÿå¤šè·³æŸ¥è¯¢ï¼ŒElastic Search ä¸ºå…¨æ–‡æœç´¢å¼•æ“ï¼Œå®ƒèƒ½å¯¹æ‰€æœ‰å…ƒæ•°æ®åŠå…¶è¡€ç¼˜è¿›è¡Œäº†é¡ºæ»‘çš„å¤„ç†è¿˜æä¾›äº†ä¼˜é›…çš„ UI å’Œ APIã€‚ Amundsen æ”¯æŒå¤šç§å›¾æ•°æ®åº“ä¸ºåç«¯ï¼Œè¿™é‡Œå’±ä»¬ç”¨ NebulaGraphã€‚ âœ… - å…¨æ–‡æœç´¢ï¼šElastic Search âœ… - å›¾æ•°æ®åº“ï¼šNebulaGraph ç°åœ¨ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½é½æ´»äº†ï¼Œå¼€å§‹ç»„è£…å®ƒä»¬å§ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:2:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#etl"},{"categories":["Nebula Graph","Amundsen"],"content":" 2.2 æŠ€æœ¯æ ˆä»‹ç»ä¸‹è¾¹ä»‹ç»ä¸€ä¸‹å…¶ä¸­çš„æ¯ä¸€éƒ¨åˆ†ã€‚ 2.2.1 æ•°æ®åº“å’Œæ•°ä»“ä¸ºäº†å¤„ç†å’Œä½¿ç”¨åŸå§‹å’Œä¸­é—´æ•°æ®ï¼Œè¿™é‡Œä¸€å®šæ¶‰åŠè‡³å°‘ä¸€ä¸ªæ•°æ®åº“æˆ–è€…æ•°ä»“ã€‚ å®ƒå¯ä»¥æ˜¯ Hiveã€Apache Deltaã€TiDBã€Cassandraã€MySQL æˆ– Postgresï¼Œåœ¨è¿™ä¸ªå‚è€ƒé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€‰ä¸€ä¸ªç®€å•ã€æµè¡Œçš„ Postgresã€‚ âœ… - æ•°æ®ä»“åº“ï¼šPostgres 2.2.2 æ•°æ®è¿ç»´ DataOpsæˆ‘ä»¬åº”è¯¥æœ‰æŸç§ DataOps çš„æ–¹æ¡ˆï¼Œè®© Pipeline å’Œç¯å¢ƒå…·æœ‰å¯é‡å¤æ€§ã€å¯æµ‹è¯•æ€§å’Œç‰ˆæœ¬æ§åˆ¶æ€§ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† GitLab åˆ›å»ºçš„ Meltanoã€‚ Meltano æ˜¯ä¸€ä¸ª just-work çš„ DataOps å¹³å°ï¼Œå®ƒä»¥ä¸€ç§ç¥å¥‡è€Œä¼˜é›…çš„æ–¹å¼å°† Singer ä½œä¸º EL å’Œ dbt ä½œä¸º T è¿æ¥èµ·æ¥ï¼Œå®ƒè¿˜è¿æ¥åˆ°å…¶ä»–ä¸€äº› dataInfra å®ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Apache Superset å’Œ Apache Airflow ç­‰ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬åˆçº³å…¥äº†ä¸€ä¸ªæˆå‘˜ï¼š âœ… - GitOpsï¼šMeltano https://gitlab.com/meltano/meltano 2.2.3 ETLå¦‚å‰è¾¹æåˆ°ï¼Œæˆ‘ä»¬è¿˜åˆ©ç”¨ Singer ä¸ Meltano ä¸€èµ·å°†æ¥è‡ªè®¸å¤šä¸åŒæ•°æ®æºçš„æ•°æ® Eï¼ˆæå–ï¼‰å’Œ Lï¼ˆåŠ è½½ï¼‰æ•°æ®ç›®æ ‡ï¼Œå¹¶ä½¿ç”¨ dbt ä½œä¸º Transform çš„å¹³å°ã€‚ âœ… - ELï¼šSinger https://singer.io/ âœ… - T: dbt https://getdbt.com/ 2.2.4 æ•°æ®å¯è§†åŒ–åœ¨æ•°æ®ä¹‹ä¸Šåˆ›å»º Dashboardã€å›¾è¡¨å’Œè¡¨æ ¼æ¥è·å¾—æ´å¯Ÿæ˜¯å¾ˆç›´æ¥çš„éœ€æ±‚ï¼ˆå¯ä»¥æƒ³è±¡ä¸ºæƒ³è±¡å¤§æ•°æ®ä¹‹ä¸Šçš„ excel å›¾æ ‡åŠŸèƒ½ï¼‰ã€‚ Apache Superset æ˜¯æˆ‘å¾ˆå–œæ¬¢çš„å¼€æºæ•°æ®å¯è§†åŒ–é¡¹ç›®ï¼Œæˆ‘å‡†å¤‡ç”¨å®ƒæ¥ä½œä¸ºè¢«æ²»ç†ç®¡ç†çš„ç›®æ ‡ä¹‹ä¸€ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šåˆ©ç”¨å®ƒçš„å¯è§†åŒ–ä½œä¸ºå…ƒæ•°æ®æ´å¯ŸåŠŸèƒ½çš„ä¸€éƒ¨åˆ†ã€‚ âœ… - Dashboardï¼šApache Superset https://superset.apache.org/ 2.2.5 ä»»åŠ¡ç¼–æ’ï¼ˆDAG Job Orchestrationï¼‰åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ DataOps ä½œä¸šã€ä»»åŠ¡ä¼šå¢é•¿åˆ°éœ€è¦ä¸€ä¸ªç¼–æ’ç³»ç»Ÿçš„è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Apache Airflow æ¥è´Ÿè´£è¿™ä¸€å—ã€‚ âœ… - DAGï¼šApache Airflow https://airflow.apache.org/ 2.2.6 å…ƒæ•°æ®æ²»ç†éšç€è¶Šæ¥è¶Šå¤šçš„ç»„ä»¶å’Œæ•°æ®è¢«å¼•å…¥æ•°æ®åŸºç¡€è®¾æ–½ï¼Œåœ¨æ•°æ®åº“ã€è¡¨ã€æ•°æ®å»ºæ¨¡(schema)ã€Dashboardã€DAGï¼ˆç¼–æ’ç³»ç»Ÿä¸­çš„æœ‰å‘æ— ç¯å›¾ï¼‰ã€åº”ç”¨ä¸æœåŠ¡çš„æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸä¸­éƒ½å°†å­˜åœ¨æµ·é‡çš„å…ƒæ•°æ®ï¼Œéœ€è¦å¯¹å®ƒä»¬çš„ç®¡ç†å‘˜å’Œå›¢é˜Ÿè¿›è¡ŒååŒç®¡ç†ã€è¿æ¥å’Œå‘ç°ã€‚ Linux Foundation Amundsen æ˜¯æˆ‘è®¤ä¸ºå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æœ€ä½³é¡¹ç›®ä¹‹ä¸€ã€‚ âœ… - æ•°æ®å‘ç°ï¼šLinux Foundation Amundsen https://www.amundsen.io/amundsen/ Amundsen ç”¨å›¾æ•°æ®åº“ä¸ºäº‹å®æºï¼ˆsingle source of truthï¼‰ä»¥åŠ é€Ÿå¤šè·³æŸ¥è¯¢ï¼ŒElastic Search ä¸ºå…¨æ–‡æœç´¢å¼•æ“ï¼Œå®ƒèƒ½å¯¹æ‰€æœ‰å…ƒæ•°æ®åŠå…¶è¡€ç¼˜è¿›è¡Œäº†é¡ºæ»‘çš„å¤„ç†è¿˜æä¾›äº†ä¼˜é›…çš„ UI å’Œ APIã€‚ Amundsen æ”¯æŒå¤šç§å›¾æ•°æ®åº“ä¸ºåç«¯ï¼Œè¿™é‡Œå’±ä»¬ç”¨ NebulaGraphã€‚ âœ… - å…¨æ–‡æœç´¢ï¼šElastic Search âœ… - å›¾æ•°æ®åº“ï¼šNebulaGraph ç°åœ¨ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½é½æ´»äº†ï¼Œå¼€å§‹ç»„è£…å®ƒä»¬å§ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:2:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æ•°æ®å¯è§†åŒ–"},{"categories":["Nebula Graph","Amundsen"],"content":" 2.2 æŠ€æœ¯æ ˆä»‹ç»ä¸‹è¾¹ä»‹ç»ä¸€ä¸‹å…¶ä¸­çš„æ¯ä¸€éƒ¨åˆ†ã€‚ 2.2.1 æ•°æ®åº“å’Œæ•°ä»“ä¸ºäº†å¤„ç†å’Œä½¿ç”¨åŸå§‹å’Œä¸­é—´æ•°æ®ï¼Œè¿™é‡Œä¸€å®šæ¶‰åŠè‡³å°‘ä¸€ä¸ªæ•°æ®åº“æˆ–è€…æ•°ä»“ã€‚ å®ƒå¯ä»¥æ˜¯ Hiveã€Apache Deltaã€TiDBã€Cassandraã€MySQL æˆ– Postgresï¼Œåœ¨è¿™ä¸ªå‚è€ƒé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€‰ä¸€ä¸ªç®€å•ã€æµè¡Œçš„ Postgresã€‚ âœ… - æ•°æ®ä»“åº“ï¼šPostgres 2.2.2 æ•°æ®è¿ç»´ DataOpsæˆ‘ä»¬åº”è¯¥æœ‰æŸç§ DataOps çš„æ–¹æ¡ˆï¼Œè®© Pipeline å’Œç¯å¢ƒå…·æœ‰å¯é‡å¤æ€§ã€å¯æµ‹è¯•æ€§å’Œç‰ˆæœ¬æ§åˆ¶æ€§ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† GitLab åˆ›å»ºçš„ Meltanoã€‚ Meltano æ˜¯ä¸€ä¸ª just-work çš„ DataOps å¹³å°ï¼Œå®ƒä»¥ä¸€ç§ç¥å¥‡è€Œä¼˜é›…çš„æ–¹å¼å°† Singer ä½œä¸º EL å’Œ dbt ä½œä¸º T è¿æ¥èµ·æ¥ï¼Œå®ƒè¿˜è¿æ¥åˆ°å…¶ä»–ä¸€äº› dataInfra å®ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Apache Superset å’Œ Apache Airflow ç­‰ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬åˆçº³å…¥äº†ä¸€ä¸ªæˆå‘˜ï¼š âœ… - GitOpsï¼šMeltano https://gitlab.com/meltano/meltano 2.2.3 ETLå¦‚å‰è¾¹æåˆ°ï¼Œæˆ‘ä»¬è¿˜åˆ©ç”¨ Singer ä¸ Meltano ä¸€èµ·å°†æ¥è‡ªè®¸å¤šä¸åŒæ•°æ®æºçš„æ•°æ® Eï¼ˆæå–ï¼‰å’Œ Lï¼ˆåŠ è½½ï¼‰æ•°æ®ç›®æ ‡ï¼Œå¹¶ä½¿ç”¨ dbt ä½œä¸º Transform çš„å¹³å°ã€‚ âœ… - ELï¼šSinger https://singer.io/ âœ… - T: dbt https://getdbt.com/ 2.2.4 æ•°æ®å¯è§†åŒ–åœ¨æ•°æ®ä¹‹ä¸Šåˆ›å»º Dashboardã€å›¾è¡¨å’Œè¡¨æ ¼æ¥è·å¾—æ´å¯Ÿæ˜¯å¾ˆç›´æ¥çš„éœ€æ±‚ï¼ˆå¯ä»¥æƒ³è±¡ä¸ºæƒ³è±¡å¤§æ•°æ®ä¹‹ä¸Šçš„ excel å›¾æ ‡åŠŸèƒ½ï¼‰ã€‚ Apache Superset æ˜¯æˆ‘å¾ˆå–œæ¬¢çš„å¼€æºæ•°æ®å¯è§†åŒ–é¡¹ç›®ï¼Œæˆ‘å‡†å¤‡ç”¨å®ƒæ¥ä½œä¸ºè¢«æ²»ç†ç®¡ç†çš„ç›®æ ‡ä¹‹ä¸€ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šåˆ©ç”¨å®ƒçš„å¯è§†åŒ–ä½œä¸ºå…ƒæ•°æ®æ´å¯ŸåŠŸèƒ½çš„ä¸€éƒ¨åˆ†ã€‚ âœ… - Dashboardï¼šApache Superset https://superset.apache.org/ 2.2.5 ä»»åŠ¡ç¼–æ’ï¼ˆDAG Job Orchestrationï¼‰åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ DataOps ä½œä¸šã€ä»»åŠ¡ä¼šå¢é•¿åˆ°éœ€è¦ä¸€ä¸ªç¼–æ’ç³»ç»Ÿçš„è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Apache Airflow æ¥è´Ÿè´£è¿™ä¸€å—ã€‚ âœ… - DAGï¼šApache Airflow https://airflow.apache.org/ 2.2.6 å…ƒæ•°æ®æ²»ç†éšç€è¶Šæ¥è¶Šå¤šçš„ç»„ä»¶å’Œæ•°æ®è¢«å¼•å…¥æ•°æ®åŸºç¡€è®¾æ–½ï¼Œåœ¨æ•°æ®åº“ã€è¡¨ã€æ•°æ®å»ºæ¨¡(schema)ã€Dashboardã€DAGï¼ˆç¼–æ’ç³»ç»Ÿä¸­çš„æœ‰å‘æ— ç¯å›¾ï¼‰ã€åº”ç”¨ä¸æœåŠ¡çš„æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸä¸­éƒ½å°†å­˜åœ¨æµ·é‡çš„å…ƒæ•°æ®ï¼Œéœ€è¦å¯¹å®ƒä»¬çš„ç®¡ç†å‘˜å’Œå›¢é˜Ÿè¿›è¡ŒååŒç®¡ç†ã€è¿æ¥å’Œå‘ç°ã€‚ Linux Foundation Amundsen æ˜¯æˆ‘è®¤ä¸ºå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æœ€ä½³é¡¹ç›®ä¹‹ä¸€ã€‚ âœ… - æ•°æ®å‘ç°ï¼šLinux Foundation Amundsen https://www.amundsen.io/amundsen/ Amundsen ç”¨å›¾æ•°æ®åº“ä¸ºäº‹å®æºï¼ˆsingle source of truthï¼‰ä»¥åŠ é€Ÿå¤šè·³æŸ¥è¯¢ï¼ŒElastic Search ä¸ºå…¨æ–‡æœç´¢å¼•æ“ï¼Œå®ƒèƒ½å¯¹æ‰€æœ‰å…ƒæ•°æ®åŠå…¶è¡€ç¼˜è¿›è¡Œäº†é¡ºæ»‘çš„å¤„ç†è¿˜æä¾›äº†ä¼˜é›…çš„ UI å’Œ APIã€‚ Amundsen æ”¯æŒå¤šç§å›¾æ•°æ®åº“ä¸ºåç«¯ï¼Œè¿™é‡Œå’±ä»¬ç”¨ NebulaGraphã€‚ âœ… - å…¨æ–‡æœç´¢ï¼šElastic Search âœ… - å›¾æ•°æ®åº“ï¼šNebulaGraph ç°åœ¨ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½é½æ´»äº†ï¼Œå¼€å§‹ç»„è£…å®ƒä»¬å§ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:2:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#ä»»åŠ¡ç¼–æ’dag-job-orchestration"},{"categories":["Nebula Graph","Amundsen"],"content":" 2.2 æŠ€æœ¯æ ˆä»‹ç»ä¸‹è¾¹ä»‹ç»ä¸€ä¸‹å…¶ä¸­çš„æ¯ä¸€éƒ¨åˆ†ã€‚ 2.2.1 æ•°æ®åº“å’Œæ•°ä»“ä¸ºäº†å¤„ç†å’Œä½¿ç”¨åŸå§‹å’Œä¸­é—´æ•°æ®ï¼Œè¿™é‡Œä¸€å®šæ¶‰åŠè‡³å°‘ä¸€ä¸ªæ•°æ®åº“æˆ–è€…æ•°ä»“ã€‚ å®ƒå¯ä»¥æ˜¯ Hiveã€Apache Deltaã€TiDBã€Cassandraã€MySQL æˆ– Postgresï¼Œåœ¨è¿™ä¸ªå‚è€ƒé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€‰ä¸€ä¸ªç®€å•ã€æµè¡Œçš„ Postgresã€‚ âœ… - æ•°æ®ä»“åº“ï¼šPostgres 2.2.2 æ•°æ®è¿ç»´ DataOpsæˆ‘ä»¬åº”è¯¥æœ‰æŸç§ DataOps çš„æ–¹æ¡ˆï¼Œè®© Pipeline å’Œç¯å¢ƒå…·æœ‰å¯é‡å¤æ€§ã€å¯æµ‹è¯•æ€§å’Œç‰ˆæœ¬æ§åˆ¶æ€§ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† GitLab åˆ›å»ºçš„ Meltanoã€‚ Meltano æ˜¯ä¸€ä¸ª just-work çš„ DataOps å¹³å°ï¼Œå®ƒä»¥ä¸€ç§ç¥å¥‡è€Œä¼˜é›…çš„æ–¹å¼å°† Singer ä½œä¸º EL å’Œ dbt ä½œä¸º T è¿æ¥èµ·æ¥ï¼Œå®ƒè¿˜è¿æ¥åˆ°å…¶ä»–ä¸€äº› dataInfra å®ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Apache Superset å’Œ Apache Airflow ç­‰ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬åˆçº³å…¥äº†ä¸€ä¸ªæˆå‘˜ï¼š âœ… - GitOpsï¼šMeltano https://gitlab.com/meltano/meltano 2.2.3 ETLå¦‚å‰è¾¹æåˆ°ï¼Œæˆ‘ä»¬è¿˜åˆ©ç”¨ Singer ä¸ Meltano ä¸€èµ·å°†æ¥è‡ªè®¸å¤šä¸åŒæ•°æ®æºçš„æ•°æ® Eï¼ˆæå–ï¼‰å’Œ Lï¼ˆåŠ è½½ï¼‰æ•°æ®ç›®æ ‡ï¼Œå¹¶ä½¿ç”¨ dbt ä½œä¸º Transform çš„å¹³å°ã€‚ âœ… - ELï¼šSinger https://singer.io/ âœ… - T: dbt https://getdbt.com/ 2.2.4 æ•°æ®å¯è§†åŒ–åœ¨æ•°æ®ä¹‹ä¸Šåˆ›å»º Dashboardã€å›¾è¡¨å’Œè¡¨æ ¼æ¥è·å¾—æ´å¯Ÿæ˜¯å¾ˆç›´æ¥çš„éœ€æ±‚ï¼ˆå¯ä»¥æƒ³è±¡ä¸ºæƒ³è±¡å¤§æ•°æ®ä¹‹ä¸Šçš„ excel å›¾æ ‡åŠŸèƒ½ï¼‰ã€‚ Apache Superset æ˜¯æˆ‘å¾ˆå–œæ¬¢çš„å¼€æºæ•°æ®å¯è§†åŒ–é¡¹ç›®ï¼Œæˆ‘å‡†å¤‡ç”¨å®ƒæ¥ä½œä¸ºè¢«æ²»ç†ç®¡ç†çš„ç›®æ ‡ä¹‹ä¸€ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šåˆ©ç”¨å®ƒçš„å¯è§†åŒ–ä½œä¸ºå…ƒæ•°æ®æ´å¯ŸåŠŸèƒ½çš„ä¸€éƒ¨åˆ†ã€‚ âœ… - Dashboardï¼šApache Superset https://superset.apache.org/ 2.2.5 ä»»åŠ¡ç¼–æ’ï¼ˆDAG Job Orchestrationï¼‰åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ DataOps ä½œä¸šã€ä»»åŠ¡ä¼šå¢é•¿åˆ°éœ€è¦ä¸€ä¸ªç¼–æ’ç³»ç»Ÿçš„è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Apache Airflow æ¥è´Ÿè´£è¿™ä¸€å—ã€‚ âœ… - DAGï¼šApache Airflow https://airflow.apache.org/ 2.2.6 å…ƒæ•°æ®æ²»ç†éšç€è¶Šæ¥è¶Šå¤šçš„ç»„ä»¶å’Œæ•°æ®è¢«å¼•å…¥æ•°æ®åŸºç¡€è®¾æ–½ï¼Œåœ¨æ•°æ®åº“ã€è¡¨ã€æ•°æ®å»ºæ¨¡(schema)ã€Dashboardã€DAGï¼ˆç¼–æ’ç³»ç»Ÿä¸­çš„æœ‰å‘æ— ç¯å›¾ï¼‰ã€åº”ç”¨ä¸æœåŠ¡çš„æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸä¸­éƒ½å°†å­˜åœ¨æµ·é‡çš„å…ƒæ•°æ®ï¼Œéœ€è¦å¯¹å®ƒä»¬çš„ç®¡ç†å‘˜å’Œå›¢é˜Ÿè¿›è¡ŒååŒç®¡ç†ã€è¿æ¥å’Œå‘ç°ã€‚ Linux Foundation Amundsen æ˜¯æˆ‘è®¤ä¸ºå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æœ€ä½³é¡¹ç›®ä¹‹ä¸€ã€‚ âœ… - æ•°æ®å‘ç°ï¼šLinux Foundation Amundsen https://www.amundsen.io/amundsen/ Amundsen ç”¨å›¾æ•°æ®åº“ä¸ºäº‹å®æºï¼ˆsingle source of truthï¼‰ä»¥åŠ é€Ÿå¤šè·³æŸ¥è¯¢ï¼ŒElastic Search ä¸ºå…¨æ–‡æœç´¢å¼•æ“ï¼Œå®ƒèƒ½å¯¹æ‰€æœ‰å…ƒæ•°æ®åŠå…¶è¡€ç¼˜è¿›è¡Œäº†é¡ºæ»‘çš„å¤„ç†è¿˜æä¾›äº†ä¼˜é›…çš„ UI å’Œ APIã€‚ Amundsen æ”¯æŒå¤šç§å›¾æ•°æ®åº“ä¸ºåç«¯ï¼Œè¿™é‡Œå’±ä»¬ç”¨ NebulaGraphã€‚ âœ… - å…¨æ–‡æœç´¢ï¼šElastic Search âœ… - å›¾æ•°æ®åº“ï¼šNebulaGraph ç°åœ¨ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½é½æ´»äº†ï¼Œå¼€å§‹ç»„è£…å®ƒä»¬å§ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:2:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#å…ƒæ•°æ®æ²»ç†"},{"categories":["Nebula Graph","Amundsen"],"content":" 3 ç¯å¢ƒæ­å»ºä¸å„ç»„ä»¶åˆè¯†æ•´ä¸ªé¡¹ç›®æ–¹æ¡ˆéƒ½æ˜¯å¼€æºçš„ï¼Œå¤§å®¶å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å®ƒçš„æ‰€æœ‰ç»†èŠ‚ï¼š https://github.com/wey-gu/data-lineage-ref-solution æ•´ä¸ªé¡¹ç›®å¤§å®¶çš„å®éªŒä¸­æˆ‘éµå¾ªå°½é‡å¹²å‡€ã€é¼“åŠ±çš„åŸåˆ™ï¼Œéœ€è¦å‡è®¾åœ¨ä¸€ä¸ª unix-like çš„ç³»ç»Ÿä¸Šè¿è¡Œï¼Œæœ‰äº’è”ç½‘å’Œ Docker-Composeã€‚ æ³¨ï¼šå‚è€ƒ https://docs.docker.com/compose/install/ åœ¨ç»§ç»­ä¹‹å‰å®‰è£… Docker å’Œ Docker Composeã€‚ è¿™é‡Œæˆ‘ä»¬åœ¨ Ubuntu 20.04 LTS X86_64 ä¸Šè¿è¡Œå®ƒï¼Œä½†åœ¨å…¶ä»–å‘è¡Œç‰ˆæˆ– Linux ç‰ˆæœ¬ä¸Šåº”è¯¥ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:0","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#ç¯å¢ƒæ­å»ºä¸å„ç»„ä»¶åˆè¯†"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.1 è¿è¡Œä¸€ä¸ªæ•°ä»“ã€æ•°æ®åº“é¦–å…ˆï¼Œå®‰è£… Postgres ä½œä¸ºæˆ‘ä»¬çš„æ•°ä»“ã€‚ è¿™ä¸ªå•è¡Œå‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªä½¿ç”¨ docker åœ¨åå°è¿è¡Œçš„ Postgresï¼Œè¿›ç¨‹å…³é—­ä¹‹åå®¹å™¨ä¸ä¼šæ®‹ç•™è€Œæ˜¯è¢«æ¸…ç†æ‰ï¼ˆå› ä¸ºå‚æ•°--rmï¼‰ã€‚ docker run --rm --name postgres \\ -e POSTGRES_PASSWORD=lineage_ref \\ -e POSTGRES_USER=lineage_ref \\ -e POSTGRES_DB=warehouse -d \\ -p 5432:5432 postgres ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Postgres CLI æˆ– GUI å®¢æˆ·ç«¯æ¥éªŒè¯å®ƒã€‚ æç¤ºï¼šå¯ä»¥ç”¨ VS Code æ’ä»¶ï¼šSQL TOOLS å¿«é€Ÿä»¥ GUI æ–¹å¼è¿æ¥åˆ°æ•°æ®åº“ï¼ˆæ”¯æŒ MariaDBã€Postgres ã€Cassandra ç­‰ï¼‰ https://marketplace.visualstudio.com/items?itemName=mtxr.sqltools ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:1","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#è¿è¡Œä¸€ä¸ªæ•°ä»“æ•°æ®åº“"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.2 DataOps å·¥å…·é“¾éƒ¨ç½²ç„¶åï¼Œå®‰è£…æœ‰æœºç»“åˆäº† Singler å’Œ dbt çš„ Meltanoã€‚ Meltano å¸®åŠ©æˆ‘ä»¬ç®¡ç† ETL å·¥å…·ï¼ˆä½œä¸ºæ’ä»¶ï¼‰åŠå…¶æ‰€æœ‰é…ç½®å’Œ pipelineã€‚ è¿™äº›å…ƒä¿¡æ¯ä½äº meltano é…ç½®åŠå…¶ç³»ç»Ÿæ•°æ®åº“ï¼ˆhttps://docs.meltano.com/concepts/project#system-databaseï¼‰ä¸­ï¼Œå…¶ä¸­é…ç½®æ˜¯åŸºäºæ–‡ä»¶çš„ï¼ˆå¯ä»¥ä½¿ç”¨ GitOps ç®¡ç†ï¼‰ï¼Œå®ƒçš„é»˜è®¤ç³»ç»Ÿæ•°æ®åº“æ˜¯ SQLiteã€‚ 3.2.1 å®‰è£… Meltanoä½¿ç”¨ Meltano çš„å·¥ä½œæµæ˜¯å¯åŠ¨ä¸€ä¸ªâ€œmeltano é¡¹ç›®â€å¹¶å¼€å§‹å°† Eã€L å’Œ T æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚ é¡¹ç›®çš„å¯åŠ¨åªéœ€è¦ä¸€ä¸ª CLI å‘½ä»¤è°ƒç”¨ï¼šmeltano init yourprojectnameï¼Œåœ¨é‚£ä¹‹å‰ï¼Œå¯ä»¥å…ˆç”¨ Python çš„åŒ…ç®¡ç†å™¨ï¼špip æˆ–è€… Docker é•œåƒå®‰è£… Meltanoï¼š åœ¨ python è™šæ‹Ÿç¯å¢ƒä¸­ä½¿ç”¨ pip å®‰è£… Meltanoï¼š mkdir .venv # example in a debian flavor Linux distro sudo apt-get install python3-dev python3-pip python3-venv python3-wheel -y python3 -m venv .venv/meltano source .venv/meltano/bin/activate python3 -m pip install wheel python3 -m pip install meltano # init a project mkdir meltano_projects \u0026\u0026 cd meltano_projects # replace \u003cyourprojectname\u003e with your own one touch .env meltano init \u003cyourprojectname\u003e æˆ–è€…ç”¨å®¹å™¨å®‰è£… Meltanoï¼š docker pull meltano/meltano:latest docker run --rm meltano/meltano --version # init a project mkdir meltano_projects \u0026\u0026 cd meltano_projects # replace \u003cyourprojectname\u003e with your own one touch .env docker run --rm -v \"$(pwd)\":/projects \\ -w /projects --env-file .env \\ meltano/meltano init \u003cyourprojectname\u003e é™¤äº† meltano initï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–å‘½ä»¤ï¼Œä¾‹å¦‚ meltano etl è¡¨ç¤º ETL çš„æ‰§è¡Œï¼Œè¿˜æœ‰ meltano invoke \u003cplugin\u003e æ¥è°ƒç”¨æ’ä»¶å‘½ä»¤ï¼Œè¯¦ç»†å¯ä»¥å‚è€ƒå®ƒçš„é€ŸæŸ¥è¡¨ï¼ˆhttps://docs.meltano.com/reference/command-line-interfaceï¼‰ã€‚ 3.2.2 Meltano GUI ç•Œé¢Meltano è¿˜å¸¦æœ‰ä¸€ä¸ªåŸºäº Web çš„ UIï¼Œæ‰§è¡Œ ui å­å‘½ä»¤å°±æ˜¯å¯åŠ¨å®ƒï¼š meltano ui é»˜è®¤ä»–ä¼šè·‘åœ¨ http://localhost:5000 ä¸Šã€‚ å¯¹äº Docker è¿è¡Œçš„æƒ…å†µï¼Œåªéœ€è¦åœ¨æš´éœ² 5000 ç«¯å£çš„æƒ…å†µä¸‹è¿è¡Œå®¹å™¨å³å¯ï¼Œç”±äºå®¹å™¨çš„é»˜è®¤å‘½ä»¤å·²ç»æ˜¯ meltano uiï¼Œæ‰€ä»¥ run çš„å‘½ä»¤åªéœ€ï¼š docker run -v \"$(pwd)\":/project \\ -w /project \\ -p 5000:5000 \\ meltano/meltano 3.2.3 Meltano é¡¹ç›®ç¤ºä¾‹å†™åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘æ³¨æ„åˆ° Pat Nadolny åˆ›å»ºäº†å¾ˆå¥½çš„ç¤ºä¾‹é¡¹ç›®åœ¨ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/singer_dbt_jaffleï¼Œå®ƒåˆ©ç”¨ dbt çš„ Meltano ç¤ºä¾‹æ•°æ®é›†ï¼Œé‡‡ç”¨ Airflow ç¼–æ’ ETL ä»»åŠ¡ï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/dbt_orchestrationï¼Œè¿˜æœ‰åˆ©ç”¨ Superset çš„ä¾‹å­ï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/jaffle_supersetï¼‰ã€‚ è¿™é‡Œï¼Œæˆ‘å°±ä¸é‡å¤é€ è½®å­äº†ï¼Œç›´æ¥åˆ©ç”¨ä»–çš„ä¾‹å­å§ã€‚ å’±ä»¬å¯ä»¥å‚ç…§ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/singer_dbt_jaffleï¼Œè¿è¡Œè¿™æ ·çš„æ•°æ®ç®¡é“ï¼ˆpipelineï¼‰ï¼š tap-CSV(Singer)ï¼Œä» CSV æ–‡ä»¶ä¸­æå–æ•°æ® target-postgres(Singer)ï¼Œå°†æ•°æ®åŠ è½½åˆ° Postgres dbtï¼Œå°†æ•°æ®è½¬æ¢ä¸ºèšåˆè¡¨æˆ–è§†å›¾ æ³¨æ„ï¼Œå‰è¾¹æˆ‘ä»¬å·²ç»å¯åŠ¨äº† postgresï¼Œé‚£ä¸€æ­¥å¯ä»¥è·³è¿‡ã€‚ æ“ä½œè¿‡ç¨‹æ˜¯ï¼š git clone https://github.com/pnadolny13/meltano_example_implementations.git cd meltano_example_implementations/meltano_projects/singer_dbt_jaffle/ meltano install touch .env echo PG_PASSWORD=\"lineage_ref\" \u003e\u003e .env echo PG_USERNAME=\"lineage_ref\" \u003e\u003e .env # Extract and Load(with Singer) meltano run tap-csv target-postgres # Trasnform(with dbt) meltano run dbt:run # Generate dbt docs meltano invoke dbt docs generate # Serve generated dbt docs meltano invoke dbt docs to serve # Then visit http://localhost:8080 ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿æ¥åˆ° Postgres æ¥æŸ¥çœ‹ åŠ è½½å’Œè½¬æ¢åçš„æ•°æ®é¢„è§ˆå¦‚ä¸‹ï¼Œæˆªå›¾æ¥è‡ª VS Code çš„ SQLToolï¼š Payments è¡¨é‡Œé•¿è¿™æ ·å­ï¼š ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#dataops-å·¥å…·é“¾éƒ¨ç½²"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.2 DataOps å·¥å…·é“¾éƒ¨ç½²ç„¶åï¼Œå®‰è£…æœ‰æœºç»“åˆäº† Singler å’Œ dbt çš„ Meltanoã€‚ Meltano å¸®åŠ©æˆ‘ä»¬ç®¡ç† ETL å·¥å…·ï¼ˆä½œä¸ºæ’ä»¶ï¼‰åŠå…¶æ‰€æœ‰é…ç½®å’Œ pipelineã€‚ è¿™äº›å…ƒä¿¡æ¯ä½äº meltano é…ç½®åŠå…¶ç³»ç»Ÿæ•°æ®åº“ï¼ˆhttps://docs.meltano.com/concepts/project#system-databaseï¼‰ä¸­ï¼Œå…¶ä¸­é…ç½®æ˜¯åŸºäºæ–‡ä»¶çš„ï¼ˆå¯ä»¥ä½¿ç”¨ GitOps ç®¡ç†ï¼‰ï¼Œå®ƒçš„é»˜è®¤ç³»ç»Ÿæ•°æ®åº“æ˜¯ SQLiteã€‚ 3.2.1 å®‰è£… Meltanoä½¿ç”¨ Meltano çš„å·¥ä½œæµæ˜¯å¯åŠ¨ä¸€ä¸ªâ€œmeltano é¡¹ç›®â€å¹¶å¼€å§‹å°† Eã€L å’Œ T æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚ é¡¹ç›®çš„å¯åŠ¨åªéœ€è¦ä¸€ä¸ª CLI å‘½ä»¤è°ƒç”¨ï¼šmeltano init yourprojectnameï¼Œåœ¨é‚£ä¹‹å‰ï¼Œå¯ä»¥å…ˆç”¨ Python çš„åŒ…ç®¡ç†å™¨ï¼špip æˆ–è€… Docker é•œåƒå®‰è£… Meltanoï¼š åœ¨ python è™šæ‹Ÿç¯å¢ƒä¸­ä½¿ç”¨ pip å®‰è£… Meltanoï¼š mkdir .venv # example in a debian flavor Linux distro sudo apt-get install python3-dev python3-pip python3-venv python3-wheel -y python3 -m venv .venv/meltano source .venv/meltano/bin/activate python3 -m pip install wheel python3 -m pip install meltano # init a project mkdir meltano_projects \u0026\u0026 cd meltano_projects # replace with your own one touch .env meltano init æˆ–è€…ç”¨å®¹å™¨å®‰è£… Meltanoï¼š docker pull meltano/meltano:latest docker run --rm meltano/meltano --version # init a project mkdir meltano_projects \u0026\u0026 cd meltano_projects # replace with your own one touch .env docker run --rm -v \"$(pwd)\":/projects \\ -w /projects --env-file .env \\ meltano/meltano init é™¤äº† meltano initï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–å‘½ä»¤ï¼Œä¾‹å¦‚ meltano etl è¡¨ç¤º ETL çš„æ‰§è¡Œï¼Œè¿˜æœ‰ meltano invoke æ¥è°ƒç”¨æ’ä»¶å‘½ä»¤ï¼Œè¯¦ç»†å¯ä»¥å‚è€ƒå®ƒçš„é€ŸæŸ¥è¡¨ï¼ˆhttps://docs.meltano.com/reference/command-line-interfaceï¼‰ã€‚ 3.2.2 Meltano GUI ç•Œé¢Meltano è¿˜å¸¦æœ‰ä¸€ä¸ªåŸºäº Web çš„ UIï¼Œæ‰§è¡Œ ui å­å‘½ä»¤å°±æ˜¯å¯åŠ¨å®ƒï¼š meltano ui é»˜è®¤ä»–ä¼šè·‘åœ¨ http://localhost:5000 ä¸Šã€‚ å¯¹äº Docker è¿è¡Œçš„æƒ…å†µï¼Œåªéœ€è¦åœ¨æš´éœ² 5000 ç«¯å£çš„æƒ…å†µä¸‹è¿è¡Œå®¹å™¨å³å¯ï¼Œç”±äºå®¹å™¨çš„é»˜è®¤å‘½ä»¤å·²ç»æ˜¯ meltano uiï¼Œæ‰€ä»¥ run çš„å‘½ä»¤åªéœ€ï¼š docker run -v \"$(pwd)\":/project \\ -w /project \\ -p 5000:5000 \\ meltano/meltano 3.2.3 Meltano é¡¹ç›®ç¤ºä¾‹å†™åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘æ³¨æ„åˆ° Pat Nadolny åˆ›å»ºäº†å¾ˆå¥½çš„ç¤ºä¾‹é¡¹ç›®åœ¨ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/singer_dbt_jaffleï¼Œå®ƒåˆ©ç”¨ dbt çš„ Meltano ç¤ºä¾‹æ•°æ®é›†ï¼Œé‡‡ç”¨ Airflow ç¼–æ’ ETL ä»»åŠ¡ï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/dbt_orchestrationï¼Œè¿˜æœ‰åˆ©ç”¨ Superset çš„ä¾‹å­ï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/jaffle_supersetï¼‰ã€‚ è¿™é‡Œï¼Œæˆ‘å°±ä¸é‡å¤é€ è½®å­äº†ï¼Œç›´æ¥åˆ©ç”¨ä»–çš„ä¾‹å­å§ã€‚ å’±ä»¬å¯ä»¥å‚ç…§ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/singer_dbt_jaffleï¼Œè¿è¡Œè¿™æ ·çš„æ•°æ®ç®¡é“ï¼ˆpipelineï¼‰ï¼š tap-CSV(Singer)ï¼Œä» CSV æ–‡ä»¶ä¸­æå–æ•°æ® target-postgres(Singer)ï¼Œå°†æ•°æ®åŠ è½½åˆ° Postgres dbtï¼Œå°†æ•°æ®è½¬æ¢ä¸ºèšåˆè¡¨æˆ–è§†å›¾ æ³¨æ„ï¼Œå‰è¾¹æˆ‘ä»¬å·²ç»å¯åŠ¨äº† postgresï¼Œé‚£ä¸€æ­¥å¯ä»¥è·³è¿‡ã€‚ æ“ä½œè¿‡ç¨‹æ˜¯ï¼š git clone https://github.com/pnadolny13/meltano_example_implementations.git cd meltano_example_implementations/meltano_projects/singer_dbt_jaffle/ meltano install touch .env echo PG_PASSWORD=\"lineage_ref\" \u003e\u003e .env echo PG_USERNAME=\"lineage_ref\" \u003e\u003e .env # Extract and Load(with Singer) meltano run tap-csv target-postgres # Trasnform(with dbt) meltano run dbt:run # Generate dbt docs meltano invoke dbt docs generate # Serve generated dbt docs meltano invoke dbt docs to serve # Then visit http://localhost:8080 ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿æ¥åˆ° Postgres æ¥æŸ¥çœ‹ åŠ è½½å’Œè½¬æ¢åçš„æ•°æ®é¢„è§ˆå¦‚ä¸‹ï¼Œæˆªå›¾æ¥è‡ª VS Code çš„ SQLToolï¼š Payments è¡¨é‡Œé•¿è¿™æ ·å­ï¼š ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#å®‰è£…-meltano"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.2 DataOps å·¥å…·é“¾éƒ¨ç½²ç„¶åï¼Œå®‰è£…æœ‰æœºç»“åˆäº† Singler å’Œ dbt çš„ Meltanoã€‚ Meltano å¸®åŠ©æˆ‘ä»¬ç®¡ç† ETL å·¥å…·ï¼ˆä½œä¸ºæ’ä»¶ï¼‰åŠå…¶æ‰€æœ‰é…ç½®å’Œ pipelineã€‚ è¿™äº›å…ƒä¿¡æ¯ä½äº meltano é…ç½®åŠå…¶ç³»ç»Ÿæ•°æ®åº“ï¼ˆhttps://docs.meltano.com/concepts/project#system-databaseï¼‰ä¸­ï¼Œå…¶ä¸­é…ç½®æ˜¯åŸºäºæ–‡ä»¶çš„ï¼ˆå¯ä»¥ä½¿ç”¨ GitOps ç®¡ç†ï¼‰ï¼Œå®ƒçš„é»˜è®¤ç³»ç»Ÿæ•°æ®åº“æ˜¯ SQLiteã€‚ 3.2.1 å®‰è£… Meltanoä½¿ç”¨ Meltano çš„å·¥ä½œæµæ˜¯å¯åŠ¨ä¸€ä¸ªâ€œmeltano é¡¹ç›®â€å¹¶å¼€å§‹å°† Eã€L å’Œ T æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚ é¡¹ç›®çš„å¯åŠ¨åªéœ€è¦ä¸€ä¸ª CLI å‘½ä»¤è°ƒç”¨ï¼šmeltano init yourprojectnameï¼Œåœ¨é‚£ä¹‹å‰ï¼Œå¯ä»¥å…ˆç”¨ Python çš„åŒ…ç®¡ç†å™¨ï¼špip æˆ–è€… Docker é•œåƒå®‰è£… Meltanoï¼š åœ¨ python è™šæ‹Ÿç¯å¢ƒä¸­ä½¿ç”¨ pip å®‰è£… Meltanoï¼š mkdir .venv # example in a debian flavor Linux distro sudo apt-get install python3-dev python3-pip python3-venv python3-wheel -y python3 -m venv .venv/meltano source .venv/meltano/bin/activate python3 -m pip install wheel python3 -m pip install meltano # init a project mkdir meltano_projects \u0026\u0026 cd meltano_projects # replace with your own one touch .env meltano init æˆ–è€…ç”¨å®¹å™¨å®‰è£… Meltanoï¼š docker pull meltano/meltano:latest docker run --rm meltano/meltano --version # init a project mkdir meltano_projects \u0026\u0026 cd meltano_projects # replace with your own one touch .env docker run --rm -v \"$(pwd)\":/projects \\ -w /projects --env-file .env \\ meltano/meltano init é™¤äº† meltano initï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–å‘½ä»¤ï¼Œä¾‹å¦‚ meltano etl è¡¨ç¤º ETL çš„æ‰§è¡Œï¼Œè¿˜æœ‰ meltano invoke æ¥è°ƒç”¨æ’ä»¶å‘½ä»¤ï¼Œè¯¦ç»†å¯ä»¥å‚è€ƒå®ƒçš„é€ŸæŸ¥è¡¨ï¼ˆhttps://docs.meltano.com/reference/command-line-interfaceï¼‰ã€‚ 3.2.2 Meltano GUI ç•Œé¢Meltano è¿˜å¸¦æœ‰ä¸€ä¸ªåŸºäº Web çš„ UIï¼Œæ‰§è¡Œ ui å­å‘½ä»¤å°±æ˜¯å¯åŠ¨å®ƒï¼š meltano ui é»˜è®¤ä»–ä¼šè·‘åœ¨ http://localhost:5000 ä¸Šã€‚ å¯¹äº Docker è¿è¡Œçš„æƒ…å†µï¼Œåªéœ€è¦åœ¨æš´éœ² 5000 ç«¯å£çš„æƒ…å†µä¸‹è¿è¡Œå®¹å™¨å³å¯ï¼Œç”±äºå®¹å™¨çš„é»˜è®¤å‘½ä»¤å·²ç»æ˜¯ meltano uiï¼Œæ‰€ä»¥ run çš„å‘½ä»¤åªéœ€ï¼š docker run -v \"$(pwd)\":/project \\ -w /project \\ -p 5000:5000 \\ meltano/meltano 3.2.3 Meltano é¡¹ç›®ç¤ºä¾‹å†™åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘æ³¨æ„åˆ° Pat Nadolny åˆ›å»ºäº†å¾ˆå¥½çš„ç¤ºä¾‹é¡¹ç›®åœ¨ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/singer_dbt_jaffleï¼Œå®ƒåˆ©ç”¨ dbt çš„ Meltano ç¤ºä¾‹æ•°æ®é›†ï¼Œé‡‡ç”¨ Airflow ç¼–æ’ ETL ä»»åŠ¡ï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/dbt_orchestrationï¼Œè¿˜æœ‰åˆ©ç”¨ Superset çš„ä¾‹å­ï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/jaffle_supersetï¼‰ã€‚ è¿™é‡Œï¼Œæˆ‘å°±ä¸é‡å¤é€ è½®å­äº†ï¼Œç›´æ¥åˆ©ç”¨ä»–çš„ä¾‹å­å§ã€‚ å’±ä»¬å¯ä»¥å‚ç…§ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/singer_dbt_jaffleï¼Œè¿è¡Œè¿™æ ·çš„æ•°æ®ç®¡é“ï¼ˆpipelineï¼‰ï¼š tap-CSV(Singer)ï¼Œä» CSV æ–‡ä»¶ä¸­æå–æ•°æ® target-postgres(Singer)ï¼Œå°†æ•°æ®åŠ è½½åˆ° Postgres dbtï¼Œå°†æ•°æ®è½¬æ¢ä¸ºèšåˆè¡¨æˆ–è§†å›¾ æ³¨æ„ï¼Œå‰è¾¹æˆ‘ä»¬å·²ç»å¯åŠ¨äº† postgresï¼Œé‚£ä¸€æ­¥å¯ä»¥è·³è¿‡ã€‚ æ“ä½œè¿‡ç¨‹æ˜¯ï¼š git clone https://github.com/pnadolny13/meltano_example_implementations.git cd meltano_example_implementations/meltano_projects/singer_dbt_jaffle/ meltano install touch .env echo PG_PASSWORD=\"lineage_ref\" \u003e\u003e .env echo PG_USERNAME=\"lineage_ref\" \u003e\u003e .env # Extract and Load(with Singer) meltano run tap-csv target-postgres # Trasnform(with dbt) meltano run dbt:run # Generate dbt docs meltano invoke dbt docs generate # Serve generated dbt docs meltano invoke dbt docs to serve # Then visit http://localhost:8080 ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿æ¥åˆ° Postgres æ¥æŸ¥çœ‹ åŠ è½½å’Œè½¬æ¢åçš„æ•°æ®é¢„è§ˆå¦‚ä¸‹ï¼Œæˆªå›¾æ¥è‡ª VS Code çš„ SQLToolï¼š Payments è¡¨é‡Œé•¿è¿™æ ·å­ï¼š ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#meltano-gui-ç•Œé¢"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.2 DataOps å·¥å…·é“¾éƒ¨ç½²ç„¶åï¼Œå®‰è£…æœ‰æœºç»“åˆäº† Singler å’Œ dbt çš„ Meltanoã€‚ Meltano å¸®åŠ©æˆ‘ä»¬ç®¡ç† ETL å·¥å…·ï¼ˆä½œä¸ºæ’ä»¶ï¼‰åŠå…¶æ‰€æœ‰é…ç½®å’Œ pipelineã€‚ è¿™äº›å…ƒä¿¡æ¯ä½äº meltano é…ç½®åŠå…¶ç³»ç»Ÿæ•°æ®åº“ï¼ˆhttps://docs.meltano.com/concepts/project#system-databaseï¼‰ä¸­ï¼Œå…¶ä¸­é…ç½®æ˜¯åŸºäºæ–‡ä»¶çš„ï¼ˆå¯ä»¥ä½¿ç”¨ GitOps ç®¡ç†ï¼‰ï¼Œå®ƒçš„é»˜è®¤ç³»ç»Ÿæ•°æ®åº“æ˜¯ SQLiteã€‚ 3.2.1 å®‰è£… Meltanoä½¿ç”¨ Meltano çš„å·¥ä½œæµæ˜¯å¯åŠ¨ä¸€ä¸ªâ€œmeltano é¡¹ç›®â€å¹¶å¼€å§‹å°† Eã€L å’Œ T æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚ é¡¹ç›®çš„å¯åŠ¨åªéœ€è¦ä¸€ä¸ª CLI å‘½ä»¤è°ƒç”¨ï¼šmeltano init yourprojectnameï¼Œåœ¨é‚£ä¹‹å‰ï¼Œå¯ä»¥å…ˆç”¨ Python çš„åŒ…ç®¡ç†å™¨ï¼špip æˆ–è€… Docker é•œåƒå®‰è£… Meltanoï¼š åœ¨ python è™šæ‹Ÿç¯å¢ƒä¸­ä½¿ç”¨ pip å®‰è£… Meltanoï¼š mkdir .venv # example in a debian flavor Linux distro sudo apt-get install python3-dev python3-pip python3-venv python3-wheel -y python3 -m venv .venv/meltano source .venv/meltano/bin/activate python3 -m pip install wheel python3 -m pip install meltano # init a project mkdir meltano_projects \u0026\u0026 cd meltano_projects # replace with your own one touch .env meltano init æˆ–è€…ç”¨å®¹å™¨å®‰è£… Meltanoï¼š docker pull meltano/meltano:latest docker run --rm meltano/meltano --version # init a project mkdir meltano_projects \u0026\u0026 cd meltano_projects # replace with your own one touch .env docker run --rm -v \"$(pwd)\":/projects \\ -w /projects --env-file .env \\ meltano/meltano init é™¤äº† meltano initï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–å‘½ä»¤ï¼Œä¾‹å¦‚ meltano etl è¡¨ç¤º ETL çš„æ‰§è¡Œï¼Œè¿˜æœ‰ meltano invoke æ¥è°ƒç”¨æ’ä»¶å‘½ä»¤ï¼Œè¯¦ç»†å¯ä»¥å‚è€ƒå®ƒçš„é€ŸæŸ¥è¡¨ï¼ˆhttps://docs.meltano.com/reference/command-line-interfaceï¼‰ã€‚ 3.2.2 Meltano GUI ç•Œé¢Meltano è¿˜å¸¦æœ‰ä¸€ä¸ªåŸºäº Web çš„ UIï¼Œæ‰§è¡Œ ui å­å‘½ä»¤å°±æ˜¯å¯åŠ¨å®ƒï¼š meltano ui é»˜è®¤ä»–ä¼šè·‘åœ¨ http://localhost:5000 ä¸Šã€‚ å¯¹äº Docker è¿è¡Œçš„æƒ…å†µï¼Œåªéœ€è¦åœ¨æš´éœ² 5000 ç«¯å£çš„æƒ…å†µä¸‹è¿è¡Œå®¹å™¨å³å¯ï¼Œç”±äºå®¹å™¨çš„é»˜è®¤å‘½ä»¤å·²ç»æ˜¯ meltano uiï¼Œæ‰€ä»¥ run çš„å‘½ä»¤åªéœ€ï¼š docker run -v \"$(pwd)\":/project \\ -w /project \\ -p 5000:5000 \\ meltano/meltano 3.2.3 Meltano é¡¹ç›®ç¤ºä¾‹å†™åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘æ³¨æ„åˆ° Pat Nadolny åˆ›å»ºäº†å¾ˆå¥½çš„ç¤ºä¾‹é¡¹ç›®åœ¨ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/singer_dbt_jaffleï¼Œå®ƒåˆ©ç”¨ dbt çš„ Meltano ç¤ºä¾‹æ•°æ®é›†ï¼Œé‡‡ç”¨ Airflow ç¼–æ’ ETL ä»»åŠ¡ï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/dbt_orchestrationï¼Œè¿˜æœ‰åˆ©ç”¨ Superset çš„ä¾‹å­ï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/jaffle_supersetï¼‰ã€‚ è¿™é‡Œï¼Œæˆ‘å°±ä¸é‡å¤é€ è½®å­äº†ï¼Œç›´æ¥åˆ©ç”¨ä»–çš„ä¾‹å­å§ã€‚ å’±ä»¬å¯ä»¥å‚ç…§ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/singer_dbt_jaffleï¼Œè¿è¡Œè¿™æ ·çš„æ•°æ®ç®¡é“ï¼ˆpipelineï¼‰ï¼š tap-CSV(Singer)ï¼Œä» CSV æ–‡ä»¶ä¸­æå–æ•°æ® target-postgres(Singer)ï¼Œå°†æ•°æ®åŠ è½½åˆ° Postgres dbtï¼Œå°†æ•°æ®è½¬æ¢ä¸ºèšåˆè¡¨æˆ–è§†å›¾ æ³¨æ„ï¼Œå‰è¾¹æˆ‘ä»¬å·²ç»å¯åŠ¨äº† postgresï¼Œé‚£ä¸€æ­¥å¯ä»¥è·³è¿‡ã€‚ æ“ä½œè¿‡ç¨‹æ˜¯ï¼š git clone https://github.com/pnadolny13/meltano_example_implementations.git cd meltano_example_implementations/meltano_projects/singer_dbt_jaffle/ meltano install touch .env echo PG_PASSWORD=\"lineage_ref\" \u003e\u003e .env echo PG_USERNAME=\"lineage_ref\" \u003e\u003e .env # Extract and Load(with Singer) meltano run tap-csv target-postgres # Trasnform(with dbt) meltano run dbt:run # Generate dbt docs meltano invoke dbt docs generate # Serve generated dbt docs meltano invoke dbt docs to serve # Then visit http://localhost:8080 ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿æ¥åˆ° Postgres æ¥æŸ¥çœ‹ åŠ è½½å’Œè½¬æ¢åçš„æ•°æ®é¢„è§ˆå¦‚ä¸‹ï¼Œæˆªå›¾æ¥è‡ª VS Code çš„ SQLToolï¼š Payments è¡¨é‡Œé•¿è¿™æ ·å­ï¼š ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#meltano-é¡¹ç›®ç¤ºä¾‹"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.3 æ­ä¸€ä¸ª BI Dashboard ç³»ç»Ÿç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†æ•°æ®ä»“åº“ä¸­çš„ä¸€äº›æ•°æ®ï¼Œç”¨ ETL å·¥å…·é“¾å°†ä¸åŒçš„æ•°æ®æºå¯¼äº†è¿›å»ï¼Œæ¥ä¸‹æ¥å¯ä»¥è¯•ç€ç”¨ä¸€ä¸‹è¿™äº›æ•°æ®äº†ã€‚ åƒä»ªè¡¨å¤§ç›˜ Dashbaord è¿™æ ·çš„ BI å·¥å…·èƒ½å¸®åŠ©æˆ‘ä»¬ä»æ•°æ®ä¸­è·å¾—æœ‰ç”¨çš„æ´å¯Ÿï¼Œä½¿ç”¨ Apache Supersetï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ›å»ºå’Œç®¡ç†åŸºäºè¿™äº›æ•°æ®æºçš„ Dashboard å’Œå„å¼å„æ ·çš„å›¾è¡¨ã€‚ æœ¬ç« çš„é‡ç‚¹ä¸åœ¨äº Apache Superset æœ¬èº«ï¼Œæ‰€ä»¥ï¼Œå’±ä»¬è¿˜æ˜¯å¤ç”¨ Pat Nadolny åœ¨çš„ä¾‹å­ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/jaffle_supersetã€‚ 3.3.1 Bootstrap Meltano å’Œ Supersetåˆ›å»ºä¸€ä¸ªå®‰è£…äº† Meltano çš„ python venvï¼š mkdir .venv python3 -m venv .venv/meltano source .venv/meltano/bin/activate python3 -m pip install wheel python3 -m pip install meltano å‚è€ƒ Pat çš„ Guideï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/jaffle_supersetï¼‰ï¼Œç¨å¾®åšä¸€äº›ä¿®æ”¹ï¼š å…‹éš† repoï¼Œè¿›å…¥ jaffle_superset é¡¹ç›® git clone https://github.com/pnadolny13/meltano_example_implementations.git cd meltano_example_implementations/meltano_projects/jaffle_superset/ ä¿®æ”¹meltanoé…ç½®æ–‡ä»¶ï¼Œè®© Superset è¿æ¥åˆ°æˆ‘ä»¬åˆ›å»ºçš„ Postgresï¼š vim meltano_projects/jaffle_superset/meltano.yml è¿™é‡Œï¼Œæˆ‘å°†ä¸»æœºåæ›´æ”¹ä¸ºâ€œ10.1.1.111â€ï¼Œè¿™æ˜¯æˆ‘å½“å‰ä¸»æœºçš„ IPï¼Œè€Œå¦‚æœè¯»è€…åœ¨ Windows æˆ–è€… macOS æœºå™¨çš„ Docker Desktop ä¸Šè·‘çš„è¯ï¼Œè¿™é‡Œä¸è¦ä¿®æ”¹ï¼Œå¦åˆ™è¦å‚è€ƒæˆ‘å»æ”¹æˆè‡ªå·±å®é™…çš„åœ°å€ï¼š --- a/meltano_projects/jaffle_superset/meltano.yml +++ b/meltano_projects/jaffle_superset/meltano.yml @@ -71,7 +71,7 @@ plugins: A list of database driver dependencies can be found here https://superset.apache.org/docs/databases/installing-database-drivers config: database_name: my_postgres - sqlalchemy_uri: postgresql+psycopg2://${PG_USERNAME}:${PG_PASSWORD}@host.docker.internal:${PG_PORT}/${PG_DATABASE} + sqlalchemy_uri: postgresql+psycopg2://${PG_USERNAME}:${PG_PASSWORD}@10.1.1.168:${PG_PORT}/${PG_DATABASE} tables: - model.my_meltano_project.customers - model.my_meltano_project.orders æ·»åŠ  Postgres ç™»å½•çš„ä¿¡æ¯åˆ° .env æ–‡ä»¶ï¼š echo PG_USERNAME=lineage_ref \u003e\u003e .env echo PG_PASSWORD=lineage_ref \u003e\u003e .env å®‰è£… Meltano é¡¹ç›®ï¼Œè¿è¡Œ ETL ä»»åŠ¡ meltano install meltano run tap-csv target-postgres dbt:run è°ƒç”¨ã€å¯åŠ¨ supersetï¼Œè¿™é‡Œæ³¨æ„ ui ä¸æ˜¯ meltano çš„å†…éƒ¨å‘½ä»¤ï¼Œè€Œæ˜¯ä¸€ä¸ªé…ç½®è¿›å»çš„è‡ªå®šä¹‰è¡Œä¸ºï¼ˆuser-defined actionï¼‰ meltano invoke superset:ui åœ¨å¦ä¸€ä¸ªå‘½ä»¤è¡Œç»ˆç«¯ï¼Œæ‰§è¡Œå¦ä¸€ä¸ªè‡ªå®šä¹‰çš„å‘½ä»¤ load_datasources meltano invoke superset:load_datasources é€šè¿‡æµè§ˆå™¨è®¿é—® http://localhost:8088/ å°±æ˜¯Superset çš„å›¾å½¢ç•Œé¢äº†ï¼š 3.3.2 åˆ›å»ºä¸€ä¸ª Dashboardè¯•ä¸€ä¸‹åœ¨è¿™ä¸ª Meltano é¡¹ç›®ä¸­å®šä¹‰çš„ Postgres ä¸­çš„ ETL æ•°æ®ä¸Šåˆ›å»ºä¸€ä¸ª Dashboard å§ ç‚¹å‡» + DASHBOARDï¼Œå¡«å†™ä»ªè¡¨ç›˜åç§°ï¼Œç„¶åç‚¹å‡» SAVEï¼Œç„¶åç‚¹å‡» + CREATE A NEW CHART åœ¨æ–°å›¾è¡¨ï¼ˆCreate a new chartï¼‰è§†å›¾ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©å›¾è¡¨ç±»å‹å’Œæ•°æ®é›†ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘é€‰æ‹©äº† orders è¡¨ä½œä¸ºæ•°æ®æºå’Œ Pie Chart å›¾è¡¨ç±»å‹ï¼š ç‚¹å‡»â€œCREATE NEW CHARTâ€åï¼Œæˆ‘ä»¬åœ¨å›¾è¡¨å®šä¹‰è§†å›¾ä¸­ï¼Œæˆ‘é€‰æ‹©äº†â€œstatusâ€çš„â€œQueryâ€ä¸ºâ€œDIMENSIONSâ€ï¼Œâ€œCOUNT(amount)â€ä¸ºâ€œMETRICâ€ã€‚ è‡³æ­¤ï¼Œå’±ä»¬å°±å¯ä»¥çœ‹åˆ°æ¯ä¸ªè®¢å•çŠ¶æ€åˆ†å¸ƒçš„é¥¼å›¾äº†ã€‚ ç‚¹å‡» SAVE ï¼Œå®ƒä¼šè¯¢é—®åº”è¯¥å°†æ­¤å›¾è¡¨æ·»åŠ åˆ°å“ªä¸ª Dashboardï¼Œé€‰æ‹©åï¼Œå•å‡» SAVE \u0026 GO TO DASHBOARDã€‚ ç„¶åï¼Œåœ¨ Dashboard ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‚£é‡Œçš„æ‰€æœ‰å›¾è¡¨ã€‚ æ‚¨å¯ä»¥çœ‹åˆ°æˆ‘è¿˜æ·»åŠ äº†å¦ä¸€ä¸ªå›¾è¡¨æ¥æ˜¾ç¤ºå®¢æˆ·è®¢å•æ•°é‡åˆ†å¸ƒï¼š ç‚¹ Â·Â·Â· çš„è¯ï¼Œè¿˜èƒ½çœ‹åˆ°åˆ·æ–°ç‡è®¾ç½®ã€ä¸‹è½½æ¸²æŸ“å›¾ç­‰å…¶ä»–çš„åŠŸèƒ½ã€‚ ç›®å‰ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•ä½†å…¸å‹çš„ homelab æ•°æ®æŠ€æœ¯æ ˆäº†ï¼Œå¹¶ä¸”æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯å¼€æºçš„ï¼ æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨ CSV ä¸­æœ‰ 100 ä¸ªæ•°æ®é›†ï¼Œåœ¨æ•°æ®ä»“åº“ä¸­æœ‰ 200 ä¸ªè¡¨ï¼Œå¹¶ä¸”æœ‰å‡ ä¸ªæ•°æ®å·¥ç¨‹å¸ˆåœ¨è¿è¡Œä¸åŒçš„é¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®ä½¿ç”¨ã€ç”Ÿæˆä¸åŒçš„åº”ç”¨ä¸æœåŠ¡ã€Dashbaord å’Œæ•°æ®åº“ã€‚ å½“æœ‰äººæƒ³è¦æŸ¥æ‰¾ã€å‘ç°æˆ–è€…ä¿®æ”¹å…¶ä¸­çš„ä¸€äº›è¡¨ã€æ•°æ®é›†ã€Dashbaord å’Œç®¡é“ï¼Œåœ¨æ²Ÿé€šå’Œå·¥ç¨‹æ–¹é¢å¯èƒ½éƒ½æ˜¯éå¸¸ä¸å¥½ç®¡ç†çš„ã€‚ å¦‚å‰è¾¹æåˆ°çš„ï¼Œæˆ‘ä»¬éœ€è¦è¿™ä¸ªç¤ºä¾‹é¡¹ç›®çš„ä¸»è¦éƒ¨åˆ†ï¼šå…ƒæ•°æ®å‘ç°ç³»ç»Ÿã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:3","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æ­ä¸€ä¸ª-bi-dashboard-ç³»ç»Ÿ"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.3 æ­ä¸€ä¸ª BI Dashboard ç³»ç»Ÿç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†æ•°æ®ä»“åº“ä¸­çš„ä¸€äº›æ•°æ®ï¼Œç”¨ ETL å·¥å…·é“¾å°†ä¸åŒçš„æ•°æ®æºå¯¼äº†è¿›å»ï¼Œæ¥ä¸‹æ¥å¯ä»¥è¯•ç€ç”¨ä¸€ä¸‹è¿™äº›æ•°æ®äº†ã€‚ åƒä»ªè¡¨å¤§ç›˜ Dashbaord è¿™æ ·çš„ BI å·¥å…·èƒ½å¸®åŠ©æˆ‘ä»¬ä»æ•°æ®ä¸­è·å¾—æœ‰ç”¨çš„æ´å¯Ÿï¼Œä½¿ç”¨ Apache Supersetï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ›å»ºå’Œç®¡ç†åŸºäºè¿™äº›æ•°æ®æºçš„ Dashboard å’Œå„å¼å„æ ·çš„å›¾è¡¨ã€‚ æœ¬ç« çš„é‡ç‚¹ä¸åœ¨äº Apache Superset æœ¬èº«ï¼Œæ‰€ä»¥ï¼Œå’±ä»¬è¿˜æ˜¯å¤ç”¨ Pat Nadolny åœ¨çš„ä¾‹å­ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/jaffle_supersetã€‚ 3.3.1 Bootstrap Meltano å’Œ Supersetåˆ›å»ºä¸€ä¸ªå®‰è£…äº† Meltano çš„ python venvï¼š mkdir .venv python3 -m venv .venv/meltano source .venv/meltano/bin/activate python3 -m pip install wheel python3 -m pip install meltano å‚è€ƒ Pat çš„ Guideï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/jaffle_supersetï¼‰ï¼Œç¨å¾®åšä¸€äº›ä¿®æ”¹ï¼š å…‹éš† repoï¼Œè¿›å…¥ jaffle_superset é¡¹ç›® git clone https://github.com/pnadolny13/meltano_example_implementations.git cd meltano_example_implementations/meltano_projects/jaffle_superset/ ä¿®æ”¹meltanoé…ç½®æ–‡ä»¶ï¼Œè®© Superset è¿æ¥åˆ°æˆ‘ä»¬åˆ›å»ºçš„ Postgresï¼š vim meltano_projects/jaffle_superset/meltano.yml è¿™é‡Œï¼Œæˆ‘å°†ä¸»æœºåæ›´æ”¹ä¸ºâ€œ10.1.1.111â€ï¼Œè¿™æ˜¯æˆ‘å½“å‰ä¸»æœºçš„ IPï¼Œè€Œå¦‚æœè¯»è€…åœ¨ Windows æˆ–è€… macOS æœºå™¨çš„ Docker Desktop ä¸Šè·‘çš„è¯ï¼Œè¿™é‡Œä¸è¦ä¿®æ”¹ï¼Œå¦åˆ™è¦å‚è€ƒæˆ‘å»æ”¹æˆè‡ªå·±å®é™…çš„åœ°å€ï¼š --- a/meltano_projects/jaffle_superset/meltano.yml +++ b/meltano_projects/jaffle_superset/meltano.yml @@ -71,7 +71,7 @@ plugins: A list of database driver dependencies can be found here https://superset.apache.org/docs/databases/installing-database-drivers config: database_name: my_postgres - sqlalchemy_uri: postgresql+psycopg2://${PG_USERNAME}:${PG_PASSWORD}@host.docker.internal:${PG_PORT}/${PG_DATABASE} + sqlalchemy_uri: postgresql+psycopg2://${PG_USERNAME}:${PG_PASSWORD}@10.1.1.168:${PG_PORT}/${PG_DATABASE} tables: - model.my_meltano_project.customers - model.my_meltano_project.orders æ·»åŠ  Postgres ç™»å½•çš„ä¿¡æ¯åˆ° .env æ–‡ä»¶ï¼š echo PG_USERNAME=lineage_ref \u003e\u003e .env echo PG_PASSWORD=lineage_ref \u003e\u003e .env å®‰è£… Meltano é¡¹ç›®ï¼Œè¿è¡Œ ETL ä»»åŠ¡ meltano install meltano run tap-csv target-postgres dbt:run è°ƒç”¨ã€å¯åŠ¨ supersetï¼Œè¿™é‡Œæ³¨æ„ ui ä¸æ˜¯ meltano çš„å†…éƒ¨å‘½ä»¤ï¼Œè€Œæ˜¯ä¸€ä¸ªé…ç½®è¿›å»çš„è‡ªå®šä¹‰è¡Œä¸ºï¼ˆuser-defined actionï¼‰ meltano invoke superset:ui åœ¨å¦ä¸€ä¸ªå‘½ä»¤è¡Œç»ˆç«¯ï¼Œæ‰§è¡Œå¦ä¸€ä¸ªè‡ªå®šä¹‰çš„å‘½ä»¤ load_datasources meltano invoke superset:load_datasources é€šè¿‡æµè§ˆå™¨è®¿é—® http://localhost:8088/ å°±æ˜¯Superset çš„å›¾å½¢ç•Œé¢äº†ï¼š 3.3.2 åˆ›å»ºä¸€ä¸ª Dashboardè¯•ä¸€ä¸‹åœ¨è¿™ä¸ª Meltano é¡¹ç›®ä¸­å®šä¹‰çš„ Postgres ä¸­çš„ ETL æ•°æ®ä¸Šåˆ›å»ºä¸€ä¸ª Dashboard å§ ç‚¹å‡» + DASHBOARDï¼Œå¡«å†™ä»ªè¡¨ç›˜åç§°ï¼Œç„¶åç‚¹å‡» SAVEï¼Œç„¶åç‚¹å‡» + CREATE A NEW CHART åœ¨æ–°å›¾è¡¨ï¼ˆCreate a new chartï¼‰è§†å›¾ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©å›¾è¡¨ç±»å‹å’Œæ•°æ®é›†ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘é€‰æ‹©äº† orders è¡¨ä½œä¸ºæ•°æ®æºå’Œ Pie Chart å›¾è¡¨ç±»å‹ï¼š ç‚¹å‡»â€œCREATE NEW CHARTâ€åï¼Œæˆ‘ä»¬åœ¨å›¾è¡¨å®šä¹‰è§†å›¾ä¸­ï¼Œæˆ‘é€‰æ‹©äº†â€œstatusâ€çš„â€œQueryâ€ä¸ºâ€œDIMENSIONSâ€ï¼Œâ€œCOUNT(amount)â€ä¸ºâ€œMETRICâ€ã€‚ è‡³æ­¤ï¼Œå’±ä»¬å°±å¯ä»¥çœ‹åˆ°æ¯ä¸ªè®¢å•çŠ¶æ€åˆ†å¸ƒçš„é¥¼å›¾äº†ã€‚ ç‚¹å‡» SAVE ï¼Œå®ƒä¼šè¯¢é—®åº”è¯¥å°†æ­¤å›¾è¡¨æ·»åŠ åˆ°å“ªä¸ª Dashboardï¼Œé€‰æ‹©åï¼Œå•å‡» SAVE \u0026 GO TO DASHBOARDã€‚ ç„¶åï¼Œåœ¨ Dashboard ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‚£é‡Œçš„æ‰€æœ‰å›¾è¡¨ã€‚ æ‚¨å¯ä»¥çœ‹åˆ°æˆ‘è¿˜æ·»åŠ äº†å¦ä¸€ä¸ªå›¾è¡¨æ¥æ˜¾ç¤ºå®¢æˆ·è®¢å•æ•°é‡åˆ†å¸ƒï¼š ç‚¹ Â·Â·Â· çš„è¯ï¼Œè¿˜èƒ½çœ‹åˆ°åˆ·æ–°ç‡è®¾ç½®ã€ä¸‹è½½æ¸²æŸ“å›¾ç­‰å…¶ä»–çš„åŠŸèƒ½ã€‚ ç›®å‰ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•ä½†å…¸å‹çš„ homelab æ•°æ®æŠ€æœ¯æ ˆäº†ï¼Œå¹¶ä¸”æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯å¼€æºçš„ï¼ æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨ CSV ä¸­æœ‰ 100 ä¸ªæ•°æ®é›†ï¼Œåœ¨æ•°æ®ä»“åº“ä¸­æœ‰ 200 ä¸ªè¡¨ï¼Œå¹¶ä¸”æœ‰å‡ ä¸ªæ•°æ®å·¥ç¨‹å¸ˆåœ¨è¿è¡Œä¸åŒçš„é¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®ä½¿ç”¨ã€ç”Ÿæˆä¸åŒçš„åº”ç”¨ä¸æœåŠ¡ã€Dashbaord å’Œæ•°æ®åº“ã€‚ å½“æœ‰äººæƒ³è¦æŸ¥æ‰¾ã€å‘ç°æˆ–è€…ä¿®æ”¹å…¶ä¸­çš„ä¸€äº›è¡¨ã€æ•°æ®é›†ã€Dashbaord å’Œç®¡é“ï¼Œåœ¨æ²Ÿé€šå’Œå·¥ç¨‹æ–¹é¢å¯èƒ½éƒ½æ˜¯éå¸¸ä¸å¥½ç®¡ç†çš„ã€‚ å¦‚å‰è¾¹æåˆ°çš„ï¼Œæˆ‘ä»¬éœ€è¦è¿™ä¸ªç¤ºä¾‹é¡¹ç›®çš„ä¸»è¦éƒ¨åˆ†ï¼šå…ƒæ•°æ®å‘ç°ç³»ç»Ÿã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:3","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#bootstrap-meltano-å’Œ-superset"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.3 æ­ä¸€ä¸ª BI Dashboard ç³»ç»Ÿç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†æ•°æ®ä»“åº“ä¸­çš„ä¸€äº›æ•°æ®ï¼Œç”¨ ETL å·¥å…·é“¾å°†ä¸åŒçš„æ•°æ®æºå¯¼äº†è¿›å»ï¼Œæ¥ä¸‹æ¥å¯ä»¥è¯•ç€ç”¨ä¸€ä¸‹è¿™äº›æ•°æ®äº†ã€‚ åƒä»ªè¡¨å¤§ç›˜ Dashbaord è¿™æ ·çš„ BI å·¥å…·èƒ½å¸®åŠ©æˆ‘ä»¬ä»æ•°æ®ä¸­è·å¾—æœ‰ç”¨çš„æ´å¯Ÿï¼Œä½¿ç”¨ Apache Supersetï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ›å»ºå’Œç®¡ç†åŸºäºè¿™äº›æ•°æ®æºçš„ Dashboard å’Œå„å¼å„æ ·çš„å›¾è¡¨ã€‚ æœ¬ç« çš„é‡ç‚¹ä¸åœ¨äº Apache Superset æœ¬èº«ï¼Œæ‰€ä»¥ï¼Œå’±ä»¬è¿˜æ˜¯å¤ç”¨ Pat Nadolny åœ¨çš„ä¾‹å­ https://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/jaffle_supersetã€‚ 3.3.1 Bootstrap Meltano å’Œ Supersetåˆ›å»ºä¸€ä¸ªå®‰è£…äº† Meltano çš„ python venvï¼š mkdir .venv python3 -m venv .venv/meltano source .venv/meltano/bin/activate python3 -m pip install wheel python3 -m pip install meltano å‚è€ƒ Pat çš„ Guideï¼ˆhttps://github.com/pnadolny13/meltano_example_implementations/tree/main/meltano_projects/jaffle_supersetï¼‰ï¼Œç¨å¾®åšä¸€äº›ä¿®æ”¹ï¼š å…‹éš† repoï¼Œè¿›å…¥ jaffle_superset é¡¹ç›® git clone https://github.com/pnadolny13/meltano_example_implementations.git cd meltano_example_implementations/meltano_projects/jaffle_superset/ ä¿®æ”¹meltanoé…ç½®æ–‡ä»¶ï¼Œè®© Superset è¿æ¥åˆ°æˆ‘ä»¬åˆ›å»ºçš„ Postgresï¼š vim meltano_projects/jaffle_superset/meltano.yml è¿™é‡Œï¼Œæˆ‘å°†ä¸»æœºåæ›´æ”¹ä¸ºâ€œ10.1.1.111â€ï¼Œè¿™æ˜¯æˆ‘å½“å‰ä¸»æœºçš„ IPï¼Œè€Œå¦‚æœè¯»è€…åœ¨ Windows æˆ–è€… macOS æœºå™¨çš„ Docker Desktop ä¸Šè·‘çš„è¯ï¼Œè¿™é‡Œä¸è¦ä¿®æ”¹ï¼Œå¦åˆ™è¦å‚è€ƒæˆ‘å»æ”¹æˆè‡ªå·±å®é™…çš„åœ°å€ï¼š --- a/meltano_projects/jaffle_superset/meltano.yml +++ b/meltano_projects/jaffle_superset/meltano.yml @@ -71,7 +71,7 @@ plugins: A list of database driver dependencies can be found here https://superset.apache.org/docs/databases/installing-database-drivers config: database_name: my_postgres - sqlalchemy_uri: postgresql+psycopg2://${PG_USERNAME}:${PG_PASSWORD}@host.docker.internal:${PG_PORT}/${PG_DATABASE} + sqlalchemy_uri: postgresql+psycopg2://${PG_USERNAME}:${PG_PASSWORD}@10.1.1.168:${PG_PORT}/${PG_DATABASE} tables: - model.my_meltano_project.customers - model.my_meltano_project.orders æ·»åŠ  Postgres ç™»å½•çš„ä¿¡æ¯åˆ° .env æ–‡ä»¶ï¼š echo PG_USERNAME=lineage_ref \u003e\u003e .env echo PG_PASSWORD=lineage_ref \u003e\u003e .env å®‰è£… Meltano é¡¹ç›®ï¼Œè¿è¡Œ ETL ä»»åŠ¡ meltano install meltano run tap-csv target-postgres dbt:run è°ƒç”¨ã€å¯åŠ¨ supersetï¼Œè¿™é‡Œæ³¨æ„ ui ä¸æ˜¯ meltano çš„å†…éƒ¨å‘½ä»¤ï¼Œè€Œæ˜¯ä¸€ä¸ªé…ç½®è¿›å»çš„è‡ªå®šä¹‰è¡Œä¸ºï¼ˆuser-defined actionï¼‰ meltano invoke superset:ui åœ¨å¦ä¸€ä¸ªå‘½ä»¤è¡Œç»ˆç«¯ï¼Œæ‰§è¡Œå¦ä¸€ä¸ªè‡ªå®šä¹‰çš„å‘½ä»¤ load_datasources meltano invoke superset:load_datasources é€šè¿‡æµè§ˆå™¨è®¿é—® http://localhost:8088/ å°±æ˜¯Superset çš„å›¾å½¢ç•Œé¢äº†ï¼š 3.3.2 åˆ›å»ºä¸€ä¸ª Dashboardè¯•ä¸€ä¸‹åœ¨è¿™ä¸ª Meltano é¡¹ç›®ä¸­å®šä¹‰çš„ Postgres ä¸­çš„ ETL æ•°æ®ä¸Šåˆ›å»ºä¸€ä¸ª Dashboard å§ ç‚¹å‡» + DASHBOARDï¼Œå¡«å†™ä»ªè¡¨ç›˜åç§°ï¼Œç„¶åç‚¹å‡» SAVEï¼Œç„¶åç‚¹å‡» + CREATE A NEW CHART åœ¨æ–°å›¾è¡¨ï¼ˆCreate a new chartï¼‰è§†å›¾ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©å›¾è¡¨ç±»å‹å’Œæ•°æ®é›†ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘é€‰æ‹©äº† orders è¡¨ä½œä¸ºæ•°æ®æºå’Œ Pie Chart å›¾è¡¨ç±»å‹ï¼š ç‚¹å‡»â€œCREATE NEW CHARTâ€åï¼Œæˆ‘ä»¬åœ¨å›¾è¡¨å®šä¹‰è§†å›¾ä¸­ï¼Œæˆ‘é€‰æ‹©äº†â€œstatusâ€çš„â€œQueryâ€ä¸ºâ€œDIMENSIONSâ€ï¼Œâ€œCOUNT(amount)â€ä¸ºâ€œMETRICâ€ã€‚ è‡³æ­¤ï¼Œå’±ä»¬å°±å¯ä»¥çœ‹åˆ°æ¯ä¸ªè®¢å•çŠ¶æ€åˆ†å¸ƒçš„é¥¼å›¾äº†ã€‚ ç‚¹å‡» SAVE ï¼Œå®ƒä¼šè¯¢é—®åº”è¯¥å°†æ­¤å›¾è¡¨æ·»åŠ åˆ°å“ªä¸ª Dashboardï¼Œé€‰æ‹©åï¼Œå•å‡» SAVE \u0026 GO TO DASHBOARDã€‚ ç„¶åï¼Œåœ¨ Dashboard ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‚£é‡Œçš„æ‰€æœ‰å›¾è¡¨ã€‚ æ‚¨å¯ä»¥çœ‹åˆ°æˆ‘è¿˜æ·»åŠ äº†å¦ä¸€ä¸ªå›¾è¡¨æ¥æ˜¾ç¤ºå®¢æˆ·è®¢å•æ•°é‡åˆ†å¸ƒï¼š ç‚¹ Â·Â·Â· çš„è¯ï¼Œè¿˜èƒ½çœ‹åˆ°åˆ·æ–°ç‡è®¾ç½®ã€ä¸‹è½½æ¸²æŸ“å›¾ç­‰å…¶ä»–çš„åŠŸèƒ½ã€‚ ç›®å‰ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•ä½†å…¸å‹çš„ homelab æ•°æ®æŠ€æœ¯æ ˆäº†ï¼Œå¹¶ä¸”æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯å¼€æºçš„ï¼ æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨ CSV ä¸­æœ‰ 100 ä¸ªæ•°æ®é›†ï¼Œåœ¨æ•°æ®ä»“åº“ä¸­æœ‰ 200 ä¸ªè¡¨ï¼Œå¹¶ä¸”æœ‰å‡ ä¸ªæ•°æ®å·¥ç¨‹å¸ˆåœ¨è¿è¡Œä¸åŒçš„é¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®ä½¿ç”¨ã€ç”Ÿæˆä¸åŒçš„åº”ç”¨ä¸æœåŠ¡ã€Dashbaord å’Œæ•°æ®åº“ã€‚ å½“æœ‰äººæƒ³è¦æŸ¥æ‰¾ã€å‘ç°æˆ–è€…ä¿®æ”¹å…¶ä¸­çš„ä¸€äº›è¡¨ã€æ•°æ®é›†ã€Dashbaord å’Œç®¡é“ï¼Œåœ¨æ²Ÿé€šå’Œå·¥ç¨‹æ–¹é¢å¯èƒ½éƒ½æ˜¯éå¸¸ä¸å¥½ç®¡ç†çš„ã€‚ å¦‚å‰è¾¹æåˆ°çš„ï¼Œæˆ‘ä»¬éœ€è¦è¿™ä¸ªç¤ºä¾‹é¡¹ç›®çš„ä¸»è¦éƒ¨åˆ†ï¼šå…ƒæ•°æ®å‘ç°ç³»ç»Ÿã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:3","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#åˆ›å»ºä¸€ä¸ª-dashboard"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.4 å…ƒæ•°æ®å‘ç°ç³»ç»Ÿç„¶åï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªå¸¦æœ‰ NebulaGraph å’Œ Elasticsearch çš„ Amundsenã€‚ æ³¨ï¼šç›®å‰ã€NebulaGraph ä½œä¸º Amundsen åç«¯çš„ PRã€‘ï¼ˆhttps://github.com/amundsen-io/amundsen/pull/1817ï¼‰å°šæœªåˆå¹¶ï¼Œæˆ‘è¿˜åœ¨ä¸ Amundsen å›¢é˜Ÿåˆä½œï¼ˆhttps://github.com/amundsen-io/rfcs/pull/48ï¼‰æ¥å®ç°å®ƒã€‚ æœ‰äº† Amundsenï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªåœ°æ–¹å‘ç°å’Œç®¡ç†æ•´ä¸ªæ•°æ®æ ˆä¸­çš„æ‰€æœ‰å…ƒæ•°æ®ã€‚ Amundsen ä¸»è¦æœ‰ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š å…ƒæ•°æ®å¯¼å…¥ Metadata Ingestion Amundsen Data builder å…ƒæ•°æ®ç›®å½•æœåŠ¡ Metadata Catalog Amundsen Frontend service Amundsen Metadata service Amundsen Search service å®ƒçš„å·¥ä½œåŸç†æ˜¯ï¼šåˆ©ç”¨ Data builder ä»ä¸åŒæ¥æºæå–å…ƒæ•°æ®ï¼Œå¹¶å°†å…ƒæ•°æ®æŒä¹…åŒ–åˆ° Meta service çš„åç«¯å­˜å‚¨å’Œ Search service çš„åç«¯å­˜å‚¨ä¸­ï¼Œç”¨æˆ·ä» Froent service æˆ–é€šè¿‡ Meta Service çš„APIã€‚ 3.4.1 éƒ¨ç½² Amundsen 3.4.1.1 å…ƒæ•°æ®æœåŠ¡ Metadata serviceæˆ‘ä»¬ç”¨ docker-compose æ–‡ä»¶éƒ¨ç½²ä¸€ä¸ª Amundsen é›†ç¾¤ã€‚ ç”±äº NebulaGraph åç«¯æ”¯æŒå°šæœªåˆå¹¶ï¼Œè¿˜ä¸èƒ½ç”¨å®˜æ–¹çš„ä»£ç ï¼Œå…ˆç”¨æˆ‘è‡ªå·±çš„åˆ†å‰ç‰ˆæœ¬ã€‚ é¦–å…ˆï¼Œè®©æˆ‘ä»¬å…‹éš†åŒ…å«æ‰€æœ‰å­æ¨¡å—çš„ repoï¼š git clone -b amundsen_nebula_graph --recursive git@github.com:wey-gu/amundsen.git cd amundsen ç„¶åï¼Œå¯åŠ¨æ‰€æœ‰ç›®å½•æœåŠ¡ï¼ˆcatalog servicesï¼‰åŠå…¶åç«¯å­˜å‚¨ï¼š docker-compose -f docker-amundsen-nebula.yml up æ³¨ï¼šå¯ä»¥æ·»åŠ  -d æ¥è®©å®¹å™¨åœ¨åå°è¿è¡Œï¼š docker-compose -f docker-amundsen-nebula.yml up -d å…³é—­åå°è¿è¡Œçš„é›†ç¾¤ docker-compose -f docker-amundsen-nebula.yml stop åˆ é™¤åå°è¿è¡Œçš„é›†ç¾¤ docker-compose -f docker-amundsen-nebula.yml down ç”±äºè¿™ä¸ª docker-compose æ–‡ä»¶æ˜¯ä¾›å¼€å‘äººå‘˜è¯•ç©ã€è°ƒè¯• Amundsen ç”¨çš„ï¼Œè€Œä¸æ˜¯ç»™ç”Ÿäº§éƒ¨ç½²å‡†å¤‡çš„ï¼Œå®ƒåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šä»ä»£ç åº“æ„å»ºé•œåƒï¼Œç¬¬ä¸€æ¬¡è·‘çš„æ—¶å€™å¯åŠ¨ä¼šæ…¢ä¸€äº›ã€‚ éƒ¨ç½²å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ Data builder å°†ä¸€äº›ç¤ºä¾‹ã€è™šæ„çš„æ•°æ®åŠ è½½å­˜å‚¨é‡Œã€‚ 3.4.1.2 æŠ“å–å…ƒæ•°æ® Data builderAmundsen Data builder å°±åƒ Meltano ç³»ç»Ÿä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯ç”¨åœ¨å…ƒæ•°æ®çš„ä¸Šçš„ ETL ï¼Œå®ƒæŠŠå…ƒæ•°æ®åŠ è½½åˆ°â€œMeta serviceâ€å’Œâ€œSearch serviceâ€çš„åç«¯å­˜å‚¨ï¼šNebulaGraph å’Œ Elasticsearch é‡Œã€‚ è¿™é‡Œçš„ Data builder åªæ˜¯ä¸€ä¸ª python æ¨¡å—ï¼Œæ‰€æœ‰çš„å…ƒæ•°æ® ETL ä½œä¸šå¯ä»¥ä½œä¸ºè„šæœ¬è¿è¡Œï¼Œä¹Ÿå¯ä»¥ç”¨ Apache Airflow ç­‰ DAG å¹³å°è¿›è¡Œç¼–æ’ã€‚ å®‰è£… Amundsen Data builderï¼š cd databuilder python3 -m venv .venv source .venv/bin/activate python3 -m pip install wheel python3 -m pip install -r requirements.txt python3 setup.py install è°ƒç”¨è¿™ä¸ªç¤ºä¾‹æ•°æ®æ„å»ºå™¨ ETL è„šæœ¬æ¥æŠŠç¤ºä¾‹çš„è™šæ‹Ÿæ•°æ®å¯¼è¿›å»ã€‚ python3 example/scripts/sample_data_loader_nebula.py 3.4.1.3 éªŒè¯ä¸€ä¸‹ Amundsenåœ¨è®¿é—® Amundsen ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨æˆ·ï¼š # run a container with curl attached to amundsenfrontend docker run -it --rm --net container:amundsenfrontend nicolaka/netshoot # Create a user with id test_user_id curl -X PUT -v http://amundsenmetadata:5002/user \\ -H \"Content-Type: application/json\" \\ --data \\ '{\"user_id\":\"test_user_id\",\"first_name\":\"test\",\"last_name\":\"user\", \"email\":\"test_user_id@mail.com\"}' exit ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨ http://localhost:5000 æŸ¥çœ‹ UI å¹¶å°è¯•æœç´¢ testï¼Œå®ƒåº”è¯¥ä¼šè¿”å›ä¸€äº›ç»“æœã€‚ ç„¶åï¼Œå¯ä»¥å•å‡»å¹¶æµè§ˆåœ¨â€œsample_data_loader_nebula.pyâ€æœŸé—´åŠ è½½åˆ° Amundsen çš„é‚£äº›ç¤ºä¾‹å…ƒæ•°æ®ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ NebulaStudio(http://localhost:7001) è®¿é—® NebulaGraph é‡Œçš„è¿™äº›æ•°æ®ã€‚ æ³¨æ„åœ¨ Nebula Studio ä¸­ï¼Œé»˜è®¤ç™»å½•å­—æ®µä¸ºï¼š ä¸»æœºï¼šgraphd:9669 ç”¨æˆ·ï¼šroot å¯†ç ï¼šnebula ä¸‹å›¾æ˜¾ç¤ºäº†æœ‰å…³ Amundsen ç»„ä»¶çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Frontend:5000 â”‚ â”‚ Metadata Sources â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ Metaservice:5001 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Foo DB â”‚ â”‚ Bar App â”‚ â”‚ X Dashboard â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”¤ Nebula Proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”¼â”€â”€â”€â”€â”¤ Search searvice:5002 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Databuilder â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”¼â”€â–º Extractor of Sources â”œâ”€â–º nebula_search_data_extractor â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Loader filesystem_csv_nebula â”‚ â”‚ Loader Elastic FS loader â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Publisher nebula_csv_publisher â”‚ â”‚ Publisher Elasticsearch â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â–ºâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Nebula Gra","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:4","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#å…ƒæ•°æ®å‘ç°ç³»ç»Ÿ"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.4 å…ƒæ•°æ®å‘ç°ç³»ç»Ÿç„¶åï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªå¸¦æœ‰ NebulaGraph å’Œ Elasticsearch çš„ Amundsenã€‚ æ³¨ï¼šç›®å‰ã€NebulaGraph ä½œä¸º Amundsen åç«¯çš„ PRã€‘ï¼ˆhttps://github.com/amundsen-io/amundsen/pull/1817ï¼‰å°šæœªåˆå¹¶ï¼Œæˆ‘è¿˜åœ¨ä¸ Amundsen å›¢é˜Ÿåˆä½œï¼ˆhttps://github.com/amundsen-io/rfcs/pull/48ï¼‰æ¥å®ç°å®ƒã€‚ æœ‰äº† Amundsenï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªåœ°æ–¹å‘ç°å’Œç®¡ç†æ•´ä¸ªæ•°æ®æ ˆä¸­çš„æ‰€æœ‰å…ƒæ•°æ®ã€‚ Amundsen ä¸»è¦æœ‰ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š å…ƒæ•°æ®å¯¼å…¥ Metadata Ingestion Amundsen Data builder å…ƒæ•°æ®ç›®å½•æœåŠ¡ Metadata Catalog Amundsen Frontend service Amundsen Metadata service Amundsen Search service å®ƒçš„å·¥ä½œåŸç†æ˜¯ï¼šåˆ©ç”¨ Data builder ä»ä¸åŒæ¥æºæå–å…ƒæ•°æ®ï¼Œå¹¶å°†å…ƒæ•°æ®æŒä¹…åŒ–åˆ° Meta service çš„åç«¯å­˜å‚¨å’Œ Search service çš„åç«¯å­˜å‚¨ä¸­ï¼Œç”¨æˆ·ä» Froent service æˆ–é€šè¿‡ Meta Service çš„APIã€‚ 3.4.1 éƒ¨ç½² Amundsen 3.4.1.1 å…ƒæ•°æ®æœåŠ¡ Metadata serviceæˆ‘ä»¬ç”¨ docker-compose æ–‡ä»¶éƒ¨ç½²ä¸€ä¸ª Amundsen é›†ç¾¤ã€‚ ç”±äº NebulaGraph åç«¯æ”¯æŒå°šæœªåˆå¹¶ï¼Œè¿˜ä¸èƒ½ç”¨å®˜æ–¹çš„ä»£ç ï¼Œå…ˆç”¨æˆ‘è‡ªå·±çš„åˆ†å‰ç‰ˆæœ¬ã€‚ é¦–å…ˆï¼Œè®©æˆ‘ä»¬å…‹éš†åŒ…å«æ‰€æœ‰å­æ¨¡å—çš„ repoï¼š git clone -b amundsen_nebula_graph --recursive git@github.com:wey-gu/amundsen.git cd amundsen ç„¶åï¼Œå¯åŠ¨æ‰€æœ‰ç›®å½•æœåŠ¡ï¼ˆcatalog servicesï¼‰åŠå…¶åç«¯å­˜å‚¨ï¼š docker-compose -f docker-amundsen-nebula.yml up æ³¨ï¼šå¯ä»¥æ·»åŠ  -d æ¥è®©å®¹å™¨åœ¨åå°è¿è¡Œï¼š docker-compose -f docker-amundsen-nebula.yml up -d å…³é—­åå°è¿è¡Œçš„é›†ç¾¤ docker-compose -f docker-amundsen-nebula.yml stop åˆ é™¤åå°è¿è¡Œçš„é›†ç¾¤ docker-compose -f docker-amundsen-nebula.yml down ç”±äºè¿™ä¸ª docker-compose æ–‡ä»¶æ˜¯ä¾›å¼€å‘äººå‘˜è¯•ç©ã€è°ƒè¯• Amundsen ç”¨çš„ï¼Œè€Œä¸æ˜¯ç»™ç”Ÿäº§éƒ¨ç½²å‡†å¤‡çš„ï¼Œå®ƒåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šä»ä»£ç åº“æ„å»ºé•œåƒï¼Œç¬¬ä¸€æ¬¡è·‘çš„æ—¶å€™å¯åŠ¨ä¼šæ…¢ä¸€äº›ã€‚ éƒ¨ç½²å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ Data builder å°†ä¸€äº›ç¤ºä¾‹ã€è™šæ„çš„æ•°æ®åŠ è½½å­˜å‚¨é‡Œã€‚ 3.4.1.2 æŠ“å–å…ƒæ•°æ® Data builderAmundsen Data builder å°±åƒ Meltano ç³»ç»Ÿä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯ç”¨åœ¨å…ƒæ•°æ®çš„ä¸Šçš„ ETL ï¼Œå®ƒæŠŠå…ƒæ•°æ®åŠ è½½åˆ°â€œMeta serviceâ€å’Œâ€œSearch serviceâ€çš„åç«¯å­˜å‚¨ï¼šNebulaGraph å’Œ Elasticsearch é‡Œã€‚ è¿™é‡Œçš„ Data builder åªæ˜¯ä¸€ä¸ª python æ¨¡å—ï¼Œæ‰€æœ‰çš„å…ƒæ•°æ® ETL ä½œä¸šå¯ä»¥ä½œä¸ºè„šæœ¬è¿è¡Œï¼Œä¹Ÿå¯ä»¥ç”¨ Apache Airflow ç­‰ DAG å¹³å°è¿›è¡Œç¼–æ’ã€‚ å®‰è£… Amundsen Data builderï¼š cd databuilder python3 -m venv .venv source .venv/bin/activate python3 -m pip install wheel python3 -m pip install -r requirements.txt python3 setup.py install è°ƒç”¨è¿™ä¸ªç¤ºä¾‹æ•°æ®æ„å»ºå™¨ ETL è„šæœ¬æ¥æŠŠç¤ºä¾‹çš„è™šæ‹Ÿæ•°æ®å¯¼è¿›å»ã€‚ python3 example/scripts/sample_data_loader_nebula.py 3.4.1.3 éªŒè¯ä¸€ä¸‹ Amundsenåœ¨è®¿é—® Amundsen ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨æˆ·ï¼š # run a container with curl attached to amundsenfrontend docker run -it --rm --net container:amundsenfrontend nicolaka/netshoot # Create a user with id test_user_id curl -X PUT -v http://amundsenmetadata:5002/user \\ -H \"Content-Type: application/json\" \\ --data \\ '{\"user_id\":\"test_user_id\",\"first_name\":\"test\",\"last_name\":\"user\", \"email\":\"test_user_id@mail.com\"}' exit ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨ http://localhost:5000 æŸ¥çœ‹ UI å¹¶å°è¯•æœç´¢ testï¼Œå®ƒåº”è¯¥ä¼šè¿”å›ä¸€äº›ç»“æœã€‚ ç„¶åï¼Œå¯ä»¥å•å‡»å¹¶æµè§ˆåœ¨â€œsample_data_loader_nebula.pyâ€æœŸé—´åŠ è½½åˆ° Amundsen çš„é‚£äº›ç¤ºä¾‹å…ƒæ•°æ®ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ NebulaStudio(http://localhost:7001) è®¿é—® NebulaGraph é‡Œçš„è¿™äº›æ•°æ®ã€‚ æ³¨æ„åœ¨ Nebula Studio ä¸­ï¼Œé»˜è®¤ç™»å½•å­—æ®µä¸ºï¼š ä¸»æœºï¼šgraphd:9669 ç”¨æˆ·ï¼šroot å¯†ç ï¼šnebula ä¸‹å›¾æ˜¾ç¤ºäº†æœ‰å…³ Amundsen ç»„ä»¶çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Frontend:5000 â”‚ â”‚ Metadata Sources â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ Metaservice:5001 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Foo DB â”‚ â”‚ Bar App â”‚ â”‚ X Dashboard â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”¤ Nebula Proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”¼â”€â”€â”€â”€â”¤ Search searvice:5002 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Databuilder â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”¼â”€â–º Extractor of Sources â”œâ”€â–º nebula_search_data_extractor â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Loader filesystem_csv_nebula â”‚ â”‚ Loader Elastic FS loader â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Publisher nebula_csv_publisher â”‚ â”‚ Publisher Elasticsearch â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â–ºâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Nebula Gra","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:4","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#éƒ¨ç½²-amundsen"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.4 å…ƒæ•°æ®å‘ç°ç³»ç»Ÿç„¶åï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªå¸¦æœ‰ NebulaGraph å’Œ Elasticsearch çš„ Amundsenã€‚ æ³¨ï¼šç›®å‰ã€NebulaGraph ä½œä¸º Amundsen åç«¯çš„ PRã€‘ï¼ˆhttps://github.com/amundsen-io/amundsen/pull/1817ï¼‰å°šæœªåˆå¹¶ï¼Œæˆ‘è¿˜åœ¨ä¸ Amundsen å›¢é˜Ÿåˆä½œï¼ˆhttps://github.com/amundsen-io/rfcs/pull/48ï¼‰æ¥å®ç°å®ƒã€‚ æœ‰äº† Amundsenï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªåœ°æ–¹å‘ç°å’Œç®¡ç†æ•´ä¸ªæ•°æ®æ ˆä¸­çš„æ‰€æœ‰å…ƒæ•°æ®ã€‚ Amundsen ä¸»è¦æœ‰ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š å…ƒæ•°æ®å¯¼å…¥ Metadata Ingestion Amundsen Data builder å…ƒæ•°æ®ç›®å½•æœåŠ¡ Metadata Catalog Amundsen Frontend service Amundsen Metadata service Amundsen Search service å®ƒçš„å·¥ä½œåŸç†æ˜¯ï¼šåˆ©ç”¨ Data builder ä»ä¸åŒæ¥æºæå–å…ƒæ•°æ®ï¼Œå¹¶å°†å…ƒæ•°æ®æŒä¹…åŒ–åˆ° Meta service çš„åç«¯å­˜å‚¨å’Œ Search service çš„åç«¯å­˜å‚¨ä¸­ï¼Œç”¨æˆ·ä» Froent service æˆ–é€šè¿‡ Meta Service çš„APIã€‚ 3.4.1 éƒ¨ç½² Amundsen 3.4.1.1 å…ƒæ•°æ®æœåŠ¡ Metadata serviceæˆ‘ä»¬ç”¨ docker-compose æ–‡ä»¶éƒ¨ç½²ä¸€ä¸ª Amundsen é›†ç¾¤ã€‚ ç”±äº NebulaGraph åç«¯æ”¯æŒå°šæœªåˆå¹¶ï¼Œè¿˜ä¸èƒ½ç”¨å®˜æ–¹çš„ä»£ç ï¼Œå…ˆç”¨æˆ‘è‡ªå·±çš„åˆ†å‰ç‰ˆæœ¬ã€‚ é¦–å…ˆï¼Œè®©æˆ‘ä»¬å…‹éš†åŒ…å«æ‰€æœ‰å­æ¨¡å—çš„ repoï¼š git clone -b amundsen_nebula_graph --recursive git@github.com:wey-gu/amundsen.git cd amundsen ç„¶åï¼Œå¯åŠ¨æ‰€æœ‰ç›®å½•æœåŠ¡ï¼ˆcatalog servicesï¼‰åŠå…¶åç«¯å­˜å‚¨ï¼š docker-compose -f docker-amundsen-nebula.yml up æ³¨ï¼šå¯ä»¥æ·»åŠ  -d æ¥è®©å®¹å™¨åœ¨åå°è¿è¡Œï¼š docker-compose -f docker-amundsen-nebula.yml up -d å…³é—­åå°è¿è¡Œçš„é›†ç¾¤ docker-compose -f docker-amundsen-nebula.yml stop åˆ é™¤åå°è¿è¡Œçš„é›†ç¾¤ docker-compose -f docker-amundsen-nebula.yml down ç”±äºè¿™ä¸ª docker-compose æ–‡ä»¶æ˜¯ä¾›å¼€å‘äººå‘˜è¯•ç©ã€è°ƒè¯• Amundsen ç”¨çš„ï¼Œè€Œä¸æ˜¯ç»™ç”Ÿäº§éƒ¨ç½²å‡†å¤‡çš„ï¼Œå®ƒåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šä»ä»£ç åº“æ„å»ºé•œåƒï¼Œç¬¬ä¸€æ¬¡è·‘çš„æ—¶å€™å¯åŠ¨ä¼šæ…¢ä¸€äº›ã€‚ éƒ¨ç½²å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ Data builder å°†ä¸€äº›ç¤ºä¾‹ã€è™šæ„çš„æ•°æ®åŠ è½½å­˜å‚¨é‡Œã€‚ 3.4.1.2 æŠ“å–å…ƒæ•°æ® Data builderAmundsen Data builder å°±åƒ Meltano ç³»ç»Ÿä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯ç”¨åœ¨å…ƒæ•°æ®çš„ä¸Šçš„ ETL ï¼Œå®ƒæŠŠå…ƒæ•°æ®åŠ è½½åˆ°â€œMeta serviceâ€å’Œâ€œSearch serviceâ€çš„åç«¯å­˜å‚¨ï¼šNebulaGraph å’Œ Elasticsearch é‡Œã€‚ è¿™é‡Œçš„ Data builder åªæ˜¯ä¸€ä¸ª python æ¨¡å—ï¼Œæ‰€æœ‰çš„å…ƒæ•°æ® ETL ä½œä¸šå¯ä»¥ä½œä¸ºè„šæœ¬è¿è¡Œï¼Œä¹Ÿå¯ä»¥ç”¨ Apache Airflow ç­‰ DAG å¹³å°è¿›è¡Œç¼–æ’ã€‚ å®‰è£… Amundsen Data builderï¼š cd databuilder python3 -m venv .venv source .venv/bin/activate python3 -m pip install wheel python3 -m pip install -r requirements.txt python3 setup.py install è°ƒç”¨è¿™ä¸ªç¤ºä¾‹æ•°æ®æ„å»ºå™¨ ETL è„šæœ¬æ¥æŠŠç¤ºä¾‹çš„è™šæ‹Ÿæ•°æ®å¯¼è¿›å»ã€‚ python3 example/scripts/sample_data_loader_nebula.py 3.4.1.3 éªŒè¯ä¸€ä¸‹ Amundsenåœ¨è®¿é—® Amundsen ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨æˆ·ï¼š # run a container with curl attached to amundsenfrontend docker run -it --rm --net container:amundsenfrontend nicolaka/netshoot # Create a user with id test_user_id curl -X PUT -v http://amundsenmetadata:5002/user \\ -H \"Content-Type: application/json\" \\ --data \\ '{\"user_id\":\"test_user_id\",\"first_name\":\"test\",\"last_name\":\"user\", \"email\":\"test_user_id@mail.com\"}' exit ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨ http://localhost:5000 æŸ¥çœ‹ UI å¹¶å°è¯•æœç´¢ testï¼Œå®ƒåº”è¯¥ä¼šè¿”å›ä¸€äº›ç»“æœã€‚ ç„¶åï¼Œå¯ä»¥å•å‡»å¹¶æµè§ˆåœ¨â€œsample_data_loader_nebula.pyâ€æœŸé—´åŠ è½½åˆ° Amundsen çš„é‚£äº›ç¤ºä¾‹å…ƒæ•°æ®ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ NebulaStudio(http://localhost:7001) è®¿é—® NebulaGraph é‡Œçš„è¿™äº›æ•°æ®ã€‚ æ³¨æ„åœ¨ Nebula Studio ä¸­ï¼Œé»˜è®¤ç™»å½•å­—æ®µä¸ºï¼š ä¸»æœºï¼šgraphd:9669 ç”¨æˆ·ï¼šroot å¯†ç ï¼šnebula ä¸‹å›¾æ˜¾ç¤ºäº†æœ‰å…³ Amundsen ç»„ä»¶çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Frontend:5000 â”‚ â”‚ Metadata Sources â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ Metaservice:5001 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Foo DB â”‚ â”‚ Bar App â”‚ â”‚ X Dashboard â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”¤ Nebula Proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”¼â”€â”€â”€â”€â”¤ Search searvice:5002 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Databuilder â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”¼â”€â–º Extractor of Sources â”œâ”€â–º nebula_search_data_extractor â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Loader filesystem_csv_nebula â”‚ â”‚ Loader Elastic FS loader â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Publisher nebula_csv_publisher â”‚ â”‚ Publisher Elasticsearch â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â–ºâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Nebula Gra","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:4","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#å…ƒæ•°æ®æœåŠ¡-metadata-service"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.4 å…ƒæ•°æ®å‘ç°ç³»ç»Ÿç„¶åï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªå¸¦æœ‰ NebulaGraph å’Œ Elasticsearch çš„ Amundsenã€‚ æ³¨ï¼šç›®å‰ã€NebulaGraph ä½œä¸º Amundsen åç«¯çš„ PRã€‘ï¼ˆhttps://github.com/amundsen-io/amundsen/pull/1817ï¼‰å°šæœªåˆå¹¶ï¼Œæˆ‘è¿˜åœ¨ä¸ Amundsen å›¢é˜Ÿåˆä½œï¼ˆhttps://github.com/amundsen-io/rfcs/pull/48ï¼‰æ¥å®ç°å®ƒã€‚ æœ‰äº† Amundsenï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªåœ°æ–¹å‘ç°å’Œç®¡ç†æ•´ä¸ªæ•°æ®æ ˆä¸­çš„æ‰€æœ‰å…ƒæ•°æ®ã€‚ Amundsen ä¸»è¦æœ‰ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š å…ƒæ•°æ®å¯¼å…¥ Metadata Ingestion Amundsen Data builder å…ƒæ•°æ®ç›®å½•æœåŠ¡ Metadata Catalog Amundsen Frontend service Amundsen Metadata service Amundsen Search service å®ƒçš„å·¥ä½œåŸç†æ˜¯ï¼šåˆ©ç”¨ Data builder ä»ä¸åŒæ¥æºæå–å…ƒæ•°æ®ï¼Œå¹¶å°†å…ƒæ•°æ®æŒä¹…åŒ–åˆ° Meta service çš„åç«¯å­˜å‚¨å’Œ Search service çš„åç«¯å­˜å‚¨ä¸­ï¼Œç”¨æˆ·ä» Froent service æˆ–é€šè¿‡ Meta Service çš„APIã€‚ 3.4.1 éƒ¨ç½² Amundsen 3.4.1.1 å…ƒæ•°æ®æœåŠ¡ Metadata serviceæˆ‘ä»¬ç”¨ docker-compose æ–‡ä»¶éƒ¨ç½²ä¸€ä¸ª Amundsen é›†ç¾¤ã€‚ ç”±äº NebulaGraph åç«¯æ”¯æŒå°šæœªåˆå¹¶ï¼Œè¿˜ä¸èƒ½ç”¨å®˜æ–¹çš„ä»£ç ï¼Œå…ˆç”¨æˆ‘è‡ªå·±çš„åˆ†å‰ç‰ˆæœ¬ã€‚ é¦–å…ˆï¼Œè®©æˆ‘ä»¬å…‹éš†åŒ…å«æ‰€æœ‰å­æ¨¡å—çš„ repoï¼š git clone -b amundsen_nebula_graph --recursive git@github.com:wey-gu/amundsen.git cd amundsen ç„¶åï¼Œå¯åŠ¨æ‰€æœ‰ç›®å½•æœåŠ¡ï¼ˆcatalog servicesï¼‰åŠå…¶åç«¯å­˜å‚¨ï¼š docker-compose -f docker-amundsen-nebula.yml up æ³¨ï¼šå¯ä»¥æ·»åŠ  -d æ¥è®©å®¹å™¨åœ¨åå°è¿è¡Œï¼š docker-compose -f docker-amundsen-nebula.yml up -d å…³é—­åå°è¿è¡Œçš„é›†ç¾¤ docker-compose -f docker-amundsen-nebula.yml stop åˆ é™¤åå°è¿è¡Œçš„é›†ç¾¤ docker-compose -f docker-amundsen-nebula.yml down ç”±äºè¿™ä¸ª docker-compose æ–‡ä»¶æ˜¯ä¾›å¼€å‘äººå‘˜è¯•ç©ã€è°ƒè¯• Amundsen ç”¨çš„ï¼Œè€Œä¸æ˜¯ç»™ç”Ÿäº§éƒ¨ç½²å‡†å¤‡çš„ï¼Œå®ƒåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šä»ä»£ç åº“æ„å»ºé•œåƒï¼Œç¬¬ä¸€æ¬¡è·‘çš„æ—¶å€™å¯åŠ¨ä¼šæ…¢ä¸€äº›ã€‚ éƒ¨ç½²å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ Data builder å°†ä¸€äº›ç¤ºä¾‹ã€è™šæ„çš„æ•°æ®åŠ è½½å­˜å‚¨é‡Œã€‚ 3.4.1.2 æŠ“å–å…ƒæ•°æ® Data builderAmundsen Data builder å°±åƒ Meltano ç³»ç»Ÿä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯ç”¨åœ¨å…ƒæ•°æ®çš„ä¸Šçš„ ETL ï¼Œå®ƒæŠŠå…ƒæ•°æ®åŠ è½½åˆ°â€œMeta serviceâ€å’Œâ€œSearch serviceâ€çš„åç«¯å­˜å‚¨ï¼šNebulaGraph å’Œ Elasticsearch é‡Œã€‚ è¿™é‡Œçš„ Data builder åªæ˜¯ä¸€ä¸ª python æ¨¡å—ï¼Œæ‰€æœ‰çš„å…ƒæ•°æ® ETL ä½œä¸šå¯ä»¥ä½œä¸ºè„šæœ¬è¿è¡Œï¼Œä¹Ÿå¯ä»¥ç”¨ Apache Airflow ç­‰ DAG å¹³å°è¿›è¡Œç¼–æ’ã€‚ å®‰è£… Amundsen Data builderï¼š cd databuilder python3 -m venv .venv source .venv/bin/activate python3 -m pip install wheel python3 -m pip install -r requirements.txt python3 setup.py install è°ƒç”¨è¿™ä¸ªç¤ºä¾‹æ•°æ®æ„å»ºå™¨ ETL è„šæœ¬æ¥æŠŠç¤ºä¾‹çš„è™šæ‹Ÿæ•°æ®å¯¼è¿›å»ã€‚ python3 example/scripts/sample_data_loader_nebula.py 3.4.1.3 éªŒè¯ä¸€ä¸‹ Amundsenåœ¨è®¿é—® Amundsen ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨æˆ·ï¼š # run a container with curl attached to amundsenfrontend docker run -it --rm --net container:amundsenfrontend nicolaka/netshoot # Create a user with id test_user_id curl -X PUT -v http://amundsenmetadata:5002/user \\ -H \"Content-Type: application/json\" \\ --data \\ '{\"user_id\":\"test_user_id\",\"first_name\":\"test\",\"last_name\":\"user\", \"email\":\"test_user_id@mail.com\"}' exit ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨ http://localhost:5000 æŸ¥çœ‹ UI å¹¶å°è¯•æœç´¢ testï¼Œå®ƒåº”è¯¥ä¼šè¿”å›ä¸€äº›ç»“æœã€‚ ç„¶åï¼Œå¯ä»¥å•å‡»å¹¶æµè§ˆåœ¨â€œsample_data_loader_nebula.pyâ€æœŸé—´åŠ è½½åˆ° Amundsen çš„é‚£äº›ç¤ºä¾‹å…ƒæ•°æ®ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ NebulaStudio(http://localhost:7001) è®¿é—® NebulaGraph é‡Œçš„è¿™äº›æ•°æ®ã€‚ æ³¨æ„åœ¨ Nebula Studio ä¸­ï¼Œé»˜è®¤ç™»å½•å­—æ®µä¸ºï¼š ä¸»æœºï¼šgraphd:9669 ç”¨æˆ·ï¼šroot å¯†ç ï¼šnebula ä¸‹å›¾æ˜¾ç¤ºäº†æœ‰å…³ Amundsen ç»„ä»¶çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Frontend:5000 â”‚ â”‚ Metadata Sources â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ Metaservice:5001 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Foo DB â”‚ â”‚ Bar App â”‚ â”‚ X Dashboard â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”¤ Nebula Proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”¼â”€â”€â”€â”€â”¤ Search searvice:5002 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Databuilder â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”¼â”€â–º Extractor of Sources â”œâ”€â–º nebula_search_data_extractor â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Loader filesystem_csv_nebula â”‚ â”‚ Loader Elastic FS loader â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Publisher nebula_csv_publisher â”‚ â”‚ Publisher Elasticsearch â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â–ºâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Nebula Gra","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:4","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æŠ“å–å…ƒæ•°æ®-data-builder"},{"categories":["Nebula Graph","Amundsen"],"content":" 3.4 å…ƒæ•°æ®å‘ç°ç³»ç»Ÿç„¶åï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªå¸¦æœ‰ NebulaGraph å’Œ Elasticsearch çš„ Amundsenã€‚ æ³¨ï¼šç›®å‰ã€NebulaGraph ä½œä¸º Amundsen åç«¯çš„ PRã€‘ï¼ˆhttps://github.com/amundsen-io/amundsen/pull/1817ï¼‰å°šæœªåˆå¹¶ï¼Œæˆ‘è¿˜åœ¨ä¸ Amundsen å›¢é˜Ÿåˆä½œï¼ˆhttps://github.com/amundsen-io/rfcs/pull/48ï¼‰æ¥å®ç°å®ƒã€‚ æœ‰äº† Amundsenï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªåœ°æ–¹å‘ç°å’Œç®¡ç†æ•´ä¸ªæ•°æ®æ ˆä¸­çš„æ‰€æœ‰å…ƒæ•°æ®ã€‚ Amundsen ä¸»è¦æœ‰ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š å…ƒæ•°æ®å¯¼å…¥ Metadata Ingestion Amundsen Data builder å…ƒæ•°æ®ç›®å½•æœåŠ¡ Metadata Catalog Amundsen Frontend service Amundsen Metadata service Amundsen Search service å®ƒçš„å·¥ä½œåŸç†æ˜¯ï¼šåˆ©ç”¨ Data builder ä»ä¸åŒæ¥æºæå–å…ƒæ•°æ®ï¼Œå¹¶å°†å…ƒæ•°æ®æŒä¹…åŒ–åˆ° Meta service çš„åç«¯å­˜å‚¨å’Œ Search service çš„åç«¯å­˜å‚¨ä¸­ï¼Œç”¨æˆ·ä» Froent service æˆ–é€šè¿‡ Meta Service çš„APIã€‚ 3.4.1 éƒ¨ç½² Amundsen 3.4.1.1 å…ƒæ•°æ®æœåŠ¡ Metadata serviceæˆ‘ä»¬ç”¨ docker-compose æ–‡ä»¶éƒ¨ç½²ä¸€ä¸ª Amundsen é›†ç¾¤ã€‚ ç”±äº NebulaGraph åç«¯æ”¯æŒå°šæœªåˆå¹¶ï¼Œè¿˜ä¸èƒ½ç”¨å®˜æ–¹çš„ä»£ç ï¼Œå…ˆç”¨æˆ‘è‡ªå·±çš„åˆ†å‰ç‰ˆæœ¬ã€‚ é¦–å…ˆï¼Œè®©æˆ‘ä»¬å…‹éš†åŒ…å«æ‰€æœ‰å­æ¨¡å—çš„ repoï¼š git clone -b amundsen_nebula_graph --recursive git@github.com:wey-gu/amundsen.git cd amundsen ç„¶åï¼Œå¯åŠ¨æ‰€æœ‰ç›®å½•æœåŠ¡ï¼ˆcatalog servicesï¼‰åŠå…¶åç«¯å­˜å‚¨ï¼š docker-compose -f docker-amundsen-nebula.yml up æ³¨ï¼šå¯ä»¥æ·»åŠ  -d æ¥è®©å®¹å™¨åœ¨åå°è¿è¡Œï¼š docker-compose -f docker-amundsen-nebula.yml up -d å…³é—­åå°è¿è¡Œçš„é›†ç¾¤ docker-compose -f docker-amundsen-nebula.yml stop åˆ é™¤åå°è¿è¡Œçš„é›†ç¾¤ docker-compose -f docker-amundsen-nebula.yml down ç”±äºè¿™ä¸ª docker-compose æ–‡ä»¶æ˜¯ä¾›å¼€å‘äººå‘˜è¯•ç©ã€è°ƒè¯• Amundsen ç”¨çš„ï¼Œè€Œä¸æ˜¯ç»™ç”Ÿäº§éƒ¨ç½²å‡†å¤‡çš„ï¼Œå®ƒåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šä»ä»£ç åº“æ„å»ºé•œåƒï¼Œç¬¬ä¸€æ¬¡è·‘çš„æ—¶å€™å¯åŠ¨ä¼šæ…¢ä¸€äº›ã€‚ éƒ¨ç½²å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ Data builder å°†ä¸€äº›ç¤ºä¾‹ã€è™šæ„çš„æ•°æ®åŠ è½½å­˜å‚¨é‡Œã€‚ 3.4.1.2 æŠ“å–å…ƒæ•°æ® Data builderAmundsen Data builder å°±åƒ Meltano ç³»ç»Ÿä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯ç”¨åœ¨å…ƒæ•°æ®çš„ä¸Šçš„ ETL ï¼Œå®ƒæŠŠå…ƒæ•°æ®åŠ è½½åˆ°â€œMeta serviceâ€å’Œâ€œSearch serviceâ€çš„åç«¯å­˜å‚¨ï¼šNebulaGraph å’Œ Elasticsearch é‡Œã€‚ è¿™é‡Œçš„ Data builder åªæ˜¯ä¸€ä¸ª python æ¨¡å—ï¼Œæ‰€æœ‰çš„å…ƒæ•°æ® ETL ä½œä¸šå¯ä»¥ä½œä¸ºè„šæœ¬è¿è¡Œï¼Œä¹Ÿå¯ä»¥ç”¨ Apache Airflow ç­‰ DAG å¹³å°è¿›è¡Œç¼–æ’ã€‚ å®‰è£… Amundsen Data builderï¼š cd databuilder python3 -m venv .venv source .venv/bin/activate python3 -m pip install wheel python3 -m pip install -r requirements.txt python3 setup.py install è°ƒç”¨è¿™ä¸ªç¤ºä¾‹æ•°æ®æ„å»ºå™¨ ETL è„šæœ¬æ¥æŠŠç¤ºä¾‹çš„è™šæ‹Ÿæ•°æ®å¯¼è¿›å»ã€‚ python3 example/scripts/sample_data_loader_nebula.py 3.4.1.3 éªŒè¯ä¸€ä¸‹ Amundsenåœ¨è®¿é—® Amundsen ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨æˆ·ï¼š # run a container with curl attached to amundsenfrontend docker run -it --rm --net container:amundsenfrontend nicolaka/netshoot # Create a user with id test_user_id curl -X PUT -v http://amundsenmetadata:5002/user \\ -H \"Content-Type: application/json\" \\ --data \\ '{\"user_id\":\"test_user_id\",\"first_name\":\"test\",\"last_name\":\"user\", \"email\":\"test_user_id@mail.com\"}' exit ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨ http://localhost:5000 æŸ¥çœ‹ UI å¹¶å°è¯•æœç´¢ testï¼Œå®ƒåº”è¯¥ä¼šè¿”å›ä¸€äº›ç»“æœã€‚ ç„¶åï¼Œå¯ä»¥å•å‡»å¹¶æµè§ˆåœ¨â€œsample_data_loader_nebula.pyâ€æœŸé—´åŠ è½½åˆ° Amundsen çš„é‚£äº›ç¤ºä¾‹å…ƒæ•°æ®ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ NebulaStudio(http://localhost:7001) è®¿é—® NebulaGraph é‡Œçš„è¿™äº›æ•°æ®ã€‚ æ³¨æ„åœ¨ Nebula Studio ä¸­ï¼Œé»˜è®¤ç™»å½•å­—æ®µä¸ºï¼š ä¸»æœºï¼šgraphd:9669 ç”¨æˆ·ï¼šroot å¯†ç ï¼šnebula ä¸‹å›¾æ˜¾ç¤ºäº†æœ‰å…³ Amundsen ç»„ä»¶çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Frontend:5000 â”‚ â”‚ Metadata Sources â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ Metaservice:5001 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Foo DB â”‚ â”‚ Bar App â”‚ â”‚ X Dashboard â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”¤ Nebula Proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”¼â”€â”€â”€â”€â”¤ Search searvice:5002 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Databuilder â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”¼â”€â–º Extractor of Sources â”œâ”€â–º nebula_search_data_extractor â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Loader filesystem_csv_nebula â”‚ â”‚ Loader Elastic FS loader â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Publisher nebula_csv_publisher â”‚ â”‚ Publisher Elasticsearch â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â–ºâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Nebula Gra","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:3:4","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#éªŒè¯ä¸€ä¸‹-amundsen"},{"categories":["Nebula Graph","Amundsen"],"content":" 4 ç©¿é’ˆå¼•çº¿ï¼šå…ƒæ•°æ®å‘ç°è®¾ç½®å¥½åŸºæœ¬ç¯å¢ƒåï¼Œè®©æˆ‘ä»¬æŠŠæ‰€æœ‰ä¸œè¥¿ç©¿èµ·æ¥ã€‚è¿˜è®°å¾—æˆ‘ä»¬æœ‰ ELT ä¸€äº›æ•°æ®åˆ° PostgreSQL å—ï¼Ÿ é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•è®© Amundsen å‘ç°æœ‰å…³è¿™äº›æ•°æ®å’Œ ETL çš„å…ƒæ•°æ®å‘¢ï¼Ÿ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:0","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#ç©¿é’ˆå¼•çº¿å…ƒæ•°æ®å‘ç°"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.1 æå– Postgres å…ƒæ•°æ®æˆ‘ä»¬ä»æ•°æ®æºå¼€å§‹ï¼šé¦–å…ˆæ˜¯ Postgresã€‚ æˆ‘ä»¬ä¸º python3 å®‰è£… Postgres å®¢æˆ·ç«¯ï¼š sudo apt-get install libpq-dev pip3 install Psycopg2 4.1.1 æ‰§è¡Œ Postgres å…ƒæ•°æ® ETLè¿è¡Œä¸€ä¸ªè„šæœ¬æ¥è§£æ Postgres å…ƒæ•°æ®ï¼š export CREDENTIALS_POSTGRES_USER=lineage_ref export CREDENTIALS_POSTGRES_PASSWORD=lineage_ref export CREDENTIALS_POSTGRES_DATABASE=warehouse python3 example/scripts/sample_postgres_loader_nebula.py If you look into the code of the sample script for loading Postgres metadata to Nebula, the main lines are quite straightforward: æˆ‘ä»¬çœ‹çœ‹æŠŠ Postgres å…ƒæ•°æ®åŠ è½½åˆ° NebulaGraph çš„ç¤ºä¾‹è„šæœ¬çš„ä»£ç ï¼Œéå¸¸ç®€å•ç›´æ¥ï¼š # part 1: PostgressMetadata --\u003e CSV --\u003e Nebula Graph job = DefaultJob( conf=job_config, task=DefaultTask( extractor=PostgresMetadataExtractor(), loader=FsNebulaCSVLoader()), publisher=NebulaCsvPublisher()) ... # part 2: Metadata stored in NebulaGraph --\u003e Elasticsearch extractor = NebulaSearchDataExtractor() task = SearchMetadatatoElasticasearchTask(extractor=extractor) job = DefaultJob(conf=job_config, task=task) ç¬¬ä¸€ä¸ªå·¥ä½œè·¯å¾„æ˜¯ï¼šPostgressMetadata --\u003e CSV --\u003e Nebula Graph PostgresMetadataExtractor ç”¨äºä» Postgres ä¸­æå–/æå–å…ƒæ•°æ®ï¼Œå¯ä»¥å‚è€ƒæ–‡æ¡£ï¼ˆhttps://www.amundsen.io/amundsen/databuilder/#postgresmetadataextractorï¼‰ã€‚ FsNebulaCSVLoader ç”¨äºå°†æå–çš„æ•°æ®ä¸­é—´æ”¾ç½®ä¸º CSV æ–‡ä»¶ NebulaCsvPublisher ç”¨äºå°†å…ƒæ•°æ®ä»¥ CSV çš„å½¢å¼å‘å¸ƒåˆ° NebulaGraph ç¬¬äºŒä¸ªå·¥ä½œè·¯å¾„æ˜¯ï¼šMetadata stored in NebulaGraph --\u003e Elasticsearch NebulaSearchDataExtractor ç”¨äºè·å–å­˜å‚¨åœ¨ Nebula Graph ä¸­çš„å…ƒæ•°æ® SearchMetadatatoElasticasearchTask ç”¨äºä½¿ Elasticsearch å¯¹å…ƒæ•°æ®è¿›è¡Œç´¢å¼•ã€‚ è¯·æ³¨æ„ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è„šæœ¬ä¸­æˆ–ä½¿ç”¨ Apache Airflow ç­‰ç¼–æ’å¹³å°è§¦å‘è¿™äº›ä½œä¸šã€‚ 4.1.2 éªŒè¯ Postgres ä¸­å…ƒæ•°æ®çš„è·å–æœç´¢paymentsæˆ–è€…ç›´æ¥è®¿é—®http://localhost:5000/table_detail/warehouse/postgres/public/paymentsï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ Postgres çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚ï¼š ç„¶åï¼Œåƒä¸Šé¢çš„å±å¹•æˆªå›¾ä¸€æ ·ï¼Œå¯ä»¥è½»æ¾å®Œæˆå…ƒæ•°æ®ç®¡ç†æ“ä½œï¼Œå¦‚æ·»åŠ æ ‡ç­¾ã€æ‰€æœ‰è€…å’Œæè¿°ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:1","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æå–-postgres-å…ƒæ•°æ®"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.1 æå– Postgres å…ƒæ•°æ®æˆ‘ä»¬ä»æ•°æ®æºå¼€å§‹ï¼šé¦–å…ˆæ˜¯ Postgresã€‚ æˆ‘ä»¬ä¸º python3 å®‰è£… Postgres å®¢æˆ·ç«¯ï¼š sudo apt-get install libpq-dev pip3 install Psycopg2 4.1.1 æ‰§è¡Œ Postgres å…ƒæ•°æ® ETLè¿è¡Œä¸€ä¸ªè„šæœ¬æ¥è§£æ Postgres å…ƒæ•°æ®ï¼š export CREDENTIALS_POSTGRES_USER=lineage_ref export CREDENTIALS_POSTGRES_PASSWORD=lineage_ref export CREDENTIALS_POSTGRES_DATABASE=warehouse python3 example/scripts/sample_postgres_loader_nebula.py If you look into the code of the sample script for loading Postgres metadata to Nebula, the main lines are quite straightforward: æˆ‘ä»¬çœ‹çœ‹æŠŠ Postgres å…ƒæ•°æ®åŠ è½½åˆ° NebulaGraph çš„ç¤ºä¾‹è„šæœ¬çš„ä»£ç ï¼Œéå¸¸ç®€å•ç›´æ¥ï¼š # part 1: PostgressMetadata --\u003e CSV --\u003e Nebula Graph job = DefaultJob( conf=job_config, task=DefaultTask( extractor=PostgresMetadataExtractor(), loader=FsNebulaCSVLoader()), publisher=NebulaCsvPublisher()) ... # part 2: Metadata stored in NebulaGraph --\u003e Elasticsearch extractor = NebulaSearchDataExtractor() task = SearchMetadatatoElasticasearchTask(extractor=extractor) job = DefaultJob(conf=job_config, task=task) ç¬¬ä¸€ä¸ªå·¥ä½œè·¯å¾„æ˜¯ï¼šPostgressMetadata --\u003e CSV --\u003e Nebula Graph PostgresMetadataExtractor ç”¨äºä» Postgres ä¸­æå–/æå–å…ƒæ•°æ®ï¼Œå¯ä»¥å‚è€ƒæ–‡æ¡£ï¼ˆhttps://www.amundsen.io/amundsen/databuilder/#postgresmetadataextractorï¼‰ã€‚ FsNebulaCSVLoader ç”¨äºå°†æå–çš„æ•°æ®ä¸­é—´æ”¾ç½®ä¸º CSV æ–‡ä»¶ NebulaCsvPublisher ç”¨äºå°†å…ƒæ•°æ®ä»¥ CSV çš„å½¢å¼å‘å¸ƒåˆ° NebulaGraph ç¬¬äºŒä¸ªå·¥ä½œè·¯å¾„æ˜¯ï¼šMetadata stored in NebulaGraph --\u003e Elasticsearch NebulaSearchDataExtractor ç”¨äºè·å–å­˜å‚¨åœ¨ Nebula Graph ä¸­çš„å…ƒæ•°æ® SearchMetadatatoElasticasearchTask ç”¨äºä½¿ Elasticsearch å¯¹å…ƒæ•°æ®è¿›è¡Œç´¢å¼•ã€‚ è¯·æ³¨æ„ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è„šæœ¬ä¸­æˆ–ä½¿ç”¨ Apache Airflow ç­‰ç¼–æ’å¹³å°è§¦å‘è¿™äº›ä½œä¸šã€‚ 4.1.2 éªŒè¯ Postgres ä¸­å…ƒæ•°æ®çš„è·å–æœç´¢paymentsæˆ–è€…ç›´æ¥è®¿é—®http://localhost:5000/table_detail/warehouse/postgres/public/paymentsï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ Postgres çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚ï¼š ç„¶åï¼Œåƒä¸Šé¢çš„å±å¹•æˆªå›¾ä¸€æ ·ï¼Œå¯ä»¥è½»æ¾å®Œæˆå…ƒæ•°æ®ç®¡ç†æ“ä½œï¼Œå¦‚æ·»åŠ æ ‡ç­¾ã€æ‰€æœ‰è€…å’Œæè¿°ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:1","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æ‰§è¡Œ-postgres-å…ƒæ•°æ®-etl"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.1 æå– Postgres å…ƒæ•°æ®æˆ‘ä»¬ä»æ•°æ®æºå¼€å§‹ï¼šé¦–å…ˆæ˜¯ Postgresã€‚ æˆ‘ä»¬ä¸º python3 å®‰è£… Postgres å®¢æˆ·ç«¯ï¼š sudo apt-get install libpq-dev pip3 install Psycopg2 4.1.1 æ‰§è¡Œ Postgres å…ƒæ•°æ® ETLè¿è¡Œä¸€ä¸ªè„šæœ¬æ¥è§£æ Postgres å…ƒæ•°æ®ï¼š export CREDENTIALS_POSTGRES_USER=lineage_ref export CREDENTIALS_POSTGRES_PASSWORD=lineage_ref export CREDENTIALS_POSTGRES_DATABASE=warehouse python3 example/scripts/sample_postgres_loader_nebula.py If you look into the code of the sample script for loading Postgres metadata to Nebula, the main lines are quite straightforward: æˆ‘ä»¬çœ‹çœ‹æŠŠ Postgres å…ƒæ•°æ®åŠ è½½åˆ° NebulaGraph çš„ç¤ºä¾‹è„šæœ¬çš„ä»£ç ï¼Œéå¸¸ç®€å•ç›´æ¥ï¼š # part 1: PostgressMetadata --\u003e CSV --\u003e Nebula Graph job = DefaultJob( conf=job_config, task=DefaultTask( extractor=PostgresMetadataExtractor(), loader=FsNebulaCSVLoader()), publisher=NebulaCsvPublisher()) ... # part 2: Metadata stored in NebulaGraph --\u003e Elasticsearch extractor = NebulaSearchDataExtractor() task = SearchMetadatatoElasticasearchTask(extractor=extractor) job = DefaultJob(conf=job_config, task=task) ç¬¬ä¸€ä¸ªå·¥ä½œè·¯å¾„æ˜¯ï¼šPostgressMetadata --\u003e CSV --\u003e Nebula Graph PostgresMetadataExtractor ç”¨äºä» Postgres ä¸­æå–/æå–å…ƒæ•°æ®ï¼Œå¯ä»¥å‚è€ƒæ–‡æ¡£ï¼ˆhttps://www.amundsen.io/amundsen/databuilder/#postgresmetadataextractorï¼‰ã€‚ FsNebulaCSVLoader ç”¨äºå°†æå–çš„æ•°æ®ä¸­é—´æ”¾ç½®ä¸º CSV æ–‡ä»¶ NebulaCsvPublisher ç”¨äºå°†å…ƒæ•°æ®ä»¥ CSV çš„å½¢å¼å‘å¸ƒåˆ° NebulaGraph ç¬¬äºŒä¸ªå·¥ä½œè·¯å¾„æ˜¯ï¼šMetadata stored in NebulaGraph --\u003e Elasticsearch NebulaSearchDataExtractor ç”¨äºè·å–å­˜å‚¨åœ¨ Nebula Graph ä¸­çš„å…ƒæ•°æ® SearchMetadatatoElasticasearchTask ç”¨äºä½¿ Elasticsearch å¯¹å…ƒæ•°æ®è¿›è¡Œç´¢å¼•ã€‚ è¯·æ³¨æ„ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è„šæœ¬ä¸­æˆ–ä½¿ç”¨ Apache Airflow ç­‰ç¼–æ’å¹³å°è§¦å‘è¿™äº›ä½œä¸šã€‚ 4.1.2 éªŒè¯ Postgres ä¸­å…ƒæ•°æ®çš„è·å–æœç´¢paymentsæˆ–è€…ç›´æ¥è®¿é—®http://localhost:5000/table_detail/warehouse/postgres/public/paymentsï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ Postgres çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚ï¼š ç„¶åï¼Œåƒä¸Šé¢çš„å±å¹•æˆªå›¾ä¸€æ ·ï¼Œå¯ä»¥è½»æ¾å®Œæˆå…ƒæ•°æ®ç®¡ç†æ“ä½œï¼Œå¦‚æ·»åŠ æ ‡ç­¾ã€æ‰€æœ‰è€…å’Œæè¿°ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:1","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#éªŒè¯-postgres-ä¸­å…ƒæ•°æ®çš„è·å–"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.2 æå– dbt å…ƒæ•°æ®å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä» dbt æœ¬èº«æå–å…ƒæ•°æ®ã€‚ Amundsen DbtExtractor ä¼šè§£æ catalog.json æˆ– manifest.json æ–‡ä»¶ä»¥å°†å…ƒæ•°æ®åŠ è½½åˆ° Amundsen å­˜å‚¨ï¼ˆNebulaGraph å’Œ Elasticsearch )ã€‚ åœ¨ä¸Šé¢çš„ meltano ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨ meltano invoke dbt docs generate ç”Ÿæˆäº†è¿™ä¸ªæ–‡ä»¶ï¼š 14:23:15 Done. 14:23:15 Building catalog 14:23:15 Catalog written to /home/ubuntu/ref-data-lineage/meltano_example_implementations/meltano_projects/singer_dbt_jaffle/.meltano/transformers/dbt/target/catalog.json 4.2.1 dbt å…ƒæ•°æ® ETL çš„æ‰§è¡Œæˆ‘ä»¬è¯•ç€è§£æç¤ºä¾‹ dbt æ–‡ä»¶ä¸­çš„å…ƒæ•°æ®å§ï¼š $ ls -l example/sample_data/dbt/ total 184 -rw-rw-r-- 1 w w 5320 May 15 07:17 catalog.json -rw-rw-r-- 1 w w 177163 May 15 07:17 manifest.json æˆ‘å†™çš„è¿™ä¸ªç¤ºä¾‹çš„åŠ è½½ä¾‹å­å¦‚ä¸‹ï¼š python3 example/scripts/sample_dbt_loader_nebula.py å…¶ä¸­ä¸»è¦çš„ä»£ç å¦‚ä¸‹ï¼š # part 1: Dbt manifest --\u003e CSV --\u003e Nebula Graph job = DefaultJob( conf=job_config, task=DefaultTask( extractor=DbtExtractor(), loader=FsNebulaCSVLoader()), publisher=NebulaCsvPublisher()) ... # part 2: Metadata stored in NebulaGraph --\u003e Elasticsearch extractor = NebulaSearchDataExtractor() task = SearchMetadatatoElasticasearchTask(extractor=extractor) job = DefaultJob(conf=job_config, task=task) å®ƒå’Œ Postgres å…ƒæ•°æ® ETL çš„å”¯ä¸€åŒºåˆ«æ˜¯ extractor=DbtExtractor()ï¼Œå®ƒå¸¦æœ‰ä»¥ä¸‹é…ç½®ä»¥è·å–æœ‰å…³ dbt é¡¹ç›®çš„ä»¥ä¸‹ä¿¡æ¯ï¼š æ•°æ®åº“åç§° ç›®å½•_json manifest_json job_config = ConfigFactory.from_dict({ 'extractor.dbt.database_name': database_name, 'extractor.dbt.catalog_json': catalog_file_loc, # File 'extractor.dbt.manifest_json': json.dumps(manifest_data), # JSON Dumped objecy 'extractor.dbt.source_url': source_url}) 4.2.2 éªŒè¯ dbt æŠ“å–ç»“æœæœç´¢ dbt_demo æˆ–è€…ç›´æ¥è®¿é—® http://localhost:5000/table_detail/dbt_demo/snowflake/public/raw_inventory_valueï¼Œå¯ä»¥çœ‹åˆ° å°æç¤ºï¼šæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¯ç”¨ DEBUG log çº§åˆ«å»çœ‹å·²å‘é€åˆ° Elasticsearch å’Œ NebulaGraph çš„å†…å®¹ã€‚ - logging.basicConfig(level=logging.INFO) + logging.basicConfig(level=logging.DEBUG) æˆ–è€…ï¼Œåœ¨ NebulaStudio ä¸­æ¢ç´¢å¯¼å…¥çš„æ•°æ®ï¼š é¦–å…ˆï¼Œç‚¹å‡» â€œStart with Verticesâ€ï¼Œå¡«å†™é¡¶ç‚¹ vidï¼šsnowflake://dbt_demo.public/fact_warehouse_inventory ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é¡¶ç‚¹æ˜¾ç¤ºä¸ºç²‰çº¢è‰²çš„ç‚¹ã€‚ è®©æˆ‘ä»¬ä¿®æ”¹ Expand / â€æ‹“å±•â€œé€‰é¡¹ï¼š æ–¹å‘ï¼šåŒå‘ æ­¥æ•°ï¼šå•å‘ã€ä¸‰æ­¥ å¹¶åŒå‡»é¡¶ç‚¹ï¼ˆç‚¹ï¼‰ï¼Œå®ƒå°†åŒå‘æ‹“å±• 3 æ­¥ï¼š ä»ä¸Šè¾¹è¿™ä¸ªæˆªå›¾é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨å¯è§†åŒ–ä¹‹åçš„å›¾æ•°æ®åº“ä¸­ï¼Œè¿™äº›å…ƒæ•°æ®å¯ä»¥å¾ˆå®¹æ˜“è¢«æŸ¥çœ‹ã€åˆ†æï¼Œå¹¶ä»ä¸­è·å¾—æ´å¯Ÿã€‚ å°è´´å£«ï¼Œæ‚¨å¯ä»¥ç‚¹å‡» ğŸ‘ å›¾æ ‡é€‰æ‹©ä¸€äº›è¦æ˜¾ç¤ºçš„å±æ€§ï¼Œæˆ‘åœ¨æˆªå›¾ä¹‹å‰å°±æ˜¯é€šè¿‡å®ƒè®©ä¸€äº›ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥çš„ã€‚ è€Œä¸”ï¼Œæˆ‘ä»¬åœ¨ NebulaStudio ä¸­çœ‹åˆ°çš„ä¹Ÿä¸ Amundsen å…ƒæ•°æ®æœåŠ¡çš„æ•°æ®æ¨¡å‹ç›¸å‘¼åº”ï¼š æœ€åï¼Œè¯·è®°ä½æˆ‘ä»¬æ›¾åˆ©ç”¨ dbt æ¥è½¬æ¢meltano ä¸­çš„ä¸€äº›æ•°æ®ï¼Œå¹¶ä¸”æ¸…å•æ–‡ä»¶è·¯å¾„æ˜¯.meltano/transformers/dbt/target/catalog.jsonï¼Œæ‚¨å¯ä»¥å°è¯•åˆ›å»ºä¸€ä¸ªæ•°æ®æ„å»ºå™¨ä½œä¸šæ¥å¯¼å…¥å®ƒã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æå–-dbt-å…ƒæ•°æ®"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.2 æå– dbt å…ƒæ•°æ®å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä» dbt æœ¬èº«æå–å…ƒæ•°æ®ã€‚ Amundsen DbtExtractor ä¼šè§£æ catalog.json æˆ– manifest.json æ–‡ä»¶ä»¥å°†å…ƒæ•°æ®åŠ è½½åˆ° Amundsen å­˜å‚¨ï¼ˆNebulaGraph å’Œ Elasticsearch )ã€‚ åœ¨ä¸Šé¢çš„ meltano ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨ meltano invoke dbt docs generate ç”Ÿæˆäº†è¿™ä¸ªæ–‡ä»¶ï¼š 14:23:15 Done. 14:23:15 Building catalog 14:23:15 Catalog written to /home/ubuntu/ref-data-lineage/meltano_example_implementations/meltano_projects/singer_dbt_jaffle/.meltano/transformers/dbt/target/catalog.json 4.2.1 dbt å…ƒæ•°æ® ETL çš„æ‰§è¡Œæˆ‘ä»¬è¯•ç€è§£æç¤ºä¾‹ dbt æ–‡ä»¶ä¸­çš„å…ƒæ•°æ®å§ï¼š $ ls -l example/sample_data/dbt/ total 184 -rw-rw-r-- 1 w w 5320 May 15 07:17 catalog.json -rw-rw-r-- 1 w w 177163 May 15 07:17 manifest.json æˆ‘å†™çš„è¿™ä¸ªç¤ºä¾‹çš„åŠ è½½ä¾‹å­å¦‚ä¸‹ï¼š python3 example/scripts/sample_dbt_loader_nebula.py å…¶ä¸­ä¸»è¦çš„ä»£ç å¦‚ä¸‹ï¼š # part 1: Dbt manifest --\u003e CSV --\u003e Nebula Graph job = DefaultJob( conf=job_config, task=DefaultTask( extractor=DbtExtractor(), loader=FsNebulaCSVLoader()), publisher=NebulaCsvPublisher()) ... # part 2: Metadata stored in NebulaGraph --\u003e Elasticsearch extractor = NebulaSearchDataExtractor() task = SearchMetadatatoElasticasearchTask(extractor=extractor) job = DefaultJob(conf=job_config, task=task) å®ƒå’Œ Postgres å…ƒæ•°æ® ETL çš„å”¯ä¸€åŒºåˆ«æ˜¯ extractor=DbtExtractor()ï¼Œå®ƒå¸¦æœ‰ä»¥ä¸‹é…ç½®ä»¥è·å–æœ‰å…³ dbt é¡¹ç›®çš„ä»¥ä¸‹ä¿¡æ¯ï¼š æ•°æ®åº“åç§° ç›®å½•_json manifest_json job_config = ConfigFactory.from_dict({ 'extractor.dbt.database_name': database_name, 'extractor.dbt.catalog_json': catalog_file_loc, # File 'extractor.dbt.manifest_json': json.dumps(manifest_data), # JSON Dumped objecy 'extractor.dbt.source_url': source_url}) 4.2.2 éªŒè¯ dbt æŠ“å–ç»“æœæœç´¢ dbt_demo æˆ–è€…ç›´æ¥è®¿é—® http://localhost:5000/table_detail/dbt_demo/snowflake/public/raw_inventory_valueï¼Œå¯ä»¥çœ‹åˆ° å°æç¤ºï¼šæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¯ç”¨ DEBUG log çº§åˆ«å»çœ‹å·²å‘é€åˆ° Elasticsearch å’Œ NebulaGraph çš„å†…å®¹ã€‚ - logging.basicConfig(level=logging.INFO) + logging.basicConfig(level=logging.DEBUG) æˆ–è€…ï¼Œåœ¨ NebulaStudio ä¸­æ¢ç´¢å¯¼å…¥çš„æ•°æ®ï¼š é¦–å…ˆï¼Œç‚¹å‡» â€œStart with Verticesâ€ï¼Œå¡«å†™é¡¶ç‚¹ vidï¼šsnowflake://dbt_demo.public/fact_warehouse_inventory ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é¡¶ç‚¹æ˜¾ç¤ºä¸ºç²‰çº¢è‰²çš„ç‚¹ã€‚ è®©æˆ‘ä»¬ä¿®æ”¹ Expand / â€æ‹“å±•â€œé€‰é¡¹ï¼š æ–¹å‘ï¼šåŒå‘ æ­¥æ•°ï¼šå•å‘ã€ä¸‰æ­¥ å¹¶åŒå‡»é¡¶ç‚¹ï¼ˆç‚¹ï¼‰ï¼Œå®ƒå°†åŒå‘æ‹“å±• 3 æ­¥ï¼š ä»ä¸Šè¾¹è¿™ä¸ªæˆªå›¾é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨å¯è§†åŒ–ä¹‹åçš„å›¾æ•°æ®åº“ä¸­ï¼Œè¿™äº›å…ƒæ•°æ®å¯ä»¥å¾ˆå®¹æ˜“è¢«æŸ¥çœ‹ã€åˆ†æï¼Œå¹¶ä»ä¸­è·å¾—æ´å¯Ÿã€‚ å°è´´å£«ï¼Œæ‚¨å¯ä»¥ç‚¹å‡» ğŸ‘ å›¾æ ‡é€‰æ‹©ä¸€äº›è¦æ˜¾ç¤ºçš„å±æ€§ï¼Œæˆ‘åœ¨æˆªå›¾ä¹‹å‰å°±æ˜¯é€šè¿‡å®ƒè®©ä¸€äº›ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥çš„ã€‚ è€Œä¸”ï¼Œæˆ‘ä»¬åœ¨ NebulaStudio ä¸­çœ‹åˆ°çš„ä¹Ÿä¸ Amundsen å…ƒæ•°æ®æœåŠ¡çš„æ•°æ®æ¨¡å‹ç›¸å‘¼åº”ï¼š æœ€åï¼Œè¯·è®°ä½æˆ‘ä»¬æ›¾åˆ©ç”¨ dbt æ¥è½¬æ¢meltano ä¸­çš„ä¸€äº›æ•°æ®ï¼Œå¹¶ä¸”æ¸…å•æ–‡ä»¶è·¯å¾„æ˜¯.meltano/transformers/dbt/target/catalog.jsonï¼Œæ‚¨å¯ä»¥å°è¯•åˆ›å»ºä¸€ä¸ªæ•°æ®æ„å»ºå™¨ä½œä¸šæ¥å¯¼å…¥å®ƒã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#dbt-å…ƒæ•°æ®-etl-çš„æ‰§è¡Œ"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.2 æå– dbt å…ƒæ•°æ®å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä» dbt æœ¬èº«æå–å…ƒæ•°æ®ã€‚ Amundsen DbtExtractor ä¼šè§£æ catalog.json æˆ– manifest.json æ–‡ä»¶ä»¥å°†å…ƒæ•°æ®åŠ è½½åˆ° Amundsen å­˜å‚¨ï¼ˆNebulaGraph å’Œ Elasticsearch )ã€‚ åœ¨ä¸Šé¢çš„ meltano ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨ meltano invoke dbt docs generate ç”Ÿæˆäº†è¿™ä¸ªæ–‡ä»¶ï¼š 14:23:15 Done. 14:23:15 Building catalog 14:23:15 Catalog written to /home/ubuntu/ref-data-lineage/meltano_example_implementations/meltano_projects/singer_dbt_jaffle/.meltano/transformers/dbt/target/catalog.json 4.2.1 dbt å…ƒæ•°æ® ETL çš„æ‰§è¡Œæˆ‘ä»¬è¯•ç€è§£æç¤ºä¾‹ dbt æ–‡ä»¶ä¸­çš„å…ƒæ•°æ®å§ï¼š $ ls -l example/sample_data/dbt/ total 184 -rw-rw-r-- 1 w w 5320 May 15 07:17 catalog.json -rw-rw-r-- 1 w w 177163 May 15 07:17 manifest.json æˆ‘å†™çš„è¿™ä¸ªç¤ºä¾‹çš„åŠ è½½ä¾‹å­å¦‚ä¸‹ï¼š python3 example/scripts/sample_dbt_loader_nebula.py å…¶ä¸­ä¸»è¦çš„ä»£ç å¦‚ä¸‹ï¼š # part 1: Dbt manifest --\u003e CSV --\u003e Nebula Graph job = DefaultJob( conf=job_config, task=DefaultTask( extractor=DbtExtractor(), loader=FsNebulaCSVLoader()), publisher=NebulaCsvPublisher()) ... # part 2: Metadata stored in NebulaGraph --\u003e Elasticsearch extractor = NebulaSearchDataExtractor() task = SearchMetadatatoElasticasearchTask(extractor=extractor) job = DefaultJob(conf=job_config, task=task) å®ƒå’Œ Postgres å…ƒæ•°æ® ETL çš„å”¯ä¸€åŒºåˆ«æ˜¯ extractor=DbtExtractor()ï¼Œå®ƒå¸¦æœ‰ä»¥ä¸‹é…ç½®ä»¥è·å–æœ‰å…³ dbt é¡¹ç›®çš„ä»¥ä¸‹ä¿¡æ¯ï¼š æ•°æ®åº“åç§° ç›®å½•_json manifest_json job_config = ConfigFactory.from_dict({ 'extractor.dbt.database_name': database_name, 'extractor.dbt.catalog_json': catalog_file_loc, # File 'extractor.dbt.manifest_json': json.dumps(manifest_data), # JSON Dumped objecy 'extractor.dbt.source_url': source_url}) 4.2.2 éªŒè¯ dbt æŠ“å–ç»“æœæœç´¢ dbt_demo æˆ–è€…ç›´æ¥è®¿é—® http://localhost:5000/table_detail/dbt_demo/snowflake/public/raw_inventory_valueï¼Œå¯ä»¥çœ‹åˆ° å°æç¤ºï¼šæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¯ç”¨ DEBUG log çº§åˆ«å»çœ‹å·²å‘é€åˆ° Elasticsearch å’Œ NebulaGraph çš„å†…å®¹ã€‚ - logging.basicConfig(level=logging.INFO) + logging.basicConfig(level=logging.DEBUG) æˆ–è€…ï¼Œåœ¨ NebulaStudio ä¸­æ¢ç´¢å¯¼å…¥çš„æ•°æ®ï¼š é¦–å…ˆï¼Œç‚¹å‡» â€œStart with Verticesâ€ï¼Œå¡«å†™é¡¶ç‚¹ vidï¼šsnowflake://dbt_demo.public/fact_warehouse_inventory ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é¡¶ç‚¹æ˜¾ç¤ºä¸ºç²‰çº¢è‰²çš„ç‚¹ã€‚ è®©æˆ‘ä»¬ä¿®æ”¹ Expand / â€æ‹“å±•â€œé€‰é¡¹ï¼š æ–¹å‘ï¼šåŒå‘ æ­¥æ•°ï¼šå•å‘ã€ä¸‰æ­¥ å¹¶åŒå‡»é¡¶ç‚¹ï¼ˆç‚¹ï¼‰ï¼Œå®ƒå°†åŒå‘æ‹“å±• 3 æ­¥ï¼š ä»ä¸Šè¾¹è¿™ä¸ªæˆªå›¾é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨å¯è§†åŒ–ä¹‹åçš„å›¾æ•°æ®åº“ä¸­ï¼Œè¿™äº›å…ƒæ•°æ®å¯ä»¥å¾ˆå®¹æ˜“è¢«æŸ¥çœ‹ã€åˆ†æï¼Œå¹¶ä»ä¸­è·å¾—æ´å¯Ÿã€‚ å°è´´å£«ï¼Œæ‚¨å¯ä»¥ç‚¹å‡» ğŸ‘ å›¾æ ‡é€‰æ‹©ä¸€äº›è¦æ˜¾ç¤ºçš„å±æ€§ï¼Œæˆ‘åœ¨æˆªå›¾ä¹‹å‰å°±æ˜¯é€šè¿‡å®ƒè®©ä¸€äº›ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥çš„ã€‚ è€Œä¸”ï¼Œæˆ‘ä»¬åœ¨ NebulaStudio ä¸­çœ‹åˆ°çš„ä¹Ÿä¸ Amundsen å…ƒæ•°æ®æœåŠ¡çš„æ•°æ®æ¨¡å‹ç›¸å‘¼åº”ï¼š æœ€åï¼Œè¯·è®°ä½æˆ‘ä»¬æ›¾åˆ©ç”¨ dbt æ¥è½¬æ¢meltano ä¸­çš„ä¸€äº›æ•°æ®ï¼Œå¹¶ä¸”æ¸…å•æ–‡ä»¶è·¯å¾„æ˜¯.meltano/transformers/dbt/target/catalog.jsonï¼Œæ‚¨å¯ä»¥å°è¯•åˆ›å»ºä¸€ä¸ªæ•°æ®æ„å»ºå™¨ä½œä¸šæ¥å¯¼å…¥å®ƒã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:2","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#éªŒè¯-dbt-æŠ“å–ç»“æœ"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.3 æå– Superset ä¸­çš„å…ƒæ•°æ®Amundsen çš„ Superset extractor å¯ä»¥è·å– Dashboard å…ƒæ•°æ®æŠ½å– https://www.amundsen.io/amundsen/databuilder/databuilder/extractor/dashboard/apache_superset/apache_superset_metadata_extractor.py å›¾è¡¨å…ƒæ•°æ®æŠ½å– https://www.amundsen.io/amundsen/databuilder/databuilder /extractor/dashboard/apache_superset/apache_superset_chart_extractor.py Superset å…ƒç´ ä¸æ•°æ®æºï¼ˆè¡¨ï¼‰çš„å…³ç³»æŠ½å– https://www.amundsen.io/amundsen/databuilder/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py å’±ä»¬ç°åœ¨å°±å°è¯•æ‘„å–ä¹‹å‰åˆ›å»ºçš„ Superset Dashboard çš„å…ƒæ•°æ®ã€‚ 4.3.1 Superset å…ƒæ•°æ® ETL çš„æ‰§è¡Œä¸‹è¾¹æ‰§è¡Œçš„ç¤ºä¾‹ Superset æå–è„šæœ¬å¯ä»¥ä»ä¸­è·å–æ•°æ®å¹¶å°†å…ƒæ•°æ®åŠ è½½åˆ° NebulaGraph å’Œ Elasticsearch ä¸­ã€‚ python3 sample_superset_data_loader_nebula.py å¦‚æœæˆ‘ä»¬å°†æ—¥å¿—è®°å½•çº§åˆ«è®¾ç½®ä¸ºâ€œDEBUGâ€ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥çœ‹åˆ°è¿™äº›ä¸­é—´çš„è¿‡ç¨‹æ—¥å¿—ï¼š # fetching metadata from superset DEBUG:urllib3.connectionpool:http://localhost:8088 \"POST /api/v1/security/login HTTP/1.1\" 200 280 INFO:databuilder.task.task:Running a task DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8088 DEBUG:urllib3.connectionpool:http://localhost:8088 \"GET /api/v1/dashboard?q=(page_size:20,page:0,order_direction:desc) HTTP/1.1\" 308 374 DEBUG:urllib3.connectionpool:http://localhost:8088 \"GET /api/v1/dashboard/?q=(page_size:20,page:0,order_direction:desc) HTTP/1.1\" 200 1058 ... # insert Dashboard DEBUG:databuilder.publisher.nebula_csv_publisher:Query: INSERT VERTEX `Dashboard` (`dashboard_url`, `name`, published_tag, publisher_last_updated_epoch_ms) VALUES \"superset_dashboard://my_cluster.1/3\":(\"http://localhost:8088/superset/dashboard/3/\",\"my_dashboard\",\"unique_tag\",timestamp()); ... # insert a DASHBOARD_WITH_TABLE relationship/edge INFO:databuilder.publisher.nebula_csv_publisher:Importing data in edge files: ['/tmp/amundsen/dashboard/relationships/Dashboard_Table_DASHBOARD_WITH_TABLE.csv'] DEBUG:databuilder.publisher.nebula_csv_publisher:Query: INSERT edge `DASHBOARD_WITH_TABLE` (`END_LABEL`, `START_LABEL`, published_tag, publisher_last_updated_epoch_ms) VALUES \"superset_dashboard://my_cluster.1/3\"-\u003e\"postgresql+psycopg2://my_cluster.warehouse/orders\":(\"Table\",\"Dashboard\",\"unique_tag\", timestamp()), \"superset_dashboard://my_cluster.1/3\"-\u003e\"postgresql+psycopg2://my_cluster.warehouse/customers\":(\"Table\",\"Dashboard\",\"unique_tag\", timestamp()); 4.3.2 éªŒè¯ Superset Dashboard å…ƒæ•°æ®é€šè¿‡åœ¨ Amundsen ä¸­æœç´¢å®ƒï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥è·å¾— Dashboard ä¿¡æ¯ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥ä» NebulaStudio è¿›è¡ŒéªŒè¯ã€‚ æ³¨ï¼šå¯ä»¥å‚é˜… Dashboard æŠ“å–æŒ‡å— ä¸­çš„ Amundsen Dashboard å›¾å»ºæ¨¡ï¼š ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:3","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æå–-superset-ä¸­çš„å…ƒæ•°æ®"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.3 æå– Superset ä¸­çš„å…ƒæ•°æ®Amundsen çš„ Superset extractor å¯ä»¥è·å– Dashboard å…ƒæ•°æ®æŠ½å– https://www.amundsen.io/amundsen/databuilder/databuilder/extractor/dashboard/apache_superset/apache_superset_metadata_extractor.py å›¾è¡¨å…ƒæ•°æ®æŠ½å– https://www.amundsen.io/amundsen/databuilder/databuilder /extractor/dashboard/apache_superset/apache_superset_chart_extractor.py Superset å…ƒç´ ä¸æ•°æ®æºï¼ˆè¡¨ï¼‰çš„å…³ç³»æŠ½å– https://www.amundsen.io/amundsen/databuilder/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py å’±ä»¬ç°åœ¨å°±å°è¯•æ‘„å–ä¹‹å‰åˆ›å»ºçš„ Superset Dashboard çš„å…ƒæ•°æ®ã€‚ 4.3.1 Superset å…ƒæ•°æ® ETL çš„æ‰§è¡Œä¸‹è¾¹æ‰§è¡Œçš„ç¤ºä¾‹ Superset æå–è„šæœ¬å¯ä»¥ä»ä¸­è·å–æ•°æ®å¹¶å°†å…ƒæ•°æ®åŠ è½½åˆ° NebulaGraph å’Œ Elasticsearch ä¸­ã€‚ python3 sample_superset_data_loader_nebula.py å¦‚æœæˆ‘ä»¬å°†æ—¥å¿—è®°å½•çº§åˆ«è®¾ç½®ä¸ºâ€œDEBUGâ€ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥çœ‹åˆ°è¿™äº›ä¸­é—´çš„è¿‡ç¨‹æ—¥å¿—ï¼š # fetching metadata from superset DEBUG:urllib3.connectionpool:http://localhost:8088 \"POST /api/v1/security/login HTTP/1.1\" 200 280 INFO:databuilder.task.task:Running a task DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8088 DEBUG:urllib3.connectionpool:http://localhost:8088 \"GET /api/v1/dashboard?q=(page_size:20,page:0,order_direction:desc) HTTP/1.1\" 308 374 DEBUG:urllib3.connectionpool:http://localhost:8088 \"GET /api/v1/dashboard/?q=(page_size:20,page:0,order_direction:desc) HTTP/1.1\" 200 1058 ... # insert Dashboard DEBUG:databuilder.publisher.nebula_csv_publisher:Query: INSERT VERTEX `Dashboard` (`dashboard_url`, `name`, published_tag, publisher_last_updated_epoch_ms) VALUES \"superset_dashboard://my_cluster.1/3\":(\"http://localhost:8088/superset/dashboard/3/\",\"my_dashboard\",\"unique_tag\",timestamp()); ... # insert a DASHBOARD_WITH_TABLE relationship/edge INFO:databuilder.publisher.nebula_csv_publisher:Importing data in edge files: ['/tmp/amundsen/dashboard/relationships/Dashboard_Table_DASHBOARD_WITH_TABLE.csv'] DEBUG:databuilder.publisher.nebula_csv_publisher:Query: INSERT edge `DASHBOARD_WITH_TABLE` (`END_LABEL`, `START_LABEL`, published_tag, publisher_last_updated_epoch_ms) VALUES \"superset_dashboard://my_cluster.1/3\"-\u003e\"postgresql+psycopg2://my_cluster.warehouse/orders\":(\"Table\",\"Dashboard\",\"unique_tag\", timestamp()), \"superset_dashboard://my_cluster.1/3\"-\u003e\"postgresql+psycopg2://my_cluster.warehouse/customers\":(\"Table\",\"Dashboard\",\"unique_tag\", timestamp()); 4.3.2 éªŒè¯ Superset Dashboard å…ƒæ•°æ®é€šè¿‡åœ¨ Amundsen ä¸­æœç´¢å®ƒï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥è·å¾— Dashboard ä¿¡æ¯ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥ä» NebulaStudio è¿›è¡ŒéªŒè¯ã€‚ æ³¨ï¼šå¯ä»¥å‚é˜… Dashboard æŠ“å–æŒ‡å— ä¸­çš„ Amundsen Dashboard å›¾å»ºæ¨¡ï¼š ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:3","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#superset-å…ƒæ•°æ®-etl-çš„æ‰§è¡Œ"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.3 æå– Superset ä¸­çš„å…ƒæ•°æ®Amundsen çš„ Superset extractor å¯ä»¥è·å– Dashboard å…ƒæ•°æ®æŠ½å– https://www.amundsen.io/amundsen/databuilder/databuilder/extractor/dashboard/apache_superset/apache_superset_metadata_extractor.py å›¾è¡¨å…ƒæ•°æ®æŠ½å– https://www.amundsen.io/amundsen/databuilder/databuilder /extractor/dashboard/apache_superset/apache_superset_chart_extractor.py Superset å…ƒç´ ä¸æ•°æ®æºï¼ˆè¡¨ï¼‰çš„å…³ç³»æŠ½å– https://www.amundsen.io/amundsen/databuilder/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py å’±ä»¬ç°åœ¨å°±å°è¯•æ‘„å–ä¹‹å‰åˆ›å»ºçš„ Superset Dashboard çš„å…ƒæ•°æ®ã€‚ 4.3.1 Superset å…ƒæ•°æ® ETL çš„æ‰§è¡Œä¸‹è¾¹æ‰§è¡Œçš„ç¤ºä¾‹ Superset æå–è„šæœ¬å¯ä»¥ä»ä¸­è·å–æ•°æ®å¹¶å°†å…ƒæ•°æ®åŠ è½½åˆ° NebulaGraph å’Œ Elasticsearch ä¸­ã€‚ python3 sample_superset_data_loader_nebula.py å¦‚æœæˆ‘ä»¬å°†æ—¥å¿—è®°å½•çº§åˆ«è®¾ç½®ä¸ºâ€œDEBUGâ€ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥çœ‹åˆ°è¿™äº›ä¸­é—´çš„è¿‡ç¨‹æ—¥å¿—ï¼š # fetching metadata from superset DEBUG:urllib3.connectionpool:http://localhost:8088 \"POST /api/v1/security/login HTTP/1.1\" 200 280 INFO:databuilder.task.task:Running a task DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): localhost:8088 DEBUG:urllib3.connectionpool:http://localhost:8088 \"GET /api/v1/dashboard?q=(page_size:20,page:0,order_direction:desc) HTTP/1.1\" 308 374 DEBUG:urllib3.connectionpool:http://localhost:8088 \"GET /api/v1/dashboard/?q=(page_size:20,page:0,order_direction:desc) HTTP/1.1\" 200 1058 ... # insert Dashboard DEBUG:databuilder.publisher.nebula_csv_publisher:Query: INSERT VERTEX `Dashboard` (`dashboard_url`, `name`, published_tag, publisher_last_updated_epoch_ms) VALUES \"superset_dashboard://my_cluster.1/3\":(\"http://localhost:8088/superset/dashboard/3/\",\"my_dashboard\",\"unique_tag\",timestamp()); ... # insert a DASHBOARD_WITH_TABLE relationship/edge INFO:databuilder.publisher.nebula_csv_publisher:Importing data in edge files: ['/tmp/amundsen/dashboard/relationships/Dashboard_Table_DASHBOARD_WITH_TABLE.csv'] DEBUG:databuilder.publisher.nebula_csv_publisher:Query: INSERT edge `DASHBOARD_WITH_TABLE` (`END_LABEL`, `START_LABEL`, published_tag, publisher_last_updated_epoch_ms) VALUES \"superset_dashboard://my_cluster.1/3\"-\u003e\"postgresql+psycopg2://my_cluster.warehouse/orders\":(\"Table\",\"Dashboard\",\"unique_tag\", timestamp()), \"superset_dashboard://my_cluster.1/3\"-\u003e\"postgresql+psycopg2://my_cluster.warehouse/customers\":(\"Table\",\"Dashboard\",\"unique_tag\", timestamp()); 4.3.2 éªŒè¯ Superset Dashboard å…ƒæ•°æ®é€šè¿‡åœ¨ Amundsen ä¸­æœç´¢å®ƒï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥è·å¾— Dashboard ä¿¡æ¯ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥ä» NebulaStudio è¿›è¡ŒéªŒè¯ã€‚ æ³¨ï¼šå¯ä»¥å‚é˜… Dashboard æŠ“å–æŒ‡å— ä¸­çš„ Amundsen Dashboard å›¾å»ºæ¨¡ï¼š ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:3","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#éªŒè¯-superset-dashboard-å…ƒæ•°æ®"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.4 ç”¨ Superset é¢„è§ˆæ•°æ®Supersetå¯ä»¥ç”¨æ¥é¢„è§ˆè¿™æ ·çš„è¡¨æ ¼æ•°æ®ã€‚ ç›¸åº”çš„æ–‡æ¡£å¯ä»¥å‚è€ƒ https://www.amundsen.io/amundsen/frontend/docs/configuration/#preview-client ï¼Œå…¶ä¸­ /superset/sql_json/ çš„ API è¢« Amundsen Frontend service è°ƒç”¨ï¼Œå–å¾—é¢„è§ˆä¿¡æ¯ã€‚ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:4","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#ç”¨-superset-é¢„è§ˆæ•°æ®"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.5 å¼€å¯æ•°æ®è¡€ç¼˜ä¿¡æ¯é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®è¡€ç¼˜æ˜¯å…³é—­çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¯ç”¨å®ƒï¼š cd åˆ° Amundsen ä»£ç ä»“åº“ä¸‹ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿è¡Œ docker-compose -f docker-amundsen-nebula.yml up å‘½ä»¤çš„åœ°æ–¹ cd amundsen ä¿®æ”¹ frontend ä¸‹çš„ typescript é…ç½® --- a/frontend/amundsen_application/static/js/config/config-default.ts +++ b/frontend/amundsen_application/static/js/config/config-default.ts tableLineage: { - inAppListEnabled: false, - inAppPageEnabled: false, + inAppListEnabled: true, + inAppPageEnabled: true, externalEnabled: false, iconPath: 'PATH_TO_ICON', isBeta: false, é‡æ–°æ„å»º docker é•œåƒï¼Œå…¶ä¸­å°†é‡å»ºå‰ç«¯å›¾åƒã€‚ docker-compose -f docker-amundsen-nebula.yml build ç„¶åï¼Œé‡æ–°è¿è¡Œ up -d ä»¥ç¡®ä¿å‰ç«¯ç”¨æ–°çš„é…ç½®ï¼š docker-compose -f docker-amundsen-nebula.yml up -d ç»“æœå¤§æ¦‚é•¿è¿™æ ·å­ï¼š $ docker-compose -f docker-amundsen-nebula.yml up -d ... Recreating amundsenfrontend ... done ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—® http://localhost:5000/lineage/table/gold/hive/test_schema/test_table1 çœ‹åˆ° Lineage ï¼ˆbetaï¼‰ è¡€ç¼˜æŒ‰é’®å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†ï¼š æˆ‘ä»¬å¯ä»¥ç‚¹å‡» Downstream åœ¨å­˜åœ¨çš„æ—¶å€™æŸ¥çœ‹è¯¥è¡¨çš„ä¸‹æ¸¸èµ„æºï¼š æˆ–è€…ç‚¹è¡€ç¼˜æŒ‰é’®æŸ¥çœ‹è¡€ç¼˜çš„å›¾è¡¨å¼ï¼š ä¹Ÿæœ‰ç”¨äºè¡€ç¼˜æŸ¥è¯¢çš„ APIã€‚ è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ç”¨ cURL è°ƒç”¨ä¸‹è¿™ä¸ª APIï¼š docker run -it --rm --net container:amundsenfrontend nicolaka/netshoot curl \"http://amundsenmetadata:5002/table/snowflake://dbt_demo.public/raw_inventory_value/lineage?depth=3\u0026direction=both\" ä¸Šé¢çš„ API è°ƒç”¨æ˜¯æŸ¥è¯¢ä¸Šæ¸¸å’Œä¸‹æ¸¸æ–¹å‘çš„ linageï¼Œè¡¨ snowflake://dbt_demo.public/raw_inventory_value çš„æ·±åº¦ä¸º 3ã€‚ ç»“æœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š { \"depth\": 3, \"downstream_entities\": [ { \"level\": 2, \"usage\": 0, \"key\": \"snowflake://dbt_demo.public/fact_daily_expenses\", \"parent\": \"snowflake://dbt_demo.public/fact_warehouse_inventory\", \"badges\": [], \"source\": \"snowflake\" }, { \"level\": 1, \"usage\": 0, \"key\": \"snowflake://dbt_demo.public/fact_warehouse_inventory\", \"parent\": \"snowflake://dbt_demo.public/raw_inventory_value\", \"badges\": [], \"source\": \"snowflake\" } ], \"key\": \"snowflake://dbt_demo.public/raw_inventory_value\", \"direction\": \"both\", \"upstream_entities\": [] } å®é™…ä¸Šï¼Œè¿™ä¸ªè¡€ç¼˜æ•°æ®å°±æ˜¯åœ¨æˆ‘ä»¬çš„ DbtExtractor æ‰§è¡ŒæœŸé—´æå–å’ŒåŠ è½½çš„ï¼Œå…¶ä¸­ extractor .dbt.{DbtExtractor.EXTRACT_LINEAGE} é»˜è®¤ä¸º Trueï¼Œå› æ­¤åˆ›å»ºäº†è¡€ç¼˜å…ƒæ•°æ®å¹¶å°†å…¶åŠ è½½åˆ°äº† Amundsenã€‚ 4.5.1 åœ¨ NebulaGraph ä¸­æ´å¯Ÿè¡€ç¼˜ä½¿ç”¨å›¾æ•°æ®åº“ä½œä¸ºå…ƒæ•°æ®å­˜å‚¨çš„ä¸¤ä¸ªä¼˜ç‚¹æ˜¯ï¼š å›¾æŸ¥è¯¢æœ¬èº«æ˜¯ä¸€ä¸ªçµæ´»çš„ DSL for lineage APIï¼Œä¾‹å¦‚ï¼Œè¿™ä¸ªæŸ¥è¯¢å¸®åŠ©æˆ‘ä»¬æ‰§è¡Œ Amundsen å…ƒæ•°æ® API çš„ç­‰ä»·çš„æŸ¥è¯¢ï¼š MATCH p=(t:`Table`) -[:`HAS_UPSTREAM`|:`HAS_DOWNSTREAM` *1..3]-\u003e(x) WHERE id(t) == \"snowflake://dbt_demo.public/raw_inventory_value\" RETURN p æˆ‘ä»¬ç°åœ¨ç”šè‡³å¯ä»¥åœ¨ NebulaGraph Studio æˆ–è€… Explorer çš„æ§åˆ¶å°ä¸­æŸ¥è¯¢å®ƒ â€‹ ç„¶åæ¸²æŸ“è¿™ä¸ªç»“æœï¼š 4.5.2 æå–æ•°æ®è¡€ç¼˜è¿™äº›è¡€ç¼˜ä¿¡æ¯æ˜¯éœ€è¦æˆ‘ä»¬æ˜ç¡®æŒ‡å®šã€è·å–çš„ï¼Œè·å–çš„æ–¹å¼å¯ä»¥æ˜¯è‡ªå·±å†™çš„ extractorï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€äº›å·²ç»æœ‰çš„æ–¹å¼ã€‚æ¯”å¦‚ dbt çš„ extractorå’Œ Open Lineage é¡¹ç›®çš„ Amundsen extractorã€‚ 4.5.2.1 é€šè¿‡ dbtè¿™ä¸ªåœ¨åˆšæ‰å·²ç»å±•ç¤ºè¿‡äº†ï¼ŒDbt çš„ Extractor ä¼šä»è¡¨çº§åˆ«è·å–è¡€ç¼˜å’Œå…¶ä»– dbt ä¸­äº§ç”Ÿçš„å…ƒæ•°æ®ä¿¡æ¯ä¸€èµ·è¢«æ‹¿åˆ°ã€‚ 4.5.2.2 é€šè¿‡ Open LineageAmundsen ä¸­çš„å¦ä¸€ä¸ªå¼€ç®±å³ç”¨çš„è¡€ç¼˜ Extractor æ˜¯ OpenLineageTableLineageExtractorã€‚ Open Lineage æ˜¯ä¸€ä¸ªå¼€æ”¾çš„æ¡†æ¶ï¼Œå¯ä»¥å°†ä¸åŒæ¥æºçš„è¡€ç»Ÿæ•°æ®æ”¶é›†åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œå®ƒå¯ä»¥å°†è¡€ç»Ÿä¿¡æ¯è¾“å‡ºä¸º JSON æ–‡ä»¶ï¼šhttps://www.amundsen.io/amundsen/databuilder/#openlineagetablelineageextractor ä¸‹è¾¹æ˜¯å®ƒçš„ Amundsen data builder ä¾‹å­ï¼š dict_config = { # ... f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.CLUSTER_NAME}': 'datalab', f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.OL_DATASET_NAMESPACE_OVERRIDE}': 'hive_table', f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.TABLE_LINEAGE_FILE_LOCATION}': 'input_dir/openlineage_nd.json', } ... task = DefaultTask( extractor=OpenLineageTableLineageExtractor(), loader=FsNebulaCSVLoader()) ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:5","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#å¼€å¯æ•°æ®è¡€ç¼˜ä¿¡æ¯"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.5 å¼€å¯æ•°æ®è¡€ç¼˜ä¿¡æ¯é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®è¡€ç¼˜æ˜¯å…³é—­çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¯ç”¨å®ƒï¼š cd åˆ° Amundsen ä»£ç ä»“åº“ä¸‹ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿è¡Œ docker-compose -f docker-amundsen-nebula.yml up å‘½ä»¤çš„åœ°æ–¹ cd amundsen ä¿®æ”¹ frontend ä¸‹çš„ typescript é…ç½® --- a/frontend/amundsen_application/static/js/config/config-default.ts +++ b/frontend/amundsen_application/static/js/config/config-default.ts tableLineage: { - inAppListEnabled: false, - inAppPageEnabled: false, + inAppListEnabled: true, + inAppPageEnabled: true, externalEnabled: false, iconPath: 'PATH_TO_ICON', isBeta: false, é‡æ–°æ„å»º docker é•œåƒï¼Œå…¶ä¸­å°†é‡å»ºå‰ç«¯å›¾åƒã€‚ docker-compose -f docker-amundsen-nebula.yml build ç„¶åï¼Œé‡æ–°è¿è¡Œ up -d ä»¥ç¡®ä¿å‰ç«¯ç”¨æ–°çš„é…ç½®ï¼š docker-compose -f docker-amundsen-nebula.yml up -d ç»“æœå¤§æ¦‚é•¿è¿™æ ·å­ï¼š $ docker-compose -f docker-amundsen-nebula.yml up -d ... Recreating amundsenfrontend ... done ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—® http://localhost:5000/lineage/table/gold/hive/test_schema/test_table1 çœ‹åˆ° Lineage ï¼ˆbetaï¼‰ è¡€ç¼˜æŒ‰é’®å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†ï¼š æˆ‘ä»¬å¯ä»¥ç‚¹å‡» Downstream åœ¨å­˜åœ¨çš„æ—¶å€™æŸ¥çœ‹è¯¥è¡¨çš„ä¸‹æ¸¸èµ„æºï¼š æˆ–è€…ç‚¹è¡€ç¼˜æŒ‰é’®æŸ¥çœ‹è¡€ç¼˜çš„å›¾è¡¨å¼ï¼š ä¹Ÿæœ‰ç”¨äºè¡€ç¼˜æŸ¥è¯¢çš„ APIã€‚ è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ç”¨ cURL è°ƒç”¨ä¸‹è¿™ä¸ª APIï¼š docker run -it --rm --net container:amundsenfrontend nicolaka/netshoot curl \"http://amundsenmetadata:5002/table/snowflake://dbt_demo.public/raw_inventory_value/lineage?depth=3\u0026direction=both\" ä¸Šé¢çš„ API è°ƒç”¨æ˜¯æŸ¥è¯¢ä¸Šæ¸¸å’Œä¸‹æ¸¸æ–¹å‘çš„ linageï¼Œè¡¨ snowflake://dbt_demo.public/raw_inventory_value çš„æ·±åº¦ä¸º 3ã€‚ ç»“æœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š { \"depth\": 3, \"downstream_entities\": [ { \"level\": 2, \"usage\": 0, \"key\": \"snowflake://dbt_demo.public/fact_daily_expenses\", \"parent\": \"snowflake://dbt_demo.public/fact_warehouse_inventory\", \"badges\": [], \"source\": \"snowflake\" }, { \"level\": 1, \"usage\": 0, \"key\": \"snowflake://dbt_demo.public/fact_warehouse_inventory\", \"parent\": \"snowflake://dbt_demo.public/raw_inventory_value\", \"badges\": [], \"source\": \"snowflake\" } ], \"key\": \"snowflake://dbt_demo.public/raw_inventory_value\", \"direction\": \"both\", \"upstream_entities\": [] } å®é™…ä¸Šï¼Œè¿™ä¸ªè¡€ç¼˜æ•°æ®å°±æ˜¯åœ¨æˆ‘ä»¬çš„ DbtExtractor æ‰§è¡ŒæœŸé—´æå–å’ŒåŠ è½½çš„ï¼Œå…¶ä¸­ extractor .dbt.{DbtExtractor.EXTRACT_LINEAGE} é»˜è®¤ä¸º Trueï¼Œå› æ­¤åˆ›å»ºäº†è¡€ç¼˜å…ƒæ•°æ®å¹¶å°†å…¶åŠ è½½åˆ°äº† Amundsenã€‚ 4.5.1 åœ¨ NebulaGraph ä¸­æ´å¯Ÿè¡€ç¼˜ä½¿ç”¨å›¾æ•°æ®åº“ä½œä¸ºå…ƒæ•°æ®å­˜å‚¨çš„ä¸¤ä¸ªä¼˜ç‚¹æ˜¯ï¼š å›¾æŸ¥è¯¢æœ¬èº«æ˜¯ä¸€ä¸ªçµæ´»çš„ DSL for lineage APIï¼Œä¾‹å¦‚ï¼Œè¿™ä¸ªæŸ¥è¯¢å¸®åŠ©æˆ‘ä»¬æ‰§è¡Œ Amundsen å…ƒæ•°æ® API çš„ç­‰ä»·çš„æŸ¥è¯¢ï¼š MATCH p=(t:`Table`) -[:`HAS_UPSTREAM`|:`HAS_DOWNSTREAM` *1..3]-\u003e(x) WHERE id(t) == \"snowflake://dbt_demo.public/raw_inventory_value\" RETURN p æˆ‘ä»¬ç°åœ¨ç”šè‡³å¯ä»¥åœ¨ NebulaGraph Studio æˆ–è€… Explorer çš„æ§åˆ¶å°ä¸­æŸ¥è¯¢å®ƒ â€‹ ç„¶åæ¸²æŸ“è¿™ä¸ªç»“æœï¼š 4.5.2 æå–æ•°æ®è¡€ç¼˜è¿™äº›è¡€ç¼˜ä¿¡æ¯æ˜¯éœ€è¦æˆ‘ä»¬æ˜ç¡®æŒ‡å®šã€è·å–çš„ï¼Œè·å–çš„æ–¹å¼å¯ä»¥æ˜¯è‡ªå·±å†™çš„ extractorï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€äº›å·²ç»æœ‰çš„æ–¹å¼ã€‚æ¯”å¦‚ dbt çš„ extractorå’Œ Open Lineage é¡¹ç›®çš„ Amundsen extractorã€‚ 4.5.2.1 é€šè¿‡ dbtè¿™ä¸ªåœ¨åˆšæ‰å·²ç»å±•ç¤ºè¿‡äº†ï¼ŒDbt çš„ Extractor ä¼šä»è¡¨çº§åˆ«è·å–è¡€ç¼˜å’Œå…¶ä»– dbt ä¸­äº§ç”Ÿçš„å…ƒæ•°æ®ä¿¡æ¯ä¸€èµ·è¢«æ‹¿åˆ°ã€‚ 4.5.2.2 é€šè¿‡ Open LineageAmundsen ä¸­çš„å¦ä¸€ä¸ªå¼€ç®±å³ç”¨çš„è¡€ç¼˜ Extractor æ˜¯ OpenLineageTableLineageExtractorã€‚ Open Lineage æ˜¯ä¸€ä¸ªå¼€æ”¾çš„æ¡†æ¶ï¼Œå¯ä»¥å°†ä¸åŒæ¥æºçš„è¡€ç»Ÿæ•°æ®æ”¶é›†åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œå®ƒå¯ä»¥å°†è¡€ç»Ÿä¿¡æ¯è¾“å‡ºä¸º JSON æ–‡ä»¶ï¼šhttps://www.amundsen.io/amundsen/databuilder/#openlineagetablelineageextractor ä¸‹è¾¹æ˜¯å®ƒçš„ Amundsen data builder ä¾‹å­ï¼š dict_config = { # ... f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.CLUSTER_NAME}': 'datalab', f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.OL_DATASET_NAMESPACE_OVERRIDE}': 'hive_table', f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.TABLE_LINEAGE_FILE_LOCATION}': 'input_dir/openlineage_nd.json', } ... task = DefaultTask( extractor=OpenLineageTableLineageExtractor(), loader=FsNebulaCSVLoader()) ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:5","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#åœ¨-nebulagraph-ä¸­æ´å¯Ÿè¡€ç¼˜"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.5 å¼€å¯æ•°æ®è¡€ç¼˜ä¿¡æ¯é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®è¡€ç¼˜æ˜¯å…³é—­çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¯ç”¨å®ƒï¼š cd åˆ° Amundsen ä»£ç ä»“åº“ä¸‹ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿è¡Œ docker-compose -f docker-amundsen-nebula.yml up å‘½ä»¤çš„åœ°æ–¹ cd amundsen ä¿®æ”¹ frontend ä¸‹çš„ typescript é…ç½® --- a/frontend/amundsen_application/static/js/config/config-default.ts +++ b/frontend/amundsen_application/static/js/config/config-default.ts tableLineage: { - inAppListEnabled: false, - inAppPageEnabled: false, + inAppListEnabled: true, + inAppPageEnabled: true, externalEnabled: false, iconPath: 'PATH_TO_ICON', isBeta: false, é‡æ–°æ„å»º docker é•œåƒï¼Œå…¶ä¸­å°†é‡å»ºå‰ç«¯å›¾åƒã€‚ docker-compose -f docker-amundsen-nebula.yml build ç„¶åï¼Œé‡æ–°è¿è¡Œ up -d ä»¥ç¡®ä¿å‰ç«¯ç”¨æ–°çš„é…ç½®ï¼š docker-compose -f docker-amundsen-nebula.yml up -d ç»“æœå¤§æ¦‚é•¿è¿™æ ·å­ï¼š $ docker-compose -f docker-amundsen-nebula.yml up -d ... Recreating amundsenfrontend ... done ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—® http://localhost:5000/lineage/table/gold/hive/test_schema/test_table1 çœ‹åˆ° Lineage ï¼ˆbetaï¼‰ è¡€ç¼˜æŒ‰é’®å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†ï¼š æˆ‘ä»¬å¯ä»¥ç‚¹å‡» Downstream åœ¨å­˜åœ¨çš„æ—¶å€™æŸ¥çœ‹è¯¥è¡¨çš„ä¸‹æ¸¸èµ„æºï¼š æˆ–è€…ç‚¹è¡€ç¼˜æŒ‰é’®æŸ¥çœ‹è¡€ç¼˜çš„å›¾è¡¨å¼ï¼š ä¹Ÿæœ‰ç”¨äºè¡€ç¼˜æŸ¥è¯¢çš„ APIã€‚ è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ç”¨ cURL è°ƒç”¨ä¸‹è¿™ä¸ª APIï¼š docker run -it --rm --net container:amundsenfrontend nicolaka/netshoot curl \"http://amundsenmetadata:5002/table/snowflake://dbt_demo.public/raw_inventory_value/lineage?depth=3\u0026direction=both\" ä¸Šé¢çš„ API è°ƒç”¨æ˜¯æŸ¥è¯¢ä¸Šæ¸¸å’Œä¸‹æ¸¸æ–¹å‘çš„ linageï¼Œè¡¨ snowflake://dbt_demo.public/raw_inventory_value çš„æ·±åº¦ä¸º 3ã€‚ ç»“æœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š { \"depth\": 3, \"downstream_entities\": [ { \"level\": 2, \"usage\": 0, \"key\": \"snowflake://dbt_demo.public/fact_daily_expenses\", \"parent\": \"snowflake://dbt_demo.public/fact_warehouse_inventory\", \"badges\": [], \"source\": \"snowflake\" }, { \"level\": 1, \"usage\": 0, \"key\": \"snowflake://dbt_demo.public/fact_warehouse_inventory\", \"parent\": \"snowflake://dbt_demo.public/raw_inventory_value\", \"badges\": [], \"source\": \"snowflake\" } ], \"key\": \"snowflake://dbt_demo.public/raw_inventory_value\", \"direction\": \"both\", \"upstream_entities\": [] } å®é™…ä¸Šï¼Œè¿™ä¸ªè¡€ç¼˜æ•°æ®å°±æ˜¯åœ¨æˆ‘ä»¬çš„ DbtExtractor æ‰§è¡ŒæœŸé—´æå–å’ŒåŠ è½½çš„ï¼Œå…¶ä¸­ extractor .dbt.{DbtExtractor.EXTRACT_LINEAGE} é»˜è®¤ä¸º Trueï¼Œå› æ­¤åˆ›å»ºäº†è¡€ç¼˜å…ƒæ•°æ®å¹¶å°†å…¶åŠ è½½åˆ°äº† Amundsenã€‚ 4.5.1 åœ¨ NebulaGraph ä¸­æ´å¯Ÿè¡€ç¼˜ä½¿ç”¨å›¾æ•°æ®åº“ä½œä¸ºå…ƒæ•°æ®å­˜å‚¨çš„ä¸¤ä¸ªä¼˜ç‚¹æ˜¯ï¼š å›¾æŸ¥è¯¢æœ¬èº«æ˜¯ä¸€ä¸ªçµæ´»çš„ DSL for lineage APIï¼Œä¾‹å¦‚ï¼Œè¿™ä¸ªæŸ¥è¯¢å¸®åŠ©æˆ‘ä»¬æ‰§è¡Œ Amundsen å…ƒæ•°æ® API çš„ç­‰ä»·çš„æŸ¥è¯¢ï¼š MATCH p=(t:`Table`) -[:`HAS_UPSTREAM`|:`HAS_DOWNSTREAM` *1..3]-\u003e(x) WHERE id(t) == \"snowflake://dbt_demo.public/raw_inventory_value\" RETURN p æˆ‘ä»¬ç°åœ¨ç”šè‡³å¯ä»¥åœ¨ NebulaGraph Studio æˆ–è€… Explorer çš„æ§åˆ¶å°ä¸­æŸ¥è¯¢å®ƒ â€‹ ç„¶åæ¸²æŸ“è¿™ä¸ªç»“æœï¼š 4.5.2 æå–æ•°æ®è¡€ç¼˜è¿™äº›è¡€ç¼˜ä¿¡æ¯æ˜¯éœ€è¦æˆ‘ä»¬æ˜ç¡®æŒ‡å®šã€è·å–çš„ï¼Œè·å–çš„æ–¹å¼å¯ä»¥æ˜¯è‡ªå·±å†™çš„ extractorï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€äº›å·²ç»æœ‰çš„æ–¹å¼ã€‚æ¯”å¦‚ dbt çš„ extractorå’Œ Open Lineage é¡¹ç›®çš„ Amundsen extractorã€‚ 4.5.2.1 é€šè¿‡ dbtè¿™ä¸ªåœ¨åˆšæ‰å·²ç»å±•ç¤ºè¿‡äº†ï¼ŒDbt çš„ Extractor ä¼šä»è¡¨çº§åˆ«è·å–è¡€ç¼˜å’Œå…¶ä»– dbt ä¸­äº§ç”Ÿçš„å…ƒæ•°æ®ä¿¡æ¯ä¸€èµ·è¢«æ‹¿åˆ°ã€‚ 4.5.2.2 é€šè¿‡ Open LineageAmundsen ä¸­çš„å¦ä¸€ä¸ªå¼€ç®±å³ç”¨çš„è¡€ç¼˜ Extractor æ˜¯ OpenLineageTableLineageExtractorã€‚ Open Lineage æ˜¯ä¸€ä¸ªå¼€æ”¾çš„æ¡†æ¶ï¼Œå¯ä»¥å°†ä¸åŒæ¥æºçš„è¡€ç»Ÿæ•°æ®æ”¶é›†åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œå®ƒå¯ä»¥å°†è¡€ç»Ÿä¿¡æ¯è¾“å‡ºä¸º JSON æ–‡ä»¶ï¼šhttps://www.amundsen.io/amundsen/databuilder/#openlineagetablelineageextractor ä¸‹è¾¹æ˜¯å®ƒçš„ Amundsen data builder ä¾‹å­ï¼š dict_config = { # ... f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.CLUSTER_NAME}': 'datalab', f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.OL_DATASET_NAMESPACE_OVERRIDE}': 'hive_table', f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.TABLE_LINEAGE_FILE_LOCATION}': 'input_dir/openlineage_nd.json', } ... task = DefaultTask( extractor=OpenLineageTableLineageExtractor(), loader=FsNebulaCSVLoader()) ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:5","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æå–æ•°æ®è¡€ç¼˜"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.5 å¼€å¯æ•°æ®è¡€ç¼˜ä¿¡æ¯é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®è¡€ç¼˜æ˜¯å…³é—­çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¯ç”¨å®ƒï¼š cd åˆ° Amundsen ä»£ç ä»“åº“ä¸‹ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿è¡Œ docker-compose -f docker-amundsen-nebula.yml up å‘½ä»¤çš„åœ°æ–¹ cd amundsen ä¿®æ”¹ frontend ä¸‹çš„ typescript é…ç½® --- a/frontend/amundsen_application/static/js/config/config-default.ts +++ b/frontend/amundsen_application/static/js/config/config-default.ts tableLineage: { - inAppListEnabled: false, - inAppPageEnabled: false, + inAppListEnabled: true, + inAppPageEnabled: true, externalEnabled: false, iconPath: 'PATH_TO_ICON', isBeta: false, é‡æ–°æ„å»º docker é•œåƒï¼Œå…¶ä¸­å°†é‡å»ºå‰ç«¯å›¾åƒã€‚ docker-compose -f docker-amundsen-nebula.yml build ç„¶åï¼Œé‡æ–°è¿è¡Œ up -d ä»¥ç¡®ä¿å‰ç«¯ç”¨æ–°çš„é…ç½®ï¼š docker-compose -f docker-amundsen-nebula.yml up -d ç»“æœå¤§æ¦‚é•¿è¿™æ ·å­ï¼š $ docker-compose -f docker-amundsen-nebula.yml up -d ... Recreating amundsenfrontend ... done ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—® http://localhost:5000/lineage/table/gold/hive/test_schema/test_table1 çœ‹åˆ° Lineage ï¼ˆbetaï¼‰ è¡€ç¼˜æŒ‰é’®å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†ï¼š æˆ‘ä»¬å¯ä»¥ç‚¹å‡» Downstream åœ¨å­˜åœ¨çš„æ—¶å€™æŸ¥çœ‹è¯¥è¡¨çš„ä¸‹æ¸¸èµ„æºï¼š æˆ–è€…ç‚¹è¡€ç¼˜æŒ‰é’®æŸ¥çœ‹è¡€ç¼˜çš„å›¾è¡¨å¼ï¼š ä¹Ÿæœ‰ç”¨äºè¡€ç¼˜æŸ¥è¯¢çš„ APIã€‚ è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ç”¨ cURL è°ƒç”¨ä¸‹è¿™ä¸ª APIï¼š docker run -it --rm --net container:amundsenfrontend nicolaka/netshoot curl \"http://amundsenmetadata:5002/table/snowflake://dbt_demo.public/raw_inventory_value/lineage?depth=3\u0026direction=both\" ä¸Šé¢çš„ API è°ƒç”¨æ˜¯æŸ¥è¯¢ä¸Šæ¸¸å’Œä¸‹æ¸¸æ–¹å‘çš„ linageï¼Œè¡¨ snowflake://dbt_demo.public/raw_inventory_value çš„æ·±åº¦ä¸º 3ã€‚ ç»“æœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š { \"depth\": 3, \"downstream_entities\": [ { \"level\": 2, \"usage\": 0, \"key\": \"snowflake://dbt_demo.public/fact_daily_expenses\", \"parent\": \"snowflake://dbt_demo.public/fact_warehouse_inventory\", \"badges\": [], \"source\": \"snowflake\" }, { \"level\": 1, \"usage\": 0, \"key\": \"snowflake://dbt_demo.public/fact_warehouse_inventory\", \"parent\": \"snowflake://dbt_demo.public/raw_inventory_value\", \"badges\": [], \"source\": \"snowflake\" } ], \"key\": \"snowflake://dbt_demo.public/raw_inventory_value\", \"direction\": \"both\", \"upstream_entities\": [] } å®é™…ä¸Šï¼Œè¿™ä¸ªè¡€ç¼˜æ•°æ®å°±æ˜¯åœ¨æˆ‘ä»¬çš„ DbtExtractor æ‰§è¡ŒæœŸé—´æå–å’ŒåŠ è½½çš„ï¼Œå…¶ä¸­ extractor .dbt.{DbtExtractor.EXTRACT_LINEAGE} é»˜è®¤ä¸º Trueï¼Œå› æ­¤åˆ›å»ºäº†è¡€ç¼˜å…ƒæ•°æ®å¹¶å°†å…¶åŠ è½½åˆ°äº† Amundsenã€‚ 4.5.1 åœ¨ NebulaGraph ä¸­æ´å¯Ÿè¡€ç¼˜ä½¿ç”¨å›¾æ•°æ®åº“ä½œä¸ºå…ƒæ•°æ®å­˜å‚¨çš„ä¸¤ä¸ªä¼˜ç‚¹æ˜¯ï¼š å›¾æŸ¥è¯¢æœ¬èº«æ˜¯ä¸€ä¸ªçµæ´»çš„ DSL for lineage APIï¼Œä¾‹å¦‚ï¼Œè¿™ä¸ªæŸ¥è¯¢å¸®åŠ©æˆ‘ä»¬æ‰§è¡Œ Amundsen å…ƒæ•°æ® API çš„ç­‰ä»·çš„æŸ¥è¯¢ï¼š MATCH p=(t:`Table`) -[:`HAS_UPSTREAM`|:`HAS_DOWNSTREAM` *1..3]-\u003e(x) WHERE id(t) == \"snowflake://dbt_demo.public/raw_inventory_value\" RETURN p æˆ‘ä»¬ç°åœ¨ç”šè‡³å¯ä»¥åœ¨ NebulaGraph Studio æˆ–è€… Explorer çš„æ§åˆ¶å°ä¸­æŸ¥è¯¢å®ƒ â€‹ ç„¶åæ¸²æŸ“è¿™ä¸ªç»“æœï¼š 4.5.2 æå–æ•°æ®è¡€ç¼˜è¿™äº›è¡€ç¼˜ä¿¡æ¯æ˜¯éœ€è¦æˆ‘ä»¬æ˜ç¡®æŒ‡å®šã€è·å–çš„ï¼Œè·å–çš„æ–¹å¼å¯ä»¥æ˜¯è‡ªå·±å†™çš„ extractorï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€äº›å·²ç»æœ‰çš„æ–¹å¼ã€‚æ¯”å¦‚ dbt çš„ extractorå’Œ Open Lineage é¡¹ç›®çš„ Amundsen extractorã€‚ 4.5.2.1 é€šè¿‡ dbtè¿™ä¸ªåœ¨åˆšæ‰å·²ç»å±•ç¤ºè¿‡äº†ï¼ŒDbt çš„ Extractor ä¼šä»è¡¨çº§åˆ«è·å–è¡€ç¼˜å’Œå…¶ä»– dbt ä¸­äº§ç”Ÿçš„å…ƒæ•°æ®ä¿¡æ¯ä¸€èµ·è¢«æ‹¿åˆ°ã€‚ 4.5.2.2 é€šè¿‡ Open LineageAmundsen ä¸­çš„å¦ä¸€ä¸ªå¼€ç®±å³ç”¨çš„è¡€ç¼˜ Extractor æ˜¯ OpenLineageTableLineageExtractorã€‚ Open Lineage æ˜¯ä¸€ä¸ªå¼€æ”¾çš„æ¡†æ¶ï¼Œå¯ä»¥å°†ä¸åŒæ¥æºçš„è¡€ç»Ÿæ•°æ®æ”¶é›†åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œå®ƒå¯ä»¥å°†è¡€ç»Ÿä¿¡æ¯è¾“å‡ºä¸º JSON æ–‡ä»¶ï¼šhttps://www.amundsen.io/amundsen/databuilder/#openlineagetablelineageextractor ä¸‹è¾¹æ˜¯å®ƒçš„ Amundsen data builder ä¾‹å­ï¼š dict_config = { # ... f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.CLUSTER_NAME}': 'datalab', f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.OL_DATASET_NAMESPACE_OVERRIDE}': 'hive_table', f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.TABLE_LINEAGE_FILE_LOCATION}': 'input_dir/openlineage_nd.json', } ... task = DefaultTask( extractor=OpenLineageTableLineageExtractor(), loader=FsNebulaCSVLoader()) ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:5","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#é€šè¿‡-dbt"},{"categories":["Nebula Graph","Amundsen"],"content":" 4.5 å¼€å¯æ•°æ®è¡€ç¼˜ä¿¡æ¯é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®è¡€ç¼˜æ˜¯å…³é—­çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¯ç”¨å®ƒï¼š cd åˆ° Amundsen ä»£ç ä»“åº“ä¸‹ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿è¡Œ docker-compose -f docker-amundsen-nebula.yml up å‘½ä»¤çš„åœ°æ–¹ cd amundsen ä¿®æ”¹ frontend ä¸‹çš„ typescript é…ç½® --- a/frontend/amundsen_application/static/js/config/config-default.ts +++ b/frontend/amundsen_application/static/js/config/config-default.ts tableLineage: { - inAppListEnabled: false, - inAppPageEnabled: false, + inAppListEnabled: true, + inAppPageEnabled: true, externalEnabled: false, iconPath: 'PATH_TO_ICON', isBeta: false, é‡æ–°æ„å»º docker é•œåƒï¼Œå…¶ä¸­å°†é‡å»ºå‰ç«¯å›¾åƒã€‚ docker-compose -f docker-amundsen-nebula.yml build ç„¶åï¼Œé‡æ–°è¿è¡Œ up -d ä»¥ç¡®ä¿å‰ç«¯ç”¨æ–°çš„é…ç½®ï¼š docker-compose -f docker-amundsen-nebula.yml up -d ç»“æœå¤§æ¦‚é•¿è¿™æ ·å­ï¼š $ docker-compose -f docker-amundsen-nebula.yml up -d ... Recreating amundsenfrontend ... done ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—® http://localhost:5000/lineage/table/gold/hive/test_schema/test_table1 çœ‹åˆ° Lineage ï¼ˆbetaï¼‰ è¡€ç¼˜æŒ‰é’®å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†ï¼š æˆ‘ä»¬å¯ä»¥ç‚¹å‡» Downstream åœ¨å­˜åœ¨çš„æ—¶å€™æŸ¥çœ‹è¯¥è¡¨çš„ä¸‹æ¸¸èµ„æºï¼š æˆ–è€…ç‚¹è¡€ç¼˜æŒ‰é’®æŸ¥çœ‹è¡€ç¼˜çš„å›¾è¡¨å¼ï¼š ä¹Ÿæœ‰ç”¨äºè¡€ç¼˜æŸ¥è¯¢çš„ APIã€‚ è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ç”¨ cURL è°ƒç”¨ä¸‹è¿™ä¸ª APIï¼š docker run -it --rm --net container:amundsenfrontend nicolaka/netshoot curl \"http://amundsenmetadata:5002/table/snowflake://dbt_demo.public/raw_inventory_value/lineage?depth=3\u0026direction=both\" ä¸Šé¢çš„ API è°ƒç”¨æ˜¯æŸ¥è¯¢ä¸Šæ¸¸å’Œä¸‹æ¸¸æ–¹å‘çš„ linageï¼Œè¡¨ snowflake://dbt_demo.public/raw_inventory_value çš„æ·±åº¦ä¸º 3ã€‚ ç»“æœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š { \"depth\": 3, \"downstream_entities\": [ { \"level\": 2, \"usage\": 0, \"key\": \"snowflake://dbt_demo.public/fact_daily_expenses\", \"parent\": \"snowflake://dbt_demo.public/fact_warehouse_inventory\", \"badges\": [], \"source\": \"snowflake\" }, { \"level\": 1, \"usage\": 0, \"key\": \"snowflake://dbt_demo.public/fact_warehouse_inventory\", \"parent\": \"snowflake://dbt_demo.public/raw_inventory_value\", \"badges\": [], \"source\": \"snowflake\" } ], \"key\": \"snowflake://dbt_demo.public/raw_inventory_value\", \"direction\": \"both\", \"upstream_entities\": [] } å®é™…ä¸Šï¼Œè¿™ä¸ªè¡€ç¼˜æ•°æ®å°±æ˜¯åœ¨æˆ‘ä»¬çš„ DbtExtractor æ‰§è¡ŒæœŸé—´æå–å’ŒåŠ è½½çš„ï¼Œå…¶ä¸­ extractor .dbt.{DbtExtractor.EXTRACT_LINEAGE} é»˜è®¤ä¸º Trueï¼Œå› æ­¤åˆ›å»ºäº†è¡€ç¼˜å…ƒæ•°æ®å¹¶å°†å…¶åŠ è½½åˆ°äº† Amundsenã€‚ 4.5.1 åœ¨ NebulaGraph ä¸­æ´å¯Ÿè¡€ç¼˜ä½¿ç”¨å›¾æ•°æ®åº“ä½œä¸ºå…ƒæ•°æ®å­˜å‚¨çš„ä¸¤ä¸ªä¼˜ç‚¹æ˜¯ï¼š å›¾æŸ¥è¯¢æœ¬èº«æ˜¯ä¸€ä¸ªçµæ´»çš„ DSL for lineage APIï¼Œä¾‹å¦‚ï¼Œè¿™ä¸ªæŸ¥è¯¢å¸®åŠ©æˆ‘ä»¬æ‰§è¡Œ Amundsen å…ƒæ•°æ® API çš„ç­‰ä»·çš„æŸ¥è¯¢ï¼š MATCH p=(t:`Table`) -[:`HAS_UPSTREAM`|:`HAS_DOWNSTREAM` *1..3]-\u003e(x) WHERE id(t) == \"snowflake://dbt_demo.public/raw_inventory_value\" RETURN p æˆ‘ä»¬ç°åœ¨ç”šè‡³å¯ä»¥åœ¨ NebulaGraph Studio æˆ–è€… Explorer çš„æ§åˆ¶å°ä¸­æŸ¥è¯¢å®ƒ â€‹ ç„¶åæ¸²æŸ“è¿™ä¸ªç»“æœï¼š 4.5.2 æå–æ•°æ®è¡€ç¼˜è¿™äº›è¡€ç¼˜ä¿¡æ¯æ˜¯éœ€è¦æˆ‘ä»¬æ˜ç¡®æŒ‡å®šã€è·å–çš„ï¼Œè·å–çš„æ–¹å¼å¯ä»¥æ˜¯è‡ªå·±å†™çš„ extractorï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€äº›å·²ç»æœ‰çš„æ–¹å¼ã€‚æ¯”å¦‚ dbt çš„ extractorå’Œ Open Lineage é¡¹ç›®çš„ Amundsen extractorã€‚ 4.5.2.1 é€šè¿‡ dbtè¿™ä¸ªåœ¨åˆšæ‰å·²ç»å±•ç¤ºè¿‡äº†ï¼ŒDbt çš„ Extractor ä¼šä»è¡¨çº§åˆ«è·å–è¡€ç¼˜å’Œå…¶ä»– dbt ä¸­äº§ç”Ÿçš„å…ƒæ•°æ®ä¿¡æ¯ä¸€èµ·è¢«æ‹¿åˆ°ã€‚ 4.5.2.2 é€šè¿‡ Open LineageAmundsen ä¸­çš„å¦ä¸€ä¸ªå¼€ç®±å³ç”¨çš„è¡€ç¼˜ Extractor æ˜¯ OpenLineageTableLineageExtractorã€‚ Open Lineage æ˜¯ä¸€ä¸ªå¼€æ”¾çš„æ¡†æ¶ï¼Œå¯ä»¥å°†ä¸åŒæ¥æºçš„è¡€ç»Ÿæ•°æ®æ”¶é›†åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œå®ƒå¯ä»¥å°†è¡€ç»Ÿä¿¡æ¯è¾“å‡ºä¸º JSON æ–‡ä»¶ï¼šhttps://www.amundsen.io/amundsen/databuilder/#openlineagetablelineageextractor ä¸‹è¾¹æ˜¯å®ƒçš„ Amundsen data builder ä¾‹å­ï¼š dict_config = { # ... f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.CLUSTER_NAME}': 'datalab', f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.OL_DATASET_NAMESPACE_OVERRIDE}': 'hive_table', f'extractor.openlineage_tablelineage.{OpenLineageTableLineageExtractor.TABLE_LINEAGE_FILE_LOCATION}': 'input_dir/openlineage_nd.json', } ... task = DefaultTask( extractor=OpenLineageTableLineageExtractor(), loader=FsNebulaCSVLoader()) ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:4:5","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#é€šè¿‡-open-lineage"},{"categories":["Nebula Graph","Amundsen"],"content":" 5 å›é¡¾æ•´å¥—å…ƒæ•°æ®æ²»ç†/å‘ç°çš„æ–¹æ¡ˆæ€è·¯å¦‚ä¸‹ï¼š å°†æ•´ä¸ªæ•°æ®æŠ€æœ¯æ ˆä¸­çš„ç»„ä»¶ä½œä¸ºå…ƒæ•°æ®æºï¼ˆä»ä»»ä½•æ•°æ®åº“ã€æ•°ä»“ï¼Œåˆ° dbtã€Airflowã€Openlineageã€Superset ç­‰å„çº§é¡¹ç›®ï¼‰ ä½¿ç”¨ Databuilderï¼ˆä½œä¸ºè„šæœ¬æˆ– DAGï¼‰è¿è¡Œå…ƒæ•°æ® ETLï¼Œä»¥ä½¿ç”¨ NebulaGraph å’Œ Elasticsearch å­˜å‚¨å’Œç´¢å¼• ä»å‰ç«¯ UIï¼ˆä½¿ç”¨ Superset é¢„è§ˆï¼‰æˆ– API å»ä½¿ç”¨ã€æ¶ˆè´¹ã€ç®¡ç†å’Œå‘ç°å…ƒæ•°æ® é€šè¿‡æŸ¥è¯¢å’Œ UI å¯¹ NebulaGraphï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—æ›´å¤šçš„å¯èƒ½æ€§ã€çµæ´»æ€§å’Œæ•°æ®ã€è¡€ç¼˜çš„æ´å¯Ÿ ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:5:0","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#å›é¡¾"},{"categories":["Nebula Graph","Amundsen"],"content":" 5.1 æ¶‰åŠåˆ°çš„å¼€æºæ­¤å‚è€ƒé¡¹ç›®ä¸­ä½¿ç”¨çš„æ‰€æœ‰é¡¹ç›®éƒ½æŒ‰å­—å…¸é¡ºåºåœ¨ä¸‹é¢åˆ—å‡ºã€‚ Amundsen Apache Airflow Apache Superset dbt Elasticsearch meltano Nebula Graph Open Lineage singer é¢˜å›¾ç‰ˆæƒï¼š Phil Hearing ","date":"2022-11-25","objectID":"/data-lineage-oss-ref-solution/:5:1","series":null,"tags":["Nebula Graph","Amundsen","æ•°æ®è¡€ç¼˜","æ•°æ®æ²»ç†"],"title":"åŸºäºå¼€æºæŠ€æœ¯æ ˆçš„æ•°æ®è¡€ç¼˜ã€æ²»ç†å‚è€ƒè§£å†³æ–¹æ¡ˆ","uri":"/data-lineage-oss-ref-solution/#æ¶‰åŠåˆ°çš„å¼€æº"},{"categories":["Nebula Graph"],"content":"æœ¬æ–‡ä»‹ç»äº†åˆ©ç”¨å¼€æº API ç½‘å…³ APISIX åŠ é€Ÿ NebulaGraph å¤šä¸ªåœºæ™¯çš„è½åœ°æœ€ä½³å®è·µï¼šè´Ÿè½½å‡è¡¡ã€æš´éœ²å­˜å‚¨æ¥å£ä¸ TLS Terminationã€‚","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/"},{"categories":["Nebula Graph"],"content":" æœ¬æ–‡ä»‹ç»äº†åˆ©ç”¨å¼€æº API ç½‘å…³ APISIX åŠ é€Ÿ NebulaGraph å¤šä¸ªåœºæ™¯çš„è½åœ°æœ€ä½³å®è·µï¼šè´Ÿè½½å‡è¡¡ã€æš´éœ²æ¥å£ç»“æ„ä¸ TLS Terminationã€‚ ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:0:0","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#"},{"categories":["Nebula Graph"],"content":" 1 API ç½‘å…³ä»‹ç»","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:1:0","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#api-ç½‘å…³ä»‹ç»"},{"categories":["Nebula Graph"],"content":" 1.1 ä»€ä¹ˆæ˜¯ API ç½‘å…³API ç½‘å…³æ˜¯å®ƒä½äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„â€œä¸­é—´äººâ€ï¼Œç”¨äºç®¡ç†ã€ç›‘æ§å’Œä¿æŠ¤ APIã€‚å®ƒå¯ä»¥åœ¨ API ä¹‹å‰æ‰§è¡Œä¸€äº›æ“ä½œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€æˆæƒã€ç¼“å­˜ã€æ—¥å¿—è®°å½•ã€å®¡è®¡ã€æµé‡æ§åˆ¶ã€å®‰å…¨ã€é˜²ç«å¢™ã€å‹ç¼©ã€è§£å‹ç¼©ã€åŠ å¯†ã€è§£å¯†ç­‰ã€‚ API ç½‘å…³å¯ä»¥å·¥ä½œåœ¨ 4 å±‚å’Œ 7 å±‚ã€‚è·‘åœ¨ 7 å±‚çš„API ç½‘å…³å¯ä»¥ä½¿ç”¨å¤šç§åè®®ï¼Œä¾‹å¦‚ HTTPã€HTTPSã€WebSocketã€gRPCã€MQTT ç­‰ï¼Œåœ¨è¿™äº›åº”ç”¨å±‚åè®®ä¸­åšä¸€äº›æ“ä½œï¼Œä¾‹å¦‚è¯·æ±‚é‡å†™ã€è¯·æ±‚è½¬å‘ã€è¯·æ±‚åˆå¹¶ã€è¯·æ±‚é‡è¯•ã€è¯·æ±‚ç¼“å­˜ã€è¯·æ±‚é™æµã€è¯·æ±‚ç†”æ–­ã€è¯·æ±‚é™çº§ã€è¯·æ±‚é‰´æƒã€è¯·æ±‚ç›‘æ§ã€è¯·æ±‚æ—¥å¿—ã€è¯·æ±‚å®¡è®¡ã€è¯·æ±‚è½¬å‘ç­‰ç­‰ã€‚ è¿™é‡Œä¸¾ä¾‹ä¸€ä¸‹å€ŸåŠ© API ç½‘å…³å¯ä»¥åšçš„å…·ä½“çš„äº‹å„¿å§ï¼š æˆ‘ä»¬å¯ä»¥åœ¨ç½‘å…³å±‚å¢åŠ è®¤è¯å±‚ï¼Œæ¯”å¦‚ JWT è®¤è¯ã€OAuth2 è®¤è¯ã€OpenID è®¤è¯ç­‰ç­‰ï¼Œè¿™æ ·åˆ™ä¸éœ€è¦åœ¨æ¯ä¸ªæœåŠ¡ä¸­éƒ½åšå…·ä½“çš„è®¤è¯é›†æˆå·¥ä½œï¼Œè¿™å¯ä»¥èŠ‚çœéå¸¸å¤šçš„å¼€å‘æˆæœ¬ã€‚ æˆ‘ä»¬å¯ä»¥å€ŸåŠ©ç½‘å…³ç»™è·³æ¿æœº SSH æµé‡å¢åŠ æ— éœ€å®¢æˆ·ç«¯ä¿®æ”¹çš„å¤æ‚è®¤è¯ï¼Œæ¯”å¦‚è·³è½¬ä»»ä½•å®¢æˆ·ç«¯çš„ SSH ç™»å½•ï¼Œç»™å‡ºä¸€ä¸ªç½‘å€æˆ–è€…è¾“å…¥æ¡†ï¼Œå¼•å¯¼ç™»é™†è€…é€šè¿‡ç½‘é¡µçš„ SSO è®¤è¯ï¼ˆåŒ…å«å¤šå› ç´ è®¤è¯ï¼‰ï¼Œç„¶åå†é€šè¿‡ç½‘å…³è½¬å‘åˆ° SSH æœåŠ¡ã€‚ æˆ‘ä»¬ç”šè‡³å¯ä»¥åœ¨ç½‘å…³å±‚åš Serverless æ•°æ®åº“ï¼TiDB ç¤¾åŒºçš„åŒå­¦ä»¬å°±åœ¨åšè¿™ä¸ªäº‹å„¿ï¼Œä»–ä»¬ä»æ™®é€šçš„ MySQL å®¢æˆ·ç«¯çš„ç™»å½•è¯·æ±‚ä¸­è§£æèƒ½æ¨æ–­å‡ºè½¬åˆ°éœ€è¦çš„ TiDB ç¤ºä¾‹çš„ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨éœ€è¦ cold start å”¤é†’å®ä¾‹çš„æ—¶å€™æŠŠè¿æ¥ä¿æŒä½ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šTiDB Gatewayã€‚ å¦‚æœæˆ‘ä»¬ç‰¹åˆ«æƒ¨åœ¨ç»´æŠ¤ä¸€äº›å±å±±é¡¹ç›®ï¼Œä¸å¾—ä¸é’ˆå¯¹æ—§ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºå¯¹æ–°ç‰ˆæœ¬çš„æœåŠ¡ç«¯è¿›è¡Œå…¼å®¹ï¼Œè¿™æ—¶å€™ API ç½‘å…³ä¹Ÿå¯ä»¥é€šè¿‡ä¸€äº›è¯·æ±‚é‡å†™ï¼ŒæŠŠæ—§ç‰ˆæœ¬çš„è¯·æ±‚è½¬æ¢æˆæ–°ç‰ˆæœ¬çš„è¯·æ±‚ã€‚ åªè¦è„‘æ´å¤§ï¼Œç†è®ºä¸ŠAPI çš„ç½‘å…³å¯ä»¥åšå¾ˆå¤šå¾ˆå¤šäº‹å„¿ï¼Œæ˜¾ç„¶ï¼Œä¸æ˜¯æ‰€æœ‰çš„äº‹æƒ…éƒ½æ˜¯é€‚åˆåœ¨è¿™ä¸€å±‚é¢å»åšçš„ï¼Œé€šå¸¸é‚£äº›æ¯”è¾ƒé€šç”¨çš„äº‹æƒ…æ‰é€‚åˆåœ¨è¿™ä¸€å±‚é¢å»åšï¼Œè¿™é‡Œæˆ‘åªæ˜¯ç»™å‡ºä¸€äº›å…¸å‹å’Œæç«¯çš„å…·ä½“ä¾‹å­ã€‚ ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:1:1","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#ä»€ä¹ˆæ˜¯-api-ç½‘å…³"},{"categories":["Nebula Graph"],"content":" 1.2 Apache APISIXAPI ç½‘å…³æ˜¯ä» LBã€Reverse Proxy é¡¹ç›®æ¼”è¿›è¿‡æ¥çš„ï¼Œéšç€äº‘åŸç”Ÿçš„å…´èµ·ï¼ŒAPI ç½‘å…³ä¹Ÿé€æ¸æˆä¸ºäº†äº‘åŸç”Ÿçš„ä¸€éƒ¨åˆ†ï¼Œæµè¡Œçš„å¼€æºçš„ç½‘å…³å°±æœ‰å¾ˆå¤šï¼š Nginx Apache APISIX Kong Lura OpenResty Tyk Traefik Istio Envoy è€Œä¸”å…¶ä¸­å¾ˆå¤šéƒ½æ˜¯åŸºäº Nginx/OpenResty çš„ä¸‹æ¸¸é¡¹ç›®ï¼Œè¿™é‡Œå°±ä»¥ Apache APISIX ä¸ºä¾‹ï¼Œä»‹ç»ä¸€ä¸‹ NebulaGraph å€ŸåŠ© API ç½‘å…³çš„å‡ ä¸ªå®è·µã€‚ ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:1:2","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#apache-apisix"},{"categories":["Nebula Graph"],"content":" 2 NebulaGraph ä»‹ç»NebulaGraph æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼å›¾æ•°æ®åº“ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼š é«˜æ€§èƒ½ï¼šNebulaGraph çš„æ€§èƒ½å¯ä»¥è¾¾åˆ°æ¯ç§’ç™¾ä¸‡çº§çš„è¯»å†™ï¼Œå…·æœ‰æé«˜çš„æ‰©å±•æ€§ï¼Œåœ¨åƒäº¿ç‚¹ä¸‡äº¿è¾¹çš„è§„æ¨¡ä¸Šæ”¯æŒæ¯«ç§’çº§çš„æŸ¥è¯¢ã€‚ æ˜“æ‰©å±•ï¼šNebulaGraph çš„æ¶æ„æ˜¯åˆ†å¸ƒå¼çš„ï¼Œå¯ä»¥åœ¨å¤šå°æœºå™¨ä¸Šæ‰©å±•ï¼Œæ¯å°æœºå™¨ä¸Šå¯ä»¥è¿è¡Œå¤šä¸ªæœåŠ¡è¿›ç¨‹ï¼Œå®ƒçš„æŸ¥è¯¢å±‚æ˜¯æ— çŠ¶æ€çš„è®¡ç®—å­˜å‚¨åˆ†ç¦»æ¶æ„ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“å¼•å…¥ä¸åŒé…ç½®ã€ä¸é€šç±»å‹çš„è®¡ç®—å±‚ï¼Œå®ç°åŒä¸€é›†ç¾¤ä¸Š TPã€APã€ å›¾è®¡ç®—ç­‰ä¸åŒè´Ÿè½½çš„æ··åˆæŸ¥è¯¢ã€‚ æ˜“ä½¿ç”¨ï¼šNebulaGraph çš„åŸç”ŸæŸ¥è¯¢è¯­è¨€æ˜¯ç±» SQL çš„ï¼Œæ˜“äºå­¦ä¹ å’Œä½¿ç”¨ï¼ŒåŒæ—¶æ”¯æŒ OpenCypherã€‚ ä¸°å¯Œç”Ÿæ€ï¼šNebulaGraph çš„ç”Ÿæ€ç³»ç»Ÿæ­£åœ¨ä¸æ–­å£®å¤§ï¼Œç›®å‰å·²ç»æœ‰äº†å¤šä¸ªå®¢æˆ·ç«¯ï¼ŒåŒ…æ‹¬ Javaã€Pythonã€Goã€C++ã€JavaScriptã€Sparkã€Flink ç­‰ï¼ŒåŒæ—¶ä¹Ÿæœ‰äº†å¤šä¸ªå¯è§†åŒ–å·¥å…·ï¼ŒåŒ…æ‹¬ NebulaGraph Studioã€Nebula Dashboardã€Nebula Explorer ç­‰ã€‚ ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:2:0","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#nebulagraph-ä»‹ç»"},{"categories":["Nebula Graph"],"content":" 3 æœ¬æ–‡è®¨è®ºçš„é—®é¢˜æœ¬æ–‡ç»™å‡ºäº†åŸºäº NebulaGraph é›†ç¾¤åº”ç”¨ä¸­æ¶‰åŠåˆ° API ç½‘å…³çš„å‡ ä¸ªåœºæ™¯ã€‚ æŸ¥è¯¢æ¥å£çš„è´Ÿè½½å‡è¡¡ åº•å±‚å­˜å‚¨æ¥å£çš„æš´éœ² ä¼ è¾“å±‚çš„åŠ å¯† ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:3:0","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#æœ¬æ–‡è®¨è®ºçš„é—®é¢˜"},{"categories":["Nebula Graph"],"content":" 3.1 æŸ¥è¯¢æ¥å£è´Ÿè½½å‡è¡¡é¦–å…ˆæ˜¯å›¾æ•°æ®åº“æŸ¥è¯¢æ¥å£ï¼ˆGraphDï¼‰çš„è´Ÿè½½å‡è¡¡ä¸é«˜å¯ç”¨çš„é—®é¢˜ã€‚ NebulaGraph å†…æ ¸ç”±ä¸‰ç§æœåŠ¡ç»„æˆï¼šGraphDã€MetaD å’Œ StorageDï¼š æ‰€ä»¥ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œé›†ç¾¤åªä¼šæš´éœ² GraphD çš„æ¥å£ï¼Œæä¾›ç»™å®¢æˆ·ç«¯è¿æ¥ï¼Œæ‰§è¡Œ nGQL çš„æŸ¥è¯¢ã€‚ è¿™å…¶ä¸­ï¼ŒGraphD æ˜¯æ— çŠ¶æ€çš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨å¤šä¸ª GraphD ä¹‹é—´åšè´Ÿè½½å‡è¡¡ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•ï¼šåŸºäºå®¢æˆ·ç«¯çš„ï¼ˆClient-Side LBï¼‰ï¼Œä¸åŸºäºä»£ç†çš„ã€‚ 3.1.1 å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡ï¼Œå°±æ˜¯åœ¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ç¨‹åºä¸­ï¼Œå®ç°è´Ÿè½½å‡è¡¡çš„é€»è¾‘ï¼ŒNebulaGraph çš„å„ä¸ªè¯­è¨€çš„å®¢æˆ·ç«¯é‡Œè¾¹å·²ç»å†…ç½®äº†ç®€å•çš„è½®è¯¢ï¼ˆRound-Robinï¼‰è´Ÿè½½å‡è¡¡ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å®¢æˆ·ç«¯é…ç½®å¤šä¸ª GraphD çš„åœ°å€å°±å¯ä»¥äº†ï¼š æ¯”å¦‚æˆ‘ä»¬åœ¨åˆ›å»ºè¿æ¥æ± çš„æ—¶å€™ï¼ŒæŒ‡å®šäº†ä¸¤ä¸ªä¸åŒçš„ GraphD çš„åœ°å€ï¼ˆå¯¹åº”ä¸åŒè¿›ç¨‹å®ä¾‹ï¼‰ï¼š from nebula3.gclient.net import ConnectionPool from nebula3.Config import Config config = Config() config.max_connection_pool_size = 10 connection_pool = ConnectionPool() connection_pool.init([('127.0.0.1', 9669), ('127.0.0.1', 49433)], config) æˆ‘ä»¬åœ¨å–å¾—è¿æ¥çš„æ—¶å€™ï¼Œå°±ä¼šä»è¿æ¥æ± ä¸­éšæœºå–å¾—ä¸€ä¸ªè¿æ¥ï¼š In [10]: connection0 = connection_pool.get_connection() In [11]: connection1 = connection_pool.get_connection() # è¿™ä¸¤ä¸ªè¿æ¥çš„ GraphD åœ°å€æ˜¯ä¸åŒçš„ In [12]: connection0._port, connection1._port Out[12]: (9669, 49433) è¿™ç§å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡çš„é—®é¢˜åœ¨äºå®ƒçš„é…ç½®ã€å®ç°ç»†èŠ‚ä¸åº”ç”¨ä»£ç è€¦åˆåœ¨ä¸€èµ·ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ä¿®æ”¹è´Ÿè½½å‡è¡¡çš„ç­–ç•¥ï¼Œå°±éœ€è¦ä¿®æ”¹åº”ç”¨ä»£ç ï¼Œè¿™æ ·å°±ä¼šå¢åŠ åº”ç”¨çš„å¤æ‚åº¦ã€‚ 3.1.2 ä»£ç†çš„è´Ÿè½½å‡è¡¡åŸºäºä»£ç†çš„è´Ÿè½½å‡è¡¡ï¼Œå°±æ˜¯åœ¨åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œå¢åŠ ä¸€ä¸ªä»£ç†å±‚ï¼Œæ¥å®ç°è´Ÿè½½å‡è¡¡çš„é€»è¾‘ï¼Œè¿™æ ·åº”ç”¨ç¨‹åºå°±ä¸éœ€è¦å…³å¿ƒè´Ÿè½½å‡è¡¡çš„é—®é¢˜äº†ã€‚åœ¨ k8s é‡Œçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ k8s çš„ Service æ¥å®ç°è¿™ä¸ªä»£ç†å±‚ã€‚ è¿™æ˜¯ä¸€ä¸ªåœ¨ Minikube ä¸­ä¸º NebulaGraph é›†ç¾¤ä¸­ GraphD åˆ›å»ºçš„ Serviceï¼š cat \u003c\u003cEOF | kubectl create -f - apiVersion: v1 kind: Service metadata: labels: app.kubernetes.io/cluster: nebula app.kubernetes.io/component: graphd app.kubernetes.io/managed-by: nebula-operator app.kubernetes.io/name: nebula-graph name: nebula-graphd-svc-nodeport namespace: default spec: externalTrafficPolicy: Local ports: - name: thrift port: 9669 protocol: TCP targetPort: 9669 nodePort: 30000 - name: http port: 19669 protocol: TCP targetPort: 19669 nodePort: 30001 selector: app.kubernetes.io/cluster: nebula app.kubernetes.io/component: graphd app.kubernetes.io/managed-by: nebula-operator app.kubernetes.io/name: nebula-graph type: NodePort EOF åˆ›å»ºäº†å®ƒä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å®ƒæš´éœ²çš„å•ç‹¬ç«¯å£æ¥è®¿é—® NebulaGraph é›†ç¾¤ä¸­çš„ GraphD äº†ï¼š In [13]: connection_pool = ConnectionPool() ...: connection_pool.init([('192.168.49.2', 9669)], config) Out[13]: True In [14]: connection0 = connection_pool.get_connection() In [15]: connection1 = connection_pool.get_connection() In [16]: connection0._ip, connection1._ip Out[16]: ('192.168.49.2', '192.168.49.2') å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿æ¥å±‚é¢ä¸Šæ¥çœ‹ï¼Œå®¢æˆ·ç«¯åªçŸ¥é“ä»£ç†çš„åœ°å€ï¼Œè€Œä¸çŸ¥é“ NebulaGraph é›†ç¾¤ä¸­çš„ GraphD çš„åœ°å€ï¼Œè¿™æ ·å°±å®ç°äº†å®¢æˆ·ç«¯ä¸ NebulaGraph é›†ç¾¤ä¸­çš„ GraphD çš„è§£è€¦ã€‚ ç„¶è€Œï¼Œå½“æˆ‘ä»¬åœ¨ connection ä¹‹ä¸Šåˆ›å»º session çš„æ—¶å€™ï¼Œå°±èƒ½çœ‹åˆ°å®é™…ä¸Šå®¢æˆ·ç«¯çš„ä¸åŒè¯·æ±‚æ˜¯è½åœ¨äº†ä¸åŒçš„ GraphD ä¸Šçš„ï¼š In [17]: session = connection_pool.get_session('root', 'nebula') In [18]: session._session_id Out[18]: 1668670607568178 In [19]: session1 = connection_pool.get_session('root', 'nebula') In [20]: session1._session_id Out[20]: 1668670625563307 # å¾—åˆ°æ¯ä¸€ä¸ª session çš„ ID In [21]: session.execute(\"SHOW SESSIONS\") # å®ƒä»¬åˆ†åˆ«å¯¹åº”äº†ä¸¤ä¸ªä¸åŒçš„ graphd å®ä¾‹ Out[21]: ResultSet(keys: ['SessionId', 'UserName', 'SpaceName', 'CreateTime', 'UpdateTime', 'GraphAddr', 'Timezone', 'ClientIp'], values: [1668670607568178, \"root\", \"\", utc datetime: 2022-11-17T07:36:47.568178, timezone_offset: 0, utc datetime: 2022-11-17T07:36:47.575303, timezone_offset: 0, \"nebula-graphd-0.nebula-graphd-svc.default.svc.cluster.local:9669\", 0, \"172.17.0.1\"],[1668670625563307, \"root\", \"\", utc datetime: 2022-11-17T07:37:05.563307, timezone_offset: 0, utc datetime: 2022-11-17T07:37:03.638910, timezone_offset: 0, \"nebula-graphd-1.nebula-graphd-svc.default.svc.cluster.local:9669\", 0, \"172.17.0.1\"]) ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:3:1","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#æŸ¥è¯¢æ¥å£è´Ÿè½½å‡è¡¡"},{"categories":["Nebula Graph"],"content":" 3.1 æŸ¥è¯¢æ¥å£è´Ÿè½½å‡è¡¡é¦–å…ˆæ˜¯å›¾æ•°æ®åº“æŸ¥è¯¢æ¥å£ï¼ˆGraphDï¼‰çš„è´Ÿè½½å‡è¡¡ä¸é«˜å¯ç”¨çš„é—®é¢˜ã€‚ NebulaGraph å†…æ ¸ç”±ä¸‰ç§æœåŠ¡ç»„æˆï¼šGraphDã€MetaD å’Œ StorageDï¼š æ‰€ä»¥ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œé›†ç¾¤åªä¼šæš´éœ² GraphD çš„æ¥å£ï¼Œæä¾›ç»™å®¢æˆ·ç«¯è¿æ¥ï¼Œæ‰§è¡Œ nGQL çš„æŸ¥è¯¢ã€‚ è¿™å…¶ä¸­ï¼ŒGraphD æ˜¯æ— çŠ¶æ€çš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨å¤šä¸ª GraphD ä¹‹é—´åšè´Ÿè½½å‡è¡¡ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•ï¼šåŸºäºå®¢æˆ·ç«¯çš„ï¼ˆClient-Side LBï¼‰ï¼Œä¸åŸºäºä»£ç†çš„ã€‚ 3.1.1 å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡ï¼Œå°±æ˜¯åœ¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ç¨‹åºä¸­ï¼Œå®ç°è´Ÿè½½å‡è¡¡çš„é€»è¾‘ï¼ŒNebulaGraph çš„å„ä¸ªè¯­è¨€çš„å®¢æˆ·ç«¯é‡Œè¾¹å·²ç»å†…ç½®äº†ç®€å•çš„è½®è¯¢ï¼ˆRound-Robinï¼‰è´Ÿè½½å‡è¡¡ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å®¢æˆ·ç«¯é…ç½®å¤šä¸ª GraphD çš„åœ°å€å°±å¯ä»¥äº†ï¼š æ¯”å¦‚æˆ‘ä»¬åœ¨åˆ›å»ºè¿æ¥æ± çš„æ—¶å€™ï¼ŒæŒ‡å®šäº†ä¸¤ä¸ªä¸åŒçš„ GraphD çš„åœ°å€ï¼ˆå¯¹åº”ä¸åŒè¿›ç¨‹å®ä¾‹ï¼‰ï¼š from nebula3.gclient.net import ConnectionPool from nebula3.Config import Config config = Config() config.max_connection_pool_size = 10 connection_pool = ConnectionPool() connection_pool.init([('127.0.0.1', 9669), ('127.0.0.1', 49433)], config) æˆ‘ä»¬åœ¨å–å¾—è¿æ¥çš„æ—¶å€™ï¼Œå°±ä¼šä»è¿æ¥æ± ä¸­éšæœºå–å¾—ä¸€ä¸ªè¿æ¥ï¼š In [10]: connection0 = connection_pool.get_connection() In [11]: connection1 = connection_pool.get_connection() # è¿™ä¸¤ä¸ªè¿æ¥çš„ GraphD åœ°å€æ˜¯ä¸åŒçš„ In [12]: connection0._port, connection1._port Out[12]: (9669, 49433) è¿™ç§å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡çš„é—®é¢˜åœ¨äºå®ƒçš„é…ç½®ã€å®ç°ç»†èŠ‚ä¸åº”ç”¨ä»£ç è€¦åˆåœ¨ä¸€èµ·ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ä¿®æ”¹è´Ÿè½½å‡è¡¡çš„ç­–ç•¥ï¼Œå°±éœ€è¦ä¿®æ”¹åº”ç”¨ä»£ç ï¼Œè¿™æ ·å°±ä¼šå¢åŠ åº”ç”¨çš„å¤æ‚åº¦ã€‚ 3.1.2 ä»£ç†çš„è´Ÿè½½å‡è¡¡åŸºäºä»£ç†çš„è´Ÿè½½å‡è¡¡ï¼Œå°±æ˜¯åœ¨åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œå¢åŠ ä¸€ä¸ªä»£ç†å±‚ï¼Œæ¥å®ç°è´Ÿè½½å‡è¡¡çš„é€»è¾‘ï¼Œè¿™æ ·åº”ç”¨ç¨‹åºå°±ä¸éœ€è¦å…³å¿ƒè´Ÿè½½å‡è¡¡çš„é—®é¢˜äº†ã€‚åœ¨ k8s é‡Œçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ k8s çš„ Service æ¥å®ç°è¿™ä¸ªä»£ç†å±‚ã€‚ è¿™æ˜¯ä¸€ä¸ªåœ¨ Minikube ä¸­ä¸º NebulaGraph é›†ç¾¤ä¸­ GraphD åˆ›å»ºçš„ Serviceï¼š cat \u003c","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:3:1","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡"},{"categories":["Nebula Graph"],"content":" 3.1 æŸ¥è¯¢æ¥å£è´Ÿè½½å‡è¡¡é¦–å…ˆæ˜¯å›¾æ•°æ®åº“æŸ¥è¯¢æ¥å£ï¼ˆGraphDï¼‰çš„è´Ÿè½½å‡è¡¡ä¸é«˜å¯ç”¨çš„é—®é¢˜ã€‚ NebulaGraph å†…æ ¸ç”±ä¸‰ç§æœåŠ¡ç»„æˆï¼šGraphDã€MetaD å’Œ StorageDï¼š æ‰€ä»¥ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œé›†ç¾¤åªä¼šæš´éœ² GraphD çš„æ¥å£ï¼Œæä¾›ç»™å®¢æˆ·ç«¯è¿æ¥ï¼Œæ‰§è¡Œ nGQL çš„æŸ¥è¯¢ã€‚ è¿™å…¶ä¸­ï¼ŒGraphD æ˜¯æ— çŠ¶æ€çš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨å¤šä¸ª GraphD ä¹‹é—´åšè´Ÿè½½å‡è¡¡ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•ï¼šåŸºäºå®¢æˆ·ç«¯çš„ï¼ˆClient-Side LBï¼‰ï¼Œä¸åŸºäºä»£ç†çš„ã€‚ 3.1.1 å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡ï¼Œå°±æ˜¯åœ¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ç¨‹åºä¸­ï¼Œå®ç°è´Ÿè½½å‡è¡¡çš„é€»è¾‘ï¼ŒNebulaGraph çš„å„ä¸ªè¯­è¨€çš„å®¢æˆ·ç«¯é‡Œè¾¹å·²ç»å†…ç½®äº†ç®€å•çš„è½®è¯¢ï¼ˆRound-Robinï¼‰è´Ÿè½½å‡è¡¡ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å®¢æˆ·ç«¯é…ç½®å¤šä¸ª GraphD çš„åœ°å€å°±å¯ä»¥äº†ï¼š æ¯”å¦‚æˆ‘ä»¬åœ¨åˆ›å»ºè¿æ¥æ± çš„æ—¶å€™ï¼ŒæŒ‡å®šäº†ä¸¤ä¸ªä¸åŒçš„ GraphD çš„åœ°å€ï¼ˆå¯¹åº”ä¸åŒè¿›ç¨‹å®ä¾‹ï¼‰ï¼š from nebula3.gclient.net import ConnectionPool from nebula3.Config import Config config = Config() config.max_connection_pool_size = 10 connection_pool = ConnectionPool() connection_pool.init([('127.0.0.1', 9669), ('127.0.0.1', 49433)], config) æˆ‘ä»¬åœ¨å–å¾—è¿æ¥çš„æ—¶å€™ï¼Œå°±ä¼šä»è¿æ¥æ± ä¸­éšæœºå–å¾—ä¸€ä¸ªè¿æ¥ï¼š In [10]: connection0 = connection_pool.get_connection() In [11]: connection1 = connection_pool.get_connection() # è¿™ä¸¤ä¸ªè¿æ¥çš„ GraphD åœ°å€æ˜¯ä¸åŒçš„ In [12]: connection0._port, connection1._port Out[12]: (9669, 49433) è¿™ç§å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡çš„é—®é¢˜åœ¨äºå®ƒçš„é…ç½®ã€å®ç°ç»†èŠ‚ä¸åº”ç”¨ä»£ç è€¦åˆåœ¨ä¸€èµ·ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ä¿®æ”¹è´Ÿè½½å‡è¡¡çš„ç­–ç•¥ï¼Œå°±éœ€è¦ä¿®æ”¹åº”ç”¨ä»£ç ï¼Œè¿™æ ·å°±ä¼šå¢åŠ åº”ç”¨çš„å¤æ‚åº¦ã€‚ 3.1.2 ä»£ç†çš„è´Ÿè½½å‡è¡¡åŸºäºä»£ç†çš„è´Ÿè½½å‡è¡¡ï¼Œå°±æ˜¯åœ¨åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œå¢åŠ ä¸€ä¸ªä»£ç†å±‚ï¼Œæ¥å®ç°è´Ÿè½½å‡è¡¡çš„é€»è¾‘ï¼Œè¿™æ ·åº”ç”¨ç¨‹åºå°±ä¸éœ€è¦å…³å¿ƒè´Ÿè½½å‡è¡¡çš„é—®é¢˜äº†ã€‚åœ¨ k8s é‡Œçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ k8s çš„ Service æ¥å®ç°è¿™ä¸ªä»£ç†å±‚ã€‚ è¿™æ˜¯ä¸€ä¸ªåœ¨ Minikube ä¸­ä¸º NebulaGraph é›†ç¾¤ä¸­ GraphD åˆ›å»ºçš„ Serviceï¼š cat \u003c","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:3:1","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#ä»£ç†çš„è´Ÿè½½å‡è¡¡"},{"categories":["Nebula Graph"],"content":" 3.2 åº•å±‚å­˜å‚¨æ¥å£çš„æš´éœ²åœ¨ NebulaGraph ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ StorageClient æ¥è®¿é—®åº•å±‚çš„å­˜å‚¨æ¥å£ï¼Œè¿™ä¸ªæ¥å£å¯ä»¥ç”¨æ¥åšä¸€äº›åˆ†æå‹ã€æ•°æ®å…¨æ‰«æè®¡ç®—çš„å·¥ä½œã€‚ ç„¶è€Œå­˜å‚¨å±‚çš„åˆ†å¸ƒå¼æœåŠ¡å®ä¾‹ä¸åƒ GraphD é‚£æ ·ï¼Œå®ƒä»¬æ˜¯æœ‰çŠ¶æ€çš„ï¼Œè¿™å…¶å®ä¸ K8s æˆ–è€… Docker Compose çš„éƒ¨ç½²æ¨¡å‹æ˜¯ç›¸è¿èƒŒçš„ï¼Œå¦‚æœè®¿é—®çš„åº”ç”¨ StorageD å®¢æˆ·ç«¯åœ¨é›†ç¾¤å¤–éƒ¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ NebulaGraph é›†ç¾¤ä¸­çš„æ¯ä¸€ä¸ªå­˜å‚¨å®ä¾‹ä¸Šéƒ½éƒ¨ç½²ä¸€ä¸ªä»£ç†ï¼ˆServiceï¼‰ï¼Œè¿™éå¸¸ä¸æ–¹ä¾¿ï¼Œæœ‰æ—¶å€™è¿˜æ˜¯ä¸€ç§æµªè´¹ã€‚ æ­¤å¤–ï¼Œç”±äº NebulaGraph å†…éƒ¨æœåŠ¡å‘ç°æœºåˆ¶å’Œ StorageD å®¢æˆ·ç«¯çš„å®ç°æœºåˆ¶å†³å®šï¼Œæ¯ä¸€ä¸ª storaged æœåŠ¡å®ä½“éƒ½æ˜¯ç”±å…¶å†…éƒ¨çš„ host:port å”¯ä¸€ç¡®å®šå’Œå¯»å€çš„ï¼Œè¿™ç»™æˆ‘ä»¬ä¸­é—´çš„ä»£ç†å·¥ä½œä¹Ÿå¸¦æ¥äº†ä¸€äº›éº»çƒ¦ã€‚ æ€»ç»“æ¥çœ‹ï¼Œæˆ‘ä»¬çš„éœ€æ±‚æ˜¯ï¼š èƒ½å¤Ÿä»é›†ç¾¤å¤–éƒ¨è®¿é—® NebulaGraph çš„å­˜å‚¨å±‚æ¯ä¸€ä¸ªå®ä¾‹ æ¯ä¸€ä¸ªå®ä¾‹çš„è®¿é—®åœ°å€ï¼ˆhost:portï¼‰å’Œå†…éƒ¨çš„åœ°å€æ˜¯å®Œå…¨ä¸€è‡´çš„ ä¸ºäº†å®ç°è¿™ä¸ªéœ€æ±‚ï¼Œæˆ‘ä¹‹å‰çš„åšæ³•æ˜¯ä¸ºæ¯ä¸€ä¸ªå®ä¾‹å•ç‹¬éƒ¨ç½²ä¸€ä¸ª GraphD ä»£ç†ï¼ˆæ¶ˆè€—ä¸€ä¸ªåœ°å€ï¼Œä¿è¯ç«¯å£ä¸å˜ï¼‰ï¼Œå†åœ¨å¤–éƒ¨æ‰‹åŠ¨æ­ä¸€ä¸ª nginx ä½œä¸ºä»£ç†ï¼Œé…åˆ DNS æŠŠå†…éƒ¨çš„åœ°å€è§£æ nginx ä¸Šï¼Œç„¶åé€šè¿‡åŸŸåæ‰¾åˆ°ä¸Šæ¸¸ï¼ˆæ¯ä¸€ä¸ªå•ç‹¬çš„ GraphD ä»£ç†ï¼‰ã€‚ æ³¨ï¼šæˆ‘åœ¨è¿™ä¸¤ä¸ª gist é‡Œç»™å‡ºäº†è¿™ä¸ªæ–¹æ³•çš„å®éªŒæ­¥éª¤ï¼š https://gist.github.com/wey-gu/950e4f4c673badae375e59007d80d372 https://gist.github.com/wey-gu/699b9a2ef5dff5f0fb5f288d692ddfd5 æœ€è¿‘ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªç›¸å¯¹ä¼˜é›…çš„å¯ç»´æŠ¤çš„æ–¹å¼ï¼š åœ¨ NebulaGraph é›†ç¾¤åŒä¸€ä¸ªå‘½åç©ºé—´ä¸‹å¼•å…¥ä¸€ä¸ª APISIX ç½‘å…³ åˆ©ç”¨ APISIX ä¸­çš„ nginx TCP ä»£ç†çš„å°è£…ï¼šstream-proxyæ¥æš´éœ² storeaged çš„æ¥å£ ä¸ºäº†æœ€ç»ˆåªåˆ©ç”¨ä¸€ä¸ªé›†ç¾¤çš„å‡ºå£ï¼ˆServiceï¼Œæˆ‘ä»¬åˆ©ç”¨å…¶æ”¯æŒçš„ TLSv1.3 ä¸­çš„ extend host name å­—æ®µï¼šSNI æ¥è·¯ç”±ä¸Šæ¸¸ï¼‰ï¼Œåšåˆ°ç”¨ä¸åŒåŸŸåçš„ TCP over TLS æŒ‡å‘åç«¯çš„ä¸åŒ storaged æœ€ç»ˆï¼Œåªéœ€è¦ Storage å®¢æˆ·ç«¯èƒ½æ”¯æŒ TLSv1.3ï¼ˆå‘é€ SNIï¼‰ï¼Œå¹¶ä¸”èƒ½è§£ææ‰€æœ‰ StorageD çš„åœ°å€åˆ° APISIX çš„ Service ä¸Šå³å¯ ç¤ºä¾‹å›¾ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ K8s Cluster â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ NebulaGraph Cluster â”‚ â”‚ â”‚ â”‚ APISIX API-GATEWAY â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-0 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ stream-proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ .â”€â”€â”€â”€â”€. â”‚ â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚â•± â•² â”‚ â”‚ - addr: 9559 â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ Storaged-1 â”‚ â”‚ â”‚ â”â”â”« DNS â”£â”â”( Service )â•‹â”â”â”â•‹â–¶ tls: true â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚`. ,' â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ `â”€â”€â”€' â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚SNI â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-2 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-3 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š åœ¨ APISIX ä¸­æ¯”è¾ƒä¼˜é›…åœ°ç»´æŠ¤ä»£ç†çš„é…ç½®ï¼Œå¹¶ä¸”å¯ä»¥ç”¨åˆ° APISIX è¿™äº›ç°ä»£åŒ–çš„æµé‡ç®¡ç†èƒ½åŠ› ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ª StorageD å•ç‹¬åˆ›å»º Serviceï¼Œåªéœ€è¦ä¸€ä¸ª Serviceï¼Œå‡ºé›†ç¾¤åœ°å€ å°±å¯ä»¥äº† ä¸ºæµé‡å¢åŠ äº† TLSv1.3 çš„åŠ å¯†ï¼Œæé«˜äº†å®‰å…¨æ€§åŒæ—¶æ²¡æœ‰ç»™ NebulaGraph é›†ç¾¤å†…éƒ¨çš„å—åŒ—æµé‡å¸¦æ¥çš„æ€§èƒ½æŸè€— åœ¨æœ¬æ–‡çš„ç»“å°¾ï¼Œæˆ‘ä¼šç»™å‡ºä¸€ä¸ªå®æ“çš„å®éªŒè¿‡ç¨‹ï¼Œè¿™é‡ŒåŒ…å«äº†æœ¬æ–‡æåˆ°çš„æ‰€æœ‰è¦ç‚¹å’Œç»†èŠ‚ã€‚ ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:3:2","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#åº•å±‚å­˜å‚¨æ¥å£çš„æš´éœ²"},{"categories":["Nebula Graph"],"content":" 3.3 ä¼ è¾“å±‚çš„åŠ å¯†æˆ‘ä»¬åœ¨å‰ä¸€ä¸ªé—®é¢˜ä¸­æåŠåˆ°äº†ï¼Œåœ¨ APISIX ç½‘å…³ä¸­ terminate TLSv1.3 çš„è¿æ¥ï¼Œå€ŸåŠ© SNI ä¿¡æ¯è·¯ç”± StorageD çš„æ–¹æ³•ï¼Œå…¶å®ï¼Œå•ç‹¬å°† GraphD æ¥å£çš„ TLS äº¤ç»™ç½‘å…³æ¥åšï¼Œå¥½å¤„ä¹Ÿæ˜¯éå¸¸æ˜æ˜¾çš„ï¼š è¯ä¹¦ç®¡ç†åœ¨ç»Ÿä¸€çš„ç½‘å…³æ§åˆ¶é¢åšï¼Œæ›´åŠ æ–¹ä¾¿ è¯ä¹¦è¿ç»´æ—  NebulaGraph é›†ç¾¤é…ç½®ä¾µå…¥ï¼ˆNebulaGraph åŸç”Ÿæ”¯æŒ TLS åŠ å¯†ï¼Œä½†æ˜¯åŠ å¯†ä¹‹åå¸¦æ¥äº†é›†ç¾¤å†…éƒ¨é€šä¿¡çš„å¼€é”€ï¼Œè€Œä¸”é…ç½®å’Œé›†ç¾¤å…¶ä»–å±‚é¢é…ç½®åœ¨ä¸€èµ·ï¼Œè¯ä¹¦æ›´æ–°æ¶‰åŠè¿›ç¨‹é‡å¯ï¼Œä¸å¤Ÿçµæ´»ï¼‰ å…·ä½“çš„æ–¹æ³•åœ¨åè¾¹å®æ“ä¸­ä¹Ÿæ˜¯æœ‰ä½“ç°çš„ã€‚ ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:3:3","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#ä¼ è¾“å±‚çš„åŠ å¯†"},{"categories":["Nebula Graph"],"content":" 4 å®æ“ï¼šåˆ©ç”¨ APISIX çš„ stream-proxy æš´éœ² StorageD çš„æ¥å£","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:4:0","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#å®æ“åˆ©ç”¨-apisix-çš„-stream-proxy-æš´éœ²-storaged-çš„æ¥å£"},{"categories":["Nebula Graph"],"content":" 4.1 å®éªŒç¯å¢ƒï¼šminikubeæˆ‘ä»¬å°±åœ¨æœ¬åœ°çš„ minikube ä¸Šåšè¿™ä¸ªå®éªŒå§ï¼Œé¦–å…ˆå¯åŠ¨ä¸€ä¸ª minikubeï¼Œå› ä¸º APISIX å†…éƒ¨çš„ etcd éœ€è¦ç”¨åˆ° storageclassï¼Œæˆ‘ä»¬å¸¦ä¸Š ç©·äººç‰ˆçš„ storageclass æ’ä»¶ï¼ŒåŒæ—¶ï¼Œä¸ºäº†åœ¨ k8s å¤–éƒ¨è®¿é—® storaged çš„æ—¶å€™ç”¨å’Œå†…éƒ¨ç›¸åŒçš„åŸŸåå’Œç«¯å£ï¼Œæˆ‘ä»¬æŠŠ node-port å…è®¸çš„ç«¯å£æ‰©å……åˆ°å°äº 9779 çš„èŒƒå›´ã€‚ minikube start \\ --addons=\"default-storageclass\" \\ --extra-config=apiserver.service-node-port-range=1-65535 ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:4:1","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#å®éªŒç¯å¢ƒminikube"},{"categories":["Nebula Graph"],"content":" 4.2 å®éªŒç¯å¢ƒï¼šNebulaGraph on K8sè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ Nebula Operator æ¥éƒ¨ç½² NebulaGraph é›†ç¾¤ï¼Œå…·ä½“çš„éƒ¨ç½²æ–¹æ³•å¯ä»¥å‚è€ƒ Nebula Operator æ–‡æ¡£ã€‚ å’±ä»¬åšå®éªŒï¼Œå°±å·ä¸ªæ‡’ï¼Œç”¨æˆ‘å†™çš„ Nebula-Operator-KinD æ¥ä¸€é”®éƒ¨ç½²ï¼š curl -sL nebula-kind.siwei.io/install-on-k8s.sh | bash ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:4:2","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#å®éªŒç¯å¢ƒnebulagraph-on-k8s"},{"categories":["Nebula Graph"],"content":" 4.3 å®éªŒç¯å¢ƒï¼šAPISIX on k8sé¦–å…ˆæ˜¯å®‰è£…ï¼Œåœ¨ Helm å‚æ•°ä¸­æŒ‡å®šæ‰“å¼€ stream-proxy çš„å¼€å…³ï¼š helm repo add apisix https://charts.apiseven.com helm repo add bitnami https://charts.bitnami.com/bitnami helm repo update helm install apisix apisix/apisix \\ --set gateway.type=NodePort \\ --set gateway.stream.enabled=true \\ --set ingress-controller.enabled=true # dashboard ä¹Ÿè£…ä¸Šï¼Œæ–¹ä¾¿æˆ‘ä»¬ç»•è¿‡ admin API call åšä¸€äº›æ–¹ä¾¿çš„æ“ä½œã€‚ helm install apisix-dashboard apisix/apisix-dashboard ç„¶åï¼Œå› ä¸ºæˆªæ­¢åˆ°ç°åœ¨ï¼ŒAPISIX çš„ Helm Chart ä¹‹ä¸­å¹¶æ²¡æœ‰æä¾› stream-proxy TCP çš„ç›‘å¬ç«¯å£çš„ TLS æ”¯æŒçš„é…ç½®æ ¼å¼ï¼Œè§ https://github.com/apache/apisix-helm-chart/issues/348 ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ›´æ”¹ APISIX çš„ configmapï¼ŒæŠŠ stream-proxy çš„ TLS é…ç½®åŠ ä¸Šï¼š kubectl edit ConfigMap apisix æˆ‘ä»¬ç¼–è¾‘æŠŠ stream_proxy.tcp æ”¹å†™æˆè¿™æ ·ï¼š stream_proxy: # TCP/UDP proxy only: false tcp: # TCP proxy port list - addr: 9779 tls: true - addr: 9559 tls: true è¿™é‡Œæˆ‘ä»¬éœ€è¦é‡å»º APISIX Podï¼Œå› ä¸º APISIX çš„ stream-proxy çš„ TLS é…ç½®æ˜¯åœ¨å¯åŠ¨çš„æ—¶å€™åŠ è½½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡å»º APISIX Podï¼š kubectl delete $(kubectl get po -l \"app.kubernetes.io/name=apisix\" -o name) ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:4:3","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#å®éªŒç¯å¢ƒapisix-on-k8s"},{"categories":["Nebula Graph"],"content":" 4.4 å¼€å§‹å®éªŒæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå®éªŒçš„ç›®æ ‡ï¼Œå°±æ˜¯æŠŠ NebulaGraph çš„ StorageD çš„æ¥å£æš´éœ²å‡ºæ¥ï¼Œè®©å¤–éƒ¨çš„å®¢æˆ·ç«¯å¯ä»¥è®¿é—®åˆ°ï¼Œè€Œæš´éœ²çš„æ–¹å¼å¦‚å›¾ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ K8s Cluster â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ NebulaGraph Cluster â”‚ â”‚ â”‚ â”‚ APISIX API-GATEWAY â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-0 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ stream-proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ .â”€â”€â”€â”€â”€. â”‚ â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚â•± â•² â”‚ â”‚ - addr: 9559 â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ Storaged-1 â”‚ â”‚ â”‚ â”â”â”« DNS â”£â”â”( Service )â•‹â”â”â”â•‹â–¶ tls: true â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚`. ,' â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ `â”€â”€â”€' â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚SNI â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-2 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-3 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æˆ‘ä»¬å·²ç»æœ‰äº†æ‰€æœ‰çš„æ¡†æ¶ï¼Œæˆ‘ä»¬è¦å¾€é‡Œå¡«ç®­å¤´å’Œåœ†åœˆäº†ã€‚ $ kubectl get po NAME READY STATUS RESTARTS AGE apisix-6d89854bc5-5m788 1/1 Running 1 (31h ago) 2d4h apisix-dashboard-b544bd766-nh79j 1/1 Running 8 (31h ago) 2d10h apisix-etcd-0 1/1 Running 2 (31h ago) 2d10h apisix-etcd-1 1/1 Running 2 (31h ago) 2d10h apisix-etcd-2 1/1 Running 2 (31h ago) 2d10h nebula-graphd-0 1/1 Running 2 (31h ago) 3d4h nebula-metad-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-1 1/1 Running 2 (31h ago) 3d4h nebula-storaged-2 1/1 Running 2 (31h ago) 3d4h 4.4.1 é…ç½® APISIX çš„ stream-proxyå‚è€ƒ APISIX æ–‡æ¡£ï¼šhttps://apisix.apache.org/docs/apisix/stream-proxy/#accept-tls-over-tcp-connection æˆ‘ä»¬ç”¨ APISIX çš„ API æ¥é…ç½® stream-proxyï¼š apisix_api_key=\"edd1c9f034335f136f87ad84b625c8f1\" apisix_pod=$(kubectl get po -l \\ \"app.kubernetes.io/name=apisix\" -o name) kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.13:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/2 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-1.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.18:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/3 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-2.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.5:9779\": 1 }, \"type\": \"roundrobin\" } }' æ³¨æ„ï¼Œå½“ä¸‹ï¼ŒAPISIX çš„ stream-proxy ä¸Šæ¸¸èŠ‚ç‚¹ä¸æ”¯æŒåŸŸåè§£æï¼Œæ˜¯å—é™äºä¸Šæ¸¸çš„ lua åº“ï¼Œè¯¦è§æˆ‘æŠ¥çš„ issueï¼šhttps://github.com/apache/apisix/issues/8334 ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿™é‡Œåº”è¯¥ç»™å‡ºæ¯ä¸€ä¸ª storaged çš„ SNI ç›¸åŒçš„åœ°å€ä½œä¸º upstream.nodesï¼Œå¥½åƒï¼š kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\": 1 }, \"type\": \"roundrobin\" } }' 4.4.2 é…ç½® APISIX ä¸­ storaged åœ°å€çš„ TLS è¯ä¹¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥äº‘åŸç”Ÿçš„æ–¹å¼å»ç®¡ç†è‡ªç­¾æˆ–è€…å…¬å…±ä¿¡ä»»çš„è¯ä¹¦ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨åˆ©ç”¨ mkcert å·¥å…·æ¥åšè¿™ä»¶äº‹å„¿ã€‚ å®‰è£… mkcert # é¦–æ¬¡è¿è¡Œï¼Œéœ€è¦å®‰è£… mkcertï¼Œå¹¶ä¸”ç”Ÿæˆæ ¹è¯ä¹¦ # macOS çš„è¯ brew install mkcert # ubuntu çš„è¯ apt-get install wget libnss3-tools # ç„¶åå†å» https://github.com/FiloSottile/mkcert/releases/ ä¸‹è½½ mkcert ç­¾å‘è¯ä¹¦ï¼š mkcert '*.nebula-storaged-headless.default.svc.cluster.local' åˆ©ç”¨ APISIX-dashboard å°†è¯ä¹¦å¯¼å…¥åˆ° APISIX ä¹‹ä¸­ å•ç‹¬å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¿è¡Œï¼š export POD_NAME=$(\\ kubectl get pods","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:4:4","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#å¼€å§‹å®éªŒ"},{"categories":["Nebula Graph"],"content":" 4.4 å¼€å§‹å®éªŒæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå®éªŒçš„ç›®æ ‡ï¼Œå°±æ˜¯æŠŠ NebulaGraph çš„ StorageD çš„æ¥å£æš´éœ²å‡ºæ¥ï¼Œè®©å¤–éƒ¨çš„å®¢æˆ·ç«¯å¯ä»¥è®¿é—®åˆ°ï¼Œè€Œæš´éœ²çš„æ–¹å¼å¦‚å›¾ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ K8s Cluster â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ NebulaGraph Cluster â”‚ â”‚ â”‚ â”‚ APISIX API-GATEWAY â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-0 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ stream-proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ .â”€â”€â”€â”€â”€. â”‚ â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚â•± â•² â”‚ â”‚ - addr: 9559 â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ Storaged-1 â”‚ â”‚ â”‚ â”â”â”« DNS â”£â”â”( Service )â•‹â”â”â”â•‹â–¶ tls: true â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚`. ,' â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ `â”€â”€â”€' â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚SNI â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-2 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-3 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æˆ‘ä»¬å·²ç»æœ‰äº†æ‰€æœ‰çš„æ¡†æ¶ï¼Œæˆ‘ä»¬è¦å¾€é‡Œå¡«ç®­å¤´å’Œåœ†åœˆäº†ã€‚ $ kubectl get po NAME READY STATUS RESTARTS AGE apisix-6d89854bc5-5m788 1/1 Running 1 (31h ago) 2d4h apisix-dashboard-b544bd766-nh79j 1/1 Running 8 (31h ago) 2d10h apisix-etcd-0 1/1 Running 2 (31h ago) 2d10h apisix-etcd-1 1/1 Running 2 (31h ago) 2d10h apisix-etcd-2 1/1 Running 2 (31h ago) 2d10h nebula-graphd-0 1/1 Running 2 (31h ago) 3d4h nebula-metad-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-1 1/1 Running 2 (31h ago) 3d4h nebula-storaged-2 1/1 Running 2 (31h ago) 3d4h 4.4.1 é…ç½® APISIX çš„ stream-proxyå‚è€ƒ APISIX æ–‡æ¡£ï¼šhttps://apisix.apache.org/docs/apisix/stream-proxy/#accept-tls-over-tcp-connection æˆ‘ä»¬ç”¨ APISIX çš„ API æ¥é…ç½® stream-proxyï¼š apisix_api_key=\"edd1c9f034335f136f87ad84b625c8f1\" apisix_pod=$(kubectl get po -l \\ \"app.kubernetes.io/name=apisix\" -o name) kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.13:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/2 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-1.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.18:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/3 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-2.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.5:9779\": 1 }, \"type\": \"roundrobin\" } }' æ³¨æ„ï¼Œå½“ä¸‹ï¼ŒAPISIX çš„ stream-proxy ä¸Šæ¸¸èŠ‚ç‚¹ä¸æ”¯æŒåŸŸåè§£æï¼Œæ˜¯å—é™äºä¸Šæ¸¸çš„ lua åº“ï¼Œè¯¦è§æˆ‘æŠ¥çš„ issueï¼šhttps://github.com/apache/apisix/issues/8334 ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿™é‡Œåº”è¯¥ç»™å‡ºæ¯ä¸€ä¸ª storaged çš„ SNI ç›¸åŒçš„åœ°å€ä½œä¸º upstream.nodesï¼Œå¥½åƒï¼š kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\": 1 }, \"type\": \"roundrobin\" } }' 4.4.2 é…ç½® APISIX ä¸­ storaged åœ°å€çš„ TLS è¯ä¹¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥äº‘åŸç”Ÿçš„æ–¹å¼å»ç®¡ç†è‡ªç­¾æˆ–è€…å…¬å…±ä¿¡ä»»çš„è¯ä¹¦ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨åˆ©ç”¨ mkcert å·¥å…·æ¥åšè¿™ä»¶äº‹å„¿ã€‚ å®‰è£… mkcert # é¦–æ¬¡è¿è¡Œï¼Œéœ€è¦å®‰è£… mkcertï¼Œå¹¶ä¸”ç”Ÿæˆæ ¹è¯ä¹¦ # macOS çš„è¯ brew install mkcert # ubuntu çš„è¯ apt-get install wget libnss3-tools # ç„¶åå†å» https://github.com/FiloSottile/mkcert/releases/ ä¸‹è½½ mkcert ç­¾å‘è¯ä¹¦ï¼š mkcert '*.nebula-storaged-headless.default.svc.cluster.local' åˆ©ç”¨ APISIX-dashboard å°†è¯ä¹¦å¯¼å…¥åˆ° APISIX ä¹‹ä¸­ å•ç‹¬å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¿è¡Œï¼š export POD_NAME=$(\\ kubectl get pods","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:4:4","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#é…ç½®-apisix-çš„-stream-proxy"},{"categories":["Nebula Graph"],"content":" 4.4 å¼€å§‹å®éªŒæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå®éªŒçš„ç›®æ ‡ï¼Œå°±æ˜¯æŠŠ NebulaGraph çš„ StorageD çš„æ¥å£æš´éœ²å‡ºæ¥ï¼Œè®©å¤–éƒ¨çš„å®¢æˆ·ç«¯å¯ä»¥è®¿é—®åˆ°ï¼Œè€Œæš´éœ²çš„æ–¹å¼å¦‚å›¾ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ K8s Cluster â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ NebulaGraph Cluster â”‚ â”‚ â”‚ â”‚ APISIX API-GATEWAY â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-0 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ stream-proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ .â”€â”€â”€â”€â”€. â”‚ â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚â•± â•² â”‚ â”‚ - addr: 9559 â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ Storaged-1 â”‚ â”‚ â”‚ â”â”â”« DNS â”£â”â”( Service )â•‹â”â”â”â•‹â–¶ tls: true â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚`. ,' â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ `â”€â”€â”€' â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚SNI â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-2 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-3 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æˆ‘ä»¬å·²ç»æœ‰äº†æ‰€æœ‰çš„æ¡†æ¶ï¼Œæˆ‘ä»¬è¦å¾€é‡Œå¡«ç®­å¤´å’Œåœ†åœˆäº†ã€‚ $ kubectl get po NAME READY STATUS RESTARTS AGE apisix-6d89854bc5-5m788 1/1 Running 1 (31h ago) 2d4h apisix-dashboard-b544bd766-nh79j 1/1 Running 8 (31h ago) 2d10h apisix-etcd-0 1/1 Running 2 (31h ago) 2d10h apisix-etcd-1 1/1 Running 2 (31h ago) 2d10h apisix-etcd-2 1/1 Running 2 (31h ago) 2d10h nebula-graphd-0 1/1 Running 2 (31h ago) 3d4h nebula-metad-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-1 1/1 Running 2 (31h ago) 3d4h nebula-storaged-2 1/1 Running 2 (31h ago) 3d4h 4.4.1 é…ç½® APISIX çš„ stream-proxyå‚è€ƒ APISIX æ–‡æ¡£ï¼šhttps://apisix.apache.org/docs/apisix/stream-proxy/#accept-tls-over-tcp-connection æˆ‘ä»¬ç”¨ APISIX çš„ API æ¥é…ç½® stream-proxyï¼š apisix_api_key=\"edd1c9f034335f136f87ad84b625c8f1\" apisix_pod=$(kubectl get po -l \\ \"app.kubernetes.io/name=apisix\" -o name) kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.13:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/2 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-1.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.18:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/3 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-2.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.5:9779\": 1 }, \"type\": \"roundrobin\" } }' æ³¨æ„ï¼Œå½“ä¸‹ï¼ŒAPISIX çš„ stream-proxy ä¸Šæ¸¸èŠ‚ç‚¹ä¸æ”¯æŒåŸŸåè§£æï¼Œæ˜¯å—é™äºä¸Šæ¸¸çš„ lua åº“ï¼Œè¯¦è§æˆ‘æŠ¥çš„ issueï¼šhttps://github.com/apache/apisix/issues/8334 ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿™é‡Œåº”è¯¥ç»™å‡ºæ¯ä¸€ä¸ª storaged çš„ SNI ç›¸åŒçš„åœ°å€ä½œä¸º upstream.nodesï¼Œå¥½åƒï¼š kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\": 1 }, \"type\": \"roundrobin\" } }' 4.4.2 é…ç½® APISIX ä¸­ storaged åœ°å€çš„ TLS è¯ä¹¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥äº‘åŸç”Ÿçš„æ–¹å¼å»ç®¡ç†è‡ªç­¾æˆ–è€…å…¬å…±ä¿¡ä»»çš„è¯ä¹¦ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨åˆ©ç”¨ mkcert å·¥å…·æ¥åšè¿™ä»¶äº‹å„¿ã€‚ å®‰è£… mkcert # é¦–æ¬¡è¿è¡Œï¼Œéœ€è¦å®‰è£… mkcertï¼Œå¹¶ä¸”ç”Ÿæˆæ ¹è¯ä¹¦ # macOS çš„è¯ brew install mkcert # ubuntu çš„è¯ apt-get install wget libnss3-tools # ç„¶åå†å» https://github.com/FiloSottile/mkcert/releases/ ä¸‹è½½ mkcert ç­¾å‘è¯ä¹¦ï¼š mkcert '*.nebula-storaged-headless.default.svc.cluster.local' åˆ©ç”¨ APISIX-dashboard å°†è¯ä¹¦å¯¼å…¥åˆ° APISIX ä¹‹ä¸­ å•ç‹¬å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¿è¡Œï¼š export POD_NAME=$(\\ kubectl get pods","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:4:4","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#é…ç½®-apisix-ä¸­-storaged-åœ°å€çš„-tls-è¯ä¹¦"},{"categories":["Nebula Graph"],"content":" 4.4 å¼€å§‹å®éªŒæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå®éªŒçš„ç›®æ ‡ï¼Œå°±æ˜¯æŠŠ NebulaGraph çš„ StorageD çš„æ¥å£æš´éœ²å‡ºæ¥ï¼Œè®©å¤–éƒ¨çš„å®¢æˆ·ç«¯å¯ä»¥è®¿é—®åˆ°ï¼Œè€Œæš´éœ²çš„æ–¹å¼å¦‚å›¾ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ K8s Cluster â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ NebulaGraph Cluster â”‚ â”‚ â”‚ â”‚ APISIX API-GATEWAY â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-0 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ stream-proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ .â”€â”€â”€â”€â”€. â”‚ â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚â•± â•² â”‚ â”‚ - addr: 9559 â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ Storaged-1 â”‚ â”‚ â”‚ â”â”â”« DNS â”£â”â”( Service )â•‹â”â”â”â•‹â–¶ tls: true â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚`. ,' â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ `â”€â”€â”€' â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚SNI â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-2 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-3 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æˆ‘ä»¬å·²ç»æœ‰äº†æ‰€æœ‰çš„æ¡†æ¶ï¼Œæˆ‘ä»¬è¦å¾€é‡Œå¡«ç®­å¤´å’Œåœ†åœˆäº†ã€‚ $ kubectl get po NAME READY STATUS RESTARTS AGE apisix-6d89854bc5-5m788 1/1 Running 1 (31h ago) 2d4h apisix-dashboard-b544bd766-nh79j 1/1 Running 8 (31h ago) 2d10h apisix-etcd-0 1/1 Running 2 (31h ago) 2d10h apisix-etcd-1 1/1 Running 2 (31h ago) 2d10h apisix-etcd-2 1/1 Running 2 (31h ago) 2d10h nebula-graphd-0 1/1 Running 2 (31h ago) 3d4h nebula-metad-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-1 1/1 Running 2 (31h ago) 3d4h nebula-storaged-2 1/1 Running 2 (31h ago) 3d4h 4.4.1 é…ç½® APISIX çš„ stream-proxyå‚è€ƒ APISIX æ–‡æ¡£ï¼šhttps://apisix.apache.org/docs/apisix/stream-proxy/#accept-tls-over-tcp-connection æˆ‘ä»¬ç”¨ APISIX çš„ API æ¥é…ç½® stream-proxyï¼š apisix_api_key=\"edd1c9f034335f136f87ad84b625c8f1\" apisix_pod=$(kubectl get po -l \\ \"app.kubernetes.io/name=apisix\" -o name) kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.13:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/2 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-1.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.18:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/3 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-2.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.5:9779\": 1 }, \"type\": \"roundrobin\" } }' æ³¨æ„ï¼Œå½“ä¸‹ï¼ŒAPISIX çš„ stream-proxy ä¸Šæ¸¸èŠ‚ç‚¹ä¸æ”¯æŒåŸŸåè§£æï¼Œæ˜¯å—é™äºä¸Šæ¸¸çš„ lua åº“ï¼Œè¯¦è§æˆ‘æŠ¥çš„ issueï¼šhttps://github.com/apache/apisix/issues/8334 ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿™é‡Œåº”è¯¥ç»™å‡ºæ¯ä¸€ä¸ª storaged çš„ SNI ç›¸åŒçš„åœ°å€ä½œä¸º upstream.nodesï¼Œå¥½åƒï¼š kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\": 1 }, \"type\": \"roundrobin\" } }' 4.4.2 é…ç½® APISIX ä¸­ storaged åœ°å€çš„ TLS è¯ä¹¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥äº‘åŸç”Ÿçš„æ–¹å¼å»ç®¡ç†è‡ªç­¾æˆ–è€…å…¬å…±ä¿¡ä»»çš„è¯ä¹¦ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨åˆ©ç”¨ mkcert å·¥å…·æ¥åšè¿™ä»¶äº‹å„¿ã€‚ å®‰è£… mkcert # é¦–æ¬¡è¿è¡Œï¼Œéœ€è¦å®‰è£… mkcertï¼Œå¹¶ä¸”ç”Ÿæˆæ ¹è¯ä¹¦ # macOS çš„è¯ brew install mkcert # ubuntu çš„è¯ apt-get install wget libnss3-tools # ç„¶åå†å» https://github.com/FiloSottile/mkcert/releases/ ä¸‹è½½ mkcert ç­¾å‘è¯ä¹¦ï¼š mkcert '*.nebula-storaged-headless.default.svc.cluster.local' åˆ©ç”¨ APISIX-dashboard å°†è¯ä¹¦å¯¼å…¥åˆ° APISIX ä¹‹ä¸­ å•ç‹¬å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¿è¡Œï¼š export POD_NAME=$(\\ kubectl get pods","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:4:4","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#å¢åŠ -apisix-çš„-nodeport-service"},{"categories":["Nebula Graph"],"content":" 4.4 å¼€å§‹å®éªŒæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå®éªŒçš„ç›®æ ‡ï¼Œå°±æ˜¯æŠŠ NebulaGraph çš„ StorageD çš„æ¥å£æš´éœ²å‡ºæ¥ï¼Œè®©å¤–éƒ¨çš„å®¢æˆ·ç«¯å¯ä»¥è®¿é—®åˆ°ï¼Œè€Œæš´éœ²çš„æ–¹å¼å¦‚å›¾ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ K8s Cluster â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ NebulaGraph Cluster â”‚ â”‚ â”‚ â”‚ APISIX API-GATEWAY â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-0 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ stream-proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ .â”€â”€â”€â”€â”€. â”‚ â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚â•± â•² â”‚ â”‚ - addr: 9559 â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ Storaged-1 â”‚ â”‚ â”‚ â”â”â”« DNS â”£â”â”( Service )â•‹â”â”â”â•‹â–¶ tls: true â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚`. ,' â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ `â”€â”€â”€' â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚SNI â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-2 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-3 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æˆ‘ä»¬å·²ç»æœ‰äº†æ‰€æœ‰çš„æ¡†æ¶ï¼Œæˆ‘ä»¬è¦å¾€é‡Œå¡«ç®­å¤´å’Œåœ†åœˆäº†ã€‚ $ kubectl get po NAME READY STATUS RESTARTS AGE apisix-6d89854bc5-5m788 1/1 Running 1 (31h ago) 2d4h apisix-dashboard-b544bd766-nh79j 1/1 Running 8 (31h ago) 2d10h apisix-etcd-0 1/1 Running 2 (31h ago) 2d10h apisix-etcd-1 1/1 Running 2 (31h ago) 2d10h apisix-etcd-2 1/1 Running 2 (31h ago) 2d10h nebula-graphd-0 1/1 Running 2 (31h ago) 3d4h nebula-metad-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-1 1/1 Running 2 (31h ago) 3d4h nebula-storaged-2 1/1 Running 2 (31h ago) 3d4h 4.4.1 é…ç½® APISIX çš„ stream-proxyå‚è€ƒ APISIX æ–‡æ¡£ï¼šhttps://apisix.apache.org/docs/apisix/stream-proxy/#accept-tls-over-tcp-connection æˆ‘ä»¬ç”¨ APISIX çš„ API æ¥é…ç½® stream-proxyï¼š apisix_api_key=\"edd1c9f034335f136f87ad84b625c8f1\" apisix_pod=$(kubectl get po -l \\ \"app.kubernetes.io/name=apisix\" -o name) kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.13:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/2 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-1.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.18:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/3 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-2.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.5:9779\": 1 }, \"type\": \"roundrobin\" } }' æ³¨æ„ï¼Œå½“ä¸‹ï¼ŒAPISIX çš„ stream-proxy ä¸Šæ¸¸èŠ‚ç‚¹ä¸æ”¯æŒåŸŸåè§£æï¼Œæ˜¯å—é™äºä¸Šæ¸¸çš„ lua åº“ï¼Œè¯¦è§æˆ‘æŠ¥çš„ issueï¼šhttps://github.com/apache/apisix/issues/8334 ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿™é‡Œåº”è¯¥ç»™å‡ºæ¯ä¸€ä¸ª storaged çš„ SNI ç›¸åŒçš„åœ°å€ä½œä¸º upstream.nodesï¼Œå¥½åƒï¼š kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\": 1 }, \"type\": \"roundrobin\" } }' 4.4.2 é…ç½® APISIX ä¸­ storaged åœ°å€çš„ TLS è¯ä¹¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥äº‘åŸç”Ÿçš„æ–¹å¼å»ç®¡ç†è‡ªç­¾æˆ–è€…å…¬å…±ä¿¡ä»»çš„è¯ä¹¦ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨åˆ©ç”¨ mkcert å·¥å…·æ¥åšè¿™ä»¶äº‹å„¿ã€‚ å®‰è£… mkcert # é¦–æ¬¡è¿è¡Œï¼Œéœ€è¦å®‰è£… mkcertï¼Œå¹¶ä¸”ç”Ÿæˆæ ¹è¯ä¹¦ # macOS çš„è¯ brew install mkcert # ubuntu çš„è¯ apt-get install wget libnss3-tools # ç„¶åå†å» https://github.com/FiloSottile/mkcert/releases/ ä¸‹è½½ mkcert ç­¾å‘è¯ä¹¦ï¼š mkcert '*.nebula-storaged-headless.default.svc.cluster.local' åˆ©ç”¨ APISIX-dashboard å°†è¯ä¹¦å¯¼å…¥åˆ° APISIX ä¹‹ä¸­ å•ç‹¬å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¿è¡Œï¼š export POD_NAME=$(\\ kubectl get pods","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:4:4","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#é…ç½®-k8s-å¤–éƒ¨-dns"},{"categories":["Nebula Graph"],"content":" 4.4 å¼€å§‹å®éªŒæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå®éªŒçš„ç›®æ ‡ï¼Œå°±æ˜¯æŠŠ NebulaGraph çš„ StorageD çš„æ¥å£æš´éœ²å‡ºæ¥ï¼Œè®©å¤–éƒ¨çš„å®¢æˆ·ç«¯å¯ä»¥è®¿é—®åˆ°ï¼Œè€Œæš´éœ²çš„æ–¹å¼å¦‚å›¾ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ K8s Cluster â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ NebulaGraph Cluster â”‚ â”‚ â”‚ â”‚ APISIX API-GATEWAY â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-0 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ stream-proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ .â”€â”€â”€â”€â”€. â”‚ â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚â•± â•² â”‚ â”‚ - addr: 9559 â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ Storaged-1 â”‚ â”‚ â”‚ â”â”â”« DNS â”£â”â”( Service )â•‹â”â”â”â•‹â–¶ tls: true â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚`. ,' â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ `â”€â”€â”€' â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚SNI â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-2 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Storaged-3 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æˆ‘ä»¬å·²ç»æœ‰äº†æ‰€æœ‰çš„æ¡†æ¶ï¼Œæˆ‘ä»¬è¦å¾€é‡Œå¡«ç®­å¤´å’Œåœ†åœˆäº†ã€‚ $ kubectl get po NAME READY STATUS RESTARTS AGE apisix-6d89854bc5-5m788 1/1 Running 1 (31h ago) 2d4h apisix-dashboard-b544bd766-nh79j 1/1 Running 8 (31h ago) 2d10h apisix-etcd-0 1/1 Running 2 (31h ago) 2d10h apisix-etcd-1 1/1 Running 2 (31h ago) 2d10h apisix-etcd-2 1/1 Running 2 (31h ago) 2d10h nebula-graphd-0 1/1 Running 2 (31h ago) 3d4h nebula-metad-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-0 1/1 Running 2 (31h ago) 3d4h nebula-storaged-1 1/1 Running 2 (31h ago) 3d4h nebula-storaged-2 1/1 Running 2 (31h ago) 3d4h 4.4.1 é…ç½® APISIX çš„ stream-proxyå‚è€ƒ APISIX æ–‡æ¡£ï¼šhttps://apisix.apache.org/docs/apisix/stream-proxy/#accept-tls-over-tcp-connection æˆ‘ä»¬ç”¨ APISIX çš„ API æ¥é…ç½® stream-proxyï¼š apisix_api_key=\"edd1c9f034335f136f87ad84b625c8f1\" apisix_pod=$(kubectl get po -l \\ \"app.kubernetes.io/name=apisix\" -o name) kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.13:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/2 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-1.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.18:9779\": 1 }, \"type\": \"roundrobin\" } }' kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/3 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-2.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"172.17.0.5:9779\": 1 }, \"type\": \"roundrobin\" } }' æ³¨æ„ï¼Œå½“ä¸‹ï¼ŒAPISIX çš„ stream-proxy ä¸Šæ¸¸èŠ‚ç‚¹ä¸æ”¯æŒåŸŸåè§£æï¼Œæ˜¯å—é™äºä¸Šæ¸¸çš„ lua åº“ï¼Œè¯¦è§æˆ‘æŠ¥çš„ issueï¼šhttps://github.com/apache/apisix/issues/8334 ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿™é‡Œåº”è¯¥ç»™å‡ºæ¯ä¸€ä¸ª storaged çš„ SNI ç›¸åŒçš„åœ°å€ä½œä¸º upstream.nodesï¼Œå¥½åƒï¼š kubectl exec -it $apisix_pod -- \\ curl http://127.0.0.1:9180/apisix/admin/stream_routes/1 \\ -H \"X-API-KEY: $apisix_api_key\" -X PUT -d \\ '{ \"sni\": \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\", \"upstream\": { \"nodes\": { \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\": 1 }, \"type\": \"roundrobin\" } }' 4.4.2 é…ç½® APISIX ä¸­ storaged åœ°å€çš„ TLS è¯ä¹¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥äº‘åŸç”Ÿçš„æ–¹å¼å»ç®¡ç†è‡ªç­¾æˆ–è€…å…¬å…±ä¿¡ä»»çš„è¯ä¹¦ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨åˆ©ç”¨ mkcert å·¥å…·æ¥åšè¿™ä»¶äº‹å„¿ã€‚ å®‰è£… mkcert # é¦–æ¬¡è¿è¡Œï¼Œéœ€è¦å®‰è£… mkcertï¼Œå¹¶ä¸”ç”Ÿæˆæ ¹è¯ä¹¦ # macOS çš„è¯ brew install mkcert # ubuntu çš„è¯ apt-get install wget libnss3-tools # ç„¶åå†å» https://github.com/FiloSottile/mkcert/releases/ ä¸‹è½½ mkcert ç­¾å‘è¯ä¹¦ï¼š mkcert '*.nebula-storaged-headless.default.svc.cluster.local' åˆ©ç”¨ APISIX-dashboard å°†è¯ä¹¦å¯¼å…¥åˆ° APISIX ä¹‹ä¸­ å•ç‹¬å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¿è¡Œï¼š export POD_NAME=$(\\ kubectl get pods","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:4:4","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#éªŒè¯-nebulagraph-storage-client-å¯ä»¥ä»æ‰€æœ‰çš„èŠ‚ç‚¹ä¸­è·å–åˆ°æ•°æ®"},{"categories":["Nebula Graph"],"content":" 5 æ€»ç»“ NebulaGraph æŸ¥è¯¢æ¥å£çš„è´Ÿè½½å‡è¡¡å¯ä»¥å€ŸåŠ© K8s Serviceæ¥åšï¼› NebulaGraph åº•å±‚å­˜å‚¨æ¥å£çš„æš´éœ²åœ¨ K8s ä¸­å¯ä»¥åˆ©ç”¨ APISIX Stream Proxy å’Œ SNI æ¥ä¼˜é›…å®ç°ï¼› åˆ©ç”¨ API ç½‘å…³å¯¹å‡ºå£ä¼ è¾“å±‚çš„åŠ å¯†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œç›¸è¾ƒäºç”¨ NebulaGraph åŸç”Ÿçš„ TLS çš„æ–¹å¼ã€‚ ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:5:0","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#æ€»ç»“"},{"categories":["Nebula Graph"],"content":" 6 ä¸€äº›å‘ å‘ç° fbthrift python å¹¶ä¸æ”¯æŒ å‘é€ extend host nameï¼ˆSNIï¼‰ï¼Œhttps://github.com/vesoft-inc/nebula-python/pull/238 ï¼Œå†™äº† PR å»åšæ”¯æŒï¼Œè¿™æ—¶å€™ APISIX ä¸­çš„æŠ¥é”™æ˜¯ failed to find SNI: 2022/11/15 10:18:26 [error] 78#78: *1744270 stream [lua] init.lua:842: stream_ssl_phase(): failed to fetch ssl config: failed to find SNI: please check if the client requests via IP or uses an outdated protocol. If you need to report an issue, provide a packet capture file of the TLS handshake., context: ssl_certificate_by_lua*, client: 172.17.0.1, server: 0.0.0.0:9779 å‚è€ƒï¼š https://docs.python.org/3/library/ssl.html#ssl.SSLContext.sslsocket_class https://github.com/apache/thrift/commit/937228e030569bf25ceb379c9491426709792701 https://github.com/apache/thrift/pull/894 https://github.com/apache/thrift/blob/e8353cb46e9f5e71f9b76f55d6bf59530b7f98ef/lib/py/src/transport/TSSLSocket.py#L184 å‘ç° APISIX stream é‡Œè¾¹ä¸è§£æä¸Šæ¸¸ node åŸŸåï¼Œæˆ‘æŸ¥äº†æ‰€æœ‰ä¸€æºœçš„ dns éƒ½æ²¡æœ‰é—®é¢˜ï¼Œå»æäº† issue æ‰çŸ¥é“æ˜¯å·²çŸ¥é—®é¢˜ï¼šhttps://github.com/apache/apisix/issues/8334ï¼Œåªå¥½å…ˆæ‰‹é… IP:Port ä½œç½¢ã€‚ 2022/11/15 12:26:59 [error] 44#44: *9538531 stream [lua] resolver.lua:47: parse_domain(): failed to parse domain: nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local, error: failed to query the DNS server: dns client error: 101 empty record received while prereading client data, client: 172.17.0.1, server: 0.0.0.0:9779 2022/11/15 12:26:59 [error] 44#44: *9538531 stream [lua] upstream.lua:79: parse_domain_for_nodes(): dns resolver domain: nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local error: failed to query the DNS server: dns client error: 101 empty record received while prereading client data, client: 172.17.0.1, server: 0.0.0.0:9779 2022/11/15 12:26:59 [error] 44#44: *9538531 stream [lua] init.lua:965: stream_preread_phase(): failed to set upstream: no valid upstream node while prereading client data, client: 172.17.0.1, server: 0.0.0.0:9779 é¢˜å›¾ç‰ˆæƒ Lars ","date":"2022-11-16","objectID":"/apisix-and-nebulagraph/:6:0","series":null,"tags":["Nebula Graph","API Gateway","äº‘åŸç”Ÿ","k8s"],"title":"NebulaGraph çš„äº‘åŸç”Ÿ API ç½‘å…³æœ€ä½³å®è·µ","uri":"/apisix-and-nebulagraph/#ä¸€äº›å‘"},{"categories":["Nebula Graph"],"content":"å¦‚ä½•æŠŠç›¸å¯¹åŸå§‹çš„æ•°æ®å¤„ç†ã€å»ºæ¨¡å¹¶å¯¼å…¥ NebulaGraphï¼Ÿæœ¬æ–‡ç”¨ä¸€ä¸ªç«¯åˆ°ç«¯çš„ç¤ºä¾‹æ¼”ç¤ºï¼Œä»å¤šæ•°æ®æºèšåˆæ•°æ®ï¼Œæ¸…ç†ã€åˆ©ç”¨ dbt è½¬æ¢æˆ NebulaGraph å»ºæ¨¡çš„å±æ€§å›¾ç‚¹è¾¹è®°å½•ï¼Œæœ€åå¯¼å…¥æˆå›¾è°±çš„å…¨æµç¨‹ã€‚","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/"},{"categories":["Nebula Graph"],"content":" å¦‚ä½•æŠŠç›¸å¯¹åŸå§‹çš„æ•°æ®å¤„ç†ã€å»ºæ¨¡å¹¶å¯¼å…¥ NebulaGraphï¼Ÿæœ¬æ–‡ç”¨ä¸€ä¸ªç«¯åˆ°ç«¯çš„ç¤ºä¾‹æ¼”ç¤ºï¼Œä»å¤šæ•°æ®æºèšåˆæ•°æ®ï¼Œæ¸…ç†ã€åˆ©ç”¨ dbt è½¬æ¢æˆ NebulaGraph å»ºæ¨¡çš„å±æ€§å›¾ç‚¹è¾¹è®°å½•ï¼Œæœ€åå¯¼å…¥æˆå›¾è°±çš„å…¨æµç¨‹ã€‚ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:0:0","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#"},{"categories":["Nebula Graph"],"content":" 1 ä»»åŠ¡å‡è®¾ä½œä¸ºä¸€ä¸ªç±»ä¼¼äº Netflixã€çˆ±å¥‡è‰ºçš„æœåŠ¡æä¾›å•†ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ NebulaGraph æ­å»ºä¸€ä¸ªç”¨æˆ·-ç”µå½±çŸ¥è¯†å›¾è°±ï¼Œæ¥è¾…åŠ©æ”¯æ’‘æ¨èã€é—®ç­”å’Œæ¨èç†ç”±ç­‰å¸¸è§ç”±å›¾è°±æ”¯æ’‘çš„åœºæ™¯ã€‚ çŸ¥è¯†å›¾è°±éœ€è¦çš„æ•°æ®å­˜åœ¨åœ¨ä¸åŒçš„æ•°æ®æºï¼Œæ¯”å¦‚ä¸€äº›å…¬å¼€çš„ APIã€æ•°ä»“ä¸­çš„ä¸åŒæ•°æ®åº“ã€é™æ€çš„æ–‡ä»¶ç­‰ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤æ¥ä»æ•°æ®æ„å»ºå›¾è°±ï¼š åˆ†æå¯èƒ½è·å–çš„æ•°æ® é€‰å–å…³å¿ƒçš„å…³è”å…³ç³»ï¼Œå›¾å»ºæ¨¡ æŠ½å–å…³è”å…³ç³»ï¼Œå¯¼å…¥å›¾æ•°æ®åº“ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:1:0","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#ä»»åŠ¡"},{"categories":["Nebula Graph"],"content":" 2 æ•°æ®æ¥æºå‡è®¾æˆ‘ä»¬çš„æ•°æ®æ¥æºæ˜¯ OMDB å’Œ MovieLensã€‚ OMDB æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ç”µå½±æ•°æ®åº“ï¼Œæœ¬ä¾‹ä¸­æˆ‘ä»¬æ¨¡æ‹Ÿå…¬å¸å†…éƒ¨çš„ä¸šåŠ¡ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—çš„ä¿¡æ¯æœ‰ï¼š ç”µå½± ç”µå½±çš„åˆ†ç±» ç”µå½±ä¸­çš„å·¥ä½œäººå‘˜ï¼ˆå¯¼æ¼”ã€åŠ¨ä½œæŒ‡å¯¼ã€æ¼”å‘˜ã€åæœŸåˆ¶ä½œç­‰ï¼‰ ç”µå½±å°é¢ã€å®£ä¼ ç‰‡ç­‰ MovieLens æ˜¯ä¸€ä¸ªå¼€æ”¾çš„æ•°æ®é›†ï¼Œæœ¬ä¾‹ä¸­æˆ‘ä»¬æ¨¡æ‹Ÿå…¬å¸å†…éƒ¨çš„ç”¨æˆ·æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—çš„ä¿¡æ¯æœ‰ï¼š ç”¨æˆ· ç”µå½± ç”¨æˆ·å¯¹ç”µå½±çš„è¯„åˆ†äº¤äº’ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:2:0","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#æ•°æ®æ¥æº"},{"categories":["Nebula Graph"],"content":" 3 å›¾å»ºæ¨¡åœ¨å‰è¾¹æˆ‘ä»¬æ¨èç³»ç»Ÿçš„æ–‡ç« ä¸­æˆ‘ä»¬ä»‹ç»äº†æ¨èç³»ç»Ÿåœ¨å›¾ä¸Šçš„ä¸€äº›åŸºæœ¬çš„æ–¹æ³•ï¼ˆæ–‡ç« çš„é“¾æ¥æ˜¯ www.siwei.io/recommendation-system-with-graphdb/ï¼‰ã€‚å…¶ä¸­çš„åŸºäºå†…å®¹è¿‡æ»¤å…³æ³¨äº†ç”¨æˆ·â€“\u003eç”µå½±ã€ç”µå½±â€“\u003eåˆ†ç±»ã€ç”µå½±â€“\u003eæ¼”å‘˜ã€ç”µå½±â€“\u003eå¯¼æ¼”çš„å…³ç³»ï¼ŒååŒè¿‡æ»¤çš„æ–¹æ³•åˆ™å…³æ³¨ç”¨æˆ·â€“\u003eç”µå½±çš„å…³ç³»ï¼Œæ¨èç†ç”±æœåŠ¡åˆ™å…³æ³¨ä»¥ä¸Šæ‰€æœ‰çš„å…³ç³»ï¼Œæ‰€ä»¥æ€»ç»“èµ·æ¥ï¼Œæˆ‘ä»¬éœ€è¦çš„è¾¹æœ‰ï¼š watched(rate(double)) with_genre directed_by acted_by ç›¸åº”çš„ï¼Œå…¶ä¸­çš„é¡¶ç‚¹ç±»å‹ï¼Œæˆ‘ä»¬å…ˆæ ¹æ®å·²æœ‰çš„ä¿¡æ¯ä¸­ï¼Œé¡¶ç‚¹ä¸­å¯èƒ½éœ€è¦è¢«å…³æ³¨çš„ä¿¡æ¯ä½œä¸ºå±æ€§ï¼Œç»™å‡ºåˆå§‹çš„è§„åˆ’ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:3:0","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#å›¾å»ºæ¨¡"},{"categories":["Nebula Graph"],"content":" 4 æ•°æ®è½¬æ¢æœ‰äº†ç›®æ ‡çš„å›¾è°±ç»“æ„å®šä¹‰ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ‰‹ä¸Šçš„æ•°æ®å¦‚ä½•æ˜ å°„åˆ°å®ƒã€‚ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:4:0","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#æ•°æ®è½¬æ¢"},{"categories":["Nebula Graph"],"content":" 4.1 OMDB æ•°æ®é¦–å…ˆæ˜¯ OMDB ä¸­çš„æ•°æ®ï¼Œå®ƒç”±å¾ˆå¤šè¡¨ç»„æˆï¼Œæ¯”å¦‚ all_movies è¿™å¼ è¡¨ï¼Œå­˜å‚¨äº†æ‰€æœ‰çš„ç”µå½±ã€ä»¥åŠå®ƒä»¬åœ¨ä¸åŒè¯­è¨€ä¸‹çš„åå­—ï¼š movie_id name language_iso_639_1 official_translation 1 Cowboy Bebop de 1 1 Cowboy Bebop en 1 2 Ariel - Abgebrannt in Helsinki de 0 3 Shadows in Paradise en 0 3 Im Schatten des Paradieses de 0 3 Schatten im Paradies de 1 è€Œ all_casts è¡¨æ ¼ä¸­ä¿æœ‰æ‰€æœ‰ç”µå½±ç›¸å…³çš„å·¥ä½œäººå‘˜ï¼š movie_id person_id job_id role position 11 1 21 1 11 1 13 1 11 2 15 Luke Skywalker 1 11 3 15 Han Solo 3 11 4 15 Leia Organa 2 ä½†æ˜¯è¿™é‡Œçš„æ¯ä¸€ä¸ªäººçš„å§“åç­‰ä¿¡æ¯ã€ä»¥åŠä»–/å¥¹åœ¨ç”µå½±ä¸­ä»»èŒçš„èŒä½ï¼Œåˆ™åˆ†åˆ«åœ¨å¦å¤–çš„è¡¨ä¸­ï¼š job_names æ¯”å¦‚ 1 ä»£è¡¨ç¼–å‰§ã€2 ä»£è¡¨åˆ¶ä½œäººï¼Œæœ‰æ„æ€çš„æ˜¯ï¼Œå’Œç”µå½± id ä¸å§“åä¸€æ ·ï¼Œjob_id åˆ° name æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œå› ä¸º OMDB ä¸­çš„æ•°æ®éƒ½æ˜¯å¤šè¯­è¨€çš„ã€‚ job_id name language_iso_639_1 1 Autoren de 1 Writing Department en 1 Departamento de redacciÃ³n es 1 DÃ©partement Ã©criture fr 1 Scenariusz pl 2 Produzenten de 2 Production Department en all_people id name birthday deathday gender 1 George Lucas 1944-05-14 \\N 0 2 Mark Hamill 1951-09-25 \\N 0 3 Harrison Ford 1942-07-13 \\N 0 4 Carrie Fisher 1956-10-21 2016-12-27 1 5 Peter Cushing 1913-05-26 1994-08-11 0 6 Anthony Daniels 1946-02-21 \\N 0 è¿™æ˜¯åœ¨æ•°æ®æ¥æºæ˜¯è¡¨ç»“æ„ã€RDBMS ä¸­ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå…¸å‹çš„æƒ…å†µï¼Œæ‰€ä»¥å¯¹äº movie \u003c-[directed_by]-(person) è¿™ä¸ªå…³ç³»ï¼Œå°±æ¶‰åŠäº† all_moviesï¼Œall_castsï¼Œall_peopleï¼Œjob_names å››ä¸ªè¡¨æ ¼ directed_by èµ·ç‚¹ person_id åœ¨ all_casts ä¹‹ä¸­ ç»ˆç‚¹ movie_id åœ¨ all_casts ä¹‹ä¸­ æ¡ä»¶æ˜¯ job_id ä¸º job_names ä¹‹ä¸­çš„ â€œdirectorâ€ movie person_id åœ¨ all_casts ä¹‹ä¸­ åå­—æ¥è‡ª all_movies ä¸­æŒ‰ id æŸ¥æ‰¾ï¼Œlanguage ä¸º â€œenâ€ person movie_id åœ¨ all_casts ä¹‹ä¸­ åå­—ã€ç”Ÿæ—¥åœ¨ all_people ä¹‹ä¸­ æ‰€æœ‰ OMDB ä¸­æˆ‘ä»¬å…³å¿ƒçš„è¡¨çš„å…³è”å¦‚å›¾ï¼š ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:4:1","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#omdb-æ•°æ®"},{"categories":["Nebula Graph"],"content":" 4.2 MovieLens æ•°æ®é›†è€Œä¸Šè¾¹åªæ˜¯ä¸€ä¸ªæ•°æ®æºã€æ•°æ®è¡¨æˆ–è€…æ•°ä»“çš„æ•°æ®ï¼Œåœ¨çœŸå®åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä»å…¶ä»–æºå¤´æ”¶å–æ•°æ®ï¼Œå¹¶èšåˆèµ·æ¥ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä» MovieLens çš„æ•°æ®é›†ä¸­æŠ½å–éœ€è¦çš„çŸ¥è¯†ã€‚ è¿™é‡Œï¼Œæ¶‰åŠåˆ° MovieLens æ•°æ®é›†ï¼Œæˆ‘ä»¬åˆ©ç”¨çš„åªæœ‰ï¼šç”¨æˆ·â€“\u003eç”µå½±ï¼Œè¿™ä¸€æ¡å…³ç³»ã€‚ movies.csv movieId title genres 1 Toy Story (1995) Adventure 2 Jumanji (1995) Adventure 3 Grumpier Old Men (1995) Comedy 4 Waiting to Exhale (1995) Comedy ratings.csv userId movieId rating timestamp 1 1 4 964982703 1 3 4 964981247 1 6 4 964982224 ä»ä¸¤ä¸ªè¡¨çš„æ•°æ®é¢„è§ˆä¼¼ä¹å¯ä»¥å¾—å‡ºï¼š watched èµ·ç‚¹æ¥è‡ªäº ratings.csv ä¸­çš„ userId ç»ˆç‚¹æ¥è‡ªäº ratings.csv ä¸­çš„ movieId è¯„åˆ†æ¥è‡ªäº ratings.csv ä¸­çš„ rating user æ¥è‡ªäº ratings.csv ä¸­çš„ userId ç„¶è€Œï¼Œç»†å¿ƒçš„ä½ ä»¬ä¸€å®šå‘ç° MovieLens æ•°æ®é›†ä¸­çš„ movieId å’Œæ¥è‡ªäº OMDB ä¸­çš„ç”µå½± id å®Œå…¨æ˜¯ä¸åŒçš„ä¸¤å¥—ä½“ç³»ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è®©ä»–ä»¬å…³è”èµ·æ¥ï¼Œéœ€è¦å°† MovieLens é‡Œçš„ movieId è½¬æ¢æˆä¸º OMDB ä¸­çš„ç”µå½± idã€‚è€Œä»–ä»¬ä¹‹é—´çš„å…³è”æ¡ä»¶åˆ™æ˜¯ç”µå½±çš„æ ‡é¢˜ã€‚ ç„¶è€Œï¼Œé€šè§‚å¯Ÿï¼Œæˆ‘ä»¬çŸ¥é“ï¼š OMDB ç”µå½±ä¸­æ ‡é¢˜æ˜¯å¤šè¯­è¨€çš„ MovieLens ä¸­çš„æ ‡é¢˜ç»“å°¾å¸¦æœ‰(1995)è¿™æ ·çš„å¹´ä»½ä¿¡æ¯ æ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆçš„ç»“è®ºä¸º watched èµ·ç‚¹æ¥è‡ªäº ratings.csv ä¸­çš„ userId ç»ˆç‚¹æ¥è‡ªäº ratings.csv ä¸­çš„ movieId ç»ˆç‚¹è¦ä» movies.csv ä¸­çš„ title ï¼Œåœ¨ OMDB ä¹‹ä¸­æŸ¥æ‰¾ï¼Œå¾—åˆ° OMDB çš„ movie_id æŸ¥æ‰¾æ¡ä»¶ä¸ºå»æ‰å¹´ä»½ï¼Œä» OMDB çš„è‹±æ–‡æ ‡é¢˜ä¸­è¿›è¡ŒåŒ¹é… è¯„åˆ†æ¥è‡ªäº ratings.csv ä¸­çš„ rating user æ¥è‡ªäº ratings.csv ä¸­çš„ userId ç°åœ¨ï¼Œè¿™ä¸ªè¡¨æ ¼ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:4:2","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#movielens-æ•°æ®é›†"},{"categories":["Nebula Graph"],"content":" 4.3 æ˜ å°„æ•°æ®åˆ°å›¾è°±ï¼ˆå±æ€§å›¾ï¼‰æ€»ç»“èµ·æ¥ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å¤šä¸ªæ•°æ®æºä¸­çš„ä¸åŒè¡¨æ ¼ï¼ˆæˆ–è€…è¡¨æ ¼å½¢å¼çš„ CSV æ–‡ä»¶ï¼‰è¿›è¡Œèšåˆï¼Œè¿™æ ·çš„å¯¹åº”å…³ç³»å¦‚å›¾æ‰€ç¤ºï¼šå…¶ä¸­è“è‰²è™šçº¿è¡¨ç¤ºå›¾ä¸­é¡¶ç‚¹çš„æ•°æ®ä¿¡æ¯æ¥æºï¼Œç²‰è‰²è™šçº¿è¡¨ç¤ºè¾¹ä¿¡æ¯çš„æ¥æºã€‚ æœ€åï¼Œæˆ‘ä»¬è¿˜è¦å¯¹ä¸åŒè¡¨ä¸­ä¸ªä½“çš„ id è¿›è¡Œæ ¼å¼åŒ–ï¼Œæ¯”å¦‚ user_idï¼Œæ˜¯è‡ªå¢çš„æ•°å­—ï¼Œæˆ‘ä»¬è¦è½¬æ¢æˆå…¨å±€å”¯ä¸€çš„ vertex_idï¼Œä¸€ä¸ªæ–¹ä¾¿çš„æ–¹å¼æ˜¯åœ¨ç°æœ‰ id çš„åŸºç¡€ä¸Šå¢åŠ å­—ç¬¦ä¸²å‰ç¼€ï¼Œæ¯”å¦‚ u_ã€‚ æœ€ç»ˆï¼Œæ‹¿å¯¹äº user -[watched]-\u003e movie è¿™ä¸€ä¸ªå…³ç³»æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å¤„ç†å¾—åˆ°è¿™æ ·çš„è¡¨ç»“æ„æ•°æ®ï¼š user_id rating title omdb_movie_id u_1 5 Seven (a.k.a. Se7en) 807 u_1 5 Star Wars: Episode IV - A New Hope 11 u_1 5 Star Wars: Episode IV - A New Hope 10 u_1 4 Mask, The 832 u_1 3 Mrs. Doubtfire 832 å…¶ä¸­æ¯ä¸€è¡Œè®°å½•ä¸­å­˜åœ¨ä¸‰ä¸ªå›¾ä¸Šçš„ç»“æ„ä¿¡æ¯ï¼š user é¡¶ç‚¹ id movie é¡¶ç‚¹ id watched è¾¹çš„ rating å€¼ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:4:3","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#æ˜ å°„æ•°æ®åˆ°å›¾è°±å±æ€§å›¾"},{"categories":["Nebula Graph"],"content":" 5 å·¥å…·åˆ°æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æ•°æ®çš„åˆ†æä¸å»ºæ¨¡è®¾è®¡ï¼Œåœ¨è¿›å…¥â€æŠ½å–å…³è”å…³ç³»ï¼Œå¯¼å…¥å›¾æ•°æ®åº“â€œç¯èŠ‚ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸‹æˆ‘ä»¬è¦ç”¨åˆ°çš„å·¥å…·ã€‚ â€æŠ½å–å…³è”å…³ç³»â€œå¯ä»¥ç®€å•è®¤ä¸ºæ˜¯ ETL ä¸­çš„ Extract å’Œ Transformã€‚æœ¬è´¨ä¸Šå°±æ˜¯å·¥ç¨‹ä¸Šæ‰§è¡Œæ•°æ®æ˜ å°„ä¸è½¬æ¢çš„å·¥ä½œï¼Œå¸‚é¢ä¸Šæœ‰å¾ˆå¤šä¸åŒé£æ ¼çš„å·¥å…·ã€å¼€æºé¡¹ç›®å¯ä»¥åšã€‚è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢çš„å·¥å…·ï¼šdbtã€‚ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:5:0","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#å·¥å…·"},{"categories":["Nebula Graph"],"content":" 5.1 æ•°æ®è½¬æ¢åˆ©å™¨ dbtdbt æ˜¯ä¸€ä¸ªå¼€æºçš„æ•°æ®è½¬æ¢å·¥å…·ï¼Œä»–æœ‰éå¸¸æˆç†Ÿçš„ç¤¾åŒºå’Œç”Ÿæ€ï¼Œå¯ä»¥åœ¨å¤§å¤šæ•°ä¸»æµæ•°ä»“ä¹‹ä¸­è¿›è¡Œé«˜æ•ˆã€å¯æ§ã€é«˜è´¨é‡çš„æ•°æ®è½¬æ¢å·¥ä½œï¼Œæ— è®ºæ˜¯ä¸´æ—¶çš„è½¬æ¢å·¥ä½œï¼ˆad-hocï¼‰ï¼Œè¿˜æ˜¯åœ¨ç»™å®šçš„å®šæ—¶ pipeline ä¸­è¿›è¡Œå¤æ‚ç¼–æ’ï¼Œdbt éƒ½å¯ä»¥å¾ˆå¥½èƒœä»»ï¼Œä»–çš„ä¸€å¤§ç‰¹è‰²å°±æ˜¯ä½¿ç”¨ SQL-like è¯­è¨€å»æè¿°æ•°æ®è½¬æ¢çš„è§„åˆ™ï¼ŒåŸºäº GitOpsï¼Œå¯ä»¥éå¸¸ä¼˜é›…åœ°å»å¤šäººåä½œã€ç»´æŠ¤è¶…å¤§è§„æ¨¡æ•°æ®å›¢é˜Ÿé‡Œå¤æ‚çš„æ•°æ®å¤„ç†ä½œä¸šã€‚è€Œä¸”å†…ç½®çš„æ•°æ®æµ‹è¯•èƒ½åŠ›å¯ä»¥å¾ˆå¥½çš„æ§åˆ¶æ•°æ®çš„è´¨é‡ï¼Œåšåˆ°å¯å¤ç°ã€å¯æ§åˆ¶ã€‚ dbt ä¸ä»…æœ‰å¾ˆå¤šé›†æˆçš„å­é¡¹ç›®ï¼Œè¿˜èƒ½å’Œå¾ˆå¤šå…¶ä»–ä¼˜ç§€çš„å¼€æºé¡¹ç›®æœ‰æœºç»“åˆï¼ˆmeltanoã€AirFlowã€Amundsen ã€Superset ç­‰ç­‰ï¼‰ï¼Œå½¢æˆä¸€æ•´å¥—ç°ä»£çš„æ•°æ®åŸºç¡€è®¾æ–½ä½“ç³»ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰æ­å»ºçš„æ•°æ®è¡€ç¼˜ä¸å…ƒæ•°æ®æ²»ç†å‚è€ƒæ¶æ„æ–‡ç« ï¼šwww.siwei.io/en/data-lineage-oss-ref-solutionã€‚ ç®€å•æ¥è¯´ï¼Œdbt æ˜¯ä¸€ä¸ª python å†™çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨å®ƒçš„æ—¶å€™ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºç‰¹å®šæ ¼å¼çš„é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…æ¶µä¸€ä¸ª YAML æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨é…ç½®æ–‡ä»¶é‡ŒæŒ‡å®šæ•°æ®è½¬æ¢çš„æ¥æºä¿¡æ¯åœ¨å“ªé‡Œï¼Œç›®æ ‡åœ¨å“ªé‡Œï¼ˆå¤„ç†ä¹‹åçš„æ•°æ®å­˜å‚¨çš„åœ°æ–¹ï¼Œå¯èƒ½æ˜¯ Postgresï¼ŒBig Queryï¼ŒSpark ç­‰ï¼‰ã€‚åœ¨æ•°æ®æºä¸­ï¼Œæˆ‘ä»¬ç”¨ YAML æ–‡ä»¶å’Œ .SQL æ–‡ä»¶ä¸€èµ·æè¿°äº†â€ä»å“ªé‡Œå–å“ªäº›æ•°æ®ï¼Œå¦‚ä½•åšå˜æ¢ï¼Œè¾“å‡ºä»€ä¹ˆâ€œçš„ä¿¡æ¯ã€‚ è¿™ä¸ªæˆªå›¾å°±æ˜¯ dbt å®˜æ–¹æ–‡æ¡£ä¸­çš„ç¤ºä¾‹é¡¹ç›®ä¸­çš„æ–‡ä»¶å’Œé…ç½®ï¼Œå¯ä»¥çœ‹åˆ° models/example é‡Œçš„ä¿¡æ¯å°±æ˜¯æœ€æ ¸å¿ƒçš„æ•°æ®è½¬æ¢ï¼ˆtransformï¼‰çš„è§„åˆ™ï¼Œè€Œæ‰€æœ‰çš„å…¶ä»–æ•°æ®éƒ½æ˜¯å’Œè¿™ä¸ªæ•°æ®è½¬æ¢ç›¸å…³çš„å…ƒæ•°æ®ï¼Œè¿™äº› dbt é¡¹ç›®æ–‡ä»¶éå¸¸é€‚åˆç”¨ git æ¥è¿›è¡Œç»´æŠ¤ï¼Œè¿›è¡Œç°ä»£ã€è‡ªåŠ¨åŒ–çš„ DataOpsã€‚ æ³¨ï¼š å¯ä»¥å‚è€ƒ dbt æ–‡æ¡£ä¸Šæ‰‹ç†è§£å®ƒï¼šhttps://docs.getdbt.com/docs/get-started/getting-started-dbt-core ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:5:1","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#æ•°æ®è½¬æ¢åˆ©å™¨-dbt"},{"categories":["Nebula Graph"],"content":" 5.2 NebulaGraph æ•°æ®å¯¼å…¥ç»è¿‡ dbt å¯¹æ•°æ®è¿›è¡Œå¤„ç†ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ç›´æ¥æ˜ å°„åˆ°ä¸åŒç±»å‹çš„é¡¶ç‚¹ã€è¾¹ã€åŠå…¶å±æ€§çš„è¡¨ç»“æ„çš„ä¸­é—´æ•°æ®ï¼Œå®ƒä»¬å¯ä»¥æ˜¯ CSV çš„æ–‡ä»¶å½¢å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯æ•°ä»“ä¸­çš„è¡¨ï¼Œç”šè‡³å¯èƒ½æ˜¯ Spark ä¸­çš„ dataframeã€‚è€Œå°†å®ƒä»¬å¯¼å…¥ NebulaGraph æœ‰ä¸åŒçš„é€‰æ‹©ï¼Œå…¶ä¸­ NebulaGraph Exchangeï¼ŒNebula-Importerï¼Œè¿˜æœ‰ Nebula-Spark-Connector éƒ½å¯ä»¥ä½œä¸ºå¯¼å…¥æ•°æ®ã€‚ æ³¨ï¼š å¤§å®¶å¯ä»¥åœ¨ www.siwei.io/sketches/nebula-data-import-options äº†è§£æ›´å¤š NebulaGraph æ•°æ®å¯¼å…¥ä¸åŒå·¥å…·çš„ä»‹ç»ï¼ŒçŸ¥é“å¦‚ä½•é€‰æ‹©ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘å°±ç”¨æœ€ç®€å•çš„ Nebula-Importer ä½œä¸ºä¾‹å­ã€‚ Nebula-Importer æ˜¯ä¸€ä¸ªç”¨ Golang å†™çš„å¼€æºå·¥å…·ï¼Œå®ƒå¯ä»¥ç¼–è¯‘æˆä¸€ä¸ªå•æ–‡ä»¶çš„äºŒè¿›åˆ¶ï¼Œé€šè¿‡é¢„é…ç½®çš„ YAML æ ¼å¼çš„æ–‡ä»¶ï¼Œè·å¾—ç»™å®šçš„ CSV æ–‡ä»¶åˆ° NebulaGraph ä¸­ç‚¹ã€è¾¹çš„å¯¹åº”å…³ç³»ï¼Œè¿›è¡Œè¯»å–å’Œå¯¼å…¥ã€‚ æ³¨ï¼š Nebula-Importer ä»£ç ï¼šhttps://github.com/vesoft-inc/nebula-importer/ Nebula-Importer æ–‡æ¡£ï¼šhttps://docs.nebula-graph.com.cn/master/nebula-importer/use-importer/ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:5:2","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#nebulagraph-æ•°æ®å¯¼å…¥"},{"categories":["Nebula Graph"],"content":" 6 å®æ“ç°åœ¨æˆ‘ä»¬å°±å®æ“ä¸€ä¸‹å¦‚ä½•åˆ©ç”¨ dbt + Nebula-Importer è¿›è¡Œå¤šæ•°æ®æºèšåˆã€è½¬æ¢ã€å†å¯¼å…¥ NebulaGraph çš„è¿‡ç¨‹ï¼Œæ•´ä¸ªé¡¹ç›®çš„ä»£ç å·²ç»å¼€æºï¼Œä»“åº“åœ¨ https://github.com/wey-gu/movie-recommendation-dataset ä¸Šï¼Œæ¬¢è¿å¤§å®¶å‚è€ƒã€å…±å»ºã€‚ æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹ï¼š å°†æºæ•°æ®ç®€å•æ¸…æ´—ã€å¯¼å…¥æ•°ä»“ï¼ˆPostgresï¼‰ï¼ˆELï¼‰ ç”¨ dbt å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ï¼ˆTransformï¼‰ã€å¯¼å‡ºä¸º CSV æ–‡ä»¶ ç”¨ Nebula Importer å°† CSV å¯¼å…¥ NebulaGraphï¼ˆLï¼‰ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:6:0","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#å®æ“"},{"categories":["Nebula Graph"],"content":" 6.1 å‡†å¤‡ dbt ç¯å¢ƒdbt æ˜¯ä¸€ä¸ª python é¡¹ç›®ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªè™šæ‹Ÿçš„ python3 ç¯å¢ƒé‡Œå®‰è£…å¥½ dbt å’Œ dbt-postgresã€‚ python3 -m venv .venv source .venv/bin/activate pip install dbt-postgres åˆ›å»ºä¸€ä¸ª dbt é¡¹ç›®ï¼Œå¹¶è¿›å…¥åˆ°ç©ºçš„é¡¹ç›®é‡Œï¼š dbt init dbt_project cd dbt_project çœ‹çœ‹é‡Œè¾¹çš„æ–‡ä»¶å§ï¼š $ tree . . |-- README.md # é¡¹ç›®è¯´æ˜ README |-- analyses |-- dbt_project.yml # é¡¹ç›®é…ç½®æ–‡ä»¶ |-- macros |-- models # transform æ¥æº | \\-- example | |-- my_first_dbt_model.sql # ä¸€ä¸ªæè¿°äº†å¦‚ä½•ä»å…ƒæ•°æ®ä¸­ SELECT å¹¶å¤„ç†çš„è§„åˆ™ | |-- my_second_dbt_model.sql | \\-- schema.yml # è§„åˆ™æ–‡ä»¶çš„å…ƒæ•°æ®é…ç½®ï¼Œæè¿°äº† sql è§„åˆ™çš„å±æ€§ |-- seeds # æºæ•°æ®å¦‚æœæ˜¯ CSV æ–‡ä»¶ï¼Œå¯ä»¥æ”¾åˆ° seeds é‡Œ |-- snapshots \\-- tests 7 directories, 5 files æœ€åï¼Œå’±ä»¬æ‹‰ä¸€ä¸ªå®¹å™¨é‡Œçš„ Postgres å½“åšæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®çš„æ•°ä»“ï¼Œå¦‚æœä½ å·²ç»æœ‰å„ç§å…¶ä»–æ•°ä»“ï¼Œå°±ä¸éœ€è¦è¿™ä¸€æ­¥äº†ï¼Œä¸è¿‡è¦æŠŠé¡¹ç›®ä¸­çš„é…ç½®æ–‡ä»¶ä½œç›¸åº”çš„ä¿®æ”¹ï¼Œå¹¶å®‰è£…ç›¸åº”çš„ dbt æ’ä»¶ã€‚ docker run --rm --name postgres \\ -e POSTGRES_PASSWORD=nebula \\ -e POSTGRES_USER=nebula \\ -e POSTGRES_DB=warehouse -d \\ -p 5432:5432 postgres ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:6:1","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#å‡†å¤‡-dbt-ç¯å¢ƒ"},{"categories":["Nebula Graph"],"content":" 6.2 æ•°æ®ä¸‹è½½ä¸é¢„å¤„ç†æˆ‘ä»¬æŠŠæ•°æ®æ”¾åˆ°é¡¹ç›®çš„ raw_data ä¸‹å§ mkdir -p raw_data cd raw_data æ³¨æ„ï¼Œå‡è®¾ raw_data åœ¨ dbt_proeject ä¹‹ä¸‹ï¼š tree .. .. |-- README.md |-- analyses |-- dbt_project.yml |-- macros |-- models | \\-- example | |-- my_first_dbt_model.sql | |-- my_second_dbt_model.sql | \\-- schema.yml |-- raw_data # æ–°å»ºçš„ç›®å½• |-- seeds |-- snapshots \\-- tests 8 directories, 5 files æˆ‘ä»¬æŠŠ omdb æ•°æ®ä¸‹è½½ä¹‹åï¼Œå†è§£å‹ï¼š wget www.omdb.org/data/all_people.csv.bz2 wget www.omdb.org/data/all_people_aliases.csv.bz2 wget www.omdb.org/data/people_links.csv.bz2 wget www.omdb.org/data/all_casts.csv.bz2 wget www.omdb.org/data/job_names.csv.bz2 wget www.omdb.org/data/all_characters.csv.bz2 wget www.omdb.org/data/movie_categories.csv.bz2 wget www.omdb.org/data/movie_keywords.csv.bz2 wget www.omdb.org/data/category_names.csv.bz2 wget www.omdb.org/data/all_categories.csv.bz2 wget www.omdb.org/data/all_movie_aliases_iso.csv.bz2 bunzip2 *.bz2 ç„¶åæ˜¯ MovieLens æ•°æ®é›†çš„ä¸‹è½½ã€è§£å‹ï¼š wget https://files.grouplens.org/datasets/movielens/ml-latest-small.zip unzip ml-latest-small.zip rm *.zip åœ¨å¯¼å…¥æ•°ä»“è¿›è¡Œè½¬æ¢ï¼ˆTransformï¼‰ä¹‹å‰æˆ‘ä»¬åšä¸€äº›æ•°æ®çš„é¢„å¤„ç†ï¼Œç„¶åæŠŠä»–ä»¬æ”¾åˆ° seeds ä¹‹ä¸‹ã€‚ # å› ä¸ºæ˜¯å®éªŒé¡¹ç›®ï¼Œæˆ‘ä»¬ç®€å•ç²—æš´åœ°å»æ‰å¸¦æœ‰è½¬ä¹‰çš„å¼•å·çš„æ•°æ®ï¼Œå› ä¸ºå®ƒä»¬ä¼šè¢«è®¤ä¸ºæ˜¯æ— æ•ˆå­—ç¬¦ï¼Œå¤„ç†ä¹‹åçš„ç»“æœæ”¾åˆ° seeds ä¸‹è¾¹ã€‚ grep -v '\\\\\"' raw_data/all_movie_aliases_iso.csv \u003e seeds/all_movie_aliases_iso.csv grep -v '\\\\\"' raw_data/all_casts.csv \u003e seeds/all_casts.csv grep -v '\\\\\"' raw_data/all_characters.csv \u003e seeds/all_characters.csv grep -v '\\\\\"' raw_data/all_people.csv \u003e seeds/all_people.csv grep -v '\\\\\"' raw_data/category_names.csv \u003e seeds/category_names.csv grep -v '\\\\\"' raw_data/job_names.csv \u003e seeds/job_names.csv # ä¸‹è¾¹çš„æ–‡ä»¶æ— éœ€å¤„ç†ï¼Œç›´æ¥æ”¾åˆ° seeds ä¸‹è¾¹ã€‚ cp raw_data/movie_categories.csv seeds/movie_categories.csv cp raw_data/movie_keywords.csv seeds/movie_keywords.csv cp raw_data/all_categories.csv seeds/all_categories.csv cp raw_data/ml-latest-small/ratings.csv seeds/movielens_ratings.csv cp raw_data/ml-latest-small/movies.csv seeds/movielens_movies.csv æœ‰äº† seeds ä¸‹è¾¹çš„æ–‡ä»¶ä¹‹åï¼Œå¯ä»¥ç”¨ä¸€ä¸ªå‘½ä»¤æŠŠä»–ä»¬å¯¼å…¥åˆ°æ•°ä»“é‡Œï¼š å‚è€ƒæ–‡æ¡£ï¼šhttps://docs.getdbt.com/docs/build/seeds dbt seed æ‰§è¡Œè¿‡ç¨‹å› æ•°ä»“è€Œå¼‚ï¼Œç”¨æœ¬åœ°çš„ postgres å¯èƒ½è¦ç­‰ä¸€ä¼šå„¿æ‰èƒ½å®Œæˆï¼Œæ‰§è¡Œç»“æœå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š $ dbt seed 05:58:27 Running with dbt=1.3.0 05:58:27 Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 11 seed files, 0 sources, 0 exposures, 0 metrics 05:58:28 05:58:28 Concurrency: 8 threads (target='dev') 05:58:28 05:58:28 1 of 11 START seed file public.all_casts ....................................... [RUN] ... 07:10:11 1 of 11 OK loaded seed file public.all_casts ................................... [INSERT 1082228 in 4303.78s] 07:10:11 07:10:11 Finished running 11 seeds in 1 hours 11 minutes and 43.93 seconds (4303.93s). 07:10:11 07:10:11 Completed successfully 07:10:11 07:10:11 Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11 ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:6:2","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#æ•°æ®ä¸‹è½½ä¸é¢„å¤„ç†"},{"categories":["Nebula Graph"],"content":" 6.3 æ’°å†™ Transform modelæˆ‘ä»¬åˆ›å»º model å¦‚ä¸‹ï¼š mkdir models/movie_recommedation touch models/movie_recommedation/user_watched_movies.sql touch models/movie_recommedation/schema.yml è¿™æ—¶å€™ models ä¸­çš„æ–‡ä»¶ç»“æ„å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š $ tree models models \\-- movie_recommedation |-- user_watched_movies.sql \\-- schema.yml è¿™ä¸ª model ä¸‹è¾¹ç›®å‰åªæœ‰ä¸€ä¸ªè§„åˆ™ï¼Œå°±æ˜¯è´Ÿè´£å¤„ç†ç”¨æˆ·è§‚çœ‹ç”µå½±è¿™ä¸€ä¸ªè¾¹ä¸Šæ•°æ®çš„ SQL è¯­å¥ã€‚ æˆ‘ä»¬å¸Œæœ›è¾“å‡ºä¸‰åˆ—ï¼Œæ‰€ä»¥ schema.yml ä¸­çš„å†…å®¹æ˜¯ï¼š version: 2 models: - name: user_watched_movies description: \"The edges between users and movies they have watched\" columns: - name: user_id description: \"user id\" tests: - not_null - name: movie_id description: \"movie id\" tests: - not_null - name: rating description: \"rating given by user to movie\" tests: - not_null æ³¨æ„ï¼Œè¿™é‡Œçš„ tests çš„è¡¨è¾¾æ˜¯å¯¹æ•°æ®éªŒè¯ã€æµ‹è¯•çš„çº¦æŸï¼Œæœ‰äº†å®ƒï¼Œæˆ‘å¯ä»¥ç”¨ dbt è½»æ¾å¯¹æ•°æ®è´¨é‡è¿›è¡Œæµ‹è¯•ã€éªŒæ”¶ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦æ±‚è¿™é‡Œçš„ä¸‰ä¸ªå­—æ®µéƒ½æ˜¯ not_nullã€‚ ç„¶åï¼Œæˆ‘ä»¬æ¥å†™ SQL å§ï¼Œuser_watched_movies.sqlï¼š {{ config(materialized='table') }} /* JOIN the movieielens_ratings table with the movieielens_movies table, and removing the movie title tailing the year of release */ WITH user_watched_movies AS( SELECT moveielens_ratings.\"userId\", moveielens_ratings.\"movieId\", moveielens_ratings.rating, REGEXP_REPLACE(moveielens_movies.title, ' \\(\\d{4}\\)$', '') AS title, moveielens_movies.genres AS movielens_genres FROM moveielens_ratings JOIN moveielens_movies ON moveielens_movies.\"movieId\" = moveielens_ratings.\"movieId\" ) /* JOIN user_watched_movies table with all_movie_aliase_iso table where language is English the join condition is the movie title */ SELECT concat('u_',user_watched_movies.\"userId\") AS user_id, user_watched_movies.rating, user_watched_movies.title, all_movie_aliases_iso.\"movie_id\" AS OMDB_movie_id, user_watched_movies.movielens_genres FROM user_watched_movies JOIN all_movie_aliases_iso ON user_watched_movies.title LIKE CONCAT(all_movie_aliases_iso.name, '%') AND all_movie_aliases_iso.language_iso_639_1 = 'en' è€Œè¿™ä¸ª SQL åšçš„äº‹æƒ…å°±æ˜¯ç»¿è‰²åœ†åœˆæ ‡æ³¨çš„éƒ¨åˆ†ï¼š ä» moveielens_ratings ä¸­é€‰ user idã€movie idã€ratingã€movie titleï¼ˆå»æ‰å¹´ä»½ï¼‰ï¼Œå­˜æˆ user_watched_movies çš„ä¸­é—´è¡¨æ ¼ movie title ä» moveielens_movies ä¸­ JOIN ï¼Œé€šè¿‡ movie_id ç›¸åŒçš„åŒ¹é…æ¡ä»¶å–å¾— ä» user_watched_movies ä¸­é€‰ user idï¼ˆå¢åŠ å‰ç¼€ u_ï¼‰ã€ratingã€titleã€OMDB_movie_id OMDB_movie_id ä» all_movie_aliases_iso ä¸­ JOINï¼Œé€šè¿‡ç›¸ä¼¼çš„ç”µå½±å§“ååŒ¹é… OMDB ç”µå½±ä¸­è‹±æ–‡æ ‡é¢˜å–å¾— æœ€ç»ˆçš„å­—æ®µä½œä¸ºè¾“å‡º å°è´´å£«ï¼šæˆ‘ä»¬å¯ä»¥åœ¨ Postgres çš„è¿æ¥å™¨ä¸­é€šè¿‡å¢åŠ  LIMIT å¿«é€Ÿè°ƒè¯•è‡ªå·±çš„ SQL è¯­å¥ã€‚ ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ dbt æ¥æ‰§è¡Œã€æµ‹è¯•åˆšåˆšçš„è§„åˆ™ï¼š dbt run -m user_watched_movies ä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥å°±å¯ä»¥åœ¨ Postgresï¼ˆæ•°ä»“ï¼‰ä¸­çœ‹åˆ°æˆ‘ä»¬è½¬æ¢ä¹‹åçš„ä¸€ä¸ªè¡¨äº†ã€‚ ç±»ä¼¼çš„ï¼Œå¦‚æ³•ç‚®åˆ¶æ‰€æœ‰å…¶ä»–éƒ¨åˆ†çš„ Transform è§„åˆ™ï¼Œæˆ‘ä»¬å°±æœ‰è¿™ä¹ˆå¤š model äº†ï¼š $ tree models models \\-- movie_recommedation |-- acted_by.sql |-- directed_by.sql |-- genres.sql |-- movies.sql |-- people.sql |-- schema.yml |-- user_watched_movies.sql \\-- with_genre.sql å†å¯¹ä»–ä»¬åˆ†åˆ«æ‰§è¡Œ transformï¼š dbt run -m acted_by dbt run -m directed_by dbt run -m with_genre dbt run -m people dbt run -m genres dbt run -m movies ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:6:3","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#æ’°å†™-transform-model"},{"categories":["Nebula Graph"],"content":" 6.4 å¯¼å‡ºæ•°æ®ä¸º CSVå®é™…ä¸Šï¼ŒNebulaGraph Exchange æœ¬èº«å°±æ”¯æŒæŠŠå¾ˆå¤šæ•°æ®æºï¼ˆPostgresï¼ŒClickhouseï¼ŒMySQLï¼ŒHive ç­‰ç­‰ï¼‰å¯¼å…¥ NebulaGraphï¼Œåªæ˜¯åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¤„ç†çš„æ•°æ®é‡å¯¹äº NebulaGraph æ¥è¯´éå¸¸éå¸¸å°ï¼ˆåªæœ‰ç™¾ä¸‡çº§åˆ«çš„è¾¹è€Œå·²ï¼‰ï¼Œä½¿ç”¨æœ€è½»é‡çº§çš„ Nebula-Importer å°±è¶³å¤Ÿäº†ã€‚è€Œ Nebula-Importer èƒ½æ¶ˆè´¹çš„æ•°æ®åªæœ‰ CSV æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠåˆšæ‰çš„è¡¨éƒ½è¾“å‡ºä¸ºæ–‡ä»¶ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬è¿›å…¥ postgres çš„ consoleï¼Œæ‰§è¡Œ COPY å‘½ä»¤ å‚è€ƒ Postgres æ–‡æ¡£ï¼šhttps://www.postgresql.org/docs/current/sql-copy.html COPY acted_by TO '/tmp/acted_by.csv' WITH DELIMITER ',' CSV HEADER; COPY directed_by TO '/tmp/directed_by.csv' WITH DELIMITER ',' CSV HEADER; COPY with_genre TO '/tmp/with_genre.csv' WITH DELIMITER ',' CSV HEADER; COPY people TO '/tmp/people.csv' WITH DELIMITER ',' CSV HEADER; COPY movies TO '/tmp/movies.csv' WITH DELIMITER ',' CSV HEADER; COPY genres TO '/tmp/genres.csv' WITH DELIMITER ',' CSV HEADER; -- å¯¹äº user_watched_movies æˆ‘ä»¬ä¸è¾“å‡ºè¡¨å¤´ï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶ä¸­è®°å½•äº†ä¸¤ç§ç‚¹ã€ä¸€ç§è¾¹ï¼Œæ²¡æ³•è®© importer é€šè¿‡çº¦å®šå¥½çš„è¡¨å¤´è‡ªåŠ¨å¯¼å…¥ï¼Œåªèƒ½é€šè¿‡æ— è¡¨å¤´çš„æƒ…å†µä¸‹æŒ‡å®šç¬¬å‡ åˆ—å¯¹åº”ä»€ä¹ˆå­—æ®µ COPY user_watched_movies TO '/tmp/user_watched_movies.csv' WITH DELIMITER ',' CSV; ç„¶åæŠŠ postgres å®¹å™¨é‡Œçš„æ–‡ä»¶å¯¼å…¥åˆ° to_nebulagraph è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œï¼š mkdir -p to_nebulagraph docker cp postgres:/tmp/. to_nebulagraph/ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:6:4","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#å¯¼å‡ºæ•°æ®ä¸º-csv"},{"categories":["Nebula Graph"],"content":" 6.5 å¯¼å…¥ NebulaGraph 6.5.1 åˆ›å»º NebulaGraph é›†ç¾¤æˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset curl -fsSL nebula-up.siwei.io/install.sh | bash 6.5.2 åˆ›å»º Schemaé¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«åš moviegraph çš„å›¾ç©ºé—´ï¼Œé’ˆå¯¹å‰è¾¹çš„å»ºæ¨¡ï¼Œåˆ›å»ºç‚¹è¾¹ç±»å‹çš„ç»“æ„ï¼ˆSchemaï¼‰ï¼š å…ˆè¿›å…¥ NebulaGraph çš„ consoleï¼š ~/.nebula-up/console.sh ç„¶åæ‰§è¡Œå¦‚ä¸‹ DDLï¼ˆData Definiation Languageï¼‰ï¼š CREATE SPACE moviegraph(partition_num=10,replica_factor=1,vid_type=fixed_string(32)); :sleep 20 USE moviegraph; CREATE TAG person(name string, birthdate string); CREATE TAG movie(name string); CREATE TAG genre(name string); CREATE TAG user(user_id string); CREATE EDGE acted_by(); CREATE EDGE directed_by(); CREATE EDGE with_genre(); CREATE EDGE watched(rate float); exit 6.5.3 åˆ›å»º Nebula-Importer é…ç½®æ–‡ä»¶è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªæè¿° CSV æ–‡ä»¶å’Œé›†ç¾¤ä¸­ç‚¹è¾¹æ•°æ®å¯¹åº”å…³ç³»çš„ YAML æ–‡ä»¶ã€‚è¯¦ç»†çš„æ ¼å¼å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼šhttps://docs.nebula-graph.com.cn/master/nebula-importer/use-importer/ï¼Œæˆ–è€…è§†é¢‘æ•™ç¨‹ï¼šhttps://www.bilibili.com/video/BV1ny4y1u7i4 ã€‚ æœ€ç»ˆçš„é…ç½®æ–‡ä»¶æˆ‘å·²ç»é—®å¤§å®¶å†™å¥½äº†ï¼Œåœ¨ https://github.com/wey-gu/movie-recommendation-dataset/blob/main/nebula-importer.yaml å¯ä»¥ä¸‹è½½å¾—åˆ°ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å°±ç›´æ¥ä¸‹è½½æˆ‘å†™å¥½äº†çš„é…ç½®æ–‡ä»¶ï¼Œæ³¨æ„ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸åº”è¯¥æ˜¯ dbt é¡¹ç›®æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬é€€å‡ºç›®å½•ï¼Œå‘ä¸Šä¸€å±‚ï¼ŒæŠŠå®ƒæ”¾åˆ° dbt_proeject å¤–è¾¹ï¼š cd .. wget https://raw.githubusercontent.com/wey-gu/movie-recommendation-dataset/main/nebula-importer.yaml 6.5.4 å¼€å§‹å¯¼å…¥è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ç”¨å®¹å™¨åŒ–çš„ nebula-importerï¼Œé¿å…äº†å®‰è£…çš„æ­¥éª¤ï¼š docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml å¾ˆå¿«ï¼Œæ‰€æœ‰çš„æ•°æ®å°±å¯¼å…¥åˆ° NebulaGraph ä¹‹ä¸­äº†ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ Nebula-Consoleï¼Œæ‰§è¡Œä¸€äº›æŸ¥è¯¢çœ‹çœ‹ç»“æœï¼š è¿›å…¥ console ~/.nebula-up/console.sh è¿›å…¥å›¾ç©ºé—´ã€æ‰§è¡Œ SHOW STATS USE moviegraph; SHOW STATS; ç»“æœï¼š (root@nebula) [moviegraph]\u003e SHOW STATS; +---------+---------------+---------+ | Type | Name | Count | +---------+---------------+---------+ | \"Tag\" | \"genre\" | 14397 | | \"Tag\" | \"movie\" | 20701 | | \"Tag\" | \"person\" | 263907 | | \"Tag\" | \"user\" | 610 | | \"Edge\" | \"acted_by\" | 673763 | | \"Edge\" | \"directed_by\" | 101949 | | \"Edge\" | \"watched\" | 31781 | | \"Edge\" | \"with_genre\" | 194009 | | \"Space\" | \"vertices\" | 299615 | | \"Space\" | \"edges\" | 1001502 | +---------+---------------+---------+ Got 10 rows (time spent 1693/15136 us) é€šè¿‡ Nebula-Studioï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å¯è§†åŒ–ç•Œé¢æ¢ç´¢è¿™ä¸ªå›¾è°±ï¼Œæ¯”å¦‚åœ¨å…¶ä¸­æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œçœ‹ä¸€ä¸‹ç»™ç”¨æˆ· u_124 æ¨èç”µå½± 1891 çš„ç†ç”±å¯èƒ½æ˜¯ä»€ä¹ˆï¼Ÿ FIND NOLOOP PATH FROM \"u_124\" TO \"1891\" over * BIDIRECT UPTO 4 STEPS yield path as `p` | LIMIT 20 ä»–çš„ç»“æœæ˜¯ï¼šæ›¾ç»å–œæ¬¢çš„æ˜Ÿæˆ˜ç”µå½±çš„å¤§éƒ¨åˆ†æ¼”èŒäººå‘˜éƒ½ä¹Ÿå‚ä¸äº†è¿™éƒ¨å’ŒåŒæ ·æ˜¯â€œå¥¥æ–¯å¡è·å¥–â€ä¸”â€œç»å…¸â€çš„ç”µå½±ã€‚ æˆ‘åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ç»™å¤§å®¶ç”¨åŒä¸€ä¸ªå›¾è°±å±•ç¤ºäº†æ›´å¤šå›¾æ•°æ®åº“ã€å›¾ç®—æ³•åœ¨æ¨èç³»ç»Ÿä¸Šçš„åº”ç”¨ï¼Œå¦‚æœå¤§å®¶æ„Ÿå…´è¶£ï¼Œæ¬¢è¿é˜…è¯»ï¼šhttps://www.siwei.io/recommendation-system-with-graphdb/ ã€‚ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:6:5","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#å¯¼å…¥-nebulagraph"},{"categories":["Nebula Graph"],"content":" 6.5 å¯¼å…¥ NebulaGraph 6.5.1 åˆ›å»º NebulaGraph é›†ç¾¤æˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset curl -fsSL nebula-up.siwei.io/install.sh | bash 6.5.2 åˆ›å»º Schemaé¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«åš moviegraph çš„å›¾ç©ºé—´ï¼Œé’ˆå¯¹å‰è¾¹çš„å»ºæ¨¡ï¼Œåˆ›å»ºç‚¹è¾¹ç±»å‹çš„ç»“æ„ï¼ˆSchemaï¼‰ï¼š å…ˆè¿›å…¥ NebulaGraph çš„ consoleï¼š ~/.nebula-up/console.sh ç„¶åæ‰§è¡Œå¦‚ä¸‹ DDLï¼ˆData Definiation Languageï¼‰ï¼š CREATE SPACE moviegraph(partition_num=10,replica_factor=1,vid_type=fixed_string(32)); :sleep 20 USE moviegraph; CREATE TAG person(name string, birthdate string); CREATE TAG movie(name string); CREATE TAG genre(name string); CREATE TAG user(user_id string); CREATE EDGE acted_by(); CREATE EDGE directed_by(); CREATE EDGE with_genre(); CREATE EDGE watched(rate float); exit 6.5.3 åˆ›å»º Nebula-Importer é…ç½®æ–‡ä»¶è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªæè¿° CSV æ–‡ä»¶å’Œé›†ç¾¤ä¸­ç‚¹è¾¹æ•°æ®å¯¹åº”å…³ç³»çš„ YAML æ–‡ä»¶ã€‚è¯¦ç»†çš„æ ¼å¼å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼šhttps://docs.nebula-graph.com.cn/master/nebula-importer/use-importer/ï¼Œæˆ–è€…è§†é¢‘æ•™ç¨‹ï¼šhttps://www.bilibili.com/video/BV1ny4y1u7i4 ã€‚ æœ€ç»ˆçš„é…ç½®æ–‡ä»¶æˆ‘å·²ç»é—®å¤§å®¶å†™å¥½äº†ï¼Œåœ¨ https://github.com/wey-gu/movie-recommendation-dataset/blob/main/nebula-importer.yaml å¯ä»¥ä¸‹è½½å¾—åˆ°ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å°±ç›´æ¥ä¸‹è½½æˆ‘å†™å¥½äº†çš„é…ç½®æ–‡ä»¶ï¼Œæ³¨æ„ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸åº”è¯¥æ˜¯ dbt é¡¹ç›®æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬é€€å‡ºç›®å½•ï¼Œå‘ä¸Šä¸€å±‚ï¼ŒæŠŠå®ƒæ”¾åˆ° dbt_proeject å¤–è¾¹ï¼š cd .. wget https://raw.githubusercontent.com/wey-gu/movie-recommendation-dataset/main/nebula-importer.yaml 6.5.4 å¼€å§‹å¯¼å…¥è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ç”¨å®¹å™¨åŒ–çš„ nebula-importerï¼Œé¿å…äº†å®‰è£…çš„æ­¥éª¤ï¼š docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml å¾ˆå¿«ï¼Œæ‰€æœ‰çš„æ•°æ®å°±å¯¼å…¥åˆ° NebulaGraph ä¹‹ä¸­äº†ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ Nebula-Consoleï¼Œæ‰§è¡Œä¸€äº›æŸ¥è¯¢çœ‹çœ‹ç»“æœï¼š è¿›å…¥ console ~/.nebula-up/console.sh è¿›å…¥å›¾ç©ºé—´ã€æ‰§è¡Œ SHOW STATS USE moviegraph; SHOW STATS; ç»“æœï¼š (root@nebula) [moviegraph]\u003e SHOW STATS; +---------+---------------+---------+ | Type | Name | Count | +---------+---------------+---------+ | \"Tag\" | \"genre\" | 14397 | | \"Tag\" | \"movie\" | 20701 | | \"Tag\" | \"person\" | 263907 | | \"Tag\" | \"user\" | 610 | | \"Edge\" | \"acted_by\" | 673763 | | \"Edge\" | \"directed_by\" | 101949 | | \"Edge\" | \"watched\" | 31781 | | \"Edge\" | \"with_genre\" | 194009 | | \"Space\" | \"vertices\" | 299615 | | \"Space\" | \"edges\" | 1001502 | +---------+---------------+---------+ Got 10 rows (time spent 1693/15136 us) é€šè¿‡ Nebula-Studioï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å¯è§†åŒ–ç•Œé¢æ¢ç´¢è¿™ä¸ªå›¾è°±ï¼Œæ¯”å¦‚åœ¨å…¶ä¸­æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œçœ‹ä¸€ä¸‹ç»™ç”¨æˆ· u_124 æ¨èç”µå½± 1891 çš„ç†ç”±å¯èƒ½æ˜¯ä»€ä¹ˆï¼Ÿ FIND NOLOOP PATH FROM \"u_124\" TO \"1891\" over * BIDIRECT UPTO 4 STEPS yield path as `p` | LIMIT 20 ä»–çš„ç»“æœæ˜¯ï¼šæ›¾ç»å–œæ¬¢çš„æ˜Ÿæˆ˜ç”µå½±çš„å¤§éƒ¨åˆ†æ¼”èŒäººå‘˜éƒ½ä¹Ÿå‚ä¸äº†è¿™éƒ¨å’ŒåŒæ ·æ˜¯â€œå¥¥æ–¯å¡è·å¥–â€ä¸”â€œç»å…¸â€çš„ç”µå½±ã€‚ æˆ‘åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ç»™å¤§å®¶ç”¨åŒä¸€ä¸ªå›¾è°±å±•ç¤ºäº†æ›´å¤šå›¾æ•°æ®åº“ã€å›¾ç®—æ³•åœ¨æ¨èç³»ç»Ÿä¸Šçš„åº”ç”¨ï¼Œå¦‚æœå¤§å®¶æ„Ÿå…´è¶£ï¼Œæ¬¢è¿é˜…è¯»ï¼šhttps://www.siwei.io/recommendation-system-with-graphdb/ ã€‚ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:6:5","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#åˆ›å»º-nebulagraph-é›†ç¾¤"},{"categories":["Nebula Graph"],"content":" 6.5 å¯¼å…¥ NebulaGraph 6.5.1 åˆ›å»º NebulaGraph é›†ç¾¤æˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset curl -fsSL nebula-up.siwei.io/install.sh | bash 6.5.2 åˆ›å»º Schemaé¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«åš moviegraph çš„å›¾ç©ºé—´ï¼Œé’ˆå¯¹å‰è¾¹çš„å»ºæ¨¡ï¼Œåˆ›å»ºç‚¹è¾¹ç±»å‹çš„ç»“æ„ï¼ˆSchemaï¼‰ï¼š å…ˆè¿›å…¥ NebulaGraph çš„ consoleï¼š ~/.nebula-up/console.sh ç„¶åæ‰§è¡Œå¦‚ä¸‹ DDLï¼ˆData Definiation Languageï¼‰ï¼š CREATE SPACE moviegraph(partition_num=10,replica_factor=1,vid_type=fixed_string(32)); :sleep 20 USE moviegraph; CREATE TAG person(name string, birthdate string); CREATE TAG movie(name string); CREATE TAG genre(name string); CREATE TAG user(user_id string); CREATE EDGE acted_by(); CREATE EDGE directed_by(); CREATE EDGE with_genre(); CREATE EDGE watched(rate float); exit 6.5.3 åˆ›å»º Nebula-Importer é…ç½®æ–‡ä»¶è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªæè¿° CSV æ–‡ä»¶å’Œé›†ç¾¤ä¸­ç‚¹è¾¹æ•°æ®å¯¹åº”å…³ç³»çš„ YAML æ–‡ä»¶ã€‚è¯¦ç»†çš„æ ¼å¼å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼šhttps://docs.nebula-graph.com.cn/master/nebula-importer/use-importer/ï¼Œæˆ–è€…è§†é¢‘æ•™ç¨‹ï¼šhttps://www.bilibili.com/video/BV1ny4y1u7i4 ã€‚ æœ€ç»ˆçš„é…ç½®æ–‡ä»¶æˆ‘å·²ç»é—®å¤§å®¶å†™å¥½äº†ï¼Œåœ¨ https://github.com/wey-gu/movie-recommendation-dataset/blob/main/nebula-importer.yaml å¯ä»¥ä¸‹è½½å¾—åˆ°ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å°±ç›´æ¥ä¸‹è½½æˆ‘å†™å¥½äº†çš„é…ç½®æ–‡ä»¶ï¼Œæ³¨æ„ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸åº”è¯¥æ˜¯ dbt é¡¹ç›®æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬é€€å‡ºç›®å½•ï¼Œå‘ä¸Šä¸€å±‚ï¼ŒæŠŠå®ƒæ”¾åˆ° dbt_proeject å¤–è¾¹ï¼š cd .. wget https://raw.githubusercontent.com/wey-gu/movie-recommendation-dataset/main/nebula-importer.yaml 6.5.4 å¼€å§‹å¯¼å…¥è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ç”¨å®¹å™¨åŒ–çš„ nebula-importerï¼Œé¿å…äº†å®‰è£…çš„æ­¥éª¤ï¼š docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml å¾ˆå¿«ï¼Œæ‰€æœ‰çš„æ•°æ®å°±å¯¼å…¥åˆ° NebulaGraph ä¹‹ä¸­äº†ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ Nebula-Consoleï¼Œæ‰§è¡Œä¸€äº›æŸ¥è¯¢çœ‹çœ‹ç»“æœï¼š è¿›å…¥ console ~/.nebula-up/console.sh è¿›å…¥å›¾ç©ºé—´ã€æ‰§è¡Œ SHOW STATS USE moviegraph; SHOW STATS; ç»“æœï¼š (root@nebula) [moviegraph]\u003e SHOW STATS; +---------+---------------+---------+ | Type | Name | Count | +---------+---------------+---------+ | \"Tag\" | \"genre\" | 14397 | | \"Tag\" | \"movie\" | 20701 | | \"Tag\" | \"person\" | 263907 | | \"Tag\" | \"user\" | 610 | | \"Edge\" | \"acted_by\" | 673763 | | \"Edge\" | \"directed_by\" | 101949 | | \"Edge\" | \"watched\" | 31781 | | \"Edge\" | \"with_genre\" | 194009 | | \"Space\" | \"vertices\" | 299615 | | \"Space\" | \"edges\" | 1001502 | +---------+---------------+---------+ Got 10 rows (time spent 1693/15136 us) é€šè¿‡ Nebula-Studioï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å¯è§†åŒ–ç•Œé¢æ¢ç´¢è¿™ä¸ªå›¾è°±ï¼Œæ¯”å¦‚åœ¨å…¶ä¸­æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œçœ‹ä¸€ä¸‹ç»™ç”¨æˆ· u_124 æ¨èç”µå½± 1891 çš„ç†ç”±å¯èƒ½æ˜¯ä»€ä¹ˆï¼Ÿ FIND NOLOOP PATH FROM \"u_124\" TO \"1891\" over * BIDIRECT UPTO 4 STEPS yield path as `p` | LIMIT 20 ä»–çš„ç»“æœæ˜¯ï¼šæ›¾ç»å–œæ¬¢çš„æ˜Ÿæˆ˜ç”µå½±çš„å¤§éƒ¨åˆ†æ¼”èŒäººå‘˜éƒ½ä¹Ÿå‚ä¸äº†è¿™éƒ¨å’ŒåŒæ ·æ˜¯â€œå¥¥æ–¯å¡è·å¥–â€ä¸”â€œç»å…¸â€çš„ç”µå½±ã€‚ æˆ‘åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ç»™å¤§å®¶ç”¨åŒä¸€ä¸ªå›¾è°±å±•ç¤ºäº†æ›´å¤šå›¾æ•°æ®åº“ã€å›¾ç®—æ³•åœ¨æ¨èç³»ç»Ÿä¸Šçš„åº”ç”¨ï¼Œå¦‚æœå¤§å®¶æ„Ÿå…´è¶£ï¼Œæ¬¢è¿é˜…è¯»ï¼šhttps://www.siwei.io/recommendation-system-with-graphdb/ ã€‚ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:6:5","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#åˆ›å»º-schema"},{"categories":["Nebula Graph"],"content":" 6.5 å¯¼å…¥ NebulaGraph 6.5.1 åˆ›å»º NebulaGraph é›†ç¾¤æˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset curl -fsSL nebula-up.siwei.io/install.sh | bash 6.5.2 åˆ›å»º Schemaé¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«åš moviegraph çš„å›¾ç©ºé—´ï¼Œé’ˆå¯¹å‰è¾¹çš„å»ºæ¨¡ï¼Œåˆ›å»ºç‚¹è¾¹ç±»å‹çš„ç»“æ„ï¼ˆSchemaï¼‰ï¼š å…ˆè¿›å…¥ NebulaGraph çš„ consoleï¼š ~/.nebula-up/console.sh ç„¶åæ‰§è¡Œå¦‚ä¸‹ DDLï¼ˆData Definiation Languageï¼‰ï¼š CREATE SPACE moviegraph(partition_num=10,replica_factor=1,vid_type=fixed_string(32)); :sleep 20 USE moviegraph; CREATE TAG person(name string, birthdate string); CREATE TAG movie(name string); CREATE TAG genre(name string); CREATE TAG user(user_id string); CREATE EDGE acted_by(); CREATE EDGE directed_by(); CREATE EDGE with_genre(); CREATE EDGE watched(rate float); exit 6.5.3 åˆ›å»º Nebula-Importer é…ç½®æ–‡ä»¶è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªæè¿° CSV æ–‡ä»¶å’Œé›†ç¾¤ä¸­ç‚¹è¾¹æ•°æ®å¯¹åº”å…³ç³»çš„ YAML æ–‡ä»¶ã€‚è¯¦ç»†çš„æ ¼å¼å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼šhttps://docs.nebula-graph.com.cn/master/nebula-importer/use-importer/ï¼Œæˆ–è€…è§†é¢‘æ•™ç¨‹ï¼šhttps://www.bilibili.com/video/BV1ny4y1u7i4 ã€‚ æœ€ç»ˆçš„é…ç½®æ–‡ä»¶æˆ‘å·²ç»é—®å¤§å®¶å†™å¥½äº†ï¼Œåœ¨ https://github.com/wey-gu/movie-recommendation-dataset/blob/main/nebula-importer.yaml å¯ä»¥ä¸‹è½½å¾—åˆ°ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å°±ç›´æ¥ä¸‹è½½æˆ‘å†™å¥½äº†çš„é…ç½®æ–‡ä»¶ï¼Œæ³¨æ„ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸åº”è¯¥æ˜¯ dbt é¡¹ç›®æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬é€€å‡ºç›®å½•ï¼Œå‘ä¸Šä¸€å±‚ï¼ŒæŠŠå®ƒæ”¾åˆ° dbt_proeject å¤–è¾¹ï¼š cd .. wget https://raw.githubusercontent.com/wey-gu/movie-recommendation-dataset/main/nebula-importer.yaml 6.5.4 å¼€å§‹å¯¼å…¥è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ç”¨å®¹å™¨åŒ–çš„ nebula-importerï¼Œé¿å…äº†å®‰è£…çš„æ­¥éª¤ï¼š docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml å¾ˆå¿«ï¼Œæ‰€æœ‰çš„æ•°æ®å°±å¯¼å…¥åˆ° NebulaGraph ä¹‹ä¸­äº†ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ Nebula-Consoleï¼Œæ‰§è¡Œä¸€äº›æŸ¥è¯¢çœ‹çœ‹ç»“æœï¼š è¿›å…¥ console ~/.nebula-up/console.sh è¿›å…¥å›¾ç©ºé—´ã€æ‰§è¡Œ SHOW STATS USE moviegraph; SHOW STATS; ç»“æœï¼š (root@nebula) [moviegraph]\u003e SHOW STATS; +---------+---------------+---------+ | Type | Name | Count | +---------+---------------+---------+ | \"Tag\" | \"genre\" | 14397 | | \"Tag\" | \"movie\" | 20701 | | \"Tag\" | \"person\" | 263907 | | \"Tag\" | \"user\" | 610 | | \"Edge\" | \"acted_by\" | 673763 | | \"Edge\" | \"directed_by\" | 101949 | | \"Edge\" | \"watched\" | 31781 | | \"Edge\" | \"with_genre\" | 194009 | | \"Space\" | \"vertices\" | 299615 | | \"Space\" | \"edges\" | 1001502 | +---------+---------------+---------+ Got 10 rows (time spent 1693/15136 us) é€šè¿‡ Nebula-Studioï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å¯è§†åŒ–ç•Œé¢æ¢ç´¢è¿™ä¸ªå›¾è°±ï¼Œæ¯”å¦‚åœ¨å…¶ä¸­æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œçœ‹ä¸€ä¸‹ç»™ç”¨æˆ· u_124 æ¨èç”µå½± 1891 çš„ç†ç”±å¯èƒ½æ˜¯ä»€ä¹ˆï¼Ÿ FIND NOLOOP PATH FROM \"u_124\" TO \"1891\" over * BIDIRECT UPTO 4 STEPS yield path as `p` | LIMIT 20 ä»–çš„ç»“æœæ˜¯ï¼šæ›¾ç»å–œæ¬¢çš„æ˜Ÿæˆ˜ç”µå½±çš„å¤§éƒ¨åˆ†æ¼”èŒäººå‘˜éƒ½ä¹Ÿå‚ä¸äº†è¿™éƒ¨å’ŒåŒæ ·æ˜¯â€œå¥¥æ–¯å¡è·å¥–â€ä¸”â€œç»å…¸â€çš„ç”µå½±ã€‚ æˆ‘åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ç»™å¤§å®¶ç”¨åŒä¸€ä¸ªå›¾è°±å±•ç¤ºäº†æ›´å¤šå›¾æ•°æ®åº“ã€å›¾ç®—æ³•åœ¨æ¨èç³»ç»Ÿä¸Šçš„åº”ç”¨ï¼Œå¦‚æœå¤§å®¶æ„Ÿå…´è¶£ï¼Œæ¬¢è¿é˜…è¯»ï¼šhttps://www.siwei.io/recommendation-system-with-graphdb/ ã€‚ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:6:5","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#åˆ›å»º-nebula-importer-é…ç½®æ–‡ä»¶"},{"categories":["Nebula Graph"],"content":" 6.5 å¯¼å…¥ NebulaGraph 6.5.1 åˆ›å»º NebulaGraph é›†ç¾¤æˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset curl -fsSL nebula-up.siwei.io/install.sh | bash 6.5.2 åˆ›å»º Schemaé¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«åš moviegraph çš„å›¾ç©ºé—´ï¼Œé’ˆå¯¹å‰è¾¹çš„å»ºæ¨¡ï¼Œåˆ›å»ºç‚¹è¾¹ç±»å‹çš„ç»“æ„ï¼ˆSchemaï¼‰ï¼š å…ˆè¿›å…¥ NebulaGraph çš„ consoleï¼š ~/.nebula-up/console.sh ç„¶åæ‰§è¡Œå¦‚ä¸‹ DDLï¼ˆData Definiation Languageï¼‰ï¼š CREATE SPACE moviegraph(partition_num=10,replica_factor=1,vid_type=fixed_string(32)); :sleep 20 USE moviegraph; CREATE TAG person(name string, birthdate string); CREATE TAG movie(name string); CREATE TAG genre(name string); CREATE TAG user(user_id string); CREATE EDGE acted_by(); CREATE EDGE directed_by(); CREATE EDGE with_genre(); CREATE EDGE watched(rate float); exit 6.5.3 åˆ›å»º Nebula-Importer é…ç½®æ–‡ä»¶è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªæè¿° CSV æ–‡ä»¶å’Œé›†ç¾¤ä¸­ç‚¹è¾¹æ•°æ®å¯¹åº”å…³ç³»çš„ YAML æ–‡ä»¶ã€‚è¯¦ç»†çš„æ ¼å¼å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼šhttps://docs.nebula-graph.com.cn/master/nebula-importer/use-importer/ï¼Œæˆ–è€…è§†é¢‘æ•™ç¨‹ï¼šhttps://www.bilibili.com/video/BV1ny4y1u7i4 ã€‚ æœ€ç»ˆçš„é…ç½®æ–‡ä»¶æˆ‘å·²ç»é—®å¤§å®¶å†™å¥½äº†ï¼Œåœ¨ https://github.com/wey-gu/movie-recommendation-dataset/blob/main/nebula-importer.yaml å¯ä»¥ä¸‹è½½å¾—åˆ°ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å°±ç›´æ¥ä¸‹è½½æˆ‘å†™å¥½äº†çš„é…ç½®æ–‡ä»¶ï¼Œæ³¨æ„ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸åº”è¯¥æ˜¯ dbt é¡¹ç›®æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬é€€å‡ºç›®å½•ï¼Œå‘ä¸Šä¸€å±‚ï¼ŒæŠŠå®ƒæ”¾åˆ° dbt_proeject å¤–è¾¹ï¼š cd .. wget https://raw.githubusercontent.com/wey-gu/movie-recommendation-dataset/main/nebula-importer.yaml 6.5.4 å¼€å§‹å¯¼å…¥è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ç”¨å®¹å™¨åŒ–çš„ nebula-importerï¼Œé¿å…äº†å®‰è£…çš„æ­¥éª¤ï¼š docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml å¾ˆå¿«ï¼Œæ‰€æœ‰çš„æ•°æ®å°±å¯¼å…¥åˆ° NebulaGraph ä¹‹ä¸­äº†ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ Nebula-Consoleï¼Œæ‰§è¡Œä¸€äº›æŸ¥è¯¢çœ‹çœ‹ç»“æœï¼š è¿›å…¥ console ~/.nebula-up/console.sh è¿›å…¥å›¾ç©ºé—´ã€æ‰§è¡Œ SHOW STATS USE moviegraph; SHOW STATS; ç»“æœï¼š (root@nebula) [moviegraph]\u003e SHOW STATS; +---------+---------------+---------+ | Type | Name | Count | +---------+---------------+---------+ | \"Tag\" | \"genre\" | 14397 | | \"Tag\" | \"movie\" | 20701 | | \"Tag\" | \"person\" | 263907 | | \"Tag\" | \"user\" | 610 | | \"Edge\" | \"acted_by\" | 673763 | | \"Edge\" | \"directed_by\" | 101949 | | \"Edge\" | \"watched\" | 31781 | | \"Edge\" | \"with_genre\" | 194009 | | \"Space\" | \"vertices\" | 299615 | | \"Space\" | \"edges\" | 1001502 | +---------+---------------+---------+ Got 10 rows (time spent 1693/15136 us) é€šè¿‡ Nebula-Studioï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å¯è§†åŒ–ç•Œé¢æ¢ç´¢è¿™ä¸ªå›¾è°±ï¼Œæ¯”å¦‚åœ¨å…¶ä¸­æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œçœ‹ä¸€ä¸‹ç»™ç”¨æˆ· u_124 æ¨èç”µå½± 1891 çš„ç†ç”±å¯èƒ½æ˜¯ä»€ä¹ˆï¼Ÿ FIND NOLOOP PATH FROM \"u_124\" TO \"1891\" over * BIDIRECT UPTO 4 STEPS yield path as `p` | LIMIT 20 ä»–çš„ç»“æœæ˜¯ï¼šæ›¾ç»å–œæ¬¢çš„æ˜Ÿæˆ˜ç”µå½±çš„å¤§éƒ¨åˆ†æ¼”èŒäººå‘˜éƒ½ä¹Ÿå‚ä¸äº†è¿™éƒ¨å’ŒåŒæ ·æ˜¯â€œå¥¥æ–¯å¡è·å¥–â€ä¸”â€œç»å…¸â€çš„ç”µå½±ã€‚ æˆ‘åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ç»™å¤§å®¶ç”¨åŒä¸€ä¸ªå›¾è°±å±•ç¤ºäº†æ›´å¤šå›¾æ•°æ®åº“ã€å›¾ç®—æ³•åœ¨æ¨èç³»ç»Ÿä¸Šçš„åº”ç”¨ï¼Œå¦‚æœå¤§å®¶æ„Ÿå…´è¶£ï¼Œæ¬¢è¿é˜…è¯»ï¼šhttps://www.siwei.io/recommendation-system-with-graphdb/ ã€‚ ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:6:5","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#å¼€å§‹å¯¼å…¥"},{"categories":["Nebula Graph"],"content":" 7 æ€»ç»“å½“æˆ‘ä»¬æ‰“ç®—æŠŠæµ·é‡æ•°æ®åˆ©ç”¨å›¾æ•°æ®åº“çš„èƒ½åŠ›è¿›è¡ŒçŸ¥è¯†è½¬åŒ–ã€æ´å¯Ÿåˆ†æçš„æ—¶å€™ï¼Œå¾€å¾€ç¬¬ä¸€æ­¥å°±æ˜¯è¦åšå¤šæ•°æ®æºåˆ°å›¾æ•°æ®çš„è½¬æ¢ã€å¤„ç†ã€å»ºæ¨¡ã€‚å¯¹äºåœ¨æ— ä»ä¸‹æ‰‹çš„æ–°æ‰‹ä»¬æ¥è¯´ï¼Œä¸€ä¸ªå¯è¡Œçš„æ€è·¯æ˜¯ä»æ‰€æœ‰çš„ç›¸å…³ä¿¡æ¯å‡ºå‘ï¼Œå»è®¾æƒ³æœ€å…³æ³¨çš„å…³è”å…³ç³»ï¼ŒæŠŠè¾¹å†™å‡ºæ¥ï¼Œç„¶åå†ç½—åˆ—å¯ä»¥å–å¾—çš„ç‚¹ã€ä»¥åŠéœ€è¦çš„ç‚¹ã€è¾¹ä¸Šçš„å±æ€§ã€‚ç¡®å®šäº†åˆå§‹çš„å»ºæ¨¡ä¹‹åï¼Œå°±å¯ä»¥åˆ©ç”¨ ETL å·¥å…·æŠŠåŸå§‹çš„æ•°æ®æ¸…æ´—ã€ETL æˆç‚¹ã€è¾¹ç±»å‹çš„è¡¨ç»“æ„ï¼Œæœ€åï¼Œåˆ©ç”¨å¯¼å…¥å·¥å…·å¯¼å…¥ NebulaGraphã€‚ å€ŸåŠ©äº dbtï¼Œæˆ‘ä»¬å¯ä»¥ç‰ˆæœ¬æ§åˆ¶ã€æµ‹è¯•ã€è¿­ä»£æˆ‘ä»¬çš„å»ºæ¨¡ä¸æ•°æ®è½¬æ¢ï¼Œä¸€ç‚¹ç‚¹è¿›åŒ–ã€ä¸°å¯Œæ„å»ºçš„çŸ¥è¯†å›¾è°±ã€‚ é¢˜å›¾ç‰ˆæƒï¼šClaudio ","date":"2022-11-10","objectID":"/nebulagraph-etl-dbt/:7:0","series":null,"tags":["Nebula Graph","etl","dbt","å›¾å»ºæ¨¡","MovieLens","OMDB"],"title":"åˆ©ç”¨ dbtï¼ŒåŸºäºè¡¨ç»“æ„çš„ Nebulagraph å›¾å»ºæ¨¡ä¸ ETL","uri":"/nebulagraph-etl-dbt/#æ€»ç»“"},{"categories":["Nebula Graph"],"content":"æœ¬æ–‡æ˜¯ä¸€ä¸ªåŸºäº NebulaGraph ä¸Šå›¾ç®—æ³•ã€å›¾æ•°æ®åº“ã€æœºå™¨å­¦ä¹ ã€GNN çš„æ¨èç³»ç»Ÿæ–¹æ³•ç»¼è¿°ï¼Œå¤§éƒ¨åˆ†ä»‹ç»çš„æ–¹æ³•æä¾›äº† Playground ä¾›å¤§å®¶å­¦ä¹ ã€‚","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/"},{"categories":["Nebula Graph"],"content":" 1 åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ æœ¬æ–‡æ˜¯ä¸€ä¸ªåŸºäº NebulaGraph ä¸Šå›¾ç®—æ³•ã€å›¾æ•°æ®åº“ã€æœºå™¨å­¦ä¹ ã€GNN çš„æ¨èç³»ç»Ÿæ–¹æ³•ç»¼è¿°ï¼Œå¤§éƒ¨åˆ†ä»‹ç»çš„æ–¹æ³•æä¾›äº† Playground ä¾›å¤§å®¶å­¦ä¹ ã€‚ ","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:0","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ"},{"categories":["Nebula Graph"],"content":" 1.1 åŸºæœ¬æ¦‚å¿µæ¨èç³»ç»Ÿè¯ç”Ÿçš„åˆè¡·æ˜¯è§£å†³äº’è”ç½‘æ—¶ä»£æ‰é¢ä¸´çš„ä¿¡æ¯é‡è¿‡è½½é—®é¢˜ï¼Œä»æœ€åˆçš„ Amazon å›¾ä¹¦æ¨èã€å•†å“æ¨èï¼Œåˆ°ç”µå½±ã€éŸ³ä¹ã€è§†é¢‘ã€æ–°é—»æ¨èï¼Œå¦‚ä»Šå¤§å¤šæ•°ç½‘ç«™ã€App ä¸­éƒ½æœ‰è‡³å°‘ä¸€ä¸ªåŸºäºæ¨èç³»ç»Ÿç”Ÿæˆçš„ä¾›ç”¨æˆ·é€‰æ‹©çš„ç‰©å“åˆ—è¡¨ç•Œé¢ã€‚è€Œè¿™äº›ç‰©å“çš„æ¨èåŸºæœ¬éƒ½æ˜¯åŸºäºç”¨æˆ·å–œå¥½ã€ç‰©å“çš„ç‰¹å¾ã€ç”¨æˆ·ä¸ç‰©å“äº¤äº’å†å²å’Œå…¶ä»–ç›¸å…³ä¸Šä¸‹æ–‡å»åšçš„ã€‚ ä¸€ä¸ªæ¨èç³»ç»Ÿä¼šåŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š æ•°æ®ã€ç‰¹å¾çš„å¤„ç† ä»ç‰¹å¾å‡ºå‘ï¼Œç”Ÿæˆæ¨èåˆ—è¡¨ è¿‡æ»¤ã€æ’åºæ¨èåˆ—è¡¨ è¿™å…¶ä¸­ï¼Œè¿‡æ»¤çš„æ ¸å¿ƒæ–¹æ³•ä¸»è¦æœ‰ä¸¤ç§ï¼šåŸºäºå†…å®¹çš„è¿‡æ»¤ï¼ˆContent-Based Filteringï¼‰ã€ä¸ååŒè¿‡æ»¤ï¼ˆCollaborative Filteringï¼‰ã€‚ 1.1.1 åŸºäºå†…å®¹çš„è¿‡æ»¤å†…å®¹è¿‡æ»¤æ–¹æ³•çš„æœ¬è´¨æ˜¯ç»™ç”¨æˆ·çš„åå¥½åšç”»åƒï¼ŒåŒæ—¶å¯¹æ‰€æœ‰å¾…æ¨èçš„ç‰©å“è®¡ç®—ç‰¹å¾ï¼Œåšç”¨æˆ·çš„ç”»åƒä¸å¾…æ¨èç‰©å“ç‰¹å¾ä¹‹é—´çš„è·ç¦»è¿ç®—ï¼Œè¿‡æ»¤å¾—åˆ°ç›¸è¿‘çš„ç‰©å“ã€‚ ref: https://www.ise.bgu.ac.il/faculty/liorr/recsyshb/chContent.pdf å†…å®¹è¿‡æ»¤çš„æ–¹æ³•çš„å¥½å¤„æœ‰ï¼š æ¸…æ™°çš„å¯è§£é‡Šæ€§ï¼Œæ— è®ºæ˜¯å¯¹ç”¨æˆ·çš„ç”»åƒåˆ†æï¼Œè¿˜æ˜¯å¯¹ç‰©å“çš„è¿ç®—æœ¬èº«å¤©ç„¶å¸¦æ¥äº†æ’åºã€è¿‡æ»¤çš„å¯è§£é‡Šæ€§ ç”¨æˆ·æ•°æ®è¾“å…¥çš„ç‹¬ç«‹æ€§ï¼Œå¯¹ç»™å®šçš„å¾…æ¨èç”¨æˆ·æ¥è¯´ï¼Œåªéœ€è¦å•ç‹¬åˆ†æä»–ä»¬çš„ç”»åƒå’Œå†å²è¯„åˆ†å°±è¶³å¤Ÿäº† è§„é¿æ–°ç‰©å“å†·å¯åŠ¨é—®é¢˜ï¼Œå¯¹äºæ–°çš„æ·»åŠ çš„ç‰©å“ï¼Œå³ä½¿æ²¡æœ‰ä»»ä½•å†å²çš„ç”¨æˆ·è¯„ä»·ï¼Œä¹Ÿå¯ä»¥åšå‡ºæ¨è åŒæ—¶ï¼ŒåŸºäºå†…å®¹è¿‡æ»¤çš„æŒ‘æˆ˜ä¸åŠ£åŠ¿ä¹Ÿæœ‰ï¼š ç‰¹å¾æå–ï¼Œæå–å¾…æ¨èç‰©å“çš„ç‰¹å¾å¹¶éæ€»æ˜¯å¾ˆå®¹æ˜“åœ°ï¼Œæ¯”å¦‚ç…§ç‰‡ã€è§†é¢‘ç­‰éçº¯æ–‡æœ¬çš„ç‰©å“ï¼Œè€Œä¸”å¾€å¾€è¿™äº›ç‰©å“çš„ç‰¹å¾æå–ä¾èµ–é¢†åŸŸä¸“å®¶çŸ¥è¯†ï¼Œæ¯”å¦‚ç”µå½±æ¨èç³»ç»Ÿä¸­éœ€è¦æŠ½ç¦»å‡ºå¯¼æ¼”ã€ç”µå½±åˆ†ç±»ç­‰é¢†åŸŸçŸ¥è¯†ä½œä¸ºç‰¹å¾ ä¸æ“…é•¿çªç ´èˆ’é€‚åœˆï¼Œå‘æ˜ç”¨æˆ·çš„æ½œåœ¨æ–°å…´è¶£ç‚¹ å­˜åœ¨æ–°ç”¨æˆ·å†·å¯åŠ¨é—®é¢˜ï¼Œå¯¹å°‘æœ‰ä¿¡æ¯ä½œä¸ºç”¨æˆ·ç”»åƒçš„ç”¨æˆ·æ¥è¯´ï¼Œç¼ºå°‘åšè¿›ä¸€æ­¥ç‰©å“ç”»åƒã€ç‰¹ç§è·ç¦»è¿ç®—çš„è¾“å…¥ 1.1.2 åŸºäºååŒè¿‡æ»¤ååŒè¿‡æ»¤æ–¹æ³•æœ¬è´¨æ˜¯ååŒç”¨æˆ·ä¸ç³»ç»Ÿä¹‹é—´çš„äº¤äº’è¡Œä¸ºå»ç»™å‡ºæ¨èç‰©å“ã€‚ ååŒè¿‡æ»¤çš„æ–¹æ³•åˆåˆ†ä¸ºåŸºäºè®°å¿†ï¼ˆmemory-basedï¼‰çš„ä¸åŸºäºæ¨¡å‹ï¼ˆmodel-basedï¼‰çš„ã€‚ å‰è€…ä¸»è¦æœ‰ç‰©å“ä¸ç‰©å“ä¹‹é—´çš„ååŒè¿‡æ»¤ï¼ˆItemCFï¼‰å’Œç”¨æˆ·ä¸ç”¨æˆ·ä¹‹é—´çš„ååŒè¿‡æ»¤ï¼ˆUserCFï¼‰ï¼ŒItemCF ç®€å•æ¥è¯´æ˜¯æ¨èå’Œç”¨æˆ·ä¹‹å‰é€‰æ‹©è¿‡çš„ç‰©å“ç±»ä¼¼çš„ç‰©å“ï¼šæ ¹æ®è¡Œä¸ºæ‰¾ç‰©å“ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼ŒUserCF åˆ™æ¨èä¸ä¹‹æœ‰å…±åŒçˆ±å¥½çš„ç”¨æˆ·å–œæ¬¢çš„ç‰©å“ï¼šæ ¹æ®è¡Œä¸ºæ‰¾ç”¨æˆ·ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼› è€Œåè€…åŸºäºå±•ç°ç”¨æˆ·å–œå¥½çš„å†å²å®è·µä¿¡æ¯ã€åˆ©ç”¨ç»Ÿè®¡ä¸æœºå™¨å­¦ä¹ æ–¹æ³•è®­ç»ƒæ¨¡å‹ï¼Œå¯¹æ–°çš„ç”¨æˆ·åå¥½è¿›è¡Œæ¨ç†ã€‚ ååŒè¿‡æ»¤çš„æ–¹æ³•çš„å¥½å¤„æœ‰ï¼š æ— éœ€å¯¹éç»“æ„åŒ–ç‰©å“è¿›è¡Œç‰¹å¾åˆ†æï¼Œå› ä¸ºååŒè¿‡æ»¤å…³æ³¨çš„æ˜¯ç”¨æˆ·å’Œç‰©å“ä¹‹é—´çš„ååŒäº¤äº’ï¼Œè¿™ç»•è¿‡äº†å¯¹ç‰©å“é¢†åŸŸçŸ¥è¯†å¤„ç†çš„éœ€æ±‚ å¯¹ç”¨æˆ·çš„ä¸ªæ€§åŒ–æ›´å¼ºï¼Œæ›´ç»†ï¼ŒåŸºäºè¡Œä¸ºçš„åˆ†æä½¿å¾—å¯¹ç”¨æˆ·åå¥½çš„åˆ’åˆ†æœ¬è´¨ä¸Šæ˜¯è¿ç»­çš„ï¼ˆç›¸æ¯”æ¥è¯´ï¼Œå¯¹ç”¨æˆ·åšç”»åƒçš„æ–¹æ³•åˆ™æ˜¯ç¦»æ•£çš„ï¼‰ï¼Œè¿™æ ·çš„æ¨èç»“æœä¼šæ›´åŠ â€œåƒäººåƒé¢â€ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šè•´å«å†…å®¹è¿‡æ»¤ã€æœ‰é™çš„ç”»åƒè§’åº¦ä¹‹ä¸‹çš„â€œæƒŠå–œâ€æ¨è è€Œå®ƒçš„ç¼ºç‚¹æœ‰ï¼š æœ‰æ–°ç”¨æˆ·å’Œæ–°ç‰©ä»¶ä¸Šçš„å†·å¯åŠ¨é—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬èº«ä¸Šéƒ½ç¼ºå°‘å†å²å–œå¥½è¡Œä¸ºçš„ä¿¡æ¯ ref: https://coek.info/pdf-a-dynamic-collaborative-filtering-system-via-a-weighted-clustering-approach-.html ä»ä»¥ä¸Šä¸¤ç§ä¸»è¦çš„è¿‡æ»¤æ–¹å¼çš„ä¼˜åŠ£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬ä¹‹ä¸­å­˜åœ¨äº’è¡¥çš„åœ°æ–¹ï¼Œæ¯”å¦‚æ–°ç‰©ä»¶çš„å†·å¯åŠ¨ä¸Šï¼ŒåŸºäºå†…å®¹çš„è¿‡æ»¤æœ‰ä¼˜åŠ¿ï¼Œå¯¹äºä¸ªæ€§åŒ–ã€æƒŠå–œæ¨èè§’åº¦ï¼ŒååŒè¿‡æ»¤æœ‰ä¼˜åŠ¿ã€‚æ‰€ä»¥ï¼Œåœ¨çœŸå®ä¸–ç•Œä¸­ï¼Œæ¨èç³»ç»Ÿåœ¨å¤§å¤šæ¼”åŒ–åœ°æ¯”ä¸Šè¾¹çš„å½’ç±»å¤æ‚å¾—å¤šï¼Œè€Œä¸”å¸¸å¸¸æ˜¯å¤šç§æ–¹æ³•çš„èåˆã€‚ ","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:1","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#åŸºæœ¬æ¦‚å¿µ"},{"categories":["Nebula Graph"],"content":" 1.1 åŸºæœ¬æ¦‚å¿µæ¨èç³»ç»Ÿè¯ç”Ÿçš„åˆè¡·æ˜¯è§£å†³äº’è”ç½‘æ—¶ä»£æ‰é¢ä¸´çš„ä¿¡æ¯é‡è¿‡è½½é—®é¢˜ï¼Œä»æœ€åˆçš„ Amazon å›¾ä¹¦æ¨èã€å•†å“æ¨èï¼Œåˆ°ç”µå½±ã€éŸ³ä¹ã€è§†é¢‘ã€æ–°é—»æ¨èï¼Œå¦‚ä»Šå¤§å¤šæ•°ç½‘ç«™ã€App ä¸­éƒ½æœ‰è‡³å°‘ä¸€ä¸ªåŸºäºæ¨èç³»ç»Ÿç”Ÿæˆçš„ä¾›ç”¨æˆ·é€‰æ‹©çš„ç‰©å“åˆ—è¡¨ç•Œé¢ã€‚è€Œè¿™äº›ç‰©å“çš„æ¨èåŸºæœ¬éƒ½æ˜¯åŸºäºç”¨æˆ·å–œå¥½ã€ç‰©å“çš„ç‰¹å¾ã€ç”¨æˆ·ä¸ç‰©å“äº¤äº’å†å²å’Œå…¶ä»–ç›¸å…³ä¸Šä¸‹æ–‡å»åšçš„ã€‚ ä¸€ä¸ªæ¨èç³»ç»Ÿä¼šåŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š æ•°æ®ã€ç‰¹å¾çš„å¤„ç† ä»ç‰¹å¾å‡ºå‘ï¼Œç”Ÿæˆæ¨èåˆ—è¡¨ è¿‡æ»¤ã€æ’åºæ¨èåˆ—è¡¨ è¿™å…¶ä¸­ï¼Œè¿‡æ»¤çš„æ ¸å¿ƒæ–¹æ³•ä¸»è¦æœ‰ä¸¤ç§ï¼šåŸºäºå†…å®¹çš„è¿‡æ»¤ï¼ˆContent-Based Filteringï¼‰ã€ä¸ååŒè¿‡æ»¤ï¼ˆCollaborative Filteringï¼‰ã€‚ 1.1.1 åŸºäºå†…å®¹çš„è¿‡æ»¤å†…å®¹è¿‡æ»¤æ–¹æ³•çš„æœ¬è´¨æ˜¯ç»™ç”¨æˆ·çš„åå¥½åšç”»åƒï¼ŒåŒæ—¶å¯¹æ‰€æœ‰å¾…æ¨èçš„ç‰©å“è®¡ç®—ç‰¹å¾ï¼Œåšç”¨æˆ·çš„ç”»åƒä¸å¾…æ¨èç‰©å“ç‰¹å¾ä¹‹é—´çš„è·ç¦»è¿ç®—ï¼Œè¿‡æ»¤å¾—åˆ°ç›¸è¿‘çš„ç‰©å“ã€‚ ref: https://www.ise.bgu.ac.il/faculty/liorr/recsyshb/chContent.pdf å†…å®¹è¿‡æ»¤çš„æ–¹æ³•çš„å¥½å¤„æœ‰ï¼š æ¸…æ™°çš„å¯è§£é‡Šæ€§ï¼Œæ— è®ºæ˜¯å¯¹ç”¨æˆ·çš„ç”»åƒåˆ†æï¼Œè¿˜æ˜¯å¯¹ç‰©å“çš„è¿ç®—æœ¬èº«å¤©ç„¶å¸¦æ¥äº†æ’åºã€è¿‡æ»¤çš„å¯è§£é‡Šæ€§ ç”¨æˆ·æ•°æ®è¾“å…¥çš„ç‹¬ç«‹æ€§ï¼Œå¯¹ç»™å®šçš„å¾…æ¨èç”¨æˆ·æ¥è¯´ï¼Œåªéœ€è¦å•ç‹¬åˆ†æä»–ä»¬çš„ç”»åƒå’Œå†å²è¯„åˆ†å°±è¶³å¤Ÿäº† è§„é¿æ–°ç‰©å“å†·å¯åŠ¨é—®é¢˜ï¼Œå¯¹äºæ–°çš„æ·»åŠ çš„ç‰©å“ï¼Œå³ä½¿æ²¡æœ‰ä»»ä½•å†å²çš„ç”¨æˆ·è¯„ä»·ï¼Œä¹Ÿå¯ä»¥åšå‡ºæ¨è åŒæ—¶ï¼ŒåŸºäºå†…å®¹è¿‡æ»¤çš„æŒ‘æˆ˜ä¸åŠ£åŠ¿ä¹Ÿæœ‰ï¼š ç‰¹å¾æå–ï¼Œæå–å¾…æ¨èç‰©å“çš„ç‰¹å¾å¹¶éæ€»æ˜¯å¾ˆå®¹æ˜“åœ°ï¼Œæ¯”å¦‚ç…§ç‰‡ã€è§†é¢‘ç­‰éçº¯æ–‡æœ¬çš„ç‰©å“ï¼Œè€Œä¸”å¾€å¾€è¿™äº›ç‰©å“çš„ç‰¹å¾æå–ä¾èµ–é¢†åŸŸä¸“å®¶çŸ¥è¯†ï¼Œæ¯”å¦‚ç”µå½±æ¨èç³»ç»Ÿä¸­éœ€è¦æŠ½ç¦»å‡ºå¯¼æ¼”ã€ç”µå½±åˆ†ç±»ç­‰é¢†åŸŸçŸ¥è¯†ä½œä¸ºç‰¹å¾ ä¸æ“…é•¿çªç ´èˆ’é€‚åœˆï¼Œå‘æ˜ç”¨æˆ·çš„æ½œåœ¨æ–°å…´è¶£ç‚¹ å­˜åœ¨æ–°ç”¨æˆ·å†·å¯åŠ¨é—®é¢˜ï¼Œå¯¹å°‘æœ‰ä¿¡æ¯ä½œä¸ºç”¨æˆ·ç”»åƒçš„ç”¨æˆ·æ¥è¯´ï¼Œç¼ºå°‘åšè¿›ä¸€æ­¥ç‰©å“ç”»åƒã€ç‰¹ç§è·ç¦»è¿ç®—çš„è¾“å…¥ 1.1.2 åŸºäºååŒè¿‡æ»¤ååŒè¿‡æ»¤æ–¹æ³•æœ¬è´¨æ˜¯ååŒç”¨æˆ·ä¸ç³»ç»Ÿä¹‹é—´çš„äº¤äº’è¡Œä¸ºå»ç»™å‡ºæ¨èç‰©å“ã€‚ ååŒè¿‡æ»¤çš„æ–¹æ³•åˆåˆ†ä¸ºåŸºäºè®°å¿†ï¼ˆmemory-basedï¼‰çš„ä¸åŸºäºæ¨¡å‹ï¼ˆmodel-basedï¼‰çš„ã€‚ å‰è€…ä¸»è¦æœ‰ç‰©å“ä¸ç‰©å“ä¹‹é—´çš„ååŒè¿‡æ»¤ï¼ˆItemCFï¼‰å’Œç”¨æˆ·ä¸ç”¨æˆ·ä¹‹é—´çš„ååŒè¿‡æ»¤ï¼ˆUserCFï¼‰ï¼ŒItemCF ç®€å•æ¥è¯´æ˜¯æ¨èå’Œç”¨æˆ·ä¹‹å‰é€‰æ‹©è¿‡çš„ç‰©å“ç±»ä¼¼çš„ç‰©å“ï¼šæ ¹æ®è¡Œä¸ºæ‰¾ç‰©å“ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼ŒUserCF åˆ™æ¨èä¸ä¹‹æœ‰å…±åŒçˆ±å¥½çš„ç”¨æˆ·å–œæ¬¢çš„ç‰©å“ï¼šæ ¹æ®è¡Œä¸ºæ‰¾ç”¨æˆ·ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼› è€Œåè€…åŸºäºå±•ç°ç”¨æˆ·å–œå¥½çš„å†å²å®è·µä¿¡æ¯ã€åˆ©ç”¨ç»Ÿè®¡ä¸æœºå™¨å­¦ä¹ æ–¹æ³•è®­ç»ƒæ¨¡å‹ï¼Œå¯¹æ–°çš„ç”¨æˆ·åå¥½è¿›è¡Œæ¨ç†ã€‚ ååŒè¿‡æ»¤çš„æ–¹æ³•çš„å¥½å¤„æœ‰ï¼š æ— éœ€å¯¹éç»“æ„åŒ–ç‰©å“è¿›è¡Œç‰¹å¾åˆ†æï¼Œå› ä¸ºååŒè¿‡æ»¤å…³æ³¨çš„æ˜¯ç”¨æˆ·å’Œç‰©å“ä¹‹é—´çš„ååŒäº¤äº’ï¼Œè¿™ç»•è¿‡äº†å¯¹ç‰©å“é¢†åŸŸçŸ¥è¯†å¤„ç†çš„éœ€æ±‚ å¯¹ç”¨æˆ·çš„ä¸ªæ€§åŒ–æ›´å¼ºï¼Œæ›´ç»†ï¼ŒåŸºäºè¡Œä¸ºçš„åˆ†æä½¿å¾—å¯¹ç”¨æˆ·åå¥½çš„åˆ’åˆ†æœ¬è´¨ä¸Šæ˜¯è¿ç»­çš„ï¼ˆç›¸æ¯”æ¥è¯´ï¼Œå¯¹ç”¨æˆ·åšç”»åƒçš„æ–¹æ³•åˆ™æ˜¯ç¦»æ•£çš„ï¼‰ï¼Œè¿™æ ·çš„æ¨èç»“æœä¼šæ›´åŠ â€œåƒäººåƒé¢â€ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šè•´å«å†…å®¹è¿‡æ»¤ã€æœ‰é™çš„ç”»åƒè§’åº¦ä¹‹ä¸‹çš„â€œæƒŠå–œâ€æ¨è è€Œå®ƒçš„ç¼ºç‚¹æœ‰ï¼š æœ‰æ–°ç”¨æˆ·å’Œæ–°ç‰©ä»¶ä¸Šçš„å†·å¯åŠ¨é—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬èº«ä¸Šéƒ½ç¼ºå°‘å†å²å–œå¥½è¡Œä¸ºçš„ä¿¡æ¯ ref: https://coek.info/pdf-a-dynamic-collaborative-filtering-system-via-a-weighted-clustering-approach-.html ä»ä»¥ä¸Šä¸¤ç§ä¸»è¦çš„è¿‡æ»¤æ–¹å¼çš„ä¼˜åŠ£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬ä¹‹ä¸­å­˜åœ¨äº’è¡¥çš„åœ°æ–¹ï¼Œæ¯”å¦‚æ–°ç‰©ä»¶çš„å†·å¯åŠ¨ä¸Šï¼ŒåŸºäºå†…å®¹çš„è¿‡æ»¤æœ‰ä¼˜åŠ¿ï¼Œå¯¹äºä¸ªæ€§åŒ–ã€æƒŠå–œæ¨èè§’åº¦ï¼ŒååŒè¿‡æ»¤æœ‰ä¼˜åŠ¿ã€‚æ‰€ä»¥ï¼Œåœ¨çœŸå®ä¸–ç•Œä¸­ï¼Œæ¨èç³»ç»Ÿåœ¨å¤§å¤šæ¼”åŒ–åœ°æ¯”ä¸Šè¾¹çš„å½’ç±»å¤æ‚å¾—å¤šï¼Œè€Œä¸”å¸¸å¸¸æ˜¯å¤šç§æ–¹æ³•çš„èåˆã€‚ ","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:1","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#åŸºäºå†…å®¹çš„è¿‡æ»¤"},{"categories":["Nebula Graph"],"content":" 1.1 åŸºæœ¬æ¦‚å¿µæ¨èç³»ç»Ÿè¯ç”Ÿçš„åˆè¡·æ˜¯è§£å†³äº’è”ç½‘æ—¶ä»£æ‰é¢ä¸´çš„ä¿¡æ¯é‡è¿‡è½½é—®é¢˜ï¼Œä»æœ€åˆçš„ Amazon å›¾ä¹¦æ¨èã€å•†å“æ¨èï¼Œåˆ°ç”µå½±ã€éŸ³ä¹ã€è§†é¢‘ã€æ–°é—»æ¨èï¼Œå¦‚ä»Šå¤§å¤šæ•°ç½‘ç«™ã€App ä¸­éƒ½æœ‰è‡³å°‘ä¸€ä¸ªåŸºäºæ¨èç³»ç»Ÿç”Ÿæˆçš„ä¾›ç”¨æˆ·é€‰æ‹©çš„ç‰©å“åˆ—è¡¨ç•Œé¢ã€‚è€Œè¿™äº›ç‰©å“çš„æ¨èåŸºæœ¬éƒ½æ˜¯åŸºäºç”¨æˆ·å–œå¥½ã€ç‰©å“çš„ç‰¹å¾ã€ç”¨æˆ·ä¸ç‰©å“äº¤äº’å†å²å’Œå…¶ä»–ç›¸å…³ä¸Šä¸‹æ–‡å»åšçš„ã€‚ ä¸€ä¸ªæ¨èç³»ç»Ÿä¼šåŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š æ•°æ®ã€ç‰¹å¾çš„å¤„ç† ä»ç‰¹å¾å‡ºå‘ï¼Œç”Ÿæˆæ¨èåˆ—è¡¨ è¿‡æ»¤ã€æ’åºæ¨èåˆ—è¡¨ è¿™å…¶ä¸­ï¼Œè¿‡æ»¤çš„æ ¸å¿ƒæ–¹æ³•ä¸»è¦æœ‰ä¸¤ç§ï¼šåŸºäºå†…å®¹çš„è¿‡æ»¤ï¼ˆContent-Based Filteringï¼‰ã€ä¸ååŒè¿‡æ»¤ï¼ˆCollaborative Filteringï¼‰ã€‚ 1.1.1 åŸºäºå†…å®¹çš„è¿‡æ»¤å†…å®¹è¿‡æ»¤æ–¹æ³•çš„æœ¬è´¨æ˜¯ç»™ç”¨æˆ·çš„åå¥½åšç”»åƒï¼ŒåŒæ—¶å¯¹æ‰€æœ‰å¾…æ¨èçš„ç‰©å“è®¡ç®—ç‰¹å¾ï¼Œåšç”¨æˆ·çš„ç”»åƒä¸å¾…æ¨èç‰©å“ç‰¹å¾ä¹‹é—´çš„è·ç¦»è¿ç®—ï¼Œè¿‡æ»¤å¾—åˆ°ç›¸è¿‘çš„ç‰©å“ã€‚ ref: https://www.ise.bgu.ac.il/faculty/liorr/recsyshb/chContent.pdf å†…å®¹è¿‡æ»¤çš„æ–¹æ³•çš„å¥½å¤„æœ‰ï¼š æ¸…æ™°çš„å¯è§£é‡Šæ€§ï¼Œæ— è®ºæ˜¯å¯¹ç”¨æˆ·çš„ç”»åƒåˆ†æï¼Œè¿˜æ˜¯å¯¹ç‰©å“çš„è¿ç®—æœ¬èº«å¤©ç„¶å¸¦æ¥äº†æ’åºã€è¿‡æ»¤çš„å¯è§£é‡Šæ€§ ç”¨æˆ·æ•°æ®è¾“å…¥çš„ç‹¬ç«‹æ€§ï¼Œå¯¹ç»™å®šçš„å¾…æ¨èç”¨æˆ·æ¥è¯´ï¼Œåªéœ€è¦å•ç‹¬åˆ†æä»–ä»¬çš„ç”»åƒå’Œå†å²è¯„åˆ†å°±è¶³å¤Ÿäº† è§„é¿æ–°ç‰©å“å†·å¯åŠ¨é—®é¢˜ï¼Œå¯¹äºæ–°çš„æ·»åŠ çš„ç‰©å“ï¼Œå³ä½¿æ²¡æœ‰ä»»ä½•å†å²çš„ç”¨æˆ·è¯„ä»·ï¼Œä¹Ÿå¯ä»¥åšå‡ºæ¨è åŒæ—¶ï¼ŒåŸºäºå†…å®¹è¿‡æ»¤çš„æŒ‘æˆ˜ä¸åŠ£åŠ¿ä¹Ÿæœ‰ï¼š ç‰¹å¾æå–ï¼Œæå–å¾…æ¨èç‰©å“çš„ç‰¹å¾å¹¶éæ€»æ˜¯å¾ˆå®¹æ˜“åœ°ï¼Œæ¯”å¦‚ç…§ç‰‡ã€è§†é¢‘ç­‰éçº¯æ–‡æœ¬çš„ç‰©å“ï¼Œè€Œä¸”å¾€å¾€è¿™äº›ç‰©å“çš„ç‰¹å¾æå–ä¾èµ–é¢†åŸŸä¸“å®¶çŸ¥è¯†ï¼Œæ¯”å¦‚ç”µå½±æ¨èç³»ç»Ÿä¸­éœ€è¦æŠ½ç¦»å‡ºå¯¼æ¼”ã€ç”µå½±åˆ†ç±»ç­‰é¢†åŸŸçŸ¥è¯†ä½œä¸ºç‰¹å¾ ä¸æ“…é•¿çªç ´èˆ’é€‚åœˆï¼Œå‘æ˜ç”¨æˆ·çš„æ½œåœ¨æ–°å…´è¶£ç‚¹ å­˜åœ¨æ–°ç”¨æˆ·å†·å¯åŠ¨é—®é¢˜ï¼Œå¯¹å°‘æœ‰ä¿¡æ¯ä½œä¸ºç”¨æˆ·ç”»åƒçš„ç”¨æˆ·æ¥è¯´ï¼Œç¼ºå°‘åšè¿›ä¸€æ­¥ç‰©å“ç”»åƒã€ç‰¹ç§è·ç¦»è¿ç®—çš„è¾“å…¥ 1.1.2 åŸºäºååŒè¿‡æ»¤ååŒè¿‡æ»¤æ–¹æ³•æœ¬è´¨æ˜¯ååŒç”¨æˆ·ä¸ç³»ç»Ÿä¹‹é—´çš„äº¤äº’è¡Œä¸ºå»ç»™å‡ºæ¨èç‰©å“ã€‚ ååŒè¿‡æ»¤çš„æ–¹æ³•åˆåˆ†ä¸ºåŸºäºè®°å¿†ï¼ˆmemory-basedï¼‰çš„ä¸åŸºäºæ¨¡å‹ï¼ˆmodel-basedï¼‰çš„ã€‚ å‰è€…ä¸»è¦æœ‰ç‰©å“ä¸ç‰©å“ä¹‹é—´çš„ååŒè¿‡æ»¤ï¼ˆItemCFï¼‰å’Œç”¨æˆ·ä¸ç”¨æˆ·ä¹‹é—´çš„ååŒè¿‡æ»¤ï¼ˆUserCFï¼‰ï¼ŒItemCF ç®€å•æ¥è¯´æ˜¯æ¨èå’Œç”¨æˆ·ä¹‹å‰é€‰æ‹©è¿‡çš„ç‰©å“ç±»ä¼¼çš„ç‰©å“ï¼šæ ¹æ®è¡Œä¸ºæ‰¾ç‰©å“ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼ŒUserCF åˆ™æ¨èä¸ä¹‹æœ‰å…±åŒçˆ±å¥½çš„ç”¨æˆ·å–œæ¬¢çš„ç‰©å“ï¼šæ ¹æ®è¡Œä¸ºæ‰¾ç”¨æˆ·ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼› è€Œåè€…åŸºäºå±•ç°ç”¨æˆ·å–œå¥½çš„å†å²å®è·µä¿¡æ¯ã€åˆ©ç”¨ç»Ÿè®¡ä¸æœºå™¨å­¦ä¹ æ–¹æ³•è®­ç»ƒæ¨¡å‹ï¼Œå¯¹æ–°çš„ç”¨æˆ·åå¥½è¿›è¡Œæ¨ç†ã€‚ ååŒè¿‡æ»¤çš„æ–¹æ³•çš„å¥½å¤„æœ‰ï¼š æ— éœ€å¯¹éç»“æ„åŒ–ç‰©å“è¿›è¡Œç‰¹å¾åˆ†æï¼Œå› ä¸ºååŒè¿‡æ»¤å…³æ³¨çš„æ˜¯ç”¨æˆ·å’Œç‰©å“ä¹‹é—´çš„ååŒäº¤äº’ï¼Œè¿™ç»•è¿‡äº†å¯¹ç‰©å“é¢†åŸŸçŸ¥è¯†å¤„ç†çš„éœ€æ±‚ å¯¹ç”¨æˆ·çš„ä¸ªæ€§åŒ–æ›´å¼ºï¼Œæ›´ç»†ï¼ŒåŸºäºè¡Œä¸ºçš„åˆ†æä½¿å¾—å¯¹ç”¨æˆ·åå¥½çš„åˆ’åˆ†æœ¬è´¨ä¸Šæ˜¯è¿ç»­çš„ï¼ˆç›¸æ¯”æ¥è¯´ï¼Œå¯¹ç”¨æˆ·åšç”»åƒçš„æ–¹æ³•åˆ™æ˜¯ç¦»æ•£çš„ï¼‰ï¼Œè¿™æ ·çš„æ¨èç»“æœä¼šæ›´åŠ â€œåƒäººåƒé¢â€ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¼šè•´å«å†…å®¹è¿‡æ»¤ã€æœ‰é™çš„ç”»åƒè§’åº¦ä¹‹ä¸‹çš„â€œæƒŠå–œâ€æ¨è è€Œå®ƒçš„ç¼ºç‚¹æœ‰ï¼š æœ‰æ–°ç”¨æˆ·å’Œæ–°ç‰©ä»¶ä¸Šçš„å†·å¯åŠ¨é—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬èº«ä¸Šéƒ½ç¼ºå°‘å†å²å–œå¥½è¡Œä¸ºçš„ä¿¡æ¯ ref: https://coek.info/pdf-a-dynamic-collaborative-filtering-system-via-a-weighted-clustering-approach-.html ä»ä»¥ä¸Šä¸¤ç§ä¸»è¦çš„è¿‡æ»¤æ–¹å¼çš„ä¼˜åŠ£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬ä¹‹ä¸­å­˜åœ¨äº’è¡¥çš„åœ°æ–¹ï¼Œæ¯”å¦‚æ–°ç‰©ä»¶çš„å†·å¯åŠ¨ä¸Šï¼ŒåŸºäºå†…å®¹çš„è¿‡æ»¤æœ‰ä¼˜åŠ¿ï¼Œå¯¹äºä¸ªæ€§åŒ–ã€æƒŠå–œæ¨èè§’åº¦ï¼ŒååŒè¿‡æ»¤æœ‰ä¼˜åŠ¿ã€‚æ‰€ä»¥ï¼Œåœ¨çœŸå®ä¸–ç•Œä¸­ï¼Œæ¨èç³»ç»Ÿåœ¨å¤§å¤šæ¼”åŒ–åœ°æ¯”ä¸Šè¾¹çš„å½’ç±»å¤æ‚å¾—å¤šï¼Œè€Œä¸”å¸¸å¸¸æ˜¯å¤šç§æ–¹æ³•çš„èåˆã€‚ ","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:1","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#åŸºäºååŒè¿‡æ»¤"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#åŸºäºå›¾çš„ä¸ªæ€§æ¨è"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#å»ºç«‹å›¾è°±"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#åŸºäºå†…å®¹çš„è¿‡æ»¤-1"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#jaccard-index"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#cbf-æ–¹æ³•åœ¨-nebulagraph-ä¸­çš„å®ç°"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#å¯è§†åŒ–åˆ†æ"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#åŸºäºè®°å¿†çš„ååŒè¿‡æ»¤"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#itemcf"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#å¯è§†åŒ–åˆ†æ-itemcf"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#å…³äºé«˜è¯„åˆ†"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#pearson-correlation-coefficient"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#usercf"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#å¯è§†åŒ–åˆ†æ-usercf"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#æ··åˆçš„æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#åŸºäºæ¨¡å‹çš„æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.2 åŸºäºå›¾çš„ä¸ªæ€§æ¨èå›¾æŠ€æœ¯ã€å›¾æ•°æ®åº“æŠ€æœ¯åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ¬ç« æˆ‘ä»¬å°±ä»å›¾æ•°æ®åº“çš„å‡ºå‘ç‚¹ä¸Šç»™å‡ºå¤šç§åº”ç”¨çš„ä¾‹å­ã€‚ 1.2.1 å»ºç«‹å›¾è°±åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä½¿ç”¨çš„å›¾æ•°æ®é›†ã€‚ ä¸ºäº†ç»™å‡ºæ›´æ¥è¿‘å®é™…æƒ…å†µçš„ä¾‹å­ï¼Œæˆ‘ä»ä¸¤ä¸ªå…¬å¼€çš„æ•°æ®é›† OMDB å’Œ MovieLens ä¸­åˆ†åˆ«æŠ½å–äº†éœ€è¦çš„ä¿¡æ¯ï¼Œç»„æˆäº†ä¸€ä¸ªæ—¢åŒ…å«ç”µå½±çš„å¡å¸ï¼ˆå¯¼æ¼”ã€æ¼”å‘˜ï¼‰å’Œç±»å‹ã€åˆåŒ…å«ç”¨æˆ·å¯¹ç”µå½±è¯„åˆ†è®°å½•çš„çŸ¥è¯†å›¾è°±ã€‚ å®ƒçš„ Scehma å¦‚ä¸‹ï¼š é¡¶ç‚¹ï¼š user(user_id) movie(name) person(name, birthdate) genre(name) è¾¹ï¼š watched(rate(double)) with_genre directed_by acted_by è¿™ä¸ªæ•°æ®çš„å‡†å¤‡ã€ETL è¿‡ç¨‹ä¼šåœ¨å¦å¤–çš„æ–‡ç« é‡Œè¯¦ç»†ä»‹ç»ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€ç« èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Nebula-Up ä¸€é”®æ­èµ·ä¸€ä¸ªæµ‹è¯•çš„ NebulaGraph å•æœºé›†ç¾¤ï¼Œç„¶åå‚è€ƒæ•°æ®é›†çš„ GitHub ä»“åº“ï¼Œä¸€é”®å¯¼å…¥æ‰€éœ€æ•°æ®ï¼š æ³¨ï¼š Nebula-UPï¼šhttps://github.com/wey-gu/nebula-up æ•°æ®é›†ä»“åº“ï¼šhttps://github.com/wey-gu/movie-recommendation-dataset è¿‡ç¨‹æœ€ç®€å•çš„æ“ä½œè¿‡ç¨‹ä¸ºï¼š ç”¨ Nebula-Up å®‰è£… NebulaGraph å…‹éš† movie-recommendation-dataset å¯¼å…¥æ•°æ®é›† NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash git clone https://github.com/wey-gu/movie-recommendation-dataset.git \u0026\u0026 cd movie-recommendation-dataset docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/dbt_project/to_nebulagraph/:/data \\ vesoft/nebula-importer:v3.2.0 \\ --config /root/nebula-importer.yaml 1.2.2 åŸºäºå†…å®¹çš„è¿‡æ»¤CBF çš„æ€æƒ³æ˜¯åˆ©ç”¨é¢†åŸŸçŸ¥è¯†ã€å†å²è®°å½•ã€å…ƒæ•°æ®åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©ä»¶åšç”»åƒã€æ‰“æ ‡ç­¾ï¼Œæœ€ç»ˆæ ¹æ®ç”¨æˆ·çš„æ ‡ç­¾ä¸å¾…æ¨èç‰©ä»¶ä¹‹é—´çš„è·ç¦»è¯„åˆ†æ’åºç»™å‡ºæ¨èã€‚ å¯¹ç”¨æˆ·çš„ç”»åƒä¸æ¶‰åŠå…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¾“å…¥çš„ç‰¹å¾å¯èƒ½æ¥æºäºå…ƒæ•°æ®ï¼ˆç”Ÿæ—¥ã€å›½ç±ã€æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œå†å²è®°å½•ï¼ˆè¯„è®ºã€æ‰“åˆ†ã€è´­ä¹°ã€æµè§ˆï¼‰ç­‰ç­‰ï¼Œåœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šå¯¹ç”¨æˆ·è¿›è¡Œæ ‡ç­¾æ ‡æ³¨ã€åˆ†ç±»ã€èšç±»ã€‚ å¯¹ç‰©ä»¶çš„ç”»åƒè¾“å…¥çš„ç‰¹å¾å¯èƒ½æ˜¯åŸºäºè¯­è¨€å¤„ç†ï¼ˆNLPã€TF-IDFã€LFMï¼‰ã€ä¸“å®¶æ ‡æ³¨ã€å¤šåª’ä½“å¤„ç†ï¼ˆè§†è§‰åˆ°æ–‡å­—å†NLPã€éŸ³é¢‘é£æ ¼å¤„ç†ã€éŸ³é¢‘åˆ°æ–‡å­—å†NLPï¼‰ç­‰ã€‚ æœ‰äº†ç”¨æˆ·ç”»åƒä¸ç‰©ä»¶çš„ç”»åƒç‰¹å¾ã€å¯¹ç”¨æˆ·æ¶‰åŠçš„ç”»åƒè¿›è¡Œç›¸å…³ç”»åƒç‰©ä»¶ä¸­æ–°å¯¹è±¡çš„è¿‘ä¼¼åº¦è®¡ç®—ï¼Œå†è¯„åˆ†åŠ æƒï¼Œå°±å¯ä»¥è·å¾—æœ€ç»ˆçš„æ¨èæ’åºäº†ã€‚è¿™å…¶ä¸­çš„è¿‘ä¼¼åº¦è®¡ç®—å¯ä»¥æ˜¯å¸¸è§çš„ KNNï¼Œä½™å¼¦ç›¸ä¼¼ï¼ŒJaccard ç›¸ä¼¼ç­‰å„ç§æ–¹æ³•ã€‚ CBF çš„æ–¹æ³•ä¸­æ²¡æœ‰é™å®šå…·ä½“å®ç°æ–¹å¼ï¼Œå¦‚å‰è¾¹ä»‹ç»ï¼Œå¯èƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ ã€elasticsearchã€å›¾è°±ç­‰ä¸åŒçš„æ–¹æ³•ã€‚è¿™é‡Œä¸ºåˆ‡åˆæœ¬ç« çš„ä¸»é¢˜ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“ã€å›¾è°±ä¸Šçš„ CBF çš„ä¾‹å­ï¼Œåšä¸€ä¸ªç”µå½±æ¨èç³»ç»Ÿï¼Œèƒ½è®©è¯»è€…ç†è§£è¿™ä¸ªæ–¹æ³•çš„æ€æƒ³çš„åŒæ—¶ç†Ÿæ‚‰å›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±çš„æ–¹æ³•ã€‚ è¿™å…¶ä¸­ç”¨æˆ·çš„ç‰¹å¾æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å†å²ç”µå½±è¯„ä»·è®°å½•ï¼Œè€Œæ¨èç‰©ä»¶ï¼šç”µå½±ï¼Œçš„ç”»åƒåˆ™æ¥è‡ªäºé¢†åŸŸä¸­çš„çŸ¥è¯†ã€‚è¿™äº›çŸ¥è¯†æœ‰ï¼šç”µå½±é£æ ¼ã€ç”µå½±çš„å¡æ–¯ã€å¯¼æ¼”ã€‚è¿‘ä¼¼åº¦è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨å›¾è°±ä¸­åŸºäºå…³ç³»çš„ Jaccard ç›¸ä¼¼åº¦ç®—æ³•ã€‚ 1.2.2.1 Jaccard IndexJaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰åœ°å–ä¸¤è€…çš„äº¤é›†ä¸å¹¶é›†æµ‹åº¦çš„æ¯”ä¾‹ï¼Œå®ƒçš„å®šä¹‰è®°ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆæœ‰å…±åŒçš„å¯¼æ¼”ã€ç”µå½±ç±»å‹ã€æ¼”å‘˜ï¼‰ï¼Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œè€Œæµ‹åº¦å°±ç›´æ¥ç”¨æ•°é‡è¡¨ç¤ºã€‚ 1.2.2.2 CBF æ–¹æ³•åœ¨ NebulaGraph ä¸­çš„å®ç°CBF æ–¹æ³•åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š æ‰¾å‡ºæ¨èç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½± ä»ç”¨æˆ·è¯„åˆ†è¿‡çš„ç”µå½±ï¼Œç»ç”±å¯¼æ¼”å¡å¸ã€ç”µå½±ç±»å‹æ‰¾åˆ°æ–°çš„å¾…æ¨èç”µå½± å¯¹çœ‹è¿‡çš„ç”µå½±ä¸æ–°çš„ç”µå½±ï¼Œè—‰ç”±å¯¼æ¼”ã€å¡å¸ã€ç”µå½±ç±»å‹çš„å…³ç³»ï¼Œåœ¨å›¾ä¸Šåš Jaccard ç›¸ä¼¼æ€§è¿ç®—ï¼Œå¾—å‡ºæ¯ä¸€å¯¹çœ‹è¿‡çš„ç”µå½±å’Œå¾…æ¨èæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•° æŠŠç”¨æˆ·å¯¹çœ‹è¿‡ç”µå½±çš„è¯„åˆ†ä½œä¸ºåŠ æƒç³»æ•°ï¼Œé’ˆå¯¹å…¶åˆ°æ¯ä¸€ä¸ªæ–°ç”µå½±ä¹‹é—´çš„ Jaccard ç³»æ•°åŠ æƒè¯„åˆ†ï¼Œè·å¾—æ’åºåçš„æ¨èç”µå½±åˆ—è¡¨ // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH (u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_124\" WITH collect(id(m)) AS watched_movies_id // æ ¹æ®ç”µå½±çš„æ ‡æ³¨å…³ç³»æ‰¾åˆ°å¤‡é€‰æ¨èç”µå½±ï¼Œåˆ¨é™¤çœ‹è¿‡çš„ï¼ŒæŠŠè¯„åˆ†ã€äº¤é›†å…³è”é“¾è·¯çš„æ•°é‡ä¼ ä¸‹å» MATCH (u:`user`)-[e:watched]-\u003e(m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection)\u003c-[:directed_by|acted_by|with_genre]-(recomm:`movie`) WHERE id(u) == \"u_124\" AND NOT id(recomm) IN watched_movies_id WITH (e.rate - 2.5)/2.5 AS rate, m, recomm, size(COLLECT(intersection)) AS intersection_size ORDER BY intersection_size DESC LIMIT 50 // è®¡ç®— Jaccard index------------------------------------------------- // é’ˆå¯¹æ¯ä¸€å¯¹ m å’Œ recommï¼š // å¼€å§‹è®¡ç®—çœ‹è¿‡çš„ç”µå½±ï¼Œé›†åˆ a çš„éƒ¨åˆ† MATCH (m:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, id(m) AS m_id, recomm, intersection_size, COLLECT(id(intersection)) AS set_a // è®¡ç®—æ¨èç”µå½±ï¼Œé›†åˆ b çš„éƒ¨åˆ† MATCH (recomm:`movie`)-[:directed_by|acted_by|with_genre]-\u003e(intersection) WITH rate, m_id, id(recomm) AS recomm_id, set_a, intersection_size, COLLECT(id(intersection)) AS set_b // å¾—åˆ°å¹¶é›†æ•°é‡ WITH rate, m_id, recomm_id, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B // å¾—åˆ°æ¯ä¸€å¯¹ m å’Œ recomm çš„ Jaccard index = A_N_B/A_U_B WITH rate, m_id, recomm_id, intersection_size/size(A_U_B) AS jaccard_index // è®¡ç®— Jaccard index------------------------------------------------- // å¾—åˆ°æ¯ä¸€ä¸ªè¢«æ¨èçš„ç”µå½± recomm_idï¼Œç»ç”±ä¸åŒçœ‹è¿‡ç”µå½±æ¨èé“¾è·¯çš„ç›¸ä¼¼åº¦ = è¯„åˆ† * jaccard_index WITH recomm_id, m_id, (rate * jaccard_index) AS score // å¯¹æ¯ä¸€ä¸ª recomm_id æŒ‰ç…§ m_id åŠ æƒæ±‚å¾—ç›¸ä¼¼åº¦çš„å’Œï¼Œä¸ºæ€»çš„æ¨èç¨‹åº¦è¯„åˆ†ï¼Œé™åºæ’åˆ— WITH recomm_id, sum(score) AS sim_score ORDER BY sim_score DESC WHERE sim_score \u003e 0 RETURN recomm_id, sim_score LIMIT 50 ä¸Šè¾¹æŸ¥è¯¢çš„æ‰§è¡Œç»“æœæˆªå–å‡ºæ¥æ˜¯ï¼š recomm_id sim_score 1891 0.2705882352941177 1892 0.22278481012658227 1894 0.15555555555555556 808 0.144 1895 0.13999999999999999 85 0.12631578947368421 348 0.12413793103448277 18746 0.11666666666666668 628 0.11636363636363636 3005 0.10566037735849057 1.2.2.3 å¯è§†åŒ–åˆ†ææˆ‘ä»¬æŠŠæ•´ä¸ªè¿‡ç¨‹ä¸­çš„ä¸€äº›æ­¥éª¤çš„æŸ¥è¯¢ä¿®æ”¹ä¸€ä¸‹ä¸º p=xxx çš„æ–¹å¼ï¼Œå¹¶æ¸²æŸ“å‡ºæ¥ï¼Œä¼šæ›´åŠ æ–¹ä¾¿ç†è§£ ç”¨æˆ· u_124 çœ‹è¿‡çš„ã€è¯„åˆ†è¿‡çš„ç”µå½± // ç”¨æˆ· u_124 çœ‹è¿‡çš„ç”µå½± MATCH p=(u:`user`)-[:watched]-\u003e(m:`movie`) WHERE id(u) == \"u_1","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:2","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#gnn--å›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ"},{"categories":["Nebula Graph"],"content":" 1.3 æ¨èç³»ç»Ÿå¯è§£é‡Šæ€§åœ¨ç»“æŸæœ¬ç« ä¹‹å‰ï¼Œå†ä¸¾ä¸€ä¸ªå›¾æ•°æ®åº“åœ¨æ¨èç³»ç»Ÿä¸­çš„å…¸å‹åº”ç”¨ï¼šæ¨èç†ç”±ã€‚ ä¸‹å›¾æ˜¯ç¾å›¢ã€å¤§ä¼—ç‚¹è¯„ä¸­çš„ä¸€ä¸ªå¸¸è§çš„æœç´¢ã€æ¨èç»“æœï¼Œç°ä»£æ¨èç³»ç»Ÿçš„å¤æ‚åº¦æ˜¯éå¸¸å¤§çš„ï¼Œä¸€æ–¹é¢ç”±å¾ˆå¤šæ–¹æ³•è‡ªèº«çš„ç‰¹æ€§å†³å®šï¼Œå¦ä¸€æ–¹é¢æœ€ç»ˆçš„æ¨èå¯èƒ½æ˜¯å¤šä¸ªç³»ç»ŸååŒè·å¾—æœ€ç»ˆç»“æœæ’åï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¾ˆéš¾å¯¹æ¨èç»“æœè¿›è¡Œè§£é‡Šã€‚ å¾—ç›Šäºè¢«æ¨èç”¨æˆ·å’Œç‰©ä»¶ã€ä»¥åŠä»–ä»¬çš„å„ç§å„æ ·ç”»åƒæœ€ç»ˆå½¢æˆçš„çŸ¥è¯†å›¾è°±ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å›¾è°±ä¸­å¯¹æ¨èç»“æœè¿›è¡Œâ€œè·¯å¾„æŸ¥æ‰¾â€å°±å¯ä»¥è·å¾—å¾ˆæœ‰æ„ä¹‰çš„è§£é‡Šï¼Œåƒæ˜¯å¦‚ä¸‹æˆªå›¾çš„â€œåœ¨åŒ—äº¬å–œæ¬¢åŒ—äº¬èœçš„å±±ä¸œè€ä¹¡éƒ½è¯´è¿™å®¶åº—å¾ˆèµâ€å°±æ˜¯è¿™æ ·è·å¾—çš„è§£é‡Šã€‚ å›¾ç‰‡æ¥æºï¼šhttps://tech.meituan.com/2021/04/01/nebula-graph-practice-in-meituan.html 1.3.1 å¯è§£é‡Šæ€§çš„ä¾‹å­å’±ä»¬å›åˆ°ç”µå½±æ¨èçš„å›¾è°±ä¸Šï¼Œæˆ‘ä»¬åœ¨å‰è¾¹çš„ç®—æ³•ä¸­æ›¾ç»è·å¾—è¿‡ç”¨æˆ· u_124 çš„æ¨èç”µå½± 1891ï¼ˆæ˜Ÿçƒå¤§æˆ˜ï¼šï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸€ä¸ªæŸ¥è¯¢è·å¾—å®ƒçš„æ¨èè§£é‡Šï¼š FIND NOLOOP PATH FROM \"u_124\" TO \"1891\" over * BIDIRECT UPTO 4 STEPS yield path as `p` | LIMIT 20 æˆ‘ä»¬å¯ä»¥å¾ˆå¿«è·å¾— 20 æ¡è·¯å¾„ï¼š (root@nebula) [moviegraph]\u003e FIND NOLOOP PATH FROM \"u_124\" TO \"1891\" over * BIDIRECT UPTO 4 STEPS yield path as `p` | LIMIT 20 +-----------------------------------------------------------------------------------------------------+ | p | +-----------------------------------------------------------------------------------------------------+ | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_49\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_17\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_10281\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_4\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_3\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_24342\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_2\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"832\")-[:with_genre@0 {}]-\u003e(\"g_1110\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_1110\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_13463\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_12248\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"47981\")-[:with_genre@0 {}]-\u003e(\"g_10219\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_6\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"497\")-[:with_genre@0 {}]-\u003e(\"g_104\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"120880\")-[:with_genre@0 {}]-\u003e(\"g_104\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_104\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_130\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"497\")-[:with_genre@0 {}]-\u003e(\"g_50\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11635\")-[:with_genre@0 {}]-\u003e(\"g_50\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_50\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | +-----------------------------------------------------------------------------------------------------+ Got 20 rows (time spent 267151/278139 us) Wed, 09 Nov 2022 19:05:56 CST æˆ‘ä»¬åœ¨ç»“æœå¯è§†åŒ–ä¸­å¯ä»¥å¾ˆå®¹æ˜“çœ‹å‡ºè¿™ä¸ªæ¨èçš„ç»“æœå¯ä»¥æ˜¯ï¼š æ›¾ç»å–œæ¬¢çš„æ˜Ÿæˆ˜ç”µå½±çš„å¤§éƒ¨åˆ†æ¼”èŒäººå‘˜éƒ½ä¹Ÿå‚ä¸äº†è¿™éƒ¨å’ŒåŒæ ·æ˜¯â€œå¥¥æ–¯å¡è·å¥–â€ä¸”â€œç»å…¸â€çš„ç”µå½±ã€‚ ","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:3","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#æ¨èç³»ç»Ÿå¯è§£é‡Šæ€§"},{"categories":["Nebula Graph"],"content":" 1.3 æ¨èç³»ç»Ÿå¯è§£é‡Šæ€§åœ¨ç»“æŸæœ¬ç« ä¹‹å‰ï¼Œå†ä¸¾ä¸€ä¸ªå›¾æ•°æ®åº“åœ¨æ¨èç³»ç»Ÿä¸­çš„å…¸å‹åº”ç”¨ï¼šæ¨èç†ç”±ã€‚ ä¸‹å›¾æ˜¯ç¾å›¢ã€å¤§ä¼—ç‚¹è¯„ä¸­çš„ä¸€ä¸ªå¸¸è§çš„æœç´¢ã€æ¨èç»“æœï¼Œç°ä»£æ¨èç³»ç»Ÿçš„å¤æ‚åº¦æ˜¯éå¸¸å¤§çš„ï¼Œä¸€æ–¹é¢ç”±å¾ˆå¤šæ–¹æ³•è‡ªèº«çš„ç‰¹æ€§å†³å®šï¼Œå¦ä¸€æ–¹é¢æœ€ç»ˆçš„æ¨èå¯èƒ½æ˜¯å¤šä¸ªç³»ç»ŸååŒè·å¾—æœ€ç»ˆç»“æœæ’åï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¾ˆéš¾å¯¹æ¨èç»“æœè¿›è¡Œè§£é‡Šã€‚ å¾—ç›Šäºè¢«æ¨èç”¨æˆ·å’Œç‰©ä»¶ã€ä»¥åŠä»–ä»¬çš„å„ç§å„æ ·ç”»åƒæœ€ç»ˆå½¢æˆçš„çŸ¥è¯†å›¾è°±ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å›¾è°±ä¸­å¯¹æ¨èç»“æœè¿›è¡Œâ€œè·¯å¾„æŸ¥æ‰¾â€å°±å¯ä»¥è·å¾—å¾ˆæœ‰æ„ä¹‰çš„è§£é‡Šï¼Œåƒæ˜¯å¦‚ä¸‹æˆªå›¾çš„â€œåœ¨åŒ—äº¬å–œæ¬¢åŒ—äº¬èœçš„å±±ä¸œè€ä¹¡éƒ½è¯´è¿™å®¶åº—å¾ˆèµâ€å°±æ˜¯è¿™æ ·è·å¾—çš„è§£é‡Šã€‚ å›¾ç‰‡æ¥æºï¼šhttps://tech.meituan.com/2021/04/01/nebula-graph-practice-in-meituan.html 1.3.1 å¯è§£é‡Šæ€§çš„ä¾‹å­å’±ä»¬å›åˆ°ç”µå½±æ¨èçš„å›¾è°±ä¸Šï¼Œæˆ‘ä»¬åœ¨å‰è¾¹çš„ç®—æ³•ä¸­æ›¾ç»è·å¾—è¿‡ç”¨æˆ· u_124 çš„æ¨èç”µå½± 1891ï¼ˆæ˜Ÿçƒå¤§æˆ˜ï¼šï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸€ä¸ªæŸ¥è¯¢è·å¾—å®ƒçš„æ¨èè§£é‡Šï¼š FIND NOLOOP PATH FROM \"u_124\" TO \"1891\" over * BIDIRECT UPTO 4 STEPS yield path as `p` | LIMIT 20 æˆ‘ä»¬å¯ä»¥å¾ˆå¿«è·å¾— 20 æ¡è·¯å¾„ï¼š (root@nebula) [moviegraph]\u003e FIND NOLOOP PATH FROM \"u_124\" TO \"1891\" over * BIDIRECT UPTO 4 STEPS yield path as `p` | LIMIT 20 +-----------------------------------------------------------------------------------------------------+ | p | +-----------------------------------------------------------------------------------------------------+ | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_49\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_17\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_10281\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_4\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_3\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_24342\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_2\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"832\")-[:with_genre@0 {}]-\u003e(\"g_1110\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_1110\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_13463\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_12248\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"47981\")-[:with_genre@0 {}]-\u003e(\"g_10219\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_6\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"497\")-[:with_genre@0 {}]-\u003e(\"g_104\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"120880\")-[:with_genre@0 {}]-\u003e(\"g_104\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_104\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:acted_by@0 {}]-\u003e(\"p_130\")\u003c-[:acted_by@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"497\")-[:with_genre@0 {}]-\u003e(\"g_50\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11635\")-[:with_genre@0 {}]-\u003e(\"g_50\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | | \u003c(\"u_124\")-[:watched@0 {}]-\u003e(\"11\")-[:with_genre@0 {}]-\u003e(\"g_50\")\u003c-[:with_genre@0 {}]-(\"1891\")\u003e | +-----------------------------------------------------------------------------------------------------+ Got 20 rows (time spent 267151/278139 us) Wed, 09 Nov 2022 19:05:56 CST æˆ‘ä»¬åœ¨ç»“æœå¯è§†åŒ–ä¸­å¯ä»¥å¾ˆå®¹æ˜“çœ‹å‡ºè¿™ä¸ªæ¨èçš„ç»“æœå¯ä»¥æ˜¯ï¼š æ›¾ç»å–œæ¬¢çš„æ˜Ÿæˆ˜ç”µå½±çš„å¤§éƒ¨åˆ†æ¼”èŒäººå‘˜éƒ½ä¹Ÿå‚ä¸äº†è¿™éƒ¨å’ŒåŒæ ·æ˜¯â€œå¥¥æ–¯å¡è·å¥–â€ä¸”â€œç»å…¸â€çš„ç”µå½±ã€‚ ","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:3","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#å¯è§£é‡Šæ€§çš„ä¾‹å­"},{"categories":["Nebula Graph"],"content":" 1.4 æ€»ç»“ç°åœ¨ï¼Œæˆ‘ä»¬çŸ¥é“å›¾æ•°æ®åº“ä½œä¸ºæ¨èç³»ç»Ÿä¸­ä¿¡æ¯çš„æœ€ç»ˆå½¢å¼ï¼šçŸ¥è¯†å­˜åœ¨ï¼Œå¯ä»¥é€‚ç”¨åœ¨ä¸åŒç±»å‹æ–¹æ³•ä¸Šï¼Œå°½ç®¡å¾ˆå¤šæ–¹æ³•ä¸­ï¼Œå›¾åº“ä¸ä¸€å®šæ˜¯æœ€ç»ˆè½åœ°ç³»ç»Ÿæ–¹æ¡ˆçš„æœ€æµè¡Œé€‰æ‹©ï¼Œå›¾æ•°æ®åº“æ‰€å¸¦æ¥çš„å¯è§†åŒ–æ´å¯Ÿçš„æ½œåŠ›è¿˜æ˜¯éå¸¸å¤§çš„ã€‚ åŒæ—¶ï¼Œæ„å»ºçš„ç»¼åˆçŸ¥è¯†å›¾è°±ä¸Šçš„è§£é‡Šã€æ¨ç†èƒ½åŠ›ä¸ä¸€äº›å®æ—¶è¦æ±‚é«˜çš„å›¾æ–¹æ³•ä¸­ï¼ˆæ¯”å¦‚ GNNçš„åŸºäºæ¨¡å‹æ–¹æ³•ï¼‰ï¼Œèƒ½èµ·åˆ°å¸¦æ¥ç‹¬ä¸€æ— äºŒçš„ä½œç”¨ã€‚ é¢˜å›¾ç‰ˆæƒï¼šcharlesdeluvio ","date":"2022-10-25","objectID":"/recommendation-system-with-graphdb/:1:4","series":null,"tags":["Nebula Graph","Recommendation system","GNN","æ¨èç³»ç»Ÿ","DGL"],"title":"åŸºäºå›¾æ•°æ®åº“çš„æ¨èç³»ç»Ÿ","uri":"/recommendation-system-with-graphdb/#æ€»ç»“"},{"categories":["Nebula Graph"],"content":"æœ¬æ–‡æ˜¯ä¸€ä¸ªå¿«é€Ÿäº†è§£ä¸º NebulaGraph å†…æ ¸è´¡çŒ®ä»£ç ã€æ„å»ºã€Debug çš„ä¸€ç«™å¼æŒ‡å—ã€‚","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/"},{"categories":["Nebula Graph"],"content":" å¦‚ä½• build NebulaGraphï¼Ÿå¦‚ä½•ä¸º NebulaGraph å†…æ ¸åšè´¡çŒ®ï¼Ÿä»æœ¬ç« ä½œä¸ºåˆ‡å…¥ç‚¹å°±å¤Ÿäº†ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:0:0","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#"},{"categories":["Nebula Graph"],"content":" 1 NebulaGraph çš„æ¶æ„ç®€ä»‹ä¸ºäº†æ–¹ä¾¿å¯¹ NebulaGraph å°šæœªäº†è§£çš„è¯»è€…ä¹Ÿèƒ½å¿«é€Ÿç›´æ¥ä»è´¡çŒ®ä»£ç ä¸ºèµ·ç‚¹äº†è§£å®ƒï¼Œæˆ‘æŠŠå¼€å‘ã€è´¡çŒ®å†…æ ¸ä»£ç å…¥æ‰‹æ‰€éœ€è¦çš„åŸºæœ¬æ¶æ„çŸ¥è¯†ä¹Ÿåœ¨è¿™é‡Œä»¥æœ€å°ä¿¡æ¯é‡çš„å½¢å¼æ€»ç»“ä¸€ä¸‹ï¼Œä½œä¸ºå‰å¯¼çŸ¥è¯†ï¼Œè¯·èµ„æ·±çš„ NebulaGraph ç©å®¶ç›´æ¥è·³è¿‡è¿™ä¸€ç« èŠ‚ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:1:0","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#nebulagraph-çš„æ¶æ„ç®€ä»‹"},{"categories":["Nebula Graph"],"content":" 1.1 æœåŠ¡ã€è¿›ç¨‹NebulaGraph çš„æ¶æ„å’Œ Google Spannerï¼ŒTiDB å¾ˆç›¸ä¼¼ï¼Œæ ¸å¿ƒéƒ¨åˆ†åªæœ‰ä¸‰ç§æœåŠ¡ã€è¿›ç¨‹ï¼šGraph æœåŠ¡ã€Meta æœåŠ¡å’Œ Storage æœåŠ¡ã€‚å®ƒä»¬ä¹‹é—´å½¼æ­¤é€šè¿‡ TCP ä¹‹ä¸Šçš„ Thrift RPC åè®®è¿›è¡Œé€šä¿¡ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:1:1","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#æœåŠ¡è¿›ç¨‹"},{"categories":["Nebula Graph"],"content":" 1.2 è®¡ç®—å±‚ä¸å­˜å‚¨å±‚NebulaGraph æ˜¯å­˜å‚¨ä¸è®¡ç®—åˆ†ç¦»çš„æ¶æ„ï¼Œå®ƒçš„ Meta æœåŠ¡å’Œ Storage æœåŠ¡å…±åŒç»„æˆäº†å­˜å‚¨å±‚ï¼ŒGraph æœåŠ¡æ˜¯å†…æ ¸æä¾›çš„è®¡ç®—å±‚ã€‚ è¿™æ ·çš„è®¾è®¡ä½¿å¾— NebulaGraph çš„é›†ç¾¤éƒ¨ç½²å¯ä»¥çµæ´»æŒ‰éœ€åˆ†é…è®¡ç®—ã€å­˜å‚¨çš„èµ„æºï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ä¸ºåŒä¸€ä¸ªé›†ç¾¤ä¸­åˆ›å»ºä¸åŒé…ç½®çš„ä¸¤ç»„ Graph æœåŠ¡å®ä¾‹ã€ç”¨æ¥é¢å‘ä¸åŒç±»å‹çš„ä¸šåŠ¡ã€‚ åŒæ—¶ï¼Œè®¡ç®—å±‚è§£è€¦äºå­˜å‚¨å±‚ä½¿å¾—åœ¨ NebulaGraph ä¹‹ä¸Šçš„æ„å»ºä¸åŒçš„ç‰¹å®šè®¡ç®—å±‚æˆä¸ºå¯èƒ½ï¼Œæ¯”å¦‚ NebulaGraph Algorithmã€NebulaGraph Analytics å°±æ˜¯åœ¨ NebulaGraph ä¹‹ä¸Šæ„å»ºäº†å¼‚æ„çš„å¦ä¸€ä¸ªè®¡ç®—å±‚ï¼Œå¦‚æœéœ€è¦ï¼Œä»»ä½•äººä¹Ÿå¯ä»¥å®šåˆ¶è‡ªå·±çš„ä¸“å±è®¡ç®—å±‚ï¼Œä»è€Œæ»¡è¶³ç»Ÿä¸€å›¾åŸºç¡€å­˜å‚¨ä¹‹ä¸Šçš„å¤åˆã€å¤šæ ·çš„è®¡ç®—éœ€æ±‚ã€‚ 1.2.1 Graph Service: nebula-graphdGraph æœåŠ¡æ˜¯å¯¹å¤–æ¥å—å›¾åº“ç™»å½•ã€å›¾æŸ¥è¯¢è¯·æ±‚ã€é›†ç¾¤ç®¡ç†æ“ä½œã€schema å®šä¹‰æ‰€ç›´æ¥è¿æ¥çš„æœåŠ¡ï¼Œä»–çš„è¿›ç¨‹åå­—å« graphdï¼Œè¡¨ç¤º nebula graph daemonã€‚ Graph æœåŠ¡çš„æ¯ä¸€ä¸ªè¿›ç¨‹æ˜¯æ— çŠ¶æ€çš„ï¼Œè¿™ä½¿å¾—æ¨ªå‘æ‰©ç¼© Graph æœåŠ¡çš„å®ä¾‹éå¸¸çµæ´»ã€ç®€å•ã€‚ Graph æœåŠ¡ä¹Ÿå« Query Engineï¼Œå…¶å†…éƒ¨å’Œä¼ ç»Ÿçš„æ•°æ®åº“ç³»ç»Ÿçš„è®¾è®¡éå¸¸ç›¸ä¼¼ï¼Œåˆ†ä¸ºï¼šè§£æã€æ ¡éªŒã€è®¡åˆ’ã€æ‰§è¡Œå‡ éƒ¨åˆ†ã€‚ 1.2.2 Meta Service: nebula-metadMeta æœåŠ¡é¡¾åæ€ä¹‰è´Ÿè´£å…ƒæ•°æ®ç®¡ç†ï¼Œè¿›ç¨‹åå­—å« metadã€‚è¿™äº›å…ƒæ•°æ®åŒ…æ‹¬ï¼š æ‰€æœ‰çš„å›¾ç©ºé—´ã€Schema å®šä¹‰ ç”¨æˆ·é‰´æƒã€æˆæƒä¿¡æ¯ é›†ç¾¤æœåŠ¡çš„å‘ç°ä¸æœåŠ¡çš„åˆ†å¸ƒ å›¾ç©ºé—´ä¸­çš„æ•°æ®åˆ†å¸ƒ Meta æœåŠ¡çš„è¿›ç¨‹å¯ä»¥å•å®ä¾‹éƒ¨ç½²ï¼Œåœ¨éå•æœºéƒ¨ç½²çš„åœºæ™¯ä¸‹ï¼Œä¸ºäº†æ•°æ®ã€æœåŠ¡çš„é«˜ SLA ï¼Œæˆ‘ä»¬å¯ä»¥å¥‡æ•°å¤šä¸ªå®ä¾‹çš„éƒ¨ç½²ï¼Œé€šå¸¸æ¥è¯´ 3 ä¸ª nebula-metad å°±è¶³å¤Ÿäº†ï¼Œä¸‰ä¸ª nebula-metad é€šè¿‡ RAFT å…±è¯†åè®®æ„æˆä¸€ä¸ªé›†ç¾¤æä¾›æœåŠ¡ã€‚ 1.2.3 Storage Service: nebula-storagedStorage æœåŠ¡å­˜å‚¨æ‰€æœ‰çš„å›¾æ•°æ®ï¼Œè¿›ç¨‹åå­—å« storagedã€‚storaged åˆ†å¸ƒå¼åœ°å­˜å‚¨å›¾æ•°æ®ï¼Œä¸º Graph å†…éƒ¨çš„å›¾æŸ¥è¯¢æ‰§è¡ŒæœŸæä¾›åº•å±‚çš„å›¾è¯­ä¹‰å­˜å‚¨æ¥å£ï¼Œæ–¹ä¾¿ Storage å®¢æˆ·ç«¯é€šè¿‡ Thrift RPC åè®®é¢å‘æ¶‰åŠçš„ storaged ç¤ºä¾‹è¿›è¡Œå›¾è¯­ä¹‰çš„è¯»å†™ã€‚ å½“ NebulaGraph ä¸­å›¾ç©ºé—´çš„å‰¯æœ¬æ•°å¤§äº 1 çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªåˆ†åŒºéƒ½ä¼šåœ¨ä¸åŒ storaged ç¤ºä¾‹ä¸Šæœ‰å‰¯æœ¬ï¼Œå‰¯æœ¬ä¹‹é—´åˆ™é€šè¿‡ RAFT åè®®åè°ƒåŒæ­¥ä¸è¯»å†™ã€‚ å‚è€ƒ æ–‡æ¡£ï¼šæ¶æ„ä»‹ç»ï¼Œäº†è§£æ›´å¤šè¯¦æƒ…ï¼› æ¨èé˜…è¯»ç¤¾åŒºå®˜æ–¹æ’­å®¢çš„æ¶æ„ç³»åˆ—æ–‡ç« ï¼šnebula-graph.com.cn/tags/æ¶æ„ç³»åˆ—ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:1:2","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#è®¡ç®—å±‚ä¸å­˜å‚¨å±‚"},{"categories":["Nebula Graph"],"content":" 1.2 è®¡ç®—å±‚ä¸å­˜å‚¨å±‚NebulaGraph æ˜¯å­˜å‚¨ä¸è®¡ç®—åˆ†ç¦»çš„æ¶æ„ï¼Œå®ƒçš„ Meta æœåŠ¡å’Œ Storage æœåŠ¡å…±åŒç»„æˆäº†å­˜å‚¨å±‚ï¼ŒGraph æœåŠ¡æ˜¯å†…æ ¸æä¾›çš„è®¡ç®—å±‚ã€‚ è¿™æ ·çš„è®¾è®¡ä½¿å¾— NebulaGraph çš„é›†ç¾¤éƒ¨ç½²å¯ä»¥çµæ´»æŒ‰éœ€åˆ†é…è®¡ç®—ã€å­˜å‚¨çš„èµ„æºï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ä¸ºåŒä¸€ä¸ªé›†ç¾¤ä¸­åˆ›å»ºä¸åŒé…ç½®çš„ä¸¤ç»„ Graph æœåŠ¡å®ä¾‹ã€ç”¨æ¥é¢å‘ä¸åŒç±»å‹çš„ä¸šåŠ¡ã€‚ åŒæ—¶ï¼Œè®¡ç®—å±‚è§£è€¦äºå­˜å‚¨å±‚ä½¿å¾—åœ¨ NebulaGraph ä¹‹ä¸Šçš„æ„å»ºä¸åŒçš„ç‰¹å®šè®¡ç®—å±‚æˆä¸ºå¯èƒ½ï¼Œæ¯”å¦‚ NebulaGraph Algorithmã€NebulaGraph Analytics å°±æ˜¯åœ¨ NebulaGraph ä¹‹ä¸Šæ„å»ºäº†å¼‚æ„çš„å¦ä¸€ä¸ªè®¡ç®—å±‚ï¼Œå¦‚æœéœ€è¦ï¼Œä»»ä½•äººä¹Ÿå¯ä»¥å®šåˆ¶è‡ªå·±çš„ä¸“å±è®¡ç®—å±‚ï¼Œä»è€Œæ»¡è¶³ç»Ÿä¸€å›¾åŸºç¡€å­˜å‚¨ä¹‹ä¸Šçš„å¤åˆã€å¤šæ ·çš„è®¡ç®—éœ€æ±‚ã€‚ 1.2.1 Graph Service: nebula-graphdGraph æœåŠ¡æ˜¯å¯¹å¤–æ¥å—å›¾åº“ç™»å½•ã€å›¾æŸ¥è¯¢è¯·æ±‚ã€é›†ç¾¤ç®¡ç†æ“ä½œã€schema å®šä¹‰æ‰€ç›´æ¥è¿æ¥çš„æœåŠ¡ï¼Œä»–çš„è¿›ç¨‹åå­—å« graphdï¼Œè¡¨ç¤º nebula graph daemonã€‚ Graph æœåŠ¡çš„æ¯ä¸€ä¸ªè¿›ç¨‹æ˜¯æ— çŠ¶æ€çš„ï¼Œè¿™ä½¿å¾—æ¨ªå‘æ‰©ç¼© Graph æœåŠ¡çš„å®ä¾‹éå¸¸çµæ´»ã€ç®€å•ã€‚ Graph æœåŠ¡ä¹Ÿå« Query Engineï¼Œå…¶å†…éƒ¨å’Œä¼ ç»Ÿçš„æ•°æ®åº“ç³»ç»Ÿçš„è®¾è®¡éå¸¸ç›¸ä¼¼ï¼Œåˆ†ä¸ºï¼šè§£æã€æ ¡éªŒã€è®¡åˆ’ã€æ‰§è¡Œå‡ éƒ¨åˆ†ã€‚ 1.2.2 Meta Service: nebula-metadMeta æœåŠ¡é¡¾åæ€ä¹‰è´Ÿè´£å…ƒæ•°æ®ç®¡ç†ï¼Œè¿›ç¨‹åå­—å« metadã€‚è¿™äº›å…ƒæ•°æ®åŒ…æ‹¬ï¼š æ‰€æœ‰çš„å›¾ç©ºé—´ã€Schema å®šä¹‰ ç”¨æˆ·é‰´æƒã€æˆæƒä¿¡æ¯ é›†ç¾¤æœåŠ¡çš„å‘ç°ä¸æœåŠ¡çš„åˆ†å¸ƒ å›¾ç©ºé—´ä¸­çš„æ•°æ®åˆ†å¸ƒ Meta æœåŠ¡çš„è¿›ç¨‹å¯ä»¥å•å®ä¾‹éƒ¨ç½²ï¼Œåœ¨éå•æœºéƒ¨ç½²çš„åœºæ™¯ä¸‹ï¼Œä¸ºäº†æ•°æ®ã€æœåŠ¡çš„é«˜ SLA ï¼Œæˆ‘ä»¬å¯ä»¥å¥‡æ•°å¤šä¸ªå®ä¾‹çš„éƒ¨ç½²ï¼Œé€šå¸¸æ¥è¯´ 3 ä¸ª nebula-metad å°±è¶³å¤Ÿäº†ï¼Œä¸‰ä¸ª nebula-metad é€šè¿‡ RAFT å…±è¯†åè®®æ„æˆä¸€ä¸ªé›†ç¾¤æä¾›æœåŠ¡ã€‚ 1.2.3 Storage Service: nebula-storagedStorage æœåŠ¡å­˜å‚¨æ‰€æœ‰çš„å›¾æ•°æ®ï¼Œè¿›ç¨‹åå­—å« storagedã€‚storaged åˆ†å¸ƒå¼åœ°å­˜å‚¨å›¾æ•°æ®ï¼Œä¸º Graph å†…éƒ¨çš„å›¾æŸ¥è¯¢æ‰§è¡ŒæœŸæä¾›åº•å±‚çš„å›¾è¯­ä¹‰å­˜å‚¨æ¥å£ï¼Œæ–¹ä¾¿ Storage å®¢æˆ·ç«¯é€šè¿‡ Thrift RPC åè®®é¢å‘æ¶‰åŠçš„ storaged ç¤ºä¾‹è¿›è¡Œå›¾è¯­ä¹‰çš„è¯»å†™ã€‚ å½“ NebulaGraph ä¸­å›¾ç©ºé—´çš„å‰¯æœ¬æ•°å¤§äº 1 çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªåˆ†åŒºéƒ½ä¼šåœ¨ä¸åŒ storaged ç¤ºä¾‹ä¸Šæœ‰å‰¯æœ¬ï¼Œå‰¯æœ¬ä¹‹é—´åˆ™é€šè¿‡ RAFT åè®®åè°ƒåŒæ­¥ä¸è¯»å†™ã€‚ å‚è€ƒ æ–‡æ¡£ï¼šæ¶æ„ä»‹ç»ï¼Œäº†è§£æ›´å¤šè¯¦æƒ…ï¼› æ¨èé˜…è¯»ç¤¾åŒºå®˜æ–¹æ’­å®¢çš„æ¶æ„ç³»åˆ—æ–‡ç« ï¼šnebula-graph.com.cn/tags/æ¶æ„ç³»åˆ—ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:1:2","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#graph-service-nebula-graphd"},{"categories":["Nebula Graph"],"content":" 1.2 è®¡ç®—å±‚ä¸å­˜å‚¨å±‚NebulaGraph æ˜¯å­˜å‚¨ä¸è®¡ç®—åˆ†ç¦»çš„æ¶æ„ï¼Œå®ƒçš„ Meta æœåŠ¡å’Œ Storage æœåŠ¡å…±åŒç»„æˆäº†å­˜å‚¨å±‚ï¼ŒGraph æœåŠ¡æ˜¯å†…æ ¸æä¾›çš„è®¡ç®—å±‚ã€‚ è¿™æ ·çš„è®¾è®¡ä½¿å¾— NebulaGraph çš„é›†ç¾¤éƒ¨ç½²å¯ä»¥çµæ´»æŒ‰éœ€åˆ†é…è®¡ç®—ã€å­˜å‚¨çš„èµ„æºï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ä¸ºåŒä¸€ä¸ªé›†ç¾¤ä¸­åˆ›å»ºä¸åŒé…ç½®çš„ä¸¤ç»„ Graph æœåŠ¡å®ä¾‹ã€ç”¨æ¥é¢å‘ä¸åŒç±»å‹çš„ä¸šåŠ¡ã€‚ åŒæ—¶ï¼Œè®¡ç®—å±‚è§£è€¦äºå­˜å‚¨å±‚ä½¿å¾—åœ¨ NebulaGraph ä¹‹ä¸Šçš„æ„å»ºä¸åŒçš„ç‰¹å®šè®¡ç®—å±‚æˆä¸ºå¯èƒ½ï¼Œæ¯”å¦‚ NebulaGraph Algorithmã€NebulaGraph Analytics å°±æ˜¯åœ¨ NebulaGraph ä¹‹ä¸Šæ„å»ºäº†å¼‚æ„çš„å¦ä¸€ä¸ªè®¡ç®—å±‚ï¼Œå¦‚æœéœ€è¦ï¼Œä»»ä½•äººä¹Ÿå¯ä»¥å®šåˆ¶è‡ªå·±çš„ä¸“å±è®¡ç®—å±‚ï¼Œä»è€Œæ»¡è¶³ç»Ÿä¸€å›¾åŸºç¡€å­˜å‚¨ä¹‹ä¸Šçš„å¤åˆã€å¤šæ ·çš„è®¡ç®—éœ€æ±‚ã€‚ 1.2.1 Graph Service: nebula-graphdGraph æœåŠ¡æ˜¯å¯¹å¤–æ¥å—å›¾åº“ç™»å½•ã€å›¾æŸ¥è¯¢è¯·æ±‚ã€é›†ç¾¤ç®¡ç†æ“ä½œã€schema å®šä¹‰æ‰€ç›´æ¥è¿æ¥çš„æœåŠ¡ï¼Œä»–çš„è¿›ç¨‹åå­—å« graphdï¼Œè¡¨ç¤º nebula graph daemonã€‚ Graph æœåŠ¡çš„æ¯ä¸€ä¸ªè¿›ç¨‹æ˜¯æ— çŠ¶æ€çš„ï¼Œè¿™ä½¿å¾—æ¨ªå‘æ‰©ç¼© Graph æœåŠ¡çš„å®ä¾‹éå¸¸çµæ´»ã€ç®€å•ã€‚ Graph æœåŠ¡ä¹Ÿå« Query Engineï¼Œå…¶å†…éƒ¨å’Œä¼ ç»Ÿçš„æ•°æ®åº“ç³»ç»Ÿçš„è®¾è®¡éå¸¸ç›¸ä¼¼ï¼Œåˆ†ä¸ºï¼šè§£æã€æ ¡éªŒã€è®¡åˆ’ã€æ‰§è¡Œå‡ éƒ¨åˆ†ã€‚ 1.2.2 Meta Service: nebula-metadMeta æœåŠ¡é¡¾åæ€ä¹‰è´Ÿè´£å…ƒæ•°æ®ç®¡ç†ï¼Œè¿›ç¨‹åå­—å« metadã€‚è¿™äº›å…ƒæ•°æ®åŒ…æ‹¬ï¼š æ‰€æœ‰çš„å›¾ç©ºé—´ã€Schema å®šä¹‰ ç”¨æˆ·é‰´æƒã€æˆæƒä¿¡æ¯ é›†ç¾¤æœåŠ¡çš„å‘ç°ä¸æœåŠ¡çš„åˆ†å¸ƒ å›¾ç©ºé—´ä¸­çš„æ•°æ®åˆ†å¸ƒ Meta æœåŠ¡çš„è¿›ç¨‹å¯ä»¥å•å®ä¾‹éƒ¨ç½²ï¼Œåœ¨éå•æœºéƒ¨ç½²çš„åœºæ™¯ä¸‹ï¼Œä¸ºäº†æ•°æ®ã€æœåŠ¡çš„é«˜ SLA ï¼Œæˆ‘ä»¬å¯ä»¥å¥‡æ•°å¤šä¸ªå®ä¾‹çš„éƒ¨ç½²ï¼Œé€šå¸¸æ¥è¯´ 3 ä¸ª nebula-metad å°±è¶³å¤Ÿäº†ï¼Œä¸‰ä¸ª nebula-metad é€šè¿‡ RAFT å…±è¯†åè®®æ„æˆä¸€ä¸ªé›†ç¾¤æä¾›æœåŠ¡ã€‚ 1.2.3 Storage Service: nebula-storagedStorage æœåŠ¡å­˜å‚¨æ‰€æœ‰çš„å›¾æ•°æ®ï¼Œè¿›ç¨‹åå­—å« storagedã€‚storaged åˆ†å¸ƒå¼åœ°å­˜å‚¨å›¾æ•°æ®ï¼Œä¸º Graph å†…éƒ¨çš„å›¾æŸ¥è¯¢æ‰§è¡ŒæœŸæä¾›åº•å±‚çš„å›¾è¯­ä¹‰å­˜å‚¨æ¥å£ï¼Œæ–¹ä¾¿ Storage å®¢æˆ·ç«¯é€šè¿‡ Thrift RPC åè®®é¢å‘æ¶‰åŠçš„ storaged ç¤ºä¾‹è¿›è¡Œå›¾è¯­ä¹‰çš„è¯»å†™ã€‚ å½“ NebulaGraph ä¸­å›¾ç©ºé—´çš„å‰¯æœ¬æ•°å¤§äº 1 çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªåˆ†åŒºéƒ½ä¼šåœ¨ä¸åŒ storaged ç¤ºä¾‹ä¸Šæœ‰å‰¯æœ¬ï¼Œå‰¯æœ¬ä¹‹é—´åˆ™é€šè¿‡ RAFT åè®®åè°ƒåŒæ­¥ä¸è¯»å†™ã€‚ å‚è€ƒ æ–‡æ¡£ï¼šæ¶æ„ä»‹ç»ï¼Œäº†è§£æ›´å¤šè¯¦æƒ…ï¼› æ¨èé˜…è¯»ç¤¾åŒºå®˜æ–¹æ’­å®¢çš„æ¶æ„ç³»åˆ—æ–‡ç« ï¼šnebula-graph.com.cn/tags/æ¶æ„ç³»åˆ—ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:1:2","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#meta-service-nebula-metad"},{"categories":["Nebula Graph"],"content":" 1.2 è®¡ç®—å±‚ä¸å­˜å‚¨å±‚NebulaGraph æ˜¯å­˜å‚¨ä¸è®¡ç®—åˆ†ç¦»çš„æ¶æ„ï¼Œå®ƒçš„ Meta æœåŠ¡å’Œ Storage æœåŠ¡å…±åŒç»„æˆäº†å­˜å‚¨å±‚ï¼ŒGraph æœåŠ¡æ˜¯å†…æ ¸æä¾›çš„è®¡ç®—å±‚ã€‚ è¿™æ ·çš„è®¾è®¡ä½¿å¾— NebulaGraph çš„é›†ç¾¤éƒ¨ç½²å¯ä»¥çµæ´»æŒ‰éœ€åˆ†é…è®¡ç®—ã€å­˜å‚¨çš„èµ„æºï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ä¸ºåŒä¸€ä¸ªé›†ç¾¤ä¸­åˆ›å»ºä¸åŒé…ç½®çš„ä¸¤ç»„ Graph æœåŠ¡å®ä¾‹ã€ç”¨æ¥é¢å‘ä¸åŒç±»å‹çš„ä¸šåŠ¡ã€‚ åŒæ—¶ï¼Œè®¡ç®—å±‚è§£è€¦äºå­˜å‚¨å±‚ä½¿å¾—åœ¨ NebulaGraph ä¹‹ä¸Šçš„æ„å»ºä¸åŒçš„ç‰¹å®šè®¡ç®—å±‚æˆä¸ºå¯èƒ½ï¼Œæ¯”å¦‚ NebulaGraph Algorithmã€NebulaGraph Analytics å°±æ˜¯åœ¨ NebulaGraph ä¹‹ä¸Šæ„å»ºäº†å¼‚æ„çš„å¦ä¸€ä¸ªè®¡ç®—å±‚ï¼Œå¦‚æœéœ€è¦ï¼Œä»»ä½•äººä¹Ÿå¯ä»¥å®šåˆ¶è‡ªå·±çš„ä¸“å±è®¡ç®—å±‚ï¼Œä»è€Œæ»¡è¶³ç»Ÿä¸€å›¾åŸºç¡€å­˜å‚¨ä¹‹ä¸Šçš„å¤åˆã€å¤šæ ·çš„è®¡ç®—éœ€æ±‚ã€‚ 1.2.1 Graph Service: nebula-graphdGraph æœåŠ¡æ˜¯å¯¹å¤–æ¥å—å›¾åº“ç™»å½•ã€å›¾æŸ¥è¯¢è¯·æ±‚ã€é›†ç¾¤ç®¡ç†æ“ä½œã€schema å®šä¹‰æ‰€ç›´æ¥è¿æ¥çš„æœåŠ¡ï¼Œä»–çš„è¿›ç¨‹åå­—å« graphdï¼Œè¡¨ç¤º nebula graph daemonã€‚ Graph æœåŠ¡çš„æ¯ä¸€ä¸ªè¿›ç¨‹æ˜¯æ— çŠ¶æ€çš„ï¼Œè¿™ä½¿å¾—æ¨ªå‘æ‰©ç¼© Graph æœåŠ¡çš„å®ä¾‹éå¸¸çµæ´»ã€ç®€å•ã€‚ Graph æœåŠ¡ä¹Ÿå« Query Engineï¼Œå…¶å†…éƒ¨å’Œä¼ ç»Ÿçš„æ•°æ®åº“ç³»ç»Ÿçš„è®¾è®¡éå¸¸ç›¸ä¼¼ï¼Œåˆ†ä¸ºï¼šè§£æã€æ ¡éªŒã€è®¡åˆ’ã€æ‰§è¡Œå‡ éƒ¨åˆ†ã€‚ 1.2.2 Meta Service: nebula-metadMeta æœåŠ¡é¡¾åæ€ä¹‰è´Ÿè´£å…ƒæ•°æ®ç®¡ç†ï¼Œè¿›ç¨‹åå­—å« metadã€‚è¿™äº›å…ƒæ•°æ®åŒ…æ‹¬ï¼š æ‰€æœ‰çš„å›¾ç©ºé—´ã€Schema å®šä¹‰ ç”¨æˆ·é‰´æƒã€æˆæƒä¿¡æ¯ é›†ç¾¤æœåŠ¡çš„å‘ç°ä¸æœåŠ¡çš„åˆ†å¸ƒ å›¾ç©ºé—´ä¸­çš„æ•°æ®åˆ†å¸ƒ Meta æœåŠ¡çš„è¿›ç¨‹å¯ä»¥å•å®ä¾‹éƒ¨ç½²ï¼Œåœ¨éå•æœºéƒ¨ç½²çš„åœºæ™¯ä¸‹ï¼Œä¸ºäº†æ•°æ®ã€æœåŠ¡çš„é«˜ SLA ï¼Œæˆ‘ä»¬å¯ä»¥å¥‡æ•°å¤šä¸ªå®ä¾‹çš„éƒ¨ç½²ï¼Œé€šå¸¸æ¥è¯´ 3 ä¸ª nebula-metad å°±è¶³å¤Ÿäº†ï¼Œä¸‰ä¸ª nebula-metad é€šè¿‡ RAFT å…±è¯†åè®®æ„æˆä¸€ä¸ªé›†ç¾¤æä¾›æœåŠ¡ã€‚ 1.2.3 Storage Service: nebula-storagedStorage æœåŠ¡å­˜å‚¨æ‰€æœ‰çš„å›¾æ•°æ®ï¼Œè¿›ç¨‹åå­—å« storagedã€‚storaged åˆ†å¸ƒå¼åœ°å­˜å‚¨å›¾æ•°æ®ï¼Œä¸º Graph å†…éƒ¨çš„å›¾æŸ¥è¯¢æ‰§è¡ŒæœŸæä¾›åº•å±‚çš„å›¾è¯­ä¹‰å­˜å‚¨æ¥å£ï¼Œæ–¹ä¾¿ Storage å®¢æˆ·ç«¯é€šè¿‡ Thrift RPC åè®®é¢å‘æ¶‰åŠçš„ storaged ç¤ºä¾‹è¿›è¡Œå›¾è¯­ä¹‰çš„è¯»å†™ã€‚ å½“ NebulaGraph ä¸­å›¾ç©ºé—´çš„å‰¯æœ¬æ•°å¤§äº 1 çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªåˆ†åŒºéƒ½ä¼šåœ¨ä¸åŒ storaged ç¤ºä¾‹ä¸Šæœ‰å‰¯æœ¬ï¼Œå‰¯æœ¬ä¹‹é—´åˆ™é€šè¿‡ RAFT åè®®åè°ƒåŒæ­¥ä¸è¯»å†™ã€‚ å‚è€ƒ æ–‡æ¡£ï¼šæ¶æ„ä»‹ç»ï¼Œäº†è§£æ›´å¤šè¯¦æƒ…ï¼› æ¨èé˜…è¯»ç¤¾åŒºå®˜æ–¹æ’­å®¢çš„æ¶æ„ç³»åˆ—æ–‡ç« ï¼šnebula-graph.com.cn/tags/æ¶æ„ç³»åˆ—ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:1:2","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#storage-service-nebula-storaged"},{"categories":["Nebula Graph"],"content":" 1.3 è¿›ç¨‹é—´é€šä¿¡ã€æœåŠ¡å‘ç°æœºåˆ¶graphdã€metadã€storaged ä¹‹é—´é€šè¿‡ Thrift åè®®è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼ˆRPCï¼‰ï¼Œä¸‹è¾¹ç»™ä¸€äº›ä¾‹å­ï¼š graphd ä¼šé€šè¿‡ metaclient è°ƒç”¨ metad å°†è‡ªå·±æŠ¥å‘Šä¸ºä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„æœåŠ¡ï¼Œä»¥ä¾¿è¢«å‘ç° ä¸ºç”¨æˆ·ï¼ˆä½¿ç”¨ graphclient ï¼‰ç™»å½•è¿›è¡Œ RPC è°ƒç”¨ å½“å®ƒå¤„ç† nGQL æŸ¥è¯¢æ—¶ï¼Œè·å–å›¾å½¢å­˜å‚¨åˆ†å¸ƒæƒ…å†µ graphd ä¼šé€šè¿‡ storageclient è°ƒç”¨ storaged åœ¨å¤„ç† nGQL æ—¶ï¼Œåœ¨å®ƒä» metad è·å¾—æ‰€éœ€çš„å…ƒä¿¡æ¯åï¼Œè¿›è¡Œå›¾å½¢æ•°æ®çš„è¯»/å†™ storaged ä¼šé€šè¿‡ metaclientè°ƒç”¨ metad å°†è‡ªå·±æŠ¥å‘Šä¸ºä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„æœåŠ¡ï¼Œä»¥ä¾¿è¢«å‘ç° å½“ç„¶æœ‰çŠ¶æ€çš„å­˜å‚¨å¼•æ“å†…éƒ¨ä¹Ÿæœ‰é›†ç¾¤åŒæ­¥çš„æµé‡ä¸é€šä¿¡ storaged ä¸å…¶ä»– storaged æœ‰ RAFT è¿æ¥ metad ä¸å…¶ä»– metad å®ä¾‹æœ‰ RAFT è¿æ¥ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:1:3","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#è¿›ç¨‹é—´é€šä¿¡æœåŠ¡å‘ç°æœºåˆ¶"},{"categories":["Nebula Graph"],"content":" 2 å¼€å‘ç¯å¢ƒæ­å»ºæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹ NebulaGraph çš„æ„å»ºã€å¼€å‘ç¯å¢ƒçš„éƒ¨åˆ†ã€‚ NebulaGraph åªæ”¯æŒåœ¨ GNU/Linux åˆ†æ”¯ä¸­æ„å»ºï¼Œç›®å‰æ¥è¯´ï¼Œæœ€æ–¹ä¾¿çš„æ–¹å¼æ˜¯åœ¨ç¤¾åŒºé¢„å…ˆæä¾›å¥½äº†ä¾èµ–çš„å®¹å™¨é•œåƒçš„åŸºç¡€ä¸Šåœ¨å®¹å™¨å†…éƒ¨æ„å»ºã€è°ƒè¯• NebulaGraph ä»£ç çš„æ›´æ”¹å’Œ Debugã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:2:0","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#å¼€å‘ç¯å¢ƒæ­å»º"},{"categories":["Nebula Graph"],"content":" 2.1 åˆ›å»ºä¸€ä¸ªå®¹å™¨åŒ–çš„ NebulaGraph é›†ç¾¤ä¸ºäº†æ›´æ–¹ä¾¿åœ°è°ƒè¯•ä»£ç ï¼Œæˆ‘ä¹ æƒ¯æå‰åˆ›å»ºä¸€ä¸ª NebulaGraph Docker ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„ Docker-Compose æ–¹å¼éƒ¨ç½²ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æˆ‘åœ¨å®˜æ–¹ Docker-Compose åŸºç¡€ä¹‹ä¸Šå¼„çš„ä¸€é”®éƒ¨ç½²å·¥å…·ï¼šnebula-up.siwei.ioã€‚ ä»¥ nebula-up ä¸ºä¾‹ï¼š åœ¨æˆ‘ä»¬çš„ Linux å¼€å‘æœåŠ¡å™¨ä¸­æ‰§è¡Œ curl -fsSL nebula-up.siwei.io/install.sh | bash å°±å¯ä»¥äº†ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:2:1","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#åˆ›å»ºä¸€ä¸ªå®¹å™¨åŒ–çš„-nebulagraph-é›†ç¾¤"},{"categories":["Nebula Graph"],"content":" 2.2 ä»£ç è·å–NebulaGraph çš„ä»£ç ä»“åº“æ‰˜ç®¡åœ¨ GitHub ä¹‹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ‰äº’è”ç½‘çš„åœ°æ–¹ç›´æ¥å…‹éš†ä¸‹æ¥ï¼š git clone git@github.com:vesoft-inc/nebula.git cd nebula ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:2:2","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#ä»£ç è·å–"},{"categories":["Nebula Graph"],"content":" 2.3 åˆ›å»ºå¼€å‘å®¹å™¨æœ‰äº† NebulaGraph é›†ç¾¤ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© https://github.com/vesoft-inc/nebula-dev-docker/ æä¾›çš„å¼€ç®±å³ç”¨å¼€å‘å®¹å™¨é•œåƒï¼Œæ­å»ºå¼€å‘ç¯å¢ƒï¼š export TAG=ubuntu2004 docker run -ti \\ --network nebula-net \\ --security-opt seccomp=unconfined \\ -v \"$PWD\":/home/nebula \\ -w /home/nebula \\ --name nebula_dev \\ vesoft/nebula-dev:$TAG \\ bash è¿™å…¶ä¸­ï¼Œ-v \"$PWD\" è¡¨ç¤ºå½“å‰çš„ NebulaGraph ä»£ç æœ¬åœ°çš„è·¯å¾„ä¼šè¢«æ˜ å°„åˆ°å¼€å‘å®¹å™¨å†…éƒ¨çš„ /home/nebulaï¼Œè€Œå¯åŠ¨çš„å®¹å™¨åå­—æ˜¯ nebula_devã€‚ å¾…è¿™ä¸ªå®¹å™¨å¯åŠ¨ä¹‹åï¼Œæˆ‘ä»¬ä¼šè‡ªåŠ¨è¿›å…¥åˆ°è¿™ä¸ªå®¹å™¨çš„ bash shell ä¹‹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬è¾“å…¥ exit é€€å‡ºå®¹å™¨ï¼Œå®ƒä¼šè¢«å…³é—­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å†æ¬¡å¯åŠ¨å®¹å™¨ï¼Œåªéœ€è¦æ‰§è¡Œï¼š docker start nebula_dev ä¹‹åï¼Œæˆ‘ä»¬çš„ç¼–è¯‘ã€Debugã€æµ‹è¯•å·¥ä½œéƒ½åœ¨ nebula_dev å®¹å™¨å†…éƒ¨è¿›è¡Œï¼Œåœ¨å®¹å™¨æ˜¯è¿è¡ŒçŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥éšæ—¶æ–°å»ºä¸€ä¸ªå®¹å™¨å†…éƒ¨çš„ bash shell è¿›ç¨‹ï¼š docker exec -ti nebula_dev bash æ³¨ï¼Œä¸ºäº†ä¿æŒç¼–è¯‘ç¯å¢ƒæ˜¯æœ€æ–°çš„ï¼Œæˆ‘ä»¬å¯ä»¥å®šæœŸåˆ é™¤ã€æ‹‰å–ã€é‡å»ºè¿™ä¸ªå¼€å‘å®¹å™¨ï¼Œä»¥ä¿æŒç¯å¢ƒä¸ä»£ç ç›¸åŒ¹é…ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:2:3","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#åˆ›å»ºå¼€å‘å®¹å™¨"},{"categories":["Nebula Graph"],"content":" 2.4 ç¼–è¯‘ç¯å¢ƒåœ¨ nebula_dev è¿™ä¸ªå®¹å™¨å†…éƒ¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œä»£ç ç¼–è¯‘ï¼š è¿›å…¥ç¼–è¯‘å®¹å™¨ docker exec -ti nebula_dev bash ç”¨ CMake å‡†å¤‡ makefileï¼Œç¬¬ä¸€æ¬¡æ„å»ºçš„æ—¶å€™ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´ã€å†…å­˜ï¼Œæˆ‘å…³é—­äº†æµ‹è¯•ï¼ˆ-DENABLE_TESTING=OFFï¼‰ï¼š mkdir build \u0026\u0026 cd build cmake -DCMAKE_CXX_COMPILER=$TOOLSET_CLANG_DIR/bin/g++ -DCMAKE_C_COMPILER=$TOOLSET_CLANG_DIR/bin/gcc -DENABLE_WERROR=OFF -DCMAKE_BUILD_TYPE=Debug -DENABLE_TESTING=OFF .. å¼€å§‹ç¼–è¯‘ï¼Œæ ¹æ®æœåŠ¡å™¨çš„ç©ºé—² CPU ä¸ªæ•°å’Œå†…å­˜é‡åŠ›è€Œè¡Œï¼Œæ¯”å¦‚æˆ‘åœ¨è‡ªå·± 72 æ ¸å¿ƒçš„æœåŠ¡å™¨ä¸Šå‡†å¤‡å…è®¸åŒæ—¶è¿è¡Œ 64 ä¸ª jobï¼Œåˆ™è¿è¡Œï¼š make -j64 ç¬¬ä¸€æ¬¡æ„å»ºçš„æ—¶é—´ä¼šæ…¢ä¸€äº›ï¼Œåœ¨ make æˆåŠŸä¹‹åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰§è¡Œ make install æŠŠäºŒè¿›åˆ¶å®‰è£…åˆ°åƒç”Ÿäº§å®‰è£…æ—¶å€™ä¸€æ ·çš„è·¯å¾„ï¼š root@1827b82e88bf:/home/nebula/build# make install root@1827b82e88bf:/home/nebula/build# ls /usr/local/nebula/bin db_dump db_upgrader meta_dump nebula-graphd nebula-metad nebula-storaged root@1827b82e88bf:/home/nebula/build# ls /usr/local/nebula/ bin etc pids scripts share ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:2:4","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#ç¼–è¯‘ç¯å¢ƒ"},{"categories":["Nebula Graph"],"content":" 3 è°ƒè¯• NebulaGraphä»¥ GraphD è°ƒè¯•ä¸ºä¾‹ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:3:0","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#è°ƒè¯•-nebulagraph"},{"categories":["Nebula Graph"],"content":" 3.1 å®‰è£…ä¾èµ–å®‰è£…ä¸€äº›åè¾¹ä¼šæ–¹ä¾¿ Debug é¢å¤–ç”¨åˆ°çš„ä¾èµ– # è£…ä¸€ä¸ª pingï¼Œæµ‹è¯•ä¸€ä¸‹ nebula-up å®‰è£…çš„é›†ç¾¤å¯ä»¥è®¿é—® apt update \u0026\u0026 apt install iputils-ping -y # ping graphd è¯•è¯•çœ‹ ping graphd -c 4 # å®‰è£… gdb gdb-dashboard apt install gdb -y wget -P ~ https://git.io/.gdbinit pip install pygments ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:3:1","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#å®‰è£…ä¾èµ–"},{"categories":["Nebula Graph"],"content":" 3.2 å‡†å¤‡å®¢æˆ·ç«¯å‡†å¤‡ä¸€ä¸ª NebulaGraph çš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼š # æ–°å¼€ä¸€ä¸ª nebula_dev çš„ shell docker exec -ti nebula_dev bash # ä¸‹è½½ nebula-console äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶èµ‹äºˆå¯æ‰§è¡Œæƒé™ï¼Œå‘½åä¸º nebula-console å¹¶å®‰è£…åˆ° /usr/bin/ ä¸‹ wget https://github.com/vesoft-inc/nebula-console/releases/download/v3.2.0/nebula-console-linux-amd64-v3.2.0 chmod +x nebula-console* mv nebula-console* /usr/bin/nebula-console è¿æ¥åˆ°å‰è¾¹æˆ‘ä»¬ nebula-up å‡†å¤‡çš„é›†ç¾¤ä¹‹ä¸Šï¼ŒåŠ è½½ basketballplayer è¿™ä¸ªæµ‹è¯•æ•°æ®ï¼š nebula-console -u root -p nebula --address=graphd --port=9669 :play basketballplayer; exit ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:3:2","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#å‡†å¤‡å®¢æˆ·ç«¯"},{"categories":["Nebula Graph"],"content":" 3.3 gdb è¿è¡Œ graphdæˆ‘ä»¬ç”¨ gdb æ‰§è¡Œåˆšåˆšç¼–è¯‘çš„ nebula-graphd äºŒè¿›åˆ¶ï¼Œè®©ä»–æˆä¸ºä¸€ä¸ªæ–°çš„ graphd æœåŠ¡ï¼Œåå­—å°±å« nebula_devã€‚ é¦–å…ˆå¯åŠ¨ gdb # æ–°å¼€ä¸€ä¸ª nebula_dev çš„ shell docker exec -ti nebula_dev bash cd /usr/local/nebula/ mkdir -p /home/nebula/build/log gdb bin/nebula-graphd åœ¨ gdb å†…éƒ¨æ‰§è¡Œè®¾ç½®å¿…è¦çš„å‚æ•° è·Ÿéš fork çš„å­è¿›ç¨‹ set follow-fork-mode child è®¾ç½®å¾…è°ƒè¯• graphd çš„å¯åŠ¨å‚æ•°ï¼ˆé…ç½®ï¼‰ï¼š meta_server_addrs å¡«å·²ç»å¯åŠ¨çš„é›†ç¾¤çš„æ‰€æœ‰ metad çš„åœ°å€ local_ip å’Œ ws_ip å¡«æœ¬å®¹å™¨çš„åŸŸåï¼Œport æ˜¯ graphd ç›‘å¬ç«¯å£ log_dir æ˜¯è¾“å‡ºæ—¥å¿—çš„ç›®å½•ï¼Œv å’Œ minloglevel æ˜¯æ—¥å¿—çš„è¾“å‡ºç­‰çº§ set args --flagfile=/usr/local/nebula/etc/nebula-graphd.conf.default \\ --meta_server_addrs=metad0:9559,metad1:9559,metad2:9559 \\ --port=9669 \\ --local_ip=nebula_dev \\ --ws_ip=nebula_dev \\ --ws_http_port=19669 \\ --log_dir=/home/nebula/build/log \\ --v=4 \\ --minloglevel=0 å¦‚æœæˆ‘ä»¬æƒ³åŠ æ–­ç‚¹åœ¨ src/common/function/FunctionManager.cpp 2783 è¡Œï¼Œå¯ä»¥å†æ‰§è¡Œï¼š b /home/nebula/src/common/function/FunctionManager.cpp:2783 é…ç½®å‰è¾¹å®‰è£…çš„ gdb-dashboardï¼Œä¸€ä¸ªå¼€æºçš„ gdb ç•Œé¢æ’ä»¶ã€‚ # è®¾å®šåœ¨ gdb ç•Œé¢ä¸Šå±•ç¤º ä»£ç ã€å†å²ã€å›è°ƒæ ˆã€å˜é‡ã€è¡¨è¾¾å‡ ä¸ªéƒ¨åˆ†ï¼Œè¯¦ç»†å‚è€ƒ https://github.com/cyrus-and/gdb-dashboard dashboard -layout source history stack variables expressions æœ€åæˆ‘ä»¬è®©è¿›ç¨‹é€šè¿‡ gdb è·‘èµ·æ¥å§ï¼š run ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è¿™ä¸ªçª—å£/shell ä¼šè¯ä¸‹è°ƒè¯• graphd ç¨‹åºäº†ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:3:3","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#gdb-è¿è¡Œ-graphd"},{"categories":["Nebula Graph"],"content":" 4 ä¿®æ”¹ NebulaGraph ä»£ç è¿™é‡Œï¼Œæˆ‘ä»¥ #3513 è¿™ä¸ª issue ä¸ºä¾‹å­ï¼Œå¿«é€Ÿä»‹ç»ä¸€ä¸‹ä»£ç ä¿®æ”¹çš„è¿‡ç¨‹ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:4:0","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#ä¿®æ”¹-nebulagraph-ä»£ç "},{"categories":["Nebula Graph"],"content":" 4.1 è¯»ä»£ç è¿™ä¸ª issue è¡¨è¾¾çš„å†…å®¹æ˜¯åœ¨æœ‰ä¸€å°éƒ¨åˆ†ç”¨æˆ·å†³å®šæŠŠ JSON ä»¥ String çš„å½¢å¼å­˜å‚¨åœ¨ NebulaGraph ä¸­çš„å±æ€§é‡Œï¼Œå› ä¸ºè¿™ç§æ–¹å¼æ¯”è¾ƒç½•è§ä¸”ä¸è¢«æ¨å´‡ï¼ŒNebulaGraph æ²¡æœ‰ç›´æ¥æ”¯æŒå¯¹ JSON String ç›´æ¥è§£æçš„æ–¹æ³•ã€‚ æœ¬æ¥è¿™ä¸ªåŠŸèƒ½æ˜¯ç­‰åˆ°å¾ˆå¸Œæœ›å¾—åˆ°æ”¯æŒçš„åŒå­¦è¿‡æ¥äº²è‡ªå»å®ç°çš„ï¼Œè€Œåœ¨ Issue ä¸­ï¼Œåˆšå¥½æœ‰ä¸€ä½æ–°æ‰‹è´¡çŒ®è€…åœ¨é‡Œè¾¹å›å¤æ±‚åŠ©å¦‚ä½•èƒ½å¼€å§‹å‚ä¸è¿™ä¸ªè´¡çŒ®ã€‚æ¥ç€è¿™ä¸ªå¥‘æœºï¼Œæˆ‘å»å‚ä¸è®¨è®ºçœ‹äº†ä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½å¯ä»¥å®ç°æˆä»€ä¹ˆæ ·å­ï¼Œæœ€ç»ˆè®¨è®ºçš„ç»“æœæ˜¯å¯ä»¥åšæˆå’Œ MySQL ä¸­çš„ JSON_EXTRACT å‡½æ•°é‚£æ ·ï¼Œä½†æ˜¯æ”¹ä¸ºåªæ¥å— JSON Stringï¼Œæ— éœ€å¤„ç†è¾“å‡ºè·¯å¾„å‚æ•°ã€‚ è¿™ä¸ªä»»åŠ¡ä¸€å¥è¯æ¥è¯´å°±æ˜¯ä¸º NebulaGraph å¼•å…¥ä¸€ä¸ªè§£æ JSON String ä¸º Map çš„å‡½æ•°ã€‚é‚£ä¹ˆï¼Œåº”è¯¥å¤§æ¦‚å¦‚ä½•å®ç°è¿™ä¸ªåŠŸèƒ½å‘¢ï¼Ÿ 4.1.1 åœ¨å“ªé‡Œä¿®æ”¹å¾ˆè‡ªç„¶ï¼Œå¼•å…¥æ–°çš„å‡½æ•°çš„æ›´æ”¹è‚¯å®šæœ‰å¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¹‹å‰å¢åŠ æ–°å‡½æ•°çš„ PR å°±å¯ä»¥å¿«é€ŸçŸ¥é“åœ¨å“ªäº›åœ°æ–¹ä¿®æ”¹äº†ã€‚ å½“ç„¶æˆ‘ä»¬å¯ä»¥è‡ªåº•å‘ä¸Šå»äº†è§£ NebulaGraph æ•´ä½“çš„ä»£ç ç»“æ„ï¼Œç„¶åä¸€ç‚¹ç‚¹æ‰¾åˆ°å‡½æ•°å¤„ç†çš„ä½ç½®ï¼Œäº‹å®ä¸Šæœ‰çš„æ—¶å€™æˆ‘ä»¬ä¹Ÿä¸å¾—ä¸è¿™ä¹ˆåšï¼Œè¿™æ—¶å€™é™¤äº†ä»£ç æœ¬èº«ï¼Œä¸€äº›é¢å‘è´¡çŒ®è€…çš„æ–‡ç« å¯èƒ½ä¼šå¸®åŠ©æˆ‘ä»¬äº‹åŠåŠŸå€å¯¹æ•´ä½“æœ‰ä¸€ä¸ªäº†è§£ï¼ŒNebulaGraph å®˜æ–¹åšå®¢é‡Œå°±æœ‰è¿™æ ·çš„ä¸€ä¸ªç³»åˆ—æ–‡ç« ï¼Œæ¨èå¤§å®¶åœ¨è´¡çŒ®çš„æ—¶å€™ä¹Ÿå»é€šè¯»ä¸€ä¸‹ï¼šnebula-graph.com.cn/posts/nebula-graph-source-code-reading-00ã€‚ äºæ˜¯ï¼Œæˆ‘ä» #4526 è¿™ä¸ª PR é‡Œäº†è§£åˆ°æ‰€æœ‰å‡½æ•°å…¥å£éƒ½è¢«ç»Ÿä¸€ç®¡ç†åœ¨ src/common/function/FunctionManager.cpp ä¹‹ä¸­ï¼Œé€šè¿‡æœç´¢ã€ç†è§£å…¶ä¸­å…¶ä»–æŸä¸€ä¸ªå‡½æ•°çš„å…³é”®è¯ä¹‹åå¯ä»¥å¾ˆå®¹æ˜“ç†è§£ä¸€ä¸ªå‡½æ•°å®ä½“çš„å…³é”®è¯ã€è¾“å…¥è¾“å‡ºæ•°æ®ç±»å‹ã€ä»¥åŠå®ƒçš„å¤„ç†é€»è¾‘çš„ä»£ç åœ¨å“ªé‡Œå®ç°ã€‚ åŒæ—¶ï¼Œæˆ‘æ³¨æ„åˆ°åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œsrc/common/function/test/FunctionManagerTest.cpp ä¹‹ä¸­åˆ™æ˜¯æ‰€æœ‰è¿™äº›å‡½æ•°çš„å•å…ƒæµ‹è¯•ä»£ç ï¼Œç”¨åŒæ ·çš„æ–¹å¼ä¹Ÿå¯ä»¥çŸ¥é“æ–°åŠ çš„ä¸€ä¸ªå‡½æ•°éœ€è¦å¦‚ä½•åœ¨é‡Œè¾¹å®ç°åŸºäº gtest çš„å•å…ƒæµ‹è¯•ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:4:1","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#è¯»ä»£ç "},{"categories":["Nebula Graph"],"content":" 4.1 è¯»ä»£ç è¿™ä¸ª issue è¡¨è¾¾çš„å†…å®¹æ˜¯åœ¨æœ‰ä¸€å°éƒ¨åˆ†ç”¨æˆ·å†³å®šæŠŠ JSON ä»¥ String çš„å½¢å¼å­˜å‚¨åœ¨ NebulaGraph ä¸­çš„å±æ€§é‡Œï¼Œå› ä¸ºè¿™ç§æ–¹å¼æ¯”è¾ƒç½•è§ä¸”ä¸è¢«æ¨å´‡ï¼ŒNebulaGraph æ²¡æœ‰ç›´æ¥æ”¯æŒå¯¹ JSON String ç›´æ¥è§£æçš„æ–¹æ³•ã€‚ æœ¬æ¥è¿™ä¸ªåŠŸèƒ½æ˜¯ç­‰åˆ°å¾ˆå¸Œæœ›å¾—åˆ°æ”¯æŒçš„åŒå­¦è¿‡æ¥äº²è‡ªå»å®ç°çš„ï¼Œè€Œåœ¨ Issue ä¸­ï¼Œåˆšå¥½æœ‰ä¸€ä½æ–°æ‰‹è´¡çŒ®è€…åœ¨é‡Œè¾¹å›å¤æ±‚åŠ©å¦‚ä½•èƒ½å¼€å§‹å‚ä¸è¿™ä¸ªè´¡çŒ®ã€‚æ¥ç€è¿™ä¸ªå¥‘æœºï¼Œæˆ‘å»å‚ä¸è®¨è®ºçœ‹äº†ä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½å¯ä»¥å®ç°æˆä»€ä¹ˆæ ·å­ï¼Œæœ€ç»ˆè®¨è®ºçš„ç»“æœæ˜¯å¯ä»¥åšæˆå’Œ MySQL ä¸­çš„ JSON_EXTRACT å‡½æ•°é‚£æ ·ï¼Œä½†æ˜¯æ”¹ä¸ºåªæ¥å— JSON Stringï¼Œæ— éœ€å¤„ç†è¾“å‡ºè·¯å¾„å‚æ•°ã€‚ è¿™ä¸ªä»»åŠ¡ä¸€å¥è¯æ¥è¯´å°±æ˜¯ä¸º NebulaGraph å¼•å…¥ä¸€ä¸ªè§£æ JSON String ä¸º Map çš„å‡½æ•°ã€‚é‚£ä¹ˆï¼Œåº”è¯¥å¤§æ¦‚å¦‚ä½•å®ç°è¿™ä¸ªåŠŸèƒ½å‘¢ï¼Ÿ 4.1.1 åœ¨å“ªé‡Œä¿®æ”¹å¾ˆè‡ªç„¶ï¼Œå¼•å…¥æ–°çš„å‡½æ•°çš„æ›´æ”¹è‚¯å®šæœ‰å¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¹‹å‰å¢åŠ æ–°å‡½æ•°çš„ PR å°±å¯ä»¥å¿«é€ŸçŸ¥é“åœ¨å“ªäº›åœ°æ–¹ä¿®æ”¹äº†ã€‚ å½“ç„¶æˆ‘ä»¬å¯ä»¥è‡ªåº•å‘ä¸Šå»äº†è§£ NebulaGraph æ•´ä½“çš„ä»£ç ç»“æ„ï¼Œç„¶åä¸€ç‚¹ç‚¹æ‰¾åˆ°å‡½æ•°å¤„ç†çš„ä½ç½®ï¼Œäº‹å®ä¸Šæœ‰çš„æ—¶å€™æˆ‘ä»¬ä¹Ÿä¸å¾—ä¸è¿™ä¹ˆåšï¼Œè¿™æ—¶å€™é™¤äº†ä»£ç æœ¬èº«ï¼Œä¸€äº›é¢å‘è´¡çŒ®è€…çš„æ–‡ç« å¯èƒ½ä¼šå¸®åŠ©æˆ‘ä»¬äº‹åŠåŠŸå€å¯¹æ•´ä½“æœ‰ä¸€ä¸ªäº†è§£ï¼ŒNebulaGraph å®˜æ–¹åšå®¢é‡Œå°±æœ‰è¿™æ ·çš„ä¸€ä¸ªç³»åˆ—æ–‡ç« ï¼Œæ¨èå¤§å®¶åœ¨è´¡çŒ®çš„æ—¶å€™ä¹Ÿå»é€šè¯»ä¸€ä¸‹ï¼šnebula-graph.com.cn/posts/nebula-graph-source-code-reading-00ã€‚ äºæ˜¯ï¼Œæˆ‘ä» #4526 è¿™ä¸ª PR é‡Œäº†è§£åˆ°æ‰€æœ‰å‡½æ•°å…¥å£éƒ½è¢«ç»Ÿä¸€ç®¡ç†åœ¨ src/common/function/FunctionManager.cpp ä¹‹ä¸­ï¼Œé€šè¿‡æœç´¢ã€ç†è§£å…¶ä¸­å…¶ä»–æŸä¸€ä¸ªå‡½æ•°çš„å…³é”®è¯ä¹‹åå¯ä»¥å¾ˆå®¹æ˜“ç†è§£ä¸€ä¸ªå‡½æ•°å®ä½“çš„å…³é”®è¯ã€è¾“å…¥è¾“å‡ºæ•°æ®ç±»å‹ã€ä»¥åŠå®ƒçš„å¤„ç†é€»è¾‘çš„ä»£ç åœ¨å“ªé‡Œå®ç°ã€‚ åŒæ—¶ï¼Œæˆ‘æ³¨æ„åˆ°åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œsrc/common/function/test/FunctionManagerTest.cpp ä¹‹ä¸­åˆ™æ˜¯æ‰€æœ‰è¿™äº›å‡½æ•°çš„å•å…ƒæµ‹è¯•ä»£ç ï¼Œç”¨åŒæ ·çš„æ–¹å¼ä¹Ÿå¯ä»¥çŸ¥é“æ–°åŠ çš„ä¸€ä¸ªå‡½æ•°éœ€è¦å¦‚ä½•åœ¨é‡Œè¾¹å®ç°åŸºäº gtest çš„å•å…ƒæµ‹è¯•ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:4:1","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#åœ¨å“ªé‡Œä¿®æ”¹"},{"categories":["Nebula Graph"],"content":" 4.2 å¼€å§‹æ”¹ä»£ç  æ³¨ï¼šåœ¨ä¿®æ”¹ä»£ç ä¹‹å‰ï¼Œè¯·ç¡®ä¿è‡ªå·±åœ¨æœ€æ–°çš„ master åˆ†æ”¯ä¹‹ä¸Šåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„åˆ†æ”¯ï¼Œè¿™é‡Œçš„ä¾‹å­ä¸­ï¼Œæˆ‘æŠŠåˆ†æ”¯åå­—å« fn_JSON_EXTRACTï¼š git checkout master git pull git checkout -b fn_JSON_EXTRACT é€šè¿‡ Google äº†è§£ä¸äº¤å‰éªŒè¯ NebulaGraph å†…éƒ¨ä½¿ç”¨çš„ utils åº“ï¼Œæˆ‘çŸ¥é“æˆ‘åº”è¯¥ç”¨ folly::parseJson æŠŠå­—ç¬¦ä¸²è¯»æˆ folly::dynamic ç„¶åå† cast æˆ NebulaGraph å†…ç½®çš„ Map() ç±»å‹ï¼Œç„¶åï¼Œå€ŸåŠ©äº StackOverflow/GitHub Copilotï¼Œæˆ‘ç»ˆäºå®Œæˆäº†ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„ä»£ç ä¿®æ”¹ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:4:2","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#å¼€å§‹æ”¹ä»£ç "},{"categories":["Nebula Graph"],"content":" 4.3 è°ƒè¯•ä»£ç æ¥ä¸‹æ¥ï¼Œæˆ‘å…´å†²å†²åœ°æ”¹å¥½äº†ç¬¬ä¸€ç‰ˆçš„ä»£ç ï¼Œä¿¡å¿ƒæ»¡æ»¡åœ°å¼€å§‹ç¼–è¯‘ï¼å®é™…ä¸Šå› ä¸ºæ˜¯ CPP æ–°æ‰‹ï¼Œå³ä½¿åœ¨ Copilot çš„åŠ æŒä¸‹ï¼Œæˆ‘çš„ä»£ç è¿˜æ˜¯èŠ±äº†å¥½å‡ æ¬¡ä¿®æ”¹æ‰é€šè¿‡ç¼–è¯‘ã€‚ ç„¶åï¼Œæˆ‘å¼€å§‹ç”¨ GDB æŠŠä¿®æ”¹äº†çš„ GraphD å¯åŠ¨èµ·æ¥ï¼Œç”¨ console å‘èµ· JSON_EXTRACT çš„å‡½æ•°è°ƒç”¨ï¼Œå…ˆè°ƒé€šäº†æœŸå¾…ä¸­çš„æ•ˆæœï¼Œå¹¶è¯•ç€è·‘å‡ ç§å¼‚å¸¸çš„è¾“å…¥ï¼Œåœ¨å‘ç°æ–°é—®é¢˜ã€ä¿®æ”¹ã€ç¼–è¯‘ã€è°ƒè¯•çš„å‡ è½®å¾ªç¯ä¸‹è®©ä»£ç è¾¾åˆ°äº†æœŸæœ›çš„çŠ¶æ€ï¼Œè¿™æ—¶å€™ï¼Œæˆ‘çŸ¥é“æˆ‘è¦æŠŠä»£ç æäº¤åˆ° GitHub è¯·é¡¹ç›®çš„èµ„æ·±è´¡çŒ®è€…å¸®å¿™ review å•¦ï¼ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:4:3","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#è°ƒè¯•ä»£ç "},{"categories":["Nebula Graph"],"content":" 5 æäº¤ PRPRï¼ˆPull Requestï¼‰æ˜¯ GitHub ä¸­æ–¹ä¾¿å¤šäººä»£ç åä½œã€ä»£ç å®¡æŸ¥ä¸­çš„ä¸€ç§æ–¹å¼ï¼Œå®ƒé€šè¿‡æŠŠä¸€ä¸ª repo ä¸‹çš„åˆ†æ”¯ä¸è¿™ä¸ªå®¡æŸ¥åä½œçš„å®ä¾‹ï¼ˆPRï¼‰åšæ˜ å°„ï¼Œå¾—åˆ°ä¸€ä¸ªé¡¹ç›®ä¸‹å”¯ä¸€çš„ PR å·ç ä¹‹åï¼Œç”Ÿæˆå•ç‹¬çš„ç½‘é¡µï¼Œåœ¨è¿™ä¸ªç½‘é¡µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åšä¸åŒè´¡çŒ®è€…ä¹‹é—´çš„äº¤æµå’Œåç»­çš„ä»£ç æ›´æ–°ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ä»£ç æäº¤è€…ä»¬å¯ä»¥ä¸€ç›´åœ¨è¿™ä¸ªåˆ†æ”¯ä¸Šä¸æ–­æäº¤ä»£ç ç›´åˆ°ä»£ç çš„çŠ¶æ€è¢«å„æ–¹åŒæ„ä¹‹åï¼Œå°±å¯ä»¥åˆå¹¶ï¼ˆmergeï¼‰åˆ°ç›®çš„åˆ†æ”¯ä¸­ã€‚ è¿™ä¸ªè¿‡ç¨‹å¯ä»¥åˆ†ä¸ºï¼š åˆ›å»º GitHub ä¸Šè¿œç¨‹çš„ä¸ªäººå¼€å‘åˆ†æ”¯ åŸºäºåˆ†æ”¯åˆ›å»ºç›®æ ‡é¡¹ç›®ä»“åº“ä¸­çš„ PR åœ¨ PR ä¸­åä½œã€è®¨è®ºã€ä¸æ–­å†æ¬¡æäº¤åˆ°å¼€å‘åˆ†æ”¯ç›´åˆ°å¤šæ–¹è¾¾åˆ°åˆå¹¶ã€æˆ–è€…å…³é—­çš„å…±è¯† ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:5:0","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#æäº¤-pr"},{"categories":["Nebula Graph"],"content":" 5.1 æäº¤åˆ°ä¸ªäººè¿œç¨‹åˆ†æ”¯è¿™ä¸€æ­¥éª¤é‡Œï¼Œæˆ‘ä»¬è¦æŠŠå½“å‰çš„æœ¬åœ°æäº¤çš„ commitï¼Œæäº¤åˆ°è‡ªå·±çš„ GitHub åˆ†å‰ä¹‹ä¸­ã€‚ 5.1.1 commit æœ¬åœ°ä¿®æ”¹é¦–å…ˆï¼Œæˆ‘ä»¬ç¡®è®¤ä¸€ä¸‹æœ¬åœ°çš„ä¿®æ”¹æ˜¯å¦éƒ½æ˜¯æœŸå¾…ä¸­çš„ï¼š # å…ˆç¡®å®šä¿®æ”¹çš„æ–‡ä»¶ $ git status # å†çœ‹çœ‹ä¿®æ”¹çš„å†…å®¹ $ git diff ç„¶åï¼ŒæŠŠå®ƒä»¬ commitï¼ˆæäº¤åœ¨æœ¬åœ°ä»“åº“ï¼‰ # æ·»åŠ æ‰€æœ‰å½“å‰ç›®å½•ï¼ˆ. è¿™ä¸ªç‚¹è¡¨ç¤ºå½“å‰ç›®å½•ï¼‰ä¿®æ”¹è¿‡çš„æ–‡ä»¶ä¸ºå¾… commit $ git add . # ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹çŠ¶æ€ï¼Œè¿™äº›ä¿®æ”¹çš„æ–‡ä»¶çŠ¶æ€å·²ç»ä¸åŒäº† $ git status # æœ€åï¼Œæäº¤åœ¨æœ¬åœ°ä»“åº“ï¼Œå¹¶ç”¨ -m å‚æ•°æŒ‡å®šå•è¡Œçš„ commit message $ git commit -m \"feat: introduce function JSON_EXTRACT\" 5.1.2 æäº¤åˆ°è‡ªå·±è¿œç¨‹çš„åˆ†æ”¯åœ¨æäº¤ä¹‹å‰ï¼Œè¦ç¡®ä¿è‡ªå·±çš„ GitHub è´¦å·ä¹‹ä¸‹ç¡®å®å­˜åœ¨ NebulaGraph ä»£ç ä»“åº“çš„åˆ†å‰ï¼ˆforkï¼‰ï¼Œæ¯”å¦‚æˆ‘çš„ GitHub è´¦å·æ˜¯ wey-guï¼Œæˆ‘è®¿é—®ï¼Œé‚£ä¹ˆæˆ‘å¯¹ https://github.com/vesoft-inc/nebula çš„åˆ†å‰åº”è¯¥å°±æ˜¯ https://github.com/wey-gu/nebula ã€‚ å¦‚æœè¿˜æ²¡æœ‰è‡ªå·±çš„åˆ†å‰ï¼Œå¯ä»¥ç›´æ¥åœ¨ https://github.com/vesoft-inc/nebula ä¸Šç‚¹å‡»å³ä¸Šè§’çš„ Forkï¼Œåˆ›å»ºè‡ªå·±çš„åˆ†å‰ä»“åº“ã€‚ å½“è¿œç¨‹çš„ä¸ªäººåˆ†å‰å­˜åœ¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä»£ç æäº¤ä¸Šå»äº† # æ·»åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“å« wey git remote add wey git@github.com:wey-gu/nebula.git # æäº¤ JSON_EXTRACT åˆ†æ”¯åˆ° wey è¿™ä¸ª remote ä»“åº“ git push wey JSON_EXTRACT 5.1.3 åœ¨ä¸ªäººè¿œç¨‹åˆ†å‰åˆ†æ”¯ä¸Šåˆ›å»º PRè¿™æ—¶å€™ï¼Œæˆ‘ä»¬è®¿é—®è¿™ä¸ªè¿œç¨‹åˆ†æ”¯ï¼šhttps://github.com/wey-gu/nebula/tree/fn_JSON_EXTRACT ï¼Œå°±èƒ½æ‰¾åˆ° Open PR çš„å…¥å£ï¼š ç„¶åç‚¹å‡» Open pull request æŒ‰é’®ï¼Œå°±è¿›å…¥åˆ°åˆ›å»º PR çš„ç•Œé¢äº†ï¼Œè¿™å’Œåœ¨ä¸€èˆ¬çš„è®ºå›é‡Œæäº¤ä¸€ä¸ªå¸–å­æ˜¯å¾ˆç±»ä¼¼çš„ï¼š æäº¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç­‰å¾…ã€æˆ–è€…é‚€è¯·å…¶ä»–äººæ¥åšä»£ç çš„å®¡æŸ¥ï¼ˆreviewï¼‰ï¼Œå¾€å¾€å…¶ä»–çš„è´¡çŒ®è€…éƒ½èƒ½ä»ä»–ä»¬çš„è§’åº¦ç»™å‡ºä¸€äº›ä»£ç ä¿®æ”¹çš„å»ºè®®å’Œæç¤ºï¼Œæˆ‘ä»¬éœ€è¦ç»è¿‡å‡ è½®çš„ä»£ç ä¿®æ”¹ã€è®¨è®ºä¹‹åä½¿å¾—ä»£ç è¾¾åˆ°æœ€ä½³çš„çŠ¶æ€ã€‚ è€Œè¿™äº›å®¡æŸ¥è€…ä¸­é™¤äº†ç¤¾åŒºçš„è´¡çŒ®è€…ï¼ˆäººç±»ï¼‰ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›è‡ªåŠ¨åŒ–çš„æœºå™¨äººï¼Œä»–ä»¬ä¼šåœ¨ä»£ç åº“ä¸­è‡ªåŠ¨åŒ–çš„é€šè¿‡æŒç»­é›†æˆï¼ˆCIï¼‰çš„æ–¹å¼è¿è¡Œä¸€äº›è‡ªåŠ¨åŒ–çš„å®¡æŸ¥å·¥ä½œï¼Œå¯èƒ½åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š CLAï¼šContributor License Agreementï¼ˆè´¡çŒ®è€…è®¸å¯åè®®ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªè¦ PR ä½œè€…åœ¨é¦–æ¬¡æäº¤ä»£ç åˆ°é¡¹ç›®æ—¶ç­¾ç½²çš„åè®®ï¼Œå› ä¸ºä»£ç å°†è¢«æäº¤åˆ°å…¬å…±ç©ºé—´ï¼Œè¿™ä»½åè®®çš„ç­¾ç½²æ„å‘³ç€ä½œè€…åŒæ„ä»£ç è¢«åˆ†äº«ã€å¤ç”¨ã€ä¿®æ”¹è¿™ä»¶äº‹æƒ…ã€‚ lintï¼šä»£ç é£æ ¼æ£€æŸ¥ï¼Œè¿™ä¹Ÿæ˜¯æœ€å¸¸è§çš„ CI ä»»åŠ¡ testï¼šå„ç§å±‚é¢çš„æµ‹è¯•æ£€æŸ¥ä»»åŠ¡ é€šå¸¸æ¥è¯´ï¼Œè¿™äº›æ‰€æœ‰çš„è‡ªåŠ¨åŒ–å®¡æŸ¥æœºå™¨äººæ‰€ä»£è¡¨çš„ä»»åŠ¡ä¹Ÿéœ€è¦å…¨éƒ½é€šè¿‡ï¼Œä»£ç çš„çŠ¶æ€æ‰èƒ½è¢«è®¤ä¸ºæ˜¯å¯ä»¥åˆå¹¶çš„ï¼Œè€Œä¸å‡ºæ„å¤–ï¼Œæˆ‘é¦–æ¬¡æäº¤çš„ä»£ç æœç„¶æœ‰æµ‹è¯•çš„å¤±è´¥ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:5:1","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#æäº¤åˆ°ä¸ªäººè¿œç¨‹åˆ†æ”¯"},{"categories":["Nebula Graph"],"content":" 5.1 æäº¤åˆ°ä¸ªäººè¿œç¨‹åˆ†æ”¯è¿™ä¸€æ­¥éª¤é‡Œï¼Œæˆ‘ä»¬è¦æŠŠå½“å‰çš„æœ¬åœ°æäº¤çš„ commitï¼Œæäº¤åˆ°è‡ªå·±çš„ GitHub åˆ†å‰ä¹‹ä¸­ã€‚ 5.1.1 commit æœ¬åœ°ä¿®æ”¹é¦–å…ˆï¼Œæˆ‘ä»¬ç¡®è®¤ä¸€ä¸‹æœ¬åœ°çš„ä¿®æ”¹æ˜¯å¦éƒ½æ˜¯æœŸå¾…ä¸­çš„ï¼š # å…ˆç¡®å®šä¿®æ”¹çš„æ–‡ä»¶ $ git status # å†çœ‹çœ‹ä¿®æ”¹çš„å†…å®¹ $ git diff ç„¶åï¼ŒæŠŠå®ƒä»¬ commitï¼ˆæäº¤åœ¨æœ¬åœ°ä»“åº“ï¼‰ # æ·»åŠ æ‰€æœ‰å½“å‰ç›®å½•ï¼ˆ. è¿™ä¸ªç‚¹è¡¨ç¤ºå½“å‰ç›®å½•ï¼‰ä¿®æ”¹è¿‡çš„æ–‡ä»¶ä¸ºå¾… commit $ git add . # ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹çŠ¶æ€ï¼Œè¿™äº›ä¿®æ”¹çš„æ–‡ä»¶çŠ¶æ€å·²ç»ä¸åŒäº† $ git status # æœ€åï¼Œæäº¤åœ¨æœ¬åœ°ä»“åº“ï¼Œå¹¶ç”¨ -m å‚æ•°æŒ‡å®šå•è¡Œçš„ commit message $ git commit -m \"feat: introduce function JSON_EXTRACT\" 5.1.2 æäº¤åˆ°è‡ªå·±è¿œç¨‹çš„åˆ†æ”¯åœ¨æäº¤ä¹‹å‰ï¼Œè¦ç¡®ä¿è‡ªå·±çš„ GitHub è´¦å·ä¹‹ä¸‹ç¡®å®å­˜åœ¨ NebulaGraph ä»£ç ä»“åº“çš„åˆ†å‰ï¼ˆforkï¼‰ï¼Œæ¯”å¦‚æˆ‘çš„ GitHub è´¦å·æ˜¯ wey-guï¼Œæˆ‘è®¿é—®ï¼Œé‚£ä¹ˆæˆ‘å¯¹ https://github.com/vesoft-inc/nebula çš„åˆ†å‰åº”è¯¥å°±æ˜¯ https://github.com/wey-gu/nebula ã€‚ å¦‚æœè¿˜æ²¡æœ‰è‡ªå·±çš„åˆ†å‰ï¼Œå¯ä»¥ç›´æ¥åœ¨ https://github.com/vesoft-inc/nebula ä¸Šç‚¹å‡»å³ä¸Šè§’çš„ Forkï¼Œåˆ›å»ºè‡ªå·±çš„åˆ†å‰ä»“åº“ã€‚ å½“è¿œç¨‹çš„ä¸ªäººåˆ†å‰å­˜åœ¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä»£ç æäº¤ä¸Šå»äº† # æ·»åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“å« wey git remote add wey git@github.com:wey-gu/nebula.git # æäº¤ JSON_EXTRACT åˆ†æ”¯åˆ° wey è¿™ä¸ª remote ä»“åº“ git push wey JSON_EXTRACT 5.1.3 åœ¨ä¸ªäººè¿œç¨‹åˆ†å‰åˆ†æ”¯ä¸Šåˆ›å»º PRè¿™æ—¶å€™ï¼Œæˆ‘ä»¬è®¿é—®è¿™ä¸ªè¿œç¨‹åˆ†æ”¯ï¼šhttps://github.com/wey-gu/nebula/tree/fn_JSON_EXTRACT ï¼Œå°±èƒ½æ‰¾åˆ° Open PR çš„å…¥å£ï¼š ç„¶åç‚¹å‡» Open pull request æŒ‰é’®ï¼Œå°±è¿›å…¥åˆ°åˆ›å»º PR çš„ç•Œé¢äº†ï¼Œè¿™å’Œåœ¨ä¸€èˆ¬çš„è®ºå›é‡Œæäº¤ä¸€ä¸ªå¸–å­æ˜¯å¾ˆç±»ä¼¼çš„ï¼š æäº¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç­‰å¾…ã€æˆ–è€…é‚€è¯·å…¶ä»–äººæ¥åšä»£ç çš„å®¡æŸ¥ï¼ˆreviewï¼‰ï¼Œå¾€å¾€å…¶ä»–çš„è´¡çŒ®è€…éƒ½èƒ½ä»ä»–ä»¬çš„è§’åº¦ç»™å‡ºä¸€äº›ä»£ç ä¿®æ”¹çš„å»ºè®®å’Œæç¤ºï¼Œæˆ‘ä»¬éœ€è¦ç»è¿‡å‡ è½®çš„ä»£ç ä¿®æ”¹ã€è®¨è®ºä¹‹åä½¿å¾—ä»£ç è¾¾åˆ°æœ€ä½³çš„çŠ¶æ€ã€‚ è€Œè¿™äº›å®¡æŸ¥è€…ä¸­é™¤äº†ç¤¾åŒºçš„è´¡çŒ®è€…ï¼ˆäººç±»ï¼‰ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›è‡ªåŠ¨åŒ–çš„æœºå™¨äººï¼Œä»–ä»¬ä¼šåœ¨ä»£ç åº“ä¸­è‡ªåŠ¨åŒ–çš„é€šè¿‡æŒç»­é›†æˆï¼ˆCIï¼‰çš„æ–¹å¼è¿è¡Œä¸€äº›è‡ªåŠ¨åŒ–çš„å®¡æŸ¥å·¥ä½œï¼Œå¯èƒ½åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š CLAï¼šContributor License Agreementï¼ˆè´¡çŒ®è€…è®¸å¯åè®®ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªè¦ PR ä½œè€…åœ¨é¦–æ¬¡æäº¤ä»£ç åˆ°é¡¹ç›®æ—¶ç­¾ç½²çš„åè®®ï¼Œå› ä¸ºä»£ç å°†è¢«æäº¤åˆ°å…¬å…±ç©ºé—´ï¼Œè¿™ä»½åè®®çš„ç­¾ç½²æ„å‘³ç€ä½œè€…åŒæ„ä»£ç è¢«åˆ†äº«ã€å¤ç”¨ã€ä¿®æ”¹è¿™ä»¶äº‹æƒ…ã€‚ lintï¼šä»£ç é£æ ¼æ£€æŸ¥ï¼Œè¿™ä¹Ÿæ˜¯æœ€å¸¸è§çš„ CI ä»»åŠ¡ testï¼šå„ç§å±‚é¢çš„æµ‹è¯•æ£€æŸ¥ä»»åŠ¡ é€šå¸¸æ¥è¯´ï¼Œè¿™äº›æ‰€æœ‰çš„è‡ªåŠ¨åŒ–å®¡æŸ¥æœºå™¨äººæ‰€ä»£è¡¨çš„ä»»åŠ¡ä¹Ÿéœ€è¦å…¨éƒ½é€šè¿‡ï¼Œä»£ç çš„çŠ¶æ€æ‰èƒ½è¢«è®¤ä¸ºæ˜¯å¯ä»¥åˆå¹¶çš„ï¼Œè€Œä¸å‡ºæ„å¤–ï¼Œæˆ‘é¦–æ¬¡æäº¤çš„ä»£ç æœç„¶æœ‰æµ‹è¯•çš„å¤±è´¥ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:5:1","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#commit-æœ¬åœ°ä¿®æ”¹"},{"categories":["Nebula Graph"],"content":" 5.1 æäº¤åˆ°ä¸ªäººè¿œç¨‹åˆ†æ”¯è¿™ä¸€æ­¥éª¤é‡Œï¼Œæˆ‘ä»¬è¦æŠŠå½“å‰çš„æœ¬åœ°æäº¤çš„ commitï¼Œæäº¤åˆ°è‡ªå·±çš„ GitHub åˆ†å‰ä¹‹ä¸­ã€‚ 5.1.1 commit æœ¬åœ°ä¿®æ”¹é¦–å…ˆï¼Œæˆ‘ä»¬ç¡®è®¤ä¸€ä¸‹æœ¬åœ°çš„ä¿®æ”¹æ˜¯å¦éƒ½æ˜¯æœŸå¾…ä¸­çš„ï¼š # å…ˆç¡®å®šä¿®æ”¹çš„æ–‡ä»¶ $ git status # å†çœ‹çœ‹ä¿®æ”¹çš„å†…å®¹ $ git diff ç„¶åï¼ŒæŠŠå®ƒä»¬ commitï¼ˆæäº¤åœ¨æœ¬åœ°ä»“åº“ï¼‰ # æ·»åŠ æ‰€æœ‰å½“å‰ç›®å½•ï¼ˆ. è¿™ä¸ªç‚¹è¡¨ç¤ºå½“å‰ç›®å½•ï¼‰ä¿®æ”¹è¿‡çš„æ–‡ä»¶ä¸ºå¾… commit $ git add . # ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹çŠ¶æ€ï¼Œè¿™äº›ä¿®æ”¹çš„æ–‡ä»¶çŠ¶æ€å·²ç»ä¸åŒäº† $ git status # æœ€åï¼Œæäº¤åœ¨æœ¬åœ°ä»“åº“ï¼Œå¹¶ç”¨ -m å‚æ•°æŒ‡å®šå•è¡Œçš„ commit message $ git commit -m \"feat: introduce function JSON_EXTRACT\" 5.1.2 æäº¤åˆ°è‡ªå·±è¿œç¨‹çš„åˆ†æ”¯åœ¨æäº¤ä¹‹å‰ï¼Œè¦ç¡®ä¿è‡ªå·±çš„ GitHub è´¦å·ä¹‹ä¸‹ç¡®å®å­˜åœ¨ NebulaGraph ä»£ç ä»“åº“çš„åˆ†å‰ï¼ˆforkï¼‰ï¼Œæ¯”å¦‚æˆ‘çš„ GitHub è´¦å·æ˜¯ wey-guï¼Œæˆ‘è®¿é—®ï¼Œé‚£ä¹ˆæˆ‘å¯¹ https://github.com/vesoft-inc/nebula çš„åˆ†å‰åº”è¯¥å°±æ˜¯ https://github.com/wey-gu/nebula ã€‚ å¦‚æœè¿˜æ²¡æœ‰è‡ªå·±çš„åˆ†å‰ï¼Œå¯ä»¥ç›´æ¥åœ¨ https://github.com/vesoft-inc/nebula ä¸Šç‚¹å‡»å³ä¸Šè§’çš„ Forkï¼Œåˆ›å»ºè‡ªå·±çš„åˆ†å‰ä»“åº“ã€‚ å½“è¿œç¨‹çš„ä¸ªäººåˆ†å‰å­˜åœ¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä»£ç æäº¤ä¸Šå»äº† # æ·»åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“å« wey git remote add wey git@github.com:wey-gu/nebula.git # æäº¤ JSON_EXTRACT åˆ†æ”¯åˆ° wey è¿™ä¸ª remote ä»“åº“ git push wey JSON_EXTRACT 5.1.3 åœ¨ä¸ªäººè¿œç¨‹åˆ†å‰åˆ†æ”¯ä¸Šåˆ›å»º PRè¿™æ—¶å€™ï¼Œæˆ‘ä»¬è®¿é—®è¿™ä¸ªè¿œç¨‹åˆ†æ”¯ï¼šhttps://github.com/wey-gu/nebula/tree/fn_JSON_EXTRACT ï¼Œå°±èƒ½æ‰¾åˆ° Open PR çš„å…¥å£ï¼š ç„¶åç‚¹å‡» Open pull request æŒ‰é’®ï¼Œå°±è¿›å…¥åˆ°åˆ›å»º PR çš„ç•Œé¢äº†ï¼Œè¿™å’Œåœ¨ä¸€èˆ¬çš„è®ºå›é‡Œæäº¤ä¸€ä¸ªå¸–å­æ˜¯å¾ˆç±»ä¼¼çš„ï¼š æäº¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç­‰å¾…ã€æˆ–è€…é‚€è¯·å…¶ä»–äººæ¥åšä»£ç çš„å®¡æŸ¥ï¼ˆreviewï¼‰ï¼Œå¾€å¾€å…¶ä»–çš„è´¡çŒ®è€…éƒ½èƒ½ä»ä»–ä»¬çš„è§’åº¦ç»™å‡ºä¸€äº›ä»£ç ä¿®æ”¹çš„å»ºè®®å’Œæç¤ºï¼Œæˆ‘ä»¬éœ€è¦ç»è¿‡å‡ è½®çš„ä»£ç ä¿®æ”¹ã€è®¨è®ºä¹‹åä½¿å¾—ä»£ç è¾¾åˆ°æœ€ä½³çš„çŠ¶æ€ã€‚ è€Œè¿™äº›å®¡æŸ¥è€…ä¸­é™¤äº†ç¤¾åŒºçš„è´¡çŒ®è€…ï¼ˆäººç±»ï¼‰ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›è‡ªåŠ¨åŒ–çš„æœºå™¨äººï¼Œä»–ä»¬ä¼šåœ¨ä»£ç åº“ä¸­è‡ªåŠ¨åŒ–çš„é€šè¿‡æŒç»­é›†æˆï¼ˆCIï¼‰çš„æ–¹å¼è¿è¡Œä¸€äº›è‡ªåŠ¨åŒ–çš„å®¡æŸ¥å·¥ä½œï¼Œå¯èƒ½åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š CLAï¼šContributor License Agreementï¼ˆè´¡çŒ®è€…è®¸å¯åè®®ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªè¦ PR ä½œè€…åœ¨é¦–æ¬¡æäº¤ä»£ç åˆ°é¡¹ç›®æ—¶ç­¾ç½²çš„åè®®ï¼Œå› ä¸ºä»£ç å°†è¢«æäº¤åˆ°å…¬å…±ç©ºé—´ï¼Œè¿™ä»½åè®®çš„ç­¾ç½²æ„å‘³ç€ä½œè€…åŒæ„ä»£ç è¢«åˆ†äº«ã€å¤ç”¨ã€ä¿®æ”¹è¿™ä»¶äº‹æƒ…ã€‚ lintï¼šä»£ç é£æ ¼æ£€æŸ¥ï¼Œè¿™ä¹Ÿæ˜¯æœ€å¸¸è§çš„ CI ä»»åŠ¡ testï¼šå„ç§å±‚é¢çš„æµ‹è¯•æ£€æŸ¥ä»»åŠ¡ é€šå¸¸æ¥è¯´ï¼Œè¿™äº›æ‰€æœ‰çš„è‡ªåŠ¨åŒ–å®¡æŸ¥æœºå™¨äººæ‰€ä»£è¡¨çš„ä»»åŠ¡ä¹Ÿéœ€è¦å…¨éƒ½é€šè¿‡ï¼Œä»£ç çš„çŠ¶æ€æ‰èƒ½è¢«è®¤ä¸ºæ˜¯å¯ä»¥åˆå¹¶çš„ï¼Œè€Œä¸å‡ºæ„å¤–ï¼Œæˆ‘é¦–æ¬¡æäº¤çš„ä»£ç æœç„¶æœ‰æµ‹è¯•çš„å¤±è´¥ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:5:1","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#æäº¤åˆ°è‡ªå·±è¿œç¨‹çš„åˆ†æ”¯"},{"categories":["Nebula Graph"],"content":" 5.1 æäº¤åˆ°ä¸ªäººè¿œç¨‹åˆ†æ”¯è¿™ä¸€æ­¥éª¤é‡Œï¼Œæˆ‘ä»¬è¦æŠŠå½“å‰çš„æœ¬åœ°æäº¤çš„ commitï¼Œæäº¤åˆ°è‡ªå·±çš„ GitHub åˆ†å‰ä¹‹ä¸­ã€‚ 5.1.1 commit æœ¬åœ°ä¿®æ”¹é¦–å…ˆï¼Œæˆ‘ä»¬ç¡®è®¤ä¸€ä¸‹æœ¬åœ°çš„ä¿®æ”¹æ˜¯å¦éƒ½æ˜¯æœŸå¾…ä¸­çš„ï¼š # å…ˆç¡®å®šä¿®æ”¹çš„æ–‡ä»¶ $ git status # å†çœ‹çœ‹ä¿®æ”¹çš„å†…å®¹ $ git diff ç„¶åï¼ŒæŠŠå®ƒä»¬ commitï¼ˆæäº¤åœ¨æœ¬åœ°ä»“åº“ï¼‰ # æ·»åŠ æ‰€æœ‰å½“å‰ç›®å½•ï¼ˆ. è¿™ä¸ªç‚¹è¡¨ç¤ºå½“å‰ç›®å½•ï¼‰ä¿®æ”¹è¿‡çš„æ–‡ä»¶ä¸ºå¾… commit $ git add . # ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹çŠ¶æ€ï¼Œè¿™äº›ä¿®æ”¹çš„æ–‡ä»¶çŠ¶æ€å·²ç»ä¸åŒäº† $ git status # æœ€åï¼Œæäº¤åœ¨æœ¬åœ°ä»“åº“ï¼Œå¹¶ç”¨ -m å‚æ•°æŒ‡å®šå•è¡Œçš„ commit message $ git commit -m \"feat: introduce function JSON_EXTRACT\" 5.1.2 æäº¤åˆ°è‡ªå·±è¿œç¨‹çš„åˆ†æ”¯åœ¨æäº¤ä¹‹å‰ï¼Œè¦ç¡®ä¿è‡ªå·±çš„ GitHub è´¦å·ä¹‹ä¸‹ç¡®å®å­˜åœ¨ NebulaGraph ä»£ç ä»“åº“çš„åˆ†å‰ï¼ˆforkï¼‰ï¼Œæ¯”å¦‚æˆ‘çš„ GitHub è´¦å·æ˜¯ wey-guï¼Œæˆ‘è®¿é—®ï¼Œé‚£ä¹ˆæˆ‘å¯¹ https://github.com/vesoft-inc/nebula çš„åˆ†å‰åº”è¯¥å°±æ˜¯ https://github.com/wey-gu/nebula ã€‚ å¦‚æœè¿˜æ²¡æœ‰è‡ªå·±çš„åˆ†å‰ï¼Œå¯ä»¥ç›´æ¥åœ¨ https://github.com/vesoft-inc/nebula ä¸Šç‚¹å‡»å³ä¸Šè§’çš„ Forkï¼Œåˆ›å»ºè‡ªå·±çš„åˆ†å‰ä»“åº“ã€‚ å½“è¿œç¨‹çš„ä¸ªäººåˆ†å‰å­˜åœ¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä»£ç æäº¤ä¸Šå»äº† # æ·»åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“å« wey git remote add wey git@github.com:wey-gu/nebula.git # æäº¤ JSON_EXTRACT åˆ†æ”¯åˆ° wey è¿™ä¸ª remote ä»“åº“ git push wey JSON_EXTRACT 5.1.3 åœ¨ä¸ªäººè¿œç¨‹åˆ†å‰åˆ†æ”¯ä¸Šåˆ›å»º PRè¿™æ—¶å€™ï¼Œæˆ‘ä»¬è®¿é—®è¿™ä¸ªè¿œç¨‹åˆ†æ”¯ï¼šhttps://github.com/wey-gu/nebula/tree/fn_JSON_EXTRACT ï¼Œå°±èƒ½æ‰¾åˆ° Open PR çš„å…¥å£ï¼š ç„¶åç‚¹å‡» Open pull request æŒ‰é’®ï¼Œå°±è¿›å…¥åˆ°åˆ›å»º PR çš„ç•Œé¢äº†ï¼Œè¿™å’Œåœ¨ä¸€èˆ¬çš„è®ºå›é‡Œæäº¤ä¸€ä¸ªå¸–å­æ˜¯å¾ˆç±»ä¼¼çš„ï¼š æäº¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç­‰å¾…ã€æˆ–è€…é‚€è¯·å…¶ä»–äººæ¥åšä»£ç çš„å®¡æŸ¥ï¼ˆreviewï¼‰ï¼Œå¾€å¾€å…¶ä»–çš„è´¡çŒ®è€…éƒ½èƒ½ä»ä»–ä»¬çš„è§’åº¦ç»™å‡ºä¸€äº›ä»£ç ä¿®æ”¹çš„å»ºè®®å’Œæç¤ºï¼Œæˆ‘ä»¬éœ€è¦ç»è¿‡å‡ è½®çš„ä»£ç ä¿®æ”¹ã€è®¨è®ºä¹‹åä½¿å¾—ä»£ç è¾¾åˆ°æœ€ä½³çš„çŠ¶æ€ã€‚ è€Œè¿™äº›å®¡æŸ¥è€…ä¸­é™¤äº†ç¤¾åŒºçš„è´¡çŒ®è€…ï¼ˆäººç±»ï¼‰ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›è‡ªåŠ¨åŒ–çš„æœºå™¨äººï¼Œä»–ä»¬ä¼šåœ¨ä»£ç åº“ä¸­è‡ªåŠ¨åŒ–çš„é€šè¿‡æŒç»­é›†æˆï¼ˆCIï¼‰çš„æ–¹å¼è¿è¡Œä¸€äº›è‡ªåŠ¨åŒ–çš„å®¡æŸ¥å·¥ä½œï¼Œå¯èƒ½åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š CLAï¼šContributor License Agreementï¼ˆè´¡çŒ®è€…è®¸å¯åè®®ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªè¦ PR ä½œè€…åœ¨é¦–æ¬¡æäº¤ä»£ç åˆ°é¡¹ç›®æ—¶ç­¾ç½²çš„åè®®ï¼Œå› ä¸ºä»£ç å°†è¢«æäº¤åˆ°å…¬å…±ç©ºé—´ï¼Œè¿™ä»½åè®®çš„ç­¾ç½²æ„å‘³ç€ä½œè€…åŒæ„ä»£ç è¢«åˆ†äº«ã€å¤ç”¨ã€ä¿®æ”¹è¿™ä»¶äº‹æƒ…ã€‚ lintï¼šä»£ç é£æ ¼æ£€æŸ¥ï¼Œè¿™ä¹Ÿæ˜¯æœ€å¸¸è§çš„ CI ä»»åŠ¡ testï¼šå„ç§å±‚é¢çš„æµ‹è¯•æ£€æŸ¥ä»»åŠ¡ é€šå¸¸æ¥è¯´ï¼Œè¿™äº›æ‰€æœ‰çš„è‡ªåŠ¨åŒ–å®¡æŸ¥æœºå™¨äººæ‰€ä»£è¡¨çš„ä»»åŠ¡ä¹Ÿéœ€è¦å…¨éƒ½é€šè¿‡ï¼Œä»£ç çš„çŠ¶æ€æ‰èƒ½è¢«è®¤ä¸ºæ˜¯å¯ä»¥åˆå¹¶çš„ï¼Œè€Œä¸å‡ºæ„å¤–ï¼Œæˆ‘é¦–æ¬¡æäº¤çš„ä»£ç æœç„¶æœ‰æµ‹è¯•çš„å¤±è´¥ã€‚ ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:5:1","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#åœ¨ä¸ªäººè¿œç¨‹åˆ†å‰åˆ†æ”¯ä¸Šåˆ›å»º-pr"},{"categories":["Nebula Graph"],"content":" 5.2 è°ƒè¯• CI æµ‹è¯•ä»£ç NebulaGraph é‡Œæ‰€æœ‰çš„ CI æµ‹è¯•ä»£ç ä¹Ÿéƒ½èƒ½åœ¨æœ¬åœ°è¢«è§¦å‘ï¼Œå¹¶ä¸”ï¼ˆæ˜¾ç„¶ï¼‰éƒ½æœ‰è¢«å•ç‹¬è§¦å‘çš„æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦æŒæ¡å®ƒä»¬è€Œä¸æ˜¯åœ¨æ¯æ¬¡ä¿®æ”¹ä¸€ä¸ªå°çš„æµ‹è¯•ä¿®å¤ä¹‹åæäº¤åˆ°æœåŠ¡å™¨ä¸Šç­‰ç€ CI åšå…¨é‡çš„è¿è¡Œï¼ˆè¿™æ ·å¸¸å¸¸å‡ ååˆ†é’Ÿå°±è¿™ä¹ˆæµªè´¹æ‰äº†ï¼‰ã€‚ 5.2.1 CTeståœ¨è¿™ä¸ªè·ç¦»çš„ PR æäº¤ä¸­ï¼Œæˆ‘ä¿®æ”¹çš„å‡½æ•°ä»£ç åŒä¸€å±‚çº§ä¸‹çš„å•å…ƒæµ‹è¯• CTest å°±æœ‰é—®é¢˜ï¼Œé—®é¢˜å¯èƒ½æ˜¯æµ‹è¯•ä»£ç æœ¬èº«é€ æˆã€æˆ‘ä»¬çš„ä¿®æ”¹ç ´åäº†åŸæ¥çš„æµ‹è¯•ç”¨ä¾‹å¯¼è‡´ã€äº¦æˆ–è€…æ˜¯æˆ‘ä»¬è‡ªå·±çš„æµ‹è¯•ç”¨ä¾‹å‘ç°äº†ä»£ç ä¿®æ”¹æœ¬èº«çš„é—®é¢˜ã€‚ è¿™æ¬¡ï¼Œæˆ‘ä»¬è¦æ ¹æ® CTest å¤±è´¥çš„æŠ¥é”™è¿›è¡Œæ’æŸ¥å’Œä»£ç ä¿®æ”¹ï¼Œç„¶åç¼–è¯‘ä»£ç ï¼Œåœ¨æœ¬åœ°è¿è¡Œä¸€ä¸‹è¿™ä¸ªå¤±è´¥çš„ç”¨ä¾‹ï¼š # æˆ‘ä»¬éœ€è¦è¿›å…¥åˆ°æˆ‘ä»¬çš„ç¼–è¯‘å®¹å™¨å†…éƒ¨çš„ build ç›®å½•ä¸‹ $ docker exec -ti nebula_dev bash $ cd build # åœ¨ -DENABLE_TESTING=ON ä¹‹ä¸­ç¼–è¯‘ï¼Œå¦‚æœä¹‹å‰çš„ç¼–è¯‘ job æ•°ä¸‹å†…å­˜å·²ç»è·‘æ»¡äº†çš„è¯ï¼Œè¿™æ¬¡å¯ä»¥æŠŠ job æ•°è°ƒå°ä¸€ç‚¹ï¼Œå› ä¸ºå¼€å¯æµ‹è¯•ä¼šå ç”¨æ›´å¤šå†…å­˜ $ cmake -DCMAKE_CXX_COMPILER=$TOOLSET_CLANG_DIR/bin/g++ -DCMAKE_C_COMPILER=$TOOLSET_CLANG_DIR/bin/gcc -DENABLE_WERROR=OFF -DCMAKE_BUILD_TYPE=Debug -DENABLE_TESTING=ON .. $ make -j 48 # å¯ä»¥çœ‹åˆ°ç¼–è¯‘æˆåŠŸäº† CTest çš„å•å…ƒæµ‹è¯•äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ # [100%] Linking CXX executable ../../../../bin/test/function_manager_test # [100%] Built target function_manager_test # æ‰§è¡Œé‡æ–°ä¿®æ”¹è¿‡çš„å•å…ƒæµ‹è¯•ï¼ $ bin/test/function_manager_test [==========] Running 11 tests from 1 test suite. [----------] Global test environment set-up. [----------] 11 tests from FunctionManagerTest [ RUN ] FunctionManagerTest.testNull [ OK ] FunctionManagerTest.testNull (0 ms) [ RUN ] FunctionManagerTest.functionCall W20221020 23:35:18.579897 28679 Map.cpp:77] JSON_EXTRACT nested layer 1: Map can be populated only by Bool, Double, Int, String value and null, now trying to parse from: object [ OK ] FunctionManagerTest.functionCall (2 ms) [ RUN ] FunctionManagerTest.time [ OK ] FunctionManagerTest.time (0 ms) [ RUN ] FunctionManagerTest.returnType [ OK ] FunctionManagerTest.returnType (0 ms) [ RUN ] FunctionManagerTest.SchemaRelated [ OK ] FunctionManagerTest.SchemaRelated (0 ms) [ RUN ] FunctionManagerTest.ScalarFunctionTest [ OK ] FunctionManagerTest.ScalarFunctionTest (0 ms) [ RUN ] FunctionManagerTest.ListFunctionTest [ OK ] FunctionManagerTest.ListFunctionTest (0 ms) [ RUN ] FunctionManagerTest.duplicateEdgesORVerticesInPath [ OK ] FunctionManagerTest.duplicateEdgesORVerticesInPath (0 ms) [ RUN ] FunctionManagerTest.ReversePath [ OK ] FunctionManagerTest.ReversePath (0 ms) [ RUN ] FunctionManagerTest.DataSetRowCol [ OK ] FunctionManagerTest.DataSetRowCol (0 ms) [ RUN ] FunctionManagerTest.PurityTest [ OK ] FunctionManagerTest.PurityTest (0 ms) [----------] 11 tests from FunctionManagerTest (5 ms total) [----------] Global test environment tear-down [==========] 11 tests from 1 test suite ran. (5 ms total) [ PASSED ] 11 tests. æˆåŠŸï¼ äºæ˜¯ï¼Œæˆ‘æŠŠæ–°çš„æ›´æ”¹æäº¤åˆ°è¿œç¨‹åˆ†æ”¯ä¸Šï¼Œåœ¨ PR çš„ç½‘é¡µä¸­ï¼Œå¯ä»¥çœ‹åˆ° CI å·²ç»åœ¨æ–°çš„æäº¤çš„è§¦å‘ä¸‹é‡æ–°ç¼–è¯‘ã€æ‰§è¡Œäº†ï¼Œè¿‡ä¸€ä¼šå„¿æœç„¶éƒ½ pass äº†ï¼Œäºæ˜¯æˆ‘å…´é«˜é‡‡çƒˆåœ°ç­‰å¾…ç€ä¸¤ä½ä»¥ä¸Šçš„å®¡æŸ¥è€…å¸®å¿™æ‰¹å‡†ä»£ç ï¼Œç„¶ååˆå¹¶å®ƒï¼ ä½†æ˜¯ï¼Œæˆ‘æ”¶åˆ°äº†æ–°çš„å»ºè®®ï¼š å¦ä¸€ä½è´¡çŒ®è€…è¯·æˆ‘æ·»åŠ  TCK çš„æµ‹è¯•ç”¨ä¾‹ã€‚ 5.2.2 TCKTCK çš„å…¨ç§°æ˜¯ The Cypher Technology Compatibility Kitï¼Œå®ƒæ˜¯ NebulaGraph ä» OpenCypher ç¤¾åŒºç»§æ‰¿æ¼”è¿›è€Œæ¥çš„ä¸€å¥—æµ‹è¯•æ¡†æ¶ï¼Œæˆ‘ä»¬ç”¨ Python åšäº†æµ‹è¯•ç”¨ä¾‹æ ¼å¼å…¼å®¹çš„å®ç°ã€‚ å®ƒçš„ä¼˜é›…åœ¨äºï¼Œæˆ‘ä»¬å¯ä»¥åƒå†™è‹±è¯­ä¸€æ ·å»æè¿°æˆ‘ä»¬æƒ³å®ç°çš„ç«¯åˆ°ç«¯åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹ï¼Œåƒè¿™æ ·ï¼ # tests/tck/features/function/json_extract.feature Feature: json_extract Function Background: Test json_extract function Scenario: Test Positive Cases When executing query: \"\"\" YIELD JSON_EXTRACT('{\"a\": \"foo\", \"b\": 0.2, \"c\": true}') AS result; \"\"\" Then the result should be, in any order: | result | | {a: \"foo\", b: 0.2, c: true} | When executing query: \"\"\" YIELD JSON_EXTRACT('{\"a\": 1, \"b\": {}, \"c\": {\"d\": true}}') AS result; \"\"\" Then the result should be, in any order: | result | | {a: 1, b: {}, c: {d: true}} | When executing query: \"\"\" YIELD JSON_EXTRACT('{}') AS result; \"\"\" Then the result should be, in any order: | result | | {} | åœ¨æ·»åŠ äº†è‡ªå·±çš„ä¸€ä¸ªæ–°çš„ tck æµ‹è¯•ç”¨ä¾‹æ–‡æœ¬æ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æµ‹è¯•æ–‡ä»¶ä¸­ä¸´æ—¶å¢åŠ æ ‡ç­¾ï¼Œå¹¶åœ¨æ‰§è¡Œçš„æ—¶å€™æŒ‡å®šæ ‡ç­¾ï¼Œå°±å¯ä»¥å•ç‹¬æ‰§è¡Œæ–°å¢çš„ tck æµ‹è¯•ç”¨ä¾‹äº†ï¼š # è¿˜æ˜¯åœ¨ç¼–è¯‘å®¹å™¨å†…éƒ¨ï¼Œè¿›å…¥åˆ° tests ç›®å½•ä¸‹ cd ../tests # å®‰è£… tck æµ‹è¯•æ‰€éœ€ä¾èµ– python3 -m pip install -r requirements.txt python3 -m pip install nebula3-python==3.1.0 # è¿è¡Œä¸€ä¸ªå•ç‹¬ä¸º tck æµ‹è¯•å‡†å¤‡çš„é›†ç¾¤ make CONTAINERIZED=true ENABLE_SSL=true CA_SIGNED=true up # ç»™ tests/tck/features/function/json_extract.feature ä»¥@å¼€å¤´ç¬¬ä¸€è¡ŒåŠ ä¸Šæ ‡ç­¾ï¼Œæ¯”å¦‚ @wey vi tests/tck/features/function/json_extract.feature # æ‰§è¡Œ pytest (åŒ…å« tck ç”¨ä¾‹)ï¼Œå› ä¸ºåˆ¶å®šäº† -m \"wey\"ï¼Œåªæœ‰ tests/tck/features/function/json_extract.feature ä¼šè¢«æ‰§è¡Œ python3 -m pytest -m \"wey\" # å…³é—­ pytest æ‰€ä¾èµ–çš„é›†ç¾¤ make CONTAINERIZED=true ENABLE_SSL=true CA_SIGNED=true down å»¶ä¼¸é˜…è¯»ï¼š åŸºäº BDD ç†è®ºçš„ Nebula é›†æˆæµ‹è¯•æ¡†æ¶é‡æ„ï¼Œhttps://nebula-graph.com.cn/posts/bdd-testing-pract","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:5:2","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#è°ƒè¯•-ci-æµ‹è¯•ä»£ç "},{"categories":["Nebula Graph"],"content":" 5.2 è°ƒè¯• CI æµ‹è¯•ä»£ç NebulaGraph é‡Œæ‰€æœ‰çš„ CI æµ‹è¯•ä»£ç ä¹Ÿéƒ½èƒ½åœ¨æœ¬åœ°è¢«è§¦å‘ï¼Œå¹¶ä¸”ï¼ˆæ˜¾ç„¶ï¼‰éƒ½æœ‰è¢«å•ç‹¬è§¦å‘çš„æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦æŒæ¡å®ƒä»¬è€Œä¸æ˜¯åœ¨æ¯æ¬¡ä¿®æ”¹ä¸€ä¸ªå°çš„æµ‹è¯•ä¿®å¤ä¹‹åæäº¤åˆ°æœåŠ¡å™¨ä¸Šç­‰ç€ CI åšå…¨é‡çš„è¿è¡Œï¼ˆè¿™æ ·å¸¸å¸¸å‡ ååˆ†é’Ÿå°±è¿™ä¹ˆæµªè´¹æ‰äº†ï¼‰ã€‚ 5.2.1 CTeståœ¨è¿™ä¸ªè·ç¦»çš„ PR æäº¤ä¸­ï¼Œæˆ‘ä¿®æ”¹çš„å‡½æ•°ä»£ç åŒä¸€å±‚çº§ä¸‹çš„å•å…ƒæµ‹è¯• CTest å°±æœ‰é—®é¢˜ï¼Œé—®é¢˜å¯èƒ½æ˜¯æµ‹è¯•ä»£ç æœ¬èº«é€ æˆã€æˆ‘ä»¬çš„ä¿®æ”¹ç ´åäº†åŸæ¥çš„æµ‹è¯•ç”¨ä¾‹å¯¼è‡´ã€äº¦æˆ–è€…æ˜¯æˆ‘ä»¬è‡ªå·±çš„æµ‹è¯•ç”¨ä¾‹å‘ç°äº†ä»£ç ä¿®æ”¹æœ¬èº«çš„é—®é¢˜ã€‚ è¿™æ¬¡ï¼Œæˆ‘ä»¬è¦æ ¹æ® CTest å¤±è´¥çš„æŠ¥é”™è¿›è¡Œæ’æŸ¥å’Œä»£ç ä¿®æ”¹ï¼Œç„¶åç¼–è¯‘ä»£ç ï¼Œåœ¨æœ¬åœ°è¿è¡Œä¸€ä¸‹è¿™ä¸ªå¤±è´¥çš„ç”¨ä¾‹ï¼š # æˆ‘ä»¬éœ€è¦è¿›å…¥åˆ°æˆ‘ä»¬çš„ç¼–è¯‘å®¹å™¨å†…éƒ¨çš„ build ç›®å½•ä¸‹ $ docker exec -ti nebula_dev bash $ cd build # åœ¨ -DENABLE_TESTING=ON ä¹‹ä¸­ç¼–è¯‘ï¼Œå¦‚æœä¹‹å‰çš„ç¼–è¯‘ job æ•°ä¸‹å†…å­˜å·²ç»è·‘æ»¡äº†çš„è¯ï¼Œè¿™æ¬¡å¯ä»¥æŠŠ job æ•°è°ƒå°ä¸€ç‚¹ï¼Œå› ä¸ºå¼€å¯æµ‹è¯•ä¼šå ç”¨æ›´å¤šå†…å­˜ $ cmake -DCMAKE_CXX_COMPILER=$TOOLSET_CLANG_DIR/bin/g++ -DCMAKE_C_COMPILER=$TOOLSET_CLANG_DIR/bin/gcc -DENABLE_WERROR=OFF -DCMAKE_BUILD_TYPE=Debug -DENABLE_TESTING=ON .. $ make -j 48 # å¯ä»¥çœ‹åˆ°ç¼–è¯‘æˆåŠŸäº† CTest çš„å•å…ƒæµ‹è¯•äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ # [100%] Linking CXX executable ../../../../bin/test/function_manager_test # [100%] Built target function_manager_test # æ‰§è¡Œé‡æ–°ä¿®æ”¹è¿‡çš„å•å…ƒæµ‹è¯•ï¼ $ bin/test/function_manager_test [==========] Running 11 tests from 1 test suite. [----------] Global test environment set-up. [----------] 11 tests from FunctionManagerTest [ RUN ] FunctionManagerTest.testNull [ OK ] FunctionManagerTest.testNull (0 ms) [ RUN ] FunctionManagerTest.functionCall W20221020 23:35:18.579897 28679 Map.cpp:77] JSON_EXTRACT nested layer 1: Map can be populated only by Bool, Double, Int, String value and null, now trying to parse from: object [ OK ] FunctionManagerTest.functionCall (2 ms) [ RUN ] FunctionManagerTest.time [ OK ] FunctionManagerTest.time (0 ms) [ RUN ] FunctionManagerTest.returnType [ OK ] FunctionManagerTest.returnType (0 ms) [ RUN ] FunctionManagerTest.SchemaRelated [ OK ] FunctionManagerTest.SchemaRelated (0 ms) [ RUN ] FunctionManagerTest.ScalarFunctionTest [ OK ] FunctionManagerTest.ScalarFunctionTest (0 ms) [ RUN ] FunctionManagerTest.ListFunctionTest [ OK ] FunctionManagerTest.ListFunctionTest (0 ms) [ RUN ] FunctionManagerTest.duplicateEdgesORVerticesInPath [ OK ] FunctionManagerTest.duplicateEdgesORVerticesInPath (0 ms) [ RUN ] FunctionManagerTest.ReversePath [ OK ] FunctionManagerTest.ReversePath (0 ms) [ RUN ] FunctionManagerTest.DataSetRowCol [ OK ] FunctionManagerTest.DataSetRowCol (0 ms) [ RUN ] FunctionManagerTest.PurityTest [ OK ] FunctionManagerTest.PurityTest (0 ms) [----------] 11 tests from FunctionManagerTest (5 ms total) [----------] Global test environment tear-down [==========] 11 tests from 1 test suite ran. (5 ms total) [ PASSED ] 11 tests. æˆåŠŸï¼ äºæ˜¯ï¼Œæˆ‘æŠŠæ–°çš„æ›´æ”¹æäº¤åˆ°è¿œç¨‹åˆ†æ”¯ä¸Šï¼Œåœ¨ PR çš„ç½‘é¡µä¸­ï¼Œå¯ä»¥çœ‹åˆ° CI å·²ç»åœ¨æ–°çš„æäº¤çš„è§¦å‘ä¸‹é‡æ–°ç¼–è¯‘ã€æ‰§è¡Œäº†ï¼Œè¿‡ä¸€ä¼šå„¿æœç„¶éƒ½ pass äº†ï¼Œäºæ˜¯æˆ‘å…´é«˜é‡‡çƒˆåœ°ç­‰å¾…ç€ä¸¤ä½ä»¥ä¸Šçš„å®¡æŸ¥è€…å¸®å¿™æ‰¹å‡†ä»£ç ï¼Œç„¶ååˆå¹¶å®ƒï¼ ä½†æ˜¯ï¼Œæˆ‘æ”¶åˆ°äº†æ–°çš„å»ºè®®ï¼š å¦ä¸€ä½è´¡çŒ®è€…è¯·æˆ‘æ·»åŠ  TCK çš„æµ‹è¯•ç”¨ä¾‹ã€‚ 5.2.2 TCKTCK çš„å…¨ç§°æ˜¯ The Cypher Technology Compatibility Kitï¼Œå®ƒæ˜¯ NebulaGraph ä» OpenCypher ç¤¾åŒºç»§æ‰¿æ¼”è¿›è€Œæ¥çš„ä¸€å¥—æµ‹è¯•æ¡†æ¶ï¼Œæˆ‘ä»¬ç”¨ Python åšäº†æµ‹è¯•ç”¨ä¾‹æ ¼å¼å…¼å®¹çš„å®ç°ã€‚ å®ƒçš„ä¼˜é›…åœ¨äºï¼Œæˆ‘ä»¬å¯ä»¥åƒå†™è‹±è¯­ä¸€æ ·å»æè¿°æˆ‘ä»¬æƒ³å®ç°çš„ç«¯åˆ°ç«¯åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹ï¼Œåƒè¿™æ ·ï¼ # tests/tck/features/function/json_extract.feature Feature: json_extract Function Background: Test json_extract function Scenario: Test Positive Cases When executing query: \"\"\" YIELD JSON_EXTRACT('{\"a\": \"foo\", \"b\": 0.2, \"c\": true}') AS result; \"\"\" Then the result should be, in any order: | result | | {a: \"foo\", b: 0.2, c: true} | When executing query: \"\"\" YIELD JSON_EXTRACT('{\"a\": 1, \"b\": {}, \"c\": {\"d\": true}}') AS result; \"\"\" Then the result should be, in any order: | result | | {a: 1, b: {}, c: {d: true}} | When executing query: \"\"\" YIELD JSON_EXTRACT('{}') AS result; \"\"\" Then the result should be, in any order: | result | | {} | åœ¨æ·»åŠ äº†è‡ªå·±çš„ä¸€ä¸ªæ–°çš„ tck æµ‹è¯•ç”¨ä¾‹æ–‡æœ¬æ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æµ‹è¯•æ–‡ä»¶ä¸­ä¸´æ—¶å¢åŠ æ ‡ç­¾ï¼Œå¹¶åœ¨æ‰§è¡Œçš„æ—¶å€™æŒ‡å®šæ ‡ç­¾ï¼Œå°±å¯ä»¥å•ç‹¬æ‰§è¡Œæ–°å¢çš„ tck æµ‹è¯•ç”¨ä¾‹äº†ï¼š # è¿˜æ˜¯åœ¨ç¼–è¯‘å®¹å™¨å†…éƒ¨ï¼Œè¿›å…¥åˆ° tests ç›®å½•ä¸‹ cd ../tests # å®‰è£… tck æµ‹è¯•æ‰€éœ€ä¾èµ– python3 -m pip install -r requirements.txt python3 -m pip install nebula3-python==3.1.0 # è¿è¡Œä¸€ä¸ªå•ç‹¬ä¸º tck æµ‹è¯•å‡†å¤‡çš„é›†ç¾¤ make CONTAINERIZED=true ENABLE_SSL=true CA_SIGNED=true up # ç»™ tests/tck/features/function/json_extract.feature ä»¥@å¼€å¤´ç¬¬ä¸€è¡ŒåŠ ä¸Šæ ‡ç­¾ï¼Œæ¯”å¦‚ @wey vi tests/tck/features/function/json_extract.feature # æ‰§è¡Œ pytest (åŒ…å« tck ç”¨ä¾‹)ï¼Œå› ä¸ºåˆ¶å®šäº† -m \"wey\"ï¼Œåªæœ‰ tests/tck/features/function/json_extract.feature ä¼šè¢«æ‰§è¡Œ python3 -m pytest -m \"wey\" # å…³é—­ pytest æ‰€ä¾èµ–çš„é›†ç¾¤ make CONTAINERIZED=true ENABLE_SSL=true CA_SIGNED=true down å»¶ä¼¸é˜…è¯»ï¼š åŸºäº BDD ç†è®ºçš„ Nebula é›†æˆæµ‹è¯•æ¡†æ¶é‡æ„ï¼Œhttps://nebula-graph.com.cn/posts/bdd-testing-pract","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:5:2","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#ctest"},{"categories":["Nebula Graph"],"content":" 5.2 è°ƒè¯• CI æµ‹è¯•ä»£ç NebulaGraph é‡Œæ‰€æœ‰çš„ CI æµ‹è¯•ä»£ç ä¹Ÿéƒ½èƒ½åœ¨æœ¬åœ°è¢«è§¦å‘ï¼Œå¹¶ä¸”ï¼ˆæ˜¾ç„¶ï¼‰éƒ½æœ‰è¢«å•ç‹¬è§¦å‘çš„æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦æŒæ¡å®ƒä»¬è€Œä¸æ˜¯åœ¨æ¯æ¬¡ä¿®æ”¹ä¸€ä¸ªå°çš„æµ‹è¯•ä¿®å¤ä¹‹åæäº¤åˆ°æœåŠ¡å™¨ä¸Šç­‰ç€ CI åšå…¨é‡çš„è¿è¡Œï¼ˆè¿™æ ·å¸¸å¸¸å‡ ååˆ†é’Ÿå°±è¿™ä¹ˆæµªè´¹æ‰äº†ï¼‰ã€‚ 5.2.1 CTeståœ¨è¿™ä¸ªè·ç¦»çš„ PR æäº¤ä¸­ï¼Œæˆ‘ä¿®æ”¹çš„å‡½æ•°ä»£ç åŒä¸€å±‚çº§ä¸‹çš„å•å…ƒæµ‹è¯• CTest å°±æœ‰é—®é¢˜ï¼Œé—®é¢˜å¯èƒ½æ˜¯æµ‹è¯•ä»£ç æœ¬èº«é€ æˆã€æˆ‘ä»¬çš„ä¿®æ”¹ç ´åäº†åŸæ¥çš„æµ‹è¯•ç”¨ä¾‹å¯¼è‡´ã€äº¦æˆ–è€…æ˜¯æˆ‘ä»¬è‡ªå·±çš„æµ‹è¯•ç”¨ä¾‹å‘ç°äº†ä»£ç ä¿®æ”¹æœ¬èº«çš„é—®é¢˜ã€‚ è¿™æ¬¡ï¼Œæˆ‘ä»¬è¦æ ¹æ® CTest å¤±è´¥çš„æŠ¥é”™è¿›è¡Œæ’æŸ¥å’Œä»£ç ä¿®æ”¹ï¼Œç„¶åç¼–è¯‘ä»£ç ï¼Œåœ¨æœ¬åœ°è¿è¡Œä¸€ä¸‹è¿™ä¸ªå¤±è´¥çš„ç”¨ä¾‹ï¼š # æˆ‘ä»¬éœ€è¦è¿›å…¥åˆ°æˆ‘ä»¬çš„ç¼–è¯‘å®¹å™¨å†…éƒ¨çš„ build ç›®å½•ä¸‹ $ docker exec -ti nebula_dev bash $ cd build # åœ¨ -DENABLE_TESTING=ON ä¹‹ä¸­ç¼–è¯‘ï¼Œå¦‚æœä¹‹å‰çš„ç¼–è¯‘ job æ•°ä¸‹å†…å­˜å·²ç»è·‘æ»¡äº†çš„è¯ï¼Œè¿™æ¬¡å¯ä»¥æŠŠ job æ•°è°ƒå°ä¸€ç‚¹ï¼Œå› ä¸ºå¼€å¯æµ‹è¯•ä¼šå ç”¨æ›´å¤šå†…å­˜ $ cmake -DCMAKE_CXX_COMPILER=$TOOLSET_CLANG_DIR/bin/g++ -DCMAKE_C_COMPILER=$TOOLSET_CLANG_DIR/bin/gcc -DENABLE_WERROR=OFF -DCMAKE_BUILD_TYPE=Debug -DENABLE_TESTING=ON .. $ make -j 48 # å¯ä»¥çœ‹åˆ°ç¼–è¯‘æˆåŠŸäº† CTest çš„å•å…ƒæµ‹è¯•äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ # [100%] Linking CXX executable ../../../../bin/test/function_manager_test # [100%] Built target function_manager_test # æ‰§è¡Œé‡æ–°ä¿®æ”¹è¿‡çš„å•å…ƒæµ‹è¯•ï¼ $ bin/test/function_manager_test [==========] Running 11 tests from 1 test suite. [----------] Global test environment set-up. [----------] 11 tests from FunctionManagerTest [ RUN ] FunctionManagerTest.testNull [ OK ] FunctionManagerTest.testNull (0 ms) [ RUN ] FunctionManagerTest.functionCall W20221020 23:35:18.579897 28679 Map.cpp:77] JSON_EXTRACT nested layer 1: Map can be populated only by Bool, Double, Int, String value and null, now trying to parse from: object [ OK ] FunctionManagerTest.functionCall (2 ms) [ RUN ] FunctionManagerTest.time [ OK ] FunctionManagerTest.time (0 ms) [ RUN ] FunctionManagerTest.returnType [ OK ] FunctionManagerTest.returnType (0 ms) [ RUN ] FunctionManagerTest.SchemaRelated [ OK ] FunctionManagerTest.SchemaRelated (0 ms) [ RUN ] FunctionManagerTest.ScalarFunctionTest [ OK ] FunctionManagerTest.ScalarFunctionTest (0 ms) [ RUN ] FunctionManagerTest.ListFunctionTest [ OK ] FunctionManagerTest.ListFunctionTest (0 ms) [ RUN ] FunctionManagerTest.duplicateEdgesORVerticesInPath [ OK ] FunctionManagerTest.duplicateEdgesORVerticesInPath (0 ms) [ RUN ] FunctionManagerTest.ReversePath [ OK ] FunctionManagerTest.ReversePath (0 ms) [ RUN ] FunctionManagerTest.DataSetRowCol [ OK ] FunctionManagerTest.DataSetRowCol (0 ms) [ RUN ] FunctionManagerTest.PurityTest [ OK ] FunctionManagerTest.PurityTest (0 ms) [----------] 11 tests from FunctionManagerTest (5 ms total) [----------] Global test environment tear-down [==========] 11 tests from 1 test suite ran. (5 ms total) [ PASSED ] 11 tests. æˆåŠŸï¼ äºæ˜¯ï¼Œæˆ‘æŠŠæ–°çš„æ›´æ”¹æäº¤åˆ°è¿œç¨‹åˆ†æ”¯ä¸Šï¼Œåœ¨ PR çš„ç½‘é¡µä¸­ï¼Œå¯ä»¥çœ‹åˆ° CI å·²ç»åœ¨æ–°çš„æäº¤çš„è§¦å‘ä¸‹é‡æ–°ç¼–è¯‘ã€æ‰§è¡Œäº†ï¼Œè¿‡ä¸€ä¼šå„¿æœç„¶éƒ½ pass äº†ï¼Œäºæ˜¯æˆ‘å…´é«˜é‡‡çƒˆåœ°ç­‰å¾…ç€ä¸¤ä½ä»¥ä¸Šçš„å®¡æŸ¥è€…å¸®å¿™æ‰¹å‡†ä»£ç ï¼Œç„¶ååˆå¹¶å®ƒï¼ ä½†æ˜¯ï¼Œæˆ‘æ”¶åˆ°äº†æ–°çš„å»ºè®®ï¼š å¦ä¸€ä½è´¡çŒ®è€…è¯·æˆ‘æ·»åŠ  TCK çš„æµ‹è¯•ç”¨ä¾‹ã€‚ 5.2.2 TCKTCK çš„å…¨ç§°æ˜¯ The Cypher Technology Compatibility Kitï¼Œå®ƒæ˜¯ NebulaGraph ä» OpenCypher ç¤¾åŒºç»§æ‰¿æ¼”è¿›è€Œæ¥çš„ä¸€å¥—æµ‹è¯•æ¡†æ¶ï¼Œæˆ‘ä»¬ç”¨ Python åšäº†æµ‹è¯•ç”¨ä¾‹æ ¼å¼å…¼å®¹çš„å®ç°ã€‚ å®ƒçš„ä¼˜é›…åœ¨äºï¼Œæˆ‘ä»¬å¯ä»¥åƒå†™è‹±è¯­ä¸€æ ·å»æè¿°æˆ‘ä»¬æƒ³å®ç°çš„ç«¯åˆ°ç«¯åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹ï¼Œåƒè¿™æ ·ï¼ # tests/tck/features/function/json_extract.feature Feature: json_extract Function Background: Test json_extract function Scenario: Test Positive Cases When executing query: \"\"\" YIELD JSON_EXTRACT('{\"a\": \"foo\", \"b\": 0.2, \"c\": true}') AS result; \"\"\" Then the result should be, in any order: | result | | {a: \"foo\", b: 0.2, c: true} | When executing query: \"\"\" YIELD JSON_EXTRACT('{\"a\": 1, \"b\": {}, \"c\": {\"d\": true}}') AS result; \"\"\" Then the result should be, in any order: | result | | {a: 1, b: {}, c: {d: true}} | When executing query: \"\"\" YIELD JSON_EXTRACT('{}') AS result; \"\"\" Then the result should be, in any order: | result | | {} | åœ¨æ·»åŠ äº†è‡ªå·±çš„ä¸€ä¸ªæ–°çš„ tck æµ‹è¯•ç”¨ä¾‹æ–‡æœ¬æ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æµ‹è¯•æ–‡ä»¶ä¸­ä¸´æ—¶å¢åŠ æ ‡ç­¾ï¼Œå¹¶åœ¨æ‰§è¡Œçš„æ—¶å€™æŒ‡å®šæ ‡ç­¾ï¼Œå°±å¯ä»¥å•ç‹¬æ‰§è¡Œæ–°å¢çš„ tck æµ‹è¯•ç”¨ä¾‹äº†ï¼š # è¿˜æ˜¯åœ¨ç¼–è¯‘å®¹å™¨å†…éƒ¨ï¼Œè¿›å…¥åˆ° tests ç›®å½•ä¸‹ cd ../tests # å®‰è£… tck æµ‹è¯•æ‰€éœ€ä¾èµ– python3 -m pip install -r requirements.txt python3 -m pip install nebula3-python==3.1.0 # è¿è¡Œä¸€ä¸ªå•ç‹¬ä¸º tck æµ‹è¯•å‡†å¤‡çš„é›†ç¾¤ make CONTAINERIZED=true ENABLE_SSL=true CA_SIGNED=true up # ç»™ tests/tck/features/function/json_extract.feature ä»¥@å¼€å¤´ç¬¬ä¸€è¡ŒåŠ ä¸Šæ ‡ç­¾ï¼Œæ¯”å¦‚ @wey vi tests/tck/features/function/json_extract.feature # æ‰§è¡Œ pytest (åŒ…å« tck ç”¨ä¾‹)ï¼Œå› ä¸ºåˆ¶å®šäº† -m \"wey\"ï¼Œåªæœ‰ tests/tck/features/function/json_extract.feature ä¼šè¢«æ‰§è¡Œ python3 -m pytest -m \"wey\" # å…³é—­ pytest æ‰€ä¾èµ–çš„é›†ç¾¤ make CONTAINERIZED=true ENABLE_SSL=true CA_SIGNED=true down å»¶ä¼¸é˜…è¯»ï¼š åŸºäº BDD ç†è®ºçš„ Nebula é›†æˆæµ‹è¯•æ¡†æ¶é‡æ„ï¼Œhttps://nebula-graph.com.cn/posts/bdd-testing-pract","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:5:2","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#tck"},{"categories":["Nebula Graph"],"content":" 5.3 é‚€è¯·å†æ¬¡ reviewå¾…æˆ‘ä»¬æŠŠéœ€è¦çš„æµ‹è¯•è°ƒé€šã€å†æ¬¡æäº¤ PR å¹¶ä¸” CI ç”¨ä¾‹å…¨éƒ½é€šè¿‡ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡é‚€è¯·ä¹‹å‰å¸®åŠ©å®¡æŸ¥ä»£ç çš„åŒå­¦åšåšæœ€åçš„æŸ¥çœ‹ï¼Œå¦‚æœä¸€åˆ‡éƒ½é¡ºåˆ©ï¼Œä»£ç å°±ä¼šè¢«åˆå¹¶äº†ï¼ é¢˜å›¾æ¥è‡ª Jon ","date":"2022-10-23","objectID":"/nebulagraph-hacking-guide/:5:3","series":null,"tags":["NebulaGraph","contributing","open-source","å¼€å‘æŒ‡å—"],"title":"NebulaGraph å†…æ ¸è´¡çŒ®å¼€å‘æŒ‡å—","uri":"/nebulagraph-hacking-guide/#é‚€è¯·å†æ¬¡-review"},{"categories":["Nebula Graph"],"content":"æœ¬æ–‡æ—¨åœ¨å¸®åŠ© NebulaGraph æ–°æ‰‹å¿«é€Ÿäº†è§£æŸ¥è¯¢è¯­å¥è°ƒä¼˜ï¼Œè¯»æ‡‚æŸ¥è¯¢è®¡åˆ’ã€‚","date":"2022-09-06","objectID":"/ngql-execution-plan/","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/"},{"categories":["Nebula Graph"],"content":" æœ¬æ–‡æ—¨åœ¨å¸®åŠ© NebulaGraph æ–°æ‰‹å¿«é€Ÿäº†è§£æŸ¥è¯¢è¯­å¥è°ƒä¼˜ï¼Œè¯»æ‡‚æŸ¥è¯¢è®¡åˆ’ã€‚ å¾ˆé•¿æ—¶é—´ä»¥æ¥ï¼ŒNebulaGraph ç¤¾åŒºé‡Œæœ€çƒ­é—¨ä¹‹ä¸€çš„è¯é¢˜éƒ½æ˜¯â€œæˆ‘å¦‚ä½•è¡¨è¾¾è¿™æ ·çš„æŸ¥è¯¢æœ€å¥½ï¼Ÿâ€œï¼Œâ€æˆ‘è¿™ä¸ªæŸ¥è¯¢è¿˜æœ‰ä¼˜åŒ–ç©ºé—´å—ï¼Ÿâ€œè¿™ä¸€ç±»çš„ã€‚ä»Šå¤©ï¼Œæˆ‘å°±è¯•ç€ä»‹ç»ä¸€ä¸‹å¦‚ä½•ç†è§£æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œä¸ä¼˜åŒ–è¿‡ç¨‹ï¼Œå¸®åŠ©å¤§å®¶è„šè¸©åœ¨åœ°ä¸Šå»å†™è‡ªå·±çš„æŸ¥è¯¢è¯­å¥ã€‚ åŒæ—¶ï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯ nGQL ç®€æ˜æ•™ç¨‹ç³»åˆ—çš„ç¬¬äºŒæœŸï¼Œé€šè¿‡æœ¬æ–‡äº†è§£é¢å‘æ€§èƒ½å»å†™æŸ¥è¯¢è¯­å¥ä¹‹åï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œå›¾å»ºæ¨¡çš„è¿‡ç¨‹ï¼ˆç¬¬ä¸‰æœŸçš„å†…å®¹ï¼‰ä¸­ä¹Ÿèƒ½æœ‰æ›´å¤šæ”¯æ’‘ã€‚ ","date":"2022-09-06","objectID":"/ngql-execution-plan/:0:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#"},{"categories":["Nebula Graph"],"content":" 1 ä¸€ä¸ªæŸ¥è¯¢çš„ä¸€ç”Ÿå…ˆä»ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ä»è¿›å…¥ NebulaGraph ä¸€ç›´åˆ°è¿”å›æŸ¥è¯¢ç»“æœçš„å…¨è¿‡ç¨‹ã€‚ åœ¨å¼€å§‹ä¹‹å‰ï¼Œæ¨èé˜…è¯»å¦‚ä¸‹æºç è§£è¯»ã€æ¶æ„è®¾è®¡çš„æ–‡ç« ï¼š å‚è€ƒæ–‡ç«  https://nebula-graph.com.cn/posts/nebula-graph-architecture-overview https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-01 https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-02 https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-03 https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-04 https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-05 https://nebula-graph.com.cn/posts/how-indexing-works-in-nebula-graph ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªæŸ¥è¯¢è¯­å¥è¢«ä» GraphClient å‘é€ç»™ GraphD ä¹‹åï¼Œç»å†äº†ï¼š åœ¨ Parser ä¸­è¢«è§£ææˆæŠ½è±¡è¯­æ³•æ ‘(AST) åœ¨ Validator, Planner ä¸­è¢«å†™æˆæ‰§è¡Œè®¡åˆ’å›¾ï¼Œå›¾ä¸­çš„æ¯ä¸€ä¸ªé¡¶ç‚¹ PlanNode å¯¹åº”ç€ä¸€ç§ç®—å­ é€šè¿‡ Optimizer ä¸­çš„ä¼˜åŒ–è§„åˆ™ï¼ˆRBOï¼‰æ”¹å†™æ‰§è¡Œè®¡åˆ’å›¾ ä¼˜åŒ–è¿‡çš„è®¡åˆ’å›¾è¢«æ‰§è¡Œå¼•æ“ä»å›¾çš„å¶å­èŠ‚ç‚¹å¼€å§‹æ‰§è¡Œç›´åˆ°æ ¹éƒ¨ çš„è¿‡ç¨‹ï¼š ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œåœ¨æŸ¥å¹´é¾„å¤§äº 34 å²çš„ä¸‰è·³å¥½å‹çš„è¯­å¥è¢«æŸ¥è¯¢ä¹‹å GO 3 STEPS FROM \"player100\" OVER follow WHERE $$.player.age \u003e 34 YIELD DISTINCT $$.player.name AS name, $$.player.age AS age | ORDER BY $-.age ASC, $-.name DESC; è¯­å¥ç»è¿‡äº†è§£æã€éªŒè¯ã€ä¼˜åŒ–ä¹‹åï¼Œæœ€ç»ˆçš„æ‰§è¡Œè®¡åˆ’æ˜¯ï¼Œ Start -\u003e Loop -\u003e Start -\u003e GetNeighbors -\u003e Project -\u003e Dedup -\u003e Loop -\u003e GetNeighbors -\u003e Project -\u003e GetVertices -\u003e Project -\u003e LeftJoin -\u003e Filter -\u003e Project -\u003e Dedup -\u003e Sortï¼Œæˆ–è€…å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ äº†è§£è¿™ä¸ªä¼˜åŒ–è¿‡ç¨‹å’Œæœ€ç»ˆæ‰§è¡Œè®¡åˆ’æ„å‘³ç€ä»€ä¹ˆæ˜¯è°ƒä¼˜æŸ¥è¯¢ã€é¢å‘æ€§èƒ½è®¾è®¡å›¾å»ºæ¨¡çš„å…³é”®ã€‚ è¿™ä¸ªè®¡åˆ’å›¾ç”±æ·»åŠ äº† PROFILE FORMAT=\"DOT\" çš„æ‰§è¡Œç»“æœä¸­çš„ digraph éƒ¨åˆ†ï¼Œå€ŸåŠ© graphviz æ¸²æŸ“è€Œå¾—ï¼Œçš„https://dreampuf.github.io/GraphvizOnline æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„çº¿ä¸Šæ¸²æŸ“çš„å·¥å…·ã€‚ å¦å¤–ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒFORMAT=\"DOT\" çœç•¥ä¹‹åçš„è¾“å‡ºç»“æœæ˜¯è¡¨æ ¼å½¢å¼çš„ï¼Œå¹¶ä¸”ï¼Œæœ‰æ›´å¤šä¿¡æ¯ä¼šå±•ç¤ºå‡ºæ¥ï¼Œåè¾¹æˆ‘ä»¬ä¼šè§£è¯»ã€‚ (root@nebula) [basketballplayer]\u003e PROFILE FORMAT=\"DOT\" GO 3 STEPS FROM \"player100\" OVER follow WHERE $$.player.age \u003e 34 YIELD DISTINCT $$.player.name AS name, $$.player.age AS age | ORDER BY $-.age ASC, $-.name DESC; +-----------------+-----+ | name | age | +-----------------+-----+ | \"Tony Parker\" | 36 | | \"Manu Ginobili\" | 41 | | \"Tim Duncan\" | 42 | +-----------------+-----+ Got 3 rows (time spent 8885/19871 us) Execution Plan (optimize time 1391 us) ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ plan ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ digraph exec_plan { rankdir=BT; \"Sort_14\"[label=\"{Sort_14|outputVar: \\{\\\"colNames\\\":\\[\\\"name\\\",\\\"age\\\"\\],\\\"type\\\":\\\"DATASET\\\",\\\"name\\\":\\\"__Sort_14\\\"\\}|inputVar: __Dedup_13}\", shape=Mrecord]; \"Dedup_13\"-\u003e\"Sort_14\"; \"Dedup_13\"[label=\"{Dedup_13|outputVar: \\{\\\"colNames\\\":\\[\\\"name\\\",\\\"age\\\"\\],\\\"type\\\":\\\"DATASET\\\",\\\"name\\\":\\\"__Dedup_13\\\"\\}|inputVar: __Project_12}\", shape=Mrecord]; \"Project_12\"-\u003e\"Dedup_13\"; \"Project_12\"[label=\"{Project_12|outputVar: \\{\\\"colNames\\\":\\[\\\"name\\\",\\\"age\\\"\\],\\\"type\\\":\\\"DATASET\\\",\\\"name\\\":\\\"__Project_12\\\"\\}|inputVar: __Filter_11}\", shape=Mrecord]; \"Filter_11\"-\u003e\"Project_12\"; \"Filter_11\"[label=\"{Filter_11|outputVar: \\{\\\"colNames\\\":\\[\\\"JOIN_DST_VID\\\",\\\"__COL_0\\\",\\\"__COL_1\\\",\\\"DST_VID\\\"\\],\\\"type\\\":\\\"DATASET\\\",\\\"name\\\":\\\"__Filter_11\\\"\\}|inputVar: __LeftJoin_10}\", shape=Mrecord]; \"LeftJoin_10\"-\u003e\"Filter_11\"; \"LeftJoin_10\"[label=\"{LeftJoin_10|outputVar: \\{\\\"colNames\\\":\\[\\\"JOIN_DST_VID\\\",\\\"__COL_0\\\",\\\"__COL_1\\\",\\\"DST_VID\\\"\\],\\\"type\\\":\\\"DATASET\\\",\\\"name\\\":\\\"__LeftJoin_10\\\"\\}|inputVar: \\{\\\"rightVar\\\":\\{\\\"__Project_9\\\":0\\},\\\"leftVar\\\":\\{\\\"__Project_7\\\":0\\}\\}}\", shape=Mrecord]; \"Project_9\"-\u003e\"LeftJoin_10\"; \"Project_9\"[label=\"{Project_9|outputVar: \\{\\\"colNames\\\":\\[\\\"__COL_0\\\",\\\"__COL_1\\\",\\\"DST_VID\\\"\\],\\\"type\\\":\\\"DATASET\\\",\\\"name\\\":\\\"__Project_9\\\"\\}|inputVar: __GetVertices_8}\", shape=Mrecord]; \"GetVertices_8\"-\u003e\"Project_9\"; \"GetVertices_8\"[label=\"{GetVertices_8|outputVar: \\{\\\"colNames\\\":\\[\\],\\\"type\\\":\\\"DATASET\\\",\\\"name\\\":\\\"__GetVertices_8\\\"\\}|inputVar: __Project_7}\", shape=Mrecord]; \"Project_7\"-\u003e\"GetVertices_8\"; \"Project_7\"[label=\"{Project_7|outputVar: \\{\\\"colNames\\\":\\[\\","date":"2022-09-06","objectID":"/ngql-execution-plan/:1:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#ä¸€ä¸ªæŸ¥è¯¢çš„ä¸€ç”Ÿ"},{"categories":["Nebula Graph"],"content":" 1.1 æŸ¥è¯¢è®¡åˆ’ä¸ºäº†ç†è§£ä¸€ä¸ªæŸ¥è¯¢åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå¦‚ä½•ååº”åˆ°æ‰§è¡Œå±‚é¢ï¼Œä»¥åŠå®ƒä»¬çš„æ€§èƒ½ä»£ä»·æ˜¯å¤šå°‘ï¼Œæˆ‘ä»¬ä»è®¤è¯†å®ƒçš„æ‰§è¡Œè®¡åˆ’å¼€å§‹å…¥æ‰‹ã€‚ ä»¥å‰è¾¹çš„å›¾çš„æ‹“å±•çš„ GO è¯­å¥ä¸ºä¾‹ï¼Œå®ƒçš„æ•´ä¸ªè¿‡ç¨‹ç»å†äº†å¦‚ä¸‹èŠ‚ç‚¹ GetNeighbors æ˜¯æ‰§è¡Œè®¡åˆ’ä¸­æœ€é‡è¦çš„èŠ‚ç‚¹ï¼ŒGetNeighbors ç®—å­ä¼šåœ¨è¿è¡ŒæœŸè®¿é—®å­˜å‚¨æœåŠ¡ï¼Œæ‹¿åˆ°é€šè¿‡èµ·ç‚¹å’ŒæŒ‡å®šè¾¹ç±»å‹ä¸€æ­¥æ‹“å±•åç»ˆç‚¹çš„ id å¤šæ­¥æ‹“å±•é€šè¿‡ Loop èŠ‚ç‚¹å®ç°ï¼ŒStart åˆ° Loop ä¹‹é—´æ˜¯ Loop å­è®¡åˆ’ï¼Œå½“æ»¡è¶³æ¡ä»¶æ—¶ Loop å­è®¡åˆ’ä¼šè¢«å¾ªç¯æ‰§è¡Œï¼Œæœ€åä¸€æ­¥æ‹“å±•èŠ‚ç‚¹åœ¨ Loop å¤–å®ç° Project èŠ‚ç‚¹ç”¨æ¥è·å–å½“å‰æ‹“å±•çš„ç»ˆç‚¹ id Dedup èŠ‚ç‚¹å¯¹ç»ˆç‚¹ id è¿›è¡Œå»é‡åä½œä¸ºä¸‹ä¸€æ­¥æ‹“å±•çš„èµ·ç‚¹ GetVertices èŠ‚ç‚¹è´Ÿè´£å–ç»ˆç‚¹ tag çš„å±æ€§ Filter åšæ¡ä»¶è¿‡æ»¤ LeftJoin çš„ä½œç”¨æ˜¯åˆå¹¶ GetNeightbors å’Œ GetVertices çš„ç»“æœ Sort åšæ’åº è€Œè¿™äº›èŠ‚ç‚¹å°±æ˜¯ä¸åŒçš„ç®—å­ã€‚ ","date":"2022-09-06","objectID":"/ngql-execution-plan/:1:1","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#æŸ¥è¯¢è®¡åˆ’"},{"categories":["Nebula Graph"],"content":" 2 è®¤è¯†ç®—å­åœ¨ NebulaGraph åšå®¢çš„ä»£ç è§£è¯»æ–‡ç« ä¸­å·²ç»æœ‰å¾ˆå¤šç®—å­è¢«æåŠã€è§£é‡Šè¿‡ï¼Œè¿™é‡Œåˆ—ä¸¾å…¶ä¸­éƒ¨åˆ†å¸¸è§çš„ç®—å­ï¼š æ³¨ï¼šè¿™é‡Œæ²¡æœ‰æåŠ GET SUBGRAPH/ FIND PATH ä¸­çš„ç®—å­ã€‚ ç®—å­ ä»‹ç» GetNeighbor æ ¹æ®æŒ‡å®šçš„ vid ï¼Œä»å­˜å‚¨å±‚è·å–èµ·å§‹ç‚¹å’Œè¾¹çš„å±æ€§ Traverse ä»…ç”¨äºMATCH åŒ¹é… ()-[e:0..n]-() æ¨¡å¼ï¼Œè·å–æ‹“å±•è¿‡ç¨‹ä¸­çš„èµ·å§‹ç‚¹å’Œè¾¹çš„å±æ€§ AppendVertices ä»…ç”¨äºMATCH ï¼Œå’Œ Traverse é…åˆè·å–ç‚¹çš„å±æ€§ GetEdge è·å–è¾¹çš„å±æ€§ GetVertices è·å–ç‚¹çš„å±æ€§ï¼ŒFETCH PROP æˆ–è€… GO è¯­å¥ä¸­ã€‚ ScanEdge å…¨è¡¨æ‰«æè¾¹ï¼Œä¾‹å¦‚ MATCH ()-[e]-\u003e() RETURN e LIMIT 3 ScanVertices å…¨è¡¨æ‰«æç‚¹ï¼Œä¾‹å¦‚ MATCH (v) return v LIMIT 3 IndexScan MATCH è¯­å¥ä¸­æ‰¾åˆ°èµ·å§‹ç‚¹çš„ç´¢å¼•æŸ¥è¯¢ TagIndexPrefixScan LOOKUP è¯­å¥ä¸­å‰ç¼€æ‰«æ LOOKUP ON player where player.name == \"Steve Nash\" YIELD player.name TagIndexRangeScan LOOKUP è¯­å¥ä¸­èŒƒå›´æ‰«æ LOOKUP ON player where player.name \u003e \"S\" YIELD player.name TagIndexFullScan LOOKUP è¯­å¥ä¸­å…¨æ‰«æ LOOKUP ON player YIELD player.name Filter æŒ‰æ¡ä»¶è¿‡æ»¤ï¼Œä¾‹å¦‚ WHERE è¯­å¥ Project è·å–ä¸Šä¸€æ­¥ç®—å­çš„åˆ— Dedup å»é‡ LeftJoin åˆå¹¶ç»“æœ LIMIT é™åˆ¶è¾“å‡ºè¡Œæ•° ä»è¿™äº›ç®—å­çš„å«ä¹‰ä¸­å·²ç»å¯ä»¥æ›´åŠ å…·ä½“çš„çŸ¥é“å›¾æ•°æ®åº“æŸ¥è¯¢è½åˆ°æŸ¥è¯¢å¼•æ“ï¼ˆGraphDï¼‰å†…éƒ¨çš„æœ€å°æ‰€éœ€æ“ä½œäº†ï¼Œè€Œæ€§èƒ½è°ƒä¼˜çš„å…³é”®å°±åœ¨äºå¦‚ä½•è§„åˆ’ã€ä¼˜åŒ–ä¸€ä¸ªæŸ¥è¯¢å¦‚ä½•è¢«æ‹†è§£ä¸ºç®—å­çš„æ‰§è¡Œè®¡åˆ’ã€‚ ","date":"2022-09-06","objectID":"/ngql-execution-plan/:2:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#è®¤è¯†ç®—å­"},{"categories":["Nebula Graph"],"content":" 3 è®¤è¯†ä¼˜åŒ–è§„åˆ™å¯¹äºä»»ä½•ç»™å®šçš„æŸ¥è¯¢ï¼Œæ‰§è¡Œè®¡åˆ’å¹¶ä¸æ˜¯å”¯ä¸€ç¡®å®šçš„ï¼Œç›¸åï¼Œåœ¨æœ€ç®€å•ã€ç›´æ¥çš„è®¡åˆ’åŸºç¡€ä¹‹ä¸Šï¼Œä¼˜åŒ–å™¨ï¼ˆOptimizerï¼‰ä¼šè¿›è¡Œå¾ˆå¤šæ€§èƒ½ä¸Šçš„ä¼˜åŒ–ã€‚ NebulaGraph ç›®å‰çš„ä¼˜åŒ–å™¨æ˜¯å®Œå…¨çš„åŸºäºè§„åˆ™çš„ä¼˜åŒ–ï¼ˆRBOï¼‰ï¼Œè¿™äº›é¢„è®¾çš„è§„åˆ™çš„ä»£ç éƒ½åœ¨ src/graph/optimizer çš„ rules é‡Œè¾¹ï¼Œå®ƒä»¬éƒ½æ˜¯é’ˆå¯¹æ‰§è¡Œè®¡åˆ’æ¨¡å¼çš„ä¿®æ”¹è§„åˆ™ï¼Œä¹‹å‰ Shylock åœ¨è¿™ç¯‡æ–‡ç« é‡Œç»™è¿‡æºç å±‚é¢çš„ä»‹ç»ï¼Œå¤§å®¶å¯ä»¥å»è¯»ä¸€ä¸‹ã€‚ å€¼å¾—åº†å¹¸çš„æ˜¯ï¼Œä»Šå¹´ï¼Œå¤§éƒ¨åˆ†ä¼˜åŒ–è§„åˆ™çš„ä»£ç é‡Œå¢åŠ äº†å¾ˆå¤šå¥½ç†è§£çš„ asciiart å›¾å½¢æ³¨é‡Šï¼Œç»“åˆä¼˜åŒ–è§„åˆ™çš„å‘½åæœ¬èº«çš„è‡ªè§£é‡Šæ€§ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¿«é€Ÿå»å¤§æ¦‚ç†è§£ä¼˜åŒ–è§„åˆ™çš„åŒ¹é…è§„åˆ™å’Œè½¬æ¢é€»è¾‘ã€‚ é¦–å…ˆï¼Œè¿™äº›è§„åˆ™çš„è½¬æ¢(transform)ä»£ç éƒ½åœ¨ .cpp æ–‡ä»¶é‡Œï¼Œasciiart å›¾å½¢æ³¨é‡Šåœ¨åŒåå¯¹åº”çš„ .h é‡Œï¼ ls src/graph/optimizer/rule/*.h src/graph/optimizer/rule/CollapseProjectRule.h src/graph/optimizer/rule/PushFilterDownLeftJoinRule.h src/graph/optimizer/rule/CombineFilterRule.h src/graph/optimizer/rule/PushFilterDownNodeRule.h src/graph/optimizer/rule/EdgeIndexFullScanRule.h src/graph/optimizer/rule/PushFilterDownProjectRule.h src/graph/optimizer/rule/EliminateAppendVerticesRule.h src/graph/optimizer/rule/PushFilterDownScanVerticesRule.h src/graph/optimizer/rule/EliminateRowCollectRule.h src/graph/optimizer/rule/PushLimitDownGetNeighborsRule.h src/graph/optimizer/rule/GeoPredicateEdgeIndexScanRule.h src/graph/optimizer/rule/PushLimitDownIndexScanRule.h src/graph/optimizer/rule/GeoPredicateIndexScanBaseRule.h src/graph/optimizer/rule/PushLimitDownProjectRule.h src/graph/optimizer/rule/GeoPredicateTagIndexScanRule.h src/graph/optimizer/rule/PushLimitDownScanAppendVerticesRule.h src/graph/optimizer/rule/GetEdgesTransformAppendVerticesLimitRule.h src/graph/optimizer/rule/PushLimitDownScanEdgesAppendVerticesRule.h src/graph/optimizer/rule/GetEdgesTransformRule.h src/graph/optimizer/rule/PushLimitDownScanEdgesRule.h src/graph/optimizer/rule/GetEdgesTransformUtils.h src/graph/optimizer/rule/PushStepLimitDownGetNeighborsRule.h src/graph/optimizer/rule/IndexFullScanBaseRule.h src/graph/optimizer/rule/PushStepSampleDownGetNeighborsRule.h src/graph/optimizer/rule/IndexScanRule.h src/graph/optimizer/rule/PushTopNDownIndexScanRule.h src/graph/optimizer/rule/MergeGetNbrsAndDedupRule.h src/graph/optimizer/rule/PushVFilterDownScanVerticesRule.h src/graph/optimizer/rule/MergeGetNbrsAndProjectRule.h src/graph/optimizer/rule/RemoveNoopProjectRule.h src/graph/optimizer/rule/MergeGetVerticesAndDedupRule.h src/graph/optimizer/rule/RemoveProjectDedupBeforeGetDstBySrcRule.h src/graph/optimizer/rule/MergeGetVerticesAndProjectRule.h src/graph/optimizer/rule/TagIndexFullScanRule.h src/graph/optimizer/rule/OptimizeEdgeIndexScanByFilterRule.h src/graph/optimizer/rule/TopNRule.h src/graph/optimizer/rule/OptimizeTagIndexScanByFilterRule.h src/graph/optimizer/rule/UnionAllEdgeIndexScanRule.h src/graph/optimizer/rule/PushEFilterDownRule.h src/graph/optimizer/rule/UnionAllIndexScanBaseRule.h src/graph/optimizer/rule/PushFilterDownAggregateRule.h src/graph/optimizer/rule/UnionAllTagIndexScanRule.h src/graph/optimizer/rule/PushFilterDownGetNbrsRule.h ","date":"2022-09-06","objectID":"/ngql-execution-plan/:3:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#è®¤è¯†ä¼˜åŒ–è§„åˆ™"},{"categories":["Nebula Graph"],"content":" 3.1 GetEdgesTransformRuleæˆ‘ä»¬çœ‹ä¸‹è¿™ä¸ªè§„åˆ™åå­—çš„æ„æ€æ˜¯è½¬æ¢ GetEdges çš„è§„åˆ™ï¼Œçœ‹èµ·æ¥ä¸å¤Ÿæ˜ç¡®ï¼Œå†çœ‹çœ‹ GetEdgesTransformRule.h // Convert [[ScanVertices]] to [[ScanEdges]] in certain cases // Required conditions: // 1. Match the pattern // Benefits: // 1. Avoid doing Traverse to optimize performance // Quey example: // 1. match ()-[e]-\u003e() return e limit 3 // // Tranformation: // Before: // +---------+---------+ // | Project | // +---------+---------+ // | // +---------+---------+ // | Limit | // +---------+---------+ // | // +---------+---------+ // | Traverse | // +---------+---------+ // | // +---------+---------+ // | ScanVertices | // +---------+---------+ // // After: // +---------+---------+ // | Project | // +---------+---------+ // | // +---------+---------+ // | Limit | // +---------+---------+ // | // +---------+---------+ // | Project | // +---------+---------+ // | // +---------+---------+ // | ScanEdges | // +---------+---------+ ç»“åˆ .cpp ä¸­ GetEdgesTransformRule::match å’Œ GetEdgesTransformRule::transform çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šè¿™ä¸ªä¼˜åŒ–è§„åˆ™æ˜¯å°† MATCH ()-[e]-\u003e() RETURN e LIMIT 3 åŸæœ¬æŒ‰ç…§ ScanVertices å»æ‰«æé¡¶ç‚¹çš„èµ·ç‚¹è½¬å˜ä¸º ScanEdgesã€‚ è¿™ä¸ªè§„åˆ™çš„èƒŒæ™¯æ˜¯æ²¡æœ‰ç‚¹ã€è¾¹ç´¢å¼•çš„ LIMIT æƒ…å†µä¸‹ï¼Œæ— èµ·ç‚¹ VID/å±æ€§æ¡ä»¶çš„æŸ¥è¯¢æ˜¯å¯ä»¥é€šè¿‡æ‰«ç‚¹è¾¹æ•°æ®ä¸‹æ¨ LIMIT çš„ï¼Œè¿™ä¸ªæ‰«æè¾¹çš„æŸ¥è¯¢å› ä¸ºåªéœ€è¦è¿”å›è¾¹ï¼Œæ‰€ä»¥ç›´æ¥æ‰«æè¾¹æ˜¯æ›´é«˜æ•ˆçš„ã€‚ ","date":"2022-09-06","objectID":"/ngql-execution-plan/:3:1","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#getedgestransformrule"},{"categories":["Nebula Graph"],"content":" 3.2 PushLimitDownScanEdgesRuleæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªè§„åˆ™ï¼Œåœ¨ PushLimitDownScanEdgesRule.h é‡Œæœ‰æ³¨é‡Š // Embedding limit to [[ScanEdges]] // Required conditions: // 1. Match the pattern // Benefits: // 1. Limit data early to optimize performance // // Transformation: // Before: // // +--------+--------+ // | Limit | // | (limit=3) | // +--------+--------+ // | // +---------+---------+ // | ScanEdges | // +---------+---------+ // // After: // // +--------+--------+ // | Limit | // | (limit=3) | // +--------+--------+ // | // +---------+---------+ // | ScanEdges | // | (limit=3) | // +---------+---------+ è¿™ä¸ªè§„åˆ™å¾ˆç®€å•ï¼Œå½“ ScanEdges ç®—å­çš„ä¸‹æ¸¸æ˜¯ Limit ç®—å­çš„æ—¶å€™ï¼ŒæŠŠ Limit çš„è¿‡æ»¤æ¡ä»¶åµŒå…¥åˆ° ScanEdges ä¹‹ä¸­ã€‚è¿™ä¸€æ­¥çš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªä¼˜åŒ–è§„åˆ™é‡Œå¸¸è§çš„æ¦‚å¿µï¼Œè®¡ç®—ä¸‹æ¨ã€‚ 3.2.1 è®¡ç®—ä¸‹æ¨åœ¨è®¡ç®—å­˜å‚¨åˆ†ç¦»çš„æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œæ¶‰åŠåˆ°è¯»å–æ•°æ®çš„ç®—å­éœ€è¦ä»å­˜å‚¨å±‚è¿œç¨‹æå–æ•°æ®å†åšè¿›ä¸€æ­¥å¤„ç†ã€‚è€Œè¿™ä¸ª RPC çš„æ•°æ®ä¼ è¾“å¸¸å¸¸æˆä¸ºæ€§èƒ½çš„ç“¶é¢ˆã€‚ç„¶è€Œï¼Œå¦‚æœä¸‹ä¸€æ­¥è®¡ç®—è¦åšçš„äº‹æƒ…æ˜¯å¯¹æ•°æ®çš„æŒ‰æ¡ä»¶å‰ªæï¼Œä¾‹å¦‚ Filterã€ Limitã€TopN ç­‰ç­‰ï¼Œè¿™æ—¶å€™ï¼Œè®©è¿™äº›å‰ªææ¡ä»¶åœ¨å­˜å‚¨å±‚ææ•°æ®çš„æ—¶å€™å°±è€ƒè™‘åˆ°ï¼Œåˆ™å¯ä»¥å¤§å¤§å‡å°‘æ•°æ®ä¼ è¾“çš„é‡ã€‚ PushLimitDownScanEdgesRule.h çš„ä¼˜åŒ–è§„åˆ™å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ Limit ä¸‹æ¨ï¼ˆPush Downï¼‰çš„è§„åˆ™ã€‚ ","date":"2022-09-06","objectID":"/ngql-execution-plan/:3:2","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#pushlimitdownscanedgesrule"},{"categories":["Nebula Graph"],"content":" 3.2 PushLimitDownScanEdgesRuleæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªè§„åˆ™ï¼Œåœ¨ PushLimitDownScanEdgesRule.h é‡Œæœ‰æ³¨é‡Š // Embedding limit to [[ScanEdges]] // Required conditions: // 1. Match the pattern // Benefits: // 1. Limit data early to optimize performance // // Transformation: // Before: // // +--------+--------+ // | Limit | // | (limit=3) | // +--------+--------+ // | // +---------+---------+ // | ScanEdges | // +---------+---------+ // // After: // // +--------+--------+ // | Limit | // | (limit=3) | // +--------+--------+ // | // +---------+---------+ // | ScanEdges | // | (limit=3) | // +---------+---------+ è¿™ä¸ªè§„åˆ™å¾ˆç®€å•ï¼Œå½“ ScanEdges ç®—å­çš„ä¸‹æ¸¸æ˜¯ Limit ç®—å­çš„æ—¶å€™ï¼ŒæŠŠ Limit çš„è¿‡æ»¤æ¡ä»¶åµŒå…¥åˆ° ScanEdges ä¹‹ä¸­ã€‚è¿™ä¸€æ­¥çš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªä¼˜åŒ–è§„åˆ™é‡Œå¸¸è§çš„æ¦‚å¿µï¼Œè®¡ç®—ä¸‹æ¨ã€‚ 3.2.1 è®¡ç®—ä¸‹æ¨åœ¨è®¡ç®—å­˜å‚¨åˆ†ç¦»çš„æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œæ¶‰åŠåˆ°è¯»å–æ•°æ®çš„ç®—å­éœ€è¦ä»å­˜å‚¨å±‚è¿œç¨‹æå–æ•°æ®å†åšè¿›ä¸€æ­¥å¤„ç†ã€‚è€Œè¿™ä¸ª RPC çš„æ•°æ®ä¼ è¾“å¸¸å¸¸æˆä¸ºæ€§èƒ½çš„ç“¶é¢ˆã€‚ç„¶è€Œï¼Œå¦‚æœä¸‹ä¸€æ­¥è®¡ç®—è¦åšçš„äº‹æƒ…æ˜¯å¯¹æ•°æ®çš„æŒ‰æ¡ä»¶å‰ªæï¼Œä¾‹å¦‚ Filterã€ Limitã€TopN ç­‰ç­‰ï¼Œè¿™æ—¶å€™ï¼Œè®©è¿™äº›å‰ªææ¡ä»¶åœ¨å­˜å‚¨å±‚ææ•°æ®çš„æ—¶å€™å°±è€ƒè™‘åˆ°ï¼Œåˆ™å¯ä»¥å¤§å¤§å‡å°‘æ•°æ®ä¼ è¾“çš„é‡ã€‚ PushLimitDownScanEdgesRule.h çš„ä¼˜åŒ–è§„åˆ™å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ Limit ä¸‹æ¨ï¼ˆPush Downï¼‰çš„è§„åˆ™ã€‚ ","date":"2022-09-06","objectID":"/ngql-execution-plan/:3:2","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#è®¡ç®—ä¸‹æ¨"},{"categories":["Nebula Graph"],"content":" 3.3 PushLimitDownProjectRuleç±»ä¼¼çš„ï¼Œæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªè§„åˆ™ï¼ŒPushLimitDownProjectRule.h é‡Œæœ‰è¿™æ ·ä¸€æ®µæ³¨é‡Šï¼Œè¿™ä¸ªè§„åˆ™åªæ˜¯æŠŠ Project ç®—å­ ä¹‹åçš„ Limit ç®—å­çš„é¡ºåºè°ƒæ¢äº†ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡åœ¨è¿™ä¸ªå˜æ¢ä¹‹åï¼ŒLimit å°±å’Œ ScanEdges ç­‰å…¶ä»–å¯ä»¥ä¸‹æ¨ Limit çš„ç®—å­ç›¸é‚»äº†ï¼Œç„¶åä¾‹å¦‚ PushLimitDownScanEdgesRule çš„è§„åˆ™å˜æ¢ä¹Ÿå¯ä»¥åšäº†ã€‚ // Push [[Limit]] down [[Project]] // Required conditions: // 1. Match the pattern // Benefits: // 1. Limit data early to optimize performance // // Tranformation: // Before: // // +--------+--------+ // | Limit | // | (limit=3) | // +--------+--------+ // | // +---------+---------+ // | Project | // +---------+---------+ // // After: // +---------+---------+ // | Project | // +---------+---------+ // | // +--------+--------+ // | Limit | // | (limit=3) | // +--------+--------+ ","date":"2022-09-06","objectID":"/ngql-execution-plan/:3:3","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#pushlimitdownprojectrule"},{"categories":["Nebula Graph"],"content":" 3.4 PushFilterDownGetNbrsRuleå†ä»‹ç»ä¸€ä¸ª Filter ä¸‹æ¨çš„ä¾‹å­ï¼Œä»è§„åˆ™æ³¨é‡Šé‡Œçš„è½¬æ¢å›¾ç¤ºå¯ä»¥è¯»å‡ºï¼Œå½“ GetNeighbors ä¹‹åå†åŒæ¡ä»¶äº¤é›† Filter çš„æ—¶å€™ï¼Œå–ä¸€ä¸ªæ¡ä»¶ä¸‹æ¨åˆ° GetNeighborsï¼Œå†è¿›è¡Œå¦ä¸€ä¸ªæ¡ä»¶çš„ Filterã€‚è¿™ä¸ªè§„åˆ™æ—¢å‡å°‘äº† GetNeighbors æ•°æ®ä¼ è¾“çš„é‡å’Œ Filter è¾“å…¥çš„è¿ç®—é‡ã€åˆå°‘äº†ä¸€æ¬¡é›†åˆè¿ç®—ã€‚ // Embed the [[Filter]] into [[GetNeighbors]] // Required conditions: // 1. Match the pattern // 2. Filter contains subexpressions that meet pushdown conditions // Benefits: // 1. Filter data early to optimize performance // // Tranformation: // Before: // // +------------------+------------------+ // | Filter | // |($^.player.age\u003e3 and $$.player.age\u003c4)| // +------------------+------------------+ // | // +------+------+ // | GetNeighbors| // +------+------+ // // After: // // +--------+--------+ // | Filter | // |($$.player.age\u003c4)| // +--------+--------+ // | // +--------+--------+ // | GetNeighbors | // |($^.player.age\u003e3)| // +--------+--------+ 3.4.1 ä¸‹ä¸€æ­¥ æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è¯•ç€è¿›ä¸€æ­¥çœ‹çœ‹æ‰€æœ‰çš„è§„åˆ™ã€‚ å¯ä»¥è¯•ç€åœ¨å¤šä¸ª GraphD çš„é›†ç¾¤ä¸Šï¼Œæ›´æ”¹å…¶ä¸­ä¸€ä¸ª GraphD çš„é…ç½®ï¼Œå…³é—­ enable_optimizerï¼ŒæŠŠåŒä¸€ä¸ª Query åˆ†åˆ«åœ¨å¼€å¯äº†ä¼˜åŒ–å’Œå…³é—­ä¼˜åŒ–çš„ GraphD ä¸­æ‰§è¡Œï¼Œæ¯”è¾ƒæ‰§è¡Œè®¡åˆ’çš„åŒºåˆ«ã€‚ å¦‚æœä½ å‘ç°å¯ä»¥æ›´ä¼˜åŒ–çš„è§„åˆ™ç»™åˆ°å¤§å®¶ï¼Œæ¬¢è¿æ¥è®ºå›ã€github æäº¤ä¼˜åŒ–å»ºè®®ã€æˆ–è€… PRï¼ ç®€å•çš„ä»‹ç»å°±åˆ°è¿™é‡Œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä»ä¸€äº›å®ä¾‹å‡ºå‘æ¥è¿›ä¸€æ­¥å®æ“æ‰§è¡Œè®¡åˆ’è°ƒä¼˜å§ã€‚ ","date":"2022-09-06","objectID":"/ngql-execution-plan/:3:4","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#pushfilterdowngetnbrsrule"},{"categories":["Nebula Graph"],"content":" 3.4 PushFilterDownGetNbrsRuleå†ä»‹ç»ä¸€ä¸ª Filter ä¸‹æ¨çš„ä¾‹å­ï¼Œä»è§„åˆ™æ³¨é‡Šé‡Œçš„è½¬æ¢å›¾ç¤ºå¯ä»¥è¯»å‡ºï¼Œå½“ GetNeighbors ä¹‹åå†åŒæ¡ä»¶äº¤é›† Filter çš„æ—¶å€™ï¼Œå–ä¸€ä¸ªæ¡ä»¶ä¸‹æ¨åˆ° GetNeighborsï¼Œå†è¿›è¡Œå¦ä¸€ä¸ªæ¡ä»¶çš„ Filterã€‚è¿™ä¸ªè§„åˆ™æ—¢å‡å°‘äº† GetNeighbors æ•°æ®ä¼ è¾“çš„é‡å’Œ Filter è¾“å…¥çš„è¿ç®—é‡ã€åˆå°‘äº†ä¸€æ¬¡é›†åˆè¿ç®—ã€‚ // Embed the [[Filter]] into [[GetNeighbors]] // Required conditions: // 1. Match the pattern // 2. Filter contains subexpressions that meet pushdown conditions // Benefits: // 1. Filter data early to optimize performance // // Tranformation: // Before: // // +------------------+------------------+ // | Filter | // |($^.player.age\u003e3 and $$.player.age\u003c4)| // +------------------+------------------+ // | // +------+------+ // | GetNeighbors| // +------+------+ // // After: // // +--------+--------+ // | Filter | // |($$.player.age\u003c4)| // +--------+--------+ // | // +--------+--------+ // | GetNeighbors | // |($^.player.age\u003e3)| // +--------+--------+ 3.4.1 ä¸‹ä¸€æ­¥ æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è¯•ç€è¿›ä¸€æ­¥çœ‹çœ‹æ‰€æœ‰çš„è§„åˆ™ã€‚ å¯ä»¥è¯•ç€åœ¨å¤šä¸ª GraphD çš„é›†ç¾¤ä¸Šï¼Œæ›´æ”¹å…¶ä¸­ä¸€ä¸ª GraphD çš„é…ç½®ï¼Œå…³é—­ enable_optimizerï¼ŒæŠŠåŒä¸€ä¸ª Query åˆ†åˆ«åœ¨å¼€å¯äº†ä¼˜åŒ–å’Œå…³é—­ä¼˜åŒ–çš„ GraphD ä¸­æ‰§è¡Œï¼Œæ¯”è¾ƒæ‰§è¡Œè®¡åˆ’çš„åŒºåˆ«ã€‚ å¦‚æœä½ å‘ç°å¯ä»¥æ›´ä¼˜åŒ–çš„è§„åˆ™ç»™åˆ°å¤§å®¶ï¼Œæ¬¢è¿æ¥è®ºå›ã€github æäº¤ä¼˜åŒ–å»ºè®®ã€æˆ–è€… PRï¼ ç®€å•çš„ä»‹ç»å°±åˆ°è¿™é‡Œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä»ä¸€äº›å®ä¾‹å‡ºå‘æ¥è¿›ä¸€æ­¥å®æ“æ‰§è¡Œè®¡åˆ’è°ƒä¼˜å§ã€‚ ","date":"2022-09-06","objectID":"/ngql-execution-plan/:3:4","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#ä¸‹ä¸€æ­¥"},{"categories":["Nebula Graph"],"content":" 4 nGQL æ‰§è¡Œè®¡åˆ’è°ƒä¼˜è§£è¯»å®ä¾‹å¸Œæœ›è¿™äº›å…·ä½“é—®é¢˜èƒ½å¤Ÿç»™å¤§å®¶å¸¦æ¥å¯å‘ã€‚ ","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#ngql-æ‰§è¡Œè®¡åˆ’è°ƒä¼˜è§£è¯»å®ä¾‹"},{"categories":["Nebula Graph"],"content":" 4.1 è§‚å¯ŸåŸºäºç´¢å¼•ä¸æ•°æ®çš„æ‰«ææˆ‘åœ¨ç´¢å¼•è¯¦è§£ä¸­è§£é‡Šè¿‡ NebulaGraph çš„ç´¢å¼•å’Œä¼ ç»Ÿæ•°æ®åº“ä¸­ç´¢å¼•çš„åŒºåˆ«ï¼Œç®€å•æ¥è¯´ï¼Œå› ä¸ºä»¥ç±»ä¼¼äºé‚»æ¥è¡¨çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼ŒNebulaGraph é‡Œéœ€è¦æ˜ç¡®æŒ‡å®šé¢å¤–åˆ›å»ºç´¢å¼•æ¥è§£å†³å…¨æ‰«ææˆ–è€…æ ¹æ®å±æ€§æ¡ä»¶æ‰«æç‚¹ã€è¾¹çš„ç±»ä¼¼äºè¡¨ç»“æ„æ•°æ®åº“ä¸­çš„åœºæ™¯ã€‚ å¦å¤–ï¼Œåœ¨æ— è¿‡æ»¤æ¡ä»¶ Limit é‡‡æ ·æ‰«æçš„åœºæ™¯ä¸‹ï¼ŒNebulaGraph ä» v3.0 ä»¥åå…è®¸äº†æ— ç´¢å¼•çš„æŸ¥è¯¢æƒ…å½¢ï¼ˆå› ä¸ºç‚¹è¾¹æ•°æ®æ‰«ææ”¯æŒäº† Limit ä¸‹æ¨ï¼Œä¸å†åƒä¹‹å‰é‚£ä¹ˆæ˜‚è´µï¼‰ï¼Œåœ¨æ²¡æœ‰ç´¢å¼•å¯ä»¥è¢«é€‰æ‹©çš„æƒ…å†µä¸‹ï¼Œplanner ä¹Ÿä¼šé€‰æ‹©ç›´æ¥æ‰«ç‚¹æˆ–è€…è¾¹çš„æ•°æ®ï¼Œè¿™ä¸ªå·®åˆ«å¯ä»¥ä» explain, profile ä¸­çœ‹å‡ºæ¥ã€‚ è¿™é‡Œç”¨ Basketballplayer æ•°æ®é›†ä¸­è‡ªå¸¦çš„ç´¢å¼•æ¥è·ç¦»ï¼Œæ³¨æ„åˆ°å…¶ä¸­åªåœ¨ player è¿™ä¸ª TAG ä¸Šæœ‰ä¸¤ä¸ªç´¢å¼•ï¼š (root@nebula) [basketballplayer]\u003e SHOW TAG INDEXES +------------------+----------+----------+ | Index Name | By Tag | Columns | +------------------+----------+----------+ | \"player_index_0\" | \"player\" | [] | | \"player_index_1\" | \"player\" | [\"name\"] | +------------------+----------+----------+ Got 2 rows (time spent 2440/19653 us) 4.1.1 æ— ç´¢å¼•æŸ¥è¯¢å…ˆçœ‹ä¸€ä¸ªæ²¡æœ‰ç´¢å¼•çš„åœºæ™¯çš„æŸ¥è¯¢ï¼š (root@nebula) [basketballplayer]\u003e PROFILE MATCH (n:team) RETURN id(n) LIMIT 1 +-----------+ | id(n) | +-----------+ | \"team206\" | +-----------+ Got 1 rows (time spent 3637/17551 us) Execution Plan (optimize time 265 us) -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | id | name | dependencies | profiling data | operator info | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 15 | Project | 16 | ver: 0, rows: 1, execTime: 28us, totalTime: 29us | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"id(n)\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__DataCollect_8\" | | | | | | } | | | | | | inputVar: __Limit_13 | | | | | | columns: [ | | | | | | \"id($-.n)\" | | | | | | ] | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 16 | Limit | 17 | ver: 0, rows: 1, execTime: 3us, totalTime: 8us | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"n\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Limit_13\" | | | | | | } | | | | | | inputVar: __AppendVertices_17 | | | | | | offset: 0 | | | | | | count: 1 | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 17 | AppendVertices | 18 | { | outputVar: { | | | | | ver: 0, rows: 3, execTime: 244us, totalTime: 1124us | \"colNames\": [ | | | | | \"storaged0\":9779 exec/total: 257(us)/779(us) | \"n\" | | | | | \"storaged2\":9779 exec/total: 190(us)/870(us) | ], | | | | | total_rpc: 1024(us) | \"type\": \"DATASET\", | | | | | \"storaged1\":9779 exec/total: 195(us)/879(us) | \"name\": \"__AppendVertices_17\" | | | | | } | } | | | | | | inputVar: __ScanVertices_18 | | | | | | space: 2 | | | | | | dedup: true | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: $-._vid | | | | | | props: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"name\", | | | | | | \"age\", | | | | | | \"_tag\" | | | | | | ], | | | | | | \"tagId\": 3 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"name\", | | | | | | \"_tag\" | | | | | | ], | | | | | | \"tagId\": 4 | | | | | | } | | | | | | ] | | | | | | exprs: | | | | | | vertex_filter: | | | | | | if_track_previous_path: false | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 18 | ScanVertices | 3 | { | outputVar: { | | | | | ver: 0, rows: 3, execTime: 225us, totalTime: 1586us | \"colNames\": [ | | | | | \"storaged2\":9779 exec/total: 532(us)/1303(us) | \"_vid\", | | | | | \"storaged1\":9779 exec/total: 480(us)/1318(us) | \"team._tag\" | | | | | total_rpc: 1502(us) | ], | | | | | \"storaged0\":9779 exec/total: 506(us)/1382(us) | \"type\": \"DATASET\", | | | | | } | \"name\": \"__ScanVertices_18\" | | | | | | } | | | | | | inputVar: | | | | | | space: 2 | | | | | | dedup: false | | | | | | limit: 1 | | | | | | filter: (team._tag IS NOT EMPTY AND team._tag IS NOT EMPTY) | | | | | | orderBy: [] | | | | ","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:1","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#è§‚å¯ŸåŸºäºç´¢å¼•ä¸æ•°æ®çš„æ‰«æ"},{"categories":["Nebula Graph"],"content":" 4.1 è§‚å¯ŸåŸºäºç´¢å¼•ä¸æ•°æ®çš„æ‰«ææˆ‘åœ¨ç´¢å¼•è¯¦è§£ä¸­è§£é‡Šè¿‡ NebulaGraph çš„ç´¢å¼•å’Œä¼ ç»Ÿæ•°æ®åº“ä¸­ç´¢å¼•çš„åŒºåˆ«ï¼Œç®€å•æ¥è¯´ï¼Œå› ä¸ºä»¥ç±»ä¼¼äºé‚»æ¥è¡¨çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼ŒNebulaGraph é‡Œéœ€è¦æ˜ç¡®æŒ‡å®šé¢å¤–åˆ›å»ºç´¢å¼•æ¥è§£å†³å…¨æ‰«ææˆ–è€…æ ¹æ®å±æ€§æ¡ä»¶æ‰«æç‚¹ã€è¾¹çš„ç±»ä¼¼äºè¡¨ç»“æ„æ•°æ®åº“ä¸­çš„åœºæ™¯ã€‚ å¦å¤–ï¼Œåœ¨æ— è¿‡æ»¤æ¡ä»¶ Limit é‡‡æ ·æ‰«æçš„åœºæ™¯ä¸‹ï¼ŒNebulaGraph ä» v3.0 ä»¥åå…è®¸äº†æ— ç´¢å¼•çš„æŸ¥è¯¢æƒ…å½¢ï¼ˆå› ä¸ºç‚¹è¾¹æ•°æ®æ‰«ææ”¯æŒäº† Limit ä¸‹æ¨ï¼Œä¸å†åƒä¹‹å‰é‚£ä¹ˆæ˜‚è´µï¼‰ï¼Œåœ¨æ²¡æœ‰ç´¢å¼•å¯ä»¥è¢«é€‰æ‹©çš„æƒ…å†µä¸‹ï¼Œplanner ä¹Ÿä¼šé€‰æ‹©ç›´æ¥æ‰«ç‚¹æˆ–è€…è¾¹çš„æ•°æ®ï¼Œè¿™ä¸ªå·®åˆ«å¯ä»¥ä» explain, profile ä¸­çœ‹å‡ºæ¥ã€‚ è¿™é‡Œç”¨ Basketballplayer æ•°æ®é›†ä¸­è‡ªå¸¦çš„ç´¢å¼•æ¥è·ç¦»ï¼Œæ³¨æ„åˆ°å…¶ä¸­åªåœ¨ player è¿™ä¸ª TAG ä¸Šæœ‰ä¸¤ä¸ªç´¢å¼•ï¼š (root@nebula) [basketballplayer]\u003e SHOW TAG INDEXES +------------------+----------+----------+ | Index Name | By Tag | Columns | +------------------+----------+----------+ | \"player_index_0\" | \"player\" | [] | | \"player_index_1\" | \"player\" | [\"name\"] | +------------------+----------+----------+ Got 2 rows (time spent 2440/19653 us) 4.1.1 æ— ç´¢å¼•æŸ¥è¯¢å…ˆçœ‹ä¸€ä¸ªæ²¡æœ‰ç´¢å¼•çš„åœºæ™¯çš„æŸ¥è¯¢ï¼š (root@nebula) [basketballplayer]\u003e PROFILE MATCH (n:team) RETURN id(n) LIMIT 1 +-----------+ | id(n) | +-----------+ | \"team206\" | +-----------+ Got 1 rows (time spent 3637/17551 us) Execution Plan (optimize time 265 us) -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | id | name | dependencies | profiling data | operator info | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 15 | Project | 16 | ver: 0, rows: 1, execTime: 28us, totalTime: 29us | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"id(n)\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__DataCollect_8\" | | | | | | } | | | | | | inputVar: __Limit_13 | | | | | | columns: [ | | | | | | \"id($-.n)\" | | | | | | ] | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 16 | Limit | 17 | ver: 0, rows: 1, execTime: 3us, totalTime: 8us | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"n\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Limit_13\" | | | | | | } | | | | | | inputVar: __AppendVertices_17 | | | | | | offset: 0 | | | | | | count: 1 | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 17 | AppendVertices | 18 | { | outputVar: { | | | | | ver: 0, rows: 3, execTime: 244us, totalTime: 1124us | \"colNames\": [ | | | | | \"storaged0\":9779 exec/total: 257(us)/779(us) | \"n\" | | | | | \"storaged2\":9779 exec/total: 190(us)/870(us) | ], | | | | | total_rpc: 1024(us) | \"type\": \"DATASET\", | | | | | \"storaged1\":9779 exec/total: 195(us)/879(us) | \"name\": \"__AppendVertices_17\" | | | | | } | } | | | | | | inputVar: __ScanVertices_18 | | | | | | space: 2 | | | | | | dedup: true | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: $-._vid | | | | | | props: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"name\", | | | | | | \"age\", | | | | | | \"_tag\" | | | | | | ], | | | | | | \"tagId\": 3 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"name\", | | | | | | \"_tag\" | | | | | | ], | | | | | | \"tagId\": 4 | | | | | | } | | | | | | ] | | | | | | exprs: | | | | | | vertex_filter: | | | | | | if_track_previous_path: false | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 18 | ScanVertices | 3 | { | outputVar: { | | | | | ver: 0, rows: 3, execTime: 225us, totalTime: 1586us | \"colNames\": [ | | | | | \"storaged2\":9779 exec/total: 532(us)/1303(us) | \"_vid\", | | | | | \"storaged1\":9779 exec/total: 480(us)/1318(us) | \"team._tag\" | | | | | total_rpc: 1502(us) | ], | | | | | \"storaged0\":9779 exec/total: 506(us)/1382(us) | \"type\": \"DATASET\", | | | | | } | \"name\": \"__ScanVertices_18\" | | | | | | } | | | | | | inputVar: | | | | | | space: 2 | | | | | | dedup: false | | | | | | limit: 1 | | | | | | filter: (team._tag IS NOT EMPTY AND team._tag IS NOT EMPTY) | | | | | | orderBy: [] | | | | ","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:1","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#æ— ç´¢å¼•æŸ¥è¯¢"},{"categories":["Nebula Graph"],"content":" 4.1 è§‚å¯ŸåŸºäºç´¢å¼•ä¸æ•°æ®çš„æ‰«ææˆ‘åœ¨ç´¢å¼•è¯¦è§£ä¸­è§£é‡Šè¿‡ NebulaGraph çš„ç´¢å¼•å’Œä¼ ç»Ÿæ•°æ®åº“ä¸­ç´¢å¼•çš„åŒºåˆ«ï¼Œç®€å•æ¥è¯´ï¼Œå› ä¸ºä»¥ç±»ä¼¼äºé‚»æ¥è¡¨çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼ŒNebulaGraph é‡Œéœ€è¦æ˜ç¡®æŒ‡å®šé¢å¤–åˆ›å»ºç´¢å¼•æ¥è§£å†³å…¨æ‰«ææˆ–è€…æ ¹æ®å±æ€§æ¡ä»¶æ‰«æç‚¹ã€è¾¹çš„ç±»ä¼¼äºè¡¨ç»“æ„æ•°æ®åº“ä¸­çš„åœºæ™¯ã€‚ å¦å¤–ï¼Œåœ¨æ— è¿‡æ»¤æ¡ä»¶ Limit é‡‡æ ·æ‰«æçš„åœºæ™¯ä¸‹ï¼ŒNebulaGraph ä» v3.0 ä»¥åå…è®¸äº†æ— ç´¢å¼•çš„æŸ¥è¯¢æƒ…å½¢ï¼ˆå› ä¸ºç‚¹è¾¹æ•°æ®æ‰«ææ”¯æŒäº† Limit ä¸‹æ¨ï¼Œä¸å†åƒä¹‹å‰é‚£ä¹ˆæ˜‚è´µï¼‰ï¼Œåœ¨æ²¡æœ‰ç´¢å¼•å¯ä»¥è¢«é€‰æ‹©çš„æƒ…å†µä¸‹ï¼Œplanner ä¹Ÿä¼šé€‰æ‹©ç›´æ¥æ‰«ç‚¹æˆ–è€…è¾¹çš„æ•°æ®ï¼Œè¿™ä¸ªå·®åˆ«å¯ä»¥ä» explain, profile ä¸­çœ‹å‡ºæ¥ã€‚ è¿™é‡Œç”¨ Basketballplayer æ•°æ®é›†ä¸­è‡ªå¸¦çš„ç´¢å¼•æ¥è·ç¦»ï¼Œæ³¨æ„åˆ°å…¶ä¸­åªåœ¨ player è¿™ä¸ª TAG ä¸Šæœ‰ä¸¤ä¸ªç´¢å¼•ï¼š (root@nebula) [basketballplayer]\u003e SHOW TAG INDEXES +------------------+----------+----------+ | Index Name | By Tag | Columns | +------------------+----------+----------+ | \"player_index_0\" | \"player\" | [] | | \"player_index_1\" | \"player\" | [\"name\"] | +------------------+----------+----------+ Got 2 rows (time spent 2440/19653 us) 4.1.1 æ— ç´¢å¼•æŸ¥è¯¢å…ˆçœ‹ä¸€ä¸ªæ²¡æœ‰ç´¢å¼•çš„åœºæ™¯çš„æŸ¥è¯¢ï¼š (root@nebula) [basketballplayer]\u003e PROFILE MATCH (n:team) RETURN id(n) LIMIT 1 +-----------+ | id(n) | +-----------+ | \"team206\" | +-----------+ Got 1 rows (time spent 3637/17551 us) Execution Plan (optimize time 265 us) -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | id | name | dependencies | profiling data | operator info | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 15 | Project | 16 | ver: 0, rows: 1, execTime: 28us, totalTime: 29us | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"id(n)\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__DataCollect_8\" | | | | | | } | | | | | | inputVar: __Limit_13 | | | | | | columns: [ | | | | | | \"id($-.n)\" | | | | | | ] | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 16 | Limit | 17 | ver: 0, rows: 1, execTime: 3us, totalTime: 8us | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"n\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Limit_13\" | | | | | | } | | | | | | inputVar: __AppendVertices_17 | | | | | | offset: 0 | | | | | | count: 1 | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 17 | AppendVertices | 18 | { | outputVar: { | | | | | ver: 0, rows: 3, execTime: 244us, totalTime: 1124us | \"colNames\": [ | | | | | \"storaged0\":9779 exec/total: 257(us)/779(us) | \"n\" | | | | | \"storaged2\":9779 exec/total: 190(us)/870(us) | ], | | | | | total_rpc: 1024(us) | \"type\": \"DATASET\", | | | | | \"storaged1\":9779 exec/total: 195(us)/879(us) | \"name\": \"__AppendVertices_17\" | | | | | } | } | | | | | | inputVar: __ScanVertices_18 | | | | | | space: 2 | | | | | | dedup: true | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: $-._vid | | | | | | props: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"name\", | | | | | | \"age\", | | | | | | \"_tag\" | | | | | | ], | | | | | | \"tagId\": 3 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"name\", | | | | | | \"_tag\" | | | | | | ], | | | | | | \"tagId\": 4 | | | | | | } | | | | | | ] | | | | | | exprs: | | | | | | vertex_filter: | | | | | | if_track_previous_path: false | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 18 | ScanVertices | 3 | { | outputVar: { | | | | | ver: 0, rows: 3, execTime: 225us, totalTime: 1586us | \"colNames\": [ | | | | | \"storaged2\":9779 exec/total: 532(us)/1303(us) | \"_vid\", | | | | | \"storaged1\":9779 exec/total: 480(us)/1318(us) | \"team._tag\" | | | | | total_rpc: 1502(us) | ], | | | | | \"storaged0\":9779 exec/total: 506(us)/1382(us) | \"type\": \"DATASET\", | | | | | } | \"name\": \"__ScanVertices_18\" | | | | | | } | | | | | | inputVar: | | | | | | space: 2 | | | | | | dedup: false | | | | | | limit: 1 | | | | | | filter: (team._tag IS NOT EMPTY AND team._tag IS NOT EMPTY) | | | | | | orderBy: [] | | | | ","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:1","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#æœ‰ç´¢å¼•æŸ¥è¯¢limit-æ— ä¸‹æ¨"},{"categories":["Nebula Graph"],"content":" 4.1 è§‚å¯ŸåŸºäºç´¢å¼•ä¸æ•°æ®çš„æ‰«ææˆ‘åœ¨ç´¢å¼•è¯¦è§£ä¸­è§£é‡Šè¿‡ NebulaGraph çš„ç´¢å¼•å’Œä¼ ç»Ÿæ•°æ®åº“ä¸­ç´¢å¼•çš„åŒºåˆ«ï¼Œç®€å•æ¥è¯´ï¼Œå› ä¸ºä»¥ç±»ä¼¼äºé‚»æ¥è¡¨çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼ŒNebulaGraph é‡Œéœ€è¦æ˜ç¡®æŒ‡å®šé¢å¤–åˆ›å»ºç´¢å¼•æ¥è§£å†³å…¨æ‰«ææˆ–è€…æ ¹æ®å±æ€§æ¡ä»¶æ‰«æç‚¹ã€è¾¹çš„ç±»ä¼¼äºè¡¨ç»“æ„æ•°æ®åº“ä¸­çš„åœºæ™¯ã€‚ å¦å¤–ï¼Œåœ¨æ— è¿‡æ»¤æ¡ä»¶ Limit é‡‡æ ·æ‰«æçš„åœºæ™¯ä¸‹ï¼ŒNebulaGraph ä» v3.0 ä»¥åå…è®¸äº†æ— ç´¢å¼•çš„æŸ¥è¯¢æƒ…å½¢ï¼ˆå› ä¸ºç‚¹è¾¹æ•°æ®æ‰«ææ”¯æŒäº† Limit ä¸‹æ¨ï¼Œä¸å†åƒä¹‹å‰é‚£ä¹ˆæ˜‚è´µï¼‰ï¼Œåœ¨æ²¡æœ‰ç´¢å¼•å¯ä»¥è¢«é€‰æ‹©çš„æƒ…å†µä¸‹ï¼Œplanner ä¹Ÿä¼šé€‰æ‹©ç›´æ¥æ‰«ç‚¹æˆ–è€…è¾¹çš„æ•°æ®ï¼Œè¿™ä¸ªå·®åˆ«å¯ä»¥ä» explain, profile ä¸­çœ‹å‡ºæ¥ã€‚ è¿™é‡Œç”¨ Basketballplayer æ•°æ®é›†ä¸­è‡ªå¸¦çš„ç´¢å¼•æ¥è·ç¦»ï¼Œæ³¨æ„åˆ°å…¶ä¸­åªåœ¨ player è¿™ä¸ª TAG ä¸Šæœ‰ä¸¤ä¸ªç´¢å¼•ï¼š (root@nebula) [basketballplayer]\u003e SHOW TAG INDEXES +------------------+----------+----------+ | Index Name | By Tag | Columns | +------------------+----------+----------+ | \"player_index_0\" | \"player\" | [] | | \"player_index_1\" | \"player\" | [\"name\"] | +------------------+----------+----------+ Got 2 rows (time spent 2440/19653 us) 4.1.1 æ— ç´¢å¼•æŸ¥è¯¢å…ˆçœ‹ä¸€ä¸ªæ²¡æœ‰ç´¢å¼•çš„åœºæ™¯çš„æŸ¥è¯¢ï¼š (root@nebula) [basketballplayer]\u003e PROFILE MATCH (n:team) RETURN id(n) LIMIT 1 +-----------+ | id(n) | +-----------+ | \"team206\" | +-----------+ Got 1 rows (time spent 3637/17551 us) Execution Plan (optimize time 265 us) -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | id | name | dependencies | profiling data | operator info | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 15 | Project | 16 | ver: 0, rows: 1, execTime: 28us, totalTime: 29us | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"id(n)\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__DataCollect_8\" | | | | | | } | | | | | | inputVar: __Limit_13 | | | | | | columns: [ | | | | | | \"id($-.n)\" | | | | | | ] | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 16 | Limit | 17 | ver: 0, rows: 1, execTime: 3us, totalTime: 8us | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"n\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Limit_13\" | | | | | | } | | | | | | inputVar: __AppendVertices_17 | | | | | | offset: 0 | | | | | | count: 1 | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 17 | AppendVertices | 18 | { | outputVar: { | | | | | ver: 0, rows: 3, execTime: 244us, totalTime: 1124us | \"colNames\": [ | | | | | \"storaged0\":9779 exec/total: 257(us)/779(us) | \"n\" | | | | | \"storaged2\":9779 exec/total: 190(us)/870(us) | ], | | | | | total_rpc: 1024(us) | \"type\": \"DATASET\", | | | | | \"storaged1\":9779 exec/total: 195(us)/879(us) | \"name\": \"__AppendVertices_17\" | | | | | } | } | | | | | | inputVar: __ScanVertices_18 | | | | | | space: 2 | | | | | | dedup: true | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: $-._vid | | | | | | props: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"name\", | | | | | | \"age\", | | | | | | \"_tag\" | | | | | | ], | | | | | | \"tagId\": 3 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"name\", | | | | | | \"_tag\" | | | | | | ], | | | | | | \"tagId\": 4 | | | | | | } | | | | | | ] | | | | | | exprs: | | | | | | vertex_filter: | | | | | | if_track_previous_path: false | -----+----------------+--------------+-----------------------------------------------------+-------------------------------------------------------------- | 18 | ScanVertices | 3 | { | outputVar: { | | | | | ver: 0, rows: 3, execTime: 225us, totalTime: 1586us | \"colNames\": [ | | | | | \"storaged2\":9779 exec/total: 532(us)/1303(us) | \"_vid\", | | | | | \"storaged1\":9779 exec/total: 480(us)/1318(us) | \"team._tag\" | | | | | total_rpc: 1502(us) | ], | | | | | \"storaged0\":9779 exec/total: 506(us)/1382(us) | \"type\": \"DATASET\", | | | | | } | \"name\": \"__ScanVertices_18\" | | | | | | } | | | | | | inputVar: | | | | | | space: 2 | | | | | | dedup: false | | | | | | limit: 1 | | | | | | filter: (team._tag IS NOT EMPTY AND team._tag IS NOT EMPTY) | | | | | | orderBy: [] | | | | ","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:1","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#æœ‰ç´¢å¼•æŸ¥è¯¢limit-ä¸‹æ¨"},{"categories":["Nebula Graph"],"content":" 4.2 è§‚å¯Ÿ filter ä¸‹æ¨æˆ‘ä»¬å…ˆçœ‹çœ‹è¿™ä¸ªæŸ¥è¯¢ï¼Œå®ƒæ²¿ç€ç»™å®šèµ·ç‚¹å‘å¤–å›¾æ‰©å±•çš„æŸ¥è¯¢ï¼Œæ ¹æ®è¾¹çš„å±æ€§æ¡ä»¶è¿‡æ»¤ï¼Œè¿”å›ç›®çš„ç‚¹ IDï¼š GO FROM \"player100\" OVER follow WHERE properties(edge).degree \u003e 1 YIELD follow._dst å®ƒçš„æ‰§è¡Œè®¡åˆ’æ˜¯ï¼š (root@nebula) [basketballplayer]\u003e explain GO FROM \"player100\" OVER follow WHERE properties(edge).degree \u003e 1 YIELD follow._dst Execution succeeded (time spent 959/7917 us) Execution Plan (optimize time 369 us) -----+--------------+--------------+----------------+----------------------------------------- | id | name | dependencies | profiling data | operator info | -----+--------------+--------------+----------------+----------------------------------------- | 3 | Project | 2 | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"follow._dst\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Project_3\" | | | | | | } | | | | | | inputVar: __Filter_2 | | | | | | columns: [ | | | | | | \"follow._dst\" | | | | | | ] | -----+--------------+--------------+----------------+----------------------------------------- | 2 | Filter | 1 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Filter_2\" | | | | | | } | | | | | | inputVar: __GetNeighbors_1 | | | | | | condition: (properties(EDGE).degree\u003e1) | | | | | | isStable: false | -----+--------------+--------------+----------------+----------------------------------------- | 1 | GetNeighbors | 0 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__GetNeighbors_1\" | | | | | | } | | | | | | inputVar: __VAR_0 | | | | | | space: 49 | | | | | | dedup: false | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: COLUMN[0] | | | | | | edgeTypes: [] | | | | | | edgeDirection: OUT_EDGE | | | | | | vertexProps: | | | | | | edgeProps: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_rank\", | | | | | | \"_src\", | | | | | | \"_type\", | | | | | | \"degree\" | | | | | | ], | | | | | | \"type\": 53 | | | | | | } | | | | | | ] | | | | | | statProps: | | | | | | exprs: | | | | | | random: false | -----+--------------+--------------+----------------+----------------------------------------- | 0 | Start | | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Start_0\" | | | | | | } | -----+--------------+--------------+----------------+----------------------------------------- å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªè®¡åˆ’é‡Œï¼ŒGetNeighboors ç®—å­å–å¾—äº†æ‰€æœ‰çš„ player100 çš„å‡ºè¾¹ï¼ˆä»¥åŠè¾¹å±æ€§ï¼‰ï¼Œç„¶åå†é€šè¿‡å•ç‹¬ Filter ç®—å­ã€‚ æˆ‘ä»¬å…³æ³¨ï¼š filter: æ˜¯ç©ºçš„ properties(EDGE).degree\u003e1 ä½œä¸º Filter ç®—å­çš„æ¡ä»¶ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰æ²¡æœ‰å¯èƒ½æŠŠ Filter ä¸‹æ¨å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œåªè¦åœ¨ WHERE æ¡ä»¶ä¸­æä¾›è¾¹ç±»å‹çš„ä¿¡æ¯ï¼Œä¼˜åŒ–æ¡ä»¶å°±å¯ä»¥æŠŠå®ƒä¸‹æ¨åˆ° GetNeighbors ç®—å­ï¼š (root@nebula) [basketballplayer]\u003e explain GO FROM \"player100\" OVER follow WHERE follow.degree \u003e 1 YIELD follow._dst Execution succeeded (time spent 664/6650 us) Execution Plan (optimize time 161 us) -----+--------------+--------------+----------------+---------------------------- | id | name | dependencies | profiling data | operator info | -----+--------------+--------------+----------------+---------------------------- | 3 | Project | 4 | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"follow._dst\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Project_3\" | | | | | | } | | | | | | inputVar: __Filter_2 | | | | | | columns: [ | | | | | | \"follow._dst\" | | | | | | ] | -----+--------------+--------------+----------------+---------------------------- | 4 | GetNeighbors | 0 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Filter_2\" | | | | | | } | | | | | | inputVar: __VAR_0 | | | | | | space: 49 | | | | | | dedup: false | | | | | | limit: -1 | | | | | | filter: (follow.degree\u003e1) | | | | | | orderBy: [] | | | | | | src: COLUMN[0] | | | | | | edgeTypes: [] | | | | | | edgeDirection: OUT_EDGE | | | | | | vertexProps: | | | | | | edgeProps: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"degree\" | | | | | | ], | | | | | | \"type\": 53 | | | | | | } | | | | | | ] | | | | | | statProps:","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:2","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#è§‚å¯Ÿ-filter-ä¸‹æ¨"},{"categories":["Nebula Graph"],"content":" 4.3 ä¼˜åŒ–åŸåˆ™ï¼šå‡å°‘æ¨¡ç³Šï¼Œå¢åŠ ç¡®å®šï¼Œè¶Šæ—©è¶Šå¥½è¿™é‡Œæˆ‘ç»™å‡ºä¸‰å¯¹æŸ¥è¯¢çš„æ¯”è¾ƒï¼š GO FROM \"player100\" OVER follow YIELD dst(edge) å¯¹æ¯” GO FROM \"player100\" OVER follow YIELD follow._dst MATCH (:player)-[e]-(:player) RETURN e ä¸ MATCH (:player)-[e:follow]-(:player) RETURN e åœ¨ 1. ä¸­ï¼Œä¸¤è€…çš„å·®å¼‚ä¸åƒå‰æ–‡ä¸­ç»™å‡ºçš„ç®—å­æœ‰ä¸åŒï¼Œè¿™æ¬¡çš„åŒºåˆ«åœ¨äºç®—å­ä¼ é€’çš„æ•°æ®é‡æœ‰ä¸åŒï¼Œdst(edge) çš„è¡¨è¾¾é‡Œï¼Œæˆ‘ä»¬ä¸€æ–¹é¢æ²¡æœ‰ç»™å‡º edge çš„ç±»å‹ï¼Œå¦ä¸€æ–¹é¢æ˜¯é’ˆå¯¹æ•´ä¸ª edge åšäº†å‡½æ•° dst() çš„è¿ç®—ï¼Œè¿™ä½¿å¾— GetNeighbors ç®—å­çš„ edgeProps è¾“å‡ºæ˜¯æ‰€æœ‰çš„å±æ€§ï¼Œåè§‚ follow._dst çš„è¡¨è¾¾ä½¿å¾— edgeProps è¾“å‡ºåªæœ‰è¾¹çš„ _dstï¼Œè¿™å°è¯äº†åœ¨æˆ‘ä»¬å·²çŸ¥è¿”å› follow è¾¹çš„å±æ€§çš„æƒ…å†µä¸‹ï¼Œææ—©ï¼ˆè€Œä¸æ˜¯ç­‰åˆ°è¯­å¥è§£æåˆ° dst(edge) ä¹‹åï¼‰è€Œä¸”ç›´æ¥ç”¨ follow._dst è¡¨è¾¾å¸¦æ¥äº†æ•°æ®ä¼ è¾“ä¸Šçš„ä¼˜åŒ–ã€‚ (root@nebula) [basketballplayer]\u003e explain GO FROM \"player100\" OVER follow YIELD dst(edge) Execution succeeded (time spent 600/7625 us) Execution Plan (optimize time 101 us) -----+--------------+--------------+----------------+------------------------------- | id | name | dependencies | profiling data | operator info | -----+--------------+--------------+----------------+------------------------------- | 2 | Project | 1 | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"dst(EDGE)\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Project_2\" | | | | | | } | | | | | | inputVar: __GetNeighbors_1 | | | | | | columns: [ | | | | | | \"dst(EDGE)\" | | | | | | ] | -----+--------------+--------------+----------------+------------------------------- | 1 | GetNeighbors | 0 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__GetNeighbors_1\" | | | | | | } | | | | | | inputVar: __VAR_0 | | | | | | space: 49 | | | | | | dedup: false | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: COLUMN[0] | | | | | | edgeTypes: [] | | | | | | edgeDirection: OUT_EDGE | | | | | | vertexProps: | | | | | | edgeProps: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_rank\", | | | | | | \"_src\", | | | | | | \"_type\", | | | | | | \"degree\" | | | | | | ], | | | | | | \"type\": 53 | | | | | | } | | | | | | ] | | | | | | statProps: | | | | | | exprs: | | | | | | random: false | -----+--------------+--------------+----------------+------------------------------- | 0 | Start | | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Start_0\" | | | | | | } | -----+--------------+--------------+----------------+------------------------------- Tue, 13 Sep 2022 14:27:27 CST (root@nebula) [basketballplayer]\u003e explain GO FROM \"player100\" OVER follow YIELD follow._dst Execution succeeded (time spent 549/5971 us) Execution Plan (optimize time 91 us) -----+--------------+--------------+----------------+------------------------------- | id | name | dependencies | profiling data | operator info | -----+--------------+--------------+----------------+------------------------------- | 2 | Project | 1 | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"follow._dst\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Project_2\" | | | | | | } | | | | | | inputVar: __GetNeighbors_1 | | | | | | columns: [ | | | | | | \"follow._dst\" | | | | | | ] | -----+--------------+--------------+----------------+------------------------------- | 1 | GetNeighbors | 0 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__GetNeighbors_1\" | | | | | | } | | | | | | inputVar: __VAR_0 | | | | | | space: 49 | | | | | | dedup: false | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: COLUMN[0] | | | | | | edgeTypes: [] | | | | | | edgeDirection: OUT_EDGE | | | | | | vertexProps: | | | | | | edgeProps: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\" | | | | | | ], | | | | | | \"type\": 53 | | | | | | } | | | | | | ] | | | | | | statProps: | | | | | | exprs: | | | | | | random: false | -----+--------------+--------------+----------------+------------------------------- | 0 | Start | | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Start_0\" | | | | | | } | -----+--------------+--------------+--------------","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:3","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#ä¼˜åŒ–åŸåˆ™å‡å°‘æ¨¡ç³Šå¢åŠ ç¡®å®šè¶Šæ—©è¶Šå¥½"},{"categories":["Nebula Graph"],"content":" 4.4 å°ç»ƒä¹ ï¼šç­‰ä»·çš„å¤šç§è¡¨è¾¾çš„ä»£ä»·è¿™æ˜¯ä¸€ä¸ªç”¨æˆ·æçš„ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•è¡¨è¾¾ä¸¤ç‚¹ä¹‹é—´æ˜¯å¦å­˜åœ¨ç›´è¿è¾¹ï¼Ÿ å¯¹äºè¿™ä¹ˆç®€å•çš„è¡¨è¾¾ï¼Œå¤§å®¶åº”è¯¥ç›´æ¥èƒ½æƒ³åˆ°åº”è¯¥æœ‰å¥½å¤šæ–¹æ³•è¡¨è¾¾ï¼š GO FIND PATH MATCH FETCH PROP è¿™é‡Œï¼Œåˆ©ç”¨ FETCH PROP è¡¨è¾¾åŒå‘è¾¹ï¼Œä¼¼ä¹æ˜¯ä¸¤ä¸ªæŸ¥è¯¢ï¼Œæˆ‘ä»¬å…ˆçœç•¥æ‰ï¼Œå¯¹äºå‰©ä¸‹çš„ä¸‰ä¸ªè¡¨è¾¾ï¼Œå“ªä¸€ç§æ›´é€‚åˆå‘¢ï¼Ÿæˆ‘ä»¬å…ˆå†™å‡ºæ¥çœ‹çœ‹ GO FROM \"player100\" over * BIDIRECT WHERE id($$) == \"player101\" YIELD edge AS e FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p MATCH (n)--(m) WHERE id(n) == \"player100\" AND id(m) == \"player101\" RETURN count(*) 4.4.1 GO/MATCH ä¸ FIND PATHä»–ä»¬éƒ½èƒ½è·å¾—æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œæ„Ÿè§‰ä¸Šï¼ŒMATCH å’Œ GO ä¼šæ¯” FIND PATH çš„æŸ¥è¯¢æ›´å¿«ä¸€äº›ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯ä»å•ä¸€èµ·ç‚¹æ‹“å±•ï¼Œè€Œ FIND PATH æ˜¯ä»ä¸¤ç«¯åŒæ—¶æŸ¥è¯¢ï¼Œåœ¨ä¸€è·³çš„æƒ…å†µä¸‹ï¼Œè¿™å…¶å®æ˜¯å†—ä½™çš„åŠ¨ä½œã€‚éªŒè¯ä¸€ä¸‹çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° explain FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p ä¸­æœç„¶æœ‰ä¸¤ä¸ª GetNeighbors ç®—å­ã€‚ (root@nebula) [basketballplayer]\u003e explain FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p Execution succeeded (time spent 818/16537 us) Execution Plan (optimize time 229 us) -----+-----------------+--------------+----------------+------------------------------------ | id | name | dependencies | profiling data | operator info | -----+-----------------+--------------+----------------+------------------------------------ | 9 | DataCollect | 8 | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"p\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__DataCollect_9\" | | | | | | } | | | | | | inputVar: [ | | | | | | { | | | | | | \"colNames\": [ | | | | | | \"_path\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__ProduceAllPaths_5\" | | | | | | } | | | | | | ] | | | | | | distinct: false | | | | | | kind: ALL PATHS | -----+-----------------+--------------+----------------+------------------------------------ | 8 | Loop | 7 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Loop_8\" | | | | | | } | | | | | | inputVar: __VAR_1 | | | | | | condition: (++($__VAR_2)\u003c=1) | | | | | | loopBody: 5 | -----+-----------------+--------------+----------------+------------------------------------ | 5 | ProduceAllPaths | 3,4 | | branch: true, nodeId: 8 | | | | | | | | | | | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"_path\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__ProduceAllPaths_5\" | | | | | | } | | | | | | inputVar: { | | | | | | \"rightVar\": \"__GetNeighbors_4\", | | | | | | \"leftVar\": \"__GetNeighbors_3\" | | | | | | } | | | | | | LeftNextVidVar: \"__VAR_0\" | | | | | | RightNextVidVar: \"__VAR_1\" | | | | | | noloop : false | | | | | | steps: 1 | -----+-----------------+--------------+----------------+------------------------------------ | 3 | GetNeighbors | 2 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__GetNeighbors_3\" | | | | | | } | | | | | | inputVar: __VAR_0 | | | | | | space: 49 | | | | | | dedup: true | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: COLUMN[0] | | | | | | edgeTypes: [] | | | | | | edgeDirection: OUT_EDGE | | | | | | vertexProps: | | | | | | edgeProps: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -52 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -53 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -67 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -68 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -69 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -70 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\"","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:4","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#å°ç»ƒä¹ ç­‰ä»·çš„å¤šç§è¡¨è¾¾çš„ä»£ä»·"},{"categories":["Nebula Graph"],"content":" 4.4 å°ç»ƒä¹ ï¼šç­‰ä»·çš„å¤šç§è¡¨è¾¾çš„ä»£ä»·è¿™æ˜¯ä¸€ä¸ªç”¨æˆ·æçš„ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•è¡¨è¾¾ä¸¤ç‚¹ä¹‹é—´æ˜¯å¦å­˜åœ¨ç›´è¿è¾¹ï¼Ÿ å¯¹äºè¿™ä¹ˆç®€å•çš„è¡¨è¾¾ï¼Œå¤§å®¶åº”è¯¥ç›´æ¥èƒ½æƒ³åˆ°åº”è¯¥æœ‰å¥½å¤šæ–¹æ³•è¡¨è¾¾ï¼š GO FIND PATH MATCH FETCH PROP è¿™é‡Œï¼Œåˆ©ç”¨ FETCH PROP è¡¨è¾¾åŒå‘è¾¹ï¼Œä¼¼ä¹æ˜¯ä¸¤ä¸ªæŸ¥è¯¢ï¼Œæˆ‘ä»¬å…ˆçœç•¥æ‰ï¼Œå¯¹äºå‰©ä¸‹çš„ä¸‰ä¸ªè¡¨è¾¾ï¼Œå“ªä¸€ç§æ›´é€‚åˆå‘¢ï¼Ÿæˆ‘ä»¬å…ˆå†™å‡ºæ¥çœ‹çœ‹ GO FROM \"player100\" over * BIDIRECT WHERE id($$) == \"player101\" YIELD edge AS e FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p MATCH (n)--(m) WHERE id(n) == \"player100\" AND id(m) == \"player101\" RETURN count(*) 4.4.1 GO/MATCH ä¸ FIND PATHä»–ä»¬éƒ½èƒ½è·å¾—æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œæ„Ÿè§‰ä¸Šï¼ŒMATCH å’Œ GO ä¼šæ¯” FIND PATH çš„æŸ¥è¯¢æ›´å¿«ä¸€äº›ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯ä»å•ä¸€èµ·ç‚¹æ‹“å±•ï¼Œè€Œ FIND PATH æ˜¯ä»ä¸¤ç«¯åŒæ—¶æŸ¥è¯¢ï¼Œåœ¨ä¸€è·³çš„æƒ…å†µä¸‹ï¼Œè¿™å…¶å®æ˜¯å†—ä½™çš„åŠ¨ä½œã€‚éªŒè¯ä¸€ä¸‹çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° explain FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p ä¸­æœç„¶æœ‰ä¸¤ä¸ª GetNeighbors ç®—å­ã€‚ (root@nebula) [basketballplayer]\u003e explain FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p Execution succeeded (time spent 818/16537 us) Execution Plan (optimize time 229 us) -----+-----------------+--------------+----------------+------------------------------------ | id | name | dependencies | profiling data | operator info | -----+-----------------+--------------+----------------+------------------------------------ | 9 | DataCollect | 8 | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"p\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__DataCollect_9\" | | | | | | } | | | | | | inputVar: [ | | | | | | { | | | | | | \"colNames\": [ | | | | | | \"_path\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__ProduceAllPaths_5\" | | | | | | } | | | | | | ] | | | | | | distinct: false | | | | | | kind: ALL PATHS | -----+-----------------+--------------+----------------+------------------------------------ | 8 | Loop | 7 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Loop_8\" | | | | | | } | | | | | | inputVar: __VAR_1 | | | | | | condition: (++($__VAR_2)\u003c=1) | | | | | | loopBody: 5 | -----+-----------------+--------------+----------------+------------------------------------ | 5 | ProduceAllPaths | 3,4 | | branch: true, nodeId: 8 | | | | | | | | | | | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"_path\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__ProduceAllPaths_5\" | | | | | | } | | | | | | inputVar: { | | | | | | \"rightVar\": \"__GetNeighbors_4\", | | | | | | \"leftVar\": \"__GetNeighbors_3\" | | | | | | } | | | | | | LeftNextVidVar: \"__VAR_0\" | | | | | | RightNextVidVar: \"__VAR_1\" | | | | | | noloop : false | | | | | | steps: 1 | -----+-----------------+--------------+----------------+------------------------------------ | 3 | GetNeighbors | 2 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__GetNeighbors_3\" | | | | | | } | | | | | | inputVar: __VAR_0 | | | | | | space: 49 | | | | | | dedup: true | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: COLUMN[0] | | | | | | edgeTypes: [] | | | | | | edgeDirection: OUT_EDGE | | | | | | vertexProps: | | | | | | edgeProps: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -52 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -53 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -67 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -68 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -69 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -70 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\"","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:4","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#gomatch-ä¸-find-path"},{"categories":["Nebula Graph"],"content":" 4.4 å°ç»ƒä¹ ï¼šç­‰ä»·çš„å¤šç§è¡¨è¾¾çš„ä»£ä»·è¿™æ˜¯ä¸€ä¸ªç”¨æˆ·æçš„ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•è¡¨è¾¾ä¸¤ç‚¹ä¹‹é—´æ˜¯å¦å­˜åœ¨ç›´è¿è¾¹ï¼Ÿ å¯¹äºè¿™ä¹ˆç®€å•çš„è¡¨è¾¾ï¼Œå¤§å®¶åº”è¯¥ç›´æ¥èƒ½æƒ³åˆ°åº”è¯¥æœ‰å¥½å¤šæ–¹æ³•è¡¨è¾¾ï¼š GO FIND PATH MATCH FETCH PROP è¿™é‡Œï¼Œåˆ©ç”¨ FETCH PROP è¡¨è¾¾åŒå‘è¾¹ï¼Œä¼¼ä¹æ˜¯ä¸¤ä¸ªæŸ¥è¯¢ï¼Œæˆ‘ä»¬å…ˆçœç•¥æ‰ï¼Œå¯¹äºå‰©ä¸‹çš„ä¸‰ä¸ªè¡¨è¾¾ï¼Œå“ªä¸€ç§æ›´é€‚åˆå‘¢ï¼Ÿæˆ‘ä»¬å…ˆå†™å‡ºæ¥çœ‹çœ‹ GO FROM \"player100\" over * BIDIRECT WHERE id($$) == \"player101\" YIELD edge AS e FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p MATCH (n)--(m) WHERE id(n) == \"player100\" AND id(m) == \"player101\" RETURN count(*) 4.4.1 GO/MATCH ä¸ FIND PATHä»–ä»¬éƒ½èƒ½è·å¾—æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œæ„Ÿè§‰ä¸Šï¼ŒMATCH å’Œ GO ä¼šæ¯” FIND PATH çš„æŸ¥è¯¢æ›´å¿«ä¸€äº›ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯ä»å•ä¸€èµ·ç‚¹æ‹“å±•ï¼Œè€Œ FIND PATH æ˜¯ä»ä¸¤ç«¯åŒæ—¶æŸ¥è¯¢ï¼Œåœ¨ä¸€è·³çš„æƒ…å†µä¸‹ï¼Œè¿™å…¶å®æ˜¯å†—ä½™çš„åŠ¨ä½œã€‚éªŒè¯ä¸€ä¸‹çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° explain FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p ä¸­æœç„¶æœ‰ä¸¤ä¸ª GetNeighbors ç®—å­ã€‚ (root@nebula) [basketballplayer]\u003e explain FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p Execution succeeded (time spent 818/16537 us) Execution Plan (optimize time 229 us) -----+-----------------+--------------+----------------+------------------------------------ | id | name | dependencies | profiling data | operator info | -----+-----------------+--------------+----------------+------------------------------------ | 9 | DataCollect | 8 | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"p\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__DataCollect_9\" | | | | | | } | | | | | | inputVar: [ | | | | | | { | | | | | | \"colNames\": [ | | | | | | \"_path\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__ProduceAllPaths_5\" | | | | | | } | | | | | | ] | | | | | | distinct: false | | | | | | kind: ALL PATHS | -----+-----------------+--------------+----------------+------------------------------------ | 8 | Loop | 7 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Loop_8\" | | | | | | } | | | | | | inputVar: __VAR_1 | | | | | | condition: (++($__VAR_2)\u003c=1) | | | | | | loopBody: 5 | -----+-----------------+--------------+----------------+------------------------------------ | 5 | ProduceAllPaths | 3,4 | | branch: true, nodeId: 8 | | | | | | | | | | | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"_path\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__ProduceAllPaths_5\" | | | | | | } | | | | | | inputVar: { | | | | | | \"rightVar\": \"__GetNeighbors_4\", | | | | | | \"leftVar\": \"__GetNeighbors_3\" | | | | | | } | | | | | | LeftNextVidVar: \"__VAR_0\" | | | | | | RightNextVidVar: \"__VAR_1\" | | | | | | noloop : false | | | | | | steps: 1 | -----+-----------------+--------------+----------------+------------------------------------ | 3 | GetNeighbors | 2 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__GetNeighbors_3\" | | | | | | } | | | | | | inputVar: __VAR_0 | | | | | | space: 49 | | | | | | dedup: true | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: COLUMN[0] | | | | | | edgeTypes: [] | | | | | | edgeDirection: OUT_EDGE | | | | | | vertexProps: | | | | | | edgeProps: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -52 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -53 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -67 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -68 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -69 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -70 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\"","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:4","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#go-ä¸-match"},{"categories":["Nebula Graph"],"content":" 4.4 å°ç»ƒä¹ ï¼šç­‰ä»·çš„å¤šç§è¡¨è¾¾çš„ä»£ä»·è¿™æ˜¯ä¸€ä¸ªç”¨æˆ·æçš„ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•è¡¨è¾¾ä¸¤ç‚¹ä¹‹é—´æ˜¯å¦å­˜åœ¨ç›´è¿è¾¹ï¼Ÿ å¯¹äºè¿™ä¹ˆç®€å•çš„è¡¨è¾¾ï¼Œå¤§å®¶åº”è¯¥ç›´æ¥èƒ½æƒ³åˆ°åº”è¯¥æœ‰å¥½å¤šæ–¹æ³•è¡¨è¾¾ï¼š GO FIND PATH MATCH FETCH PROP è¿™é‡Œï¼Œåˆ©ç”¨ FETCH PROP è¡¨è¾¾åŒå‘è¾¹ï¼Œä¼¼ä¹æ˜¯ä¸¤ä¸ªæŸ¥è¯¢ï¼Œæˆ‘ä»¬å…ˆçœç•¥æ‰ï¼Œå¯¹äºå‰©ä¸‹çš„ä¸‰ä¸ªè¡¨è¾¾ï¼Œå“ªä¸€ç§æ›´é€‚åˆå‘¢ï¼Ÿæˆ‘ä»¬å…ˆå†™å‡ºæ¥çœ‹çœ‹ GO FROM \"player100\" over * BIDIRECT WHERE id($$) == \"player101\" YIELD edge AS e FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p MATCH (n)--(m) WHERE id(n) == \"player100\" AND id(m) == \"player101\" RETURN count(*) 4.4.1 GO/MATCH ä¸ FIND PATHä»–ä»¬éƒ½èƒ½è·å¾—æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œæ„Ÿè§‰ä¸Šï¼ŒMATCH å’Œ GO ä¼šæ¯” FIND PATH çš„æŸ¥è¯¢æ›´å¿«ä¸€äº›ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯ä»å•ä¸€èµ·ç‚¹æ‹“å±•ï¼Œè€Œ FIND PATH æ˜¯ä»ä¸¤ç«¯åŒæ—¶æŸ¥è¯¢ï¼Œåœ¨ä¸€è·³çš„æƒ…å†µä¸‹ï¼Œè¿™å…¶å®æ˜¯å†—ä½™çš„åŠ¨ä½œã€‚éªŒè¯ä¸€ä¸‹çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° explain FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p ä¸­æœç„¶æœ‰ä¸¤ä¸ª GetNeighbors ç®—å­ã€‚ (root@nebula) [basketballplayer]\u003e explain FIND ALL PATH FROM \"player100\" TO \"player101\" OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p Execution succeeded (time spent 818/16537 us) Execution Plan (optimize time 229 us) -----+-----------------+--------------+----------------+------------------------------------ | id | name | dependencies | profiling data | operator info | -----+-----------------+--------------+----------------+------------------------------------ | 9 | DataCollect | 8 | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"p\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__DataCollect_9\" | | | | | | } | | | | | | inputVar: [ | | | | | | { | | | | | | \"colNames\": [ | | | | | | \"_path\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__ProduceAllPaths_5\" | | | | | | } | | | | | | ] | | | | | | distinct: false | | | | | | kind: ALL PATHS | -----+-----------------+--------------+----------------+------------------------------------ | 8 | Loop | 7 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Loop_8\" | | | | | | } | | | | | | inputVar: __VAR_1 | | | | | | condition: (++($__VAR_2)\u003c=1) | | | | | | loopBody: 5 | -----+-----------------+--------------+----------------+------------------------------------ | 5 | ProduceAllPaths | 3,4 | | branch: true, nodeId: 8 | | | | | | | | | | | | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"_path\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__ProduceAllPaths_5\" | | | | | | } | | | | | | inputVar: { | | | | | | \"rightVar\": \"__GetNeighbors_4\", | | | | | | \"leftVar\": \"__GetNeighbors_3\" | | | | | | } | | | | | | LeftNextVidVar: \"__VAR_0\" | | | | | | RightNextVidVar: \"__VAR_1\" | | | | | | noloop : false | | | | | | steps: 1 | -----+-----------------+--------------+----------------+------------------------------------ | 3 | GetNeighbors | 2 | | outputVar: { | | | | | | \"colNames\": [], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__GetNeighbors_3\" | | | | | | } | | | | | | inputVar: __VAR_0 | | | | | | space: 49 | | | | | | dedup: true | | | | | | limit: -1 | | | | | | filter: | | | | | | orderBy: [] | | | | | | src: COLUMN[0] | | | | | | edgeTypes: [] | | | | | | edgeDirection: OUT_EDGE | | | | | | vertexProps: | | | | | | edgeProps: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -52 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -53 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -67 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -68 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -69 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\", | | | | | | \"_type\", | | | | | | \"_rank\" | | | | | | ], | | | | | | \"type\": -70 | | | | | | }, | | | | | | { | | | | | | \"props\": [ | | | | | | \"_dst\"","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:4","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#æ›´ä¼˜çš„-go-è¡¨è¾¾"},{"categories":["Nebula Graph"],"content":" 4.5 ç´¢å¼•çš„å‘½ä¸­åœ¨æœ¬ç¯‡ç»“æŸä¹‹å‰ï¼Œæˆ‘è¿˜æƒ³å†ç»™ä¸€ä¸ªç´¢å¼•æŸ¥è¯¢çš„ä¾‹å­ï¼Œé¦–å…ˆï¼Œå‡è®¾ç¯å¢ƒé‡Œåªå­˜åœ¨ player() å’Œ player.name ä¸Šçš„ç´¢å¼•ï¼Œæ²¡æœ‰ player.age ä¸Šçš„ç´¢å¼•ã€‚ (root@nebula) [basketballplayer]\u003e SHOW TAG INDEXES +------------------+----------+----------+ | Index Name | By Tag | Columns | +------------------+----------+----------+ | \"player_index_0\" | \"player\" | [] | | \"player_index_1\" | \"player\" | [\"name\"] | +------------------+----------+----------+ Got 2 rows (time spent 2440/19653 us) å†æ¬¡å¼ºè°ƒä¸€ä¸‹ï¼Œåœ¨ NebulaGraph ä¸­ï¼Œåªæœ‰æ—  ID æ¡ä»¶çš„èµ·ç‚¹æ‰æ¶‰åŠç´¢å¼•ï¼Œè€Œè¿™ç±»èµ·ç‚¹æŸ¥è¯¢å…¶å®æ˜¯ä¸€ä¸ªå…¸å‹çš„éå›¾åº“æŸ¥è¯¢ã€‚ç›¸åï¼Œç‚¹çš„æ‹“å±•æ˜¯æ— å…³ NebulaGraph ç´¢å¼•çš„ã€‚ è¿™é‡Œçš„ä¾‹å­ä¹Ÿæ˜¯åªæ¶‰åŠèµ·ç‚¹æŸ¥è¯¢ï¼Œç±»ä¼¼äº SELECT * FROM player WHERE ... çš„è¡¨è¾¾ï¼Œè¿™ä¸‰ä¸ªæŸ¥è¯¢ MATCH (n:player) WHERE n.player.age \u003e 50 RETURN n MATCH (n:player) WHERE n.player.name \u003e \"T\" RETURN n MATCH (n:team) WHERE n.team.name \u003e \"T\" RETURN n ä¹‹ä¸­åªæœ‰ 1.ï¼Œ2. æ˜¯å…è®¸çš„æŸ¥è¯¢ï¼Œ3. å› ä¸ºæŸ¥è¯¢æ¶‰åŠæ•°æ®å…¨æ‰«æè€Œè¢« NebulaGraph ç¦æ­¢ï¼Œå› ä¸ºä¸å­˜åœ¨ team ä¹‹ä¸­çš„ç´¢å¼•ï¼Œè¿™æ ·çš„å…¨æ‰«ææ˜¯å¾ˆæ˜‚è´µçš„ï¼š (root@nebula) [basketballplayer]\u003e match (n:team) WHERE n.team.name \u003e \"T\" RETURN n [ERROR (-1005)]: IndexNotFound: No valid index found è€Œ 1. ä¸ 2. çš„æƒ…å†µåˆæœ‰ä¸åŒï¼Œ1. ä¸­çš„è¿‡æ»¤æ¡ä»¶ n.player.age \u003e 50 æ¶‰åŠæœªè¢«ç´¢å¼•çš„å­—æ®µï¼Œè¿™ä¸ªè¿‡æ»¤æ˜¯æ— æ³•è¢«ä¸‹æ¨åˆ° IndexScan ç®—å­çš„ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰çš„ player éƒ½ä¼šè¢«æ‰«æåˆ° GraphD ä¸­ï¼Œç„¶åå†è¿›ä¸€æ­¥è¿›è¡Œ Filter ç®—å­çš„è¿‡æ»¤è®¡ç®—ã€‚ ç´¢å¼•è®¾è®¡çš„æ–‡ç« å‚è€ƒï¼šhttps://nebula-graph.com.cn/posts/how-indexing-works-in-nebula-graphï¼Œå¦‚ä¸‹æ˜¯æ–‡ä¸­ä»‹ç»çš„ç‚¹ç´¢å¼•åœ¨ RocksDB ä¸­çš„æ•°æ®ç»“æ„ã€‚ é€šè¿‡ä¸¤ä¸ªæŸ¥è¯¢çš„ profile åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ¥šåœ°çœ‹åˆ°ï¼š IndexScan åœ¨ 1. æŸ¥è¯¢ä¸­æ²¡æœ‰ columnHints ä¿¡æ¯ï¼Œæ‰«æçš„è¡Œæ•°ä¸º rows: 52ï¼ˆè¿™æ˜¯æ‰€æœ‰çš„ player é¡¶ç‚¹æ•°é‡ï¼‰ IndexScan åœ¨ 2. æŸ¥è¯¢ä¸­æœ‰ columnHints ä¿¡æ¯ï¼Œæ‰«æçš„è¡Œæ•°åªæœ‰ rows: 6 æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨çœŸçš„éœ€è¦è¿™ç§ä»å±æ€§åæŸ¥å›¾æ¢ç´¢èµ·ç‚¹çš„æ—¶å€™ï¼Œè¦æ ¹æ®å®é™…æŸ¥è¯¢éœ€æ±‚å»æ–Ÿé…Œç´¢å¼•çš„åˆ›å»ºã€‚ (root@nebula) [basketballplayer]\u003e profile MATCH (n:player) WHERE n.player.age \u003e 50 RETURN n +---+ | n | +---+ +---+ Empty set (time spent 8468/25278 us) Execution Plan (optimize time 442 us) -----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------- | id | name | dependencies | profiling data | operator info | -----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------- | 6 | Project | 5 | ver: 0, rows: 0, execTime: 19us, totalTime: 22us | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"n\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Project_6\" | | | | | | } | | | | | | inputVar: __Filter_5 | | | | | | columns: [ | | | | | | \"$n\" | | | | | | ] | -----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------- | 5 | Filter | 9 | ver: 0, rows: 0, execTime: 74us, totalTime: 75us | outputVar: { | | | | | | \"colNames\": [ | | | | | | \"n\" | | | | | | ], | | | | | | \"type\": \"DATASET\", | | | | | | \"name\": \"__Filter_5\" | | | | | | } | | | | | | inputVar: __Project_4 | | | | | | condition: (n.player.age\u003e50) | | | | | | isStable: false | -----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------- | 9 | AppendVertices | 7 | { | outputVar: { | | | | | ver: 0, rows: 51, execTime: 841us, totalTime: 4481us | \"colNames\": [ | | | | | total_rpc: 4018(us) | \"n\" | | | | | \"storaged1\":9779 exec/total: 1591(us)/2868(us) | ], | | | | | \"storaged0\":9779 exec/total: 1532(us)/2672(us) | \"type\": \"DATASET\", | | | | | \"storaged2\":9779 exec/total: 2510(us)/3733(us) | \"name\": \"__Project_4\" | | | | | } | } | | | | | | inputVar: __IndexScan_1 | | | | | | space: 49 | | | | | | dedup: true | | | | | | limit: -1 | | | | | | filter: player._tag IS NOT EMPTY | | | | | | orderBy: [] | | | | | | src: $_vid | | | | | | props: [ | | | | | | { | | | | | | \"props\": [ | | | | | | \"name\", | | | | | | \"age\", | | | | | | \"_tag\" | | | | | | ], | | | | | | \"tagId\": 59 | | | | | | ","date":"2022-09-06","objectID":"/ngql-execution-plan/:4:5","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#ç´¢å¼•çš„å‘½ä¸­"},{"categories":["Nebula Graph"],"content":" 5 å°ç»“åœ¨ç†è§£äº† NebulaGraph çš„åŸºæœ¬æ¶æ„è®¾è®¡ã€å­˜å‚¨æ ¼å¼ã€æŸ¥è¯¢çš„ç®€å•è°ƒç”¨æµç¨‹å’Œå¸¸è§çš„ä¼˜åŒ–è§„åˆ™ä¹‹åï¼Œç»“åˆ PROFILE/EXPLAINï¼Œæˆ‘ä»¬å¯ä»¥ä¸€ç‚¹ç‚¹å»è®¾è®¡æ›´é€‚åˆä¸åŒåœºæ™¯çš„å›¾å»ºæ¨¡ä¸å›¾æŸ¥è¯¢ã€‚ ä¼˜åŒ–åŸåˆ™ï¼šå‡å°‘æ¨¡ç³Šï¼Œå¢åŠ ç¡®å®šï¼Œè¶Šæ—©è¶Šå¥½ã€‚ æ¬¢è¿å¤§å®¶åœ¨æœ¬æ–‡çš„è¯„è®ºåŒºè®¨è®ºã€æä¾›æ›´å¤šä¼˜åŒ–æŸ¥è¯¢çš„ä¾‹å­ã€‚ Feature image generated with OpenAI Dall-E, with the keyword â€œmake potions for the nebula magicâ€ and Outpainting. Raw image ","date":"2022-09-06","objectID":"/ngql-execution-plan/:5:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","è°ƒä¼˜","æ‰§è¡Œè®¡åˆ’"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸ nGQL æ‰§è¡Œè®¡åˆ’è¯¦è§£ä¸è°ƒä¼˜","uri":"/ngql-execution-plan/#å°ç»“"},{"categories":["Nebula Graph"],"content":"NebulaGraph æ•™ç¨‹ï¼šä¸€æ–‡å…¥é—¨å›¾æŸ¥è¯¢è¯­å¥ï¼šnGQLã€‚æœ¬æ–‡æ—¨åœ¨è®©æ–°æ‰‹å¿«é€Ÿäº†è§£ nGQLï¼ŒæŒæ¡æ–¹å‘ï¼Œä¹‹åå¯ä»¥è„šè¸©åœ¨åœ°ä¸Šå€ŸåŠ©æ–‡æ¡£å†™å‡ºä»»ä½•å¿ƒä¸­çš„ NebulaGraph å›¾æŸ¥è¯¢ã€‚","date":"2022-08-15","objectID":"/ngql-tutorial/","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/"},{"categories":["Nebula Graph"],"content":" æœ¬æ–‡æ—¨åœ¨è®©æ–°æ‰‹å¿«é€Ÿäº†è§£ nGQLï¼ŒæŒæ¡æ–¹å‘ï¼Œä¹‹åå¯ä»¥è„šè¸©åœ¨åœ°ä¸Šå€ŸåŠ©æ–‡æ¡£å†™å‡ºä»»ä½•å¿ƒä¸­çš„ NebulaGraph å›¾æŸ¥è¯¢ã€‚ ","date":"2022-08-15","objectID":"/ngql-tutorial/:0:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#"},{"categories":["Nebula Graph"],"content":" 1 ç³»åˆ—æ•™ç¨‹ nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸï¼Œå¿«é€Ÿå…¥é—¨ï¼Œæœ¬æ–‡ nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬äºŒæœŸï¼ŒæŸ¥è¯¢è®¡åˆ’ä¸è°ƒä¼˜ ","date":"2022-08-15","objectID":"/ngql-tutorial/:1:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#ç³»åˆ—æ•™ç¨‹"},{"categories":["Nebula Graph"],"content":" 2 è§†é¢‘æœ¬æ•™ç¨‹çš„è§†é¢‘ç‰ˆåœ¨è¿™é‡Œã€‚ ","date":"2022-08-15","objectID":"/ngql-tutorial/:2:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#è§†é¢‘"},{"categories":["Nebula Graph"],"content":" 3 å¼€å§‹ä¹‹å‰æœ¬æ–‡å‡è®¾ä½ å·²ç»åœ¨æ–‡æ¡£çœ‹è¿‡å¿«é€Ÿå…¥é—¨æµç¨‹ï¼Œéƒ¨ç½²ã€è¿æ¥è¿‡ NebulaGraphï¼Œå¹¶ä¸”çœ‹è¿‡äº†å¸¸ç”¨å‘½ä»¤ã€‚å¦‚æœæ‚¨è¿˜æ²¡çœ‹è¿‡è¿™ä¸¤ä¸ªæ–‡æ¡£ï¼Œå¼ºçƒˆå»ºè®®å…ˆå¿«é€Ÿè¿‡ä¸€éã€‚ ","date":"2022-08-15","objectID":"/ngql-tutorial/:3:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#å¼€å§‹ä¹‹å‰"},{"categories":["Nebula Graph"],"content":" 3.1 æ•™ç¨‹ç›®æ ‡æœ¬æ•™ç¨‹ç›®çš„åœ¨äºè®©æ–°æ‰‹å¤§æ¦‚çŸ¥é“äº† NebulaGraph çš„æŸ¥è¯¢è¯­å¥åï¼Œè§£å†³â€œä¸çŸ¥é“ä»€ä¹ˆæ ·çš„æŸ¥è¯¢åº”è¯¥ç”¨ä»€ä¹ˆè¯­å¥â€çš„é—®é¢˜ã€‚ ","date":"2022-08-15","objectID":"/ngql-tutorial/:3:1","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#æ•™ç¨‹ç›®æ ‡"},{"categories":["Nebula Graph"],"content":" 3.2 nGQL æ˜¯ä»€ä¹ˆæˆ‘ä»¬å…ˆå¼ºè°ƒä¸€ä¸‹æ¦‚å¿µï¼šnGQL æ˜¯ NebulaGraph Graph Query Language çš„ç¼©å†™ï¼Œå®ƒè¡¨ç¤º NebulaGraph çš„æŸ¥è¯¢è¯­è¨€ï¼Œè€Œ nGQL çš„è¯­å¥å¯ä»¥ä¸ä¸¥è°¨åœ°åˆ†ä¸ºè¿™å‡ éƒ¨åˆ†ï¼š NebulaGraph ç‹¬æœ‰ DQL æŸ¥è¯¢è¯­å¥ï¼ˆData Query Languageï¼‰ NebulaGraph OpenCypher DQL NebulaGraph DML å†™è¯­å¥ï¼ˆData Mutation Languageï¼‰ NebulaGraph DDL Schema è¯­å¥ï¼ˆData Definition Language) NebulaGraph Admin Queries ç®¡ç†è¯­å¥ è¿™é‡Œï¼Œä½œä¸ºç®€æ˜æ•™ç¨‹ä¸€æŠŠæ¢­ï¼Œæˆ‘ä»¬åªå…³æ³¨å‰ä¸¤ä¸ªéƒ¨åˆ†ï¼Œåè¾¹çš„å†…å®¹ä¼šåœ¨ Part 2 ä¸­ä»‹ç»ã€‚ ","date":"2022-08-15","objectID":"/ngql-tutorial/:3:2","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#ngql-æ˜¯ä»€ä¹ˆ"},{"categories":["Nebula Graph"],"content":" 3.3 nGQL é€ŸæŸ¥è¡¨ Cheatsheet å¤§å®¶å¯ä»¥æŠ¥é”™è¿™ä»½å•é¡µé€ŸæŸ¥è¡¨ï¼Œä¸€æ¬¡äº†è§£æ‰€æœ‰ nGQL çš„ç”¨æ³•ã€‚ åŸå§‹æ–‡ä»¶é“¾æ¥ ","date":"2022-08-15","objectID":"/ngql-tutorial/:3:3","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#ngql-é€ŸæŸ¥è¡¨-cheatsheet"},{"categories":["Nebula Graph"],"content":" 4 NebulaGraph ç‹¬æœ‰ DQLNebulaGraph çš„ç‹¬æœ‰è¯»æŸ¥è¯¢è¯­å¥çš„è®¾è®¡éå¸¸ç®€æ´ï¼Œå¯¹åˆå­¦è€…éå¸¸å‹å¥½ï¼Œç»“åˆäº†ç®¡é“çš„æ¦‚å¿µï¼Œåšåˆ°äº†åªæ¶‰åŠäº†å‡ ä¸ªå…³é”®è¯å°±å¯ä»¥æè¿°å¤§å¤šæ•°å›¾æŸ¥è¯¢æ¨¡å¼ã€‚ ç”¨ä¸€å¥è¯æè¿°æ¥è¯´ï¼ŒnGQL çš„ç‹¬æœ‰ DQL ä¸€å…±åˆ†æˆå››ç±»è¯­å¥ï¼š å›¾æ‹“å±•ï¼šGO ç´¢å¼•åæŸ¥ï¼šLOOKUP å–å±æ€§ï¼šFETCH PROP è·¯å¾„ä¸å­å›¾ï¼šFIND PATH ä¸ GET SUBGRAPH å’Œå‡ ä¸ªç‰¹åˆ«çš„å…ƒç´  ç®¡é“ï¼š| å¼•ç”¨å±æ€§: $ å¼€å¤´çš„å‡ ä¸ªç¬¦å·ï¼Œç”¨æ¥æè¿°ä¸€äº›ç‰¹å®šçš„ä¸Šä¸‹æ–‡ ","date":"2022-08-15","objectID":"/ngql-tutorial/:4:0","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#nebulagraph-ç‹¬æœ‰-dql"},{"categories":["Nebula Graph"],"content":" 4.1 å›¾æ‹“å±• GOGO çš„è¯­ä¹‰éå¸¸ç›´è§‚ï¼šä»ç»™å®šçš„èµ·ç‚¹ï¼Œå‘å¤–æ‹“å±•ï¼ŒæŒ‰éœ€è¿”å›ç»ˆç‚¹ã€èµ·ç‚¹çš„ä¿¡æ¯ã€‚ # å›¾æ‹“å±• GO 3 STEPS FROM \"player102\" OVER follow YIELD dst(edge); â”€â”€â”€â”¬â”€â”€â”€ â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€ â”€â”¬â”€â”€â”€â”€ â”€â”€â”¬â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€ è¿”å›æœ€åä¸€è·³è¾¹çš„ç»ˆç‚¹ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€ ä» follow è¿™ä¸ªè¾¹[å‡ºæ–¹å‘]æ¢ç´¢ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ èµ·ç‚¹æ˜¯ \"player102\" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ¢ç´¢ 3 æ­¥ å‚è€ƒ GO è¯­å¥æ–‡æ¡£ï¼Œäº†è§£å¦‚ä½•ï¼š æŒ‡å®šåæ–¹å‘æ‹“å±•ã€åŒå‘æ‹“å±• æŒ‡å®šå¯å˜è·³æ•°æ‹“å±• åŸºäºæ‰€æœ‰ç±»å‹è¾¹æ‹“å±• è¿”å›å…¶ä»–ä¿¡æ¯ ","date":"2022-08-15","objectID":"/ngql-tutorial/:4:1","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#å›¾æ‹“å±•-go"},{"categories":["Nebula Graph"],"content":" 4.2 LOOKUP åŸºäºç´¢å¼•åæŸ¥ IDå’Œ GO ä¸ºä»å·²çŸ¥çš„ç‚¹å‡ºå‘ç›¸åï¼ŒLOOKUP æ˜¯ä¸€ä¸ªç±»ä¼¼äº SQL é‡Œ SELECT è¯­ä¹‰çš„å…³é”®å­—ï¼Œå®ƒå®é™…çš„ä½œç”¨ä¹Ÿç±»ä¼¼ä¸å…³ç³»å‹æ•°æ®åº“ä¸­çš„æ‰«è¡¨ã€‚ LOOKUP éœ€è¦æ‰‹åŠ¨æ˜ç¡®å»ºç«‹ç›¸åº” TAGã€è¾¹ç±»å‹ä¸Šç´¢å¼•æ‰èƒ½å…è®¸ç›¸åº”çš„æŸ¥è¯¢ã€‚ 4.2.1 ä¸ºä»€ä¹ˆ LOOKUP éœ€è¦ç´¢å¼•ï¼Ÿå› ä¸º NebulaGraph ä¸­çš„æ•°æ®é»˜è®¤æ˜¯æŒ‰ç…§é‚»æ¥è¡¨çš„å½¢å¼å­˜å‚¨ï¼Œåœ¨åˆ†å¸ƒå¼è®¾è®¡ä¸­ï¼Œæ‰«æä¸€ä¸ªç±»å‹çš„ç‚¹ã€è¾¹æ˜¯éå¸¸æ˜‚è´µçš„ï¼Œæ‰€ä»¥å®ƒè¢«é»˜è®¤ç¦æ­¢äº†ã€‚è€Œåˆ›å»ºç›¸åº”çš„ç´¢å¼•ç±»ä¼¼äºå¢åŠ äº†ç±»ä¼¼äºè¡¨ç»“æ„æ•°æ®åº“çš„æ’åºæ•°æ®ï¼Œå¯ä»¥ç”¨æ¥åšç±»ä¼¼äº SELECT çš„æŸ¥è¯¢ã€‚ åˆ›å»ºç´¢å¼•çš„ä»£ä»·æ˜¯ä»€ä¹ˆï¼ˆå¢åŠ å†™å…¥è´Ÿæ‹…ï¼‰ï¼Ÿç´¢å¼•ä¼šåŠ é€Ÿè¯»ä¹ˆï¼ˆä¸ä¼šï¼Œå®ƒæ˜¯æä¾›äº† LOOKUP çš„å¯èƒ½æ€§ï¼ŒåŸç”Ÿå›¾çš„æŸ¥è¯¢ä¸éœ€è¦ç´¢å¼•åŠ é€Ÿï¼‰ï¼Ÿç­‰ç­‰æ›´è¯¦ç»†çš„é—®é¢˜è¯·å‚é˜…æˆ‘ä¹‹å‰çš„ç´¢å¼•è¯¦è§£æ–‡ç« ã€‚ # ç´¢å¼•åæŸ¥ LOOKUP ON player WHERE player.name == \"Tony Parker\" YIELD id(vertex); â”€â”€â”¬â”€â”€â”€ â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”€â”€â”¬â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿”å›æŸ¥åˆ°ç‚¹çš„ VID â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿‡æ»¤æ¡ä»¶æ˜¯å±æ€§ name çš„å€¼ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ ¹æ®ç‚¹çš„ç±»åˆ«/TAG player æŸ¥è¯¢ è¿›ä¸€æ­¥å‚è€ƒ LOOKUP è¯­å¥æ–‡æ¡£ï¼Œäº†è§£å¦‚ä½•ï¼š è¿”å›å±æ€§ æ ¹æ®è¾¹çš„ç±»å‹æŸ¥è¯¢è¾¹ äº†è§£ LOOKUP æŸ¥è¯¢çš„å‰æã€ç´¢å¼•ï¼Œç´¢å¼•è¯¦è§£ ","date":"2022-08-15","objectID":"/ngql-tutorial/:4:2","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#lookup-åŸºäºç´¢å¼•åæŸ¥-id"},{"categories":["Nebula Graph"],"content":" 4.2 LOOKUP åŸºäºç´¢å¼•åæŸ¥ IDå’Œ GO ä¸ºä»å·²çŸ¥çš„ç‚¹å‡ºå‘ç›¸åï¼ŒLOOKUP æ˜¯ä¸€ä¸ªç±»ä¼¼äº SQL é‡Œ SELECT è¯­ä¹‰çš„å…³é”®å­—ï¼Œå®ƒå®é™…çš„ä½œç”¨ä¹Ÿç±»ä¼¼ä¸å…³ç³»å‹æ•°æ®åº“ä¸­çš„æ‰«è¡¨ã€‚ LOOKUP éœ€è¦æ‰‹åŠ¨æ˜ç¡®å»ºç«‹ç›¸åº” TAGã€è¾¹ç±»å‹ä¸Šç´¢å¼•æ‰èƒ½å…è®¸ç›¸åº”çš„æŸ¥è¯¢ã€‚ 4.2.1 ä¸ºä»€ä¹ˆ LOOKUP éœ€è¦ç´¢å¼•ï¼Ÿå› ä¸º NebulaGraph ä¸­çš„æ•°æ®é»˜è®¤æ˜¯æŒ‰ç…§é‚»æ¥è¡¨çš„å½¢å¼å­˜å‚¨ï¼Œåœ¨åˆ†å¸ƒå¼è®¾è®¡ä¸­ï¼Œæ‰«æä¸€ä¸ªç±»å‹çš„ç‚¹ã€è¾¹æ˜¯éå¸¸æ˜‚è´µçš„ï¼Œæ‰€ä»¥å®ƒè¢«é»˜è®¤ç¦æ­¢äº†ã€‚è€Œåˆ›å»ºç›¸åº”çš„ç´¢å¼•ç±»ä¼¼äºå¢åŠ äº†ç±»ä¼¼äºè¡¨ç»“æ„æ•°æ®åº“çš„æ’åºæ•°æ®ï¼Œå¯ä»¥ç”¨æ¥åšç±»ä¼¼äº SELECT çš„æŸ¥è¯¢ã€‚ åˆ›å»ºç´¢å¼•çš„ä»£ä»·æ˜¯ä»€ä¹ˆï¼ˆå¢åŠ å†™å…¥è´Ÿæ‹…ï¼‰ï¼Ÿç´¢å¼•ä¼šåŠ é€Ÿè¯»ä¹ˆï¼ˆä¸ä¼šï¼Œå®ƒæ˜¯æä¾›äº† LOOKUP çš„å¯èƒ½æ€§ï¼ŒåŸç”Ÿå›¾çš„æŸ¥è¯¢ä¸éœ€è¦ç´¢å¼•åŠ é€Ÿï¼‰ï¼Ÿç­‰ç­‰æ›´è¯¦ç»†çš„é—®é¢˜è¯·å‚é˜…æˆ‘ä¹‹å‰çš„ç´¢å¼•è¯¦è§£æ–‡ç« ã€‚ # ç´¢å¼•åæŸ¥ LOOKUP ON player WHERE player.name == \"Tony Parker\" YIELD id(vertex); â”€â”€â”¬â”€â”€â”€ â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”€â”€â”¬â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿”å›æŸ¥åˆ°ç‚¹çš„ VID â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿‡æ»¤æ¡ä»¶æ˜¯å±æ€§ name çš„å€¼ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ ¹æ®ç‚¹çš„ç±»åˆ«/TAG player æŸ¥è¯¢ è¿›ä¸€æ­¥å‚è€ƒ LOOKUP è¯­å¥æ–‡æ¡£ï¼Œäº†è§£å¦‚ä½•ï¼š è¿”å›å±æ€§ æ ¹æ®è¾¹çš„ç±»å‹æŸ¥è¯¢è¾¹ äº†è§£ LOOKUP æŸ¥è¯¢çš„å‰æã€ç´¢å¼•ï¼Œç´¢å¼•è¯¦è§£ ","date":"2022-08-15","objectID":"/ngql-tutorial/:4:2","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#ä¸ºä»€ä¹ˆ-lookup-éœ€è¦ç´¢å¼•"},{"categories":["Nebula Graph"],"content":" 4.3 FETCH PROP è·å–å±æ€§å¦‚å­—é¢æ„æ€ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªç‚¹ã€è¾¹çš„ IDï¼Œæƒ³è¦è·å–å®ƒä¸Šè¾¹çš„å±æ€§ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¦ç”¨ FETCH PROP è€Œé LOOKUPã€‚ # å–å±æ€§ FETCH PROP ON player \"player100\" YIELD properties(vertex); â”€â”€â”¬â”€â”€â”€ â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€ è¿”å›ç‚¹çš„ player TAG ä¸‹æ‰€æœ‰å±æ€§ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä» \"player100\" è¿™ä¸ªç‚¹è·å– â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è·å– player è¿™ä¸ª TAG ä¸‹çš„å±æ€§ è¿›ä¸€æ­¥å‚è€ƒ FETCH PROP è¯­å¥æ–‡æ¡£ï¼Œäº†è§£å¦‚ä½•ï¼š è¿”å›æŸä¸€ä¸ªå±æ€§ è·å–ç»™å®šè¾¹çš„å±æ€§ ","date":"2022-08-15","objectID":"/ngql-tutorial/:4:3","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#fetch-prop-è·å–å±æ€§"},{"categories":["Nebula Graph"],"content":" 4.4 è·¯å¾„æŸ¥æ‰¾ FIND PATHå¦‚æœæˆ‘ä»¬ä»ç»™å®šçš„èµ·ç‚¹ã€ç»ˆç‚¹ä¸­ï¼Œæ‰¾åˆ°ä¹‹é—´çš„æ‰€æœ‰è·¯å¾„ï¼Œä¸€å®šè¦ç”¨ FIND PATH # èµ·ç‚¹ç»ˆç‚¹é—´è·¯å¾„ FIND SHORTEST PATH FROM \"player102\" TO \"team204\" OVER * \\ â”€â”€â”¬â”€â”€â”€â”€â”€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”€â”€â”€â”¬â”€â”€â”€ YIELDâ”‚path AS p; â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚â”€â”€â”€â”€â”¬â”€â”€â”€â”€ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç»ç”±æ‰€æœ‰ç±»å‹çš„è¾¹å‡ºå‘æ¢ç´¢ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä»ç»™å®šçš„èµ·ç‚¹ã€ç»ˆç‚¹ VID â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿”å›è·¯å¾„ä¸º p åˆ— â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æŸ¥æ‰¾æœ€çŸ­è·¯å¾„ è¿›ä¸€æ­¥å‚è€ƒ FIND PATH è¯­å¥æ–‡æ¡£ï¼Œäº†è§£å¦‚ä½•ï¼š è¿”å›è·¯å¾„ä¸­çš„å±æ€§ è®¾å®šæ‹“å±•æ–¹å‘ ","date":"2022-08-15","objectID":"/ngql-tutorial/:4:4","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#è·¯å¾„æŸ¥æ‰¾-find-path"},{"categories":["Nebula Graph"],"content":" 4.5 å•ç‚¹å­å›¾ GET SUBGRAPHå’Œè·¯å¾„æŸ¥æ‰¾ç±»ä¼¼ï¼Œä½†æ˜¯æˆ‘ä»¬åªç»™å®šä¸€ä¸ªèµ·ç‚¹å’Œæ‹“å±•éƒ¨ç½²ï¼Œç”¨ GET SUBGRAPH å¯ä»¥å¸®æˆ‘ä»¬è·å–åŒæ ·çš„ BFS å‡ºå»çš„å­å›¾ # å•ç‚¹ BFS å­å›¾ GET SUBGRAPH 5 STEPS FROM \"player101\" \\ â”€â”€â”€â”¬â”€â”€â”€ â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ YIELD VERTICES AS nodes, EDGES AS relationships; â”€â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€ ä» \"player101\" å¼€å§‹è§¦å‘ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è·å– 5 æ­¥çš„æ¢ç´¢ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿”å›æ‰€æœ‰çš„ç‚¹ã€è¾¹ è¿›ä¸€æ­¥å‚è€ƒ GET SUBGRAPH è¯­å¥æ–‡æ¡£ï¼Œäº†è§£å¦‚ä½•ï¼š è¿”å›å¸¦æœ‰å±æ€§çš„ç‚¹ã€è¾¹ è®¾å®šæ‹“å±•æ–¹å‘ ","date":"2022-08-15","objectID":"/ngql-tutorial/:4:5","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#å•ç‚¹å­å›¾-get-subgraph"},{"categories":["Nebula Graph"],"content":" 4.6 åˆ©ç”¨ç®¡é“å’Œå±æ€§å¼•ç”¨ç¬¦NebulaGraph çš„ç®¡é“è®¾è®¡å’Œ Unix-Shell çš„è®¾è®¡å¾ˆåƒï¼Œå¯ä»¥å°†ç®€å•çš„å‡ ç§è¯­å¥ç»“åˆèµ·æ¥ï¼Œæœ‰å¼ºå¤§çš„è¡¨è¾¾åŠ›ã€‚ # ä½¿ç”¨é€šé“ GO FROM \"player100\" OVER follow YIELD dst(edge) AS did | \\ â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”€â”¬â”€ GO FROMâ”‚$-.did OVER follow YIELD dst(edge); â”‚ â”‚â”€â”€â”€â”€â”¬â”€â”€ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€ ç®¡é“å°†å·¦è¾¹çš„ AS è¾“å‡ºä½œä¸ºå³è¾¹è¯­å¥è¾“å…¥ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä»ç®¡é“å·¦è¾¹çš„ did å±æ€§å¼€å§‹æ¢ç´¢ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ è¿›ä¸€æ­¥å‚è€ƒ å¼•ç”¨å±æ€§æ–‡æ¡£ã€ç®¡é“æ–‡æ¡£äº†è§£ï¼š æ›´å¤šå±æ€§å¼•ç”¨å®šä¹‰ æ›´å¤šä¾‹å­ ç»“åˆ LOOKUP, GO, FETCH çš„è¯­å¥ é™¤äº†ä»¥ä¸Šçš„å‡ ç§è¡¨è¾¾ä¹‹å¤–ï¼ŒNebulaGraph ç‹¬æœ‰æŸ¥è¯¢è¯­å¥è¿˜æœ‰èšåˆçš„è¡¨è¾¾å‚è€ƒ GROUP-BYï¼Œå¦å¤–åœ¨æ–‡æ¡£é‡Œè¿˜æœ‰ä¸€ä¸ª Cheatsheet ä¾›å¤§å®¶æŸ¥è¯¢ä¸€äº›å¤æ‚ä¸€ç‚¹æŸ¥è¯¢çš„ä¾‹å­ã€‚ ","date":"2022-08-15","objectID":"/ngql-tutorial/:4:6","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#åˆ©ç”¨ç®¡é“å’Œå±æ€§å¼•ç”¨ç¬¦"},{"categories":["Nebula Graph"],"content":" 4.7 NebulaGraph OpenCypher DQLä» 2.0 èµ·ï¼ŒOpenCypher çš„ MATCH è¯­å¥ä¹Ÿè¢« NebulaGraph åŸç”Ÿæ”¯æŒäº†ï¼Œè™½ç„¶è¿™é‡Œæ˜¯ä¸€ä¸ªæ–¹è¨€ï¼ˆæœ‰ä¸€äº›ç»†èŠ‚å·®å¼‚ï¼‰ã€‚ MATCH \u003cpattern\u003e [\u003cclause_1\u003e] RETURN \u003coutput\u003e [\u003cclause_2\u003e]; MATCH çš„åŸºæœ¬è¡¨è¾¾æ˜¯ä»¥ (v:tag_a) åŒ…è£¹çš„ç‚¹ --\u003e æˆ–è€… \u003c-[:edge_type_1]- è¡¨è¾¾çš„è¾¹ç»„æˆçš„æ¨¡å¼ï¼Œä¸ RETURN è¡¨è¾¾çš„è¾“å‡ºã€‚ å¦‚æœæ‚¨ä» Cypher çš„æŸ¥è¯¢è¯­å¥å…¥é—¨å›¾æ•°æ®åº“ï¼Œå¯ä»¥ä»ä¸‹è¾¹å‡ ä¸ªä¾‹å­äº†è§£åˆ°å‡ ä¸ª NebulaGraph é‡Œçš„ç»†èŠ‚å·®å¼‚ï¼š å¢åŠ äº† WHERE id(v) == \"foo\" çš„è¡¨è¾¾ == è¡¨è¾¾ç›¸ç­‰åˆ¤æ–­è€Œä¸æ˜¯ = ç‚¹çš„å±æ€§è¡¨è¾¾éœ€è¦å¡«å†™ TAGï¼Œä¾‹å¦‚ v3.player.name è€Œä¸æ˜¯ v3.name MATCH (v:`player`{name:\"Tim Duncan\"})--\u003e(v2)\u003c--(v3) \\ RETURN v3.`player`.name AS Name; MATCH (v:`player`) \\ WHERE NOT (v)--() \\ RETURN v; MATCH (v:`player`)--(v2) \\ WHERE id(v2) IN [\"player101\", \"player102\"] \\ RETURN v; MATCH (m)-[]-\u003e(n) WHERE id(m)==\"player100\" \\ OPTIONAL MATCH (n)-[]-\u003e(l) WHERE id(n)==\"player125\" \\ RETURN id(m), id(n), id(l); è¿›ä¸€æ­¥å‚è€ƒ MATCH æ–‡æ¡£äº†è§£ï¼š æ›´å¤šä¾‹å­ å¯å˜è·³æ•°çš„ MATCH è¡¨è¾¾ å¤š MATCH OPTIONAL MATCH é¢˜å›¾ç‰ˆæƒï¼šDALLÂ·E Open-AIï¼ŒåŸå›¾ The featured image was generated with keywords: learning spells of the nebula magic, with DALLÂ·E Open-AI. ","date":"2022-08-15","objectID":"/ngql-tutorial/:4:7","series":null,"tags":["NebulaGraph","nGQL","OpenCypher","cheatsheet","é€ŸæŸ¥è¡¨"],"title":"nGQL ç®€æ˜æ•™ç¨‹ï¼Œç¬¬ä¸€æœŸ","uri":"/ngql-tutorial/#nebulagraph-opencypher-dql"},{"categories":["Nebula Graph"],"content":"æœ¬æ–‡æ˜¯ä¸€ä¸ªåŸºäº NebulaGraph ä¸Šçš„å›¾ç®—æ³•ã€å›¾æ•°æ®åº“ã€å›¾ç¥ç»ç½‘ç»œçš„ ID-Mapping æ–¹æ³•ç»¼è¿°ï¼Œé™¤äº†åŸºæœ¬æ–¹æ³•æ€æƒ³çš„ä»‹ç»ä¹‹å¤–ï¼Œæˆ‘è¿˜ç»™å¤§å®¶å¼„äº†å¯ä»¥è·‘çš„ Playgroundã€‚","date":"2022-08-14","objectID":"/identity-resolution/","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/"},{"categories":["Nebula Graph"],"content":" æœ¬æ–‡æ˜¯ä¸€ä¸ªåŸºäº NebulaGraph ä¸Šçš„å›¾ç®—æ³•ã€å›¾æ•°æ®åº“ã€å›¾ç¥ç»ç½‘ç»œçš„ ID-Mapping æ–¹æ³•ç»¼è¿°ï¼Œé™¤äº†åŸºæœ¬æ–¹æ³•æ€æƒ³çš„ä»‹ç»ä¹‹å¤–ï¼Œæˆ‘è¿˜ç»™å¤§å®¶å¼„äº†å¯ä»¥è·‘çš„ Playgroundã€‚ æœ¬æ–‡è¿˜åœ¨æ’°å†™ä¸­ï¼ŒTBD çš„ç« èŠ‚è¿˜è¯·è§è°…ã€‚ ","date":"2022-08-14","objectID":"/identity-resolution/:0:0","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#"},{"categories":["Nebula Graph"],"content":" 1 åŸºäºå›¾æ•°æ®åº“çš„ç”¨æˆ· ID è¯†åˆ«æ–¹æ³•ç”¨æˆ· ID è¯†åˆ«ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„å›¾æŠ€æœ¯åº”ç”¨åœºæ™¯ï¼Œåœ¨ä¸åŒçš„è¯­å¢ƒä¸‹å®ƒå¯èƒ½è¿˜è¢«å«åš Entity Correlationï¼ˆå®ä½“å…³è”ï¼‰ã€Entity Linkingï¼ˆå®ä½“é“¾æ¥ï¼‰ã€ID Mappingï¼ˆèº«ä»½æ˜ å°„ï¼‰ç­‰ç­‰ã€‚ID è¯†åˆ«è§£å†³çš„é—®é¢˜æ˜¯æ‰¾å‡ºç›¸åŒçš„ç”¨æˆ·åœ¨åŒä¸€ä¸ªç³»ç»Ÿæˆ–è€…ä¸åŒç³»ç»Ÿä¸­çš„ä¸åŒè´¦å·ã€‚ ç”±äº ID è¯†åˆ«å¤©ç„¶åœ°æ˜¯ä¸€ä¸ªå…³è”å…³ç³»é—®é¢˜ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå…¸å‹çš„å›¾ã€å›¾æ•°æ®åº“åº”ç”¨åœºæ™¯ã€‚ ","date":"2022-08-14","objectID":"/identity-resolution/:1:0","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åŸºäºå›¾æ•°æ®åº“çš„ç”¨æˆ·-id-è¯†åˆ«æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.1 å»ºç«‹å›¾è°± 1.1.1 å›¾å»ºæ¨¡æˆ‘ä»¬ä»ä¸€ä¸ªæœ€ç®€å•ã€ç›´æ¥çš„å›¾è°±å¼€å§‹ï¼Œå¦‚ä¸‹è¾¹çš„å›¾ç»“æ„ç¤ºæ„æ˜¾ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰äº†ç‚¹ï¼š user Prop: [name, email, birthday, address, phone_num] phone email device ip address åœ¨ä»–ä»¬ä¹‹é—´æœ‰å¾ˆè‡ªç„¶çš„è¾¹ï¼š used_device Prop: time logged_in_from Prop: time has_phone has_address has_email 1.1.2 æ•°æ®è¿™ä»½æ•°æ®æ˜¯å¼€æºçš„ï¼Œåœ°å€åœ¨ https://github.com/wey-gu/identity-correlation-datagen 1.1.3 å†™å…¥ NebulaGraph åˆ©ç”¨ Nebula Upï¼Œä¸€è¡Œéƒ¨ç½² NebulaGraph åœ°å€ï¼šhttps://github.com/wey-gu/nebula-up/ curl -fsSL nebula-up.siwei.io/install.sh | bash å›¾å»ºæ¨¡çš„ Schema å¯¹åº”çš„ NebulaGraph DDL æ˜¯ï¼š # åˆ›å»ºä¸€ä¸ªå«åš entity_resolution çš„å›¾ç©ºé—´ CREATE SPACE entity_resolution (vid_type=FIXED_STRING(30)); USE entity_resolution; # åˆ›å»ºç‚¹çš„ç±»å‹ TAG CREATE TAG `user` (`name` string NOT NULL, `email` string NOT NULL, `phone_num` string NOT NULL, `birthday` date NOT NULL, `address` string NOT NULL); CREATE TAG `address` (`address` string NOT NULL); CREATE TAG `device` (`uuid` string NOT NULL); CREATE TAG `email` (); CREATE TAG `ip` (); CREATE TAG `phone` (); # åˆ›å»ºè¾¹çš„ç±»å‹ Edge Type CREATE EDGE `used_device` (`time` timestamp NOT NULL); CREATE EDGE `logged_in_from` (`time` timestamp NOT NULL); CREATE EDGE `has_phone` (); CREATE EDGE `has_address` (); CREATE EDGE `has_email` (); å¯¹äºå†™å…¥æ•°æ®çš„ DMLï¼Œè¿™é‡Œåªç»™å‡º user ï¼Œemail ç±»å‹ç‚¹ã€has_email ç±»å‹è¾¹çš„ä¾‹å­ INSERT VERTEX `user` (`email`, `name`, `birthday`, `address`, `phone_num`) VALUES \"user_1\":(\"heathermoore@johnson.com\",\"Miranda Miller\",date(\"1957-08-27\"),\"Brittany Forge Apt. 718 East Eric WV 97881\",\"+1-652-450-5443x00562\"), \"user_2\":(\"holly@welch.org\",\"Holly Pollard\",date(\"1990-10-19\"),\"1 Amanda Freeway Lisaland NJ 94933\",\"600-192-2985x041\"), \"user_3\":(\"julia.h.24@gmail.com\",\"Julia Hall\",date(\"1927-08-24\"),\"Rodriguez Track East Connorfort NC 63144\",\"1248361783\"), \"user_4\":(\"franklin.b@gibson.biz\",\"Franklin Barnett\",date(\"2020-03-01\"),\"Richard Curve Kingstad AZ 05660\",\"(224)497-9312\"), \"user_5\":(\"4kelly@yahoo.com\",\"April Kelly\",date(\"1967-12-01\"),\"Schmidt Key Lake Charles AL 36174\",\"410.138.1816x98702\"), \"user_6\":(\"steven.web@johnson.com\",\"Steven Webb\",date(\"1955-04-24\"),\"5 Joanna Key Suite 704 Frankshire OK 03035\",\"3666519376\"), \"user_7\":(\"Jessica_Torres@morris.com\",\"Jessica Torres\",date(\"1958-09-03\"),\"1 Payne Circle Mitchellfort LA 73053\",\"535-357-3112x4903\"), \"user_8\":(\"brettglenn@gmail.com\",\"Brett Glenn\",date(\"1992-09-03\"),\"Weber Unions Eddieland MT 64619\",\"660.391.3730\"), \"user_9\":(\"veronica.j@yahoo.com\",\"Veronica Jordan\",date(\"1947-06-08\"),\"2 Klein Mission New Annetteton HI 05775\",\"810-252-6218\"), \"user_10\":(\"steven@phelps-craig.info\",\"Steven Brooks\",date(\"1954-06-14\"),\"1 Vanessa Stravenue Suite 184 Baileyville NY 46381\",\"+1-665-328-8103x3448\"), \"user_11\":(\"ReginaldTheMan@hotmail.com\",\"Reginald Mccullough\",date(\"1915-04-12\"),\"John Garden Port John LA 54602\",\"030.088.4523x94511\"), \"user_12\":(\"Jennifer.f@carroll-acosta.com\",\"Jennifer Foster\",date(\"1988-04-30\"),\"11 Webb Groves Tiffanyside MN 14566\",\"(489)306-8558x98227\"), \"user_13\":(\"Philip66@yahoo.com\",\"Philip Garcia\",date(\"1955-12-01\"),\"70 Robinson Locks Suite 113 East Veronica ND 87845\",\"490-088-7610x9437\"), \"user_14\":(\"Ann@hernandez.com\",\"Ann Williams\",date(\"1947-05-28\"),\"24 Mcknight Port Apt. 028 Sarahborough MD 38195\",\"868.057.4056x4814\"), \"user_15\":(\"Jessica@turner.com\",\"Jessica Stewart\",date(\"1951-11-28\"),\"0337 Mason Corner Apt. 900 Toddmouth FL 61464\",\"(335)408-3835x883\"), \"user_16\":(\"Sandra311@hotmail.com\",\"Sandra Dougherty\",date(\"1908-06-03\"),\"7 Davis Station Apt. 691 Pittmanfort HI 29746\",\"+1-189-827-0744x27614\"), \"user_17\":(\"Sharon91@gmail.com\",\"Sharon Mccoy\",date(\"1958-09-01\"),\"1 Southport Street Apt. 098 Westport KY 85907\",\"(814)898-9079x898\"), \"user_18\":(\"Sharon91+001@gmail.com\",\"Kathryn Miller\",date(\"1958-09-01\"),\"1 Southport Street Apt. 098 Westport KY 85907\",\"(814)898-9079x898\"), \"user_19\":(\"brettglenn@googlemail.com\",\"Bretty Glenn\",date(\"1991-09-03\"),\"Weber Unions Eddieland MT 64619\",\"660-391-3730\"), \"user_20\":(\"julia.h.24@yahoo.com\",\"Julia H.\",date(\"1927-08-24\"),\"Rodriguez Track East Connorfort NC 63144\",\"1248361783\"), \"user_21\":(\"holly@welch.org\",\"Holly\",date(\"0000-10-19\"),\"1 Ama","date":"2022-08-14","objectID":"/identity-resolution/:1:1","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#å»ºç«‹å›¾è°±"},{"categories":["Nebula Graph"],"content":" 1.1 å»ºç«‹å›¾è°± 1.1.1 å›¾å»ºæ¨¡æˆ‘ä»¬ä»ä¸€ä¸ªæœ€ç®€å•ã€ç›´æ¥çš„å›¾è°±å¼€å§‹ï¼Œå¦‚ä¸‹è¾¹çš„å›¾ç»“æ„ç¤ºæ„æ˜¾ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰äº†ç‚¹ï¼š user Prop: [name, email, birthday, address, phone_num] phone email device ip address åœ¨ä»–ä»¬ä¹‹é—´æœ‰å¾ˆè‡ªç„¶çš„è¾¹ï¼š used_device Prop: time logged_in_from Prop: time has_phone has_address has_email 1.1.2 æ•°æ®è¿™ä»½æ•°æ®æ˜¯å¼€æºçš„ï¼Œåœ°å€åœ¨ https://github.com/wey-gu/identity-correlation-datagen 1.1.3 å†™å…¥ NebulaGraph åˆ©ç”¨ Nebula Upï¼Œä¸€è¡Œéƒ¨ç½² NebulaGraph åœ°å€ï¼šhttps://github.com/wey-gu/nebula-up/ curl -fsSL nebula-up.siwei.io/install.sh | bash å›¾å»ºæ¨¡çš„ Schema å¯¹åº”çš„ NebulaGraph DDL æ˜¯ï¼š # åˆ›å»ºä¸€ä¸ªå«åš entity_resolution çš„å›¾ç©ºé—´ CREATE SPACE entity_resolution (vid_type=FIXED_STRING(30)); USE entity_resolution; # åˆ›å»ºç‚¹çš„ç±»å‹ TAG CREATE TAG `user` (`name` string NOT NULL, `email` string NOT NULL, `phone_num` string NOT NULL, `birthday` date NOT NULL, `address` string NOT NULL); CREATE TAG `address` (`address` string NOT NULL); CREATE TAG `device` (`uuid` string NOT NULL); CREATE TAG `email` (); CREATE TAG `ip` (); CREATE TAG `phone` (); # åˆ›å»ºè¾¹çš„ç±»å‹ Edge Type CREATE EDGE `used_device` (`time` timestamp NOT NULL); CREATE EDGE `logged_in_from` (`time` timestamp NOT NULL); CREATE EDGE `has_phone` (); CREATE EDGE `has_address` (); CREATE EDGE `has_email` (); å¯¹äºå†™å…¥æ•°æ®çš„ DMLï¼Œè¿™é‡Œåªç»™å‡º user ï¼Œemail ç±»å‹ç‚¹ã€has_email ç±»å‹è¾¹çš„ä¾‹å­ INSERT VERTEX `user` (`email`, `name`, `birthday`, `address`, `phone_num`) VALUES \"user_1\":(\"heathermoore@johnson.com\",\"Miranda Miller\",date(\"1957-08-27\"),\"Brittany Forge Apt. 718 East Eric WV 97881\",\"+1-652-450-5443x00562\"), \"user_2\":(\"holly@welch.org\",\"Holly Pollard\",date(\"1990-10-19\"),\"1 Amanda Freeway Lisaland NJ 94933\",\"600-192-2985x041\"), \"user_3\":(\"julia.h.24@gmail.com\",\"Julia Hall\",date(\"1927-08-24\"),\"Rodriguez Track East Connorfort NC 63144\",\"1248361783\"), \"user_4\":(\"franklin.b@gibson.biz\",\"Franklin Barnett\",date(\"2020-03-01\"),\"Richard Curve Kingstad AZ 05660\",\"(224)497-9312\"), \"user_5\":(\"4kelly@yahoo.com\",\"April Kelly\",date(\"1967-12-01\"),\"Schmidt Key Lake Charles AL 36174\",\"410.138.1816x98702\"), \"user_6\":(\"steven.web@johnson.com\",\"Steven Webb\",date(\"1955-04-24\"),\"5 Joanna Key Suite 704 Frankshire OK 03035\",\"3666519376\"), \"user_7\":(\"Jessica_Torres@morris.com\",\"Jessica Torres\",date(\"1958-09-03\"),\"1 Payne Circle Mitchellfort LA 73053\",\"535-357-3112x4903\"), \"user_8\":(\"brettglenn@gmail.com\",\"Brett Glenn\",date(\"1992-09-03\"),\"Weber Unions Eddieland MT 64619\",\"660.391.3730\"), \"user_9\":(\"veronica.j@yahoo.com\",\"Veronica Jordan\",date(\"1947-06-08\"),\"2 Klein Mission New Annetteton HI 05775\",\"810-252-6218\"), \"user_10\":(\"steven@phelps-craig.info\",\"Steven Brooks\",date(\"1954-06-14\"),\"1 Vanessa Stravenue Suite 184 Baileyville NY 46381\",\"+1-665-328-8103x3448\"), \"user_11\":(\"ReginaldTheMan@hotmail.com\",\"Reginald Mccullough\",date(\"1915-04-12\"),\"John Garden Port John LA 54602\",\"030.088.4523x94511\"), \"user_12\":(\"Jennifer.f@carroll-acosta.com\",\"Jennifer Foster\",date(\"1988-04-30\"),\"11 Webb Groves Tiffanyside MN 14566\",\"(489)306-8558x98227\"), \"user_13\":(\"Philip66@yahoo.com\",\"Philip Garcia\",date(\"1955-12-01\"),\"70 Robinson Locks Suite 113 East Veronica ND 87845\",\"490-088-7610x9437\"), \"user_14\":(\"Ann@hernandez.com\",\"Ann Williams\",date(\"1947-05-28\"),\"24 Mcknight Port Apt. 028 Sarahborough MD 38195\",\"868.057.4056x4814\"), \"user_15\":(\"Jessica@turner.com\",\"Jessica Stewart\",date(\"1951-11-28\"),\"0337 Mason Corner Apt. 900 Toddmouth FL 61464\",\"(335)408-3835x883\"), \"user_16\":(\"Sandra311@hotmail.com\",\"Sandra Dougherty\",date(\"1908-06-03\"),\"7 Davis Station Apt. 691 Pittmanfort HI 29746\",\"+1-189-827-0744x27614\"), \"user_17\":(\"Sharon91@gmail.com\",\"Sharon Mccoy\",date(\"1958-09-01\"),\"1 Southport Street Apt. 098 Westport KY 85907\",\"(814)898-9079x898\"), \"user_18\":(\"Sharon91+001@gmail.com\",\"Kathryn Miller\",date(\"1958-09-01\"),\"1 Southport Street Apt. 098 Westport KY 85907\",\"(814)898-9079x898\"), \"user_19\":(\"brettglenn@googlemail.com\",\"Bretty Glenn\",date(\"1991-09-03\"),\"Weber Unions Eddieland MT 64619\",\"660-391-3730\"), \"user_20\":(\"julia.h.24@yahoo.com\",\"Julia H.\",date(\"1927-08-24\"),\"Rodriguez Track East Connorfort NC 63144\",\"1248361783\"), \"user_21\":(\"holly@welch.org\",\"Holly\",date(\"0000-10-19\"),\"1 Ama","date":"2022-08-14","objectID":"/identity-resolution/:1:1","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#å›¾å»ºæ¨¡"},{"categories":["Nebula Graph"],"content":" 1.1 å»ºç«‹å›¾è°± 1.1.1 å›¾å»ºæ¨¡æˆ‘ä»¬ä»ä¸€ä¸ªæœ€ç®€å•ã€ç›´æ¥çš„å›¾è°±å¼€å§‹ï¼Œå¦‚ä¸‹è¾¹çš„å›¾ç»“æ„ç¤ºæ„æ˜¾ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰äº†ç‚¹ï¼š user Prop: [name, email, birthday, address, phone_num] phone email device ip address åœ¨ä»–ä»¬ä¹‹é—´æœ‰å¾ˆè‡ªç„¶çš„è¾¹ï¼š used_device Prop: time logged_in_from Prop: time has_phone has_address has_email 1.1.2 æ•°æ®è¿™ä»½æ•°æ®æ˜¯å¼€æºçš„ï¼Œåœ°å€åœ¨ https://github.com/wey-gu/identity-correlation-datagen 1.1.3 å†™å…¥ NebulaGraph åˆ©ç”¨ Nebula Upï¼Œä¸€è¡Œéƒ¨ç½² NebulaGraph åœ°å€ï¼šhttps://github.com/wey-gu/nebula-up/ curl -fsSL nebula-up.siwei.io/install.sh | bash å›¾å»ºæ¨¡çš„ Schema å¯¹åº”çš„ NebulaGraph DDL æ˜¯ï¼š # åˆ›å»ºä¸€ä¸ªå«åš entity_resolution çš„å›¾ç©ºé—´ CREATE SPACE entity_resolution (vid_type=FIXED_STRING(30)); USE entity_resolution; # åˆ›å»ºç‚¹çš„ç±»å‹ TAG CREATE TAG `user` (`name` string NOT NULL, `email` string NOT NULL, `phone_num` string NOT NULL, `birthday` date NOT NULL, `address` string NOT NULL); CREATE TAG `address` (`address` string NOT NULL); CREATE TAG `device` (`uuid` string NOT NULL); CREATE TAG `email` (); CREATE TAG `ip` (); CREATE TAG `phone` (); # åˆ›å»ºè¾¹çš„ç±»å‹ Edge Type CREATE EDGE `used_device` (`time` timestamp NOT NULL); CREATE EDGE `logged_in_from` (`time` timestamp NOT NULL); CREATE EDGE `has_phone` (); CREATE EDGE `has_address` (); CREATE EDGE `has_email` (); å¯¹äºå†™å…¥æ•°æ®çš„ DMLï¼Œè¿™é‡Œåªç»™å‡º user ï¼Œemail ç±»å‹ç‚¹ã€has_email ç±»å‹è¾¹çš„ä¾‹å­ INSERT VERTEX `user` (`email`, `name`, `birthday`, `address`, `phone_num`) VALUES \"user_1\":(\"heathermoore@johnson.com\",\"Miranda Miller\",date(\"1957-08-27\"),\"Brittany Forge Apt. 718 East Eric WV 97881\",\"+1-652-450-5443x00562\"), \"user_2\":(\"holly@welch.org\",\"Holly Pollard\",date(\"1990-10-19\"),\"1 Amanda Freeway Lisaland NJ 94933\",\"600-192-2985x041\"), \"user_3\":(\"julia.h.24@gmail.com\",\"Julia Hall\",date(\"1927-08-24\"),\"Rodriguez Track East Connorfort NC 63144\",\"1248361783\"), \"user_4\":(\"franklin.b@gibson.biz\",\"Franklin Barnett\",date(\"2020-03-01\"),\"Richard Curve Kingstad AZ 05660\",\"(224)497-9312\"), \"user_5\":(\"4kelly@yahoo.com\",\"April Kelly\",date(\"1967-12-01\"),\"Schmidt Key Lake Charles AL 36174\",\"410.138.1816x98702\"), \"user_6\":(\"steven.web@johnson.com\",\"Steven Webb\",date(\"1955-04-24\"),\"5 Joanna Key Suite 704 Frankshire OK 03035\",\"3666519376\"), \"user_7\":(\"Jessica_Torres@morris.com\",\"Jessica Torres\",date(\"1958-09-03\"),\"1 Payne Circle Mitchellfort LA 73053\",\"535-357-3112x4903\"), \"user_8\":(\"brettglenn@gmail.com\",\"Brett Glenn\",date(\"1992-09-03\"),\"Weber Unions Eddieland MT 64619\",\"660.391.3730\"), \"user_9\":(\"veronica.j@yahoo.com\",\"Veronica Jordan\",date(\"1947-06-08\"),\"2 Klein Mission New Annetteton HI 05775\",\"810-252-6218\"), \"user_10\":(\"steven@phelps-craig.info\",\"Steven Brooks\",date(\"1954-06-14\"),\"1 Vanessa Stravenue Suite 184 Baileyville NY 46381\",\"+1-665-328-8103x3448\"), \"user_11\":(\"ReginaldTheMan@hotmail.com\",\"Reginald Mccullough\",date(\"1915-04-12\"),\"John Garden Port John LA 54602\",\"030.088.4523x94511\"), \"user_12\":(\"Jennifer.f@carroll-acosta.com\",\"Jennifer Foster\",date(\"1988-04-30\"),\"11 Webb Groves Tiffanyside MN 14566\",\"(489)306-8558x98227\"), \"user_13\":(\"Philip66@yahoo.com\",\"Philip Garcia\",date(\"1955-12-01\"),\"70 Robinson Locks Suite 113 East Veronica ND 87845\",\"490-088-7610x9437\"), \"user_14\":(\"Ann@hernandez.com\",\"Ann Williams\",date(\"1947-05-28\"),\"24 Mcknight Port Apt. 028 Sarahborough MD 38195\",\"868.057.4056x4814\"), \"user_15\":(\"Jessica@turner.com\",\"Jessica Stewart\",date(\"1951-11-28\"),\"0337 Mason Corner Apt. 900 Toddmouth FL 61464\",\"(335)408-3835x883\"), \"user_16\":(\"Sandra311@hotmail.com\",\"Sandra Dougherty\",date(\"1908-06-03\"),\"7 Davis Station Apt. 691 Pittmanfort HI 29746\",\"+1-189-827-0744x27614\"), \"user_17\":(\"Sharon91@gmail.com\",\"Sharon Mccoy\",date(\"1958-09-01\"),\"1 Southport Street Apt. 098 Westport KY 85907\",\"(814)898-9079x898\"), \"user_18\":(\"Sharon91+001@gmail.com\",\"Kathryn Miller\",date(\"1958-09-01\"),\"1 Southport Street Apt. 098 Westport KY 85907\",\"(814)898-9079x898\"), \"user_19\":(\"brettglenn@googlemail.com\",\"Bretty Glenn\",date(\"1991-09-03\"),\"Weber Unions Eddieland MT 64619\",\"660-391-3730\"), \"user_20\":(\"julia.h.24@yahoo.com\",\"Julia H.\",date(\"1927-08-24\"),\"Rodriguez Track East Connorfort NC 63144\",\"1248361783\"), \"user_21\":(\"holly@welch.org\",\"Holly\",date(\"0000-10-19\"),\"1 Ama","date":"2022-08-14","objectID":"/identity-resolution/:1:1","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#æ•°æ®"},{"categories":["Nebula Graph"],"content":" 1.1 å»ºç«‹å›¾è°± 1.1.1 å›¾å»ºæ¨¡æˆ‘ä»¬ä»ä¸€ä¸ªæœ€ç®€å•ã€ç›´æ¥çš„å›¾è°±å¼€å§‹ï¼Œå¦‚ä¸‹è¾¹çš„å›¾ç»“æ„ç¤ºæ„æ˜¾ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰äº†ç‚¹ï¼š user Prop: [name, email, birthday, address, phone_num] phone email device ip address åœ¨ä»–ä»¬ä¹‹é—´æœ‰å¾ˆè‡ªç„¶çš„è¾¹ï¼š used_device Prop: time logged_in_from Prop: time has_phone has_address has_email 1.1.2 æ•°æ®è¿™ä»½æ•°æ®æ˜¯å¼€æºçš„ï¼Œåœ°å€åœ¨ https://github.com/wey-gu/identity-correlation-datagen 1.1.3 å†™å…¥ NebulaGraph åˆ©ç”¨ Nebula Upï¼Œä¸€è¡Œéƒ¨ç½² NebulaGraph åœ°å€ï¼šhttps://github.com/wey-gu/nebula-up/ curl -fsSL nebula-up.siwei.io/install.sh | bash å›¾å»ºæ¨¡çš„ Schema å¯¹åº”çš„ NebulaGraph DDL æ˜¯ï¼š # åˆ›å»ºä¸€ä¸ªå«åš entity_resolution çš„å›¾ç©ºé—´ CREATE SPACE entity_resolution (vid_type=FIXED_STRING(30)); USE entity_resolution; # åˆ›å»ºç‚¹çš„ç±»å‹ TAG CREATE TAG `user` (`name` string NOT NULL, `email` string NOT NULL, `phone_num` string NOT NULL, `birthday` date NOT NULL, `address` string NOT NULL); CREATE TAG `address` (`address` string NOT NULL); CREATE TAG `device` (`uuid` string NOT NULL); CREATE TAG `email` (); CREATE TAG `ip` (); CREATE TAG `phone` (); # åˆ›å»ºè¾¹çš„ç±»å‹ Edge Type CREATE EDGE `used_device` (`time` timestamp NOT NULL); CREATE EDGE `logged_in_from` (`time` timestamp NOT NULL); CREATE EDGE `has_phone` (); CREATE EDGE `has_address` (); CREATE EDGE `has_email` (); å¯¹äºå†™å…¥æ•°æ®çš„ DMLï¼Œè¿™é‡Œåªç»™å‡º user ï¼Œemail ç±»å‹ç‚¹ã€has_email ç±»å‹è¾¹çš„ä¾‹å­ INSERT VERTEX `user` (`email`, `name`, `birthday`, `address`, `phone_num`) VALUES \"user_1\":(\"heathermoore@johnson.com\",\"Miranda Miller\",date(\"1957-08-27\"),\"Brittany Forge Apt. 718 East Eric WV 97881\",\"+1-652-450-5443x00562\"), \"user_2\":(\"holly@welch.org\",\"Holly Pollard\",date(\"1990-10-19\"),\"1 Amanda Freeway Lisaland NJ 94933\",\"600-192-2985x041\"), \"user_3\":(\"julia.h.24@gmail.com\",\"Julia Hall\",date(\"1927-08-24\"),\"Rodriguez Track East Connorfort NC 63144\",\"1248361783\"), \"user_4\":(\"franklin.b@gibson.biz\",\"Franklin Barnett\",date(\"2020-03-01\"),\"Richard Curve Kingstad AZ 05660\",\"(224)497-9312\"), \"user_5\":(\"4kelly@yahoo.com\",\"April Kelly\",date(\"1967-12-01\"),\"Schmidt Key Lake Charles AL 36174\",\"410.138.1816x98702\"), \"user_6\":(\"steven.web@johnson.com\",\"Steven Webb\",date(\"1955-04-24\"),\"5 Joanna Key Suite 704 Frankshire OK 03035\",\"3666519376\"), \"user_7\":(\"Jessica_Torres@morris.com\",\"Jessica Torres\",date(\"1958-09-03\"),\"1 Payne Circle Mitchellfort LA 73053\",\"535-357-3112x4903\"), \"user_8\":(\"brettglenn@gmail.com\",\"Brett Glenn\",date(\"1992-09-03\"),\"Weber Unions Eddieland MT 64619\",\"660.391.3730\"), \"user_9\":(\"veronica.j@yahoo.com\",\"Veronica Jordan\",date(\"1947-06-08\"),\"2 Klein Mission New Annetteton HI 05775\",\"810-252-6218\"), \"user_10\":(\"steven@phelps-craig.info\",\"Steven Brooks\",date(\"1954-06-14\"),\"1 Vanessa Stravenue Suite 184 Baileyville NY 46381\",\"+1-665-328-8103x3448\"), \"user_11\":(\"ReginaldTheMan@hotmail.com\",\"Reginald Mccullough\",date(\"1915-04-12\"),\"John Garden Port John LA 54602\",\"030.088.4523x94511\"), \"user_12\":(\"Jennifer.f@carroll-acosta.com\",\"Jennifer Foster\",date(\"1988-04-30\"),\"11 Webb Groves Tiffanyside MN 14566\",\"(489)306-8558x98227\"), \"user_13\":(\"Philip66@yahoo.com\",\"Philip Garcia\",date(\"1955-12-01\"),\"70 Robinson Locks Suite 113 East Veronica ND 87845\",\"490-088-7610x9437\"), \"user_14\":(\"Ann@hernandez.com\",\"Ann Williams\",date(\"1947-05-28\"),\"24 Mcknight Port Apt. 028 Sarahborough MD 38195\",\"868.057.4056x4814\"), \"user_15\":(\"Jessica@turner.com\",\"Jessica Stewart\",date(\"1951-11-28\"),\"0337 Mason Corner Apt. 900 Toddmouth FL 61464\",\"(335)408-3835x883\"), \"user_16\":(\"Sandra311@hotmail.com\",\"Sandra Dougherty\",date(\"1908-06-03\"),\"7 Davis Station Apt. 691 Pittmanfort HI 29746\",\"+1-189-827-0744x27614\"), \"user_17\":(\"Sharon91@gmail.com\",\"Sharon Mccoy\",date(\"1958-09-01\"),\"1 Southport Street Apt. 098 Westport KY 85907\",\"(814)898-9079x898\"), \"user_18\":(\"Sharon91+001@gmail.com\",\"Kathryn Miller\",date(\"1958-09-01\"),\"1 Southport Street Apt. 098 Westport KY 85907\",\"(814)898-9079x898\"), \"user_19\":(\"brettglenn@googlemail.com\",\"Bretty Glenn\",date(\"1991-09-03\"),\"Weber Unions Eddieland MT 64619\",\"660-391-3730\"), \"user_20\":(\"julia.h.24@yahoo.com\",\"Julia H.\",date(\"1927-08-24\"),\"Rodriguez Track East Connorfort NC 63144\",\"1248361783\"), \"user_21\":(\"holly@welch.org\",\"Holly\",date(\"0000-10-19\"),\"1 Ama","date":"2022-08-14","objectID":"/identity-resolution/:1:1","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#å†™å…¥-nebulagraph"},{"categories":["Nebula Graph"],"content":" 1.2 æ ¹æ®ç¡®å®šè§„åˆ™è·å– ID æ˜ å°„å…³ç³»æœ€ç®€å•ã€ç›´æ¥çš„æ–¹æ³•ï¼Œåœ¨ç‰¹å®šçš„åœºæ™¯ä¸‹ä¹Ÿå¯èƒ½æ˜¯æœ‰ç”¨çš„ï¼Œè¯•æƒ³åƒ emailã€IP åœ°å€ã€ä¸Šç½‘è®¾å¤‡è¿™äº›æœ‰ä¸¥æ ¼ç»“æ„çš„æ•°æ®ï¼Œåœ¨å®ƒä»¬æˆä¸ºå›¾è°±ä¸­çš„ç‚¹çš„æ—¶å€™ï¼Œç®€å•çš„ç›¸ç­‰å…³ç³»å°±è¶³ä»¥æ‰¾å‡ºè¿™æ ·å¯¹åº”å…³ç³»ï¼Œæ¯”å¦‚ï¼š æ‹¥æœ‰ç›¸åŒçš„ email ä½¿ç”¨è¿‡ç›¸åŒçš„ IP åœ°å€ ä½¿ç”¨è¿‡ç›¸åŒçš„è®¾å¤‡ åœ¨å‰è¾¹çš„å›¾è°±ã€å›¾æ•°æ®åº“ä¸­ï¼Œæ‹¥æœ‰ç›¸åŒçš„ email å¯ä»¥ç›´æ¥è¡¨è¾¾ä¸ºå¦‚ä¸‹çš„å›¾æ¨¡å¼ï¼ˆGraph Patternï¼‰ã€‚ (:`user`)-[:`has_email`]-\u003e(:`email`)\u003c-[:`has_email`]-[:`user`] ä¸‹å›¾ä¸ºé¡¶ç‚¹ï¼š user ä¸è¾¹ï¼šhas_email çš„ä¸€ä¸ªå›¾çš„å¯è§†åŒ–ç»“æœï¼Œå¯ä»¥çœ‹åˆ°è¿™å…¶ä¸­æœ‰ä¸¤ä¸ªä¸‰ä¸ªç‚¹ç›¸è¿çš„ä¸²æ­£æ˜¯ç¬¦åˆæ‹¥æœ‰ç›¸åŒ email çš„æ¨¡å¼çš„ç‚¹ã€‚ æ³¨ï¼š è¿™ä¸ªç»“æœçš„æ•°æ®æºåœ¨ https://github.com/wey-gu/identity-correlation-datagen/tree/main/sample/hand_crafted å¦‚æœé€šè¿‡çº¿ä¸Šè®¿é—®æœ¬æ–‡ï¼Œä½ å¯ä»¥é¼ æ ‡æ‚¬åœï¼ˆè·å–ç‚¹ä¸Šçš„å±æ€§ï¼‰å’Œæ¡†é€‰æ”¾å¤§æ¯ä¸€ä¸ªç‚¹å’Œå­å›¾å“¦ã€‚ IFrame not supported æ˜¾ç„¶ï¼Œåœ¨æ„å»º ID Mapping ç³»ç»Ÿçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°±æ˜¯é€šè¿‡åœ¨å›¾æ•°æ®åº“ä¸­ç›´æ¥æŸ¥è¯¢ï¼Œå¯è§†åŒ–æ¸²æŸ“ç»“æœæ¥çœ‹åˆ°ç­‰æ•ˆçš„æ´å¯Ÿï¼Œè¿™ä¸ªæŸ¥è¯¢å¯ä»¥å†™æˆï¼š MATCH p=(:`user`)-[:`has_email`]-\u003e(:`email`)\u003c-[:`has_email`]-(:`user`) RETURN p limit 10 NebulaGraph ä¸­çš„æŸ¥è¯¢ç»“æœ åŒæ ·ï¼Œåœ¨ä¸Šè¾¹äº¤äº’å›¾ä¸­å¯ä»¥æ”¾å¤§çœ‹åˆ°è¿™ä¸¤å¯¹æ‹¥æœ‰ç›¸åŒ email å…³è”èµ·æ¥çš„è´¦å·ï¼š ç„¶è€Œï¼Œåœ¨æ›´å¤šçœŸå®ä¸–ç•Œä¸­ï¼Œè¿™æ ·çš„æ¨¡å¼åŒ¹é…å¾€å¾€ä¸èƒ½è§£å†³æ›´å¤šç¨å¾®å¤æ‚ä¸€ç‚¹çš„æƒ…å½¢ï¼š æ¯”å¦‚ä»ä¸Šè¾¹çš„å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªåŒ¹é…äº†çš„æ˜ å°„ä¸­ï¼Œholly@welch.org å…³è”ä¸‹çš„ä¸¤ä¸ªç”¨æˆ·çš„å§“åæ˜¯ä¸åŒçš„ï¼Œè€Œ veronica.j@yahoo.com å…³è”ä¸‹çš„ä¸¤ä¸ªç”¨æˆ·å§“åæ˜¯å®Œå…¨ç›¸åŒçš„ã€‚ user_2,holly@welch.org,Holly Pollard,1990-10-19,1 Amanda Freeway Lisaland NJ 94933,600-192-2985x041 user_21,holly@welch.org,Holly,0000-10-19,1 Amanda Freeway Lisaland NJ 94933,(600)-192-2985 å†æ¯”å¦‚ Sharon91@gmail.com å’Œ Sharon91+001@gmail.com ï¼Œè¿™ä¸¤ä¸ªäººçš„å§“åä¸åŒï¼Œä½†æ˜¯æ‰‹æœºå’Œåœ°å€å´æ˜¯ç›¸åŒçš„ã€‚ user_17,Sharon91@gmail.com,Sharon Mccoy,1958-09-01,1 Southport Street Apt. 098 Westport KY 85907,(814)898-9079x898 user_18,Sharon91+001@gmail.com,Kathryn Miller,1958-09-01,1 Southport Street Apt. 098 Westport KY 85907,(814)898-9079x898 æ¯”è¾ƒåº†å¹¸çš„æ˜¯æˆ‘ä»¬åªéœ€è¦å¢åŠ ç±»ä¼¼äº\"æ‹¥æœ‰ç›¸åŒé‚®ç®±\"ã€â€œæ‹¥æœ‰ç›¸åŒåœ°å€â€ã€â€œæ‹¥æœ‰ç›¸åŒç”µè¯\"ç­‰å…¶ä»–æ¡ä»¶å°±å¯ä»¥æŠŠè¿™ç§æƒ…å†µè€ƒè™‘è¿›æ¥äº†ï¼Œè€Œéšä¹‹è€Œæ¥çš„é—®é¢˜æ˜¯ï¼š ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®éƒ½è‡³å°‘å­˜åœ¨æŸä¸€ä¸ªç¡®å®šæ¡ä»¶çš„ç›¸ç­‰ï¼ˆäºŒå…ƒçš„æ˜¯ä¸å¦ï¼‰ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ä¸€æ¡ç¡®å®šçš„è¾¹å»è¿æ¥å®ƒä»¬ï¼Œæ¯”å¦‚è¿™ä¸¤ä¸ªè´¦æˆ·ä¸­ï¼š user_5,4kelly@yahoo.com,April Kelly,1967-12-01,Schmidt Key Lake Charles AL 36174,410.138.1816x98702 user_23,4kelly@hotmail.com,Kelly April,2010-01-01,Schmidt Key Lake Charles AL 13617,410-138-1816 å¦‚ä½•è¡¨ç° 4kelly@yahoo.com ä¸ 4kelly@hotmail.com çš„ç›¸ä¼¼æ€§ï¼Ÿ å¦‚ä½•å°†å¤šç§åŒ¹é…è§„åˆ™çš„ä¿¡æ¯éƒ½çº³å…¥å…³è”ç³»ç»Ÿï¼Ÿ ","date":"2022-08-14","objectID":"/identity-resolution/:1:2","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#æ ¹æ®ç¡®å®šè§„åˆ™è·å–-id-æ˜ å°„å…³ç³»"},{"categories":["Nebula Graph"],"content":" 1.3 éç¡®å®šè§„åˆ™åŸºäºå¤åˆæ¡ä»¶é‡åŒ–æ–¹æ³•å‰è¾¹æåˆ°äº†å‡ ç§ç¡®å®šè§„åˆ™æ— æ³•å¤„ç†çš„æƒ…å†µï¼Œå®ƒä»¬å¯ä»¥å½’ç»“ä¸ºè¿™ä¸¤ç‚¹ï¼š éœ€è¦å¤šå› ç´ ï¼ˆè§„åˆ™ï¼‰è¿›è¡Œç»¼åˆè€ƒè™‘ä¸åˆ¤å®š éœ€è¦å¯¹éç¡®å®šæ¡ä»¶ï¼ˆå±æ€§ï¼‰è¿›è¡Œå¤„ç†ï¼ŒæŒ–æ˜éšå«ç›¸ç­‰ã€ç›¸ä¼¼çš„å…³è”å…³ç³»ï¼ˆè¾¹ï¼‰ å¯¹äº 1. ï¼Œå¾ˆè‡ªç„¶å¯ä»¥æƒ³åˆ°å¯¹å¤šç§å…³è”æ¡ä»¶è¿›è¡Œé‡åŒ–è¯„åˆ†ï¼ˆscoreï¼‰ï¼ŒæŒ‰ç…§å¤šç§æ¡ä»¶çš„é‡è¦ç¨‹åº¦è¿›è¡ŒåŠ æƒï¼Œç»™å‡ºè®¤å®šä¸ºå…³è”çš„æ€»åˆ†çš„é˜ˆå€¼ã€‚ æœ‰äº†å¤šå› ç´ è¯„åˆ†çš„æœºåˆ¶ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘å¦‚ä½•åœ¨ç¡®å®šçš„å¤šå› ç´ åŸºç¡€ä¹‹ä¸Šï¼Œå¢åŠ å¯¹ä¸ç¡®å®šå› ç´ çš„å¤„ç†ï¼Œä»è€Œè§£å†³ 2.çš„æƒ…å†µã€‚è¿™é‡Œï¼Œéç¡®å®šçš„æ¡ä»¶å¯èƒ½æ˜¯ï¼š a. è¡¨ç°ç»“æ„åŒ–æ•°æ®çš„ç›¸ä¼¼æ€§ï¼šSharon91@gmail.com ä¸ Sharon91+001@gmail.com b. è¡¨ç°éç»“æ„åŒ–æ•°æ®çš„ç›¸ä¼¼æ€§ï¼š Schmidt Key Lake Charles AL 36174 ä¸ Schmidt Key Lake Charles AL 13617 600-192-2985x041 ä¸(600)-192-2985 å¯¹äº a. çš„ç»“æ„åŒ–æ•°æ®ä¸­çš„ç›¸ä¼¼æ€§ï¼Œæœ‰ä¸¤ä¸ªæ€è·¯æ˜¯å¯ä»¥è€ƒè™‘çš„ï¼š ç›´æ¥è¿›è¡Œä¸¤ä¸ªå€¼çš„ç›¸ä¼¼åº¦ ç›´æ¥åˆ¤å®šå­å­—ç¬¦ä¸² è¿ç®— Jaccard index ç­‰ç±»ä¼¼çš„ç›¸ä¼¼åº¦ æ‹†åˆ†ä¸ºæ›´ç»†ç²’çš„å¤šä¸ªå±æ€§ å°† email foo+num@bar.com æ‹†åˆ†æˆä¸‰ä¸ªå­å±æ€§ email_handle: foo, email_alias: num, email_domain: bar.com ç„¶åå°±å¯ä»¥è®¾è®¡è¯¦ç»†çš„ç¡®å®šæ€§è§„åˆ™ï¼šemail.handle ç›¸ç­‰ã€ç”šè‡³å†åœ¨æ­¤åŸºç¡€ä¸Šåº”ç”¨å…¶ä»–éç¡®å®šè§„åˆ™ æœ‰æ—¶å€™ï¼Œæ¯”å¦‚å¯¹äº email_domain å­—æ®µï¼Œæˆ‘ä»¬è¿˜çŸ¥é“ gmail.com å’Œ googlemail.com æ˜¯ç­‰ä»·çš„ï¼Œè¿™é‡Œçš„å¤„ç†ä¹Ÿæ˜¯å¯ä»¥è€ƒè™‘çš„ï¼ˆåƒæ˜¯user_19,brettglenn@googlemail.com ä¸ user_8,brettglenn@gmail.comï¼Œä½†ä»é‚®ç®±åˆ¤æ–­èƒŒåå°±æ˜¯åŒä¸€ä¸ªæŒæœ‰è€…) è€Œå¯¹äº b. çš„éç»“æ„å±æ€§ç›¸ä¼¼æ€§è·ç¦»ï¼Œå¤„ç†æ–¹å¼å¯ä»¥æ ¹æ®å…·ä½“çš„ domain knowledge åƒå·®ä¸‡åˆ«ï¼š åƒ Schmidt Key Lake Charles AL 36174 ä¸ Schmidt Key Lake Charles AL 13617 çš„åœ°å€ä¿¡æ¯ï¼Œé™¤äº†å¯ä»¥ç”¨å€¼çš„ç›¸ä¼¼åº¦ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æŠŠå®ƒè½¬æ¢æˆåœ°ç†ç±»å‹çš„å±æ€§ï¼Œæ¯”å¦‚ä¸€ä¸ªç»çº¬åº¦ç»„æˆçš„ç‚¹ï¼Œä»è€Œè®¡ç®—ä¸¤ä¸ªç‚¹ä¹‹é—´çš„åœ°ç†è·ç¦»ï¼Œæ ¹æ®ç»™å®šçš„è·ç¦»å€¼æ¥æ‰“åˆ†ã€‚ æ³¨ï¼Œä½ çŸ¥é“å—ï¼ŸNebulaGraph å›¾æ•°æ®åº“ä¸­åŸç”Ÿæ”¯æŒåœ°ç†ç±»å‹çš„å±æ€§ä¸ç´¢å¼•ï¼Œå¯ä»¥ç›´æ¥åˆ›å»º Point ç±»å‹çš„åœ°ç†å±æ€§ï¼Œå¹¶è®¡ç®—ä¸¤ä¸ª Point ä¹‹é—´çš„è·ç¦»ã€‚ å¯¹äº 600-192-2985x041 ä¸(600)-192-2985 è¿™ç§å­—ç¬¦ä¸²å½¢å¼çš„ç”µè¯å·ç ï¼Œåˆ™å¯ä»¥ç»Ÿä¸€è½¬åŒ–ä¸º\u003cå›½å®¶ç \u003e+\u003cåŒºåŸŸç \u003e+\u003cæœ¬åœ°å·ç \u003e+\u003cåˆ†æœºå·\u003eè¿™æ ·çš„ç»“æ„åŒ–æ•°æ®ï¼Œè¿›ä¸€æ­¥æŒ‰ç…§ç»“æ„åŒ–æ•°æ®çš„æ–¹å¼å¤„ç†ã€‚ å¦‚æœè´¦å·å­˜åœ¨å›¾ç‰‡å¯¹è±¡ URLï¼Œå¯ä»¥å¯¹æ¯”å…¶æ–‡ä»¶ç›¸ä¼¼åº¦ã€‚ å¦å¤–ï¼Œå¯¹äºéç»“æ„å±æ€§çš„ç›¸ä¼¼æ€§è®¡ç®—æˆ‘ä»¬è¦å°½é‡é¿å…ä¸¤ä¸¤ç©·ä¸¾è¿ç®—çš„æ–¹å¼ï¼ˆç¬›å¡å°”ç§¯ï¼‰ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªæŒ‡æ•°å¢é•¿çš„é‡çº§ï¼Œä¸€ä¸ªå¯è¡Œçš„æ–¹æ³•æ˜¯åªæ¯”è¾ƒå»ºç«‹äº†ç¡®å®šæ€§å…³ç³»ï¼ˆæ¯”å¦‚ç›¸åŒé‚®ä»¶å‰ç¼€ï¼šemail_handleï¼Œåœ°å€åœ¨ç›¸åŒè¡—åŒºï¼ŒIP åœ¨åŒä¸€ä¸ªç½‘æ®µç­‰ï¼‰çš„å®ä½“ã€‚ å°ç»“ æ€»ç»“æ¥çœ‹ï¼Œä¸ºäº†è§£å†³çœŸå®ä¸–ç•Œæ•°æ®çš„å¤æ‚æƒ…å½¢ï¼ŒåŸºäºå¤åˆæ¡ä»¶çš„é‡åŒ–æ–¹æ³•æœ‰ï¼š é€šè¿‡ç»†åŒ–ç»“æ„æ•°æ®ï¼ˆæ¯”å¦‚é‚®ç®±å­—æ®µæ‹†åˆ†ä¸ºå­å±æ€§æˆ–è€…ç‚¹ï¼‰ã€æˆ–è€…è½¬å˜ä¸ºç»“æ„åŒ–æ•°æ®ï¼ˆå¤„ç†å­—ç¬¦ä¸²å½¢å¼çš„ç”µè¯å·ç ï¼‰å»ºç«‹ç›¸ä¼¼ç»“æ„åŒ–æ•°æ®ä¹‹é—´çš„ç¡®å®šå…³è”ï¼› åœ¨æœ‰é™å­˜åœ¨ç¡®å®šæ€§å…³è”çš„ç‚¹ä¹‹é—´ï¼ˆé¿å…ä¸¤ä¸¤ç©·ä¸¾ï¼‰ï¼Œè¿ç®—å…¶ä»–é‡åŒ–ã€éç¡®å®šç›¸ä¼¼æ€§ï¼ˆå­—ç¬¦è·ç¦»ã€åœ°ç†è·ç¦»ç­‰ã€å›¾ç‰‡æ–‡ä»¶ç›¸ä¼¼åº¦ï¼‰ï¼› ä¸ºä¸åŒå…³ç³»èµ‹äºˆåŠ æƒï¼Œè®¡ç®—ç›¸ä¼¼åº¦æ€»åˆ†ï¼› 1.3.1 åŸºäºå¤åˆæ¡ä»¶é‡åŒ–æ–¹æ³•å®æ“ä¸‹è¾¹ï¼Œæˆ‘ä»¬æ¥ç»™å‡ºè¿™ç³»åˆ—æ–¹æ³•çš„å®æ“æ¡ˆä¾‹ã€‚ 1. ç»†åŒ–ç»“æ„æ•°æ® é€šè¿‡ç»†åŒ–ç»“æ„æ•°æ®ï¼ˆæ¯”å¦‚é‚®ç®±å­—æ®µæ‹†åˆ†ä¸ºå­å±æ€§æˆ–è€…ç‚¹ï¼‰ã€æˆ–è€…è½¬å˜ä¸ºç»“æ„åŒ–æ•°æ®ï¼ˆå¤„ç†å­—ç¬¦ä¸²å½¢å¼çš„ç”µè¯å·ç ï¼‰å»ºç«‹ç›¸ä¼¼ç»“æ„åŒ–æ•°æ®ä¹‹é—´çš„ç¡®å®šå…³è”ï¼› é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠ email çš„ç‚¹æ‹†æˆå‰ç¼€ email_handle ä¸åç¼€ email_domainï¼Œè‡ªç„¶åœ°ï¼Œä¼šäº§ç”Ÿè¿™æ ·çš„è¾¹ï¼š has_email_with_handle (user -\u003e email_handle) has_email_with_domain (user -\u003e email_domain) with_handle (email -\u003e email_handle) with_domain (email -\u003e email_domain) ç„¶è€Œï¼Œå¯ä»¥æƒ³è§ email_domain æ˜¯ä¸€ä¸ªæ½œåœ¨çš„è¶…çº§èŠ‚ç‚¹ï¼Œå¹¶ä¸”ï¼Œå®ƒçš„åŒºåˆ†åº¦åœ¨å¾ˆå¤šæƒ…å†µä¸‹æ˜¯å¾ˆå°çš„ï¼Œæ¯”å¦‚ gmail.com è¿™ä¸ªå…¬å…±é‚®ç®±åç¼€æ²¡æœ‰å¾ˆå¤§çš„å…³è”æ€§æ„ä¹‰ã€‚æˆ‘ä»¬å¯ä»¥åªç•™ä¸‹ email.handle ä½œä¸ºç‚¹ï¼Œè€Œå¯¹äº email_domainï¼ŒæŠŠå®ƒç•™åœ¨è¾¹ä¸­ä½œä¸ºå±æ€§ï¼š has_email_with_handle (user -\u003e email_handle) Prop: email_domain with_handle (email -\u003e email_handle) Prop: email_domain å¯¹åº”çš„æ–°çš„ç‚¹ç±»å‹ã€è¾¹ç±»å‹çš„ NebulaGraph DDL è¯­å¥ï¼š # æ–°çš„ç‚¹ç±»å‹ CREATE TAG `email_handle` (); # æ–°çš„è¾¹ç±»å‹ CREATE EDGE `has_email_with_handle` (`email_domain` string NOT NULL); CREATE EDGE `with_handle` (`email_domain` string NOT NULL); å¯¹åº”æ–°çš„ç‚¹ã€è¾¹çš„ DML è¯­å¥ï¼š INSERT VERTEX `email_handle` () VALUES \"4kelly\":(), \"Ann\":(), \"brettglenn\":(), \"franklin.b\":(), \"heathermoore\":(), \"holly\":(), \"Jennifer.f\":(), \"Jessica\":(), \"Jessica_Torres\":(), \"julia.h.24\":(), \"Philip66\":(), \"ReginaldTheMan\":(), \"Sandra311\":(), \"Sharon91\":(), \"steven\":(), \"steven.web\":(), \"veronica.j\":(); INSERT EDGE `has_email_with_handle` (`email_domain`) VALUES \"user_1\"-\u003e\"heathermoore\":(\"johnson.com\"), \"user_2\"-\u003e\"holly\":(\"welch.org\"), \"user_3\"-\u003e\"julia.h.24\":(\"gmail.com\"), \"user_4\"-\u003e\"franklin.b\":(\"gibson.biz\"), \"user_5\"-\u003e\"4kelly\":(\"yahoo.com\"), \"user_6\"-\u003e\"steven.web\":(\"johnson.com\"), \"user_7\"-\u003e\"Jessica_Torres\":(\"morris.com\"), \"user_8\"-\u003e\"brettglenn\":(\"gmail.com\"), \"user_9\"-\u003e\"veronica.j\":(\"yahoo.com\"), \"user_10\"-\u003e\"steven\":(\"phelps-craig.info\"), \"user_11\"-\u003e\"ReginaldTheMan\":(\"hotmail.com\"), \"user_12\"-\u003e\"Jennifer.f\":(\"carroll-acosta.com\"), \"user_13\"-\u003e\"Philip66\":(\"yahoo.com\"), \"user_14\"-\u003e\"Ann\":(\"hernandez.com\"), \"user_15\"-\u003e\"Jessica\":(\"turner.com\"), \"user_16\"-\u003e\"Sandra311\":(\"hotmail.com\"), \"user_17\"-\u003e\"Sharon91\":(\"gmail.com\"), \"user_18\"-\u003e\"Sharon91\":(\"gmail.com\"), \"user_19\"-\u003e\"brettglenn\":(\"googlemail.com\"), \"user_20\"-\u003e\"julia.h.24\":(\"yahoo.com\"), \"user_21\"-\u003e\"holly\":(\"welch.org\"), \"user_22\"-\u003e\"veronica.j\":(\"yahoo.com\"), \"user_23\"-\u003e\"4kelly\":(\"hotmail.com\"); INSERT EDGE `with_handle` (`email_domain`) VALUES \"heathermoore@johnson.com\"-\u003e\"heathermoore\":(\"johnson.com\"), \"holly@welch.org\"-\u003e\"holly\":(\"welch.org\"), \"julia.h.24@gmail.com\"-\u003e\"julia.h.24\":(\"gmail.com\"), \"franklin.b@gibson.biz\"-\u003e\"franklin.b\":(\"gibson.biz\"), \"4kelly@yahoo.com\"-\u003e\"4kelly\":(\"yahoo.com\"), \"steven.web@johnson.com\"-\u003e\"steven.web\":(\"johnson.com\"), \"Jessica_Torres@morris.c","date":"2022-08-14","objectID":"/identity-resolution/:1:3","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#éç¡®å®šè§„åˆ™åŸºäºå¤åˆæ¡ä»¶é‡åŒ–æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.3 éç¡®å®šè§„åˆ™åŸºäºå¤åˆæ¡ä»¶é‡åŒ–æ–¹æ³•å‰è¾¹æåˆ°äº†å‡ ç§ç¡®å®šè§„åˆ™æ— æ³•å¤„ç†çš„æƒ…å†µï¼Œå®ƒä»¬å¯ä»¥å½’ç»“ä¸ºè¿™ä¸¤ç‚¹ï¼š éœ€è¦å¤šå› ç´ ï¼ˆè§„åˆ™ï¼‰è¿›è¡Œç»¼åˆè€ƒè™‘ä¸åˆ¤å®š éœ€è¦å¯¹éç¡®å®šæ¡ä»¶ï¼ˆå±æ€§ï¼‰è¿›è¡Œå¤„ç†ï¼ŒæŒ–æ˜éšå«ç›¸ç­‰ã€ç›¸ä¼¼çš„å…³è”å…³ç³»ï¼ˆè¾¹ï¼‰ å¯¹äº 1. ï¼Œå¾ˆè‡ªç„¶å¯ä»¥æƒ³åˆ°å¯¹å¤šç§å…³è”æ¡ä»¶è¿›è¡Œé‡åŒ–è¯„åˆ†ï¼ˆscoreï¼‰ï¼ŒæŒ‰ç…§å¤šç§æ¡ä»¶çš„é‡è¦ç¨‹åº¦è¿›è¡ŒåŠ æƒï¼Œç»™å‡ºè®¤å®šä¸ºå…³è”çš„æ€»åˆ†çš„é˜ˆå€¼ã€‚ æœ‰äº†å¤šå› ç´ è¯„åˆ†çš„æœºåˆ¶ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘å¦‚ä½•åœ¨ç¡®å®šçš„å¤šå› ç´ åŸºç¡€ä¹‹ä¸Šï¼Œå¢åŠ å¯¹ä¸ç¡®å®šå› ç´ çš„å¤„ç†ï¼Œä»è€Œè§£å†³ 2.çš„æƒ…å†µã€‚è¿™é‡Œï¼Œéç¡®å®šçš„æ¡ä»¶å¯èƒ½æ˜¯ï¼š a. è¡¨ç°ç»“æ„åŒ–æ•°æ®çš„ç›¸ä¼¼æ€§ï¼šSharon91@gmail.com ä¸ Sharon91+001@gmail.com b. è¡¨ç°éç»“æ„åŒ–æ•°æ®çš„ç›¸ä¼¼æ€§ï¼š Schmidt Key Lake Charles AL 36174 ä¸ Schmidt Key Lake Charles AL 13617 600-192-2985x041 ä¸(600)-192-2985 å¯¹äº a. çš„ç»“æ„åŒ–æ•°æ®ä¸­çš„ç›¸ä¼¼æ€§ï¼Œæœ‰ä¸¤ä¸ªæ€è·¯æ˜¯å¯ä»¥è€ƒè™‘çš„ï¼š ç›´æ¥è¿›è¡Œä¸¤ä¸ªå€¼çš„ç›¸ä¼¼åº¦ ç›´æ¥åˆ¤å®šå­å­—ç¬¦ä¸² è¿ç®— Jaccard index ç­‰ç±»ä¼¼çš„ç›¸ä¼¼åº¦ æ‹†åˆ†ä¸ºæ›´ç»†ç²’çš„å¤šä¸ªå±æ€§ å°† email foo+num@bar.com æ‹†åˆ†æˆä¸‰ä¸ªå­å±æ€§ email_handle: foo, email_alias: num, email_domain: bar.com ç„¶åå°±å¯ä»¥è®¾è®¡è¯¦ç»†çš„ç¡®å®šæ€§è§„åˆ™ï¼šemail.handle ç›¸ç­‰ã€ç”šè‡³å†åœ¨æ­¤åŸºç¡€ä¸Šåº”ç”¨å…¶ä»–éç¡®å®šè§„åˆ™ æœ‰æ—¶å€™ï¼Œæ¯”å¦‚å¯¹äº email_domain å­—æ®µï¼Œæˆ‘ä»¬è¿˜çŸ¥é“ gmail.com å’Œ googlemail.com æ˜¯ç­‰ä»·çš„ï¼Œè¿™é‡Œçš„å¤„ç†ä¹Ÿæ˜¯å¯ä»¥è€ƒè™‘çš„ï¼ˆåƒæ˜¯user_19,brettglenn@googlemail.com ä¸ user_8,brettglenn@gmail.comï¼Œä½†ä»é‚®ç®±åˆ¤æ–­èƒŒåå°±æ˜¯åŒä¸€ä¸ªæŒæœ‰è€…) è€Œå¯¹äº b. çš„éç»“æ„å±æ€§ç›¸ä¼¼æ€§è·ç¦»ï¼Œå¤„ç†æ–¹å¼å¯ä»¥æ ¹æ®å…·ä½“çš„ domain knowledge åƒå·®ä¸‡åˆ«ï¼š åƒ Schmidt Key Lake Charles AL 36174 ä¸ Schmidt Key Lake Charles AL 13617 çš„åœ°å€ä¿¡æ¯ï¼Œé™¤äº†å¯ä»¥ç”¨å€¼çš„ç›¸ä¼¼åº¦ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æŠŠå®ƒè½¬æ¢æˆåœ°ç†ç±»å‹çš„å±æ€§ï¼Œæ¯”å¦‚ä¸€ä¸ªç»çº¬åº¦ç»„æˆçš„ç‚¹ï¼Œä»è€Œè®¡ç®—ä¸¤ä¸ªç‚¹ä¹‹é—´çš„åœ°ç†è·ç¦»ï¼Œæ ¹æ®ç»™å®šçš„è·ç¦»å€¼æ¥æ‰“åˆ†ã€‚ æ³¨ï¼Œä½ çŸ¥é“å—ï¼ŸNebulaGraph å›¾æ•°æ®åº“ä¸­åŸç”Ÿæ”¯æŒåœ°ç†ç±»å‹çš„å±æ€§ä¸ç´¢å¼•ï¼Œå¯ä»¥ç›´æ¥åˆ›å»º Point ç±»å‹çš„åœ°ç†å±æ€§ï¼Œå¹¶è®¡ç®—ä¸¤ä¸ª Point ä¹‹é—´çš„è·ç¦»ã€‚ å¯¹äº 600-192-2985x041 ä¸(600)-192-2985 è¿™ç§å­—ç¬¦ä¸²å½¢å¼çš„ç”µè¯å·ç ï¼Œåˆ™å¯ä»¥ç»Ÿä¸€è½¬åŒ–ä¸º\u003cå›½å®¶ç \u003e+\u003cåŒºåŸŸç \u003e+\u003cæœ¬åœ°å·ç \u003e+\u003cåˆ†æœºå·\u003eè¿™æ ·çš„ç»“æ„åŒ–æ•°æ®ï¼Œè¿›ä¸€æ­¥æŒ‰ç…§ç»“æ„åŒ–æ•°æ®çš„æ–¹å¼å¤„ç†ã€‚ å¦‚æœè´¦å·å­˜åœ¨å›¾ç‰‡å¯¹è±¡ URLï¼Œå¯ä»¥å¯¹æ¯”å…¶æ–‡ä»¶ç›¸ä¼¼åº¦ã€‚ å¦å¤–ï¼Œå¯¹äºéç»“æ„å±æ€§çš„ç›¸ä¼¼æ€§è®¡ç®—æˆ‘ä»¬è¦å°½é‡é¿å…ä¸¤ä¸¤ç©·ä¸¾è¿ç®—çš„æ–¹å¼ï¼ˆç¬›å¡å°”ç§¯ï¼‰ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªæŒ‡æ•°å¢é•¿çš„é‡çº§ï¼Œä¸€ä¸ªå¯è¡Œçš„æ–¹æ³•æ˜¯åªæ¯”è¾ƒå»ºç«‹äº†ç¡®å®šæ€§å…³ç³»ï¼ˆæ¯”å¦‚ç›¸åŒé‚®ä»¶å‰ç¼€ï¼šemail_handleï¼Œåœ°å€åœ¨ç›¸åŒè¡—åŒºï¼ŒIP åœ¨åŒä¸€ä¸ªç½‘æ®µç­‰ï¼‰çš„å®ä½“ã€‚ å°ç»“ æ€»ç»“æ¥çœ‹ï¼Œä¸ºäº†è§£å†³çœŸå®ä¸–ç•Œæ•°æ®çš„å¤æ‚æƒ…å½¢ï¼ŒåŸºäºå¤åˆæ¡ä»¶çš„é‡åŒ–æ–¹æ³•æœ‰ï¼š é€šè¿‡ç»†åŒ–ç»“æ„æ•°æ®ï¼ˆæ¯”å¦‚é‚®ç®±å­—æ®µæ‹†åˆ†ä¸ºå­å±æ€§æˆ–è€…ç‚¹ï¼‰ã€æˆ–è€…è½¬å˜ä¸ºç»“æ„åŒ–æ•°æ®ï¼ˆå¤„ç†å­—ç¬¦ä¸²å½¢å¼çš„ç”µè¯å·ç ï¼‰å»ºç«‹ç›¸ä¼¼ç»“æ„åŒ–æ•°æ®ä¹‹é—´çš„ç¡®å®šå…³è”ï¼› åœ¨æœ‰é™å­˜åœ¨ç¡®å®šæ€§å…³è”çš„ç‚¹ä¹‹é—´ï¼ˆé¿å…ä¸¤ä¸¤ç©·ä¸¾ï¼‰ï¼Œè¿ç®—å…¶ä»–é‡åŒ–ã€éç¡®å®šç›¸ä¼¼æ€§ï¼ˆå­—ç¬¦è·ç¦»ã€åœ°ç†è·ç¦»ç­‰ã€å›¾ç‰‡æ–‡ä»¶ç›¸ä¼¼åº¦ï¼‰ï¼› ä¸ºä¸åŒå…³ç³»èµ‹äºˆåŠ æƒï¼Œè®¡ç®—ç›¸ä¼¼åº¦æ€»åˆ†ï¼› 1.3.1 åŸºäºå¤åˆæ¡ä»¶é‡åŒ–æ–¹æ³•å®æ“ä¸‹è¾¹ï¼Œæˆ‘ä»¬æ¥ç»™å‡ºè¿™ç³»åˆ—æ–¹æ³•çš„å®æ“æ¡ˆä¾‹ã€‚ 1. ç»†åŒ–ç»“æ„æ•°æ® é€šè¿‡ç»†åŒ–ç»“æ„æ•°æ®ï¼ˆæ¯”å¦‚é‚®ç®±å­—æ®µæ‹†åˆ†ä¸ºå­å±æ€§æˆ–è€…ç‚¹ï¼‰ã€æˆ–è€…è½¬å˜ä¸ºç»“æ„åŒ–æ•°æ®ï¼ˆå¤„ç†å­—ç¬¦ä¸²å½¢å¼çš„ç”µè¯å·ç ï¼‰å»ºç«‹ç›¸ä¼¼ç»“æ„åŒ–æ•°æ®ä¹‹é—´çš„ç¡®å®šå…³è”ï¼› é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠ email çš„ç‚¹æ‹†æˆå‰ç¼€ email_handle ä¸åç¼€ email_domainï¼Œè‡ªç„¶åœ°ï¼Œä¼šäº§ç”Ÿè¿™æ ·çš„è¾¹ï¼š has_email_with_handle (user -\u003e email_handle) has_email_with_domain (user -\u003e email_domain) with_handle (email -\u003e email_handle) with_domain (email -\u003e email_domain) ç„¶è€Œï¼Œå¯ä»¥æƒ³è§ email_domain æ˜¯ä¸€ä¸ªæ½œåœ¨çš„è¶…çº§èŠ‚ç‚¹ï¼Œå¹¶ä¸”ï¼Œå®ƒçš„åŒºåˆ†åº¦åœ¨å¾ˆå¤šæƒ…å†µä¸‹æ˜¯å¾ˆå°çš„ï¼Œæ¯”å¦‚ gmail.com è¿™ä¸ªå…¬å…±é‚®ç®±åç¼€æ²¡æœ‰å¾ˆå¤§çš„å…³è”æ€§æ„ä¹‰ã€‚æˆ‘ä»¬å¯ä»¥åªç•™ä¸‹ email.handle ä½œä¸ºç‚¹ï¼Œè€Œå¯¹äº email_domainï¼ŒæŠŠå®ƒç•™åœ¨è¾¹ä¸­ä½œä¸ºå±æ€§ï¼š has_email_with_handle (user -\u003e email_handle) Prop: email_domain with_handle (email -\u003e email_handle) Prop: email_domain å¯¹åº”çš„æ–°çš„ç‚¹ç±»å‹ã€è¾¹ç±»å‹çš„ NebulaGraph DDL è¯­å¥ï¼š # æ–°çš„ç‚¹ç±»å‹ CREATE TAG `email_handle` (); # æ–°çš„è¾¹ç±»å‹ CREATE EDGE `has_email_with_handle` (`email_domain` string NOT NULL); CREATE EDGE `with_handle` (`email_domain` string NOT NULL); å¯¹åº”æ–°çš„ç‚¹ã€è¾¹çš„ DML è¯­å¥ï¼š INSERT VERTEX `email_handle` () VALUES \"4kelly\":(), \"Ann\":(), \"brettglenn\":(), \"franklin.b\":(), \"heathermoore\":(), \"holly\":(), \"Jennifer.f\":(), \"Jessica\":(), \"Jessica_Torres\":(), \"julia.h.24\":(), \"Philip66\":(), \"ReginaldTheMan\":(), \"Sandra311\":(), \"Sharon91\":(), \"steven\":(), \"steven.web\":(), \"veronica.j\":(); INSERT EDGE `has_email_with_handle` (`email_domain`) VALUES \"user_1\"-\u003e\"heathermoore\":(\"johnson.com\"), \"user_2\"-\u003e\"holly\":(\"welch.org\"), \"user_3\"-\u003e\"julia.h.24\":(\"gmail.com\"), \"user_4\"-\u003e\"franklin.b\":(\"gibson.biz\"), \"user_5\"-\u003e\"4kelly\":(\"yahoo.com\"), \"user_6\"-\u003e\"steven.web\":(\"johnson.com\"), \"user_7\"-\u003e\"Jessica_Torres\":(\"morris.com\"), \"user_8\"-\u003e\"brettglenn\":(\"gmail.com\"), \"user_9\"-\u003e\"veronica.j\":(\"yahoo.com\"), \"user_10\"-\u003e\"steven\":(\"phelps-craig.info\"), \"user_11\"-\u003e\"ReginaldTheMan\":(\"hotmail.com\"), \"user_12\"-\u003e\"Jennifer.f\":(\"carroll-acosta.com\"), \"user_13\"-\u003e\"Philip66\":(\"yahoo.com\"), \"user_14\"-\u003e\"Ann\":(\"hernandez.com\"), \"user_15\"-\u003e\"Jessica\":(\"turner.com\"), \"user_16\"-\u003e\"Sandra311\":(\"hotmail.com\"), \"user_17\"-\u003e\"Sharon91\":(\"gmail.com\"), \"user_18\"-\u003e\"Sharon91\":(\"gmail.com\"), \"user_19\"-\u003e\"brettglenn\":(\"googlemail.com\"), \"user_20\"-\u003e\"julia.h.24\":(\"yahoo.com\"), \"user_21\"-\u003e\"holly\":(\"welch.org\"), \"user_22\"-\u003e\"veronica.j\":(\"yahoo.com\"), \"user_23\"-\u003e\"4kelly\":(\"hotmail.com\"); INSERT EDGE `with_handle` (`email_domain`) VALUES \"heathermoore@johnson.com\"-\u003e\"heathermoore\":(\"johnson.com\"), \"holly@welch.org\"-\u003e\"holly\":(\"welch.org\"), \"julia.h.24@gmail.com\"-\u003e\"julia.h.24\":(\"gmail.com\"), \"franklin.b@gibson.biz\"-\u003e\"franklin.b\":(\"gibson.biz\"), \"4kelly@yahoo.com\"-\u003e\"4kelly\":(\"yahoo.com\"), \"steven.web@johnson.com\"-\u003e\"steven.web\":(\"johnson.com\"), \"Jessica_Torres@morris.c","date":"2022-08-14","objectID":"/identity-resolution/:1:3","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åŸºäºå¤åˆæ¡ä»¶é‡åŒ–æ–¹æ³•å®æ“"},{"categories":["Nebula Graph"],"content":" 1.3 éç¡®å®šè§„åˆ™åŸºäºå¤åˆæ¡ä»¶é‡åŒ–æ–¹æ³•å‰è¾¹æåˆ°äº†å‡ ç§ç¡®å®šè§„åˆ™æ— æ³•å¤„ç†çš„æƒ…å†µï¼Œå®ƒä»¬å¯ä»¥å½’ç»“ä¸ºè¿™ä¸¤ç‚¹ï¼š éœ€è¦å¤šå› ç´ ï¼ˆè§„åˆ™ï¼‰è¿›è¡Œç»¼åˆè€ƒè™‘ä¸åˆ¤å®š éœ€è¦å¯¹éç¡®å®šæ¡ä»¶ï¼ˆå±æ€§ï¼‰è¿›è¡Œå¤„ç†ï¼ŒæŒ–æ˜éšå«ç›¸ç­‰ã€ç›¸ä¼¼çš„å…³è”å…³ç³»ï¼ˆè¾¹ï¼‰ å¯¹äº 1. ï¼Œå¾ˆè‡ªç„¶å¯ä»¥æƒ³åˆ°å¯¹å¤šç§å…³è”æ¡ä»¶è¿›è¡Œé‡åŒ–è¯„åˆ†ï¼ˆscoreï¼‰ï¼ŒæŒ‰ç…§å¤šç§æ¡ä»¶çš„é‡è¦ç¨‹åº¦è¿›è¡ŒåŠ æƒï¼Œç»™å‡ºè®¤å®šä¸ºå…³è”çš„æ€»åˆ†çš„é˜ˆå€¼ã€‚ æœ‰äº†å¤šå› ç´ è¯„åˆ†çš„æœºåˆ¶ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘å¦‚ä½•åœ¨ç¡®å®šçš„å¤šå› ç´ åŸºç¡€ä¹‹ä¸Šï¼Œå¢åŠ å¯¹ä¸ç¡®å®šå› ç´ çš„å¤„ç†ï¼Œä»è€Œè§£å†³ 2.çš„æƒ…å†µã€‚è¿™é‡Œï¼Œéç¡®å®šçš„æ¡ä»¶å¯èƒ½æ˜¯ï¼š a. è¡¨ç°ç»“æ„åŒ–æ•°æ®çš„ç›¸ä¼¼æ€§ï¼šSharon91@gmail.com ä¸ Sharon91+001@gmail.com b. è¡¨ç°éç»“æ„åŒ–æ•°æ®çš„ç›¸ä¼¼æ€§ï¼š Schmidt Key Lake Charles AL 36174 ä¸ Schmidt Key Lake Charles AL 13617 600-192-2985x041 ä¸(600)-192-2985 å¯¹äº a. çš„ç»“æ„åŒ–æ•°æ®ä¸­çš„ç›¸ä¼¼æ€§ï¼Œæœ‰ä¸¤ä¸ªæ€è·¯æ˜¯å¯ä»¥è€ƒè™‘çš„ï¼š ç›´æ¥è¿›è¡Œä¸¤ä¸ªå€¼çš„ç›¸ä¼¼åº¦ ç›´æ¥åˆ¤å®šå­å­—ç¬¦ä¸² è¿ç®— Jaccard index ç­‰ç±»ä¼¼çš„ç›¸ä¼¼åº¦ æ‹†åˆ†ä¸ºæ›´ç»†ç²’çš„å¤šä¸ªå±æ€§ å°† email foo+num@bar.com æ‹†åˆ†æˆä¸‰ä¸ªå­å±æ€§ email_handle: foo, email_alias: num, email_domain: bar.com ç„¶åå°±å¯ä»¥è®¾è®¡è¯¦ç»†çš„ç¡®å®šæ€§è§„åˆ™ï¼šemail.handle ç›¸ç­‰ã€ç”šè‡³å†åœ¨æ­¤åŸºç¡€ä¸Šåº”ç”¨å…¶ä»–éç¡®å®šè§„åˆ™ æœ‰æ—¶å€™ï¼Œæ¯”å¦‚å¯¹äº email_domain å­—æ®µï¼Œæˆ‘ä»¬è¿˜çŸ¥é“ gmail.com å’Œ googlemail.com æ˜¯ç­‰ä»·çš„ï¼Œè¿™é‡Œçš„å¤„ç†ä¹Ÿæ˜¯å¯ä»¥è€ƒè™‘çš„ï¼ˆåƒæ˜¯user_19,brettglenn@googlemail.com ä¸ user_8,brettglenn@gmail.comï¼Œä½†ä»é‚®ç®±åˆ¤æ–­èƒŒåå°±æ˜¯åŒä¸€ä¸ªæŒæœ‰è€…) è€Œå¯¹äº b. çš„éç»“æ„å±æ€§ç›¸ä¼¼æ€§è·ç¦»ï¼Œå¤„ç†æ–¹å¼å¯ä»¥æ ¹æ®å…·ä½“çš„ domain knowledge åƒå·®ä¸‡åˆ«ï¼š åƒ Schmidt Key Lake Charles AL 36174 ä¸ Schmidt Key Lake Charles AL 13617 çš„åœ°å€ä¿¡æ¯ï¼Œé™¤äº†å¯ä»¥ç”¨å€¼çš„ç›¸ä¼¼åº¦ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æŠŠå®ƒè½¬æ¢æˆåœ°ç†ç±»å‹çš„å±æ€§ï¼Œæ¯”å¦‚ä¸€ä¸ªç»çº¬åº¦ç»„æˆçš„ç‚¹ï¼Œä»è€Œè®¡ç®—ä¸¤ä¸ªç‚¹ä¹‹é—´çš„åœ°ç†è·ç¦»ï¼Œæ ¹æ®ç»™å®šçš„è·ç¦»å€¼æ¥æ‰“åˆ†ã€‚ æ³¨ï¼Œä½ çŸ¥é“å—ï¼ŸNebulaGraph å›¾æ•°æ®åº“ä¸­åŸç”Ÿæ”¯æŒåœ°ç†ç±»å‹çš„å±æ€§ä¸ç´¢å¼•ï¼Œå¯ä»¥ç›´æ¥åˆ›å»º Point ç±»å‹çš„åœ°ç†å±æ€§ï¼Œå¹¶è®¡ç®—ä¸¤ä¸ª Point ä¹‹é—´çš„è·ç¦»ã€‚ å¯¹äº 600-192-2985x041 ä¸(600)-192-2985 è¿™ç§å­—ç¬¦ä¸²å½¢å¼çš„ç”µè¯å·ç ï¼Œåˆ™å¯ä»¥ç»Ÿä¸€è½¬åŒ–ä¸º\u003cå›½å®¶ç \u003e+\u003cåŒºåŸŸç \u003e+\u003cæœ¬åœ°å·ç \u003e+\u003cåˆ†æœºå·\u003eè¿™æ ·çš„ç»“æ„åŒ–æ•°æ®ï¼Œè¿›ä¸€æ­¥æŒ‰ç…§ç»“æ„åŒ–æ•°æ®çš„æ–¹å¼å¤„ç†ã€‚ å¦‚æœè´¦å·å­˜åœ¨å›¾ç‰‡å¯¹è±¡ URLï¼Œå¯ä»¥å¯¹æ¯”å…¶æ–‡ä»¶ç›¸ä¼¼åº¦ã€‚ å¦å¤–ï¼Œå¯¹äºéç»“æ„å±æ€§çš„ç›¸ä¼¼æ€§è®¡ç®—æˆ‘ä»¬è¦å°½é‡é¿å…ä¸¤ä¸¤ç©·ä¸¾è¿ç®—çš„æ–¹å¼ï¼ˆç¬›å¡å°”ç§¯ï¼‰ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªæŒ‡æ•°å¢é•¿çš„é‡çº§ï¼Œä¸€ä¸ªå¯è¡Œçš„æ–¹æ³•æ˜¯åªæ¯”è¾ƒå»ºç«‹äº†ç¡®å®šæ€§å…³ç³»ï¼ˆæ¯”å¦‚ç›¸åŒé‚®ä»¶å‰ç¼€ï¼šemail_handleï¼Œåœ°å€åœ¨ç›¸åŒè¡—åŒºï¼ŒIP åœ¨åŒä¸€ä¸ªç½‘æ®µç­‰ï¼‰çš„å®ä½“ã€‚ å°ç»“ æ€»ç»“æ¥çœ‹ï¼Œä¸ºäº†è§£å†³çœŸå®ä¸–ç•Œæ•°æ®çš„å¤æ‚æƒ…å½¢ï¼ŒåŸºäºå¤åˆæ¡ä»¶çš„é‡åŒ–æ–¹æ³•æœ‰ï¼š é€šè¿‡ç»†åŒ–ç»“æ„æ•°æ®ï¼ˆæ¯”å¦‚é‚®ç®±å­—æ®µæ‹†åˆ†ä¸ºå­å±æ€§æˆ–è€…ç‚¹ï¼‰ã€æˆ–è€…è½¬å˜ä¸ºç»“æ„åŒ–æ•°æ®ï¼ˆå¤„ç†å­—ç¬¦ä¸²å½¢å¼çš„ç”µè¯å·ç ï¼‰å»ºç«‹ç›¸ä¼¼ç»“æ„åŒ–æ•°æ®ä¹‹é—´çš„ç¡®å®šå…³è”ï¼› åœ¨æœ‰é™å­˜åœ¨ç¡®å®šæ€§å…³è”çš„ç‚¹ä¹‹é—´ï¼ˆé¿å…ä¸¤ä¸¤ç©·ä¸¾ï¼‰ï¼Œè¿ç®—å…¶ä»–é‡åŒ–ã€éç¡®å®šç›¸ä¼¼æ€§ï¼ˆå­—ç¬¦è·ç¦»ã€åœ°ç†è·ç¦»ç­‰ã€å›¾ç‰‡æ–‡ä»¶ç›¸ä¼¼åº¦ï¼‰ï¼› ä¸ºä¸åŒå…³ç³»èµ‹äºˆåŠ æƒï¼Œè®¡ç®—ç›¸ä¼¼åº¦æ€»åˆ†ï¼› 1.3.1 åŸºäºå¤åˆæ¡ä»¶é‡åŒ–æ–¹æ³•å®æ“ä¸‹è¾¹ï¼Œæˆ‘ä»¬æ¥ç»™å‡ºè¿™ç³»åˆ—æ–¹æ³•çš„å®æ“æ¡ˆä¾‹ã€‚ 1. ç»†åŒ–ç»“æ„æ•°æ® é€šè¿‡ç»†åŒ–ç»“æ„æ•°æ®ï¼ˆæ¯”å¦‚é‚®ç®±å­—æ®µæ‹†åˆ†ä¸ºå­å±æ€§æˆ–è€…ç‚¹ï¼‰ã€æˆ–è€…è½¬å˜ä¸ºç»“æ„åŒ–æ•°æ®ï¼ˆå¤„ç†å­—ç¬¦ä¸²å½¢å¼çš„ç”µè¯å·ç ï¼‰å»ºç«‹ç›¸ä¼¼ç»“æ„åŒ–æ•°æ®ä¹‹é—´çš„ç¡®å®šå…³è”ï¼› é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠ email çš„ç‚¹æ‹†æˆå‰ç¼€ email_handle ä¸åç¼€ email_domainï¼Œè‡ªç„¶åœ°ï¼Œä¼šäº§ç”Ÿè¿™æ ·çš„è¾¹ï¼š has_email_with_handle (user -\u003e email_handle) has_email_with_domain (user -\u003e email_domain) with_handle (email -\u003e email_handle) with_domain (email -\u003e email_domain) ç„¶è€Œï¼Œå¯ä»¥æƒ³è§ email_domain æ˜¯ä¸€ä¸ªæ½œåœ¨çš„è¶…çº§èŠ‚ç‚¹ï¼Œå¹¶ä¸”ï¼Œå®ƒçš„åŒºåˆ†åº¦åœ¨å¾ˆå¤šæƒ…å†µä¸‹æ˜¯å¾ˆå°çš„ï¼Œæ¯”å¦‚ gmail.com è¿™ä¸ªå…¬å…±é‚®ç®±åç¼€æ²¡æœ‰å¾ˆå¤§çš„å…³è”æ€§æ„ä¹‰ã€‚æˆ‘ä»¬å¯ä»¥åªç•™ä¸‹ email.handle ä½œä¸ºç‚¹ï¼Œè€Œå¯¹äº email_domainï¼ŒæŠŠå®ƒç•™åœ¨è¾¹ä¸­ä½œä¸ºå±æ€§ï¼š has_email_with_handle (user -\u003e email_handle) Prop: email_domain with_handle (email -\u003e email_handle) Prop: email_domain å¯¹åº”çš„æ–°çš„ç‚¹ç±»å‹ã€è¾¹ç±»å‹çš„ NebulaGraph DDL è¯­å¥ï¼š # æ–°çš„ç‚¹ç±»å‹ CREATE TAG `email_handle` (); # æ–°çš„è¾¹ç±»å‹ CREATE EDGE `has_email_with_handle` (`email_domain` string NOT NULL); CREATE EDGE `with_handle` (`email_domain` string NOT NULL); å¯¹åº”æ–°çš„ç‚¹ã€è¾¹çš„ DML è¯­å¥ï¼š INSERT VERTEX `email_handle` () VALUES \"4kelly\":(), \"Ann\":(), \"brettglenn\":(), \"franklin.b\":(), \"heathermoore\":(), \"holly\":(), \"Jennifer.f\":(), \"Jessica\":(), \"Jessica_Torres\":(), \"julia.h.24\":(), \"Philip66\":(), \"ReginaldTheMan\":(), \"Sandra311\":(), \"Sharon91\":(), \"steven\":(), \"steven.web\":(), \"veronica.j\":(); INSERT EDGE `has_email_with_handle` (`email_domain`) VALUES \"user_1\"-\u003e\"heathermoore\":(\"johnson.com\"), \"user_2\"-\u003e\"holly\":(\"welch.org\"), \"user_3\"-\u003e\"julia.h.24\":(\"gmail.com\"), \"user_4\"-\u003e\"franklin.b\":(\"gibson.biz\"), \"user_5\"-\u003e\"4kelly\":(\"yahoo.com\"), \"user_6\"-\u003e\"steven.web\":(\"johnson.com\"), \"user_7\"-\u003e\"Jessica_Torres\":(\"morris.com\"), \"user_8\"-\u003e\"brettglenn\":(\"gmail.com\"), \"user_9\"-\u003e\"veronica.j\":(\"yahoo.com\"), \"user_10\"-\u003e\"steven\":(\"phelps-craig.info\"), \"user_11\"-\u003e\"ReginaldTheMan\":(\"hotmail.com\"), \"user_12\"-\u003e\"Jennifer.f\":(\"carroll-acosta.com\"), \"user_13\"-\u003e\"Philip66\":(\"yahoo.com\"), \"user_14\"-\u003e\"Ann\":(\"hernandez.com\"), \"user_15\"-\u003e\"Jessica\":(\"turner.com\"), \"user_16\"-\u003e\"Sandra311\":(\"hotmail.com\"), \"user_17\"-\u003e\"Sharon91\":(\"gmail.com\"), \"user_18\"-\u003e\"Sharon91\":(\"gmail.com\"), \"user_19\"-\u003e\"brettglenn\":(\"googlemail.com\"), \"user_20\"-\u003e\"julia.h.24\":(\"yahoo.com\"), \"user_21\"-\u003e\"holly\":(\"welch.org\"), \"user_22\"-\u003e\"veronica.j\":(\"yahoo.com\"), \"user_23\"-\u003e\"4kelly\":(\"hotmail.com\"); INSERT EDGE `with_handle` (`email_domain`) VALUES \"heathermoore@johnson.com\"-\u003e\"heathermoore\":(\"johnson.com\"), \"holly@welch.org\"-\u003e\"holly\":(\"welch.org\"), \"julia.h.24@gmail.com\"-\u003e\"julia.h.24\":(\"gmail.com\"), \"franklin.b@gibson.biz\"-\u003e\"franklin.b\":(\"gibson.biz\"), \"4kelly@yahoo.com\"-\u003e\"4kelly\":(\"yahoo.com\"), \"steven.web@johnson.com\"-\u003e\"steven.web\":(\"johnson.com\"), \"Jessica_Torres@morris.c","date":"2022-08-14","objectID":"/identity-resolution/:1:3","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åˆ©ç”¨-active-learning-çš„æ–¹æ³•äº¤äº’å¼å­¦ä¹ è¯„åˆ†æƒé‡"},{"categories":["Nebula Graph"],"content":" 1.4 åˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•è¿›ä¸€æ­¥ï¼Œå¯¹äºè¿™äº›ç¡®å®šï¼ˆæ˜¯å¦äºŒå…ƒçš„ï¼‰æˆ–éç¡®å®šï¼ˆé‡åŒ–çš„ï¼‰å…³ç³»ï¼Œåˆ©ç”¨å›¾åº“ä¸å¤–éƒ¨ç³»ç»Ÿè·å¾—äº†å…³è”å…³ç³»ä¹‹åï¼Œå¸¸å¸¸å¯ä»¥ç›´æ¥æŠŠå®ƒä»¬å®šä¹‰ä¸ºå›¾è°±ä¸­ç›´è¿çš„è¾¹ï¼Œå†™å›å›¾åº“ï¼Œæä¾›ç»™å…¶ä»–ç®—æ³•ã€ç³»ç»Ÿä½œä¸ºè¾“å…¥ï¼Œåšè¿›ä¸€æ­¥è¿­ä»£ã€è®¡ç®—ã€‚ 1.4.1 åˆ›å»ºå•ç‹¬çš„ç›´è¿è¾¹å‡è®¾ä¹‹å‰å¯¹é‚®ä»¶ã€åœ°å€ã€å§“åçš„å¤„ç†ä¹‹åï¼ŒæŠŠç»“æœä½œä¸ºç”¨æˆ·å®ä½“ä¹‹å‰çš„ç›´è¿è¾¹æ’å…¥å›¾è°±ï¼Œè¿™äº›ç§è¾¹å«åšï¼š shared_similar_email shared_similar_location shared_name # DDL CREATE EDGE `shared_similar_email` (); CREATE EDGE `shared_similar_location` (); CREATE EDGE `shared_name` (); # DML INSERT EDGE `shared_similar_email` () VALUES \"user_5\" -\u003e\"user_23\":(), \"user_9\" -\u003e\"user_22\":(), \"user_21\"-\u003e\"user_2\" :(), \"user_2\" -\u003e\"user_21\":(), \"user_22\"-\u003e\"user_9\" :(), \"user_20\"-\u003e\"user_3\" :(), \"user_3\" -\u003e\"user_20\":(), \"user_18\"-\u003e\"user_17\":(), \"user_17\"-\u003e\"user_18\":(), \"user_19\"-\u003e\"user_8\" :(), \"user_8\" -\u003e\"user_19\":(), \"user_23\"-\u003e\"user_5\" :(); INSERT EDGE `shared_name` () VALUES \"user_9\" -\u003e\"user_22\":(), \"user_22\"-\u003e\"user_9\" :(); INSERT EDGE `shared_similar_location` () VALUES \"user_5\" -\u003e\"user_23\":(), \"user_9\" -\u003e\"user_22\":(), \"user_21\"-\u003e\"user_2\" :(), \"user_2\" -\u003e\"user_21\":(), \"user_22\"-\u003e\"user_9\" :(), \"user_20\"-\u003e\"user_3\" :(), \"user_3\" -\u003e\"user_20\":(), \"user_18\"-\u003e\"user_17\":(), \"user_17\"-\u003e\"user_18\":(), \"user_19\"-\u003e\"user_8\" :(), \"user_8\" -\u003e\"user_19\":(), \"user_23\"-\u003e\"user_5\" :(); 1.4.2 åˆ›å»ºå¤åˆè¯„åˆ†ä¹‹åçš„è¾¹æ¯”å¦‚ï¼Œæˆ‘ä»¬æŸ¥è¯¢ç»¼åˆåˆ†æ•°å¤§äº 2 çš„ç‚¹ï¼š MATCH (v_start:`user`)-[:has_email_with_handle]-\u003e(:email_handle)\u003c-[:has_email_with_handle]-(v_end:`user`) MATCH (v_start:`user`)-[:has_address]-\u003e(a_start:address) MATCH (v_end:`user`)-[:has_address]-\u003e(a_end:address) WITH id(v_start) AS s, id(v_end) AS e, v_start.`user`.name AS s_name, v_end.`user`.name AS e_name, ST_Distance(a_start.address.geo_point, a_end.address.geo_point) AS distance WITH s, e, 1 AS shared_email_handle, CASE WHEN s_name == e_name THEN 1 ELSE 0 END AS shared_name, CASE WHEN distance \u003c 10000 THEN 1 ELSE 0 END AS shared_location WITH s, e, (shared_email_handle + shared_name + shared_location) AS score WHERE score \u003e 2 RETURN s, e, score ORDER BY score DESC ç„¶åæ ¹æ®è¿”å›ç»“æœå»ºç«‹æ–°çš„è¾¹ï¼š # DDL CREATE EDGE `is_similar_to` (score int NOT NULL); # DML INSERT EDGE `is_similar_to` (`score`) VALUES \"user_22\" -\u003e\"user_9\":(3), \"user_9\" -\u003e\"user_22\":(3); ","date":"2022-08-14","objectID":"/identity-resolution/:1:4","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.4 åˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•è¿›ä¸€æ­¥ï¼Œå¯¹äºè¿™äº›ç¡®å®šï¼ˆæ˜¯å¦äºŒå…ƒçš„ï¼‰æˆ–éç¡®å®šï¼ˆé‡åŒ–çš„ï¼‰å…³ç³»ï¼Œåˆ©ç”¨å›¾åº“ä¸å¤–éƒ¨ç³»ç»Ÿè·å¾—äº†å…³è”å…³ç³»ä¹‹åï¼Œå¸¸å¸¸å¯ä»¥ç›´æ¥æŠŠå®ƒä»¬å®šä¹‰ä¸ºå›¾è°±ä¸­ç›´è¿çš„è¾¹ï¼Œå†™å›å›¾åº“ï¼Œæä¾›ç»™å…¶ä»–ç®—æ³•ã€ç³»ç»Ÿä½œä¸ºè¾“å…¥ï¼Œåšè¿›ä¸€æ­¥è¿­ä»£ã€è®¡ç®—ã€‚ 1.4.1 åˆ›å»ºå•ç‹¬çš„ç›´è¿è¾¹å‡è®¾ä¹‹å‰å¯¹é‚®ä»¶ã€åœ°å€ã€å§“åçš„å¤„ç†ä¹‹åï¼ŒæŠŠç»“æœä½œä¸ºç”¨æˆ·å®ä½“ä¹‹å‰çš„ç›´è¿è¾¹æ’å…¥å›¾è°±ï¼Œè¿™äº›ç§è¾¹å«åšï¼š shared_similar_email shared_similar_location shared_name # DDL CREATE EDGE `shared_similar_email` (); CREATE EDGE `shared_similar_location` (); CREATE EDGE `shared_name` (); # DML INSERT EDGE `shared_similar_email` () VALUES \"user_5\" -\u003e\"user_23\":(), \"user_9\" -\u003e\"user_22\":(), \"user_21\"-\u003e\"user_2\" :(), \"user_2\" -\u003e\"user_21\":(), \"user_22\"-\u003e\"user_9\" :(), \"user_20\"-\u003e\"user_3\" :(), \"user_3\" -\u003e\"user_20\":(), \"user_18\"-\u003e\"user_17\":(), \"user_17\"-\u003e\"user_18\":(), \"user_19\"-\u003e\"user_8\" :(), \"user_8\" -\u003e\"user_19\":(), \"user_23\"-\u003e\"user_5\" :(); INSERT EDGE `shared_name` () VALUES \"user_9\" -\u003e\"user_22\":(), \"user_22\"-\u003e\"user_9\" :(); INSERT EDGE `shared_similar_location` () VALUES \"user_5\" -\u003e\"user_23\":(), \"user_9\" -\u003e\"user_22\":(), \"user_21\"-\u003e\"user_2\" :(), \"user_2\" -\u003e\"user_21\":(), \"user_22\"-\u003e\"user_9\" :(), \"user_20\"-\u003e\"user_3\" :(), \"user_3\" -\u003e\"user_20\":(), \"user_18\"-\u003e\"user_17\":(), \"user_17\"-\u003e\"user_18\":(), \"user_19\"-\u003e\"user_8\" :(), \"user_8\" -\u003e\"user_19\":(), \"user_23\"-\u003e\"user_5\" :(); 1.4.2 åˆ›å»ºå¤åˆè¯„åˆ†ä¹‹åçš„è¾¹æ¯”å¦‚ï¼Œæˆ‘ä»¬æŸ¥è¯¢ç»¼åˆåˆ†æ•°å¤§äº 2 çš„ç‚¹ï¼š MATCH (v_start:`user`)-[:has_email_with_handle]-\u003e(:email_handle)\u003c-[:has_email_with_handle]-(v_end:`user`) MATCH (v_start:`user`)-[:has_address]-\u003e(a_start:address) MATCH (v_end:`user`)-[:has_address]-\u003e(a_end:address) WITH id(v_start) AS s, id(v_end) AS e, v_start.`user`.name AS s_name, v_end.`user`.name AS e_name, ST_Distance(a_start.address.geo_point, a_end.address.geo_point) AS distance WITH s, e, 1 AS shared_email_handle, CASE WHEN s_name == e_name THEN 1 ELSE 0 END AS shared_name, CASE WHEN distance \u003c 10000 THEN 1 ELSE 0 END AS shared_location WITH s, e, (shared_email_handle + shared_name + shared_location) AS score WHERE score \u003e 2 RETURN s, e, score ORDER BY score DESC ç„¶åæ ¹æ®è¿”å›ç»“æœå»ºç«‹æ–°çš„è¾¹ï¼š # DDL CREATE EDGE `is_similar_to` (score int NOT NULL); # DML INSERT EDGE `is_similar_to` (`score`) VALUES \"user_22\" -\u003e\"user_9\":(3), \"user_9\" -\u003e\"user_22\":(3); ","date":"2022-08-14","objectID":"/identity-resolution/:1:4","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åˆ›å»ºå•ç‹¬çš„ç›´è¿è¾¹"},{"categories":["Nebula Graph"],"content":" 1.4 åˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•è¿›ä¸€æ­¥ï¼Œå¯¹äºè¿™äº›ç¡®å®šï¼ˆæ˜¯å¦äºŒå…ƒçš„ï¼‰æˆ–éç¡®å®šï¼ˆé‡åŒ–çš„ï¼‰å…³ç³»ï¼Œåˆ©ç”¨å›¾åº“ä¸å¤–éƒ¨ç³»ç»Ÿè·å¾—äº†å…³è”å…³ç³»ä¹‹åï¼Œå¸¸å¸¸å¯ä»¥ç›´æ¥æŠŠå®ƒä»¬å®šä¹‰ä¸ºå›¾è°±ä¸­ç›´è¿çš„è¾¹ï¼Œå†™å›å›¾åº“ï¼Œæä¾›ç»™å…¶ä»–ç®—æ³•ã€ç³»ç»Ÿä½œä¸ºè¾“å…¥ï¼Œåšè¿›ä¸€æ­¥è¿­ä»£ã€è®¡ç®—ã€‚ 1.4.1 åˆ›å»ºå•ç‹¬çš„ç›´è¿è¾¹å‡è®¾ä¹‹å‰å¯¹é‚®ä»¶ã€åœ°å€ã€å§“åçš„å¤„ç†ä¹‹åï¼ŒæŠŠç»“æœä½œä¸ºç”¨æˆ·å®ä½“ä¹‹å‰çš„ç›´è¿è¾¹æ’å…¥å›¾è°±ï¼Œè¿™äº›ç§è¾¹å«åšï¼š shared_similar_email shared_similar_location shared_name # DDL CREATE EDGE `shared_similar_email` (); CREATE EDGE `shared_similar_location` (); CREATE EDGE `shared_name` (); # DML INSERT EDGE `shared_similar_email` () VALUES \"user_5\" -\u003e\"user_23\":(), \"user_9\" -\u003e\"user_22\":(), \"user_21\"-\u003e\"user_2\" :(), \"user_2\" -\u003e\"user_21\":(), \"user_22\"-\u003e\"user_9\" :(), \"user_20\"-\u003e\"user_3\" :(), \"user_3\" -\u003e\"user_20\":(), \"user_18\"-\u003e\"user_17\":(), \"user_17\"-\u003e\"user_18\":(), \"user_19\"-\u003e\"user_8\" :(), \"user_8\" -\u003e\"user_19\":(), \"user_23\"-\u003e\"user_5\" :(); INSERT EDGE `shared_name` () VALUES \"user_9\" -\u003e\"user_22\":(), \"user_22\"-\u003e\"user_9\" :(); INSERT EDGE `shared_similar_location` () VALUES \"user_5\" -\u003e\"user_23\":(), \"user_9\" -\u003e\"user_22\":(), \"user_21\"-\u003e\"user_2\" :(), \"user_2\" -\u003e\"user_21\":(), \"user_22\"-\u003e\"user_9\" :(), \"user_20\"-\u003e\"user_3\" :(), \"user_3\" -\u003e\"user_20\":(), \"user_18\"-\u003e\"user_17\":(), \"user_17\"-\u003e\"user_18\":(), \"user_19\"-\u003e\"user_8\" :(), \"user_8\" -\u003e\"user_19\":(), \"user_23\"-\u003e\"user_5\" :(); 1.4.2 åˆ›å»ºå¤åˆè¯„åˆ†ä¹‹åçš„è¾¹æ¯”å¦‚ï¼Œæˆ‘ä»¬æŸ¥è¯¢ç»¼åˆåˆ†æ•°å¤§äº 2 çš„ç‚¹ï¼š MATCH (v_start:`user`)-[:has_email_with_handle]-\u003e(:email_handle)\u003c-[:has_email_with_handle]-(v_end:`user`) MATCH (v_start:`user`)-[:has_address]-\u003e(a_start:address) MATCH (v_end:`user`)-[:has_address]-\u003e(a_end:address) WITH id(v_start) AS s, id(v_end) AS e, v_start.`user`.name AS s_name, v_end.`user`.name AS e_name, ST_Distance(a_start.address.geo_point, a_end.address.geo_point) AS distance WITH s, e, 1 AS shared_email_handle, CASE WHEN s_name == e_name THEN 1 ELSE 0 END AS shared_name, CASE WHEN distance \u003c 10000 THEN 1 ELSE 0 END AS shared_location WITH s, e, (shared_email_handle + shared_name + shared_location) AS score WHERE score \u003e 2 RETURN s, e, score ORDER BY score DESC ç„¶åæ ¹æ®è¿”å›ç»“æœå»ºç«‹æ–°çš„è¾¹ï¼š # DDL CREATE EDGE `is_similar_to` (score int NOT NULL); # DML INSERT EDGE `is_similar_to` (`score`) VALUES \"user_22\" -\u003e\"user_9\":(3), \"user_9\" -\u003e\"user_22\":(3); ","date":"2022-08-14","objectID":"/identity-resolution/:1:4","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åˆ›å»ºå¤åˆè¯„åˆ†ä¹‹åçš„è¾¹"},{"categories":["Nebula Graph"],"content":" 1.5 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•å‰è¾¹çš„æ–¹æ³•ä¸­æˆ‘ä»¬ç›´æ¥åˆ©ç”¨äº†ç”¨æˆ·çš„å„é¡¹å±æ€§ã€è¡Œä¸ºäº‹ä»¶ä¸­äº§ç”Ÿçš„å…³ç³»ï¼Œå¹¶åˆ©ç”¨å„ç§å±æ€§ã€å€¼ç›¸ä¼¼åº¦çš„æ–¹æ³•å»ºç«‹äº†åŸºäºæ¦‚ç‡æˆ–è€…å¸¦æœ‰è¯„åˆ†çš„å…³è”å…³ç³»ã€‚è€Œåœ¨é€šè¿‡å…¶ä»–æ–¹æ³•å¢åŠ äº†æ–°çš„è¾¹ä¹‹åçš„å›¾ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å›¾ç®—æ³•çš„æ–¹æ³•æ¥æ˜ å°„æ½œåœ¨çš„ç›¸åŒç”¨æˆ· IDã€‚ 1.5.1 å›¾ç›¸ä¼¼æ€§ç®—æ³•åˆ©ç”¨èŠ‚ç‚¹ç›¸ä¼¼æ€§å›¾ç®—æ³•ï¼Œæ¯”å¦‚ Jaccard Indexã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æˆ–è€… a. åˆ©ç”¨å›¾åº“ä¹‹ä¸Šçš„å›¾è®¡ç®—å¹³å°å…¨é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæˆ–è€… b. ç”¨å›¾æŸ¥è¯¢è¯­å¥å®ç°å…¨å›¾/ç»™å®šçš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ€åç»™ç›¸ä¼¼åº¦ä¸€å®šçš„é˜ˆå€¼æ¥å¸®åŠ©å»ºç«‹æ–°çš„ï¼ˆè€ƒè™‘äº†æ¶‰åŠè¾¹çš„ï¼‰æ˜ å°„å…³ç³»ã€‚ æ³¨ï¼Œè¿™é‡Œçš„ Jaccard index å’Œæˆ‘ä»¬å‰è¾¹æåˆ°çš„æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ç°åœ¨æåŠçš„æ˜¯åº”ç”¨åœ¨å›¾ä¸Šçš„ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿ç‚¹ä½œä¸ºç®—æ³•ä¸­çš„â€œäº¤é›†â€çš„å®ç°ã€‚ 1.5.2 ç¤¾åŒºå‘ç°ç®—æ³•è‡ªç„¶åœ°ï¼Œè¿˜å¯ä»¥ç”¨ç¤¾åŒºå‘ç°çš„ç®—æ³•å…¨å›¾æ‰¾å‡ºç»™å®šçš„åŸºäºè¾¹ä¹‹ä¸‹çš„ç¤¾åŒºåˆ’åˆ†ï¼Œè°ƒè¯•ç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡åˆ’åˆ†ç¤¾åŒºå†…éƒ¨ç‚¹ä¸ºä¼°è®¡çš„ç›¸åŒç”¨æˆ·ã€‚ 1.5.3 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³• 1.5.3.1 åŸºäºå›¾æŸ¥è¯¢çš„ Jaccard å®ç°Jaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆè®¾å¤‡ã€IPã€é‚®ç®±å‰ç¼€ã€åœ°å€ï¼‰ï¼Œè€Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™æ ·çš„ NebulaGraph OpenCypher æŸ¥è¯¢å°±å¯ä»¥ç®—å‡ºè‡³å°‘åŒ…å«ä¸€è·³å…³ç³»çš„ç‚¹å’Œå®ƒç›¸å…³çš„ç‚¹ã€ä»¥åŠ Jaccard Index å€¼ï¼Œè¶Šå¤§ä»£è¡¨å…³è”åº¦è¶Šå¤§ã€‚ MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components)\u003c-[:used_device|logged_in_from|has_email_with_handle|has_address]-(v_end:`user`) WITH v_start, v_end, count(shared_components) AS intersection_size MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH id(v_start) AS v_start, v_end, intersection_size, COLLECT(id(shared_components)) AS set_a MATCH (v_end:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH v_start, id(v_end) AS v_end, intersection_size, set_a, COLLECT(id(shared_components)) AS set_b WITH v_start, v_end, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B RETURN v_start, v_end, intersection_size/size(A_U_B) AS jaccard_index ORDER BY jaccard_index DESC æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼š +-----------+-----------+---------------------+ | v_start | v_end | jaccard_index | +-----------+-----------+---------------------+ | \"user_8\" | \"user_19\" | 1.0 | | \"user_19\" | \"user_8\" | 1.0 | | \"user_20\" | \"user_3\" | 0.6666666666666666 | | \"user_3\" | \"user_20\" | 0.6666666666666666 | | \"user_21\" | \"user_2\" | 0.6 | | \"user_18\" | \"user_17\" | 0.6 | | \"user_17\" | \"user_18\" | 0.6 | | \"user_2\" | \"user_21\" | 0.6 | | \"user_22\" | \"user_9\" | 0.5 | | \"user_9\" | \"user_22\" | 0.5 | | \"user_23\" | \"user_5\" | 0.2 | | \"user_5\" | \"user_23\" | 0.2 | | \"user_21\" | \"user_20\" | 0.16666666666666666 | | \"user_20\" | \"user_21\" | 0.16666666666666666 | +-----------+-----------+---------------------+ user_8 ä¸ user_19 çš„ç³»æ•°æ˜¯æœ€å¤§çš„çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ä¹‹é—´çš„è¿æ¥ï¼Ÿ FIND ALL PATH FROM \"user_8\" TO \"user_19\" OVER * BIDIRECT YIELD path AS p; æœç„¶ï¼Œä»–ä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾ˆå¤§ï¼š 1.5.3.2 åŸºäº NebulaGraph Algorithm å›¾è®¡ç®—å¹³å°çš„ Jaccard æ–¹æ³• 1.5.3.2.1 å‰é¢æ–¹æ³•çš„å±€é™åˆ©ç”¨å›¾æ•°æ®åº“æŸ¥è¯¢è®¡ç®— Jaccard ç³»æ•°çš„æ–¹æ³•æœ‰ä¸¤æ–¹é¢å±€é™ã€‚ é¦–å…ˆï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸¤è¿ç®—ï¼Œæˆ‘ä»¬å‡è®¾äº†æ‰€æœ‰å€¼å¾—è¢«è¿ç®—çš„ç‚¹ä¹‹é—´å·²ç»å­˜åœ¨æŸç§ç¡®å®šé“¾æ¥ï¼ˆå¯¹åº” MATCH ç¬¬ä¸€è¡Œï¼‰ï¼Œè™½ç„¶è¿™æ ·çš„å‡è®¾åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥ç²—ç•¥è¢«æ¥å—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ç§å‹ç¼©å’Œå¦¥åã€‚ å…¶æ¬¡ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å½¢é‡Œï¼Œè¿™æ ·çš„æŸ¥è¯¢å°†ä¸å…·æœ‰å¯æ“ä½œæ€§ã€‚ 1.5.3.2.2 æ›´ Scale çš„æ–¹æ³•ä¸ºäº†èƒ½å¤„ç†æ›´å¤§è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spark ç­‰å¹¶è¡Œè®¡ç®—å¹³å°è¿›è¡Œç®—æ³•æ‰§è¡Œï¼› åœ¨å…¨å›¾è¿ç®—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ MinHash æ¥å¯¹ä¸¤ä¸¤æ¯”å¯¹é™ç»´ï¼Œåº†å¹¸çš„æ˜¯ï¼ŒSpark ä¸­æä¾›äº† MinHash çš„å®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ å‚è€ƒï¼š https://aksakalli.github.io/2016/03/01/jaccard-similarity-with-minhash.html https://en.wikipedia.org/wiki/MinHash https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.MinHashLSH.html https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/LSH.scala MinHash çš„æ€æƒ³ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¦‚ç‡å»æœ‰æŸä¼°è®¡ Jaccard ç³»æ•°ï¼Œè¿™é‡Œçš„é™ç»´ä½“ç°åœ¨å®ƒç”¨ bit map å»æ•°å­—åŒ–æ¯ä¸€ä¸ªé›†åˆï¼Œéšæœºå®šä¹‰ä¸åŒçš„é›†åˆä¸Šçš„ shuffleï¼ˆä¹±åºï¼‰å˜æ¢ï¼Œå–å˜æ¢ä¹‹å hash çš„æœ€å°å€¼ã€‚è¿™é‡Œï¼Œä¸¤ä¸ªé›†åˆçš„éšæœºå˜æ¢åæœ€å°å€¼ ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ç­‰äº Jaccard ç³»æ•°çš„ã€‚æ‰€ä»¥ï¼Œè¿™æ ·å·æ¢æ¢æŸ±ï¼Œå°±æŠŠéœ€è¦ä¸¤ä¸¤é›†åˆè¿ç®—æ¯”è¾ƒçš„ç®—æ³•å˜æˆåªéœ€è¦å¯¹æ¯ä¸€ä¸ªé›†åˆåšå¸¸æ•°æ¬¡éšæœºå˜æ¢å–æœ€å°çš„é™ç»´è¿‘ä¼¼è¿ç®—äº†ã€‚ åœ¨å›¾ä¸Šï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒçš„é‚»å±…å°±æ˜¯è¿™ä¸ªç‚¹çš„é›†åˆï¼Œé‚£ä¹ˆåœ¨ Spark ä¸­è¿ç®— Jaccard ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼š è·å–æ¯ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆ å¯¹ç‚¹çš„é‚»å±…è¿›è¡Œ MinHash è¿ç®—ï¼Œè·å¾— Jaccard ç³»æ•° åº†å¹¸çš„æ˜¯ï¼Œå¼€æºçš„ NebulaGraph Algorithm å·²ç»æä¾›äº†è¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—® nebula-algorithm/src/main/scala/com/vesoft/nebula/algorithm/lib/JaccardAlgo.scala äº†è§£å®ƒçš„å®ç°ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ NebulaGraph Algorithm å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹æ³•å‚è€ƒ NebulaGraph Algorithm æ–‡æ¡£ã€‚ æ³¨ï¼Œé…ç½®ä¸­ jaccard.tol çš„æ„æ¶µæ˜¯ approxSimilarityJoin ä¸­çš„ threshold ï¼š def approxSimilarityJoin( datasetA: Dataset[_], datasetB: Dataset[_], threshold: Double, distCol: String): Dataset[_] = { ... // Filter the joined datasets where the distance are smaller than the threshold. joinedDatasetWithDist.filter(col(distCol) \u003c threshold) è¯»è€…åˆ°è¿™é‡Œåº”è¯¥ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯å‡è®¾æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç”¨æˆ·å®ä½“ï¼Œè¾¹æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›´è¿å…³ç³»çš„ã€‚æ‰€ä»¥å†åº”ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç»è¿‡é¢„å¤„ç†çš„ç›´è¿è¾¹ï¼Œè¿™ä¸ªæ­¥éª¤æ­£æ˜¯å‰è¾¹ç« èŠ‚â€œåˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•â€ä¸­çš„å†…å®¹ã€‚ 1.","date":"2022-08-14","objectID":"/identity-resolution/:1:5","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.5 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•å‰è¾¹çš„æ–¹æ³•ä¸­æˆ‘ä»¬ç›´æ¥åˆ©ç”¨äº†ç”¨æˆ·çš„å„é¡¹å±æ€§ã€è¡Œä¸ºäº‹ä»¶ä¸­äº§ç”Ÿçš„å…³ç³»ï¼Œå¹¶åˆ©ç”¨å„ç§å±æ€§ã€å€¼ç›¸ä¼¼åº¦çš„æ–¹æ³•å»ºç«‹äº†åŸºäºæ¦‚ç‡æˆ–è€…å¸¦æœ‰è¯„åˆ†çš„å…³è”å…³ç³»ã€‚è€Œåœ¨é€šè¿‡å…¶ä»–æ–¹æ³•å¢åŠ äº†æ–°çš„è¾¹ä¹‹åçš„å›¾ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å›¾ç®—æ³•çš„æ–¹æ³•æ¥æ˜ å°„æ½œåœ¨çš„ç›¸åŒç”¨æˆ· IDã€‚ 1.5.1 å›¾ç›¸ä¼¼æ€§ç®—æ³•åˆ©ç”¨èŠ‚ç‚¹ç›¸ä¼¼æ€§å›¾ç®—æ³•ï¼Œæ¯”å¦‚ Jaccard Indexã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æˆ–è€… a. åˆ©ç”¨å›¾åº“ä¹‹ä¸Šçš„å›¾è®¡ç®—å¹³å°å…¨é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæˆ–è€… b. ç”¨å›¾æŸ¥è¯¢è¯­å¥å®ç°å…¨å›¾/ç»™å®šçš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ€åç»™ç›¸ä¼¼åº¦ä¸€å®šçš„é˜ˆå€¼æ¥å¸®åŠ©å»ºç«‹æ–°çš„ï¼ˆè€ƒè™‘äº†æ¶‰åŠè¾¹çš„ï¼‰æ˜ å°„å…³ç³»ã€‚ æ³¨ï¼Œè¿™é‡Œçš„ Jaccard index å’Œæˆ‘ä»¬å‰è¾¹æåˆ°çš„æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ç°åœ¨æåŠçš„æ˜¯åº”ç”¨åœ¨å›¾ä¸Šçš„ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿ç‚¹ä½œä¸ºç®—æ³•ä¸­çš„â€œäº¤é›†â€çš„å®ç°ã€‚ 1.5.2 ç¤¾åŒºå‘ç°ç®—æ³•è‡ªç„¶åœ°ï¼Œè¿˜å¯ä»¥ç”¨ç¤¾åŒºå‘ç°çš„ç®—æ³•å…¨å›¾æ‰¾å‡ºç»™å®šçš„åŸºäºè¾¹ä¹‹ä¸‹çš„ç¤¾åŒºåˆ’åˆ†ï¼Œè°ƒè¯•ç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡åˆ’åˆ†ç¤¾åŒºå†…éƒ¨ç‚¹ä¸ºä¼°è®¡çš„ç›¸åŒç”¨æˆ·ã€‚ 1.5.3 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³• 1.5.3.1 åŸºäºå›¾æŸ¥è¯¢çš„ Jaccard å®ç°Jaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆè®¾å¤‡ã€IPã€é‚®ç®±å‰ç¼€ã€åœ°å€ï¼‰ï¼Œè€Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™æ ·çš„ NebulaGraph OpenCypher æŸ¥è¯¢å°±å¯ä»¥ç®—å‡ºè‡³å°‘åŒ…å«ä¸€è·³å…³ç³»çš„ç‚¹å’Œå®ƒç›¸å…³çš„ç‚¹ã€ä»¥åŠ Jaccard Index å€¼ï¼Œè¶Šå¤§ä»£è¡¨å…³è”åº¦è¶Šå¤§ã€‚ MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components)\u003c-[:used_device|logged_in_from|has_email_with_handle|has_address]-(v_end:`user`) WITH v_start, v_end, count(shared_components) AS intersection_size MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH id(v_start) AS v_start, v_end, intersection_size, COLLECT(id(shared_components)) AS set_a MATCH (v_end:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH v_start, id(v_end) AS v_end, intersection_size, set_a, COLLECT(id(shared_components)) AS set_b WITH v_start, v_end, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B RETURN v_start, v_end, intersection_size/size(A_U_B) AS jaccard_index ORDER BY jaccard_index DESC æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼š +-----------+-----------+---------------------+ | v_start | v_end | jaccard_index | +-----------+-----------+---------------------+ | \"user_8\" | \"user_19\" | 1.0 | | \"user_19\" | \"user_8\" | 1.0 | | \"user_20\" | \"user_3\" | 0.6666666666666666 | | \"user_3\" | \"user_20\" | 0.6666666666666666 | | \"user_21\" | \"user_2\" | 0.6 | | \"user_18\" | \"user_17\" | 0.6 | | \"user_17\" | \"user_18\" | 0.6 | | \"user_2\" | \"user_21\" | 0.6 | | \"user_22\" | \"user_9\" | 0.5 | | \"user_9\" | \"user_22\" | 0.5 | | \"user_23\" | \"user_5\" | 0.2 | | \"user_5\" | \"user_23\" | 0.2 | | \"user_21\" | \"user_20\" | 0.16666666666666666 | | \"user_20\" | \"user_21\" | 0.16666666666666666 | +-----------+-----------+---------------------+ user_8 ä¸ user_19 çš„ç³»æ•°æ˜¯æœ€å¤§çš„çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ä¹‹é—´çš„è¿æ¥ï¼Ÿ FIND ALL PATH FROM \"user_8\" TO \"user_19\" OVER * BIDIRECT YIELD path AS p; æœç„¶ï¼Œä»–ä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾ˆå¤§ï¼š 1.5.3.2 åŸºäº NebulaGraph Algorithm å›¾è®¡ç®—å¹³å°çš„ Jaccard æ–¹æ³• 1.5.3.2.1 å‰é¢æ–¹æ³•çš„å±€é™åˆ©ç”¨å›¾æ•°æ®åº“æŸ¥è¯¢è®¡ç®— Jaccard ç³»æ•°çš„æ–¹æ³•æœ‰ä¸¤æ–¹é¢å±€é™ã€‚ é¦–å…ˆï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸¤è¿ç®—ï¼Œæˆ‘ä»¬å‡è®¾äº†æ‰€æœ‰å€¼å¾—è¢«è¿ç®—çš„ç‚¹ä¹‹é—´å·²ç»å­˜åœ¨æŸç§ç¡®å®šé“¾æ¥ï¼ˆå¯¹åº” MATCH ç¬¬ä¸€è¡Œï¼‰ï¼Œè™½ç„¶è¿™æ ·çš„å‡è®¾åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥ç²—ç•¥è¢«æ¥å—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ç§å‹ç¼©å’Œå¦¥åã€‚ å…¶æ¬¡ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å½¢é‡Œï¼Œè¿™æ ·çš„æŸ¥è¯¢å°†ä¸å…·æœ‰å¯æ“ä½œæ€§ã€‚ 1.5.3.2.2 æ›´ Scale çš„æ–¹æ³•ä¸ºäº†èƒ½å¤„ç†æ›´å¤§è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spark ç­‰å¹¶è¡Œè®¡ç®—å¹³å°è¿›è¡Œç®—æ³•æ‰§è¡Œï¼› åœ¨å…¨å›¾è¿ç®—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ MinHash æ¥å¯¹ä¸¤ä¸¤æ¯”å¯¹é™ç»´ï¼Œåº†å¹¸çš„æ˜¯ï¼ŒSpark ä¸­æä¾›äº† MinHash çš„å®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ å‚è€ƒï¼š https://aksakalli.github.io/2016/03/01/jaccard-similarity-with-minhash.html https://en.wikipedia.org/wiki/MinHash https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.MinHashLSH.html https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/LSH.scala MinHash çš„æ€æƒ³ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¦‚ç‡å»æœ‰æŸä¼°è®¡ Jaccard ç³»æ•°ï¼Œè¿™é‡Œçš„é™ç»´ä½“ç°åœ¨å®ƒç”¨ bit map å»æ•°å­—åŒ–æ¯ä¸€ä¸ªé›†åˆï¼Œéšæœºå®šä¹‰ä¸åŒçš„é›†åˆä¸Šçš„ shuffleï¼ˆä¹±åºï¼‰å˜æ¢ï¼Œå–å˜æ¢ä¹‹å hash çš„æœ€å°å€¼ã€‚è¿™é‡Œï¼Œä¸¤ä¸ªé›†åˆçš„éšæœºå˜æ¢åæœ€å°å€¼ ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ç­‰äº Jaccard ç³»æ•°çš„ã€‚æ‰€ä»¥ï¼Œè¿™æ ·å·æ¢æ¢æŸ±ï¼Œå°±æŠŠéœ€è¦ä¸¤ä¸¤é›†åˆè¿ç®—æ¯”è¾ƒçš„ç®—æ³•å˜æˆåªéœ€è¦å¯¹æ¯ä¸€ä¸ªé›†åˆåšå¸¸æ•°æ¬¡éšæœºå˜æ¢å–æœ€å°çš„é™ç»´è¿‘ä¼¼è¿ç®—äº†ã€‚ åœ¨å›¾ä¸Šï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒçš„é‚»å±…å°±æ˜¯è¿™ä¸ªç‚¹çš„é›†åˆï¼Œé‚£ä¹ˆåœ¨ Spark ä¸­è¿ç®— Jaccard ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼š è·å–æ¯ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆ å¯¹ç‚¹çš„é‚»å±…è¿›è¡Œ MinHash è¿ç®—ï¼Œè·å¾— Jaccard ç³»æ•° åº†å¹¸çš„æ˜¯ï¼Œå¼€æºçš„ NebulaGraph Algorithm å·²ç»æä¾›äº†è¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—® nebula-algorithm/src/main/scala/com/vesoft/nebula/algorithm/lib/JaccardAlgo.scala äº†è§£å®ƒçš„å®ç°ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ NebulaGraph Algorithm å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹æ³•å‚è€ƒ NebulaGraph Algorithm æ–‡æ¡£ã€‚ æ³¨ï¼Œé…ç½®ä¸­ jaccard.tol çš„æ„æ¶µæ˜¯ approxSimilarityJoin ä¸­çš„ threshold ï¼š def approxSimilarityJoin( datasetA: Dataset[_], datasetB: Dataset[_], threshold: Double, distCol: String): Dataset[_] = { ... // Filter the joined datasets where the distance are smaller than the threshold. joinedDatasetWithDist.filter(col(distCol) \u003c threshold) è¯»è€…åˆ°è¿™é‡Œåº”è¯¥ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯å‡è®¾æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç”¨æˆ·å®ä½“ï¼Œè¾¹æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›´è¿å…³ç³»çš„ã€‚æ‰€ä»¥å†åº”ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç»è¿‡é¢„å¤„ç†çš„ç›´è¿è¾¹ï¼Œè¿™ä¸ªæ­¥éª¤æ­£æ˜¯å‰è¾¹ç« èŠ‚â€œåˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•â€ä¸­çš„å†…å®¹ã€‚ 1.","date":"2022-08-14","objectID":"/identity-resolution/:1:5","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#å›¾ç›¸ä¼¼æ€§ç®—æ³•"},{"categories":["Nebula Graph"],"content":" 1.5 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•å‰è¾¹çš„æ–¹æ³•ä¸­æˆ‘ä»¬ç›´æ¥åˆ©ç”¨äº†ç”¨æˆ·çš„å„é¡¹å±æ€§ã€è¡Œä¸ºäº‹ä»¶ä¸­äº§ç”Ÿçš„å…³ç³»ï¼Œå¹¶åˆ©ç”¨å„ç§å±æ€§ã€å€¼ç›¸ä¼¼åº¦çš„æ–¹æ³•å»ºç«‹äº†åŸºäºæ¦‚ç‡æˆ–è€…å¸¦æœ‰è¯„åˆ†çš„å…³è”å…³ç³»ã€‚è€Œåœ¨é€šè¿‡å…¶ä»–æ–¹æ³•å¢åŠ äº†æ–°çš„è¾¹ä¹‹åçš„å›¾ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å›¾ç®—æ³•çš„æ–¹æ³•æ¥æ˜ å°„æ½œåœ¨çš„ç›¸åŒç”¨æˆ· IDã€‚ 1.5.1 å›¾ç›¸ä¼¼æ€§ç®—æ³•åˆ©ç”¨èŠ‚ç‚¹ç›¸ä¼¼æ€§å›¾ç®—æ³•ï¼Œæ¯”å¦‚ Jaccard Indexã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æˆ–è€… a. åˆ©ç”¨å›¾åº“ä¹‹ä¸Šçš„å›¾è®¡ç®—å¹³å°å…¨é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæˆ–è€… b. ç”¨å›¾æŸ¥è¯¢è¯­å¥å®ç°å…¨å›¾/ç»™å®šçš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ€åç»™ç›¸ä¼¼åº¦ä¸€å®šçš„é˜ˆå€¼æ¥å¸®åŠ©å»ºç«‹æ–°çš„ï¼ˆè€ƒè™‘äº†æ¶‰åŠè¾¹çš„ï¼‰æ˜ å°„å…³ç³»ã€‚ æ³¨ï¼Œè¿™é‡Œçš„ Jaccard index å’Œæˆ‘ä»¬å‰è¾¹æåˆ°çš„æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ç°åœ¨æåŠçš„æ˜¯åº”ç”¨åœ¨å›¾ä¸Šçš„ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿ç‚¹ä½œä¸ºç®—æ³•ä¸­çš„â€œäº¤é›†â€çš„å®ç°ã€‚ 1.5.2 ç¤¾åŒºå‘ç°ç®—æ³•è‡ªç„¶åœ°ï¼Œè¿˜å¯ä»¥ç”¨ç¤¾åŒºå‘ç°çš„ç®—æ³•å…¨å›¾æ‰¾å‡ºç»™å®šçš„åŸºäºè¾¹ä¹‹ä¸‹çš„ç¤¾åŒºåˆ’åˆ†ï¼Œè°ƒè¯•ç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡åˆ’åˆ†ç¤¾åŒºå†…éƒ¨ç‚¹ä¸ºä¼°è®¡çš„ç›¸åŒç”¨æˆ·ã€‚ 1.5.3 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³• 1.5.3.1 åŸºäºå›¾æŸ¥è¯¢çš„ Jaccard å®ç°Jaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆè®¾å¤‡ã€IPã€é‚®ç®±å‰ç¼€ã€åœ°å€ï¼‰ï¼Œè€Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™æ ·çš„ NebulaGraph OpenCypher æŸ¥è¯¢å°±å¯ä»¥ç®—å‡ºè‡³å°‘åŒ…å«ä¸€è·³å…³ç³»çš„ç‚¹å’Œå®ƒç›¸å…³çš„ç‚¹ã€ä»¥åŠ Jaccard Index å€¼ï¼Œè¶Šå¤§ä»£è¡¨å…³è”åº¦è¶Šå¤§ã€‚ MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components)\u003c-[:used_device|logged_in_from|has_email_with_handle|has_address]-(v_end:`user`) WITH v_start, v_end, count(shared_components) AS intersection_size MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH id(v_start) AS v_start, v_end, intersection_size, COLLECT(id(shared_components)) AS set_a MATCH (v_end:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH v_start, id(v_end) AS v_end, intersection_size, set_a, COLLECT(id(shared_components)) AS set_b WITH v_start, v_end, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B RETURN v_start, v_end, intersection_size/size(A_U_B) AS jaccard_index ORDER BY jaccard_index DESC æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼š +-----------+-----------+---------------------+ | v_start | v_end | jaccard_index | +-----------+-----------+---------------------+ | \"user_8\" | \"user_19\" | 1.0 | | \"user_19\" | \"user_8\" | 1.0 | | \"user_20\" | \"user_3\" | 0.6666666666666666 | | \"user_3\" | \"user_20\" | 0.6666666666666666 | | \"user_21\" | \"user_2\" | 0.6 | | \"user_18\" | \"user_17\" | 0.6 | | \"user_17\" | \"user_18\" | 0.6 | | \"user_2\" | \"user_21\" | 0.6 | | \"user_22\" | \"user_9\" | 0.5 | | \"user_9\" | \"user_22\" | 0.5 | | \"user_23\" | \"user_5\" | 0.2 | | \"user_5\" | \"user_23\" | 0.2 | | \"user_21\" | \"user_20\" | 0.16666666666666666 | | \"user_20\" | \"user_21\" | 0.16666666666666666 | +-----------+-----------+---------------------+ user_8 ä¸ user_19 çš„ç³»æ•°æ˜¯æœ€å¤§çš„çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ä¹‹é—´çš„è¿æ¥ï¼Ÿ FIND ALL PATH FROM \"user_8\" TO \"user_19\" OVER * BIDIRECT YIELD path AS p; æœç„¶ï¼Œä»–ä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾ˆå¤§ï¼š 1.5.3.2 åŸºäº NebulaGraph Algorithm å›¾è®¡ç®—å¹³å°çš„ Jaccard æ–¹æ³• 1.5.3.2.1 å‰é¢æ–¹æ³•çš„å±€é™åˆ©ç”¨å›¾æ•°æ®åº“æŸ¥è¯¢è®¡ç®— Jaccard ç³»æ•°çš„æ–¹æ³•æœ‰ä¸¤æ–¹é¢å±€é™ã€‚ é¦–å…ˆï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸¤è¿ç®—ï¼Œæˆ‘ä»¬å‡è®¾äº†æ‰€æœ‰å€¼å¾—è¢«è¿ç®—çš„ç‚¹ä¹‹é—´å·²ç»å­˜åœ¨æŸç§ç¡®å®šé“¾æ¥ï¼ˆå¯¹åº” MATCH ç¬¬ä¸€è¡Œï¼‰ï¼Œè™½ç„¶è¿™æ ·çš„å‡è®¾åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥ç²—ç•¥è¢«æ¥å—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ç§å‹ç¼©å’Œå¦¥åã€‚ å…¶æ¬¡ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å½¢é‡Œï¼Œè¿™æ ·çš„æŸ¥è¯¢å°†ä¸å…·æœ‰å¯æ“ä½œæ€§ã€‚ 1.5.3.2.2 æ›´ Scale çš„æ–¹æ³•ä¸ºäº†èƒ½å¤„ç†æ›´å¤§è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spark ç­‰å¹¶è¡Œè®¡ç®—å¹³å°è¿›è¡Œç®—æ³•æ‰§è¡Œï¼› åœ¨å…¨å›¾è¿ç®—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ MinHash æ¥å¯¹ä¸¤ä¸¤æ¯”å¯¹é™ç»´ï¼Œåº†å¹¸çš„æ˜¯ï¼ŒSpark ä¸­æä¾›äº† MinHash çš„å®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ å‚è€ƒï¼š https://aksakalli.github.io/2016/03/01/jaccard-similarity-with-minhash.html https://en.wikipedia.org/wiki/MinHash https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.MinHashLSH.html https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/LSH.scala MinHash çš„æ€æƒ³ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¦‚ç‡å»æœ‰æŸä¼°è®¡ Jaccard ç³»æ•°ï¼Œè¿™é‡Œçš„é™ç»´ä½“ç°åœ¨å®ƒç”¨ bit map å»æ•°å­—åŒ–æ¯ä¸€ä¸ªé›†åˆï¼Œéšæœºå®šä¹‰ä¸åŒçš„é›†åˆä¸Šçš„ shuffleï¼ˆä¹±åºï¼‰å˜æ¢ï¼Œå–å˜æ¢ä¹‹å hash çš„æœ€å°å€¼ã€‚è¿™é‡Œï¼Œä¸¤ä¸ªé›†åˆçš„éšæœºå˜æ¢åæœ€å°å€¼ ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ç­‰äº Jaccard ç³»æ•°çš„ã€‚æ‰€ä»¥ï¼Œè¿™æ ·å·æ¢æ¢æŸ±ï¼Œå°±æŠŠéœ€è¦ä¸¤ä¸¤é›†åˆè¿ç®—æ¯”è¾ƒçš„ç®—æ³•å˜æˆåªéœ€è¦å¯¹æ¯ä¸€ä¸ªé›†åˆåšå¸¸æ•°æ¬¡éšæœºå˜æ¢å–æœ€å°çš„é™ç»´è¿‘ä¼¼è¿ç®—äº†ã€‚ åœ¨å›¾ä¸Šï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒçš„é‚»å±…å°±æ˜¯è¿™ä¸ªç‚¹çš„é›†åˆï¼Œé‚£ä¹ˆåœ¨ Spark ä¸­è¿ç®— Jaccard ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼š è·å–æ¯ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆ å¯¹ç‚¹çš„é‚»å±…è¿›è¡Œ MinHash è¿ç®—ï¼Œè·å¾— Jaccard ç³»æ•° åº†å¹¸çš„æ˜¯ï¼Œå¼€æºçš„ NebulaGraph Algorithm å·²ç»æä¾›äº†è¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—® nebula-algorithm/src/main/scala/com/vesoft/nebula/algorithm/lib/JaccardAlgo.scala äº†è§£å®ƒçš„å®ç°ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ NebulaGraph Algorithm å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹æ³•å‚è€ƒ NebulaGraph Algorithm æ–‡æ¡£ã€‚ æ³¨ï¼Œé…ç½®ä¸­ jaccard.tol çš„æ„æ¶µæ˜¯ approxSimilarityJoin ä¸­çš„ threshold ï¼š def approxSimilarityJoin( datasetA: Dataset[_], datasetB: Dataset[_], threshold: Double, distCol: String): Dataset[_] = { ... // Filter the joined datasets where the distance are smaller than the threshold. joinedDatasetWithDist.filter(col(distCol) \u003c threshold) è¯»è€…åˆ°è¿™é‡Œåº”è¯¥ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯å‡è®¾æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç”¨æˆ·å®ä½“ï¼Œè¾¹æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›´è¿å…³ç³»çš„ã€‚æ‰€ä»¥å†åº”ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç»è¿‡é¢„å¤„ç†çš„ç›´è¿è¾¹ï¼Œè¿™ä¸ªæ­¥éª¤æ­£æ˜¯å‰è¾¹ç« èŠ‚â€œåˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•â€ä¸­çš„å†…å®¹ã€‚ 1.","date":"2022-08-14","objectID":"/identity-resolution/:1:5","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#ç¤¾åŒºå‘ç°ç®—æ³•"},{"categories":["Nebula Graph"],"content":" 1.5 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•å‰è¾¹çš„æ–¹æ³•ä¸­æˆ‘ä»¬ç›´æ¥åˆ©ç”¨äº†ç”¨æˆ·çš„å„é¡¹å±æ€§ã€è¡Œä¸ºäº‹ä»¶ä¸­äº§ç”Ÿçš„å…³ç³»ï¼Œå¹¶åˆ©ç”¨å„ç§å±æ€§ã€å€¼ç›¸ä¼¼åº¦çš„æ–¹æ³•å»ºç«‹äº†åŸºäºæ¦‚ç‡æˆ–è€…å¸¦æœ‰è¯„åˆ†çš„å…³è”å…³ç³»ã€‚è€Œåœ¨é€šè¿‡å…¶ä»–æ–¹æ³•å¢åŠ äº†æ–°çš„è¾¹ä¹‹åçš„å›¾ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å›¾ç®—æ³•çš„æ–¹æ³•æ¥æ˜ å°„æ½œåœ¨çš„ç›¸åŒç”¨æˆ· IDã€‚ 1.5.1 å›¾ç›¸ä¼¼æ€§ç®—æ³•åˆ©ç”¨èŠ‚ç‚¹ç›¸ä¼¼æ€§å›¾ç®—æ³•ï¼Œæ¯”å¦‚ Jaccard Indexã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æˆ–è€… a. åˆ©ç”¨å›¾åº“ä¹‹ä¸Šçš„å›¾è®¡ç®—å¹³å°å…¨é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæˆ–è€… b. ç”¨å›¾æŸ¥è¯¢è¯­å¥å®ç°å…¨å›¾/ç»™å®šçš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ€åç»™ç›¸ä¼¼åº¦ä¸€å®šçš„é˜ˆå€¼æ¥å¸®åŠ©å»ºç«‹æ–°çš„ï¼ˆè€ƒè™‘äº†æ¶‰åŠè¾¹çš„ï¼‰æ˜ å°„å…³ç³»ã€‚ æ³¨ï¼Œè¿™é‡Œçš„ Jaccard index å’Œæˆ‘ä»¬å‰è¾¹æåˆ°çš„æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ç°åœ¨æåŠçš„æ˜¯åº”ç”¨åœ¨å›¾ä¸Šçš„ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿ç‚¹ä½œä¸ºç®—æ³•ä¸­çš„â€œäº¤é›†â€çš„å®ç°ã€‚ 1.5.2 ç¤¾åŒºå‘ç°ç®—æ³•è‡ªç„¶åœ°ï¼Œè¿˜å¯ä»¥ç”¨ç¤¾åŒºå‘ç°çš„ç®—æ³•å…¨å›¾æ‰¾å‡ºç»™å®šçš„åŸºäºè¾¹ä¹‹ä¸‹çš„ç¤¾åŒºåˆ’åˆ†ï¼Œè°ƒè¯•ç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡åˆ’åˆ†ç¤¾åŒºå†…éƒ¨ç‚¹ä¸ºä¼°è®¡çš„ç›¸åŒç”¨æˆ·ã€‚ 1.5.3 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³• 1.5.3.1 åŸºäºå›¾æŸ¥è¯¢çš„ Jaccard å®ç°Jaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆè®¾å¤‡ã€IPã€é‚®ç®±å‰ç¼€ã€åœ°å€ï¼‰ï¼Œè€Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™æ ·çš„ NebulaGraph OpenCypher æŸ¥è¯¢å°±å¯ä»¥ç®—å‡ºè‡³å°‘åŒ…å«ä¸€è·³å…³ç³»çš„ç‚¹å’Œå®ƒç›¸å…³çš„ç‚¹ã€ä»¥åŠ Jaccard Index å€¼ï¼Œè¶Šå¤§ä»£è¡¨å…³è”åº¦è¶Šå¤§ã€‚ MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components)\u003c-[:used_device|logged_in_from|has_email_with_handle|has_address]-(v_end:`user`) WITH v_start, v_end, count(shared_components) AS intersection_size MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH id(v_start) AS v_start, v_end, intersection_size, COLLECT(id(shared_components)) AS set_a MATCH (v_end:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH v_start, id(v_end) AS v_end, intersection_size, set_a, COLLECT(id(shared_components)) AS set_b WITH v_start, v_end, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B RETURN v_start, v_end, intersection_size/size(A_U_B) AS jaccard_index ORDER BY jaccard_index DESC æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼š +-----------+-----------+---------------------+ | v_start | v_end | jaccard_index | +-----------+-----------+---------------------+ | \"user_8\" | \"user_19\" | 1.0 | | \"user_19\" | \"user_8\" | 1.0 | | \"user_20\" | \"user_3\" | 0.6666666666666666 | | \"user_3\" | \"user_20\" | 0.6666666666666666 | | \"user_21\" | \"user_2\" | 0.6 | | \"user_18\" | \"user_17\" | 0.6 | | \"user_17\" | \"user_18\" | 0.6 | | \"user_2\" | \"user_21\" | 0.6 | | \"user_22\" | \"user_9\" | 0.5 | | \"user_9\" | \"user_22\" | 0.5 | | \"user_23\" | \"user_5\" | 0.2 | | \"user_5\" | \"user_23\" | 0.2 | | \"user_21\" | \"user_20\" | 0.16666666666666666 | | \"user_20\" | \"user_21\" | 0.16666666666666666 | +-----------+-----------+---------------------+ user_8 ä¸ user_19 çš„ç³»æ•°æ˜¯æœ€å¤§çš„çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ä¹‹é—´çš„è¿æ¥ï¼Ÿ FIND ALL PATH FROM \"user_8\" TO \"user_19\" OVER * BIDIRECT YIELD path AS p; æœç„¶ï¼Œä»–ä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾ˆå¤§ï¼š 1.5.3.2 åŸºäº NebulaGraph Algorithm å›¾è®¡ç®—å¹³å°çš„ Jaccard æ–¹æ³• 1.5.3.2.1 å‰é¢æ–¹æ³•çš„å±€é™åˆ©ç”¨å›¾æ•°æ®åº“æŸ¥è¯¢è®¡ç®— Jaccard ç³»æ•°çš„æ–¹æ³•æœ‰ä¸¤æ–¹é¢å±€é™ã€‚ é¦–å…ˆï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸¤è¿ç®—ï¼Œæˆ‘ä»¬å‡è®¾äº†æ‰€æœ‰å€¼å¾—è¢«è¿ç®—çš„ç‚¹ä¹‹é—´å·²ç»å­˜åœ¨æŸç§ç¡®å®šé“¾æ¥ï¼ˆå¯¹åº” MATCH ç¬¬ä¸€è¡Œï¼‰ï¼Œè™½ç„¶è¿™æ ·çš„å‡è®¾åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥ç²—ç•¥è¢«æ¥å—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ç§å‹ç¼©å’Œå¦¥åã€‚ å…¶æ¬¡ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å½¢é‡Œï¼Œè¿™æ ·çš„æŸ¥è¯¢å°†ä¸å…·æœ‰å¯æ“ä½œæ€§ã€‚ 1.5.3.2.2 æ›´ Scale çš„æ–¹æ³•ä¸ºäº†èƒ½å¤„ç†æ›´å¤§è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spark ç­‰å¹¶è¡Œè®¡ç®—å¹³å°è¿›è¡Œç®—æ³•æ‰§è¡Œï¼› åœ¨å…¨å›¾è¿ç®—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ MinHash æ¥å¯¹ä¸¤ä¸¤æ¯”å¯¹é™ç»´ï¼Œåº†å¹¸çš„æ˜¯ï¼ŒSpark ä¸­æä¾›äº† MinHash çš„å®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ å‚è€ƒï¼š https://aksakalli.github.io/2016/03/01/jaccard-similarity-with-minhash.html https://en.wikipedia.org/wiki/MinHash https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.MinHashLSH.html https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/LSH.scala MinHash çš„æ€æƒ³ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¦‚ç‡å»æœ‰æŸä¼°è®¡ Jaccard ç³»æ•°ï¼Œè¿™é‡Œçš„é™ç»´ä½“ç°åœ¨å®ƒç”¨ bit map å»æ•°å­—åŒ–æ¯ä¸€ä¸ªé›†åˆï¼Œéšæœºå®šä¹‰ä¸åŒçš„é›†åˆä¸Šçš„ shuffleï¼ˆä¹±åºï¼‰å˜æ¢ï¼Œå–å˜æ¢ä¹‹å hash çš„æœ€å°å€¼ã€‚è¿™é‡Œï¼Œä¸¤ä¸ªé›†åˆçš„éšæœºå˜æ¢åæœ€å°å€¼ ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ç­‰äº Jaccard ç³»æ•°çš„ã€‚æ‰€ä»¥ï¼Œè¿™æ ·å·æ¢æ¢æŸ±ï¼Œå°±æŠŠéœ€è¦ä¸¤ä¸¤é›†åˆè¿ç®—æ¯”è¾ƒçš„ç®—æ³•å˜æˆåªéœ€è¦å¯¹æ¯ä¸€ä¸ªé›†åˆåšå¸¸æ•°æ¬¡éšæœºå˜æ¢å–æœ€å°çš„é™ç»´è¿‘ä¼¼è¿ç®—äº†ã€‚ åœ¨å›¾ä¸Šï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒçš„é‚»å±…å°±æ˜¯è¿™ä¸ªç‚¹çš„é›†åˆï¼Œé‚£ä¹ˆåœ¨ Spark ä¸­è¿ç®— Jaccard ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼š è·å–æ¯ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆ å¯¹ç‚¹çš„é‚»å±…è¿›è¡Œ MinHash è¿ç®—ï¼Œè·å¾— Jaccard ç³»æ•° åº†å¹¸çš„æ˜¯ï¼Œå¼€æºçš„ NebulaGraph Algorithm å·²ç»æä¾›äº†è¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—® nebula-algorithm/src/main/scala/com/vesoft/nebula/algorithm/lib/JaccardAlgo.scala äº†è§£å®ƒçš„å®ç°ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ NebulaGraph Algorithm å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹æ³•å‚è€ƒ NebulaGraph Algorithm æ–‡æ¡£ã€‚ æ³¨ï¼Œé…ç½®ä¸­ jaccard.tol çš„æ„æ¶µæ˜¯ approxSimilarityJoin ä¸­çš„ threshold ï¼š def approxSimilarityJoin( datasetA: Dataset[_], datasetB: Dataset[_], threshold: Double, distCol: String): Dataset[_] = { ... // Filter the joined datasets where the distance are smaller than the threshold. joinedDatasetWithDist.filter(col(distCol) \u003c threshold) è¯»è€…åˆ°è¿™é‡Œåº”è¯¥ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯å‡è®¾æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç”¨æˆ·å®ä½“ï¼Œè¾¹æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›´è¿å…³ç³»çš„ã€‚æ‰€ä»¥å†åº”ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç»è¿‡é¢„å¤„ç†çš„ç›´è¿è¾¹ï¼Œè¿™ä¸ªæ­¥éª¤æ­£æ˜¯å‰è¾¹ç« èŠ‚â€œåˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•â€ä¸­çš„å†…å®¹ã€‚ 1.","date":"2022-08-14","objectID":"/identity-resolution/:1:5","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•-1"},{"categories":["Nebula Graph"],"content":" 1.5 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•å‰è¾¹çš„æ–¹æ³•ä¸­æˆ‘ä»¬ç›´æ¥åˆ©ç”¨äº†ç”¨æˆ·çš„å„é¡¹å±æ€§ã€è¡Œä¸ºäº‹ä»¶ä¸­äº§ç”Ÿçš„å…³ç³»ï¼Œå¹¶åˆ©ç”¨å„ç§å±æ€§ã€å€¼ç›¸ä¼¼åº¦çš„æ–¹æ³•å»ºç«‹äº†åŸºäºæ¦‚ç‡æˆ–è€…å¸¦æœ‰è¯„åˆ†çš„å…³è”å…³ç³»ã€‚è€Œåœ¨é€šè¿‡å…¶ä»–æ–¹æ³•å¢åŠ äº†æ–°çš„è¾¹ä¹‹åçš„å›¾ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å›¾ç®—æ³•çš„æ–¹æ³•æ¥æ˜ å°„æ½œåœ¨çš„ç›¸åŒç”¨æˆ· IDã€‚ 1.5.1 å›¾ç›¸ä¼¼æ€§ç®—æ³•åˆ©ç”¨èŠ‚ç‚¹ç›¸ä¼¼æ€§å›¾ç®—æ³•ï¼Œæ¯”å¦‚ Jaccard Indexã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æˆ–è€… a. åˆ©ç”¨å›¾åº“ä¹‹ä¸Šçš„å›¾è®¡ç®—å¹³å°å…¨é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæˆ–è€… b. ç”¨å›¾æŸ¥è¯¢è¯­å¥å®ç°å…¨å›¾/ç»™å®šçš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ€åç»™ç›¸ä¼¼åº¦ä¸€å®šçš„é˜ˆå€¼æ¥å¸®åŠ©å»ºç«‹æ–°çš„ï¼ˆè€ƒè™‘äº†æ¶‰åŠè¾¹çš„ï¼‰æ˜ å°„å…³ç³»ã€‚ æ³¨ï¼Œè¿™é‡Œçš„ Jaccard index å’Œæˆ‘ä»¬å‰è¾¹æåˆ°çš„æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ç°åœ¨æåŠçš„æ˜¯åº”ç”¨åœ¨å›¾ä¸Šçš„ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿ç‚¹ä½œä¸ºç®—æ³•ä¸­çš„â€œäº¤é›†â€çš„å®ç°ã€‚ 1.5.2 ç¤¾åŒºå‘ç°ç®—æ³•è‡ªç„¶åœ°ï¼Œè¿˜å¯ä»¥ç”¨ç¤¾åŒºå‘ç°çš„ç®—æ³•å…¨å›¾æ‰¾å‡ºç»™å®šçš„åŸºäºè¾¹ä¹‹ä¸‹çš„ç¤¾åŒºåˆ’åˆ†ï¼Œè°ƒè¯•ç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡åˆ’åˆ†ç¤¾åŒºå†…éƒ¨ç‚¹ä¸ºä¼°è®¡çš„ç›¸åŒç”¨æˆ·ã€‚ 1.5.3 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³• 1.5.3.1 åŸºäºå›¾æŸ¥è¯¢çš„ Jaccard å®ç°Jaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆè®¾å¤‡ã€IPã€é‚®ç®±å‰ç¼€ã€åœ°å€ï¼‰ï¼Œè€Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™æ ·çš„ NebulaGraph OpenCypher æŸ¥è¯¢å°±å¯ä»¥ç®—å‡ºè‡³å°‘åŒ…å«ä¸€è·³å…³ç³»çš„ç‚¹å’Œå®ƒç›¸å…³çš„ç‚¹ã€ä»¥åŠ Jaccard Index å€¼ï¼Œè¶Šå¤§ä»£è¡¨å…³è”åº¦è¶Šå¤§ã€‚ MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components)\u003c-[:used_device|logged_in_from|has_email_with_handle|has_address]-(v_end:`user`) WITH v_start, v_end, count(shared_components) AS intersection_size MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH id(v_start) AS v_start, v_end, intersection_size, COLLECT(id(shared_components)) AS set_a MATCH (v_end:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH v_start, id(v_end) AS v_end, intersection_size, set_a, COLLECT(id(shared_components)) AS set_b WITH v_start, v_end, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B RETURN v_start, v_end, intersection_size/size(A_U_B) AS jaccard_index ORDER BY jaccard_index DESC æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼š +-----------+-----------+---------------------+ | v_start | v_end | jaccard_index | +-----------+-----------+---------------------+ | \"user_8\" | \"user_19\" | 1.0 | | \"user_19\" | \"user_8\" | 1.0 | | \"user_20\" | \"user_3\" | 0.6666666666666666 | | \"user_3\" | \"user_20\" | 0.6666666666666666 | | \"user_21\" | \"user_2\" | 0.6 | | \"user_18\" | \"user_17\" | 0.6 | | \"user_17\" | \"user_18\" | 0.6 | | \"user_2\" | \"user_21\" | 0.6 | | \"user_22\" | \"user_9\" | 0.5 | | \"user_9\" | \"user_22\" | 0.5 | | \"user_23\" | \"user_5\" | 0.2 | | \"user_5\" | \"user_23\" | 0.2 | | \"user_21\" | \"user_20\" | 0.16666666666666666 | | \"user_20\" | \"user_21\" | 0.16666666666666666 | +-----------+-----------+---------------------+ user_8 ä¸ user_19 çš„ç³»æ•°æ˜¯æœ€å¤§çš„çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ä¹‹é—´çš„è¿æ¥ï¼Ÿ FIND ALL PATH FROM \"user_8\" TO \"user_19\" OVER * BIDIRECT YIELD path AS p; æœç„¶ï¼Œä»–ä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾ˆå¤§ï¼š 1.5.3.2 åŸºäº NebulaGraph Algorithm å›¾è®¡ç®—å¹³å°çš„ Jaccard æ–¹æ³• 1.5.3.2.1 å‰é¢æ–¹æ³•çš„å±€é™åˆ©ç”¨å›¾æ•°æ®åº“æŸ¥è¯¢è®¡ç®— Jaccard ç³»æ•°çš„æ–¹æ³•æœ‰ä¸¤æ–¹é¢å±€é™ã€‚ é¦–å…ˆï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸¤è¿ç®—ï¼Œæˆ‘ä»¬å‡è®¾äº†æ‰€æœ‰å€¼å¾—è¢«è¿ç®—çš„ç‚¹ä¹‹é—´å·²ç»å­˜åœ¨æŸç§ç¡®å®šé“¾æ¥ï¼ˆå¯¹åº” MATCH ç¬¬ä¸€è¡Œï¼‰ï¼Œè™½ç„¶è¿™æ ·çš„å‡è®¾åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥ç²—ç•¥è¢«æ¥å—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ç§å‹ç¼©å’Œå¦¥åã€‚ å…¶æ¬¡ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å½¢é‡Œï¼Œè¿™æ ·çš„æŸ¥è¯¢å°†ä¸å…·æœ‰å¯æ“ä½œæ€§ã€‚ 1.5.3.2.2 æ›´ Scale çš„æ–¹æ³•ä¸ºäº†èƒ½å¤„ç†æ›´å¤§è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spark ç­‰å¹¶è¡Œè®¡ç®—å¹³å°è¿›è¡Œç®—æ³•æ‰§è¡Œï¼› åœ¨å…¨å›¾è¿ç®—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ MinHash æ¥å¯¹ä¸¤ä¸¤æ¯”å¯¹é™ç»´ï¼Œåº†å¹¸çš„æ˜¯ï¼ŒSpark ä¸­æä¾›äº† MinHash çš„å®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ å‚è€ƒï¼š https://aksakalli.github.io/2016/03/01/jaccard-similarity-with-minhash.html https://en.wikipedia.org/wiki/MinHash https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.MinHashLSH.html https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/LSH.scala MinHash çš„æ€æƒ³ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¦‚ç‡å»æœ‰æŸä¼°è®¡ Jaccard ç³»æ•°ï¼Œè¿™é‡Œçš„é™ç»´ä½“ç°åœ¨å®ƒç”¨ bit map å»æ•°å­—åŒ–æ¯ä¸€ä¸ªé›†åˆï¼Œéšæœºå®šä¹‰ä¸åŒçš„é›†åˆä¸Šçš„ shuffleï¼ˆä¹±åºï¼‰å˜æ¢ï¼Œå–å˜æ¢ä¹‹å hash çš„æœ€å°å€¼ã€‚è¿™é‡Œï¼Œä¸¤ä¸ªé›†åˆçš„éšæœºå˜æ¢åæœ€å°å€¼ ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ç­‰äº Jaccard ç³»æ•°çš„ã€‚æ‰€ä»¥ï¼Œè¿™æ ·å·æ¢æ¢æŸ±ï¼Œå°±æŠŠéœ€è¦ä¸¤ä¸¤é›†åˆè¿ç®—æ¯”è¾ƒçš„ç®—æ³•å˜æˆåªéœ€è¦å¯¹æ¯ä¸€ä¸ªé›†åˆåšå¸¸æ•°æ¬¡éšæœºå˜æ¢å–æœ€å°çš„é™ç»´è¿‘ä¼¼è¿ç®—äº†ã€‚ åœ¨å›¾ä¸Šï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒçš„é‚»å±…å°±æ˜¯è¿™ä¸ªç‚¹çš„é›†åˆï¼Œé‚£ä¹ˆåœ¨ Spark ä¸­è¿ç®— Jaccard ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼š è·å–æ¯ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆ å¯¹ç‚¹çš„é‚»å±…è¿›è¡Œ MinHash è¿ç®—ï¼Œè·å¾— Jaccard ç³»æ•° åº†å¹¸çš„æ˜¯ï¼Œå¼€æºçš„ NebulaGraph Algorithm å·²ç»æä¾›äº†è¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—® nebula-algorithm/src/main/scala/com/vesoft/nebula/algorithm/lib/JaccardAlgo.scala äº†è§£å®ƒçš„å®ç°ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ NebulaGraph Algorithm å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹æ³•å‚è€ƒ NebulaGraph Algorithm æ–‡æ¡£ã€‚ æ³¨ï¼Œé…ç½®ä¸­ jaccard.tol çš„æ„æ¶µæ˜¯ approxSimilarityJoin ä¸­çš„ threshold ï¼š def approxSimilarityJoin( datasetA: Dataset[_], datasetB: Dataset[_], threshold: Double, distCol: String): Dataset[_] = { ... // Filter the joined datasets where the distance are smaller than the threshold. joinedDatasetWithDist.filter(col(distCol) \u003c threshold) è¯»è€…åˆ°è¿™é‡Œåº”è¯¥ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯å‡è®¾æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç”¨æˆ·å®ä½“ï¼Œè¾¹æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›´è¿å…³ç³»çš„ã€‚æ‰€ä»¥å†åº”ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç»è¿‡é¢„å¤„ç†çš„ç›´è¿è¾¹ï¼Œè¿™ä¸ªæ­¥éª¤æ­£æ˜¯å‰è¾¹ç« èŠ‚â€œåˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•â€ä¸­çš„å†…å®¹ã€‚ 1.","date":"2022-08-14","objectID":"/identity-resolution/:1:5","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åŸºäºå›¾æŸ¥è¯¢çš„-jaccard-å®ç°"},{"categories":["Nebula Graph"],"content":" 1.5 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•å‰è¾¹çš„æ–¹æ³•ä¸­æˆ‘ä»¬ç›´æ¥åˆ©ç”¨äº†ç”¨æˆ·çš„å„é¡¹å±æ€§ã€è¡Œä¸ºäº‹ä»¶ä¸­äº§ç”Ÿçš„å…³ç³»ï¼Œå¹¶åˆ©ç”¨å„ç§å±æ€§ã€å€¼ç›¸ä¼¼åº¦çš„æ–¹æ³•å»ºç«‹äº†åŸºäºæ¦‚ç‡æˆ–è€…å¸¦æœ‰è¯„åˆ†çš„å…³è”å…³ç³»ã€‚è€Œåœ¨é€šè¿‡å…¶ä»–æ–¹æ³•å¢åŠ äº†æ–°çš„è¾¹ä¹‹åçš„å›¾ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å›¾ç®—æ³•çš„æ–¹æ³•æ¥æ˜ å°„æ½œåœ¨çš„ç›¸åŒç”¨æˆ· IDã€‚ 1.5.1 å›¾ç›¸ä¼¼æ€§ç®—æ³•åˆ©ç”¨èŠ‚ç‚¹ç›¸ä¼¼æ€§å›¾ç®—æ³•ï¼Œæ¯”å¦‚ Jaccard Indexã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æˆ–è€… a. åˆ©ç”¨å›¾åº“ä¹‹ä¸Šçš„å›¾è®¡ç®—å¹³å°å…¨é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæˆ–è€… b. ç”¨å›¾æŸ¥è¯¢è¯­å¥å®ç°å…¨å›¾/ç»™å®šçš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ€åç»™ç›¸ä¼¼åº¦ä¸€å®šçš„é˜ˆå€¼æ¥å¸®åŠ©å»ºç«‹æ–°çš„ï¼ˆè€ƒè™‘äº†æ¶‰åŠè¾¹çš„ï¼‰æ˜ å°„å…³ç³»ã€‚ æ³¨ï¼Œè¿™é‡Œçš„ Jaccard index å’Œæˆ‘ä»¬å‰è¾¹æåˆ°çš„æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ç°åœ¨æåŠçš„æ˜¯åº”ç”¨åœ¨å›¾ä¸Šçš„ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿ç‚¹ä½œä¸ºç®—æ³•ä¸­çš„â€œäº¤é›†â€çš„å®ç°ã€‚ 1.5.2 ç¤¾åŒºå‘ç°ç®—æ³•è‡ªç„¶åœ°ï¼Œè¿˜å¯ä»¥ç”¨ç¤¾åŒºå‘ç°çš„ç®—æ³•å…¨å›¾æ‰¾å‡ºç»™å®šçš„åŸºäºè¾¹ä¹‹ä¸‹çš„ç¤¾åŒºåˆ’åˆ†ï¼Œè°ƒè¯•ç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡åˆ’åˆ†ç¤¾åŒºå†…éƒ¨ç‚¹ä¸ºä¼°è®¡çš„ç›¸åŒç”¨æˆ·ã€‚ 1.5.3 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³• 1.5.3.1 åŸºäºå›¾æŸ¥è¯¢çš„ Jaccard å®ç°Jaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆè®¾å¤‡ã€IPã€é‚®ç®±å‰ç¼€ã€åœ°å€ï¼‰ï¼Œè€Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™æ ·çš„ NebulaGraph OpenCypher æŸ¥è¯¢å°±å¯ä»¥ç®—å‡ºè‡³å°‘åŒ…å«ä¸€è·³å…³ç³»çš„ç‚¹å’Œå®ƒç›¸å…³çš„ç‚¹ã€ä»¥åŠ Jaccard Index å€¼ï¼Œè¶Šå¤§ä»£è¡¨å…³è”åº¦è¶Šå¤§ã€‚ MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components)\u003c-[:used_device|logged_in_from|has_email_with_handle|has_address]-(v_end:`user`) WITH v_start, v_end, count(shared_components) AS intersection_size MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH id(v_start) AS v_start, v_end, intersection_size, COLLECT(id(shared_components)) AS set_a MATCH (v_end:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH v_start, id(v_end) AS v_end, intersection_size, set_a, COLLECT(id(shared_components)) AS set_b WITH v_start, v_end, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B RETURN v_start, v_end, intersection_size/size(A_U_B) AS jaccard_index ORDER BY jaccard_index DESC æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼š +-----------+-----------+---------------------+ | v_start | v_end | jaccard_index | +-----------+-----------+---------------------+ | \"user_8\" | \"user_19\" | 1.0 | | \"user_19\" | \"user_8\" | 1.0 | | \"user_20\" | \"user_3\" | 0.6666666666666666 | | \"user_3\" | \"user_20\" | 0.6666666666666666 | | \"user_21\" | \"user_2\" | 0.6 | | \"user_18\" | \"user_17\" | 0.6 | | \"user_17\" | \"user_18\" | 0.6 | | \"user_2\" | \"user_21\" | 0.6 | | \"user_22\" | \"user_9\" | 0.5 | | \"user_9\" | \"user_22\" | 0.5 | | \"user_23\" | \"user_5\" | 0.2 | | \"user_5\" | \"user_23\" | 0.2 | | \"user_21\" | \"user_20\" | 0.16666666666666666 | | \"user_20\" | \"user_21\" | 0.16666666666666666 | +-----------+-----------+---------------------+ user_8 ä¸ user_19 çš„ç³»æ•°æ˜¯æœ€å¤§çš„çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ä¹‹é—´çš„è¿æ¥ï¼Ÿ FIND ALL PATH FROM \"user_8\" TO \"user_19\" OVER * BIDIRECT YIELD path AS p; æœç„¶ï¼Œä»–ä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾ˆå¤§ï¼š 1.5.3.2 åŸºäº NebulaGraph Algorithm å›¾è®¡ç®—å¹³å°çš„ Jaccard æ–¹æ³• 1.5.3.2.1 å‰é¢æ–¹æ³•çš„å±€é™åˆ©ç”¨å›¾æ•°æ®åº“æŸ¥è¯¢è®¡ç®— Jaccard ç³»æ•°çš„æ–¹æ³•æœ‰ä¸¤æ–¹é¢å±€é™ã€‚ é¦–å…ˆï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸¤è¿ç®—ï¼Œæˆ‘ä»¬å‡è®¾äº†æ‰€æœ‰å€¼å¾—è¢«è¿ç®—çš„ç‚¹ä¹‹é—´å·²ç»å­˜åœ¨æŸç§ç¡®å®šé“¾æ¥ï¼ˆå¯¹åº” MATCH ç¬¬ä¸€è¡Œï¼‰ï¼Œè™½ç„¶è¿™æ ·çš„å‡è®¾åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥ç²—ç•¥è¢«æ¥å—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ç§å‹ç¼©å’Œå¦¥åã€‚ å…¶æ¬¡ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å½¢é‡Œï¼Œè¿™æ ·çš„æŸ¥è¯¢å°†ä¸å…·æœ‰å¯æ“ä½œæ€§ã€‚ 1.5.3.2.2 æ›´ Scale çš„æ–¹æ³•ä¸ºäº†èƒ½å¤„ç†æ›´å¤§è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spark ç­‰å¹¶è¡Œè®¡ç®—å¹³å°è¿›è¡Œç®—æ³•æ‰§è¡Œï¼› åœ¨å…¨å›¾è¿ç®—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ MinHash æ¥å¯¹ä¸¤ä¸¤æ¯”å¯¹é™ç»´ï¼Œåº†å¹¸çš„æ˜¯ï¼ŒSpark ä¸­æä¾›äº† MinHash çš„å®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ å‚è€ƒï¼š https://aksakalli.github.io/2016/03/01/jaccard-similarity-with-minhash.html https://en.wikipedia.org/wiki/MinHash https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.MinHashLSH.html https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/LSH.scala MinHash çš„æ€æƒ³ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¦‚ç‡å»æœ‰æŸä¼°è®¡ Jaccard ç³»æ•°ï¼Œè¿™é‡Œçš„é™ç»´ä½“ç°åœ¨å®ƒç”¨ bit map å»æ•°å­—åŒ–æ¯ä¸€ä¸ªé›†åˆï¼Œéšæœºå®šä¹‰ä¸åŒçš„é›†åˆä¸Šçš„ shuffleï¼ˆä¹±åºï¼‰å˜æ¢ï¼Œå–å˜æ¢ä¹‹å hash çš„æœ€å°å€¼ã€‚è¿™é‡Œï¼Œä¸¤ä¸ªé›†åˆçš„éšæœºå˜æ¢åæœ€å°å€¼ ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ç­‰äº Jaccard ç³»æ•°çš„ã€‚æ‰€ä»¥ï¼Œè¿™æ ·å·æ¢æ¢æŸ±ï¼Œå°±æŠŠéœ€è¦ä¸¤ä¸¤é›†åˆè¿ç®—æ¯”è¾ƒçš„ç®—æ³•å˜æˆåªéœ€è¦å¯¹æ¯ä¸€ä¸ªé›†åˆåšå¸¸æ•°æ¬¡éšæœºå˜æ¢å–æœ€å°çš„é™ç»´è¿‘ä¼¼è¿ç®—äº†ã€‚ åœ¨å›¾ä¸Šï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒçš„é‚»å±…å°±æ˜¯è¿™ä¸ªç‚¹çš„é›†åˆï¼Œé‚£ä¹ˆåœ¨ Spark ä¸­è¿ç®— Jaccard ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼š è·å–æ¯ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆ å¯¹ç‚¹çš„é‚»å±…è¿›è¡Œ MinHash è¿ç®—ï¼Œè·å¾— Jaccard ç³»æ•° åº†å¹¸çš„æ˜¯ï¼Œå¼€æºçš„ NebulaGraph Algorithm å·²ç»æä¾›äº†è¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—® nebula-algorithm/src/main/scala/com/vesoft/nebula/algorithm/lib/JaccardAlgo.scala äº†è§£å®ƒçš„å®ç°ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ NebulaGraph Algorithm å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹æ³•å‚è€ƒ NebulaGraph Algorithm æ–‡æ¡£ã€‚ æ³¨ï¼Œé…ç½®ä¸­ jaccard.tol çš„æ„æ¶µæ˜¯ approxSimilarityJoin ä¸­çš„ threshold ï¼š def approxSimilarityJoin( datasetA: Dataset[_], datasetB: Dataset[_], threshold: Double, distCol: String): Dataset[_] = { ... // Filter the joined datasets where the distance are smaller than the threshold. joinedDatasetWithDist.filter(col(distCol) \u003c threshold) è¯»è€…åˆ°è¿™é‡Œåº”è¯¥ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯å‡è®¾æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç”¨æˆ·å®ä½“ï¼Œè¾¹æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›´è¿å…³ç³»çš„ã€‚æ‰€ä»¥å†åº”ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç»è¿‡é¢„å¤„ç†çš„ç›´è¿è¾¹ï¼Œè¿™ä¸ªæ­¥éª¤æ­£æ˜¯å‰è¾¹ç« èŠ‚â€œåˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•â€ä¸­çš„å†…å®¹ã€‚ 1.","date":"2022-08-14","objectID":"/identity-resolution/:1:5","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åŸºäº-nebulagraph-algorithm-å›¾è®¡ç®—å¹³å°çš„-jaccard-æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.5 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•å‰è¾¹çš„æ–¹æ³•ä¸­æˆ‘ä»¬ç›´æ¥åˆ©ç”¨äº†ç”¨æˆ·çš„å„é¡¹å±æ€§ã€è¡Œä¸ºäº‹ä»¶ä¸­äº§ç”Ÿçš„å…³ç³»ï¼Œå¹¶åˆ©ç”¨å„ç§å±æ€§ã€å€¼ç›¸ä¼¼åº¦çš„æ–¹æ³•å»ºç«‹äº†åŸºäºæ¦‚ç‡æˆ–è€…å¸¦æœ‰è¯„åˆ†çš„å…³è”å…³ç³»ã€‚è€Œåœ¨é€šè¿‡å…¶ä»–æ–¹æ³•å¢åŠ äº†æ–°çš„è¾¹ä¹‹åçš„å›¾ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å›¾ç®—æ³•çš„æ–¹æ³•æ¥æ˜ å°„æ½œåœ¨çš„ç›¸åŒç”¨æˆ· IDã€‚ 1.5.1 å›¾ç›¸ä¼¼æ€§ç®—æ³•åˆ©ç”¨èŠ‚ç‚¹ç›¸ä¼¼æ€§å›¾ç®—æ³•ï¼Œæ¯”å¦‚ Jaccard Indexã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æˆ–è€… a. åˆ©ç”¨å›¾åº“ä¹‹ä¸Šçš„å›¾è®¡ç®—å¹³å°å…¨é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæˆ–è€… b. ç”¨å›¾æŸ¥è¯¢è¯­å¥å®ç°å…¨å›¾/ç»™å®šçš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ€åç»™ç›¸ä¼¼åº¦ä¸€å®šçš„é˜ˆå€¼æ¥å¸®åŠ©å»ºç«‹æ–°çš„ï¼ˆè€ƒè™‘äº†æ¶‰åŠè¾¹çš„ï¼‰æ˜ å°„å…³ç³»ã€‚ æ³¨ï¼Œè¿™é‡Œçš„ Jaccard index å’Œæˆ‘ä»¬å‰è¾¹æåˆ°çš„æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ç°åœ¨æåŠçš„æ˜¯åº”ç”¨åœ¨å›¾ä¸Šçš„ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿ç‚¹ä½œä¸ºç®—æ³•ä¸­çš„â€œäº¤é›†â€çš„å®ç°ã€‚ 1.5.2 ç¤¾åŒºå‘ç°ç®—æ³•è‡ªç„¶åœ°ï¼Œè¿˜å¯ä»¥ç”¨ç¤¾åŒºå‘ç°çš„ç®—æ³•å…¨å›¾æ‰¾å‡ºç»™å®šçš„åŸºäºè¾¹ä¹‹ä¸‹çš„ç¤¾åŒºåˆ’åˆ†ï¼Œè°ƒè¯•ç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡åˆ’åˆ†ç¤¾åŒºå†…éƒ¨ç‚¹ä¸ºä¼°è®¡çš„ç›¸åŒç”¨æˆ·ã€‚ 1.5.3 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³• 1.5.3.1 åŸºäºå›¾æŸ¥è¯¢çš„ Jaccard å®ç°Jaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆè®¾å¤‡ã€IPã€é‚®ç®±å‰ç¼€ã€åœ°å€ï¼‰ï¼Œè€Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™æ ·çš„ NebulaGraph OpenCypher æŸ¥è¯¢å°±å¯ä»¥ç®—å‡ºè‡³å°‘åŒ…å«ä¸€è·³å…³ç³»çš„ç‚¹å’Œå®ƒç›¸å…³çš„ç‚¹ã€ä»¥åŠ Jaccard Index å€¼ï¼Œè¶Šå¤§ä»£è¡¨å…³è”åº¦è¶Šå¤§ã€‚ MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components)\u003c-[:used_device|logged_in_from|has_email_with_handle|has_address]-(v_end:`user`) WITH v_start, v_end, count(shared_components) AS intersection_size MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH id(v_start) AS v_start, v_end, intersection_size, COLLECT(id(shared_components)) AS set_a MATCH (v_end:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH v_start, id(v_end) AS v_end, intersection_size, set_a, COLLECT(id(shared_components)) AS set_b WITH v_start, v_end, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B RETURN v_start, v_end, intersection_size/size(A_U_B) AS jaccard_index ORDER BY jaccard_index DESC æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼š +-----------+-----------+---------------------+ | v_start | v_end | jaccard_index | +-----------+-----------+---------------------+ | \"user_8\" | \"user_19\" | 1.0 | | \"user_19\" | \"user_8\" | 1.0 | | \"user_20\" | \"user_3\" | 0.6666666666666666 | | \"user_3\" | \"user_20\" | 0.6666666666666666 | | \"user_21\" | \"user_2\" | 0.6 | | \"user_18\" | \"user_17\" | 0.6 | | \"user_17\" | \"user_18\" | 0.6 | | \"user_2\" | \"user_21\" | 0.6 | | \"user_22\" | \"user_9\" | 0.5 | | \"user_9\" | \"user_22\" | 0.5 | | \"user_23\" | \"user_5\" | 0.2 | | \"user_5\" | \"user_23\" | 0.2 | | \"user_21\" | \"user_20\" | 0.16666666666666666 | | \"user_20\" | \"user_21\" | 0.16666666666666666 | +-----------+-----------+---------------------+ user_8 ä¸ user_19 çš„ç³»æ•°æ˜¯æœ€å¤§çš„çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ä¹‹é—´çš„è¿æ¥ï¼Ÿ FIND ALL PATH FROM \"user_8\" TO \"user_19\" OVER * BIDIRECT YIELD path AS p; æœç„¶ï¼Œä»–ä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾ˆå¤§ï¼š 1.5.3.2 åŸºäº NebulaGraph Algorithm å›¾è®¡ç®—å¹³å°çš„ Jaccard æ–¹æ³• 1.5.3.2.1 å‰é¢æ–¹æ³•çš„å±€é™åˆ©ç”¨å›¾æ•°æ®åº“æŸ¥è¯¢è®¡ç®— Jaccard ç³»æ•°çš„æ–¹æ³•æœ‰ä¸¤æ–¹é¢å±€é™ã€‚ é¦–å…ˆï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸¤è¿ç®—ï¼Œæˆ‘ä»¬å‡è®¾äº†æ‰€æœ‰å€¼å¾—è¢«è¿ç®—çš„ç‚¹ä¹‹é—´å·²ç»å­˜åœ¨æŸç§ç¡®å®šé“¾æ¥ï¼ˆå¯¹åº” MATCH ç¬¬ä¸€è¡Œï¼‰ï¼Œè™½ç„¶è¿™æ ·çš„å‡è®¾åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥ç²—ç•¥è¢«æ¥å—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ç§å‹ç¼©å’Œå¦¥åã€‚ å…¶æ¬¡ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å½¢é‡Œï¼Œè¿™æ ·çš„æŸ¥è¯¢å°†ä¸å…·æœ‰å¯æ“ä½œæ€§ã€‚ 1.5.3.2.2 æ›´ Scale çš„æ–¹æ³•ä¸ºäº†èƒ½å¤„ç†æ›´å¤§è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spark ç­‰å¹¶è¡Œè®¡ç®—å¹³å°è¿›è¡Œç®—æ³•æ‰§è¡Œï¼› åœ¨å…¨å›¾è¿ç®—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ MinHash æ¥å¯¹ä¸¤ä¸¤æ¯”å¯¹é™ç»´ï¼Œåº†å¹¸çš„æ˜¯ï¼ŒSpark ä¸­æä¾›äº† MinHash çš„å®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ å‚è€ƒï¼š https://aksakalli.github.io/2016/03/01/jaccard-similarity-with-minhash.html https://en.wikipedia.org/wiki/MinHash https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.MinHashLSH.html https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/LSH.scala MinHash çš„æ€æƒ³ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¦‚ç‡å»æœ‰æŸä¼°è®¡ Jaccard ç³»æ•°ï¼Œè¿™é‡Œçš„é™ç»´ä½“ç°åœ¨å®ƒç”¨ bit map å»æ•°å­—åŒ–æ¯ä¸€ä¸ªé›†åˆï¼Œéšæœºå®šä¹‰ä¸åŒçš„é›†åˆä¸Šçš„ shuffleï¼ˆä¹±åºï¼‰å˜æ¢ï¼Œå–å˜æ¢ä¹‹å hash çš„æœ€å°å€¼ã€‚è¿™é‡Œï¼Œä¸¤ä¸ªé›†åˆçš„éšæœºå˜æ¢åæœ€å°å€¼ ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ç­‰äº Jaccard ç³»æ•°çš„ã€‚æ‰€ä»¥ï¼Œè¿™æ ·å·æ¢æ¢æŸ±ï¼Œå°±æŠŠéœ€è¦ä¸¤ä¸¤é›†åˆè¿ç®—æ¯”è¾ƒçš„ç®—æ³•å˜æˆåªéœ€è¦å¯¹æ¯ä¸€ä¸ªé›†åˆåšå¸¸æ•°æ¬¡éšæœºå˜æ¢å–æœ€å°çš„é™ç»´è¿‘ä¼¼è¿ç®—äº†ã€‚ åœ¨å›¾ä¸Šï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒçš„é‚»å±…å°±æ˜¯è¿™ä¸ªç‚¹çš„é›†åˆï¼Œé‚£ä¹ˆåœ¨ Spark ä¸­è¿ç®— Jaccard ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼š è·å–æ¯ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆ å¯¹ç‚¹çš„é‚»å±…è¿›è¡Œ MinHash è¿ç®—ï¼Œè·å¾— Jaccard ç³»æ•° åº†å¹¸çš„æ˜¯ï¼Œå¼€æºçš„ NebulaGraph Algorithm å·²ç»æä¾›äº†è¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—® nebula-algorithm/src/main/scala/com/vesoft/nebula/algorithm/lib/JaccardAlgo.scala äº†è§£å®ƒçš„å®ç°ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ NebulaGraph Algorithm å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹æ³•å‚è€ƒ NebulaGraph Algorithm æ–‡æ¡£ã€‚ æ³¨ï¼Œé…ç½®ä¸­ jaccard.tol çš„æ„æ¶µæ˜¯ approxSimilarityJoin ä¸­çš„ threshold ï¼š def approxSimilarityJoin( datasetA: Dataset[_], datasetB: Dataset[_], threshold: Double, distCol: String): Dataset[_] = { ... // Filter the joined datasets where the distance are smaller than the threshold. joinedDatasetWithDist.filter(col(distCol) \u003c threshold) è¯»è€…åˆ°è¿™é‡Œåº”è¯¥ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯å‡è®¾æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç”¨æˆ·å®ä½“ï¼Œè¾¹æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›´è¿å…³ç³»çš„ã€‚æ‰€ä»¥å†åº”ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç»è¿‡é¢„å¤„ç†çš„ç›´è¿è¾¹ï¼Œè¿™ä¸ªæ­¥éª¤æ­£æ˜¯å‰è¾¹ç« èŠ‚â€œåˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•â€ä¸­çš„å†…å®¹ã€‚ 1.","date":"2022-08-14","objectID":"/identity-resolution/:1:5","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#å‰é¢æ–¹æ³•çš„å±€é™"},{"categories":["Nebula Graph"],"content":" 1.5 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•å‰è¾¹çš„æ–¹æ³•ä¸­æˆ‘ä»¬ç›´æ¥åˆ©ç”¨äº†ç”¨æˆ·çš„å„é¡¹å±æ€§ã€è¡Œä¸ºäº‹ä»¶ä¸­äº§ç”Ÿçš„å…³ç³»ï¼Œå¹¶åˆ©ç”¨å„ç§å±æ€§ã€å€¼ç›¸ä¼¼åº¦çš„æ–¹æ³•å»ºç«‹äº†åŸºäºæ¦‚ç‡æˆ–è€…å¸¦æœ‰è¯„åˆ†çš„å…³è”å…³ç³»ã€‚è€Œåœ¨é€šè¿‡å…¶ä»–æ–¹æ³•å¢åŠ äº†æ–°çš„è¾¹ä¹‹åçš„å›¾ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å›¾ç®—æ³•çš„æ–¹æ³•æ¥æ˜ å°„æ½œåœ¨çš„ç›¸åŒç”¨æˆ· IDã€‚ 1.5.1 å›¾ç›¸ä¼¼æ€§ç®—æ³•åˆ©ç”¨èŠ‚ç‚¹ç›¸ä¼¼æ€§å›¾ç®—æ³•ï¼Œæ¯”å¦‚ Jaccard Indexã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æˆ–è€… a. åˆ©ç”¨å›¾åº“ä¹‹ä¸Šçš„å›¾è®¡ç®—å¹³å°å…¨é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæˆ–è€… b. ç”¨å›¾æŸ¥è¯¢è¯­å¥å®ç°å…¨å›¾/ç»™å®šçš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ€åç»™ç›¸ä¼¼åº¦ä¸€å®šçš„é˜ˆå€¼æ¥å¸®åŠ©å»ºç«‹æ–°çš„ï¼ˆè€ƒè™‘äº†æ¶‰åŠè¾¹çš„ï¼‰æ˜ å°„å…³ç³»ã€‚ æ³¨ï¼Œè¿™é‡Œçš„ Jaccard index å’Œæˆ‘ä»¬å‰è¾¹æåˆ°çš„æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ç°åœ¨æåŠçš„æ˜¯åº”ç”¨åœ¨å›¾ä¸Šçš„ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿ç‚¹ä½œä¸ºç®—æ³•ä¸­çš„â€œäº¤é›†â€çš„å®ç°ã€‚ 1.5.2 ç¤¾åŒºå‘ç°ç®—æ³•è‡ªç„¶åœ°ï¼Œè¿˜å¯ä»¥ç”¨ç¤¾åŒºå‘ç°çš„ç®—æ³•å…¨å›¾æ‰¾å‡ºç»™å®šçš„åŸºäºè¾¹ä¹‹ä¸‹çš„ç¤¾åŒºåˆ’åˆ†ï¼Œè°ƒè¯•ç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡åˆ’åˆ†ç¤¾åŒºå†…éƒ¨ç‚¹ä¸ºä¼°è®¡çš„ç›¸åŒç”¨æˆ·ã€‚ 1.5.3 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³• 1.5.3.1 åŸºäºå›¾æŸ¥è¯¢çš„ Jaccard å®ç°Jaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆè®¾å¤‡ã€IPã€é‚®ç®±å‰ç¼€ã€åœ°å€ï¼‰ï¼Œè€Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™æ ·çš„ NebulaGraph OpenCypher æŸ¥è¯¢å°±å¯ä»¥ç®—å‡ºè‡³å°‘åŒ…å«ä¸€è·³å…³ç³»çš„ç‚¹å’Œå®ƒç›¸å…³çš„ç‚¹ã€ä»¥åŠ Jaccard Index å€¼ï¼Œè¶Šå¤§ä»£è¡¨å…³è”åº¦è¶Šå¤§ã€‚ MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components)\u003c-[:used_device|logged_in_from|has_email_with_handle|has_address]-(v_end:`user`) WITH v_start, v_end, count(shared_components) AS intersection_size MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH id(v_start) AS v_start, v_end, intersection_size, COLLECT(id(shared_components)) AS set_a MATCH (v_end:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH v_start, id(v_end) AS v_end, intersection_size, set_a, COLLECT(id(shared_components)) AS set_b WITH v_start, v_end, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B RETURN v_start, v_end, intersection_size/size(A_U_B) AS jaccard_index ORDER BY jaccard_index DESC æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼š +-----------+-----------+---------------------+ | v_start | v_end | jaccard_index | +-----------+-----------+---------------------+ | \"user_8\" | \"user_19\" | 1.0 | | \"user_19\" | \"user_8\" | 1.0 | | \"user_20\" | \"user_3\" | 0.6666666666666666 | | \"user_3\" | \"user_20\" | 0.6666666666666666 | | \"user_21\" | \"user_2\" | 0.6 | | \"user_18\" | \"user_17\" | 0.6 | | \"user_17\" | \"user_18\" | 0.6 | | \"user_2\" | \"user_21\" | 0.6 | | \"user_22\" | \"user_9\" | 0.5 | | \"user_9\" | \"user_22\" | 0.5 | | \"user_23\" | \"user_5\" | 0.2 | | \"user_5\" | \"user_23\" | 0.2 | | \"user_21\" | \"user_20\" | 0.16666666666666666 | | \"user_20\" | \"user_21\" | 0.16666666666666666 | +-----------+-----------+---------------------+ user_8 ä¸ user_19 çš„ç³»æ•°æ˜¯æœ€å¤§çš„çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ä¹‹é—´çš„è¿æ¥ï¼Ÿ FIND ALL PATH FROM \"user_8\" TO \"user_19\" OVER * BIDIRECT YIELD path AS p; æœç„¶ï¼Œä»–ä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾ˆå¤§ï¼š 1.5.3.2 åŸºäº NebulaGraph Algorithm å›¾è®¡ç®—å¹³å°çš„ Jaccard æ–¹æ³• 1.5.3.2.1 å‰é¢æ–¹æ³•çš„å±€é™åˆ©ç”¨å›¾æ•°æ®åº“æŸ¥è¯¢è®¡ç®— Jaccard ç³»æ•°çš„æ–¹æ³•æœ‰ä¸¤æ–¹é¢å±€é™ã€‚ é¦–å…ˆï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸¤è¿ç®—ï¼Œæˆ‘ä»¬å‡è®¾äº†æ‰€æœ‰å€¼å¾—è¢«è¿ç®—çš„ç‚¹ä¹‹é—´å·²ç»å­˜åœ¨æŸç§ç¡®å®šé“¾æ¥ï¼ˆå¯¹åº” MATCH ç¬¬ä¸€è¡Œï¼‰ï¼Œè™½ç„¶è¿™æ ·çš„å‡è®¾åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥ç²—ç•¥è¢«æ¥å—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ç§å‹ç¼©å’Œå¦¥åã€‚ å…¶æ¬¡ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å½¢é‡Œï¼Œè¿™æ ·çš„æŸ¥è¯¢å°†ä¸å…·æœ‰å¯æ“ä½œæ€§ã€‚ 1.5.3.2.2 æ›´ Scale çš„æ–¹æ³•ä¸ºäº†èƒ½å¤„ç†æ›´å¤§è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spark ç­‰å¹¶è¡Œè®¡ç®—å¹³å°è¿›è¡Œç®—æ³•æ‰§è¡Œï¼› åœ¨å…¨å›¾è¿ç®—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ MinHash æ¥å¯¹ä¸¤ä¸¤æ¯”å¯¹é™ç»´ï¼Œåº†å¹¸çš„æ˜¯ï¼ŒSpark ä¸­æä¾›äº† MinHash çš„å®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ å‚è€ƒï¼š https://aksakalli.github.io/2016/03/01/jaccard-similarity-with-minhash.html https://en.wikipedia.org/wiki/MinHash https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.MinHashLSH.html https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/LSH.scala MinHash çš„æ€æƒ³ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¦‚ç‡å»æœ‰æŸä¼°è®¡ Jaccard ç³»æ•°ï¼Œè¿™é‡Œçš„é™ç»´ä½“ç°åœ¨å®ƒç”¨ bit map å»æ•°å­—åŒ–æ¯ä¸€ä¸ªé›†åˆï¼Œéšæœºå®šä¹‰ä¸åŒçš„é›†åˆä¸Šçš„ shuffleï¼ˆä¹±åºï¼‰å˜æ¢ï¼Œå–å˜æ¢ä¹‹å hash çš„æœ€å°å€¼ã€‚è¿™é‡Œï¼Œä¸¤ä¸ªé›†åˆçš„éšæœºå˜æ¢åæœ€å°å€¼ ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ç­‰äº Jaccard ç³»æ•°çš„ã€‚æ‰€ä»¥ï¼Œè¿™æ ·å·æ¢æ¢æŸ±ï¼Œå°±æŠŠéœ€è¦ä¸¤ä¸¤é›†åˆè¿ç®—æ¯”è¾ƒçš„ç®—æ³•å˜æˆåªéœ€è¦å¯¹æ¯ä¸€ä¸ªé›†åˆåšå¸¸æ•°æ¬¡éšæœºå˜æ¢å–æœ€å°çš„é™ç»´è¿‘ä¼¼è¿ç®—äº†ã€‚ åœ¨å›¾ä¸Šï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒçš„é‚»å±…å°±æ˜¯è¿™ä¸ªç‚¹çš„é›†åˆï¼Œé‚£ä¹ˆåœ¨ Spark ä¸­è¿ç®— Jaccard ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼š è·å–æ¯ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆ å¯¹ç‚¹çš„é‚»å±…è¿›è¡Œ MinHash è¿ç®—ï¼Œè·å¾— Jaccard ç³»æ•° åº†å¹¸çš„æ˜¯ï¼Œå¼€æºçš„ NebulaGraph Algorithm å·²ç»æä¾›äº†è¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—® nebula-algorithm/src/main/scala/com/vesoft/nebula/algorithm/lib/JaccardAlgo.scala äº†è§£å®ƒçš„å®ç°ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ NebulaGraph Algorithm å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹æ³•å‚è€ƒ NebulaGraph Algorithm æ–‡æ¡£ã€‚ æ³¨ï¼Œé…ç½®ä¸­ jaccard.tol çš„æ„æ¶µæ˜¯ approxSimilarityJoin ä¸­çš„ threshold ï¼š def approxSimilarityJoin( datasetA: Dataset[_], datasetB: Dataset[_], threshold: Double, distCol: String): Dataset[_] = { ... // Filter the joined datasets where the distance are smaller than the threshold. joinedDatasetWithDist.filter(col(distCol) \u003c threshold) è¯»è€…åˆ°è¿™é‡Œåº”è¯¥ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯å‡è®¾æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç”¨æˆ·å®ä½“ï¼Œè¾¹æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›´è¿å…³ç³»çš„ã€‚æ‰€ä»¥å†åº”ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç»è¿‡é¢„å¤„ç†çš„ç›´è¿è¾¹ï¼Œè¿™ä¸ªæ­¥éª¤æ­£æ˜¯å‰è¾¹ç« èŠ‚â€œåˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•â€ä¸­çš„å†…å®¹ã€‚ 1.","date":"2022-08-14","objectID":"/identity-resolution/:1:5","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#æ›´-scale-çš„æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.5 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•å‰è¾¹çš„æ–¹æ³•ä¸­æˆ‘ä»¬ç›´æ¥åˆ©ç”¨äº†ç”¨æˆ·çš„å„é¡¹å±æ€§ã€è¡Œä¸ºäº‹ä»¶ä¸­äº§ç”Ÿçš„å…³ç³»ï¼Œå¹¶åˆ©ç”¨å„ç§å±æ€§ã€å€¼ç›¸ä¼¼åº¦çš„æ–¹æ³•å»ºç«‹äº†åŸºäºæ¦‚ç‡æˆ–è€…å¸¦æœ‰è¯„åˆ†çš„å…³è”å…³ç³»ã€‚è€Œåœ¨é€šè¿‡å…¶ä»–æ–¹æ³•å¢åŠ äº†æ–°çš„è¾¹ä¹‹åçš„å›¾ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å›¾ç®—æ³•çš„æ–¹æ³•æ¥æ˜ å°„æ½œåœ¨çš„ç›¸åŒç”¨æˆ· IDã€‚ 1.5.1 å›¾ç›¸ä¼¼æ€§ç®—æ³•åˆ©ç”¨èŠ‚ç‚¹ç›¸ä¼¼æ€§å›¾ç®—æ³•ï¼Œæ¯”å¦‚ Jaccard Indexã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æˆ–è€… a. åˆ©ç”¨å›¾åº“ä¹‹ä¸Šçš„å›¾è®¡ç®—å¹³å°å…¨é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæˆ–è€… b. ç”¨å›¾æŸ¥è¯¢è¯­å¥å®ç°å…¨å›¾/ç»™å®šçš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ€åç»™ç›¸ä¼¼åº¦ä¸€å®šçš„é˜ˆå€¼æ¥å¸®åŠ©å»ºç«‹æ–°çš„ï¼ˆè€ƒè™‘äº†æ¶‰åŠè¾¹çš„ï¼‰æ˜ å°„å…³ç³»ã€‚ æ³¨ï¼Œè¿™é‡Œçš„ Jaccard index å’Œæˆ‘ä»¬å‰è¾¹æåˆ°çš„æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ç°åœ¨æåŠçš„æ˜¯åº”ç”¨åœ¨å›¾ä¸Šçš„ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿ç‚¹ä½œä¸ºç®—æ³•ä¸­çš„â€œäº¤é›†â€çš„å®ç°ã€‚ 1.5.2 ç¤¾åŒºå‘ç°ç®—æ³•è‡ªç„¶åœ°ï¼Œè¿˜å¯ä»¥ç”¨ç¤¾åŒºå‘ç°çš„ç®—æ³•å…¨å›¾æ‰¾å‡ºç»™å®šçš„åŸºäºè¾¹ä¹‹ä¸‹çš„ç¤¾åŒºåˆ’åˆ†ï¼Œè°ƒè¯•ç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡åˆ’åˆ†ç¤¾åŒºå†…éƒ¨ç‚¹ä¸ºä¼°è®¡çš„ç›¸åŒç”¨æˆ·ã€‚ 1.5.3 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³• 1.5.3.1 åŸºäºå›¾æŸ¥è¯¢çš„ Jaccard å®ç°Jaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆè®¾å¤‡ã€IPã€é‚®ç®±å‰ç¼€ã€åœ°å€ï¼‰ï¼Œè€Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™æ ·çš„ NebulaGraph OpenCypher æŸ¥è¯¢å°±å¯ä»¥ç®—å‡ºè‡³å°‘åŒ…å«ä¸€è·³å…³ç³»çš„ç‚¹å’Œå®ƒç›¸å…³çš„ç‚¹ã€ä»¥åŠ Jaccard Index å€¼ï¼Œè¶Šå¤§ä»£è¡¨å…³è”åº¦è¶Šå¤§ã€‚ MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components)\u003c-[:used_device|logged_in_from|has_email_with_handle|has_address]-(v_end:`user`) WITH v_start, v_end, count(shared_components) AS intersection_size MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH id(v_start) AS v_start, v_end, intersection_size, COLLECT(id(shared_components)) AS set_a MATCH (v_end:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH v_start, id(v_end) AS v_end, intersection_size, set_a, COLLECT(id(shared_components)) AS set_b WITH v_start, v_end, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B RETURN v_start, v_end, intersection_size/size(A_U_B) AS jaccard_index ORDER BY jaccard_index DESC æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼š +-----------+-----------+---------------------+ | v_start | v_end | jaccard_index | +-----------+-----------+---------------------+ | \"user_8\" | \"user_19\" | 1.0 | | \"user_19\" | \"user_8\" | 1.0 | | \"user_20\" | \"user_3\" | 0.6666666666666666 | | \"user_3\" | \"user_20\" | 0.6666666666666666 | | \"user_21\" | \"user_2\" | 0.6 | | \"user_18\" | \"user_17\" | 0.6 | | \"user_17\" | \"user_18\" | 0.6 | | \"user_2\" | \"user_21\" | 0.6 | | \"user_22\" | \"user_9\" | 0.5 | | \"user_9\" | \"user_22\" | 0.5 | | \"user_23\" | \"user_5\" | 0.2 | | \"user_5\" | \"user_23\" | 0.2 | | \"user_21\" | \"user_20\" | 0.16666666666666666 | | \"user_20\" | \"user_21\" | 0.16666666666666666 | +-----------+-----------+---------------------+ user_8 ä¸ user_19 çš„ç³»æ•°æ˜¯æœ€å¤§çš„çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ä¹‹é—´çš„è¿æ¥ï¼Ÿ FIND ALL PATH FROM \"user_8\" TO \"user_19\" OVER * BIDIRECT YIELD path AS p; æœç„¶ï¼Œä»–ä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾ˆå¤§ï¼š 1.5.3.2 åŸºäº NebulaGraph Algorithm å›¾è®¡ç®—å¹³å°çš„ Jaccard æ–¹æ³• 1.5.3.2.1 å‰é¢æ–¹æ³•çš„å±€é™åˆ©ç”¨å›¾æ•°æ®åº“æŸ¥è¯¢è®¡ç®— Jaccard ç³»æ•°çš„æ–¹æ³•æœ‰ä¸¤æ–¹é¢å±€é™ã€‚ é¦–å…ˆï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸¤è¿ç®—ï¼Œæˆ‘ä»¬å‡è®¾äº†æ‰€æœ‰å€¼å¾—è¢«è¿ç®—çš„ç‚¹ä¹‹é—´å·²ç»å­˜åœ¨æŸç§ç¡®å®šé“¾æ¥ï¼ˆå¯¹åº” MATCH ç¬¬ä¸€è¡Œï¼‰ï¼Œè™½ç„¶è¿™æ ·çš„å‡è®¾åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥ç²—ç•¥è¢«æ¥å—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ç§å‹ç¼©å’Œå¦¥åã€‚ å…¶æ¬¡ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å½¢é‡Œï¼Œè¿™æ ·çš„æŸ¥è¯¢å°†ä¸å…·æœ‰å¯æ“ä½œæ€§ã€‚ 1.5.3.2.2 æ›´ Scale çš„æ–¹æ³•ä¸ºäº†èƒ½å¤„ç†æ›´å¤§è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spark ç­‰å¹¶è¡Œè®¡ç®—å¹³å°è¿›è¡Œç®—æ³•æ‰§è¡Œï¼› åœ¨å…¨å›¾è¿ç®—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ MinHash æ¥å¯¹ä¸¤ä¸¤æ¯”å¯¹é™ç»´ï¼Œåº†å¹¸çš„æ˜¯ï¼ŒSpark ä¸­æä¾›äº† MinHash çš„å®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ å‚è€ƒï¼š https://aksakalli.github.io/2016/03/01/jaccard-similarity-with-minhash.html https://en.wikipedia.org/wiki/MinHash https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.MinHashLSH.html https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/LSH.scala MinHash çš„æ€æƒ³ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¦‚ç‡å»æœ‰æŸä¼°è®¡ Jaccard ç³»æ•°ï¼Œè¿™é‡Œçš„é™ç»´ä½“ç°åœ¨å®ƒç”¨ bit map å»æ•°å­—åŒ–æ¯ä¸€ä¸ªé›†åˆï¼Œéšæœºå®šä¹‰ä¸åŒçš„é›†åˆä¸Šçš„ shuffleï¼ˆä¹±åºï¼‰å˜æ¢ï¼Œå–å˜æ¢ä¹‹å hash çš„æœ€å°å€¼ã€‚è¿™é‡Œï¼Œä¸¤ä¸ªé›†åˆçš„éšæœºå˜æ¢åæœ€å°å€¼ ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ç­‰äº Jaccard ç³»æ•°çš„ã€‚æ‰€ä»¥ï¼Œè¿™æ ·å·æ¢æ¢æŸ±ï¼Œå°±æŠŠéœ€è¦ä¸¤ä¸¤é›†åˆè¿ç®—æ¯”è¾ƒçš„ç®—æ³•å˜æˆåªéœ€è¦å¯¹æ¯ä¸€ä¸ªé›†åˆåšå¸¸æ•°æ¬¡éšæœºå˜æ¢å–æœ€å°çš„é™ç»´è¿‘ä¼¼è¿ç®—äº†ã€‚ åœ¨å›¾ä¸Šï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒçš„é‚»å±…å°±æ˜¯è¿™ä¸ªç‚¹çš„é›†åˆï¼Œé‚£ä¹ˆåœ¨ Spark ä¸­è¿ç®— Jaccard ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼š è·å–æ¯ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆ å¯¹ç‚¹çš„é‚»å±…è¿›è¡Œ MinHash è¿ç®—ï¼Œè·å¾— Jaccard ç³»æ•° åº†å¹¸çš„æ˜¯ï¼Œå¼€æºçš„ NebulaGraph Algorithm å·²ç»æä¾›äº†è¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—® nebula-algorithm/src/main/scala/com/vesoft/nebula/algorithm/lib/JaccardAlgo.scala äº†è§£å®ƒçš„å®ç°ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ NebulaGraph Algorithm å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹æ³•å‚è€ƒ NebulaGraph Algorithm æ–‡æ¡£ã€‚ æ³¨ï¼Œé…ç½®ä¸­ jaccard.tol çš„æ„æ¶µæ˜¯ approxSimilarityJoin ä¸­çš„ threshold ï¼š def approxSimilarityJoin( datasetA: Dataset[_], datasetB: Dataset[_], threshold: Double, distCol: String): Dataset[_] = { ... // Filter the joined datasets where the distance are smaller than the threshold. joinedDatasetWithDist.filter(col(distCol) \u003c threshold) è¯»è€…åˆ°è¿™é‡Œåº”è¯¥ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯å‡è®¾æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç”¨æˆ·å®ä½“ï¼Œè¾¹æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›´è¿å…³ç³»çš„ã€‚æ‰€ä»¥å†åº”ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç»è¿‡é¢„å¤„ç†çš„ç›´è¿è¾¹ï¼Œè¿™ä¸ªæ­¥éª¤æ­£æ˜¯å‰è¾¹ç« èŠ‚â€œåˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•â€ä¸­çš„å†…å®¹ã€‚ 1.","date":"2022-08-14","objectID":"/identity-resolution/:1:5","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åŸºäº-nebulagraph-algorithm-å›¾è®¡ç®—å¹³å°ç¤¾åŒºå‘ç°ç®—æ³•"},{"categories":["Nebula Graph"],"content":" 1.5 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³•å‰è¾¹çš„æ–¹æ³•ä¸­æˆ‘ä»¬ç›´æ¥åˆ©ç”¨äº†ç”¨æˆ·çš„å„é¡¹å±æ€§ã€è¡Œä¸ºäº‹ä»¶ä¸­äº§ç”Ÿçš„å…³ç³»ï¼Œå¹¶åˆ©ç”¨å„ç§å±æ€§ã€å€¼ç›¸ä¼¼åº¦çš„æ–¹æ³•å»ºç«‹äº†åŸºäºæ¦‚ç‡æˆ–è€…å¸¦æœ‰è¯„åˆ†çš„å…³è”å…³ç³»ã€‚è€Œåœ¨é€šè¿‡å…¶ä»–æ–¹æ³•å¢åŠ äº†æ–°çš„è¾¹ä¹‹åçš„å›¾ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å›¾ç®—æ³•çš„æ–¹æ³•æ¥æ˜ å°„æ½œåœ¨çš„ç›¸åŒç”¨æˆ· IDã€‚ 1.5.1 å›¾ç›¸ä¼¼æ€§ç®—æ³•åˆ©ç”¨èŠ‚ç‚¹ç›¸ä¼¼æ€§å›¾ç®—æ³•ï¼Œæ¯”å¦‚ Jaccard Indexã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æˆ–è€… a. åˆ©ç”¨å›¾åº“ä¹‹ä¸Šçš„å›¾è®¡ç®—å¹³å°å…¨é‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæˆ–è€… b. ç”¨å›¾æŸ¥è¯¢è¯­å¥å®ç°å…¨å›¾/ç»™å®šçš„ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ€åç»™ç›¸ä¼¼åº¦ä¸€å®šçš„é˜ˆå€¼æ¥å¸®åŠ©å»ºç«‹æ–°çš„ï¼ˆè€ƒè™‘äº†æ¶‰åŠè¾¹çš„ï¼‰æ˜ å°„å…³ç³»ã€‚ æ³¨ï¼Œè¿™é‡Œçš„ Jaccard index å’Œæˆ‘ä»¬å‰è¾¹æåˆ°çš„æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ç°åœ¨æåŠçš„æ˜¯åº”ç”¨åœ¨å›¾ä¸Šçš„ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿ç‚¹ä½œä¸ºç®—æ³•ä¸­çš„â€œäº¤é›†â€çš„å®ç°ã€‚ 1.5.2 ç¤¾åŒºå‘ç°ç®—æ³•è‡ªç„¶åœ°ï¼Œè¿˜å¯ä»¥ç”¨ç¤¾åŒºå‘ç°çš„ç®—æ³•å…¨å›¾æ‰¾å‡ºç»™å®šçš„åŸºäºè¾¹ä¹‹ä¸‹çš„ç¤¾åŒºåˆ’åˆ†ï¼Œè°ƒè¯•ç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡åˆ’åˆ†ç¤¾åŒºå†…éƒ¨ç‚¹ä¸ºä¼°è®¡çš„ç›¸åŒç”¨æˆ·ã€‚ 1.5.3 åŸºäºå›¾ç®—æ³•çš„æ–¹æ³• 1.5.3.1 åŸºäºå›¾æŸ¥è¯¢çš„ Jaccard å®ç°Jaccard Index æ˜¯ä¸€ä¸ªæè¿°ä¸¤ä¸ªé›†åˆè·ç¦»çš„å®šä¹‰å…¬å¼ï¼Œéå¸¸ç®€å•ã€ç¬¦åˆç›´è§‰ï¼Œå®ƒçš„å®šä¹‰ä¸ºï¼š $$ J(A,B)= \\frac {|A\\cap B|}{|A\\cup B|} $$ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠäº¤é›†ç†è§£ä¸º A ä¸ B å…±åŒè¿æ¥çš„ç‚¹ï¼ˆè®¾å¤‡ã€IPã€é‚®ç®±å‰ç¼€ã€åœ°å€ï¼‰ï¼Œè€Œå¹¶é›†ç†è§£ä¸ºè¿™å‡ ç§å…³ç³»ä¸‹ä¸ A æˆ–è€… B ç›´è¿çš„æ‰€æœ‰ç‚¹ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™æ ·çš„ NebulaGraph OpenCypher æŸ¥è¯¢å°±å¯ä»¥ç®—å‡ºè‡³å°‘åŒ…å«ä¸€è·³å…³ç³»çš„ç‚¹å’Œå®ƒç›¸å…³çš„ç‚¹ã€ä»¥åŠ Jaccard Index å€¼ï¼Œè¶Šå¤§ä»£è¡¨å…³è”åº¦è¶Šå¤§ã€‚ MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components)\u003c-[:used_device|logged_in_from|has_email_with_handle|has_address]-(v_end:`user`) WITH v_start, v_end, count(shared_components) AS intersection_size MATCH (v_start:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH id(v_start) AS v_start, v_end, intersection_size, COLLECT(id(shared_components)) AS set_a MATCH (v_end:`user`)-[:used_device|logged_in_from|has_email_with_handle|has_address]-\u003e(shared_components) WITH v_start, id(v_end) AS v_end, intersection_size, set_a, COLLECT(id(shared_components)) AS set_b WITH v_start, v_end, toFloat(intersection_size) AS intersection_size, toSet(set_a + set_b) AS A_U_B RETURN v_start, v_end, intersection_size/size(A_U_B) AS jaccard_index ORDER BY jaccard_index DESC æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œï¼š +-----------+-----------+---------------------+ | v_start | v_end | jaccard_index | +-----------+-----------+---------------------+ | \"user_8\" | \"user_19\" | 1.0 | | \"user_19\" | \"user_8\" | 1.0 | | \"user_20\" | \"user_3\" | 0.6666666666666666 | | \"user_3\" | \"user_20\" | 0.6666666666666666 | | \"user_21\" | \"user_2\" | 0.6 | | \"user_18\" | \"user_17\" | 0.6 | | \"user_17\" | \"user_18\" | 0.6 | | \"user_2\" | \"user_21\" | 0.6 | | \"user_22\" | \"user_9\" | 0.5 | | \"user_9\" | \"user_22\" | 0.5 | | \"user_23\" | \"user_5\" | 0.2 | | \"user_5\" | \"user_23\" | 0.2 | | \"user_21\" | \"user_20\" | 0.16666666666666666 | | \"user_20\" | \"user_21\" | 0.16666666666666666 | +-----------+-----------+---------------------+ user_8 ä¸ user_19 çš„ç³»æ•°æ˜¯æœ€å¤§çš„çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ä¹‹é—´çš„è¿æ¥ï¼Ÿ FIND ALL PATH FROM \"user_8\" TO \"user_19\" OVER * BIDIRECT YIELD path AS p; æœç„¶ï¼Œä»–ä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾ˆå¤§ï¼š 1.5.3.2 åŸºäº NebulaGraph Algorithm å›¾è®¡ç®—å¹³å°çš„ Jaccard æ–¹æ³• 1.5.3.2.1 å‰é¢æ–¹æ³•çš„å±€é™åˆ©ç”¨å›¾æ•°æ®åº“æŸ¥è¯¢è®¡ç®— Jaccard ç³»æ•°çš„æ–¹æ³•æœ‰ä¸¤æ–¹é¢å±€é™ã€‚ é¦–å…ˆï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸¤è¿ç®—ï¼Œæˆ‘ä»¬å‡è®¾äº†æ‰€æœ‰å€¼å¾—è¢«è¿ç®—çš„ç‚¹ä¹‹é—´å·²ç»å­˜åœ¨æŸç§ç¡®å®šé“¾æ¥ï¼ˆå¯¹åº” MATCH ç¬¬ä¸€è¡Œï¼‰ï¼Œè™½ç„¶è¿™æ ·çš„å‡è®¾åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥ç²—ç•¥è¢«æ¥å—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ç§å‹ç¼©å’Œå¦¥åã€‚ å…¶æ¬¡ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å½¢é‡Œï¼Œè¿™æ ·çš„æŸ¥è¯¢å°†ä¸å…·æœ‰å¯æ“ä½œæ€§ã€‚ 1.5.3.2.2 æ›´ Scale çš„æ–¹æ³•ä¸ºäº†èƒ½å¤„ç†æ›´å¤§è§„æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spark ç­‰å¹¶è¡Œè®¡ç®—å¹³å°è¿›è¡Œç®—æ³•æ‰§è¡Œï¼› åœ¨å…¨å›¾è¿ç®—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å±€éƒ¨æ•æ„Ÿå“ˆå¸Œ MinHash æ¥å¯¹ä¸¤ä¸¤æ¯”å¯¹é™ç»´ï¼Œåº†å¹¸çš„æ˜¯ï¼ŒSpark ä¸­æä¾›äº† MinHash çš„å®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼ å‚è€ƒï¼š https://aksakalli.github.io/2016/03/01/jaccard-similarity-with-minhash.html https://en.wikipedia.org/wiki/MinHash https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.ml.feature.MinHashLSH.html https://github.com/apache/spark/blob/master/mllib/src/main/scala/org/apache/spark/ml/feature/LSH.scala MinHash çš„æ€æƒ³ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¦‚ç‡å»æœ‰æŸä¼°è®¡ Jaccard ç³»æ•°ï¼Œè¿™é‡Œçš„é™ç»´ä½“ç°åœ¨å®ƒç”¨ bit map å»æ•°å­—åŒ–æ¯ä¸€ä¸ªé›†åˆï¼Œéšæœºå®šä¹‰ä¸åŒçš„é›†åˆä¸Šçš„ shuffleï¼ˆä¹±åºï¼‰å˜æ¢ï¼Œå–å˜æ¢ä¹‹å hash çš„æœ€å°å€¼ã€‚è¿™é‡Œï¼Œä¸¤ä¸ªé›†åˆçš„éšæœºå˜æ¢åæœ€å°å€¼ ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ç­‰äº Jaccard ç³»æ•°çš„ã€‚æ‰€ä»¥ï¼Œè¿™æ ·å·æ¢æ¢æŸ±ï¼Œå°±æŠŠéœ€è¦ä¸¤ä¸¤é›†åˆè¿ç®—æ¯”è¾ƒçš„ç®—æ³•å˜æˆåªéœ€è¦å¯¹æ¯ä¸€ä¸ªé›†åˆåšå¸¸æ•°æ¬¡éšæœºå˜æ¢å–æœ€å°çš„é™ç»´è¿‘ä¼¼è¿ç®—äº†ã€‚ åœ¨å›¾ä¸Šï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒçš„é‚»å±…å°±æ˜¯è¿™ä¸ªç‚¹çš„é›†åˆï¼Œé‚£ä¹ˆåœ¨ Spark ä¸­è¿ç®— Jaccard ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯ï¼š è·å–æ¯ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆ å¯¹ç‚¹çš„é‚»å±…è¿›è¡Œ MinHash è¿ç®—ï¼Œè·å¾— Jaccard ç³»æ•° åº†å¹¸çš„æ˜¯ï¼Œå¼€æºçš„ NebulaGraph Algorithm å·²ç»æä¾›äº†è¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è®¿é—® nebula-algorithm/src/main/scala/com/vesoft/nebula/algorithm/lib/JaccardAlgo.scala äº†è§£å®ƒçš„å®ç°ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ NebulaGraph Algorithm å°±å¯ä»¥äº†ï¼Œä½¿ç”¨æ–¹æ³•å‚è€ƒ NebulaGraph Algorithm æ–‡æ¡£ã€‚ æ³¨ï¼Œé…ç½®ä¸­ jaccard.tol çš„æ„æ¶µæ˜¯ approxSimilarityJoin ä¸­çš„ threshold ï¼š def approxSimilarityJoin( datasetA: Dataset[_], datasetB: Dataset[_], threshold: Double, distCol: String): Dataset[_] = { ... // Filter the joined datasets where the distance are smaller than the threshold. joinedDatasetWithDist.filter(col(distCol) \u003c threshold) è¯»è€…åˆ°è¿™é‡Œåº”è¯¥ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯å‡è®¾æ‰€æœ‰çš„ç‚¹éƒ½æ˜¯ç”¨æˆ·å®ä½“ï¼Œè¾¹æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›´è¿å…³ç³»çš„ã€‚æ‰€ä»¥å†åº”ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºç»è¿‡é¢„å¤„ç†çš„ç›´è¿è¾¹ï¼Œè¿™ä¸ªæ­¥éª¤æ­£æ˜¯å‰è¾¹ç« èŠ‚â€œåˆ©ç”¨æ–°çš„è¾¹è¿æ¥ä¸åŒæ–¹æ³•â€ä¸­çš„å†…å®¹ã€‚ 1.","date":"2022-08-14","objectID":"/identity-resolution/:1:5","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#ä¸Šæ‰‹åŸºäº-nebulagraph-algorithm-å›¾è®¡ç®—æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.6 åŸºäºå›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨è®²ä»¥ä¸Šä¸åŒçš„æ–¹æ³•ç›¸ç»“åˆçš„æ—¶å€™ï¼Œä¼šæŠŠå‰å¯¼æ–¹æ³•çš„ç»“æœä½œä¸ºå›¾ä¸Šçš„è¾¹ï¼Œè¿›è€Œä½œä¸ºåè¾¹çš„æ–¹æ³•çš„è¾“å…¥ï¼Œè€Œç›¸åŒç”¨æˆ· ID çš„è¯†åˆ«æœ¬è´¨ä¸Šå°±æ˜¯åœ¨å›¾ä¸Šå»é¢„æµ‹ç”¨æˆ·ä¹‹é—´é“¾æ¥ã€è¾¹ã€‚ åœ¨ GNN çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†æˆ‘ä»¬åœ¨æ¬ºè¯ˆæ£€æµ‹ä¸­åˆ©ç”¨åˆ°çš„èŠ‚ç‚¹åˆ†ç±»ï¼ˆå±æ€§é¢„æµ‹ï¼‰ä¹‹å¤–ï¼Œé“¾æ¥é¢„æµ‹ï¼ˆLink Predictionï¼‰ä¹Ÿæ˜¯å¦ä¸€ä¸ªå¸¸è§çš„ç®—æ³•ç›®æ ‡å’Œåº”ç”¨åœºæ™¯ã€‚è‡ªç„¶åœ°ï¼Œå¯ä»¥æƒ³åˆ°ç”¨ GNN çš„æ–¹æ³•ç»“åˆ 1. é GNN æ–¹æ³•è·å¾—çš„ã€ 2. å·²ç»æœ‰çš„äººä¸ºæ ‡æ³¨çš„é“¾æ¥ï¼Œæ¥å­¦ä¹ ã€é¢„æµ‹å›¾ä¸Šçš„ ID æ˜ å°„ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGNN çš„æ–¹æ³•åªèƒ½åˆ©ç”¨æ•°å­—å‹çš„ featureã€å±æ€§ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æŠŠéæ•°å­—å‹çš„å±æ€§åƒåœ¨åˆ†ç±»æƒ…å†µé‡Œé‚£æ ·æšä¸¾ä¸ºæ•°å€¼ï¼Œç›¸åï¼Œæˆ‘ä»¬åœ¨çœŸæ­£çš„ GNN ä¹‹å‰ï¼Œå¯ä»¥ç”¨å…¶ä»–çš„å›¾æ–¹æ³•å»å»ºç«‹åŸºäºæ‰“åˆ†ã€æˆ–è€…ç›¸ä¼¼åº¦çš„è¾¹å»ºç«‹ã€‚è¿™æ—¶å€™ï¼Œè¿™äº›å‰è¾¹çš„æ–¹æ³•æˆä¸ºäº† GNN é“¾è·¯é¢„æµ‹çš„ç‰¹å¾å·¥ç¨‹ã€‚ 1.6.1 åŸºäº GNN çš„å®æ“å’Œåœ¨ â€œåŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹â€ çš„æ¬ºè¯ˆæ£€æµ‹ç±»ä¼¼ï¼Œæˆ‘å°†ç»™å‡ºçš„ä¾‹å­ä¹Ÿæ˜¯ GNN ç»“åˆå›¾æ•°æ®åº“åšå®æ—¶é¢„æµ‹çš„ä¾‹å­ã€‚ 1.6.1.1 HDE[ICDM2021]æˆ‘ä»¬åˆ©ç”¨ Heterogeneous Graph Neural Network with Distance Encoding ç»™å‡ºçš„æ–¹æ³•æ¥åš Inductive Learning çš„å¼‚æ„ GNN ä¸Šçš„é“¾è·¯é¢„æµ‹ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªæ›´æ–¹ä¾¿çš„ GNN å·¥å…·ï¼ŒOpenHGNNï¼Œæœ‰äº†å®ƒï¼Œæœ¬ä¾‹ä¸­çš„ä»£ç é‡ä¹Ÿä¼šå¤§å¤§ä¸‹é™ã€‚ æ³¨ï¼šOpenHGNN æ˜¯ç”±åŒ—é‚® GAMMA Lab å¼€å‘çš„åŸºäº PyTorch å’Œ DGL çš„å¼€æºå¼‚è´¨å›¾ç¥ç»ç½‘ç»œå·¥å…·åŒ…ã€‚ 1.6.1.2 æ•°æ®é›†æœ¬åˆ©çš„æ•°æ®é›†æ˜¯å‰è¾¹æ–¹æ³•ä¸­å»ºç«‹åœ¨ NebulaGraph ä¸­çš„å›¾è°±ï¼Œå€ŸåŠ©äº Nebula-DGLï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è¡Œä»£ç æŠŠ NebulaGraph ä¸­çš„å›¾åŠ è½½åˆ° DGL ä¹‹ä¸­ã€‚ æ³¨ï¼š è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl ä½ å¯ä»¥ç›´æ¥ load è¿™ä¸ª .ngql æ–‡ä»¶åˆ° NebulaGraphã€‚ https://github.com/wey-gu/identity-correlation-datagen/raw/main/sample/hand_crafted/entity_resolution.ngql 1.6.1.3 æ•°æ®å¤„ç†ä¸ºäº†å°† NebulaGraph å›¾è°±è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬è¦é€šè¿‡ Nebula-DGL çš„ YAML é…ç½®æ–‡ä»¶ API æè¿°æ‰€éœ€çš„ç‚¹ã€è¾¹ç±»å‹ä»¥åŠå…³å¿ƒçš„å±æ€§ï¼ˆç‰¹å¾ï¼‰ã€‚ æˆ‘ä»¬çœ‹ä¸‹ç°åœ¨çš„å›¾ä¸­æœ‰å“ªäº›ç‚¹ã€è¾¹ç±»å‹ï¼š (root@nebula) [entity_resolution]\u003e SHOW TAGS +----------------+ | Name | +----------------+ | \"address\" | | \"device\" | | \"email\" | | \"email_handle\" | | \"ip\" | | \"phone\" | | \"user\" | +----------------+ Got 7 rows (time spent 1335/7357 us) (root@nebula) [entity_resolution]\u003e SHOW EDGES +---------------------------+ | Name | +---------------------------+ | \"has_address\" | | \"has_email\" | | \"has_email_with_handle\" | | \"has_phone\" | | \"is_similar_to\" | | \"logged_in_from\" | | \"shared_name\" | | \"shared_similar_email\" | | \"shared_similar_location\" | | \"used_device\" | | \"with_handle\" | +---------------------------+ Got 11 rows (time spent 1439/30418 us) åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘å±æ€§(ç‰¹å¾)ã€‚ nebulagraph_entity_resolution_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: entity_resolution # str or int vertex_id_type: int vertex_tags: - name: user - name: address - name: device - name: email_handle - name: ip edge_types: - name: has_email_with_handle start_vertex_tag: user end_vertex_tag: email_handle - name: is_similar_to start_vertex_tag: user end_vertex_tag: user - name: shared_similar_location start_vertex_tag: user end_vertex_tag: user - name: has_address start_vertex_tag: user end_vertex_tag: address - name: logged_in_from start_vertex_tag: user end_vertex_tag: ip - name: used_device start_vertex_tag: user end_vertex_tag: device ç„¶åï¼Œæˆ‘ä»¬åœ¨å®‰è£…å¥½ Nebula-DGL ä¹‹ååªéœ€è¦è¿™å‡ è¡Œä»£ç å°±å¯ä»¥å°† NebulaGraph ä¸­çš„è¿™å¼ å›¾æ„é€ ä¸º DGL çš„ DGLHeteroGraph å›¾å¯¹è±¡ï¼š from nebula_dgl import NebulaLoader nebula_config = { \"graph_hosts\": [ ('graphd', 9669), ('graphd1', 9669), ('graphd2', 9669) ], \"nebula_user\": \"root\", \"nebula_password\": \"nebula\", } # load feature_mapper from yaml file with open('nebulagraph_entity_resolution_dgl_mapper.yaml', 'r') as f: feature_mapper = yaml.safe_load(f) nebula_loader = NebulaLoader(nebula_config, feature_mapper) g = nebula_loader.load() g = g.to('cpu') device = torch.device('cpu') 1.6.1.4 æ¨¡å‹è®­ç»ƒå‚è€ƒ custom_link_prediction_dataset.py HDE_link_predict.py import torch as th from openhgnn import Experiment from openhgnn.dataset import AsLinkPredictionDataset, generate_random_hg from dgl import transforms as T from dgl import DGLHeteroGraph from dgl.data import DGLDataset from dgl.dataloading.negative_sampler import GlobalUniform meta_paths_dict = {'APA': [('user', 'has_email_with_handle', 'email_handle'), ('user', 'is_similar_to', 'user'), ('user', 'shared_similar_location', 'user'), ('user', 'has_address', 'address'), ('user', 'logged_in_from', 'ip'), ('user', 'used_device', 'device')]} target_link = [('user', 'is_similar_to', 'user')] target_link_r = [('user', 'is_similar_to', 'user')] class MyLPDataset(DGLDataset): def __init__(self, g): super().__init__(name='entity_resolution', force_reload=True) self.g = g def process(","date":"2022-08-14","objectID":"/identity-resolution/:1:6","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åŸºäºå›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.6 åŸºäºå›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨è®²ä»¥ä¸Šä¸åŒçš„æ–¹æ³•ç›¸ç»“åˆçš„æ—¶å€™ï¼Œä¼šæŠŠå‰å¯¼æ–¹æ³•çš„ç»“æœä½œä¸ºå›¾ä¸Šçš„è¾¹ï¼Œè¿›è€Œä½œä¸ºåè¾¹çš„æ–¹æ³•çš„è¾“å…¥ï¼Œè€Œç›¸åŒç”¨æˆ· ID çš„è¯†åˆ«æœ¬è´¨ä¸Šå°±æ˜¯åœ¨å›¾ä¸Šå»é¢„æµ‹ç”¨æˆ·ä¹‹é—´é“¾æ¥ã€è¾¹ã€‚ åœ¨ GNN çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†æˆ‘ä»¬åœ¨æ¬ºè¯ˆæ£€æµ‹ä¸­åˆ©ç”¨åˆ°çš„èŠ‚ç‚¹åˆ†ç±»ï¼ˆå±æ€§é¢„æµ‹ï¼‰ä¹‹å¤–ï¼Œé“¾æ¥é¢„æµ‹ï¼ˆLink Predictionï¼‰ä¹Ÿæ˜¯å¦ä¸€ä¸ªå¸¸è§çš„ç®—æ³•ç›®æ ‡å’Œåº”ç”¨åœºæ™¯ã€‚è‡ªç„¶åœ°ï¼Œå¯ä»¥æƒ³åˆ°ç”¨ GNN çš„æ–¹æ³•ç»“åˆ 1. é GNN æ–¹æ³•è·å¾—çš„ã€ 2. å·²ç»æœ‰çš„äººä¸ºæ ‡æ³¨çš„é“¾æ¥ï¼Œæ¥å­¦ä¹ ã€é¢„æµ‹å›¾ä¸Šçš„ ID æ˜ å°„ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGNN çš„æ–¹æ³•åªèƒ½åˆ©ç”¨æ•°å­—å‹çš„ featureã€å±æ€§ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æŠŠéæ•°å­—å‹çš„å±æ€§åƒåœ¨åˆ†ç±»æƒ…å†µé‡Œé‚£æ ·æšä¸¾ä¸ºæ•°å€¼ï¼Œç›¸åï¼Œæˆ‘ä»¬åœ¨çœŸæ­£çš„ GNN ä¹‹å‰ï¼Œå¯ä»¥ç”¨å…¶ä»–çš„å›¾æ–¹æ³•å»å»ºç«‹åŸºäºæ‰“åˆ†ã€æˆ–è€…ç›¸ä¼¼åº¦çš„è¾¹å»ºç«‹ã€‚è¿™æ—¶å€™ï¼Œè¿™äº›å‰è¾¹çš„æ–¹æ³•æˆä¸ºäº† GNN é“¾è·¯é¢„æµ‹çš„ç‰¹å¾å·¥ç¨‹ã€‚ 1.6.1 åŸºäº GNN çš„å®æ“å’Œåœ¨ â€œåŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹â€ çš„æ¬ºè¯ˆæ£€æµ‹ç±»ä¼¼ï¼Œæˆ‘å°†ç»™å‡ºçš„ä¾‹å­ä¹Ÿæ˜¯ GNN ç»“åˆå›¾æ•°æ®åº“åšå®æ—¶é¢„æµ‹çš„ä¾‹å­ã€‚ 1.6.1.1 HDE[ICDM2021]æˆ‘ä»¬åˆ©ç”¨ Heterogeneous Graph Neural Network with Distance Encoding ç»™å‡ºçš„æ–¹æ³•æ¥åš Inductive Learning çš„å¼‚æ„ GNN ä¸Šçš„é“¾è·¯é¢„æµ‹ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªæ›´æ–¹ä¾¿çš„ GNN å·¥å…·ï¼ŒOpenHGNNï¼Œæœ‰äº†å®ƒï¼Œæœ¬ä¾‹ä¸­çš„ä»£ç é‡ä¹Ÿä¼šå¤§å¤§ä¸‹é™ã€‚ æ³¨ï¼šOpenHGNN æ˜¯ç”±åŒ—é‚® GAMMA Lab å¼€å‘çš„åŸºäº PyTorch å’Œ DGL çš„å¼€æºå¼‚è´¨å›¾ç¥ç»ç½‘ç»œå·¥å…·åŒ…ã€‚ 1.6.1.2 æ•°æ®é›†æœ¬åˆ©çš„æ•°æ®é›†æ˜¯å‰è¾¹æ–¹æ³•ä¸­å»ºç«‹åœ¨ NebulaGraph ä¸­çš„å›¾è°±ï¼Œå€ŸåŠ©äº Nebula-DGLï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è¡Œä»£ç æŠŠ NebulaGraph ä¸­çš„å›¾åŠ è½½åˆ° DGL ä¹‹ä¸­ã€‚ æ³¨ï¼š è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl ä½ å¯ä»¥ç›´æ¥ load è¿™ä¸ª .ngql æ–‡ä»¶åˆ° NebulaGraphã€‚ https://github.com/wey-gu/identity-correlation-datagen/raw/main/sample/hand_crafted/entity_resolution.ngql 1.6.1.3 æ•°æ®å¤„ç†ä¸ºäº†å°† NebulaGraph å›¾è°±è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬è¦é€šè¿‡ Nebula-DGL çš„ YAML é…ç½®æ–‡ä»¶ API æè¿°æ‰€éœ€çš„ç‚¹ã€è¾¹ç±»å‹ä»¥åŠå…³å¿ƒçš„å±æ€§ï¼ˆç‰¹å¾ï¼‰ã€‚ æˆ‘ä»¬çœ‹ä¸‹ç°åœ¨çš„å›¾ä¸­æœ‰å“ªäº›ç‚¹ã€è¾¹ç±»å‹ï¼š (root@nebula) [entity_resolution]\u003e SHOW TAGS +----------------+ | Name | +----------------+ | \"address\" | | \"device\" | | \"email\" | | \"email_handle\" | | \"ip\" | | \"phone\" | | \"user\" | +----------------+ Got 7 rows (time spent 1335/7357 us) (root@nebula) [entity_resolution]\u003e SHOW EDGES +---------------------------+ | Name | +---------------------------+ | \"has_address\" | | \"has_email\" | | \"has_email_with_handle\" | | \"has_phone\" | | \"is_similar_to\" | | \"logged_in_from\" | | \"shared_name\" | | \"shared_similar_email\" | | \"shared_similar_location\" | | \"used_device\" | | \"with_handle\" | +---------------------------+ Got 11 rows (time spent 1439/30418 us) åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘å±æ€§(ç‰¹å¾)ã€‚ nebulagraph_entity_resolution_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: entity_resolution # str or int vertex_id_type: int vertex_tags: - name: user - name: address - name: device - name: email_handle - name: ip edge_types: - name: has_email_with_handle start_vertex_tag: user end_vertex_tag: email_handle - name: is_similar_to start_vertex_tag: user end_vertex_tag: user - name: shared_similar_location start_vertex_tag: user end_vertex_tag: user - name: has_address start_vertex_tag: user end_vertex_tag: address - name: logged_in_from start_vertex_tag: user end_vertex_tag: ip - name: used_device start_vertex_tag: user end_vertex_tag: device ç„¶åï¼Œæˆ‘ä»¬åœ¨å®‰è£…å¥½ Nebula-DGL ä¹‹ååªéœ€è¦è¿™å‡ è¡Œä»£ç å°±å¯ä»¥å°† NebulaGraph ä¸­çš„è¿™å¼ å›¾æ„é€ ä¸º DGL çš„ DGLHeteroGraph å›¾å¯¹è±¡ï¼š from nebula_dgl import NebulaLoader nebula_config = { \"graph_hosts\": [ ('graphd', 9669), ('graphd1', 9669), ('graphd2', 9669) ], \"nebula_user\": \"root\", \"nebula_password\": \"nebula\", } # load feature_mapper from yaml file with open('nebulagraph_entity_resolution_dgl_mapper.yaml', 'r') as f: feature_mapper = yaml.safe_load(f) nebula_loader = NebulaLoader(nebula_config, feature_mapper) g = nebula_loader.load() g = g.to('cpu') device = torch.device('cpu') 1.6.1.4 æ¨¡å‹è®­ç»ƒå‚è€ƒ custom_link_prediction_dataset.py HDE_link_predict.py import torch as th from openhgnn import Experiment from openhgnn.dataset import AsLinkPredictionDataset, generate_random_hg from dgl import transforms as T from dgl import DGLHeteroGraph from dgl.data import DGLDataset from dgl.dataloading.negative_sampler import GlobalUniform meta_paths_dict = {'APA': [('user', 'has_email_with_handle', 'email_handle'), ('user', 'is_similar_to', 'user'), ('user', 'shared_similar_location', 'user'), ('user', 'has_address', 'address'), ('user', 'logged_in_from', 'ip'), ('user', 'used_device', 'device')]} target_link = [('user', 'is_similar_to', 'user')] target_link_r = [('user', 'is_similar_to', 'user')] class MyLPDataset(DGLDataset): def __init__(self, g): super().__init__(name='entity_resolution', force_reload=True) self.g = g def process(","date":"2022-08-14","objectID":"/identity-resolution/:1:6","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åŸºäº-gnn-çš„å®æ“"},{"categories":["Nebula Graph"],"content":" 1.6 åŸºäºå›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨è®²ä»¥ä¸Šä¸åŒçš„æ–¹æ³•ç›¸ç»“åˆçš„æ—¶å€™ï¼Œä¼šæŠŠå‰å¯¼æ–¹æ³•çš„ç»“æœä½œä¸ºå›¾ä¸Šçš„è¾¹ï¼Œè¿›è€Œä½œä¸ºåè¾¹çš„æ–¹æ³•çš„è¾“å…¥ï¼Œè€Œç›¸åŒç”¨æˆ· ID çš„è¯†åˆ«æœ¬è´¨ä¸Šå°±æ˜¯åœ¨å›¾ä¸Šå»é¢„æµ‹ç”¨æˆ·ä¹‹é—´é“¾æ¥ã€è¾¹ã€‚ åœ¨ GNN çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†æˆ‘ä»¬åœ¨æ¬ºè¯ˆæ£€æµ‹ä¸­åˆ©ç”¨åˆ°çš„èŠ‚ç‚¹åˆ†ç±»ï¼ˆå±æ€§é¢„æµ‹ï¼‰ä¹‹å¤–ï¼Œé“¾æ¥é¢„æµ‹ï¼ˆLink Predictionï¼‰ä¹Ÿæ˜¯å¦ä¸€ä¸ªå¸¸è§çš„ç®—æ³•ç›®æ ‡å’Œåº”ç”¨åœºæ™¯ã€‚è‡ªç„¶åœ°ï¼Œå¯ä»¥æƒ³åˆ°ç”¨ GNN çš„æ–¹æ³•ç»“åˆ 1. é GNN æ–¹æ³•è·å¾—çš„ã€ 2. å·²ç»æœ‰çš„äººä¸ºæ ‡æ³¨çš„é“¾æ¥ï¼Œæ¥å­¦ä¹ ã€é¢„æµ‹å›¾ä¸Šçš„ ID æ˜ å°„ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGNN çš„æ–¹æ³•åªèƒ½åˆ©ç”¨æ•°å­—å‹çš„ featureã€å±æ€§ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æŠŠéæ•°å­—å‹çš„å±æ€§åƒåœ¨åˆ†ç±»æƒ…å†µé‡Œé‚£æ ·æšä¸¾ä¸ºæ•°å€¼ï¼Œç›¸åï¼Œæˆ‘ä»¬åœ¨çœŸæ­£çš„ GNN ä¹‹å‰ï¼Œå¯ä»¥ç”¨å…¶ä»–çš„å›¾æ–¹æ³•å»å»ºç«‹åŸºäºæ‰“åˆ†ã€æˆ–è€…ç›¸ä¼¼åº¦çš„è¾¹å»ºç«‹ã€‚è¿™æ—¶å€™ï¼Œè¿™äº›å‰è¾¹çš„æ–¹æ³•æˆä¸ºäº† GNN é“¾è·¯é¢„æµ‹çš„ç‰¹å¾å·¥ç¨‹ã€‚ 1.6.1 åŸºäº GNN çš„å®æ“å’Œåœ¨ â€œåŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹â€ çš„æ¬ºè¯ˆæ£€æµ‹ç±»ä¼¼ï¼Œæˆ‘å°†ç»™å‡ºçš„ä¾‹å­ä¹Ÿæ˜¯ GNN ç»“åˆå›¾æ•°æ®åº“åšå®æ—¶é¢„æµ‹çš„ä¾‹å­ã€‚ 1.6.1.1 HDE[ICDM2021]æˆ‘ä»¬åˆ©ç”¨ Heterogeneous Graph Neural Network with Distance Encoding ç»™å‡ºçš„æ–¹æ³•æ¥åš Inductive Learning çš„å¼‚æ„ GNN ä¸Šçš„é“¾è·¯é¢„æµ‹ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªæ›´æ–¹ä¾¿çš„ GNN å·¥å…·ï¼ŒOpenHGNNï¼Œæœ‰äº†å®ƒï¼Œæœ¬ä¾‹ä¸­çš„ä»£ç é‡ä¹Ÿä¼šå¤§å¤§ä¸‹é™ã€‚ æ³¨ï¼šOpenHGNN æ˜¯ç”±åŒ—é‚® GAMMA Lab å¼€å‘çš„åŸºäº PyTorch å’Œ DGL çš„å¼€æºå¼‚è´¨å›¾ç¥ç»ç½‘ç»œå·¥å…·åŒ…ã€‚ 1.6.1.2 æ•°æ®é›†æœ¬åˆ©çš„æ•°æ®é›†æ˜¯å‰è¾¹æ–¹æ³•ä¸­å»ºç«‹åœ¨ NebulaGraph ä¸­çš„å›¾è°±ï¼Œå€ŸåŠ©äº Nebula-DGLï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è¡Œä»£ç æŠŠ NebulaGraph ä¸­çš„å›¾åŠ è½½åˆ° DGL ä¹‹ä¸­ã€‚ æ³¨ï¼š è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl ä½ å¯ä»¥ç›´æ¥ load è¿™ä¸ª .ngql æ–‡ä»¶åˆ° NebulaGraphã€‚ https://github.com/wey-gu/identity-correlation-datagen/raw/main/sample/hand_crafted/entity_resolution.ngql 1.6.1.3 æ•°æ®å¤„ç†ä¸ºäº†å°† NebulaGraph å›¾è°±è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬è¦é€šè¿‡ Nebula-DGL çš„ YAML é…ç½®æ–‡ä»¶ API æè¿°æ‰€éœ€çš„ç‚¹ã€è¾¹ç±»å‹ä»¥åŠå…³å¿ƒçš„å±æ€§ï¼ˆç‰¹å¾ï¼‰ã€‚ æˆ‘ä»¬çœ‹ä¸‹ç°åœ¨çš„å›¾ä¸­æœ‰å“ªäº›ç‚¹ã€è¾¹ç±»å‹ï¼š (root@nebula) [entity_resolution]\u003e SHOW TAGS +----------------+ | Name | +----------------+ | \"address\" | | \"device\" | | \"email\" | | \"email_handle\" | | \"ip\" | | \"phone\" | | \"user\" | +----------------+ Got 7 rows (time spent 1335/7357 us) (root@nebula) [entity_resolution]\u003e SHOW EDGES +---------------------------+ | Name | +---------------------------+ | \"has_address\" | | \"has_email\" | | \"has_email_with_handle\" | | \"has_phone\" | | \"is_similar_to\" | | \"logged_in_from\" | | \"shared_name\" | | \"shared_similar_email\" | | \"shared_similar_location\" | | \"used_device\" | | \"with_handle\" | +---------------------------+ Got 11 rows (time spent 1439/30418 us) åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘å±æ€§(ç‰¹å¾)ã€‚ nebulagraph_entity_resolution_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: entity_resolution # str or int vertex_id_type: int vertex_tags: - name: user - name: address - name: device - name: email_handle - name: ip edge_types: - name: has_email_with_handle start_vertex_tag: user end_vertex_tag: email_handle - name: is_similar_to start_vertex_tag: user end_vertex_tag: user - name: shared_similar_location start_vertex_tag: user end_vertex_tag: user - name: has_address start_vertex_tag: user end_vertex_tag: address - name: logged_in_from start_vertex_tag: user end_vertex_tag: ip - name: used_device start_vertex_tag: user end_vertex_tag: device ç„¶åï¼Œæˆ‘ä»¬åœ¨å®‰è£…å¥½ Nebula-DGL ä¹‹ååªéœ€è¦è¿™å‡ è¡Œä»£ç å°±å¯ä»¥å°† NebulaGraph ä¸­çš„è¿™å¼ å›¾æ„é€ ä¸º DGL çš„ DGLHeteroGraph å›¾å¯¹è±¡ï¼š from nebula_dgl import NebulaLoader nebula_config = { \"graph_hosts\": [ ('graphd', 9669), ('graphd1', 9669), ('graphd2', 9669) ], \"nebula_user\": \"root\", \"nebula_password\": \"nebula\", } # load feature_mapper from yaml file with open('nebulagraph_entity_resolution_dgl_mapper.yaml', 'r') as f: feature_mapper = yaml.safe_load(f) nebula_loader = NebulaLoader(nebula_config, feature_mapper) g = nebula_loader.load() g = g.to('cpu') device = torch.device('cpu') 1.6.1.4 æ¨¡å‹è®­ç»ƒå‚è€ƒ custom_link_prediction_dataset.py HDE_link_predict.py import torch as th from openhgnn import Experiment from openhgnn.dataset import AsLinkPredictionDataset, generate_random_hg from dgl import transforms as T from dgl import DGLHeteroGraph from dgl.data import DGLDataset from dgl.dataloading.negative_sampler import GlobalUniform meta_paths_dict = {'APA': [('user', 'has_email_with_handle', 'email_handle'), ('user', 'is_similar_to', 'user'), ('user', 'shared_similar_location', 'user'), ('user', 'has_address', 'address'), ('user', 'logged_in_from', 'ip'), ('user', 'used_device', 'device')]} target_link = [('user', 'is_similar_to', 'user')] target_link_r = [('user', 'is_similar_to', 'user')] class MyLPDataset(DGLDataset): def __init__(self, g): super().__init__(name='entity_resolution', force_reload=True) self.g = g def process(","date":"2022-08-14","objectID":"/identity-resolution/:1:6","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#hdeicdm2021httpsieeexploreieeeorgdocument9679130"},{"categories":["Nebula Graph"],"content":" 1.6 åŸºäºå›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨è®²ä»¥ä¸Šä¸åŒçš„æ–¹æ³•ç›¸ç»“åˆçš„æ—¶å€™ï¼Œä¼šæŠŠå‰å¯¼æ–¹æ³•çš„ç»“æœä½œä¸ºå›¾ä¸Šçš„è¾¹ï¼Œè¿›è€Œä½œä¸ºåè¾¹çš„æ–¹æ³•çš„è¾“å…¥ï¼Œè€Œç›¸åŒç”¨æˆ· ID çš„è¯†åˆ«æœ¬è´¨ä¸Šå°±æ˜¯åœ¨å›¾ä¸Šå»é¢„æµ‹ç”¨æˆ·ä¹‹é—´é“¾æ¥ã€è¾¹ã€‚ åœ¨ GNN çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†æˆ‘ä»¬åœ¨æ¬ºè¯ˆæ£€æµ‹ä¸­åˆ©ç”¨åˆ°çš„èŠ‚ç‚¹åˆ†ç±»ï¼ˆå±æ€§é¢„æµ‹ï¼‰ä¹‹å¤–ï¼Œé“¾æ¥é¢„æµ‹ï¼ˆLink Predictionï¼‰ä¹Ÿæ˜¯å¦ä¸€ä¸ªå¸¸è§çš„ç®—æ³•ç›®æ ‡å’Œåº”ç”¨åœºæ™¯ã€‚è‡ªç„¶åœ°ï¼Œå¯ä»¥æƒ³åˆ°ç”¨ GNN çš„æ–¹æ³•ç»“åˆ 1. é GNN æ–¹æ³•è·å¾—çš„ã€ 2. å·²ç»æœ‰çš„äººä¸ºæ ‡æ³¨çš„é“¾æ¥ï¼Œæ¥å­¦ä¹ ã€é¢„æµ‹å›¾ä¸Šçš„ ID æ˜ å°„ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGNN çš„æ–¹æ³•åªèƒ½åˆ©ç”¨æ•°å­—å‹çš„ featureã€å±æ€§ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æŠŠéæ•°å­—å‹çš„å±æ€§åƒåœ¨åˆ†ç±»æƒ…å†µé‡Œé‚£æ ·æšä¸¾ä¸ºæ•°å€¼ï¼Œç›¸åï¼Œæˆ‘ä»¬åœ¨çœŸæ­£çš„ GNN ä¹‹å‰ï¼Œå¯ä»¥ç”¨å…¶ä»–çš„å›¾æ–¹æ³•å»å»ºç«‹åŸºäºæ‰“åˆ†ã€æˆ–è€…ç›¸ä¼¼åº¦çš„è¾¹å»ºç«‹ã€‚è¿™æ—¶å€™ï¼Œè¿™äº›å‰è¾¹çš„æ–¹æ³•æˆä¸ºäº† GNN é“¾è·¯é¢„æµ‹çš„ç‰¹å¾å·¥ç¨‹ã€‚ 1.6.1 åŸºäº GNN çš„å®æ“å’Œåœ¨ â€œåŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹â€ çš„æ¬ºè¯ˆæ£€æµ‹ç±»ä¼¼ï¼Œæˆ‘å°†ç»™å‡ºçš„ä¾‹å­ä¹Ÿæ˜¯ GNN ç»“åˆå›¾æ•°æ®åº“åšå®æ—¶é¢„æµ‹çš„ä¾‹å­ã€‚ 1.6.1.1 HDE[ICDM2021]æˆ‘ä»¬åˆ©ç”¨ Heterogeneous Graph Neural Network with Distance Encoding ç»™å‡ºçš„æ–¹æ³•æ¥åš Inductive Learning çš„å¼‚æ„ GNN ä¸Šçš„é“¾è·¯é¢„æµ‹ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªæ›´æ–¹ä¾¿çš„ GNN å·¥å…·ï¼ŒOpenHGNNï¼Œæœ‰äº†å®ƒï¼Œæœ¬ä¾‹ä¸­çš„ä»£ç é‡ä¹Ÿä¼šå¤§å¤§ä¸‹é™ã€‚ æ³¨ï¼šOpenHGNN æ˜¯ç”±åŒ—é‚® GAMMA Lab å¼€å‘çš„åŸºäº PyTorch å’Œ DGL çš„å¼€æºå¼‚è´¨å›¾ç¥ç»ç½‘ç»œå·¥å…·åŒ…ã€‚ 1.6.1.2 æ•°æ®é›†æœ¬åˆ©çš„æ•°æ®é›†æ˜¯å‰è¾¹æ–¹æ³•ä¸­å»ºç«‹åœ¨ NebulaGraph ä¸­çš„å›¾è°±ï¼Œå€ŸåŠ©äº Nebula-DGLï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è¡Œä»£ç æŠŠ NebulaGraph ä¸­çš„å›¾åŠ è½½åˆ° DGL ä¹‹ä¸­ã€‚ æ³¨ï¼š è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl ä½ å¯ä»¥ç›´æ¥ load è¿™ä¸ª .ngql æ–‡ä»¶åˆ° NebulaGraphã€‚ https://github.com/wey-gu/identity-correlation-datagen/raw/main/sample/hand_crafted/entity_resolution.ngql 1.6.1.3 æ•°æ®å¤„ç†ä¸ºäº†å°† NebulaGraph å›¾è°±è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬è¦é€šè¿‡ Nebula-DGL çš„ YAML é…ç½®æ–‡ä»¶ API æè¿°æ‰€éœ€çš„ç‚¹ã€è¾¹ç±»å‹ä»¥åŠå…³å¿ƒçš„å±æ€§ï¼ˆç‰¹å¾ï¼‰ã€‚ æˆ‘ä»¬çœ‹ä¸‹ç°åœ¨çš„å›¾ä¸­æœ‰å“ªäº›ç‚¹ã€è¾¹ç±»å‹ï¼š (root@nebula) [entity_resolution]\u003e SHOW TAGS +----------------+ | Name | +----------------+ | \"address\" | | \"device\" | | \"email\" | | \"email_handle\" | | \"ip\" | | \"phone\" | | \"user\" | +----------------+ Got 7 rows (time spent 1335/7357 us) (root@nebula) [entity_resolution]\u003e SHOW EDGES +---------------------------+ | Name | +---------------------------+ | \"has_address\" | | \"has_email\" | | \"has_email_with_handle\" | | \"has_phone\" | | \"is_similar_to\" | | \"logged_in_from\" | | \"shared_name\" | | \"shared_similar_email\" | | \"shared_similar_location\" | | \"used_device\" | | \"with_handle\" | +---------------------------+ Got 11 rows (time spent 1439/30418 us) åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘å±æ€§(ç‰¹å¾)ã€‚ nebulagraph_entity_resolution_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: entity_resolution # str or int vertex_id_type: int vertex_tags: - name: user - name: address - name: device - name: email_handle - name: ip edge_types: - name: has_email_with_handle start_vertex_tag: user end_vertex_tag: email_handle - name: is_similar_to start_vertex_tag: user end_vertex_tag: user - name: shared_similar_location start_vertex_tag: user end_vertex_tag: user - name: has_address start_vertex_tag: user end_vertex_tag: address - name: logged_in_from start_vertex_tag: user end_vertex_tag: ip - name: used_device start_vertex_tag: user end_vertex_tag: device ç„¶åï¼Œæˆ‘ä»¬åœ¨å®‰è£…å¥½ Nebula-DGL ä¹‹ååªéœ€è¦è¿™å‡ è¡Œä»£ç å°±å¯ä»¥å°† NebulaGraph ä¸­çš„è¿™å¼ å›¾æ„é€ ä¸º DGL çš„ DGLHeteroGraph å›¾å¯¹è±¡ï¼š from nebula_dgl import NebulaLoader nebula_config = { \"graph_hosts\": [ ('graphd', 9669), ('graphd1', 9669), ('graphd2', 9669) ], \"nebula_user\": \"root\", \"nebula_password\": \"nebula\", } # load feature_mapper from yaml file with open('nebulagraph_entity_resolution_dgl_mapper.yaml', 'r') as f: feature_mapper = yaml.safe_load(f) nebula_loader = NebulaLoader(nebula_config, feature_mapper) g = nebula_loader.load() g = g.to('cpu') device = torch.device('cpu') 1.6.1.4 æ¨¡å‹è®­ç»ƒå‚è€ƒ custom_link_prediction_dataset.py HDE_link_predict.py import torch as th from openhgnn import Experiment from openhgnn.dataset import AsLinkPredictionDataset, generate_random_hg from dgl import transforms as T from dgl import DGLHeteroGraph from dgl.data import DGLDataset from dgl.dataloading.negative_sampler import GlobalUniform meta_paths_dict = {'APA': [('user', 'has_email_with_handle', 'email_handle'), ('user', 'is_similar_to', 'user'), ('user', 'shared_similar_location', 'user'), ('user', 'has_address', 'address'), ('user', 'logged_in_from', 'ip'), ('user', 'used_device', 'device')]} target_link = [('user', 'is_similar_to', 'user')] target_link_r = [('user', 'is_similar_to', 'user')] class MyLPDataset(DGLDataset): def __init__(self, g): super().__init__(name='entity_resolution', force_reload=True) self.g = g def process(","date":"2022-08-14","objectID":"/identity-resolution/:1:6","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#æ•°æ®é›†"},{"categories":["Nebula Graph"],"content":" 1.6 åŸºäºå›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨è®²ä»¥ä¸Šä¸åŒçš„æ–¹æ³•ç›¸ç»“åˆçš„æ—¶å€™ï¼Œä¼šæŠŠå‰å¯¼æ–¹æ³•çš„ç»“æœä½œä¸ºå›¾ä¸Šçš„è¾¹ï¼Œè¿›è€Œä½œä¸ºåè¾¹çš„æ–¹æ³•çš„è¾“å…¥ï¼Œè€Œç›¸åŒç”¨æˆ· ID çš„è¯†åˆ«æœ¬è´¨ä¸Šå°±æ˜¯åœ¨å›¾ä¸Šå»é¢„æµ‹ç”¨æˆ·ä¹‹é—´é“¾æ¥ã€è¾¹ã€‚ åœ¨ GNN çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†æˆ‘ä»¬åœ¨æ¬ºè¯ˆæ£€æµ‹ä¸­åˆ©ç”¨åˆ°çš„èŠ‚ç‚¹åˆ†ç±»ï¼ˆå±æ€§é¢„æµ‹ï¼‰ä¹‹å¤–ï¼Œé“¾æ¥é¢„æµ‹ï¼ˆLink Predictionï¼‰ä¹Ÿæ˜¯å¦ä¸€ä¸ªå¸¸è§çš„ç®—æ³•ç›®æ ‡å’Œåº”ç”¨åœºæ™¯ã€‚è‡ªç„¶åœ°ï¼Œå¯ä»¥æƒ³åˆ°ç”¨ GNN çš„æ–¹æ³•ç»“åˆ 1. é GNN æ–¹æ³•è·å¾—çš„ã€ 2. å·²ç»æœ‰çš„äººä¸ºæ ‡æ³¨çš„é“¾æ¥ï¼Œæ¥å­¦ä¹ ã€é¢„æµ‹å›¾ä¸Šçš„ ID æ˜ å°„ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGNN çš„æ–¹æ³•åªèƒ½åˆ©ç”¨æ•°å­—å‹çš„ featureã€å±æ€§ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æŠŠéæ•°å­—å‹çš„å±æ€§åƒåœ¨åˆ†ç±»æƒ…å†µé‡Œé‚£æ ·æšä¸¾ä¸ºæ•°å€¼ï¼Œç›¸åï¼Œæˆ‘ä»¬åœ¨çœŸæ­£çš„ GNN ä¹‹å‰ï¼Œå¯ä»¥ç”¨å…¶ä»–çš„å›¾æ–¹æ³•å»å»ºç«‹åŸºäºæ‰“åˆ†ã€æˆ–è€…ç›¸ä¼¼åº¦çš„è¾¹å»ºç«‹ã€‚è¿™æ—¶å€™ï¼Œè¿™äº›å‰è¾¹çš„æ–¹æ³•æˆä¸ºäº† GNN é“¾è·¯é¢„æµ‹çš„ç‰¹å¾å·¥ç¨‹ã€‚ 1.6.1 åŸºäº GNN çš„å®æ“å’Œåœ¨ â€œåŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹â€ çš„æ¬ºè¯ˆæ£€æµ‹ç±»ä¼¼ï¼Œæˆ‘å°†ç»™å‡ºçš„ä¾‹å­ä¹Ÿæ˜¯ GNN ç»“åˆå›¾æ•°æ®åº“åšå®æ—¶é¢„æµ‹çš„ä¾‹å­ã€‚ 1.6.1.1 HDE[ICDM2021]æˆ‘ä»¬åˆ©ç”¨ Heterogeneous Graph Neural Network with Distance Encoding ç»™å‡ºçš„æ–¹æ³•æ¥åš Inductive Learning çš„å¼‚æ„ GNN ä¸Šçš„é“¾è·¯é¢„æµ‹ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªæ›´æ–¹ä¾¿çš„ GNN å·¥å…·ï¼ŒOpenHGNNï¼Œæœ‰äº†å®ƒï¼Œæœ¬ä¾‹ä¸­çš„ä»£ç é‡ä¹Ÿä¼šå¤§å¤§ä¸‹é™ã€‚ æ³¨ï¼šOpenHGNN æ˜¯ç”±åŒ—é‚® GAMMA Lab å¼€å‘çš„åŸºäº PyTorch å’Œ DGL çš„å¼€æºå¼‚è´¨å›¾ç¥ç»ç½‘ç»œå·¥å…·åŒ…ã€‚ 1.6.1.2 æ•°æ®é›†æœ¬åˆ©çš„æ•°æ®é›†æ˜¯å‰è¾¹æ–¹æ³•ä¸­å»ºç«‹åœ¨ NebulaGraph ä¸­çš„å›¾è°±ï¼Œå€ŸåŠ©äº Nebula-DGLï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è¡Œä»£ç æŠŠ NebulaGraph ä¸­çš„å›¾åŠ è½½åˆ° DGL ä¹‹ä¸­ã€‚ æ³¨ï¼š è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl ä½ å¯ä»¥ç›´æ¥ load è¿™ä¸ª .ngql æ–‡ä»¶åˆ° NebulaGraphã€‚ https://github.com/wey-gu/identity-correlation-datagen/raw/main/sample/hand_crafted/entity_resolution.ngql 1.6.1.3 æ•°æ®å¤„ç†ä¸ºäº†å°† NebulaGraph å›¾è°±è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬è¦é€šè¿‡ Nebula-DGL çš„ YAML é…ç½®æ–‡ä»¶ API æè¿°æ‰€éœ€çš„ç‚¹ã€è¾¹ç±»å‹ä»¥åŠå…³å¿ƒçš„å±æ€§ï¼ˆç‰¹å¾ï¼‰ã€‚ æˆ‘ä»¬çœ‹ä¸‹ç°åœ¨çš„å›¾ä¸­æœ‰å“ªäº›ç‚¹ã€è¾¹ç±»å‹ï¼š (root@nebula) [entity_resolution]\u003e SHOW TAGS +----------------+ | Name | +----------------+ | \"address\" | | \"device\" | | \"email\" | | \"email_handle\" | | \"ip\" | | \"phone\" | | \"user\" | +----------------+ Got 7 rows (time spent 1335/7357 us) (root@nebula) [entity_resolution]\u003e SHOW EDGES +---------------------------+ | Name | +---------------------------+ | \"has_address\" | | \"has_email\" | | \"has_email_with_handle\" | | \"has_phone\" | | \"is_similar_to\" | | \"logged_in_from\" | | \"shared_name\" | | \"shared_similar_email\" | | \"shared_similar_location\" | | \"used_device\" | | \"with_handle\" | +---------------------------+ Got 11 rows (time spent 1439/30418 us) åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘å±æ€§(ç‰¹å¾)ã€‚ nebulagraph_entity_resolution_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: entity_resolution # str or int vertex_id_type: int vertex_tags: - name: user - name: address - name: device - name: email_handle - name: ip edge_types: - name: has_email_with_handle start_vertex_tag: user end_vertex_tag: email_handle - name: is_similar_to start_vertex_tag: user end_vertex_tag: user - name: shared_similar_location start_vertex_tag: user end_vertex_tag: user - name: has_address start_vertex_tag: user end_vertex_tag: address - name: logged_in_from start_vertex_tag: user end_vertex_tag: ip - name: used_device start_vertex_tag: user end_vertex_tag: device ç„¶åï¼Œæˆ‘ä»¬åœ¨å®‰è£…å¥½ Nebula-DGL ä¹‹ååªéœ€è¦è¿™å‡ è¡Œä»£ç å°±å¯ä»¥å°† NebulaGraph ä¸­çš„è¿™å¼ å›¾æ„é€ ä¸º DGL çš„ DGLHeteroGraph å›¾å¯¹è±¡ï¼š from nebula_dgl import NebulaLoader nebula_config = { \"graph_hosts\": [ ('graphd', 9669), ('graphd1', 9669), ('graphd2', 9669) ], \"nebula_user\": \"root\", \"nebula_password\": \"nebula\", } # load feature_mapper from yaml file with open('nebulagraph_entity_resolution_dgl_mapper.yaml', 'r') as f: feature_mapper = yaml.safe_load(f) nebula_loader = NebulaLoader(nebula_config, feature_mapper) g = nebula_loader.load() g = g.to('cpu') device = torch.device('cpu') 1.6.1.4 æ¨¡å‹è®­ç»ƒå‚è€ƒ custom_link_prediction_dataset.py HDE_link_predict.py import torch as th from openhgnn import Experiment from openhgnn.dataset import AsLinkPredictionDataset, generate_random_hg from dgl import transforms as T from dgl import DGLHeteroGraph from dgl.data import DGLDataset from dgl.dataloading.negative_sampler import GlobalUniform meta_paths_dict = {'APA': [('user', 'has_email_with_handle', 'email_handle'), ('user', 'is_similar_to', 'user'), ('user', 'shared_similar_location', 'user'), ('user', 'has_address', 'address'), ('user', 'logged_in_from', 'ip'), ('user', 'used_device', 'device')]} target_link = [('user', 'is_similar_to', 'user')] target_link_r = [('user', 'is_similar_to', 'user')] class MyLPDataset(DGLDataset): def __init__(self, g): super().__init__(name='entity_resolution', force_reload=True) self.g = g def process(","date":"2022-08-14","objectID":"/identity-resolution/:1:6","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#æ•°æ®å¤„ç†"},{"categories":["Nebula Graph"],"content":" 1.6 åŸºäºå›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨è®²ä»¥ä¸Šä¸åŒçš„æ–¹æ³•ç›¸ç»“åˆçš„æ—¶å€™ï¼Œä¼šæŠŠå‰å¯¼æ–¹æ³•çš„ç»“æœä½œä¸ºå›¾ä¸Šçš„è¾¹ï¼Œè¿›è€Œä½œä¸ºåè¾¹çš„æ–¹æ³•çš„è¾“å…¥ï¼Œè€Œç›¸åŒç”¨æˆ· ID çš„è¯†åˆ«æœ¬è´¨ä¸Šå°±æ˜¯åœ¨å›¾ä¸Šå»é¢„æµ‹ç”¨æˆ·ä¹‹é—´é“¾æ¥ã€è¾¹ã€‚ åœ¨ GNN çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†æˆ‘ä»¬åœ¨æ¬ºè¯ˆæ£€æµ‹ä¸­åˆ©ç”¨åˆ°çš„èŠ‚ç‚¹åˆ†ç±»ï¼ˆå±æ€§é¢„æµ‹ï¼‰ä¹‹å¤–ï¼Œé“¾æ¥é¢„æµ‹ï¼ˆLink Predictionï¼‰ä¹Ÿæ˜¯å¦ä¸€ä¸ªå¸¸è§çš„ç®—æ³•ç›®æ ‡å’Œåº”ç”¨åœºæ™¯ã€‚è‡ªç„¶åœ°ï¼Œå¯ä»¥æƒ³åˆ°ç”¨ GNN çš„æ–¹æ³•ç»“åˆ 1. é GNN æ–¹æ³•è·å¾—çš„ã€ 2. å·²ç»æœ‰çš„äººä¸ºæ ‡æ³¨çš„é“¾æ¥ï¼Œæ¥å­¦ä¹ ã€é¢„æµ‹å›¾ä¸Šçš„ ID æ˜ å°„ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGNN çš„æ–¹æ³•åªèƒ½åˆ©ç”¨æ•°å­—å‹çš„ featureã€å±æ€§ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æŠŠéæ•°å­—å‹çš„å±æ€§åƒåœ¨åˆ†ç±»æƒ…å†µé‡Œé‚£æ ·æšä¸¾ä¸ºæ•°å€¼ï¼Œç›¸åï¼Œæˆ‘ä»¬åœ¨çœŸæ­£çš„ GNN ä¹‹å‰ï¼Œå¯ä»¥ç”¨å…¶ä»–çš„å›¾æ–¹æ³•å»å»ºç«‹åŸºäºæ‰“åˆ†ã€æˆ–è€…ç›¸ä¼¼åº¦çš„è¾¹å»ºç«‹ã€‚è¿™æ—¶å€™ï¼Œè¿™äº›å‰è¾¹çš„æ–¹æ³•æˆä¸ºäº† GNN é“¾è·¯é¢„æµ‹çš„ç‰¹å¾å·¥ç¨‹ã€‚ 1.6.1 åŸºäº GNN çš„å®æ“å’Œåœ¨ â€œåŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹â€ çš„æ¬ºè¯ˆæ£€æµ‹ç±»ä¼¼ï¼Œæˆ‘å°†ç»™å‡ºçš„ä¾‹å­ä¹Ÿæ˜¯ GNN ç»“åˆå›¾æ•°æ®åº“åšå®æ—¶é¢„æµ‹çš„ä¾‹å­ã€‚ 1.6.1.1 HDE[ICDM2021]æˆ‘ä»¬åˆ©ç”¨ Heterogeneous Graph Neural Network with Distance Encoding ç»™å‡ºçš„æ–¹æ³•æ¥åš Inductive Learning çš„å¼‚æ„ GNN ä¸Šçš„é“¾è·¯é¢„æµ‹ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªæ›´æ–¹ä¾¿çš„ GNN å·¥å…·ï¼ŒOpenHGNNï¼Œæœ‰äº†å®ƒï¼Œæœ¬ä¾‹ä¸­çš„ä»£ç é‡ä¹Ÿä¼šå¤§å¤§ä¸‹é™ã€‚ æ³¨ï¼šOpenHGNN æ˜¯ç”±åŒ—é‚® GAMMA Lab å¼€å‘çš„åŸºäº PyTorch å’Œ DGL çš„å¼€æºå¼‚è´¨å›¾ç¥ç»ç½‘ç»œå·¥å…·åŒ…ã€‚ 1.6.1.2 æ•°æ®é›†æœ¬åˆ©çš„æ•°æ®é›†æ˜¯å‰è¾¹æ–¹æ³•ä¸­å»ºç«‹åœ¨ NebulaGraph ä¸­çš„å›¾è°±ï¼Œå€ŸåŠ©äº Nebula-DGLï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è¡Œä»£ç æŠŠ NebulaGraph ä¸­çš„å›¾åŠ è½½åˆ° DGL ä¹‹ä¸­ã€‚ æ³¨ï¼š è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl ä½ å¯ä»¥ç›´æ¥ load è¿™ä¸ª .ngql æ–‡ä»¶åˆ° NebulaGraphã€‚ https://github.com/wey-gu/identity-correlation-datagen/raw/main/sample/hand_crafted/entity_resolution.ngql 1.6.1.3 æ•°æ®å¤„ç†ä¸ºäº†å°† NebulaGraph å›¾è°±è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬è¦é€šè¿‡ Nebula-DGL çš„ YAML é…ç½®æ–‡ä»¶ API æè¿°æ‰€éœ€çš„ç‚¹ã€è¾¹ç±»å‹ä»¥åŠå…³å¿ƒçš„å±æ€§ï¼ˆç‰¹å¾ï¼‰ã€‚ æˆ‘ä»¬çœ‹ä¸‹ç°åœ¨çš„å›¾ä¸­æœ‰å“ªäº›ç‚¹ã€è¾¹ç±»å‹ï¼š (root@nebula) [entity_resolution]\u003e SHOW TAGS +----------------+ | Name | +----------------+ | \"address\" | | \"device\" | | \"email\" | | \"email_handle\" | | \"ip\" | | \"phone\" | | \"user\" | +----------------+ Got 7 rows (time spent 1335/7357 us) (root@nebula) [entity_resolution]\u003e SHOW EDGES +---------------------------+ | Name | +---------------------------+ | \"has_address\" | | \"has_email\" | | \"has_email_with_handle\" | | \"has_phone\" | | \"is_similar_to\" | | \"logged_in_from\" | | \"shared_name\" | | \"shared_similar_email\" | | \"shared_similar_location\" | | \"used_device\" | | \"with_handle\" | +---------------------------+ Got 11 rows (time spent 1439/30418 us) åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘å±æ€§(ç‰¹å¾)ã€‚ nebulagraph_entity_resolution_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: entity_resolution # str or int vertex_id_type: int vertex_tags: - name: user - name: address - name: device - name: email_handle - name: ip edge_types: - name: has_email_with_handle start_vertex_tag: user end_vertex_tag: email_handle - name: is_similar_to start_vertex_tag: user end_vertex_tag: user - name: shared_similar_location start_vertex_tag: user end_vertex_tag: user - name: has_address start_vertex_tag: user end_vertex_tag: address - name: logged_in_from start_vertex_tag: user end_vertex_tag: ip - name: used_device start_vertex_tag: user end_vertex_tag: device ç„¶åï¼Œæˆ‘ä»¬åœ¨å®‰è£…å¥½ Nebula-DGL ä¹‹ååªéœ€è¦è¿™å‡ è¡Œä»£ç å°±å¯ä»¥å°† NebulaGraph ä¸­çš„è¿™å¼ å›¾æ„é€ ä¸º DGL çš„ DGLHeteroGraph å›¾å¯¹è±¡ï¼š from nebula_dgl import NebulaLoader nebula_config = { \"graph_hosts\": [ ('graphd', 9669), ('graphd1', 9669), ('graphd2', 9669) ], \"nebula_user\": \"root\", \"nebula_password\": \"nebula\", } # load feature_mapper from yaml file with open('nebulagraph_entity_resolution_dgl_mapper.yaml', 'r') as f: feature_mapper = yaml.safe_load(f) nebula_loader = NebulaLoader(nebula_config, feature_mapper) g = nebula_loader.load() g = g.to('cpu') device = torch.device('cpu') 1.6.1.4 æ¨¡å‹è®­ç»ƒå‚è€ƒ custom_link_prediction_dataset.py HDE_link_predict.py import torch as th from openhgnn import Experiment from openhgnn.dataset import AsLinkPredictionDataset, generate_random_hg from dgl import transforms as T from dgl import DGLHeteroGraph from dgl.data import DGLDataset from dgl.dataloading.negative_sampler import GlobalUniform meta_paths_dict = {'APA': [('user', 'has_email_with_handle', 'email_handle'), ('user', 'is_similar_to', 'user'), ('user', 'shared_similar_location', 'user'), ('user', 'has_address', 'address'), ('user', 'logged_in_from', 'ip'), ('user', 'used_device', 'device')]} target_link = [('user', 'is_similar_to', 'user')] target_link_r = [('user', 'is_similar_to', 'user')] class MyLPDataset(DGLDataset): def __init__(self, g): super().__init__(name='entity_resolution', force_reload=True) self.g = g def process(","date":"2022-08-14","objectID":"/identity-resolution/:1:6","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#æ¨¡å‹è®­ç»ƒ"},{"categories":["Nebula Graph"],"content":" 1.6 åŸºäºå›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨è®²ä»¥ä¸Šä¸åŒçš„æ–¹æ³•ç›¸ç»“åˆçš„æ—¶å€™ï¼Œä¼šæŠŠå‰å¯¼æ–¹æ³•çš„ç»“æœä½œä¸ºå›¾ä¸Šçš„è¾¹ï¼Œè¿›è€Œä½œä¸ºåè¾¹çš„æ–¹æ³•çš„è¾“å…¥ï¼Œè€Œç›¸åŒç”¨æˆ· ID çš„è¯†åˆ«æœ¬è´¨ä¸Šå°±æ˜¯åœ¨å›¾ä¸Šå»é¢„æµ‹ç”¨æˆ·ä¹‹é—´é“¾æ¥ã€è¾¹ã€‚ åœ¨ GNN çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†æˆ‘ä»¬åœ¨æ¬ºè¯ˆæ£€æµ‹ä¸­åˆ©ç”¨åˆ°çš„èŠ‚ç‚¹åˆ†ç±»ï¼ˆå±æ€§é¢„æµ‹ï¼‰ä¹‹å¤–ï¼Œé“¾æ¥é¢„æµ‹ï¼ˆLink Predictionï¼‰ä¹Ÿæ˜¯å¦ä¸€ä¸ªå¸¸è§çš„ç®—æ³•ç›®æ ‡å’Œåº”ç”¨åœºæ™¯ã€‚è‡ªç„¶åœ°ï¼Œå¯ä»¥æƒ³åˆ°ç”¨ GNN çš„æ–¹æ³•ç»“åˆ 1. é GNN æ–¹æ³•è·å¾—çš„ã€ 2. å·²ç»æœ‰çš„äººä¸ºæ ‡æ³¨çš„é“¾æ¥ï¼Œæ¥å­¦ä¹ ã€é¢„æµ‹å›¾ä¸Šçš„ ID æ˜ å°„ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGNN çš„æ–¹æ³•åªèƒ½åˆ©ç”¨æ•°å­—å‹çš„ featureã€å±æ€§ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æŠŠéæ•°å­—å‹çš„å±æ€§åƒåœ¨åˆ†ç±»æƒ…å†µé‡Œé‚£æ ·æšä¸¾ä¸ºæ•°å€¼ï¼Œç›¸åï¼Œæˆ‘ä»¬åœ¨çœŸæ­£çš„ GNN ä¹‹å‰ï¼Œå¯ä»¥ç”¨å…¶ä»–çš„å›¾æ–¹æ³•å»å»ºç«‹åŸºäºæ‰“åˆ†ã€æˆ–è€…ç›¸ä¼¼åº¦çš„è¾¹å»ºç«‹ã€‚è¿™æ—¶å€™ï¼Œè¿™äº›å‰è¾¹çš„æ–¹æ³•æˆä¸ºäº† GNN é“¾è·¯é¢„æµ‹çš„ç‰¹å¾å·¥ç¨‹ã€‚ 1.6.1 åŸºäº GNN çš„å®æ“å’Œåœ¨ â€œåŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹â€ çš„æ¬ºè¯ˆæ£€æµ‹ç±»ä¼¼ï¼Œæˆ‘å°†ç»™å‡ºçš„ä¾‹å­ä¹Ÿæ˜¯ GNN ç»“åˆå›¾æ•°æ®åº“åšå®æ—¶é¢„æµ‹çš„ä¾‹å­ã€‚ 1.6.1.1 HDE[ICDM2021]æˆ‘ä»¬åˆ©ç”¨ Heterogeneous Graph Neural Network with Distance Encoding ç»™å‡ºçš„æ–¹æ³•æ¥åš Inductive Learning çš„å¼‚æ„ GNN ä¸Šçš„é“¾è·¯é¢„æµ‹ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªæ›´æ–¹ä¾¿çš„ GNN å·¥å…·ï¼ŒOpenHGNNï¼Œæœ‰äº†å®ƒï¼Œæœ¬ä¾‹ä¸­çš„ä»£ç é‡ä¹Ÿä¼šå¤§å¤§ä¸‹é™ã€‚ æ³¨ï¼šOpenHGNN æ˜¯ç”±åŒ—é‚® GAMMA Lab å¼€å‘çš„åŸºäº PyTorch å’Œ DGL çš„å¼€æºå¼‚è´¨å›¾ç¥ç»ç½‘ç»œå·¥å…·åŒ…ã€‚ 1.6.1.2 æ•°æ®é›†æœ¬åˆ©çš„æ•°æ®é›†æ˜¯å‰è¾¹æ–¹æ³•ä¸­å»ºç«‹åœ¨ NebulaGraph ä¸­çš„å›¾è°±ï¼Œå€ŸåŠ©äº Nebula-DGLï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è¡Œä»£ç æŠŠ NebulaGraph ä¸­çš„å›¾åŠ è½½åˆ° DGL ä¹‹ä¸­ã€‚ æ³¨ï¼š è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl ä½ å¯ä»¥ç›´æ¥ load è¿™ä¸ª .ngql æ–‡ä»¶åˆ° NebulaGraphã€‚ https://github.com/wey-gu/identity-correlation-datagen/raw/main/sample/hand_crafted/entity_resolution.ngql 1.6.1.3 æ•°æ®å¤„ç†ä¸ºäº†å°† NebulaGraph å›¾è°±è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬è¦é€šè¿‡ Nebula-DGL çš„ YAML é…ç½®æ–‡ä»¶ API æè¿°æ‰€éœ€çš„ç‚¹ã€è¾¹ç±»å‹ä»¥åŠå…³å¿ƒçš„å±æ€§ï¼ˆç‰¹å¾ï¼‰ã€‚ æˆ‘ä»¬çœ‹ä¸‹ç°åœ¨çš„å›¾ä¸­æœ‰å“ªäº›ç‚¹ã€è¾¹ç±»å‹ï¼š (root@nebula) [entity_resolution]\u003e SHOW TAGS +----------------+ | Name | +----------------+ | \"address\" | | \"device\" | | \"email\" | | \"email_handle\" | | \"ip\" | | \"phone\" | | \"user\" | +----------------+ Got 7 rows (time spent 1335/7357 us) (root@nebula) [entity_resolution]\u003e SHOW EDGES +---------------------------+ | Name | +---------------------------+ | \"has_address\" | | \"has_email\" | | \"has_email_with_handle\" | | \"has_phone\" | | \"is_similar_to\" | | \"logged_in_from\" | | \"shared_name\" | | \"shared_similar_email\" | | \"shared_similar_location\" | | \"used_device\" | | \"with_handle\" | +---------------------------+ Got 11 rows (time spent 1439/30418 us) åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘å±æ€§(ç‰¹å¾)ã€‚ nebulagraph_entity_resolution_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: entity_resolution # str or int vertex_id_type: int vertex_tags: - name: user - name: address - name: device - name: email_handle - name: ip edge_types: - name: has_email_with_handle start_vertex_tag: user end_vertex_tag: email_handle - name: is_similar_to start_vertex_tag: user end_vertex_tag: user - name: shared_similar_location start_vertex_tag: user end_vertex_tag: user - name: has_address start_vertex_tag: user end_vertex_tag: address - name: logged_in_from start_vertex_tag: user end_vertex_tag: ip - name: used_device start_vertex_tag: user end_vertex_tag: device ç„¶åï¼Œæˆ‘ä»¬åœ¨å®‰è£…å¥½ Nebula-DGL ä¹‹ååªéœ€è¦è¿™å‡ è¡Œä»£ç å°±å¯ä»¥å°† NebulaGraph ä¸­çš„è¿™å¼ å›¾æ„é€ ä¸º DGL çš„ DGLHeteroGraph å›¾å¯¹è±¡ï¼š from nebula_dgl import NebulaLoader nebula_config = { \"graph_hosts\": [ ('graphd', 9669), ('graphd1', 9669), ('graphd2', 9669) ], \"nebula_user\": \"root\", \"nebula_password\": \"nebula\", } # load feature_mapper from yaml file with open('nebulagraph_entity_resolution_dgl_mapper.yaml', 'r') as f: feature_mapper = yaml.safe_load(f) nebula_loader = NebulaLoader(nebula_config, feature_mapper) g = nebula_loader.load() g = g.to('cpu') device = torch.device('cpu') 1.6.1.4 æ¨¡å‹è®­ç»ƒå‚è€ƒ custom_link_prediction_dataset.py HDE_link_predict.py import torch as th from openhgnn import Experiment from openhgnn.dataset import AsLinkPredictionDataset, generate_random_hg from dgl import transforms as T from dgl import DGLHeteroGraph from dgl.data import DGLDataset from dgl.dataloading.negative_sampler import GlobalUniform meta_paths_dict = {'APA': [('user', 'has_email_with_handle', 'email_handle'), ('user', 'is_similar_to', 'user'), ('user', 'shared_similar_location', 'user'), ('user', 'has_address', 'address'), ('user', 'logged_in_from', 'ip'), ('user', 'used_device', 'device')]} target_link = [('user', 'is_similar_to', 'user')] target_link_r = [('user', 'is_similar_to', 'user')] class MyLPDataset(DGLDataset): def __init__(self, g): super().__init__(name='entity_resolution', force_reload=True) self.g = g def process(","date":"2022-08-14","objectID":"/identity-resolution/:1:6","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#ä¿å­˜æ¨¡å‹"},{"categories":["Nebula Graph"],"content":" 1.6 åŸºäºå›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨è®²ä»¥ä¸Šä¸åŒçš„æ–¹æ³•ç›¸ç»“åˆçš„æ—¶å€™ï¼Œä¼šæŠŠå‰å¯¼æ–¹æ³•çš„ç»“æœä½œä¸ºå›¾ä¸Šçš„è¾¹ï¼Œè¿›è€Œä½œä¸ºåè¾¹çš„æ–¹æ³•çš„è¾“å…¥ï¼Œè€Œç›¸åŒç”¨æˆ· ID çš„è¯†åˆ«æœ¬è´¨ä¸Šå°±æ˜¯åœ¨å›¾ä¸Šå»é¢„æµ‹ç”¨æˆ·ä¹‹é—´é“¾æ¥ã€è¾¹ã€‚ åœ¨ GNN çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†æˆ‘ä»¬åœ¨æ¬ºè¯ˆæ£€æµ‹ä¸­åˆ©ç”¨åˆ°çš„èŠ‚ç‚¹åˆ†ç±»ï¼ˆå±æ€§é¢„æµ‹ï¼‰ä¹‹å¤–ï¼Œé“¾æ¥é¢„æµ‹ï¼ˆLink Predictionï¼‰ä¹Ÿæ˜¯å¦ä¸€ä¸ªå¸¸è§çš„ç®—æ³•ç›®æ ‡å’Œåº”ç”¨åœºæ™¯ã€‚è‡ªç„¶åœ°ï¼Œå¯ä»¥æƒ³åˆ°ç”¨ GNN çš„æ–¹æ³•ç»“åˆ 1. é GNN æ–¹æ³•è·å¾—çš„ã€ 2. å·²ç»æœ‰çš„äººä¸ºæ ‡æ³¨çš„é“¾æ¥ï¼Œæ¥å­¦ä¹ ã€é¢„æµ‹å›¾ä¸Šçš„ ID æ˜ å°„ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGNN çš„æ–¹æ³•åªèƒ½åˆ©ç”¨æ•°å­—å‹çš„ featureã€å±æ€§ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æŠŠéæ•°å­—å‹çš„å±æ€§åƒåœ¨åˆ†ç±»æƒ…å†µé‡Œé‚£æ ·æšä¸¾ä¸ºæ•°å€¼ï¼Œç›¸åï¼Œæˆ‘ä»¬åœ¨çœŸæ­£çš„ GNN ä¹‹å‰ï¼Œå¯ä»¥ç”¨å…¶ä»–çš„å›¾æ–¹æ³•å»å»ºç«‹åŸºäºæ‰“åˆ†ã€æˆ–è€…ç›¸ä¼¼åº¦çš„è¾¹å»ºç«‹ã€‚è¿™æ—¶å€™ï¼Œè¿™äº›å‰è¾¹çš„æ–¹æ³•æˆä¸ºäº† GNN é“¾è·¯é¢„æµ‹çš„ç‰¹å¾å·¥ç¨‹ã€‚ 1.6.1 åŸºäº GNN çš„å®æ“å’Œåœ¨ â€œåŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹â€ çš„æ¬ºè¯ˆæ£€æµ‹ç±»ä¼¼ï¼Œæˆ‘å°†ç»™å‡ºçš„ä¾‹å­ä¹Ÿæ˜¯ GNN ç»“åˆå›¾æ•°æ®åº“åšå®æ—¶é¢„æµ‹çš„ä¾‹å­ã€‚ 1.6.1.1 HDE[ICDM2021]æˆ‘ä»¬åˆ©ç”¨ Heterogeneous Graph Neural Network with Distance Encoding ç»™å‡ºçš„æ–¹æ³•æ¥åš Inductive Learning çš„å¼‚æ„ GNN ä¸Šçš„é“¾è·¯é¢„æµ‹ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªæ›´æ–¹ä¾¿çš„ GNN å·¥å…·ï¼ŒOpenHGNNï¼Œæœ‰äº†å®ƒï¼Œæœ¬ä¾‹ä¸­çš„ä»£ç é‡ä¹Ÿä¼šå¤§å¤§ä¸‹é™ã€‚ æ³¨ï¼šOpenHGNN æ˜¯ç”±åŒ—é‚® GAMMA Lab å¼€å‘çš„åŸºäº PyTorch å’Œ DGL çš„å¼€æºå¼‚è´¨å›¾ç¥ç»ç½‘ç»œå·¥å…·åŒ…ã€‚ 1.6.1.2 æ•°æ®é›†æœ¬åˆ©çš„æ•°æ®é›†æ˜¯å‰è¾¹æ–¹æ³•ä¸­å»ºç«‹åœ¨ NebulaGraph ä¸­çš„å›¾è°±ï¼Œå€ŸåŠ©äº Nebula-DGLï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è¡Œä»£ç æŠŠ NebulaGraph ä¸­çš„å›¾åŠ è½½åˆ° DGL ä¹‹ä¸­ã€‚ æ³¨ï¼š è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl ä½ å¯ä»¥ç›´æ¥ load è¿™ä¸ª .ngql æ–‡ä»¶åˆ° NebulaGraphã€‚ https://github.com/wey-gu/identity-correlation-datagen/raw/main/sample/hand_crafted/entity_resolution.ngql 1.6.1.3 æ•°æ®å¤„ç†ä¸ºäº†å°† NebulaGraph å›¾è°±è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬è¦é€šè¿‡ Nebula-DGL çš„ YAML é…ç½®æ–‡ä»¶ API æè¿°æ‰€éœ€çš„ç‚¹ã€è¾¹ç±»å‹ä»¥åŠå…³å¿ƒçš„å±æ€§ï¼ˆç‰¹å¾ï¼‰ã€‚ æˆ‘ä»¬çœ‹ä¸‹ç°åœ¨çš„å›¾ä¸­æœ‰å“ªäº›ç‚¹ã€è¾¹ç±»å‹ï¼š (root@nebula) [entity_resolution]\u003e SHOW TAGS +----------------+ | Name | +----------------+ | \"address\" | | \"device\" | | \"email\" | | \"email_handle\" | | \"ip\" | | \"phone\" | | \"user\" | +----------------+ Got 7 rows (time spent 1335/7357 us) (root@nebula) [entity_resolution]\u003e SHOW EDGES +---------------------------+ | Name | +---------------------------+ | \"has_address\" | | \"has_email\" | | \"has_email_with_handle\" | | \"has_phone\" | | \"is_similar_to\" | | \"logged_in_from\" | | \"shared_name\" | | \"shared_similar_email\" | | \"shared_similar_location\" | | \"used_device\" | | \"with_handle\" | +---------------------------+ Got 11 rows (time spent 1439/30418 us) åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘å±æ€§(ç‰¹å¾)ã€‚ nebulagraph_entity_resolution_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: entity_resolution # str or int vertex_id_type: int vertex_tags: - name: user - name: address - name: device - name: email_handle - name: ip edge_types: - name: has_email_with_handle start_vertex_tag: user end_vertex_tag: email_handle - name: is_similar_to start_vertex_tag: user end_vertex_tag: user - name: shared_similar_location start_vertex_tag: user end_vertex_tag: user - name: has_address start_vertex_tag: user end_vertex_tag: address - name: logged_in_from start_vertex_tag: user end_vertex_tag: ip - name: used_device start_vertex_tag: user end_vertex_tag: device ç„¶åï¼Œæˆ‘ä»¬åœ¨å®‰è£…å¥½ Nebula-DGL ä¹‹ååªéœ€è¦è¿™å‡ è¡Œä»£ç å°±å¯ä»¥å°† NebulaGraph ä¸­çš„è¿™å¼ å›¾æ„é€ ä¸º DGL çš„ DGLHeteroGraph å›¾å¯¹è±¡ï¼š from nebula_dgl import NebulaLoader nebula_config = { \"graph_hosts\": [ ('graphd', 9669), ('graphd1', 9669), ('graphd2', 9669) ], \"nebula_user\": \"root\", \"nebula_password\": \"nebula\", } # load feature_mapper from yaml file with open('nebulagraph_entity_resolution_dgl_mapper.yaml', 'r') as f: feature_mapper = yaml.safe_load(f) nebula_loader = NebulaLoader(nebula_config, feature_mapper) g = nebula_loader.load() g = g.to('cpu') device = torch.device('cpu') 1.6.1.4 æ¨¡å‹è®­ç»ƒå‚è€ƒ custom_link_prediction_dataset.py HDE_link_predict.py import torch as th from openhgnn import Experiment from openhgnn.dataset import AsLinkPredictionDataset, generate_random_hg from dgl import transforms as T from dgl import DGLHeteroGraph from dgl.data import DGLDataset from dgl.dataloading.negative_sampler import GlobalUniform meta_paths_dict = {'APA': [('user', 'has_email_with_handle', 'email_handle'), ('user', 'is_similar_to', 'user'), ('user', 'shared_similar_location', 'user'), ('user', 'has_address', 'address'), ('user', 'logged_in_from', 'ip'), ('user', 'used_device', 'device')]} target_link = [('user', 'is_similar_to', 'user')] target_link_r = [('user', 'is_similar_to', 'user')] class MyLPDataset(DGLDataset): def __init__(self, g): super().__init__(name='entity_resolution', force_reload=True) self.g = g def process(","date":"2022-08-14","objectID":"/identity-resolution/:1:6","series":null,"tags":["Nebula Graph","ID-Mapping","GNN","Entity-Linking","ç”¨æˆ·360","DGL"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„ ID Resolution æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/identity-resolution/#åº”ç”¨è½åœ°"},{"categories":["Nebula Graph"],"content":"æœ¬æ–‡æ˜¯ä¸€ä¸ªåŸºäº NebulaGraph ä¸Šçš„å›¾ç®—æ³•ã€å›¾æ•°æ®åº“ã€æœºå™¨å­¦ä¹ ã€å›¾ç¥ç»ç½‘ç»œçš„ Fraud Detection æ–¹æ³•ç»¼è¿°ï¼Œé™¤äº†åŸºæœ¬æ–¹æ³•æ€æƒ³çš„ä»‹ç»ä¹‹å¤–ï¼Œæˆ‘è¿˜ç»™å¤§å®¶å¼„äº†å¯ä»¥è·‘çš„ Playgroundã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™è¿˜æˆ‘ç¬¬ä¸€æ¬¡ç»™å¤§å®¶ä»‹ç» Nebula-DGL è¿™ä¸ªé¡¹ç›® ğŸ˜ã€‚","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/"},{"categories":["Nebula Graph"],"content":" æœ¬æ–‡æ˜¯ä¸€ä¸ªåŸºäº NebulaGraph ä¸Šå›¾ç®—æ³•ã€å›¾æ•°æ®åº“ã€æœºå™¨å­¦ä¹ ã€GNN çš„ Fraud Detection æ–¹æ³•ç»¼è¿°ï¼Œé™¤äº†åŸºæœ¬æ–¹æ³•æ€æƒ³çš„ä»‹ç»ä¹‹å¤–ï¼Œæˆ‘è¿˜ç»™å¤§å®¶å¼„äº†å¯ä»¥è·‘çš„ Playgroundã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™è¿˜æˆ‘ç¬¬ä¸€æ¬¡ç»™å¤§å®¶ä»‹ç» Nebula-DGL è¿™ä¸ªé¡¹ç›® ğŸ˜ã€‚ ","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:0:0","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#"},{"categories":["Nebula Graph"],"content":" 1 åŸºäºå›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:0","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#åŸºäºå›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.1 å»ºç«‹å›¾è°±é¦–å…ˆï¼Œå¯¹ç°æœ‰çš„å†å²æ•°æ®ã€æ ‡æ³¨ä¿¡æ¯é¢å‘å…³è”å…³ç³»è¿›è¡Œå±æ€§å›¾å»ºæ¨¡ã€‚è¿™ç§åŸå§‹æ•°æ®æ˜¯å¤šä¸ªè¡¨ç»“æ„ä¸­çš„é“¶è¡Œã€ç”µå­å•†åŠ¡æˆ–è€…ä¿é™©è¡Œä¸šé‡Œçš„äº¤æ˜“äº‹ä»¶è®°å½•ã€ç”¨æˆ·æ•°æ®å’Œé£æ§æ ‡æ³¨ï¼Œè€Œå»ºæ¨¡è¿‡ç¨‹å°±æ˜¯æŠ½è±¡å‡ºæˆ‘ä»¬å…³å¿ƒçš„å®ä½“ã€å®ä½“é—´çš„å…³è”å…³ç³»ã€å’Œå…¶ä¸­æœ‰æ„ä¹‰çš„å±æ€§ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œè‡ªç„¶äººã€å…¬å¸å®ä½“ã€ç”µè¯å·ç ã€åœ°å€ã€è®¾å¤‡ï¼ˆæ¯”å¦‚ç»ˆç«¯è®¾å¤‡ã€ç½‘ç»œåœ°å€ã€ç»ˆç«¯è®¾å¤‡æ‰€è¿æ¥çš„ WiFi SSID ç­‰ï¼‰ã€è®¢å•éƒ½æ˜¯å®ä½“æœ¬èº«ï¼Œå…¶ä»–ä¿¡æ¯æ¯”å¦‚é£é™©æ ‡æ³¨ï¼ˆæ˜¯å¦é«˜é£é™©ã€é£é™©æè¿°ç­‰ï¼‰ã€è‡ªç„¶äººå’Œå…¬å¸å®ä½“çš„ä¿¡æ¯ï¼ˆèŒä¸šã€æ”¶å…¥ã€å­¦å†ç­‰ï¼‰éƒ½ä½œä¸ºå®ä½“çš„å±æ€§æ¥å»ºæ¨¡ã€‚ ä¸‹å›¾æ˜¯ä¸€ä¸ªå¯ä»¥å‚è€ƒçš„è´·æ¬¾åæ¬ºè¯ˆçš„ç¤ºä¾‹å»ºæ¨¡ï¼Œå®ƒæ¥è‡ªä¸€ä»½ä½œè€…å¼€æºçš„å›¾ç»“æ„æ•°æ®ç”Ÿæˆé¡¹ç›®ã€‚ æ³¨ï¼Œä½ å¯ä»¥è®¿é—® https://github.com/wey-gu/fraud-detection-datagen è·å–è¿™ä¸ªå¼€æºçš„æ•°æ®ç”Ÿæˆå™¨ä»£ç å’Œä¸€ä»½ç¤ºä¾‹çš„æ•°æ®ã€‚ ","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:1","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#å»ºç«‹å›¾è°±"},{"categories":["Nebula Graph"],"content":" 1.2 å›¾æ•°æ®åº“æŸ¥è¯¢è¯†åˆ«é£é™©æœ‰äº†ä¸€å¼ å›Šæ‹¬äº†äººã€å…¬å¸ã€å†å²è´·æ¬¾ç”³è¯·è®°å½•ã€ç”µè¯ã€çº¿ä¸Šç”³è¯·ç½‘ç»œè®¾å¤‡çš„å›¾è°±ï¼Œæˆ‘ä»¬å¯ä»¥æŒ–æ˜ä¸€äº›æœ‰æ„æ€çš„ä¿¡æ¯ã€‚ äº‹å®ä¸Šï¼Œå¾ˆå¤šå€¼å¾—è¢«å‘ç°ã€å¹¶æœ‰æ•ˆé˜»æ­¢ä»è€Œæ­¢æŸçš„éª—ä¿è¡Œä¸ºæ˜¯å…·æœ‰ç¾¤ä½“èšé›†æ€§çš„ã€‚æ¯”å¦‚æ¬ºè¯ˆå›¢ä¼™å¯èƒ½æ˜¯ä¸€å°æ‰¹äººï¼ˆæ¯”å¦‚3åˆ°5äººï¼‰æœ‰ç»„ç»‡åœ°æ”¶é›†æ›´å¤§è§„æ¨¡çš„èº«ä»½è¯ä¿¡æ¯ï¼ˆæ¯”å¦‚30å¼ ï¼‰ï¼ŒåŒæ—¶å‘èµ·å¤šä¸ªé‡‘èæœºæ„å¤§é‡è´·æ¬¾ï¼Œç„¶ååœ¨æ”¾æ¬¾åé€‰æ‹©ä¸¢å¼ƒè¿™æ‰¹ç•™ä¸‹äº†è¿çº¦è®°å½•çš„èº«ä»½è¯ï¼Œå†è¿›ä¸€æ­¥é€‰æ‹©ä¸‹ä¸€æ‰¹èº«ä»½è¯ä¿¡æ¯å¦‚æ³•ç‚®åˆ¶ã€‚ è¿™ç§å›¢ä¼™ä½œæ¡ˆçš„æ–¹å¼å› ä¸ºåˆ©ç”¨äº†å¤§é‡æ–°çš„èº«ä»½ä¿¡æ¯ï¼Œå®Œå…¨åˆ©ç”¨å†å²è®°å½•å»é»‘åå•è§„é¿é£é™©çš„æ–¹å¼æ˜¯æ— æ•ˆçš„ã€‚ä¸è¿‡ï¼Œå€ŸåŠ©äºå…³è”å…³ç³»çš„è§†è§’ï¼Œè¿™äº›æ¨¡å¼æ˜¯ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥è¢«åŠæ—¶è¯†åˆ«å‡ºæ¥çš„ã€‚ è¿™äº›å¯ä»¥è¢«è¯†åˆ«å‡ºçš„è§„å¾‹æˆ‘æŠŠå®ƒåˆ†æˆä¸¤ç§ï¼š ä¸€ç§æ˜¯é£æ§ä¸“å®¶å¯ä»¥ç›´æ¥ç”¨æŸç§æ¨¡å¼æ¥æè¿°çš„ï¼Œä¾‹å¦‚ï¼šå’Œå·²ç»è¢«æ ‡æ³¨ä¸ºé«˜é£é™©çš„å®ä½“æœ‰ç›´æ¥æˆ–è€…é—´æ¥çš„å…³è”å…³ç³»ï¼ˆæ–°è®¢å•ç”³è¯·äººä½¿ç”¨äº†å’Œè¿‡å¾€é«˜é£é™©è®°å½•ç›¸åŒçš„ç½‘ç»œè®¾å¤‡ï¼‰ï¼Œè¿™ç§æ¨¡å¼å¯¹åº”åˆ°å›¾è°±ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªå›¾æŸ¥è¯¢å°±å¯ä»¥å®æ—¶ç»™å‡ºç»“æœã€‚ å¦ä¸€ç§æ˜¯éšå«åœ¨æ•°æ®çš„å…³è”å…³ç³»èƒŒåï¼Œéœ€è¦é€šè¿‡å›¾ç®—æ³•æŒ–æ˜å¾—å‡ºçš„ä¸€äº›é£é™©æç¤ºï¼Œä¾‹å¦‚ï¼šå°½ç®¡ç»™å®šçš„å®ä½“ä¸æœ‰é™çš„æ ‡æ³¨é«˜é£é™©å®ä½“æ²¡æœ‰åŒ¹é…çš„å…³è”ï¼Œä½†æ˜¯å®ƒåœ¨å›¾ä¸­å½¢æˆäº†èšé›†æ€§å¯èƒ½æç¤ºæˆ‘ä»¬è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå°šæœªå¾—æ‰‹çš„è¿›è¡Œä¸­çš„å›¢ä¼™è´·æ¬¾è¯ˆéª—çš„å…¶ä¸­ä¸€æ¬¡ç”³è¯·ï¼Œè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡å®šæœŸåœ¨å†å²æ•°æ®ä¸­æ‰¹é‡æ‰§è¡Œç¤¾åŒºå‘ç°ç®—æ³•å¾—å‡ºï¼Œå¹¶åœ¨é«˜èšé›†ç¤¾åŒºä¸­åˆ©ç”¨ä¸­å¿ƒæ€§ç®—æ³•ç»™å‡ºæ ¸å¿ƒå®ä½“ï¼Œä¸€å¹¶æç¤ºç»™é£é™©ä¸“å®¶è¿›è¡Œåç»­è¯„ä¼°å’Œé£é™©æ ‡æ³¨ã€‚ 1.2.1 åŸºäºå›¾è°±ä¸ä¸“å®¶å›¾æ¨¡å¼åŒ¹é…çš„æ¬ºè¯ˆæ£€æµ‹ç¤ºä¾‹åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬åˆ©ç”¨ Nebula-UP æ¥ä¸€é”®éƒ¨ç½²ä¸€å¥— NebulaGraph å›¾æ•°æ®åº“ï¼š æ›´å¤šè¯·å‚è€ƒ https://github.com/wey-gu/nebula-up/ curl -fsSL nebula-up.siwei.io/install.sh | bash é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠå‰è¾¹å»ºæ¨¡çš„å›¾è°±åŠ è½½åˆ° NebulaGraph é‡Œï¼š # å…‹éš†æ•°æ®é›†ä»£ç ä»“åº“ git clone https://github.com/wey-gu/fraud-detection-datagen.git cp -r data_sample_numerical_vertex_id data # å»æ‰è¡¨å¤´ sed -i '1d' data/*.csv docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/data/:/data \\ vesoft/nebula-importer:v3.1.0 \\ --config /root/nebula_graph_importer.yaml æœ‰äº†è¿™æ ·ä¸€ä¸ªå›¾è°±ï¼Œé£æ§ä¸“å®¶å¯ä»¥åœ¨å¯è§†åŒ–æ¢ç´¢å·¥å…·ä¸­æŒ‰éœ€æ¢ç´¢å®ä½“ä¹‹é—´çš„å…³ç³»ï¼Œç»˜åˆ¶ç›¸åº”çš„é£é™©æ¨¡å¼ï¼š åœ¨è¿™ä¸ªæ¢ç´¢æˆªå›¾é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ˜æ˜¾çœ‹åˆ°ä¸€ä¸ªç¾¤æ§è®¾å¤‡çš„é£é™©æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼å¯ä»¥è¢«äº¤ç»™å›¾æ•°æ®åº“å¼€å‘è€…ï¼ŒæŠ½è±¡æˆå¯ä»¥è¢«é£æ§åº”ç”¨å®šæœŸã€å®æ—¶æŸ¥è¯¢çš„è¯­å¥ï¼š ## é’ˆå¯¹ä¸€ç¬”äº¤æ˜“ç”³è¯·å…³è”æŸ¥è¯¢ MATCH (n) WHERE id(n) == \"200000010265\" OPTIONAL MATCH p_shared_d=(n)-[:`used_device`]-\u003e(d)\u003c-[:`used_device`]-(:`applicant`)-[:`with_phone_num`]-\u003e(pn:phone_num)\u003c-[e:`with_phone_num`]-(:`applicant`) RETURN p_shared_d æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ¨æ­¤æ¨¡å‹ä¹‹ä¸Šï¼Œé€šè¿‡ä¿®æ”¹è¿”å›çš„å…³è”è®¾å¤‡è®¡æ•°ï¼Œä½œä¸ºæ„å‘æŒ‡æ ‡æŸ¥è¯¢çš„åˆ¤æ–­ APIï¼š ## ç¾¤æ§æŒ‡æ ‡ MATCH (n) WHERE id(n) == \"200000010265\" OPTIONAL MATCH p_shared_d=(n)-[:`used_device`]-\u003e(d)\u003c-[:`used_device`]-(:`applicant`)-[:`with_phone_num`]-\u003e(pn:phone_num)\u003c-[e:`with_phone_num`]-(:`applicant`) RETURN count(e) å¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªç›¸å¯¹æœ‰æ•ˆçš„é£æ§ç³»ç»Ÿï¼Œåˆ©ç”¨æœ‰é™çš„æ ‡æ³¨æ•°æ®å’Œä¸“å®¶èµ„æºï¼Œå»æ›´é«˜æ•ˆæ§åˆ¶å›¢ä¼™æ¬ºè¯ˆä½œæ¡ˆé£é™©ã€‚ å¦ä¸€ä¸ªåˆ©ç”¨æ ‡æ³¨é£é™©èŠ‚ç‚¹çš„æŸ¥è¯¢æ˜¯æ‰¾åˆ°ç›¸å…³è”èŠ‚ç‚¹é«˜é£é™©å±æ€§çš„æ•°é‡ï¼š MATCH p_=(p:`applicant`)-[*1..2]-(p2:`applicant`) WHERE id(p)==\"200000014810\" AND p2.`applicant`.is_risky == \"True\" RETURN p_ LIMIT 100 å¯ä»¥ä»è¿™ä¸ªè·¯å¾„æŸ¥è¯¢çœ‹åˆ° 200000014810 çš„ç›¸è¿æ¥çš„ç”³è¯·äººä¸­æœ‰ä¸å°‘æ˜¯é«˜é£é™©çš„ï¼ˆä¹Ÿèƒ½çœ‹å‡ºèšé›†çš„ deviceï¼‰ã€‚ å¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ç›¸è¿é«˜é£é™©ç‚¹æ•°é‡ä¸ºä¸€ä¸ªæŒ‡æ ‡ï¼š MATCH (p:`applicant`)-[*1..2]-(p2:`applicant`) WHERE id(p)==\"200000014810\" AND p2.`applicant`.is_risky == \"True\" RETURN count(p2) ç„¶è€Œï¼Œåœ¨ç°å®æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„å¤§å¤šæ•°æ ‡æ³¨æ•°æ®çš„è·å–è¿˜æ˜¯è¿‡äºæ˜‚è´µï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•æ˜¯æ›´æœ‰æ•ˆåˆ©ç”¨æœ‰é™çš„é£é™©æ ‡æ³¨å’Œå›¾ç»“æ„ï¼Œæ¥é¢„æµ‹å‡ºé£é™©å‘¢ï¼Ÿ ","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:2","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#å›¾æ•°æ®åº“æŸ¥è¯¢è¯†åˆ«é£é™©"},{"categories":["Nebula Graph"],"content":" 1.2 å›¾æ•°æ®åº“æŸ¥è¯¢è¯†åˆ«é£é™©æœ‰äº†ä¸€å¼ å›Šæ‹¬äº†äººã€å…¬å¸ã€å†å²è´·æ¬¾ç”³è¯·è®°å½•ã€ç”µè¯ã€çº¿ä¸Šç”³è¯·ç½‘ç»œè®¾å¤‡çš„å›¾è°±ï¼Œæˆ‘ä»¬å¯ä»¥æŒ–æ˜ä¸€äº›æœ‰æ„æ€çš„ä¿¡æ¯ã€‚ äº‹å®ä¸Šï¼Œå¾ˆå¤šå€¼å¾—è¢«å‘ç°ã€å¹¶æœ‰æ•ˆé˜»æ­¢ä»è€Œæ­¢æŸçš„éª—ä¿è¡Œä¸ºæ˜¯å…·æœ‰ç¾¤ä½“èšé›†æ€§çš„ã€‚æ¯”å¦‚æ¬ºè¯ˆå›¢ä¼™å¯èƒ½æ˜¯ä¸€å°æ‰¹äººï¼ˆæ¯”å¦‚3åˆ°5äººï¼‰æœ‰ç»„ç»‡åœ°æ”¶é›†æ›´å¤§è§„æ¨¡çš„èº«ä»½è¯ä¿¡æ¯ï¼ˆæ¯”å¦‚30å¼ ï¼‰ï¼ŒåŒæ—¶å‘èµ·å¤šä¸ªé‡‘èæœºæ„å¤§é‡è´·æ¬¾ï¼Œç„¶ååœ¨æ”¾æ¬¾åé€‰æ‹©ä¸¢å¼ƒè¿™æ‰¹ç•™ä¸‹äº†è¿çº¦è®°å½•çš„èº«ä»½è¯ï¼Œå†è¿›ä¸€æ­¥é€‰æ‹©ä¸‹ä¸€æ‰¹èº«ä»½è¯ä¿¡æ¯å¦‚æ³•ç‚®åˆ¶ã€‚ è¿™ç§å›¢ä¼™ä½œæ¡ˆçš„æ–¹å¼å› ä¸ºåˆ©ç”¨äº†å¤§é‡æ–°çš„èº«ä»½ä¿¡æ¯ï¼Œå®Œå…¨åˆ©ç”¨å†å²è®°å½•å»é»‘åå•è§„é¿é£é™©çš„æ–¹å¼æ˜¯æ— æ•ˆçš„ã€‚ä¸è¿‡ï¼Œå€ŸåŠ©äºå…³è”å…³ç³»çš„è§†è§’ï¼Œè¿™äº›æ¨¡å¼æ˜¯ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥è¢«åŠæ—¶è¯†åˆ«å‡ºæ¥çš„ã€‚ è¿™äº›å¯ä»¥è¢«è¯†åˆ«å‡ºçš„è§„å¾‹æˆ‘æŠŠå®ƒåˆ†æˆä¸¤ç§ï¼š ä¸€ç§æ˜¯é£æ§ä¸“å®¶å¯ä»¥ç›´æ¥ç”¨æŸç§æ¨¡å¼æ¥æè¿°çš„ï¼Œä¾‹å¦‚ï¼šå’Œå·²ç»è¢«æ ‡æ³¨ä¸ºé«˜é£é™©çš„å®ä½“æœ‰ç›´æ¥æˆ–è€…é—´æ¥çš„å…³è”å…³ç³»ï¼ˆæ–°è®¢å•ç”³è¯·äººä½¿ç”¨äº†å’Œè¿‡å¾€é«˜é£é™©è®°å½•ç›¸åŒçš„ç½‘ç»œè®¾å¤‡ï¼‰ï¼Œè¿™ç§æ¨¡å¼å¯¹åº”åˆ°å›¾è°±ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªå›¾æŸ¥è¯¢å°±å¯ä»¥å®æ—¶ç»™å‡ºç»“æœã€‚ å¦ä¸€ç§æ˜¯éšå«åœ¨æ•°æ®çš„å…³è”å…³ç³»èƒŒåï¼Œéœ€è¦é€šè¿‡å›¾ç®—æ³•æŒ–æ˜å¾—å‡ºçš„ä¸€äº›é£é™©æç¤ºï¼Œä¾‹å¦‚ï¼šå°½ç®¡ç»™å®šçš„å®ä½“ä¸æœ‰é™çš„æ ‡æ³¨é«˜é£é™©å®ä½“æ²¡æœ‰åŒ¹é…çš„å…³è”ï¼Œä½†æ˜¯å®ƒåœ¨å›¾ä¸­å½¢æˆäº†èšé›†æ€§å¯èƒ½æç¤ºæˆ‘ä»¬è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå°šæœªå¾—æ‰‹çš„è¿›è¡Œä¸­çš„å›¢ä¼™è´·æ¬¾è¯ˆéª—çš„å…¶ä¸­ä¸€æ¬¡ç”³è¯·ï¼Œè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡å®šæœŸåœ¨å†å²æ•°æ®ä¸­æ‰¹é‡æ‰§è¡Œç¤¾åŒºå‘ç°ç®—æ³•å¾—å‡ºï¼Œå¹¶åœ¨é«˜èšé›†ç¤¾åŒºä¸­åˆ©ç”¨ä¸­å¿ƒæ€§ç®—æ³•ç»™å‡ºæ ¸å¿ƒå®ä½“ï¼Œä¸€å¹¶æç¤ºç»™é£é™©ä¸“å®¶è¿›è¡Œåç»­è¯„ä¼°å’Œé£é™©æ ‡æ³¨ã€‚ 1.2.1 åŸºäºå›¾è°±ä¸ä¸“å®¶å›¾æ¨¡å¼åŒ¹é…çš„æ¬ºè¯ˆæ£€æµ‹ç¤ºä¾‹åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬åˆ©ç”¨ Nebula-UP æ¥ä¸€é”®éƒ¨ç½²ä¸€å¥— NebulaGraph å›¾æ•°æ®åº“ï¼š æ›´å¤šè¯·å‚è€ƒ https://github.com/wey-gu/nebula-up/ curl -fsSL nebula-up.siwei.io/install.sh | bash é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠå‰è¾¹å»ºæ¨¡çš„å›¾è°±åŠ è½½åˆ° NebulaGraph é‡Œï¼š # å…‹éš†æ•°æ®é›†ä»£ç ä»“åº“ git clone https://github.com/wey-gu/fraud-detection-datagen.git cp -r data_sample_numerical_vertex_id data # å»æ‰è¡¨å¤´ sed -i '1d' data/*.csv docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}:/root/ \\ -v ${PWD}/data/:/data \\ vesoft/nebula-importer:v3.1.0 \\ --config /root/nebula_graph_importer.yaml æœ‰äº†è¿™æ ·ä¸€ä¸ªå›¾è°±ï¼Œé£æ§ä¸“å®¶å¯ä»¥åœ¨å¯è§†åŒ–æ¢ç´¢å·¥å…·ä¸­æŒ‰éœ€æ¢ç´¢å®ä½“ä¹‹é—´çš„å…³ç³»ï¼Œç»˜åˆ¶ç›¸åº”çš„é£é™©æ¨¡å¼ï¼š åœ¨è¿™ä¸ªæ¢ç´¢æˆªå›¾é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ˜æ˜¾çœ‹åˆ°ä¸€ä¸ªç¾¤æ§è®¾å¤‡çš„é£é™©æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼å¯ä»¥è¢«äº¤ç»™å›¾æ•°æ®åº“å¼€å‘è€…ï¼ŒæŠ½è±¡æˆå¯ä»¥è¢«é£æ§åº”ç”¨å®šæœŸã€å®æ—¶æŸ¥è¯¢çš„è¯­å¥ï¼š ## é’ˆå¯¹ä¸€ç¬”äº¤æ˜“ç”³è¯·å…³è”æŸ¥è¯¢ MATCH (n) WHERE id(n) == \"200000010265\" OPTIONAL MATCH p_shared_d=(n)-[:`used_device`]-\u003e(d)\u003c-[:`used_device`]-(:`applicant`)-[:`with_phone_num`]-\u003e(pn:phone_num)\u003c-[e:`with_phone_num`]-(:`applicant`) RETURN p_shared_d æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ¨æ­¤æ¨¡å‹ä¹‹ä¸Šï¼Œé€šè¿‡ä¿®æ”¹è¿”å›çš„å…³è”è®¾å¤‡è®¡æ•°ï¼Œä½œä¸ºæ„å‘æŒ‡æ ‡æŸ¥è¯¢çš„åˆ¤æ–­ APIï¼š ## ç¾¤æ§æŒ‡æ ‡ MATCH (n) WHERE id(n) == \"200000010265\" OPTIONAL MATCH p_shared_d=(n)-[:`used_device`]-\u003e(d)\u003c-[:`used_device`]-(:`applicant`)-[:`with_phone_num`]-\u003e(pn:phone_num)\u003c-[e:`with_phone_num`]-(:`applicant`) RETURN count(e) å¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªç›¸å¯¹æœ‰æ•ˆçš„é£æ§ç³»ç»Ÿï¼Œåˆ©ç”¨æœ‰é™çš„æ ‡æ³¨æ•°æ®å’Œä¸“å®¶èµ„æºï¼Œå»æ›´é«˜æ•ˆæ§åˆ¶å›¢ä¼™æ¬ºè¯ˆä½œæ¡ˆé£é™©ã€‚ å¦ä¸€ä¸ªåˆ©ç”¨æ ‡æ³¨é£é™©èŠ‚ç‚¹çš„æŸ¥è¯¢æ˜¯æ‰¾åˆ°ç›¸å…³è”èŠ‚ç‚¹é«˜é£é™©å±æ€§çš„æ•°é‡ï¼š MATCH p_=(p:`applicant`)-[*1..2]-(p2:`applicant`) WHERE id(p)==\"200000014810\" AND p2.`applicant`.is_risky == \"True\" RETURN p_ LIMIT 100 å¯ä»¥ä»è¿™ä¸ªè·¯å¾„æŸ¥è¯¢çœ‹åˆ° 200000014810 çš„ç›¸è¿æ¥çš„ç”³è¯·äººä¸­æœ‰ä¸å°‘æ˜¯é«˜é£é™©çš„ï¼ˆä¹Ÿèƒ½çœ‹å‡ºèšé›†çš„ deviceï¼‰ã€‚ å¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ç›¸è¿é«˜é£é™©ç‚¹æ•°é‡ä¸ºä¸€ä¸ªæŒ‡æ ‡ï¼š MATCH (p:`applicant`)-[*1..2]-(p2:`applicant`) WHERE id(p)==\"200000014810\" AND p2.`applicant`.is_risky == \"True\" RETURN count(p2) ç„¶è€Œï¼Œåœ¨ç°å®æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„å¤§å¤šæ•°æ ‡æ³¨æ•°æ®çš„è·å–è¿˜æ˜¯è¿‡äºæ˜‚è´µï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•æ˜¯æ›´æœ‰æ•ˆåˆ©ç”¨æœ‰é™çš„é£é™©æ ‡æ³¨å’Œå›¾ç»“æ„ï¼Œæ¥é¢„æµ‹å‡ºé£é™©å‘¢ï¼Ÿ ","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:2","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#åŸºäºå›¾è°±ä¸ä¸“å®¶å›¾æ¨¡å¼åŒ¹é…çš„æ¬ºè¯ˆæ£€æµ‹ç¤ºä¾‹"},{"categories":["Nebula Graph"],"content":" 1.3 åˆ©ç”¨å›¾æ‰©å……æ ‡æ³¨ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œ Xiaojin Z. å’Œ Zoubin G. åœ¨è®ºæ–‡ï¼šLearning from Labeled and Unlabeled Data with Label Propagation ï¼ˆCMU-CALD-02-107ï¼‰ä¸­ï¼Œåˆ©ç”¨æ ‡ç­¾ä¼ æ’­ï¼ˆLabel Propagationï¼‰ç®—æ³•æ¥æŠŠæœ‰é™çš„æ ‡æ³¨ä¿¡æ¯åœ¨å›¾ä¸Šé€šè¿‡å…³è”å…³ç³»ä¼ æ’­åˆ°æ›´å¤šå®ä½“ä¸­ã€‚ è¿™æ ·ï¼Œåœ¨æˆ‘ä»¬å»ºç«‹çš„å›¾è°±ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å€ŸåŠ©æœ‰é™çš„é«˜é£é™©æ ‡æ³¨ï¼Œå»â€œä¼ æ’­â€äº§ç”Ÿæ›´å¤šçš„æ ‡æ³¨ä¿¡æ¯ã€‚è¿™äº›æ‰©å±•å‡ºæ¥çš„æ ‡æ³¨ä¿¡æ¯ä¸€æ–¹é¢å¯ä»¥åœ¨å®æ—¶çš„å›¾æŸ¥è¯¢ä¸­ç»™å‡ºæ›´å¤šçš„ç»“æœï¼Œå¦ä¸€æ–¹é¢ï¼Œå®ƒè¿˜èƒ½ä½œä¸ºé£æ§ä¸“å®¶é‡è¦çš„è¾“å…¥ä¿¡æ¯ï¼Œå¸®åŠ©æ¨è¿›åæ¬ºè¯ˆè°ƒæŸ¥è¡ŒåŠ¨çš„å¼€å±•ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®šæœŸç¦»çº¿åœ°å…¨å›¾æ‰«ææ•°æ®ï¼Œé€šè¿‡å›¾ç®—æ³•æ‰©å……ã€æ›´æ–°æ ‡æ³¨ï¼Œå†å°†æœ‰æ•ˆçš„æ›´æ–°æ ‡æ³¨å†™å›åˆ°å›¾è°±ä¹‹ä¸­ã€‚ æ³¨ï¼Œç±»ä¼¼çš„æ–¹æ³•è¿˜æœ‰ SIGNDiffusionï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»äº†è§£ä¸€ä¸‹ã€‚ 1.3.1 å›¾ç®—æ³•æ‰©å……æ¬ºè¯ˆé£é™©æ ‡æ³¨çš„ç¤ºä¾‹ä¸‹é¢ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªå¯ä»¥è·‘é€šçš„æ¡ˆä¾‹ï¼š è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ç”¨åˆ°äº† Yelp è¿™ä¸ªæ¬ºè¯ˆè¯†åˆ«çš„ç»å…¸æ•°æ®ï¼Œè¿™ä»½æ•°æ®ä¸åªä¼šç”¨åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåè¾¹ GNN æ–¹æ³•ä¸­çš„æ¡ˆä¾‹æˆ‘ä¹Ÿä¼šç”¨åˆ°å®ƒï¼Œæ‰€ä»¥å¤§å®¶å¯ä»¥è€å¿ƒæŠŠæ•°æ®å¯¼å…¥ NebulaGraphã€‚ å¯¼å…¥æ•°æ®åˆ°å›¾åº“ ç”Ÿæˆå¯¼å…¥çš„æ–¹æ³•åœ¨è¿™é‡Œï¼Œhttps://github.com/wey-gu/nebulagraph-yelp-frauddetection cd ~ git clone https://github.com/wey-gu/nebulagraph-yelp-frauddetection cd nebulagraph-yelp-frauddetection python3 -m pip install -r requirements.txt python3 data_download.py # å¯¼å…¥å›¾åº“ docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}/yelp_nebulagraph_importer.yaml:/root/importer.yaml \\ -v ${PWD}/data:/root \\ vesoft/nebula-importer:v3.1.0 \\ --config /root/importer.yaml ç»“æŸä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å›¾ä¸Šçš„ç»Ÿè®¡ï¼š ~/.nebula-up/console.sh -e \"USE yelp; SHOW STATS\" ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š (root@nebula) [(none)]\u003e USE yelp; SHOW STATS +---------+---------------------------------------+---------+ | Type | Name | Count | +---------+---------------------------------------+---------+ | \"Tag\" | \"review\" | 45954 | | \"Edge\" | \"shares_restaurant_in_one_month_with\" | 1147232 | | \"Edge\" | \"shares_restaurant_rating_with\" | 6805486 | | \"Edge\" | \"shares_user_with\" | 98630 | | \"Space\" | \"vertices\" | 45954 | | \"Space\" | \"edges\" | 8051348 | +---------+---------------------------------------+---------+ Got 6 rows (time spent 1911/4488 us) ç›®å‰ï¼Œå¸‚é¢ä¸Šçš„ LPA æ ‡ç­¾ä¼ æ’­ç®—æ³•éƒ½æ˜¯ç”¨æ¥åšç¤¾åŒºæ£€æµ‹çš„ï¼Œå¾ˆå°‘æœ‰å®ç°æ˜¯ç”¨æ¥åšæ ‡ç­¾æ‹“å±•çš„ï¼ˆåªæœ‰ SK-Learn ä¸­æœ‰è¿™ä¸ªå®ç°ï¼‰ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬å‚è€ƒ Thibaud M ç»™å‡ºæ¥çš„å®ç°ã€‚ åŸå§‹çš„è®¨è®ºå‚è€ƒï¼šhttps://datascience.stackexchange.com/a/55720/138720 ä¸ºäº†è®©è¿™ä¸ªç®—æ³•è·‘çš„å¿«ä¸€ç‚¹ï¼Œä¼šä» NebulaGraph é‡Œå–ä¸€ä¸ªç‚¹çš„å­å›¾ï¼Œåœ¨è¿™ä¸ªå°çš„å­å›¾ä¸Šåšæ ‡æ³¨çš„æ‰©å……ï¼š é¦–å…ˆï¼Œæˆ‘ä»¬å¯åŠ¨ä¸€ä¸ª Jupyter çš„ Playgroundï¼Œ å‚è€ƒ https://github.com/wey-gu/nebula-dgl ä¸­çš„ Playground è¿‡ç¨‹ï¼š git clone https://github.com/wey-gu/nebula-dgl.git cd nebula-dgl # è¿è¡Œ Jupyter Notebook docker run -it --name dgl -p 8888:8888 --network nebula-net \\ -v \"$PWD\":/home/jovyan/work jupyter/datascience-notebook \\ start-notebook.sh --NotebookApp.token='nebulagraph' è®¿é—®ï¼šhttp://localhost:8888/lab/tree/work?token=nebulagraph å®‰è£…ä¾èµ–ï¼ˆè¿™äº›ä¾èµ–åœ¨åè¾¹çš„ GNN ä¾‹å­ä¸­ä¹Ÿä¼šè¢«ç”¨åˆ°ï¼‰ !python3 -m pip install git+https://github.com/vesoft-inc/nebula-python.git@8c328c534413b04ccecfd42e64ce6491e09c6ca8 !python3 -m pip install . ç„¶åï¼Œæˆ‘ä»¬ä»å›¾ä¸­è¯»å–ä¸€ä¸ªå­å›¾ï¼Œä» 2048 è¿™ä¸ªç‚¹å¼€å§‹æ¢ç´¢ä¸¤æ­¥å†…çš„æ‰€æœ‰è¾¹ã€‚ import torch import json from torch import tensor from dgl import DGLHeteroGraph, heterograph from nebula3.gclient.net import ConnectionPool from nebula3.Config import Config config = Config() config.max_connection_pool_size = 2 connection_pool = ConnectionPool() connection_pool.init([('graphd', 9669)], config) vertex_id = 2048 client = connection_pool.get_session('root', 'nebula') r = client.execute_json( \"USE yelp;\" f\"GET SUBGRAPH WITH PROP 2 STEPS FROM {vertex_id} YIELD VERTICES AS nodes, EDGES AS relationships;\") r = json.loads(r) data = r.get('results', [{}])[0].get('data') columns = r.get('results', [{}])[0].get('columns') # create node and nodedata node_id_map = {} # key: vertex id in NebulaGraph, value: node id in dgl_graph node_idx = 0 features = [[] for _ in range(32)] + [[]] for i in range(len(data)): for index, node in enumerate(data[i]['meta'][0]): nodeid = data[i]['meta'][0][index]['id'] if nodeid not in node_id_map: node_id_map[nodeid] = node_idx node_idx += 1 for f in range(32): features[f].append(data[i]['row'][0][index][f\"review.f{f}\"]) features[32].append(data[i]['row'][0][index]['review.is_fraud']) rur_start, rur_end, rsr_start, rsr_end, rtr_start, rtr_end = [], [], [], [], [], [] for i in range(len(data)): for edge in data[i]['meta'][1]: edge = edge['id'] if edge['name'] == 'shares_user_with': rur_start.append(node_id_map[edge['src']]) rur_end.append(node_id_map[edge['dst']]) elif edge['name'] == 'shares_restaurant_rating_with': rsr_start.append(node_id_map[edge['src']]) rsr_end.append(node_id_map[edge['dst']]) elif edge['name'] == 'shar","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:3","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#åˆ©ç”¨å›¾æ‰©å……æ ‡æ³¨"},{"categories":["Nebula Graph"],"content":" 1.3 åˆ©ç”¨å›¾æ‰©å……æ ‡æ³¨ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œ Xiaojin Z. å’Œ Zoubin G. åœ¨è®ºæ–‡ï¼šLearning from Labeled and Unlabeled Data with Label Propagation ï¼ˆCMU-CALD-02-107ï¼‰ä¸­ï¼Œåˆ©ç”¨æ ‡ç­¾ä¼ æ’­ï¼ˆLabel Propagationï¼‰ç®—æ³•æ¥æŠŠæœ‰é™çš„æ ‡æ³¨ä¿¡æ¯åœ¨å›¾ä¸Šé€šè¿‡å…³è”å…³ç³»ä¼ æ’­åˆ°æ›´å¤šå®ä½“ä¸­ã€‚ è¿™æ ·ï¼Œåœ¨æˆ‘ä»¬å»ºç«‹çš„å›¾è°±ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å€ŸåŠ©æœ‰é™çš„é«˜é£é™©æ ‡æ³¨ï¼Œå»â€œä¼ æ’­â€äº§ç”Ÿæ›´å¤šçš„æ ‡æ³¨ä¿¡æ¯ã€‚è¿™äº›æ‰©å±•å‡ºæ¥çš„æ ‡æ³¨ä¿¡æ¯ä¸€æ–¹é¢å¯ä»¥åœ¨å®æ—¶çš„å›¾æŸ¥è¯¢ä¸­ç»™å‡ºæ›´å¤šçš„ç»“æœï¼Œå¦ä¸€æ–¹é¢ï¼Œå®ƒè¿˜èƒ½ä½œä¸ºé£æ§ä¸“å®¶é‡è¦çš„è¾“å…¥ä¿¡æ¯ï¼Œå¸®åŠ©æ¨è¿›åæ¬ºè¯ˆè°ƒæŸ¥è¡ŒåŠ¨çš„å¼€å±•ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®šæœŸç¦»çº¿åœ°å…¨å›¾æ‰«ææ•°æ®ï¼Œé€šè¿‡å›¾ç®—æ³•æ‰©å……ã€æ›´æ–°æ ‡æ³¨ï¼Œå†å°†æœ‰æ•ˆçš„æ›´æ–°æ ‡æ³¨å†™å›åˆ°å›¾è°±ä¹‹ä¸­ã€‚ æ³¨ï¼Œç±»ä¼¼çš„æ–¹æ³•è¿˜æœ‰ SIGNDiffusionï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»äº†è§£ä¸€ä¸‹ã€‚ 1.3.1 å›¾ç®—æ³•æ‰©å……æ¬ºè¯ˆé£é™©æ ‡æ³¨çš„ç¤ºä¾‹ä¸‹é¢ï¼Œæˆ‘ç»™å‡ºä¸€ä¸ªå¯ä»¥è·‘é€šçš„æ¡ˆä¾‹ï¼š è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ç”¨åˆ°äº† Yelp è¿™ä¸ªæ¬ºè¯ˆè¯†åˆ«çš„ç»å…¸æ•°æ®ï¼Œè¿™ä»½æ•°æ®ä¸åªä¼šç”¨åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåè¾¹ GNN æ–¹æ³•ä¸­çš„æ¡ˆä¾‹æˆ‘ä¹Ÿä¼šç”¨åˆ°å®ƒï¼Œæ‰€ä»¥å¤§å®¶å¯ä»¥è€å¿ƒæŠŠæ•°æ®å¯¼å…¥ NebulaGraphã€‚ å¯¼å…¥æ•°æ®åˆ°å›¾åº“ ç”Ÿæˆå¯¼å…¥çš„æ–¹æ³•åœ¨è¿™é‡Œï¼Œhttps://github.com/wey-gu/nebulagraph-yelp-frauddetection cd ~ git clone https://github.com/wey-gu/nebulagraph-yelp-frauddetection cd nebulagraph-yelp-frauddetection python3 -m pip install -r requirements.txt python3 data_download.py # å¯¼å…¥å›¾åº“ docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}/yelp_nebulagraph_importer.yaml:/root/importer.yaml \\ -v ${PWD}/data:/root \\ vesoft/nebula-importer:v3.1.0 \\ --config /root/importer.yaml ç»“æŸä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å›¾ä¸Šçš„ç»Ÿè®¡ï¼š ~/.nebula-up/console.sh -e \"USE yelp; SHOW STATS\" ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š (root@nebula) [(none)]\u003e USE yelp; SHOW STATS +---------+---------------------------------------+---------+ | Type | Name | Count | +---------+---------------------------------------+---------+ | \"Tag\" | \"review\" | 45954 | | \"Edge\" | \"shares_restaurant_in_one_month_with\" | 1147232 | | \"Edge\" | \"shares_restaurant_rating_with\" | 6805486 | | \"Edge\" | \"shares_user_with\" | 98630 | | \"Space\" | \"vertices\" | 45954 | | \"Space\" | \"edges\" | 8051348 | +---------+---------------------------------------+---------+ Got 6 rows (time spent 1911/4488 us) ç›®å‰ï¼Œå¸‚é¢ä¸Šçš„ LPA æ ‡ç­¾ä¼ æ’­ç®—æ³•éƒ½æ˜¯ç”¨æ¥åšç¤¾åŒºæ£€æµ‹çš„ï¼Œå¾ˆå°‘æœ‰å®ç°æ˜¯ç”¨æ¥åšæ ‡ç­¾æ‹“å±•çš„ï¼ˆåªæœ‰ SK-Learn ä¸­æœ‰è¿™ä¸ªå®ç°ï¼‰ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬å‚è€ƒ Thibaud M ç»™å‡ºæ¥çš„å®ç°ã€‚ åŸå§‹çš„è®¨è®ºå‚è€ƒï¼šhttps://datascience.stackexchange.com/a/55720/138720 ä¸ºäº†è®©è¿™ä¸ªç®—æ³•è·‘çš„å¿«ä¸€ç‚¹ï¼Œä¼šä» NebulaGraph é‡Œå–ä¸€ä¸ªç‚¹çš„å­å›¾ï¼Œåœ¨è¿™ä¸ªå°çš„å­å›¾ä¸Šåšæ ‡æ³¨çš„æ‰©å……ï¼š é¦–å…ˆï¼Œæˆ‘ä»¬å¯åŠ¨ä¸€ä¸ª Jupyter çš„ Playgroundï¼Œ å‚è€ƒ https://github.com/wey-gu/nebula-dgl ä¸­çš„ Playground è¿‡ç¨‹ï¼š git clone https://github.com/wey-gu/nebula-dgl.git cd nebula-dgl # è¿è¡Œ Jupyter Notebook docker run -it --name dgl -p 8888:8888 --network nebula-net \\ -v \"$PWD\":/home/jovyan/work jupyter/datascience-notebook \\ start-notebook.sh --NotebookApp.token='nebulagraph' è®¿é—®ï¼šhttp://localhost:8888/lab/tree/work?token=nebulagraph å®‰è£…ä¾èµ–ï¼ˆè¿™äº›ä¾èµ–åœ¨åè¾¹çš„ GNN ä¾‹å­ä¸­ä¹Ÿä¼šè¢«ç”¨åˆ°ï¼‰ !python3 -m pip install git+https://github.com/vesoft-inc/nebula-python.git@8c328c534413b04ccecfd42e64ce6491e09c6ca8 !python3 -m pip install . ç„¶åï¼Œæˆ‘ä»¬ä»å›¾ä¸­è¯»å–ä¸€ä¸ªå­å›¾ï¼Œä» 2048 è¿™ä¸ªç‚¹å¼€å§‹æ¢ç´¢ä¸¤æ­¥å†…çš„æ‰€æœ‰è¾¹ã€‚ import torch import json from torch import tensor from dgl import DGLHeteroGraph, heterograph from nebula3.gclient.net import ConnectionPool from nebula3.Config import Config config = Config() config.max_connection_pool_size = 2 connection_pool = ConnectionPool() connection_pool.init([('graphd', 9669)], config) vertex_id = 2048 client = connection_pool.get_session('root', 'nebula') r = client.execute_json( \"USE yelp;\" f\"GET SUBGRAPH WITH PROP 2 STEPS FROM {vertex_id} YIELD VERTICES AS nodes, EDGES AS relationships;\") r = json.loads(r) data = r.get('results', [{}])[0].get('data') columns = r.get('results', [{}])[0].get('columns') # create node and nodedata node_id_map = {} # key: vertex id in NebulaGraph, value: node id in dgl_graph node_idx = 0 features = [[] for _ in range(32)] + [[]] for i in range(len(data)): for index, node in enumerate(data[i]['meta'][0]): nodeid = data[i]['meta'][0][index]['id'] if nodeid not in node_id_map: node_id_map[nodeid] = node_idx node_idx += 1 for f in range(32): features[f].append(data[i]['row'][0][index][f\"review.f{f}\"]) features[32].append(data[i]['row'][0][index]['review.is_fraud']) rur_start, rur_end, rsr_start, rsr_end, rtr_start, rtr_end = [], [], [], [], [], [] for i in range(len(data)): for edge in data[i]['meta'][1]: edge = edge['id'] if edge['name'] == 'shares_user_with': rur_start.append(node_id_map[edge['src']]) rur_end.append(node_id_map[edge['dst']]) elif edge['name'] == 'shares_restaurant_rating_with': rsr_start.append(node_id_map[edge['src']]) rsr_end.append(node_id_map[edge['dst']]) elif edge['name'] == 'shar","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:3","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#å›¾ç®—æ³•æ‰©å……æ¬ºè¯ˆé£é™©æ ‡æ³¨çš„ç¤ºä¾‹"},{"categories":["Nebula Graph"],"content":" 1.4 å¸¦æœ‰å›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ åœ¨é£æ§é¢†åŸŸå¼€å§‹åˆ©ç”¨å›¾çš„æ€æƒ³å’Œèƒ½åŠ›ä¹‹å‰ï¼Œå·²ç»æœ‰å¾ˆå¤šåˆ©ç”¨æœºå™¨å­¦ä¹ çš„åˆ†ç±»ç®—æ³•åŸºäºå†å²æ•°æ®é¢„æµ‹é«˜é£é™©è¡Œä¸ºçš„æ–¹æ³•äº†ï¼Œè¿™äº›æ–¹æ³•æŠŠè®°å½•ä¸­é¢†åŸŸä¸“å®¶è®¤ä¸ºæœ‰å…³çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼šå¹´é¾„ã€å­¦å†ã€æ”¶å…¥ï¼‰ä½œä¸ºç‰¹å¾ï¼Œå†å²æ ‡æ³¨ä¿¡æ¯ä½œä¸ºæ ‡ç­¾å»è®­ç»ƒé£é™©é¢„æµ‹æ¨¡å‹ã€‚ é‚£ä¹ˆè¯»åˆ°çš„è¿™é‡Œï¼Œæˆ‘ä»¬æ˜¯å¦ä¼šæƒ³åˆ°åœ¨è¿™äº›æ–¹æ³•çš„åŸºç¡€ä¹‹ä¸Šï¼Œå¦‚æœæŠŠåŸºäºå›¾ç»“æ„çš„å±æ€§ä¹Ÿè€ƒè™‘è¿›æ¥ï¼Œä½œä¸ºç‰¹å¾å»è®­ç»ƒçš„æ¨¡å‹å¯èƒ½æ›´æœ‰æ•ˆå‘¢ï¼Ÿç­”æ¡ˆä¹Ÿæ˜¯è‚¯å®šçš„ï¼Œå·²ç»æœ‰å¾ˆå¤šè®ºæ–‡å’Œå·¥ç¨‹å®è·µæ­ç¤ºè¿™æ ·çš„æ¨¡å‹æ¯”æœªè€ƒè™‘å›¾ç‰¹å¾çš„ç®—æ³•æ›´åŠ æœ‰æ•ˆï¼šè¿™äº›è¢«å°è¯•æœ‰æ•ˆçš„å›¾ç»“æ„ç‰¹å¾å¯èƒ½æ˜¯å®ä½“çš„ PageRank å€¼ã€Degree å€¼æˆ–è€…æ˜¯æŸä¸€ä¸ªç¤¾åŒºå‘ç°ç®—æ³•å¾—å‡ºçš„ç¤¾åŒº idã€‚ åœ¨ç”Ÿäº§ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å®šæœŸä»å›¾è°±ä¸­è·å¾—å®æ—¶çš„å…¨å›¾ä¿¡æ¯ï¼Œåœ¨å›¾è®¡ç®—å¹³å°ä¸­åˆ†æè¿ç®—è·å¾—æ‰€éœ€ç‰¹å¾ï¼Œç»è¿‡é¢„å®šçš„æ•°æ®ç®¡é“ï¼Œå¯¼å…¥æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­å‘¨æœŸè·å¾—æ–°çš„é£é™©æç¤ºï¼Œå¹¶å°†éƒ¨åˆ†ç»“æœå†™å›å›¾è°±æ–¹ä¾¿å…¶ä»–ç³»ç»Ÿå’Œä¸“å®¶æŠ½å–ã€å‚è€ƒã€‚ 1.4.1 å¸¦æœ‰å›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ¬ºè¯ˆæ£€æµ‹ç¤ºä¾‹è¿™é‡Œï¼Œæœºå™¨å­¦ä¹ çš„æ–¹æ³•æˆ‘å°±ä¸æ¼”ç¤ºäº†ï¼Œå°±æ˜¯å¸¸è§çš„åˆ†ç±»æ–¹æ³•ï¼Œåœ¨æ­¤ä¹‹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•°æ®ä¸­é€šè¿‡å›¾ç®—æ³•è·å¾—ä¸€äº›æ–°çš„å±æ€§ï¼Œè¿™äº›å±æ€§å†å¤„ç†ä¸€ä¸‹ä½œä¸ºæ–°çš„ç‰¹å¾ã€‚æˆ‘åªæ¼”ç¤ºä¸€ä¸ªç¤¾åŒºå‘ç°çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¨å›¾è·‘ä¸€ä¸ª Louvainï¼Œå¾—å‡ºä¸åŒèŠ‚ç‚¹çš„ç¤¾åŒºå½’å±ï¼Œç„¶åæŠŠç¤¾åŒºçš„å€¼å½“åšä¸€ä¸ªåˆ†ç±»å¤„ç†æˆä¸ºæ•°å€¼çš„ç‰¹å¾ã€‚ è¿™ä¸ªä¾‹å­é‡Œæˆ‘ä»¬è¿˜ç”¨ https://github.com/wey-gu/fraud-detection-datagen è¿™ä¸ªæ•°æ®ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œè¿™ä¸ªä¾‹å­æˆ‘ç”¨åˆ°äº† Nebula-Algorithm è¿™ä¸ªé¡¹ç›®ï¼Œå®ƒæ˜¯ä¸€ä¸ª Spark åº”ç”¨ï¼Œå¯ä»¥åœ¨ NebulaGraph å›¾åº“ä¸Šè¿è¡Œå¾ˆå¤šå¸¸ç”¨çš„å›¾ç®—æ³•ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éƒ¨ç½² Spark å’Œ Nebula Algorithmï¼Œè¿˜æ˜¯åˆ©ç”¨ Nebula-UPï¼Œä¸€é”®éƒ¨ç½²ï¼š curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 spark é›†ç¾¤èµ·æ¥ä¹‹åï¼Œå› ä¸ºéœ€è¦çš„é…ç½®æ–‡ä»¶æˆ‘å·²ç»æ”¾åœ¨äº† Nebula-UP å†…éƒ¨ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€è¡Œå°±å¯ä»¥è¿è¡Œç®—æ³•å•¦ï¼ cd ~/.nebula-up/nebula-up/spark \u0026\u0026 ls -l docker exec -it sparkmaster /spark/bin/spark-submit \\ --master \"local\" --conf spark.rpc.askTimeout=6000s \\ --class com.vesoft.nebula.algorithm.Main \\ --driver-memory 4g /root/download/nebula-algo.jar \\ -p /root/louvain.conf è€Œæœ€ç»ˆçš„ç»“æœå°±åœ¨ sparkmaster å®¹å™¨å†…çš„ /output é‡Œï¼š # docker exec -it sparkmaster bash ls -l /output ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ª Louvain çš„å›¾ç‰¹å¾åšä¸€äº›å¤„ç†ï¼Œå¹¶å¼€å§‹ä¼ ç»Ÿçš„æ¨¡å‹è®­ç»ƒäº†ã€‚ ","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:4","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#å¸¦æœ‰å›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ "},{"categories":["Nebula Graph"],"content":" 1.4 å¸¦æœ‰å›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ åœ¨é£æ§é¢†åŸŸå¼€å§‹åˆ©ç”¨å›¾çš„æ€æƒ³å’Œèƒ½åŠ›ä¹‹å‰ï¼Œå·²ç»æœ‰å¾ˆå¤šåˆ©ç”¨æœºå™¨å­¦ä¹ çš„åˆ†ç±»ç®—æ³•åŸºäºå†å²æ•°æ®é¢„æµ‹é«˜é£é™©è¡Œä¸ºçš„æ–¹æ³•äº†ï¼Œè¿™äº›æ–¹æ³•æŠŠè®°å½•ä¸­é¢†åŸŸä¸“å®¶è®¤ä¸ºæœ‰å…³çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼šå¹´é¾„ã€å­¦å†ã€æ”¶å…¥ï¼‰ä½œä¸ºç‰¹å¾ï¼Œå†å²æ ‡æ³¨ä¿¡æ¯ä½œä¸ºæ ‡ç­¾å»è®­ç»ƒé£é™©é¢„æµ‹æ¨¡å‹ã€‚ é‚£ä¹ˆè¯»åˆ°çš„è¿™é‡Œï¼Œæˆ‘ä»¬æ˜¯å¦ä¼šæƒ³åˆ°åœ¨è¿™äº›æ–¹æ³•çš„åŸºç¡€ä¹‹ä¸Šï¼Œå¦‚æœæŠŠåŸºäºå›¾ç»“æ„çš„å±æ€§ä¹Ÿè€ƒè™‘è¿›æ¥ï¼Œä½œä¸ºç‰¹å¾å»è®­ç»ƒçš„æ¨¡å‹å¯èƒ½æ›´æœ‰æ•ˆå‘¢ï¼Ÿç­”æ¡ˆä¹Ÿæ˜¯è‚¯å®šçš„ï¼Œå·²ç»æœ‰å¾ˆå¤šè®ºæ–‡å’Œå·¥ç¨‹å®è·µæ­ç¤ºè¿™æ ·çš„æ¨¡å‹æ¯”æœªè€ƒè™‘å›¾ç‰¹å¾çš„ç®—æ³•æ›´åŠ æœ‰æ•ˆï¼šè¿™äº›è¢«å°è¯•æœ‰æ•ˆçš„å›¾ç»“æ„ç‰¹å¾å¯èƒ½æ˜¯å®ä½“çš„ PageRank å€¼ã€Degree å€¼æˆ–è€…æ˜¯æŸä¸€ä¸ªç¤¾åŒºå‘ç°ç®—æ³•å¾—å‡ºçš„ç¤¾åŒº idã€‚ åœ¨ç”Ÿäº§ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å®šæœŸä»å›¾è°±ä¸­è·å¾—å®æ—¶çš„å…¨å›¾ä¿¡æ¯ï¼Œåœ¨å›¾è®¡ç®—å¹³å°ä¸­åˆ†æè¿ç®—è·å¾—æ‰€éœ€ç‰¹å¾ï¼Œç»è¿‡é¢„å®šçš„æ•°æ®ç®¡é“ï¼Œå¯¼å…¥æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­å‘¨æœŸè·å¾—æ–°çš„é£é™©æç¤ºï¼Œå¹¶å°†éƒ¨åˆ†ç»“æœå†™å›å›¾è°±æ–¹ä¾¿å…¶ä»–ç³»ç»Ÿå’Œä¸“å®¶æŠ½å–ã€å‚è€ƒã€‚ 1.4.1 å¸¦æœ‰å›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ¬ºè¯ˆæ£€æµ‹ç¤ºä¾‹è¿™é‡Œï¼Œæœºå™¨å­¦ä¹ çš„æ–¹æ³•æˆ‘å°±ä¸æ¼”ç¤ºäº†ï¼Œå°±æ˜¯å¸¸è§çš„åˆ†ç±»æ–¹æ³•ï¼Œåœ¨æ­¤ä¹‹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•°æ®ä¸­é€šè¿‡å›¾ç®—æ³•è·å¾—ä¸€äº›æ–°çš„å±æ€§ï¼Œè¿™äº›å±æ€§å†å¤„ç†ä¸€ä¸‹ä½œä¸ºæ–°çš„ç‰¹å¾ã€‚æˆ‘åªæ¼”ç¤ºä¸€ä¸ªç¤¾åŒºå‘ç°çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¨å›¾è·‘ä¸€ä¸ª Louvainï¼Œå¾—å‡ºä¸åŒèŠ‚ç‚¹çš„ç¤¾åŒºå½’å±ï¼Œç„¶åæŠŠç¤¾åŒºçš„å€¼å½“åšä¸€ä¸ªåˆ†ç±»å¤„ç†æˆä¸ºæ•°å€¼çš„ç‰¹å¾ã€‚ è¿™ä¸ªä¾‹å­é‡Œæˆ‘ä»¬è¿˜ç”¨ https://github.com/wey-gu/fraud-detection-datagen è¿™ä¸ªæ•°æ®ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œè¿™ä¸ªä¾‹å­æˆ‘ç”¨åˆ°äº† Nebula-Algorithm è¿™ä¸ªé¡¹ç›®ï¼Œå®ƒæ˜¯ä¸€ä¸ª Spark åº”ç”¨ï¼Œå¯ä»¥åœ¨ NebulaGraph å›¾åº“ä¸Šè¿è¡Œå¾ˆå¤šå¸¸ç”¨çš„å›¾ç®—æ³•ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éƒ¨ç½² Spark å’Œ Nebula Algorithmï¼Œè¿˜æ˜¯åˆ©ç”¨ Nebula-UPï¼Œä¸€é”®éƒ¨ç½²ï¼š curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 spark é›†ç¾¤èµ·æ¥ä¹‹åï¼Œå› ä¸ºéœ€è¦çš„é…ç½®æ–‡ä»¶æˆ‘å·²ç»æ”¾åœ¨äº† Nebula-UP å†…éƒ¨ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€è¡Œå°±å¯ä»¥è¿è¡Œç®—æ³•å•¦ï¼ cd ~/.nebula-up/nebula-up/spark \u0026\u0026 ls -l docker exec -it sparkmaster /spark/bin/spark-submit \\ --master \"local\" --conf spark.rpc.askTimeout=6000s \\ --class com.vesoft.nebula.algorithm.Main \\ --driver-memory 4g /root/download/nebula-algo.jar \\ -p /root/louvain.conf è€Œæœ€ç»ˆçš„ç»“æœå°±åœ¨ sparkmaster å®¹å™¨å†…çš„ /output é‡Œï¼š # docker exec -it sparkmaster bash ls -l /output ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ª Louvain çš„å›¾ç‰¹å¾åšä¸€äº›å¤„ç†ï¼Œå¹¶å¼€å§‹ä¼ ç»Ÿçš„æ¨¡å‹è®­ç»ƒäº†ã€‚ ","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:4","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#å¸¦æœ‰å›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ¬ºè¯ˆæ£€æµ‹ç¤ºä¾‹"},{"categories":["Nebula Graph"],"content":" 1.5 å›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•ç„¶è€Œï¼Œè¿™äº›å›¾ç‰¹å¾çš„æ–¹æ³•çš„é—®é¢˜åœ¨äºï¼š å›¾ç‰¹å¾å¹¶ä¸èƒ½æŠŠå…³è”å…³ç³»ï¼Œæ•°æ®çš„å±€éƒ¨æ€§å……åˆ†åæ˜ åˆ°æˆ‘ä»¬çš„æ¨¡å‹ã€æ–¹æ³•é‡Œï¼› å›¾çš„ç‰¹å¾å·¥ç¨‹æ˜¯å¾ˆæ˜‚è´µã€ç¹ççš„ã€‚ åœ¨æœ€è¿‘å‡ å¹´çš„æˆæœä¸­ï¼ŒåŸºäº GNN çš„æ–¹æ³•é€šè¿‡å°†å›¾ç»“æ„ä¸å±æ€§ä¿¡æ¯è¿›è¡ŒåµŒå…¥è¡¨ç¤ºï¼Œä½¿å¾—æˆ‘ä»¬èƒ½åœ¨ä¸è¿›è¡Œå›¾ç‰¹å¾æŠ½å–ã€ç‰¹å¾å·¥ç¨‹ã€ä¸“å®¶ä¸å·¥ç¨‹æ–¹æ³•çš„æ•°æ®æ ‡æ³¨çš„æƒ…å†µä¸‹ï¼Œå¾—åˆ°ç›¸æ¯”äºåŸºäºä¼ ç»Ÿå›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ›´å¥½çš„æ•ˆæœã€‚æœ‰æ„æ€çš„æ˜¯ï¼Œç°åœ¨æ­£æ˜¯è¿™äº›æ–¹æ³•å¿«é€Ÿè¢«å‘ç°ã€æ¼”è¿›çš„æ—¶æœŸï¼ŒåŸºäºå›¾çš„æ·±åº¦å­¦ä¹ æ˜¯ä¹‹å‰å‡ å¹´æœ€çƒ­é—¨çš„æœºå™¨å­¦ä¹ ç ”ç©¶æ–¹å‘ä¹‹ä¸€ã€‚ åŒæ—¶ï¼Œå›¾æ·±åº¦å­¦ä¹ çš„ä¸€äº›æ–¹æ³•å¯ä»¥åšåˆ° Inductive Learningâ€”â€”æ¨¡å‹å¯ä»¥åœ¨æ–°çš„ç‚¹ã€è¾¹ä¸Šè¿›è¡Œæ¨ç†ï¼Œè¿™æ ·ï¼Œé…åˆå›¾æ•°æ®åº“ä¸Šçº¿ä¸Šçš„å­å›¾æŸ¥è¯¢èƒ½åŠ›ï¼Œåœ¨çº¿å®æ—¶çš„é£é™©é¢„æµ‹ä¹Ÿå˜å¾—å¾ˆç®€å•å¯è¡Œäº†ã€‚ 1.5.1 åŸºäºå›¾è¡¨ç¤ºçš„å›¾ç¥ç»ç½‘ç»œæ¬ºè¯ˆæ£€æµ‹ç³»ç»Ÿç¤ºä¾‹åˆ©ç”¨ GNN çš„æ–¹æ³•ä¸­ï¼Œå›¾æ•°æ®åº“å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œæ•°æ®çš„å­˜å‚¨å¯ä»¥åœ¨å…¶ä»–å‡ ç§å¸¸è§çš„ä»‹è´¨ä¹‹ä¸­ï¼Œä½†æ˜¯å›¾åº“èƒ½å¤Ÿæœ€å¤§åŒ–åŠ©ç›Šæ¨¡å‹è®­ç»ƒã€æ¨¡å‹æ›´æ–°ã€çº¿ä¸Šç»“æœçš„æ›´æ–°ã€‚å½“æˆ‘ä»¬æŠŠå›¾æ•°æ®åº“ä½œä¸ºæ•°æ®çš„å•ä¸€æ•°æ®æ¥æºï¼ˆsingle source of truthï¼‰çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„åŸºäºçº¿ä¸Šã€ç¦»çº¿ã€å›¾è°±çš„æ–¹æ³•å¯ä»¥å¾ˆå®¹æ˜“è¢«é›†æˆèµ·æ¥ï¼Œä»è€Œç»„åˆæ‰€æœ‰æ–¹æ³•çš„ä¼˜åŠ¿ä¸ç»“æœï¼Œåšå‡ºæ›´æœ‰æ•ˆçš„æ¬ºè¯ˆæ£€æµ‹å¤åˆç³»ç»Ÿã€‚ åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬ä¸€æ ·åˆ†ä¸ºï¼šæ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€æ„å»ºæ£€æµ‹ç³»ç»Ÿè¿™å‡ éƒ¨åˆ†ã€‚ æ³¨ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl æˆ‘ä¹Ÿæ˜¯è¿™ä¸ªåº“çš„ä½œè€… ğŸ˜ 1.5.1.1 æ•°æ®é›†æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®é›†æ˜¯ Yelp-Fraudï¼Œä»–ç›´æ¥æ¥è‡ªäºè®ºæ–‡ Enhancing Graph Neural Network-based Fraud Detectors against Camouflaged Fraudstersã€‚ è¿™ä¸ªå›¾ä¸­æœ‰ä¸€ç§ç‚¹ï¼Œä¸‰ç§å…³ç³»ï¼š é¡¶ç‚¹ï¼šæ¥è‡ª Yelp ä¸­çš„é¤å…ã€é…’åº—çš„è¯„ä»·ï¼Œæœ‰ä¸¤ç±»å±æ€§ï¼š æ¯ä¸€ä¸ªè¯„ä»·ä¸­æœ‰è¢«æ ‡æ³¨äº†çš„æ˜¯å¦æ˜¯è™šå‡ã€æ¬ºè¯ˆè¯„ä»·çš„æ ‡ç­¾ 32 ä¸ªå·²ç»è¢«å¤„ç†è¿‡çš„æ•°å­—å‹å±æ€§ è¾¹ï¼šä¸‰ç±»è¯„ä»·ä¹‹é—´çš„å…³è”å…³ç³» R-U-Rï¼šä¸¤ä¸ªè¯„ä»·ç”±åŒä¸€ä¸ªç”¨æˆ·å‘å‡º shares_user_with R-S-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒè¯„åˆ†ï¼ˆè¯„åˆ†å¯ä»¥æ˜¯1åˆ°5ï¼‰ shares_restaurant_rating_with R-T-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒæäº¤æœˆä»½ shares_restaurant_in_one_month_with åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å‡è®¾è¿™ä¸ªå›¾å·²ç»åœ¨æˆ‘ä»¬çš„ NebulaGraph é‡Œè¾¹äº†ã€‚ æ³¨ï¼Œæˆ‘å·²ç»å¸®å¤§å®¶æå‰åšå¥½äº†å°†è¿™å¼ å›¾å¯¼å…¥ NebulaGraph çš„å·¥ä½œï¼Œé•¿è¯çŸ­è¯´å°±æ˜¯ï¼š # éƒ¨ç½² NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash # æ‹‰å–è¿™ä¸ªæ•°æ®çš„ Repo git clone https://github.com/wey-gu/nebulagraph-yelp-frauddetection \u0026\u0026 cd nebulagraph-yelp-frauddetection # å®‰è£…ä¾èµ–ï¼Œæ‰§è¡Œæ•°æ®ä¸‹è½½ç”Ÿæˆ python3 -m pip install -r requirements.txt python3 data_download.py # å¯¼å…¥åˆ° NebulaGraph docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}/yelp_nebulagraph_importer.yaml:/root/importer.yaml \\ -v ${PWD}/data:/root \\ vesoft/nebula-importer:v3.1.0 \\ --config /root/importer.yaml è¯¦æƒ…å‚è€ƒï¼šhttps://github.com/wey-gu/nebulagraph-yelp-frauddetection 1.5.1.2 æ•°æ®å¤„ç†è¿™éƒ¨åˆ†çš„ä»»åŠ¡æ˜¯å°†å›¾è°±ä¸­å’Œé£é™©ç›¸å…³å­å›¾çš„æ‹“æ‰‘ç»“æ„è¡¨ç¤ºå’Œå…¶ä¸­æœ‰å…³çš„ç‰¹å¾ï¼ˆå±æ€§ï¼‰è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ã€‚ DGL æœ¬èº«æ”¯æŒä»ç‚¹ã€è¾¹åˆ—è¡¨ï¼ˆedgelistï¼‰å½¢å¼ CSV æ–‡ä»¶ï¼Œæˆ–è€…ä» NetworkX å’Œ SciPy çš„åºåˆ—åŒ–ç¨€ç–çš„é‚»æ¥çŸ©é˜µï¼ˆadjacency matrixï¼‰çš„æ•°æ®æ¥æ„é€ å®ƒçš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸå§‹çš„å›¾æ•°æ®æˆ–è€…å›¾åº“ä¸­çš„æ•°æ®å…¨é‡å¯¼å‡ºä¸ºè¿™äº›å½¢å¼ï¼Œä¸è¿‡åœ¨çœŸå®çš„ä¾‹å­ä¸­å›¾åº“ä¸­çš„æ•°æ®æ˜¯å®æ—¶å˜åŒ–çš„ï¼Œèƒ½å¤Ÿç›´æ¥åœ¨ NebulaGraph ä¸­çš„å­å›¾ä¸Šåš GNN è®­ç»ƒä¸€èˆ¬æ¥è¯´æ˜¯æ›´ç†æƒ³ã€‚å¾—ç›Šäº Nebula-DGL è¿™ä¸ªåº“ï¼Œåšè¿™ä»¶äº‹å„¿æ˜¯å¾ˆè‡ªç„¶çš„ã€‚ æ³¨ï¼ŒDGL å¤–éƒ¨æ•°æ®å‘˜å¯¼å…¥æ–‡æ¡£ï¼šhttps://docs.dgl.ai/guide/graph-external.html ç°åœ¨æˆ‘ä»¬å¼€å§‹è¿™ä¸ªæ•°æ®çš„å¯¼å…¥ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘å…ˆä»‹ç»ä¸€ä¸‹ Nebula-DGLã€‚ Nebula-DGL å¯ä»¥æ ¹æ®ç»™å®šçš„æ˜ å°„å’Œè½¬æ¢è§„åˆ™ï¼ˆYAML æ ¼å¼ï¼‰ï¼Œå°† NebulaGraph ä¸­çš„é¡¶ç‚¹ã€è¾¹ï¼Œå’Œå®ƒä»¬çš„å±æ€§æŒ‰ç…§è§„åˆ™å¤„ç†æˆä¸ºç‚¹ã€è¾¹ã€å’Œå…¶ä¸­çš„æ ‡æ³¨ï¼ˆLabelï¼‰ä¸ç‰¹å¾ï¼ˆFeatureï¼‰ï¼Œä»è€Œæ„é€ ä¸º DGL çš„å›¾å¯¹è±¡ã€‚è¿™å…¶ä¸­ï¼Œå€¼å¾—ä¸€æçš„æ˜¯å±æ€§åˆ°ç‰¹å¾çš„è½¬æ¢ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œç‰¹å¾å¯èƒ½æ˜¯æŸä¸€ä¸ªå±æ€§çš„å€¼ã€ä¸€ä¸ªæˆ–è€…å¤šä¸ªå±æ€§çš„å€¼åšä¸€å®šçš„æ•°å­¦å˜æ¢ã€äº¦æˆ–æ˜¯å­—ç¬¦å‹çš„å±æ€§æŒ‰ç…§æšä¸¾è§„åˆ™è¾“å‡ºä¸ºæ•°å­—ã€‚ç›¸åº”çš„ï¼ŒNebula-DGL åœ¨è§„åˆ™ä¸­ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é’ˆå¯¹è¿™å‡ ç§æƒ…å†µåˆ©ç”¨ filter è¿›è¡Œè¡¨è¾¾ï¼š ç‰¹å¾ç›´æ¥é€‰å–å±æ€§çš„å€¼ï¼š è¿™ä¸ªä¾‹å­é‡Œï¼ŒNebulaGraph å›¾ä¸­ follow è¿™ä¸ªè¾¹å°†è¢«æŠ½å–ï¼Œè¾¹ä¸Šçš„å±æ€§ degree çš„å€¼å°†ç›´æ¥è¢«ä½œä¸ºåä¸º degree çš„ç‰¹å¾ã€‚ edge_types: - name: follow start_vertex_tag: player end_vertex_tag: player features: - name: degree properties: - name: degree type: int nullable: False filter: type: value ç‰¹å¾ä»å±æ€§ä¸­ç»è¿‡æ•°å­¦å˜æ¢ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ serve è¾¹ä¹‹ä¸­çš„ä¸¤ä¸ªå±æ€§è¿›è¡Œ (end_year - start_year) / 30 çš„å¤„ç†ï¼Œå˜ä¸º service_time è¿™æ ·çš„ä¸€ä¸ªç‰¹å¾ã€‚ edge_types: - name: serve start_vertex_tag: player end_vertex_tag: team features: - name: service_time properties: - name: start_year type: int nullable: False - name: end_year type: int nullable: False # The variable was mapped by order of properties filter: type: function function: \"lambda start_year, end_year: (end_year - start_year) / 30\" æšä¸¾å±æ€§å€¼ä¸ºæ•°å­—ç‰¹å¾ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ team é¡¶ç‚¹ä¸­çš„ name å±æ€§è¿›è¡Œæšä¸¾ï¼Œæ ¹æ®è¿™ä¸ªå¯¹äºæ˜¯è¥¿å²¸è¿˜æ˜¯ä¸œå²¸ï¼š vertex_tags: - name: team features: - name: coast properties: - name: name type: str nullable: False filter: # 0 stand for the east coast, 1 stand for the west coast type: enumeration enumeration: Celtics: 0 Nets: 0 Nuggets: 1 Timberwolves: 1 Thunder: 1 # ... not showing all teams here å¯ä»¥çœ‹åˆ°è¿™ä¸ªè½¬æ¢è§„åˆ™éå¸¸ç®€å•ç›´æ¥ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å‚è€ƒ Nebula-DGL çš„å®Œæ•´ä¾‹å­äº†è§£å…¨éƒ¨ç»†èŠ‚ https://github.com/wey-gu/nebula-dgl/tree/main/exampleã€‚è€Œæœ‰ä¸Šè¾¹æ•°æ®å¤„ç†è§„åˆ™çš„äº†è§£ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å¤„ç†è¿™ä¸ª Yelp å›¾æ•°æ®äº†ã€‚ é¦–å…ˆï¼Œå®šä¹‰å¦‚ä¸‹è§„åˆ™ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬æŠŠé¡¶ç‚¹ review å’Œä¸‰ç§è¾¹éƒ½å¯¹åº”è¿‡æ¥äº†ï¼ŒåŒæ—¶ï¼Œreview ä¸Šçš„å±æ€§ä¹ŸæŒ‰ç…§åŸæœ¬çš„å€¼å¯¹åº”äº†è¿‡æ¥ï¼š nebulagraph_yelp_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: yelp # str or int vertex_id_type: int vertex_tags: - name: review label: name: is_fraud properties: - name: is_fraud type: int nullable: False filter: type: value features: - name: f0 properties: - name: f0 type: float nullable: False filter: type: value - na","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:5","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#å›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 1.5 å›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•ç„¶è€Œï¼Œè¿™äº›å›¾ç‰¹å¾çš„æ–¹æ³•çš„é—®é¢˜åœ¨äºï¼š å›¾ç‰¹å¾å¹¶ä¸èƒ½æŠŠå…³è”å…³ç³»ï¼Œæ•°æ®çš„å±€éƒ¨æ€§å……åˆ†åæ˜ åˆ°æˆ‘ä»¬çš„æ¨¡å‹ã€æ–¹æ³•é‡Œï¼› å›¾çš„ç‰¹å¾å·¥ç¨‹æ˜¯å¾ˆæ˜‚è´µã€ç¹ççš„ã€‚ åœ¨æœ€è¿‘å‡ å¹´çš„æˆæœä¸­ï¼ŒåŸºäº GNN çš„æ–¹æ³•é€šè¿‡å°†å›¾ç»“æ„ä¸å±æ€§ä¿¡æ¯è¿›è¡ŒåµŒå…¥è¡¨ç¤ºï¼Œä½¿å¾—æˆ‘ä»¬èƒ½åœ¨ä¸è¿›è¡Œå›¾ç‰¹å¾æŠ½å–ã€ç‰¹å¾å·¥ç¨‹ã€ä¸“å®¶ä¸å·¥ç¨‹æ–¹æ³•çš„æ•°æ®æ ‡æ³¨çš„æƒ…å†µä¸‹ï¼Œå¾—åˆ°ç›¸æ¯”äºåŸºäºä¼ ç»Ÿå›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ›´å¥½çš„æ•ˆæœã€‚æœ‰æ„æ€çš„æ˜¯ï¼Œç°åœ¨æ­£æ˜¯è¿™äº›æ–¹æ³•å¿«é€Ÿè¢«å‘ç°ã€æ¼”è¿›çš„æ—¶æœŸï¼ŒåŸºäºå›¾çš„æ·±åº¦å­¦ä¹ æ˜¯ä¹‹å‰å‡ å¹´æœ€çƒ­é—¨çš„æœºå™¨å­¦ä¹ ç ”ç©¶æ–¹å‘ä¹‹ä¸€ã€‚ åŒæ—¶ï¼Œå›¾æ·±åº¦å­¦ä¹ çš„ä¸€äº›æ–¹æ³•å¯ä»¥åšåˆ° Inductive Learningâ€”â€”æ¨¡å‹å¯ä»¥åœ¨æ–°çš„ç‚¹ã€è¾¹ä¸Šè¿›è¡Œæ¨ç†ï¼Œè¿™æ ·ï¼Œé…åˆå›¾æ•°æ®åº“ä¸Šçº¿ä¸Šçš„å­å›¾æŸ¥è¯¢èƒ½åŠ›ï¼Œåœ¨çº¿å®æ—¶çš„é£é™©é¢„æµ‹ä¹Ÿå˜å¾—å¾ˆç®€å•å¯è¡Œäº†ã€‚ 1.5.1 åŸºäºå›¾è¡¨ç¤ºçš„å›¾ç¥ç»ç½‘ç»œæ¬ºè¯ˆæ£€æµ‹ç³»ç»Ÿç¤ºä¾‹åˆ©ç”¨ GNN çš„æ–¹æ³•ä¸­ï¼Œå›¾æ•°æ®åº“å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œæ•°æ®çš„å­˜å‚¨å¯ä»¥åœ¨å…¶ä»–å‡ ç§å¸¸è§çš„ä»‹è´¨ä¹‹ä¸­ï¼Œä½†æ˜¯å›¾åº“èƒ½å¤Ÿæœ€å¤§åŒ–åŠ©ç›Šæ¨¡å‹è®­ç»ƒã€æ¨¡å‹æ›´æ–°ã€çº¿ä¸Šç»“æœçš„æ›´æ–°ã€‚å½“æˆ‘ä»¬æŠŠå›¾æ•°æ®åº“ä½œä¸ºæ•°æ®çš„å•ä¸€æ•°æ®æ¥æºï¼ˆsingle source of truthï¼‰çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„åŸºäºçº¿ä¸Šã€ç¦»çº¿ã€å›¾è°±çš„æ–¹æ³•å¯ä»¥å¾ˆå®¹æ˜“è¢«é›†æˆèµ·æ¥ï¼Œä»è€Œç»„åˆæ‰€æœ‰æ–¹æ³•çš„ä¼˜åŠ¿ä¸ç»“æœï¼Œåšå‡ºæ›´æœ‰æ•ˆçš„æ¬ºè¯ˆæ£€æµ‹å¤åˆç³»ç»Ÿã€‚ åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬ä¸€æ ·åˆ†ä¸ºï¼šæ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€æ„å»ºæ£€æµ‹ç³»ç»Ÿè¿™å‡ éƒ¨åˆ†ã€‚ æ³¨ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl æˆ‘ä¹Ÿæ˜¯è¿™ä¸ªåº“çš„ä½œè€… ğŸ˜ 1.5.1.1 æ•°æ®é›†æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®é›†æ˜¯ Yelp-Fraudï¼Œä»–ç›´æ¥æ¥è‡ªäºè®ºæ–‡ Enhancing Graph Neural Network-based Fraud Detectors against Camouflaged Fraudstersã€‚ è¿™ä¸ªå›¾ä¸­æœ‰ä¸€ç§ç‚¹ï¼Œä¸‰ç§å…³ç³»ï¼š é¡¶ç‚¹ï¼šæ¥è‡ª Yelp ä¸­çš„é¤å…ã€é…’åº—çš„è¯„ä»·ï¼Œæœ‰ä¸¤ç±»å±æ€§ï¼š æ¯ä¸€ä¸ªè¯„ä»·ä¸­æœ‰è¢«æ ‡æ³¨äº†çš„æ˜¯å¦æ˜¯è™šå‡ã€æ¬ºè¯ˆè¯„ä»·çš„æ ‡ç­¾ 32 ä¸ªå·²ç»è¢«å¤„ç†è¿‡çš„æ•°å­—å‹å±æ€§ è¾¹ï¼šä¸‰ç±»è¯„ä»·ä¹‹é—´çš„å…³è”å…³ç³» R-U-Rï¼šä¸¤ä¸ªè¯„ä»·ç”±åŒä¸€ä¸ªç”¨æˆ·å‘å‡º shares_user_with R-S-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒè¯„åˆ†ï¼ˆè¯„åˆ†å¯ä»¥æ˜¯1åˆ°5ï¼‰ shares_restaurant_rating_with R-T-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒæäº¤æœˆä»½ shares_restaurant_in_one_month_with åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å‡è®¾è¿™ä¸ªå›¾å·²ç»åœ¨æˆ‘ä»¬çš„ NebulaGraph é‡Œè¾¹äº†ã€‚ æ³¨ï¼Œæˆ‘å·²ç»å¸®å¤§å®¶æå‰åšå¥½äº†å°†è¿™å¼ å›¾å¯¼å…¥ NebulaGraph çš„å·¥ä½œï¼Œé•¿è¯çŸ­è¯´å°±æ˜¯ï¼š # éƒ¨ç½² NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash # æ‹‰å–è¿™ä¸ªæ•°æ®çš„ Repo git clone https://github.com/wey-gu/nebulagraph-yelp-frauddetection \u0026\u0026 cd nebulagraph-yelp-frauddetection # å®‰è£…ä¾èµ–ï¼Œæ‰§è¡Œæ•°æ®ä¸‹è½½ç”Ÿæˆ python3 -m pip install -r requirements.txt python3 data_download.py # å¯¼å…¥åˆ° NebulaGraph docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}/yelp_nebulagraph_importer.yaml:/root/importer.yaml \\ -v ${PWD}/data:/root \\ vesoft/nebula-importer:v3.1.0 \\ --config /root/importer.yaml è¯¦æƒ…å‚è€ƒï¼šhttps://github.com/wey-gu/nebulagraph-yelp-frauddetection 1.5.1.2 æ•°æ®å¤„ç†è¿™éƒ¨åˆ†çš„ä»»åŠ¡æ˜¯å°†å›¾è°±ä¸­å’Œé£é™©ç›¸å…³å­å›¾çš„æ‹“æ‰‘ç»“æ„è¡¨ç¤ºå’Œå…¶ä¸­æœ‰å…³çš„ç‰¹å¾ï¼ˆå±æ€§ï¼‰è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ã€‚ DGL æœ¬èº«æ”¯æŒä»ç‚¹ã€è¾¹åˆ—è¡¨ï¼ˆedgelistï¼‰å½¢å¼ CSV æ–‡ä»¶ï¼Œæˆ–è€…ä» NetworkX å’Œ SciPy çš„åºåˆ—åŒ–ç¨€ç–çš„é‚»æ¥çŸ©é˜µï¼ˆadjacency matrixï¼‰çš„æ•°æ®æ¥æ„é€ å®ƒçš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸå§‹çš„å›¾æ•°æ®æˆ–è€…å›¾åº“ä¸­çš„æ•°æ®å…¨é‡å¯¼å‡ºä¸ºè¿™äº›å½¢å¼ï¼Œä¸è¿‡åœ¨çœŸå®çš„ä¾‹å­ä¸­å›¾åº“ä¸­çš„æ•°æ®æ˜¯å®æ—¶å˜åŒ–çš„ï¼Œèƒ½å¤Ÿç›´æ¥åœ¨ NebulaGraph ä¸­çš„å­å›¾ä¸Šåš GNN è®­ç»ƒä¸€èˆ¬æ¥è¯´æ˜¯æ›´ç†æƒ³ã€‚å¾—ç›Šäº Nebula-DGL è¿™ä¸ªåº“ï¼Œåšè¿™ä»¶äº‹å„¿æ˜¯å¾ˆè‡ªç„¶çš„ã€‚ æ³¨ï¼ŒDGL å¤–éƒ¨æ•°æ®å‘˜å¯¼å…¥æ–‡æ¡£ï¼šhttps://docs.dgl.ai/guide/graph-external.html ç°åœ¨æˆ‘ä»¬å¼€å§‹è¿™ä¸ªæ•°æ®çš„å¯¼å…¥ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘å…ˆä»‹ç»ä¸€ä¸‹ Nebula-DGLã€‚ Nebula-DGL å¯ä»¥æ ¹æ®ç»™å®šçš„æ˜ å°„å’Œè½¬æ¢è§„åˆ™ï¼ˆYAML æ ¼å¼ï¼‰ï¼Œå°† NebulaGraph ä¸­çš„é¡¶ç‚¹ã€è¾¹ï¼Œå’Œå®ƒä»¬çš„å±æ€§æŒ‰ç…§è§„åˆ™å¤„ç†æˆä¸ºç‚¹ã€è¾¹ã€å’Œå…¶ä¸­çš„æ ‡æ³¨ï¼ˆLabelï¼‰ä¸ç‰¹å¾ï¼ˆFeatureï¼‰ï¼Œä»è€Œæ„é€ ä¸º DGL çš„å›¾å¯¹è±¡ã€‚è¿™å…¶ä¸­ï¼Œå€¼å¾—ä¸€æçš„æ˜¯å±æ€§åˆ°ç‰¹å¾çš„è½¬æ¢ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œç‰¹å¾å¯èƒ½æ˜¯æŸä¸€ä¸ªå±æ€§çš„å€¼ã€ä¸€ä¸ªæˆ–è€…å¤šä¸ªå±æ€§çš„å€¼åšä¸€å®šçš„æ•°å­¦å˜æ¢ã€äº¦æˆ–æ˜¯å­—ç¬¦å‹çš„å±æ€§æŒ‰ç…§æšä¸¾è§„åˆ™è¾“å‡ºä¸ºæ•°å­—ã€‚ç›¸åº”çš„ï¼ŒNebula-DGL åœ¨è§„åˆ™ä¸­ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é’ˆå¯¹è¿™å‡ ç§æƒ…å†µåˆ©ç”¨ filter è¿›è¡Œè¡¨è¾¾ï¼š ç‰¹å¾ç›´æ¥é€‰å–å±æ€§çš„å€¼ï¼š è¿™ä¸ªä¾‹å­é‡Œï¼ŒNebulaGraph å›¾ä¸­ follow è¿™ä¸ªè¾¹å°†è¢«æŠ½å–ï¼Œè¾¹ä¸Šçš„å±æ€§ degree çš„å€¼å°†ç›´æ¥è¢«ä½œä¸ºåä¸º degree çš„ç‰¹å¾ã€‚ edge_types: - name: follow start_vertex_tag: player end_vertex_tag: player features: - name: degree properties: - name: degree type: int nullable: False filter: type: value ç‰¹å¾ä»å±æ€§ä¸­ç»è¿‡æ•°å­¦å˜æ¢ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ serve è¾¹ä¹‹ä¸­çš„ä¸¤ä¸ªå±æ€§è¿›è¡Œ (end_year - start_year) / 30 çš„å¤„ç†ï¼Œå˜ä¸º service_time è¿™æ ·çš„ä¸€ä¸ªç‰¹å¾ã€‚ edge_types: - name: serve start_vertex_tag: player end_vertex_tag: team features: - name: service_time properties: - name: start_year type: int nullable: False - name: end_year type: int nullable: False # The variable was mapped by order of properties filter: type: function function: \"lambda start_year, end_year: (end_year - start_year) / 30\" æšä¸¾å±æ€§å€¼ä¸ºæ•°å­—ç‰¹å¾ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ team é¡¶ç‚¹ä¸­çš„ name å±æ€§è¿›è¡Œæšä¸¾ï¼Œæ ¹æ®è¿™ä¸ªå¯¹äºæ˜¯è¥¿å²¸è¿˜æ˜¯ä¸œå²¸ï¼š vertex_tags: - name: team features: - name: coast properties: - name: name type: str nullable: False filter: # 0 stand for the east coast, 1 stand for the west coast type: enumeration enumeration: Celtics: 0 Nets: 0 Nuggets: 1 Timberwolves: 1 Thunder: 1 # ... not showing all teams here å¯ä»¥çœ‹åˆ°è¿™ä¸ªè½¬æ¢è§„åˆ™éå¸¸ç®€å•ç›´æ¥ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å‚è€ƒ Nebula-DGL çš„å®Œæ•´ä¾‹å­äº†è§£å…¨éƒ¨ç»†èŠ‚ https://github.com/wey-gu/nebula-dgl/tree/main/exampleã€‚è€Œæœ‰ä¸Šè¾¹æ•°æ®å¤„ç†è§„åˆ™çš„äº†è§£ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å¤„ç†è¿™ä¸ª Yelp å›¾æ•°æ®äº†ã€‚ é¦–å…ˆï¼Œå®šä¹‰å¦‚ä¸‹è§„åˆ™ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬æŠŠé¡¶ç‚¹ review å’Œä¸‰ç§è¾¹éƒ½å¯¹åº”è¿‡æ¥äº†ï¼ŒåŒæ—¶ï¼Œreview ä¸Šçš„å±æ€§ä¹ŸæŒ‰ç…§åŸæœ¬çš„å€¼å¯¹åº”äº†è¿‡æ¥ï¼š nebulagraph_yelp_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: yelp # str or int vertex_id_type: int vertex_tags: - name: review label: name: is_fraud properties: - name: is_fraud type: int nullable: False filter: type: value features: - name: f0 properties: - name: f0 type: float nullable: False filter: type: value - na","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:5","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#åŸºäºå›¾è¡¨ç¤ºçš„å›¾ç¥ç»ç½‘ç»œæ¬ºè¯ˆæ£€æµ‹ç³»ç»Ÿç¤ºä¾‹"},{"categories":["Nebula Graph"],"content":" 1.5 å›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•ç„¶è€Œï¼Œè¿™äº›å›¾ç‰¹å¾çš„æ–¹æ³•çš„é—®é¢˜åœ¨äºï¼š å›¾ç‰¹å¾å¹¶ä¸èƒ½æŠŠå…³è”å…³ç³»ï¼Œæ•°æ®çš„å±€éƒ¨æ€§å……åˆ†åæ˜ åˆ°æˆ‘ä»¬çš„æ¨¡å‹ã€æ–¹æ³•é‡Œï¼› å›¾çš„ç‰¹å¾å·¥ç¨‹æ˜¯å¾ˆæ˜‚è´µã€ç¹ççš„ã€‚ åœ¨æœ€è¿‘å‡ å¹´çš„æˆæœä¸­ï¼ŒåŸºäº GNN çš„æ–¹æ³•é€šè¿‡å°†å›¾ç»“æ„ä¸å±æ€§ä¿¡æ¯è¿›è¡ŒåµŒå…¥è¡¨ç¤ºï¼Œä½¿å¾—æˆ‘ä»¬èƒ½åœ¨ä¸è¿›è¡Œå›¾ç‰¹å¾æŠ½å–ã€ç‰¹å¾å·¥ç¨‹ã€ä¸“å®¶ä¸å·¥ç¨‹æ–¹æ³•çš„æ•°æ®æ ‡æ³¨çš„æƒ…å†µä¸‹ï¼Œå¾—åˆ°ç›¸æ¯”äºåŸºäºä¼ ç»Ÿå›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ›´å¥½çš„æ•ˆæœã€‚æœ‰æ„æ€çš„æ˜¯ï¼Œç°åœ¨æ­£æ˜¯è¿™äº›æ–¹æ³•å¿«é€Ÿè¢«å‘ç°ã€æ¼”è¿›çš„æ—¶æœŸï¼ŒåŸºäºå›¾çš„æ·±åº¦å­¦ä¹ æ˜¯ä¹‹å‰å‡ å¹´æœ€çƒ­é—¨çš„æœºå™¨å­¦ä¹ ç ”ç©¶æ–¹å‘ä¹‹ä¸€ã€‚ åŒæ—¶ï¼Œå›¾æ·±åº¦å­¦ä¹ çš„ä¸€äº›æ–¹æ³•å¯ä»¥åšåˆ° Inductive Learningâ€”â€”æ¨¡å‹å¯ä»¥åœ¨æ–°çš„ç‚¹ã€è¾¹ä¸Šè¿›è¡Œæ¨ç†ï¼Œè¿™æ ·ï¼Œé…åˆå›¾æ•°æ®åº“ä¸Šçº¿ä¸Šçš„å­å›¾æŸ¥è¯¢èƒ½åŠ›ï¼Œåœ¨çº¿å®æ—¶çš„é£é™©é¢„æµ‹ä¹Ÿå˜å¾—å¾ˆç®€å•å¯è¡Œäº†ã€‚ 1.5.1 åŸºäºå›¾è¡¨ç¤ºçš„å›¾ç¥ç»ç½‘ç»œæ¬ºè¯ˆæ£€æµ‹ç³»ç»Ÿç¤ºä¾‹åˆ©ç”¨ GNN çš„æ–¹æ³•ä¸­ï¼Œå›¾æ•°æ®åº“å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œæ•°æ®çš„å­˜å‚¨å¯ä»¥åœ¨å…¶ä»–å‡ ç§å¸¸è§çš„ä»‹è´¨ä¹‹ä¸­ï¼Œä½†æ˜¯å›¾åº“èƒ½å¤Ÿæœ€å¤§åŒ–åŠ©ç›Šæ¨¡å‹è®­ç»ƒã€æ¨¡å‹æ›´æ–°ã€çº¿ä¸Šç»“æœçš„æ›´æ–°ã€‚å½“æˆ‘ä»¬æŠŠå›¾æ•°æ®åº“ä½œä¸ºæ•°æ®çš„å•ä¸€æ•°æ®æ¥æºï¼ˆsingle source of truthï¼‰çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„åŸºäºçº¿ä¸Šã€ç¦»çº¿ã€å›¾è°±çš„æ–¹æ³•å¯ä»¥å¾ˆå®¹æ˜“è¢«é›†æˆèµ·æ¥ï¼Œä»è€Œç»„åˆæ‰€æœ‰æ–¹æ³•çš„ä¼˜åŠ¿ä¸ç»“æœï¼Œåšå‡ºæ›´æœ‰æ•ˆçš„æ¬ºè¯ˆæ£€æµ‹å¤åˆç³»ç»Ÿã€‚ åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬ä¸€æ ·åˆ†ä¸ºï¼šæ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€æ„å»ºæ£€æµ‹ç³»ç»Ÿè¿™å‡ éƒ¨åˆ†ã€‚ æ³¨ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl æˆ‘ä¹Ÿæ˜¯è¿™ä¸ªåº“çš„ä½œè€… ğŸ˜ 1.5.1.1 æ•°æ®é›†æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®é›†æ˜¯ Yelp-Fraudï¼Œä»–ç›´æ¥æ¥è‡ªäºè®ºæ–‡ Enhancing Graph Neural Network-based Fraud Detectors against Camouflaged Fraudstersã€‚ è¿™ä¸ªå›¾ä¸­æœ‰ä¸€ç§ç‚¹ï¼Œä¸‰ç§å…³ç³»ï¼š é¡¶ç‚¹ï¼šæ¥è‡ª Yelp ä¸­çš„é¤å…ã€é…’åº—çš„è¯„ä»·ï¼Œæœ‰ä¸¤ç±»å±æ€§ï¼š æ¯ä¸€ä¸ªè¯„ä»·ä¸­æœ‰è¢«æ ‡æ³¨äº†çš„æ˜¯å¦æ˜¯è™šå‡ã€æ¬ºè¯ˆè¯„ä»·çš„æ ‡ç­¾ 32 ä¸ªå·²ç»è¢«å¤„ç†è¿‡çš„æ•°å­—å‹å±æ€§ è¾¹ï¼šä¸‰ç±»è¯„ä»·ä¹‹é—´çš„å…³è”å…³ç³» R-U-Rï¼šä¸¤ä¸ªè¯„ä»·ç”±åŒä¸€ä¸ªç”¨æˆ·å‘å‡º shares_user_with R-S-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒè¯„åˆ†ï¼ˆè¯„åˆ†å¯ä»¥æ˜¯1åˆ°5ï¼‰ shares_restaurant_rating_with R-T-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒæäº¤æœˆä»½ shares_restaurant_in_one_month_with åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å‡è®¾è¿™ä¸ªå›¾å·²ç»åœ¨æˆ‘ä»¬çš„ NebulaGraph é‡Œè¾¹äº†ã€‚ æ³¨ï¼Œæˆ‘å·²ç»å¸®å¤§å®¶æå‰åšå¥½äº†å°†è¿™å¼ å›¾å¯¼å…¥ NebulaGraph çš„å·¥ä½œï¼Œé•¿è¯çŸ­è¯´å°±æ˜¯ï¼š # éƒ¨ç½² NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash # æ‹‰å–è¿™ä¸ªæ•°æ®çš„ Repo git clone https://github.com/wey-gu/nebulagraph-yelp-frauddetection \u0026\u0026 cd nebulagraph-yelp-frauddetection # å®‰è£…ä¾èµ–ï¼Œæ‰§è¡Œæ•°æ®ä¸‹è½½ç”Ÿæˆ python3 -m pip install -r requirements.txt python3 data_download.py # å¯¼å…¥åˆ° NebulaGraph docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}/yelp_nebulagraph_importer.yaml:/root/importer.yaml \\ -v ${PWD}/data:/root \\ vesoft/nebula-importer:v3.1.0 \\ --config /root/importer.yaml è¯¦æƒ…å‚è€ƒï¼šhttps://github.com/wey-gu/nebulagraph-yelp-frauddetection 1.5.1.2 æ•°æ®å¤„ç†è¿™éƒ¨åˆ†çš„ä»»åŠ¡æ˜¯å°†å›¾è°±ä¸­å’Œé£é™©ç›¸å…³å­å›¾çš„æ‹“æ‰‘ç»“æ„è¡¨ç¤ºå’Œå…¶ä¸­æœ‰å…³çš„ç‰¹å¾ï¼ˆå±æ€§ï¼‰è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ã€‚ DGL æœ¬èº«æ”¯æŒä»ç‚¹ã€è¾¹åˆ—è¡¨ï¼ˆedgelistï¼‰å½¢å¼ CSV æ–‡ä»¶ï¼Œæˆ–è€…ä» NetworkX å’Œ SciPy çš„åºåˆ—åŒ–ç¨€ç–çš„é‚»æ¥çŸ©é˜µï¼ˆadjacency matrixï¼‰çš„æ•°æ®æ¥æ„é€ å®ƒçš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸå§‹çš„å›¾æ•°æ®æˆ–è€…å›¾åº“ä¸­çš„æ•°æ®å…¨é‡å¯¼å‡ºä¸ºè¿™äº›å½¢å¼ï¼Œä¸è¿‡åœ¨çœŸå®çš„ä¾‹å­ä¸­å›¾åº“ä¸­çš„æ•°æ®æ˜¯å®æ—¶å˜åŒ–çš„ï¼Œèƒ½å¤Ÿç›´æ¥åœ¨ NebulaGraph ä¸­çš„å­å›¾ä¸Šåš GNN è®­ç»ƒä¸€èˆ¬æ¥è¯´æ˜¯æ›´ç†æƒ³ã€‚å¾—ç›Šäº Nebula-DGL è¿™ä¸ªåº“ï¼Œåšè¿™ä»¶äº‹å„¿æ˜¯å¾ˆè‡ªç„¶çš„ã€‚ æ³¨ï¼ŒDGL å¤–éƒ¨æ•°æ®å‘˜å¯¼å…¥æ–‡æ¡£ï¼šhttps://docs.dgl.ai/guide/graph-external.html ç°åœ¨æˆ‘ä»¬å¼€å§‹è¿™ä¸ªæ•°æ®çš„å¯¼å…¥ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘å…ˆä»‹ç»ä¸€ä¸‹ Nebula-DGLã€‚ Nebula-DGL å¯ä»¥æ ¹æ®ç»™å®šçš„æ˜ å°„å’Œè½¬æ¢è§„åˆ™ï¼ˆYAML æ ¼å¼ï¼‰ï¼Œå°† NebulaGraph ä¸­çš„é¡¶ç‚¹ã€è¾¹ï¼Œå’Œå®ƒä»¬çš„å±æ€§æŒ‰ç…§è§„åˆ™å¤„ç†æˆä¸ºç‚¹ã€è¾¹ã€å’Œå…¶ä¸­çš„æ ‡æ³¨ï¼ˆLabelï¼‰ä¸ç‰¹å¾ï¼ˆFeatureï¼‰ï¼Œä»è€Œæ„é€ ä¸º DGL çš„å›¾å¯¹è±¡ã€‚è¿™å…¶ä¸­ï¼Œå€¼å¾—ä¸€æçš„æ˜¯å±æ€§åˆ°ç‰¹å¾çš„è½¬æ¢ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œç‰¹å¾å¯èƒ½æ˜¯æŸä¸€ä¸ªå±æ€§çš„å€¼ã€ä¸€ä¸ªæˆ–è€…å¤šä¸ªå±æ€§çš„å€¼åšä¸€å®šçš„æ•°å­¦å˜æ¢ã€äº¦æˆ–æ˜¯å­—ç¬¦å‹çš„å±æ€§æŒ‰ç…§æšä¸¾è§„åˆ™è¾“å‡ºä¸ºæ•°å­—ã€‚ç›¸åº”çš„ï¼ŒNebula-DGL åœ¨è§„åˆ™ä¸­ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é’ˆå¯¹è¿™å‡ ç§æƒ…å†µåˆ©ç”¨ filter è¿›è¡Œè¡¨è¾¾ï¼š ç‰¹å¾ç›´æ¥é€‰å–å±æ€§çš„å€¼ï¼š è¿™ä¸ªä¾‹å­é‡Œï¼ŒNebulaGraph å›¾ä¸­ follow è¿™ä¸ªè¾¹å°†è¢«æŠ½å–ï¼Œè¾¹ä¸Šçš„å±æ€§ degree çš„å€¼å°†ç›´æ¥è¢«ä½œä¸ºåä¸º degree çš„ç‰¹å¾ã€‚ edge_types: - name: follow start_vertex_tag: player end_vertex_tag: player features: - name: degree properties: - name: degree type: int nullable: False filter: type: value ç‰¹å¾ä»å±æ€§ä¸­ç»è¿‡æ•°å­¦å˜æ¢ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ serve è¾¹ä¹‹ä¸­çš„ä¸¤ä¸ªå±æ€§è¿›è¡Œ (end_year - start_year) / 30 çš„å¤„ç†ï¼Œå˜ä¸º service_time è¿™æ ·çš„ä¸€ä¸ªç‰¹å¾ã€‚ edge_types: - name: serve start_vertex_tag: player end_vertex_tag: team features: - name: service_time properties: - name: start_year type: int nullable: False - name: end_year type: int nullable: False # The variable was mapped by order of properties filter: type: function function: \"lambda start_year, end_year: (end_year - start_year) / 30\" æšä¸¾å±æ€§å€¼ä¸ºæ•°å­—ç‰¹å¾ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ team é¡¶ç‚¹ä¸­çš„ name å±æ€§è¿›è¡Œæšä¸¾ï¼Œæ ¹æ®è¿™ä¸ªå¯¹äºæ˜¯è¥¿å²¸è¿˜æ˜¯ä¸œå²¸ï¼š vertex_tags: - name: team features: - name: coast properties: - name: name type: str nullable: False filter: # 0 stand for the east coast, 1 stand for the west coast type: enumeration enumeration: Celtics: 0 Nets: 0 Nuggets: 1 Timberwolves: 1 Thunder: 1 # ... not showing all teams here å¯ä»¥çœ‹åˆ°è¿™ä¸ªè½¬æ¢è§„åˆ™éå¸¸ç®€å•ç›´æ¥ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å‚è€ƒ Nebula-DGL çš„å®Œæ•´ä¾‹å­äº†è§£å…¨éƒ¨ç»†èŠ‚ https://github.com/wey-gu/nebula-dgl/tree/main/exampleã€‚è€Œæœ‰ä¸Šè¾¹æ•°æ®å¤„ç†è§„åˆ™çš„äº†è§£ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å¤„ç†è¿™ä¸ª Yelp å›¾æ•°æ®äº†ã€‚ é¦–å…ˆï¼Œå®šä¹‰å¦‚ä¸‹è§„åˆ™ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬æŠŠé¡¶ç‚¹ review å’Œä¸‰ç§è¾¹éƒ½å¯¹åº”è¿‡æ¥äº†ï¼ŒåŒæ—¶ï¼Œreview ä¸Šçš„å±æ€§ä¹ŸæŒ‰ç…§åŸæœ¬çš„å€¼å¯¹åº”äº†è¿‡æ¥ï¼š nebulagraph_yelp_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: yelp # str or int vertex_id_type: int vertex_tags: - name: review label: name: is_fraud properties: - name: is_fraud type: int nullable: False filter: type: value features: - name: f0 properties: - name: f0 type: float nullable: False filter: type: value - na","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:5","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#æ•°æ®é›†"},{"categories":["Nebula Graph"],"content":" 1.5 å›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•ç„¶è€Œï¼Œè¿™äº›å›¾ç‰¹å¾çš„æ–¹æ³•çš„é—®é¢˜åœ¨äºï¼š å›¾ç‰¹å¾å¹¶ä¸èƒ½æŠŠå…³è”å…³ç³»ï¼Œæ•°æ®çš„å±€éƒ¨æ€§å……åˆ†åæ˜ åˆ°æˆ‘ä»¬çš„æ¨¡å‹ã€æ–¹æ³•é‡Œï¼› å›¾çš„ç‰¹å¾å·¥ç¨‹æ˜¯å¾ˆæ˜‚è´µã€ç¹ççš„ã€‚ åœ¨æœ€è¿‘å‡ å¹´çš„æˆæœä¸­ï¼ŒåŸºäº GNN çš„æ–¹æ³•é€šè¿‡å°†å›¾ç»“æ„ä¸å±æ€§ä¿¡æ¯è¿›è¡ŒåµŒå…¥è¡¨ç¤ºï¼Œä½¿å¾—æˆ‘ä»¬èƒ½åœ¨ä¸è¿›è¡Œå›¾ç‰¹å¾æŠ½å–ã€ç‰¹å¾å·¥ç¨‹ã€ä¸“å®¶ä¸å·¥ç¨‹æ–¹æ³•çš„æ•°æ®æ ‡æ³¨çš„æƒ…å†µä¸‹ï¼Œå¾—åˆ°ç›¸æ¯”äºåŸºäºä¼ ç»Ÿå›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ›´å¥½çš„æ•ˆæœã€‚æœ‰æ„æ€çš„æ˜¯ï¼Œç°åœ¨æ­£æ˜¯è¿™äº›æ–¹æ³•å¿«é€Ÿè¢«å‘ç°ã€æ¼”è¿›çš„æ—¶æœŸï¼ŒåŸºäºå›¾çš„æ·±åº¦å­¦ä¹ æ˜¯ä¹‹å‰å‡ å¹´æœ€çƒ­é—¨çš„æœºå™¨å­¦ä¹ ç ”ç©¶æ–¹å‘ä¹‹ä¸€ã€‚ åŒæ—¶ï¼Œå›¾æ·±åº¦å­¦ä¹ çš„ä¸€äº›æ–¹æ³•å¯ä»¥åšåˆ° Inductive Learningâ€”â€”æ¨¡å‹å¯ä»¥åœ¨æ–°çš„ç‚¹ã€è¾¹ä¸Šè¿›è¡Œæ¨ç†ï¼Œè¿™æ ·ï¼Œé…åˆå›¾æ•°æ®åº“ä¸Šçº¿ä¸Šçš„å­å›¾æŸ¥è¯¢èƒ½åŠ›ï¼Œåœ¨çº¿å®æ—¶çš„é£é™©é¢„æµ‹ä¹Ÿå˜å¾—å¾ˆç®€å•å¯è¡Œäº†ã€‚ 1.5.1 åŸºäºå›¾è¡¨ç¤ºçš„å›¾ç¥ç»ç½‘ç»œæ¬ºè¯ˆæ£€æµ‹ç³»ç»Ÿç¤ºä¾‹åˆ©ç”¨ GNN çš„æ–¹æ³•ä¸­ï¼Œå›¾æ•°æ®åº“å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œæ•°æ®çš„å­˜å‚¨å¯ä»¥åœ¨å…¶ä»–å‡ ç§å¸¸è§çš„ä»‹è´¨ä¹‹ä¸­ï¼Œä½†æ˜¯å›¾åº“èƒ½å¤Ÿæœ€å¤§åŒ–åŠ©ç›Šæ¨¡å‹è®­ç»ƒã€æ¨¡å‹æ›´æ–°ã€çº¿ä¸Šç»“æœçš„æ›´æ–°ã€‚å½“æˆ‘ä»¬æŠŠå›¾æ•°æ®åº“ä½œä¸ºæ•°æ®çš„å•ä¸€æ•°æ®æ¥æºï¼ˆsingle source of truthï¼‰çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„åŸºäºçº¿ä¸Šã€ç¦»çº¿ã€å›¾è°±çš„æ–¹æ³•å¯ä»¥å¾ˆå®¹æ˜“è¢«é›†æˆèµ·æ¥ï¼Œä»è€Œç»„åˆæ‰€æœ‰æ–¹æ³•çš„ä¼˜åŠ¿ä¸ç»“æœï¼Œåšå‡ºæ›´æœ‰æ•ˆçš„æ¬ºè¯ˆæ£€æµ‹å¤åˆç³»ç»Ÿã€‚ åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬ä¸€æ ·åˆ†ä¸ºï¼šæ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€æ„å»ºæ£€æµ‹ç³»ç»Ÿè¿™å‡ éƒ¨åˆ†ã€‚ æ³¨ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl æˆ‘ä¹Ÿæ˜¯è¿™ä¸ªåº“çš„ä½œè€… ğŸ˜ 1.5.1.1 æ•°æ®é›†æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®é›†æ˜¯ Yelp-Fraudï¼Œä»–ç›´æ¥æ¥è‡ªäºè®ºæ–‡ Enhancing Graph Neural Network-based Fraud Detectors against Camouflaged Fraudstersã€‚ è¿™ä¸ªå›¾ä¸­æœ‰ä¸€ç§ç‚¹ï¼Œä¸‰ç§å…³ç³»ï¼š é¡¶ç‚¹ï¼šæ¥è‡ª Yelp ä¸­çš„é¤å…ã€é…’åº—çš„è¯„ä»·ï¼Œæœ‰ä¸¤ç±»å±æ€§ï¼š æ¯ä¸€ä¸ªè¯„ä»·ä¸­æœ‰è¢«æ ‡æ³¨äº†çš„æ˜¯å¦æ˜¯è™šå‡ã€æ¬ºè¯ˆè¯„ä»·çš„æ ‡ç­¾ 32 ä¸ªå·²ç»è¢«å¤„ç†è¿‡çš„æ•°å­—å‹å±æ€§ è¾¹ï¼šä¸‰ç±»è¯„ä»·ä¹‹é—´çš„å…³è”å…³ç³» R-U-Rï¼šä¸¤ä¸ªè¯„ä»·ç”±åŒä¸€ä¸ªç”¨æˆ·å‘å‡º shares_user_with R-S-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒè¯„åˆ†ï¼ˆè¯„åˆ†å¯ä»¥æ˜¯1åˆ°5ï¼‰ shares_restaurant_rating_with R-T-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒæäº¤æœˆä»½ shares_restaurant_in_one_month_with åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å‡è®¾è¿™ä¸ªå›¾å·²ç»åœ¨æˆ‘ä»¬çš„ NebulaGraph é‡Œè¾¹äº†ã€‚ æ³¨ï¼Œæˆ‘å·²ç»å¸®å¤§å®¶æå‰åšå¥½äº†å°†è¿™å¼ å›¾å¯¼å…¥ NebulaGraph çš„å·¥ä½œï¼Œé•¿è¯çŸ­è¯´å°±æ˜¯ï¼š # éƒ¨ç½² NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash # æ‹‰å–è¿™ä¸ªæ•°æ®çš„ Repo git clone https://github.com/wey-gu/nebulagraph-yelp-frauddetection \u0026\u0026 cd nebulagraph-yelp-frauddetection # å®‰è£…ä¾èµ–ï¼Œæ‰§è¡Œæ•°æ®ä¸‹è½½ç”Ÿæˆ python3 -m pip install -r requirements.txt python3 data_download.py # å¯¼å…¥åˆ° NebulaGraph docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}/yelp_nebulagraph_importer.yaml:/root/importer.yaml \\ -v ${PWD}/data:/root \\ vesoft/nebula-importer:v3.1.0 \\ --config /root/importer.yaml è¯¦æƒ…å‚è€ƒï¼šhttps://github.com/wey-gu/nebulagraph-yelp-frauddetection 1.5.1.2 æ•°æ®å¤„ç†è¿™éƒ¨åˆ†çš„ä»»åŠ¡æ˜¯å°†å›¾è°±ä¸­å’Œé£é™©ç›¸å…³å­å›¾çš„æ‹“æ‰‘ç»“æ„è¡¨ç¤ºå’Œå…¶ä¸­æœ‰å…³çš„ç‰¹å¾ï¼ˆå±æ€§ï¼‰è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ã€‚ DGL æœ¬èº«æ”¯æŒä»ç‚¹ã€è¾¹åˆ—è¡¨ï¼ˆedgelistï¼‰å½¢å¼ CSV æ–‡ä»¶ï¼Œæˆ–è€…ä» NetworkX å’Œ SciPy çš„åºåˆ—åŒ–ç¨€ç–çš„é‚»æ¥çŸ©é˜µï¼ˆadjacency matrixï¼‰çš„æ•°æ®æ¥æ„é€ å®ƒçš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸå§‹çš„å›¾æ•°æ®æˆ–è€…å›¾åº“ä¸­çš„æ•°æ®å…¨é‡å¯¼å‡ºä¸ºè¿™äº›å½¢å¼ï¼Œä¸è¿‡åœ¨çœŸå®çš„ä¾‹å­ä¸­å›¾åº“ä¸­çš„æ•°æ®æ˜¯å®æ—¶å˜åŒ–çš„ï¼Œèƒ½å¤Ÿç›´æ¥åœ¨ NebulaGraph ä¸­çš„å­å›¾ä¸Šåš GNN è®­ç»ƒä¸€èˆ¬æ¥è¯´æ˜¯æ›´ç†æƒ³ã€‚å¾—ç›Šäº Nebula-DGL è¿™ä¸ªåº“ï¼Œåšè¿™ä»¶äº‹å„¿æ˜¯å¾ˆè‡ªç„¶çš„ã€‚ æ³¨ï¼ŒDGL å¤–éƒ¨æ•°æ®å‘˜å¯¼å…¥æ–‡æ¡£ï¼šhttps://docs.dgl.ai/guide/graph-external.html ç°åœ¨æˆ‘ä»¬å¼€å§‹è¿™ä¸ªæ•°æ®çš„å¯¼å…¥ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘å…ˆä»‹ç»ä¸€ä¸‹ Nebula-DGLã€‚ Nebula-DGL å¯ä»¥æ ¹æ®ç»™å®šçš„æ˜ å°„å’Œè½¬æ¢è§„åˆ™ï¼ˆYAML æ ¼å¼ï¼‰ï¼Œå°† NebulaGraph ä¸­çš„é¡¶ç‚¹ã€è¾¹ï¼Œå’Œå®ƒä»¬çš„å±æ€§æŒ‰ç…§è§„åˆ™å¤„ç†æˆä¸ºç‚¹ã€è¾¹ã€å’Œå…¶ä¸­çš„æ ‡æ³¨ï¼ˆLabelï¼‰ä¸ç‰¹å¾ï¼ˆFeatureï¼‰ï¼Œä»è€Œæ„é€ ä¸º DGL çš„å›¾å¯¹è±¡ã€‚è¿™å…¶ä¸­ï¼Œå€¼å¾—ä¸€æçš„æ˜¯å±æ€§åˆ°ç‰¹å¾çš„è½¬æ¢ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œç‰¹å¾å¯èƒ½æ˜¯æŸä¸€ä¸ªå±æ€§çš„å€¼ã€ä¸€ä¸ªæˆ–è€…å¤šä¸ªå±æ€§çš„å€¼åšä¸€å®šçš„æ•°å­¦å˜æ¢ã€äº¦æˆ–æ˜¯å­—ç¬¦å‹çš„å±æ€§æŒ‰ç…§æšä¸¾è§„åˆ™è¾“å‡ºä¸ºæ•°å­—ã€‚ç›¸åº”çš„ï¼ŒNebula-DGL åœ¨è§„åˆ™ä¸­ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é’ˆå¯¹è¿™å‡ ç§æƒ…å†µåˆ©ç”¨ filter è¿›è¡Œè¡¨è¾¾ï¼š ç‰¹å¾ç›´æ¥é€‰å–å±æ€§çš„å€¼ï¼š è¿™ä¸ªä¾‹å­é‡Œï¼ŒNebulaGraph å›¾ä¸­ follow è¿™ä¸ªè¾¹å°†è¢«æŠ½å–ï¼Œè¾¹ä¸Šçš„å±æ€§ degree çš„å€¼å°†ç›´æ¥è¢«ä½œä¸ºåä¸º degree çš„ç‰¹å¾ã€‚ edge_types: - name: follow start_vertex_tag: player end_vertex_tag: player features: - name: degree properties: - name: degree type: int nullable: False filter: type: value ç‰¹å¾ä»å±æ€§ä¸­ç»è¿‡æ•°å­¦å˜æ¢ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ serve è¾¹ä¹‹ä¸­çš„ä¸¤ä¸ªå±æ€§è¿›è¡Œ (end_year - start_year) / 30 çš„å¤„ç†ï¼Œå˜ä¸º service_time è¿™æ ·çš„ä¸€ä¸ªç‰¹å¾ã€‚ edge_types: - name: serve start_vertex_tag: player end_vertex_tag: team features: - name: service_time properties: - name: start_year type: int nullable: False - name: end_year type: int nullable: False # The variable was mapped by order of properties filter: type: function function: \"lambda start_year, end_year: (end_year - start_year) / 30\" æšä¸¾å±æ€§å€¼ä¸ºæ•°å­—ç‰¹å¾ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ team é¡¶ç‚¹ä¸­çš„ name å±æ€§è¿›è¡Œæšä¸¾ï¼Œæ ¹æ®è¿™ä¸ªå¯¹äºæ˜¯è¥¿å²¸è¿˜æ˜¯ä¸œå²¸ï¼š vertex_tags: - name: team features: - name: coast properties: - name: name type: str nullable: False filter: # 0 stand for the east coast, 1 stand for the west coast type: enumeration enumeration: Celtics: 0 Nets: 0 Nuggets: 1 Timberwolves: 1 Thunder: 1 # ... not showing all teams here å¯ä»¥çœ‹åˆ°è¿™ä¸ªè½¬æ¢è§„åˆ™éå¸¸ç®€å•ç›´æ¥ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å‚è€ƒ Nebula-DGL çš„å®Œæ•´ä¾‹å­äº†è§£å…¨éƒ¨ç»†èŠ‚ https://github.com/wey-gu/nebula-dgl/tree/main/exampleã€‚è€Œæœ‰ä¸Šè¾¹æ•°æ®å¤„ç†è§„åˆ™çš„äº†è§£ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å¤„ç†è¿™ä¸ª Yelp å›¾æ•°æ®äº†ã€‚ é¦–å…ˆï¼Œå®šä¹‰å¦‚ä¸‹è§„åˆ™ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬æŠŠé¡¶ç‚¹ review å’Œä¸‰ç§è¾¹éƒ½å¯¹åº”è¿‡æ¥äº†ï¼ŒåŒæ—¶ï¼Œreview ä¸Šçš„å±æ€§ä¹ŸæŒ‰ç…§åŸæœ¬çš„å€¼å¯¹åº”äº†è¿‡æ¥ï¼š nebulagraph_yelp_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: yelp # str or int vertex_id_type: int vertex_tags: - name: review label: name: is_fraud properties: - name: is_fraud type: int nullable: False filter: type: value features: - name: f0 properties: - name: f0 type: float nullable: False filter: type: value - na","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:5","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#æ•°æ®å¤„ç†"},{"categories":["Nebula Graph"],"content":" 1.5 å›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•ç„¶è€Œï¼Œè¿™äº›å›¾ç‰¹å¾çš„æ–¹æ³•çš„é—®é¢˜åœ¨äºï¼š å›¾ç‰¹å¾å¹¶ä¸èƒ½æŠŠå…³è”å…³ç³»ï¼Œæ•°æ®çš„å±€éƒ¨æ€§å……åˆ†åæ˜ åˆ°æˆ‘ä»¬çš„æ¨¡å‹ã€æ–¹æ³•é‡Œï¼› å›¾çš„ç‰¹å¾å·¥ç¨‹æ˜¯å¾ˆæ˜‚è´µã€ç¹ççš„ã€‚ åœ¨æœ€è¿‘å‡ å¹´çš„æˆæœä¸­ï¼ŒåŸºäº GNN çš„æ–¹æ³•é€šè¿‡å°†å›¾ç»“æ„ä¸å±æ€§ä¿¡æ¯è¿›è¡ŒåµŒå…¥è¡¨ç¤ºï¼Œä½¿å¾—æˆ‘ä»¬èƒ½åœ¨ä¸è¿›è¡Œå›¾ç‰¹å¾æŠ½å–ã€ç‰¹å¾å·¥ç¨‹ã€ä¸“å®¶ä¸å·¥ç¨‹æ–¹æ³•çš„æ•°æ®æ ‡æ³¨çš„æƒ…å†µä¸‹ï¼Œå¾—åˆ°ç›¸æ¯”äºåŸºäºä¼ ç»Ÿå›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ›´å¥½çš„æ•ˆæœã€‚æœ‰æ„æ€çš„æ˜¯ï¼Œç°åœ¨æ­£æ˜¯è¿™äº›æ–¹æ³•å¿«é€Ÿè¢«å‘ç°ã€æ¼”è¿›çš„æ—¶æœŸï¼ŒåŸºäºå›¾çš„æ·±åº¦å­¦ä¹ æ˜¯ä¹‹å‰å‡ å¹´æœ€çƒ­é—¨çš„æœºå™¨å­¦ä¹ ç ”ç©¶æ–¹å‘ä¹‹ä¸€ã€‚ åŒæ—¶ï¼Œå›¾æ·±åº¦å­¦ä¹ çš„ä¸€äº›æ–¹æ³•å¯ä»¥åšåˆ° Inductive Learningâ€”â€”æ¨¡å‹å¯ä»¥åœ¨æ–°çš„ç‚¹ã€è¾¹ä¸Šè¿›è¡Œæ¨ç†ï¼Œè¿™æ ·ï¼Œé…åˆå›¾æ•°æ®åº“ä¸Šçº¿ä¸Šçš„å­å›¾æŸ¥è¯¢èƒ½åŠ›ï¼Œåœ¨çº¿å®æ—¶çš„é£é™©é¢„æµ‹ä¹Ÿå˜å¾—å¾ˆç®€å•å¯è¡Œäº†ã€‚ 1.5.1 åŸºäºå›¾è¡¨ç¤ºçš„å›¾ç¥ç»ç½‘ç»œæ¬ºè¯ˆæ£€æµ‹ç³»ç»Ÿç¤ºä¾‹åˆ©ç”¨ GNN çš„æ–¹æ³•ä¸­ï¼Œå›¾æ•°æ®åº“å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œæ•°æ®çš„å­˜å‚¨å¯ä»¥åœ¨å…¶ä»–å‡ ç§å¸¸è§çš„ä»‹è´¨ä¹‹ä¸­ï¼Œä½†æ˜¯å›¾åº“èƒ½å¤Ÿæœ€å¤§åŒ–åŠ©ç›Šæ¨¡å‹è®­ç»ƒã€æ¨¡å‹æ›´æ–°ã€çº¿ä¸Šç»“æœçš„æ›´æ–°ã€‚å½“æˆ‘ä»¬æŠŠå›¾æ•°æ®åº“ä½œä¸ºæ•°æ®çš„å•ä¸€æ•°æ®æ¥æºï¼ˆsingle source of truthï¼‰çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„åŸºäºçº¿ä¸Šã€ç¦»çº¿ã€å›¾è°±çš„æ–¹æ³•å¯ä»¥å¾ˆå®¹æ˜“è¢«é›†æˆèµ·æ¥ï¼Œä»è€Œç»„åˆæ‰€æœ‰æ–¹æ³•çš„ä¼˜åŠ¿ä¸ç»“æœï¼Œåšå‡ºæ›´æœ‰æ•ˆçš„æ¬ºè¯ˆæ£€æµ‹å¤åˆç³»ç»Ÿã€‚ åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬ä¸€æ ·åˆ†ä¸ºï¼šæ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€æ„å»ºæ£€æµ‹ç³»ç»Ÿè¿™å‡ éƒ¨åˆ†ã€‚ æ³¨ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl æˆ‘ä¹Ÿæ˜¯è¿™ä¸ªåº“çš„ä½œè€… ğŸ˜ 1.5.1.1 æ•°æ®é›†æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®é›†æ˜¯ Yelp-Fraudï¼Œä»–ç›´æ¥æ¥è‡ªäºè®ºæ–‡ Enhancing Graph Neural Network-based Fraud Detectors against Camouflaged Fraudstersã€‚ è¿™ä¸ªå›¾ä¸­æœ‰ä¸€ç§ç‚¹ï¼Œä¸‰ç§å…³ç³»ï¼š é¡¶ç‚¹ï¼šæ¥è‡ª Yelp ä¸­çš„é¤å…ã€é…’åº—çš„è¯„ä»·ï¼Œæœ‰ä¸¤ç±»å±æ€§ï¼š æ¯ä¸€ä¸ªè¯„ä»·ä¸­æœ‰è¢«æ ‡æ³¨äº†çš„æ˜¯å¦æ˜¯è™šå‡ã€æ¬ºè¯ˆè¯„ä»·çš„æ ‡ç­¾ 32 ä¸ªå·²ç»è¢«å¤„ç†è¿‡çš„æ•°å­—å‹å±æ€§ è¾¹ï¼šä¸‰ç±»è¯„ä»·ä¹‹é—´çš„å…³è”å…³ç³» R-U-Rï¼šä¸¤ä¸ªè¯„ä»·ç”±åŒä¸€ä¸ªç”¨æˆ·å‘å‡º shares_user_with R-S-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒè¯„åˆ†ï¼ˆè¯„åˆ†å¯ä»¥æ˜¯1åˆ°5ï¼‰ shares_restaurant_rating_with R-T-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒæäº¤æœˆä»½ shares_restaurant_in_one_month_with åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å‡è®¾è¿™ä¸ªå›¾å·²ç»åœ¨æˆ‘ä»¬çš„ NebulaGraph é‡Œè¾¹äº†ã€‚ æ³¨ï¼Œæˆ‘å·²ç»å¸®å¤§å®¶æå‰åšå¥½äº†å°†è¿™å¼ å›¾å¯¼å…¥ NebulaGraph çš„å·¥ä½œï¼Œé•¿è¯çŸ­è¯´å°±æ˜¯ï¼š # éƒ¨ç½² NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash # æ‹‰å–è¿™ä¸ªæ•°æ®çš„ Repo git clone https://github.com/wey-gu/nebulagraph-yelp-frauddetection \u0026\u0026 cd nebulagraph-yelp-frauddetection # å®‰è£…ä¾èµ–ï¼Œæ‰§è¡Œæ•°æ®ä¸‹è½½ç”Ÿæˆ python3 -m pip install -r requirements.txt python3 data_download.py # å¯¼å…¥åˆ° NebulaGraph docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}/yelp_nebulagraph_importer.yaml:/root/importer.yaml \\ -v ${PWD}/data:/root \\ vesoft/nebula-importer:v3.1.0 \\ --config /root/importer.yaml è¯¦æƒ…å‚è€ƒï¼šhttps://github.com/wey-gu/nebulagraph-yelp-frauddetection 1.5.1.2 æ•°æ®å¤„ç†è¿™éƒ¨åˆ†çš„ä»»åŠ¡æ˜¯å°†å›¾è°±ä¸­å’Œé£é™©ç›¸å…³å­å›¾çš„æ‹“æ‰‘ç»“æ„è¡¨ç¤ºå’Œå…¶ä¸­æœ‰å…³çš„ç‰¹å¾ï¼ˆå±æ€§ï¼‰è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ã€‚ DGL æœ¬èº«æ”¯æŒä»ç‚¹ã€è¾¹åˆ—è¡¨ï¼ˆedgelistï¼‰å½¢å¼ CSV æ–‡ä»¶ï¼Œæˆ–è€…ä» NetworkX å’Œ SciPy çš„åºåˆ—åŒ–ç¨€ç–çš„é‚»æ¥çŸ©é˜µï¼ˆadjacency matrixï¼‰çš„æ•°æ®æ¥æ„é€ å®ƒçš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸå§‹çš„å›¾æ•°æ®æˆ–è€…å›¾åº“ä¸­çš„æ•°æ®å…¨é‡å¯¼å‡ºä¸ºè¿™äº›å½¢å¼ï¼Œä¸è¿‡åœ¨çœŸå®çš„ä¾‹å­ä¸­å›¾åº“ä¸­çš„æ•°æ®æ˜¯å®æ—¶å˜åŒ–çš„ï¼Œèƒ½å¤Ÿç›´æ¥åœ¨ NebulaGraph ä¸­çš„å­å›¾ä¸Šåš GNN è®­ç»ƒä¸€èˆ¬æ¥è¯´æ˜¯æ›´ç†æƒ³ã€‚å¾—ç›Šäº Nebula-DGL è¿™ä¸ªåº“ï¼Œåšè¿™ä»¶äº‹å„¿æ˜¯å¾ˆè‡ªç„¶çš„ã€‚ æ³¨ï¼ŒDGL å¤–éƒ¨æ•°æ®å‘˜å¯¼å…¥æ–‡æ¡£ï¼šhttps://docs.dgl.ai/guide/graph-external.html ç°åœ¨æˆ‘ä»¬å¼€å§‹è¿™ä¸ªæ•°æ®çš„å¯¼å…¥ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘å…ˆä»‹ç»ä¸€ä¸‹ Nebula-DGLã€‚ Nebula-DGL å¯ä»¥æ ¹æ®ç»™å®šçš„æ˜ å°„å’Œè½¬æ¢è§„åˆ™ï¼ˆYAML æ ¼å¼ï¼‰ï¼Œå°† NebulaGraph ä¸­çš„é¡¶ç‚¹ã€è¾¹ï¼Œå’Œå®ƒä»¬çš„å±æ€§æŒ‰ç…§è§„åˆ™å¤„ç†æˆä¸ºç‚¹ã€è¾¹ã€å’Œå…¶ä¸­çš„æ ‡æ³¨ï¼ˆLabelï¼‰ä¸ç‰¹å¾ï¼ˆFeatureï¼‰ï¼Œä»è€Œæ„é€ ä¸º DGL çš„å›¾å¯¹è±¡ã€‚è¿™å…¶ä¸­ï¼Œå€¼å¾—ä¸€æçš„æ˜¯å±æ€§åˆ°ç‰¹å¾çš„è½¬æ¢ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œç‰¹å¾å¯èƒ½æ˜¯æŸä¸€ä¸ªå±æ€§çš„å€¼ã€ä¸€ä¸ªæˆ–è€…å¤šä¸ªå±æ€§çš„å€¼åšä¸€å®šçš„æ•°å­¦å˜æ¢ã€äº¦æˆ–æ˜¯å­—ç¬¦å‹çš„å±æ€§æŒ‰ç…§æšä¸¾è§„åˆ™è¾“å‡ºä¸ºæ•°å­—ã€‚ç›¸åº”çš„ï¼ŒNebula-DGL åœ¨è§„åˆ™ä¸­ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é’ˆå¯¹è¿™å‡ ç§æƒ…å†µåˆ©ç”¨ filter è¿›è¡Œè¡¨è¾¾ï¼š ç‰¹å¾ç›´æ¥é€‰å–å±æ€§çš„å€¼ï¼š è¿™ä¸ªä¾‹å­é‡Œï¼ŒNebulaGraph å›¾ä¸­ follow è¿™ä¸ªè¾¹å°†è¢«æŠ½å–ï¼Œè¾¹ä¸Šçš„å±æ€§ degree çš„å€¼å°†ç›´æ¥è¢«ä½œä¸ºåä¸º degree çš„ç‰¹å¾ã€‚ edge_types: - name: follow start_vertex_tag: player end_vertex_tag: player features: - name: degree properties: - name: degree type: int nullable: False filter: type: value ç‰¹å¾ä»å±æ€§ä¸­ç»è¿‡æ•°å­¦å˜æ¢ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ serve è¾¹ä¹‹ä¸­çš„ä¸¤ä¸ªå±æ€§è¿›è¡Œ (end_year - start_year) / 30 çš„å¤„ç†ï¼Œå˜ä¸º service_time è¿™æ ·çš„ä¸€ä¸ªç‰¹å¾ã€‚ edge_types: - name: serve start_vertex_tag: player end_vertex_tag: team features: - name: service_time properties: - name: start_year type: int nullable: False - name: end_year type: int nullable: False # The variable was mapped by order of properties filter: type: function function: \"lambda start_year, end_year: (end_year - start_year) / 30\" æšä¸¾å±æ€§å€¼ä¸ºæ•°å­—ç‰¹å¾ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ team é¡¶ç‚¹ä¸­çš„ name å±æ€§è¿›è¡Œæšä¸¾ï¼Œæ ¹æ®è¿™ä¸ªå¯¹äºæ˜¯è¥¿å²¸è¿˜æ˜¯ä¸œå²¸ï¼š vertex_tags: - name: team features: - name: coast properties: - name: name type: str nullable: False filter: # 0 stand for the east coast, 1 stand for the west coast type: enumeration enumeration: Celtics: 0 Nets: 0 Nuggets: 1 Timberwolves: 1 Thunder: 1 # ... not showing all teams here å¯ä»¥çœ‹åˆ°è¿™ä¸ªè½¬æ¢è§„åˆ™éå¸¸ç®€å•ç›´æ¥ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å‚è€ƒ Nebula-DGL çš„å®Œæ•´ä¾‹å­äº†è§£å…¨éƒ¨ç»†èŠ‚ https://github.com/wey-gu/nebula-dgl/tree/main/exampleã€‚è€Œæœ‰ä¸Šè¾¹æ•°æ®å¤„ç†è§„åˆ™çš„äº†è§£ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å¤„ç†è¿™ä¸ª Yelp å›¾æ•°æ®äº†ã€‚ é¦–å…ˆï¼Œå®šä¹‰å¦‚ä¸‹è§„åˆ™ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬æŠŠé¡¶ç‚¹ review å’Œä¸‰ç§è¾¹éƒ½å¯¹åº”è¿‡æ¥äº†ï¼ŒåŒæ—¶ï¼Œreview ä¸Šçš„å±æ€§ä¹ŸæŒ‰ç…§åŸæœ¬çš„å€¼å¯¹åº”äº†è¿‡æ¥ï¼š nebulagraph_yelp_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: yelp # str or int vertex_id_type: int vertex_tags: - name: review label: name: is_fraud properties: - name: is_fraud type: int nullable: False filter: type: value features: - name: f0 properties: - name: f0 type: float nullable: False filter: type: value - na","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:5","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#æ¨¡å‹è®­ç»ƒ"},{"categories":["Nebula Graph"],"content":" 1.5 å›¾ç¥ç»ç½‘ç»œçš„æ–¹æ³•ç„¶è€Œï¼Œè¿™äº›å›¾ç‰¹å¾çš„æ–¹æ³•çš„é—®é¢˜åœ¨äºï¼š å›¾ç‰¹å¾å¹¶ä¸èƒ½æŠŠå…³è”å…³ç³»ï¼Œæ•°æ®çš„å±€éƒ¨æ€§å……åˆ†åæ˜ åˆ°æˆ‘ä»¬çš„æ¨¡å‹ã€æ–¹æ³•é‡Œï¼› å›¾çš„ç‰¹å¾å·¥ç¨‹æ˜¯å¾ˆæ˜‚è´µã€ç¹ççš„ã€‚ åœ¨æœ€è¿‘å‡ å¹´çš„æˆæœä¸­ï¼ŒåŸºäº GNN çš„æ–¹æ³•é€šè¿‡å°†å›¾ç»“æ„ä¸å±æ€§ä¿¡æ¯è¿›è¡ŒåµŒå…¥è¡¨ç¤ºï¼Œä½¿å¾—æˆ‘ä»¬èƒ½åœ¨ä¸è¿›è¡Œå›¾ç‰¹å¾æŠ½å–ã€ç‰¹å¾å·¥ç¨‹ã€ä¸“å®¶ä¸å·¥ç¨‹æ–¹æ³•çš„æ•°æ®æ ‡æ³¨çš„æƒ…å†µä¸‹ï¼Œå¾—åˆ°ç›¸æ¯”äºåŸºäºä¼ ç»Ÿå›¾ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ›´å¥½çš„æ•ˆæœã€‚æœ‰æ„æ€çš„æ˜¯ï¼Œç°åœ¨æ­£æ˜¯è¿™äº›æ–¹æ³•å¿«é€Ÿè¢«å‘ç°ã€æ¼”è¿›çš„æ—¶æœŸï¼ŒåŸºäºå›¾çš„æ·±åº¦å­¦ä¹ æ˜¯ä¹‹å‰å‡ å¹´æœ€çƒ­é—¨çš„æœºå™¨å­¦ä¹ ç ”ç©¶æ–¹å‘ä¹‹ä¸€ã€‚ åŒæ—¶ï¼Œå›¾æ·±åº¦å­¦ä¹ çš„ä¸€äº›æ–¹æ³•å¯ä»¥åšåˆ° Inductive Learningâ€”â€”æ¨¡å‹å¯ä»¥åœ¨æ–°çš„ç‚¹ã€è¾¹ä¸Šè¿›è¡Œæ¨ç†ï¼Œè¿™æ ·ï¼Œé…åˆå›¾æ•°æ®åº“ä¸Šçº¿ä¸Šçš„å­å›¾æŸ¥è¯¢èƒ½åŠ›ï¼Œåœ¨çº¿å®æ—¶çš„é£é™©é¢„æµ‹ä¹Ÿå˜å¾—å¾ˆç®€å•å¯è¡Œäº†ã€‚ 1.5.1 åŸºäºå›¾è¡¨ç¤ºçš„å›¾ç¥ç»ç½‘ç»œæ¬ºè¯ˆæ£€æµ‹ç³»ç»Ÿç¤ºä¾‹åˆ©ç”¨ GNN çš„æ–¹æ³•ä¸­ï¼Œå›¾æ•°æ®åº“å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œæ•°æ®çš„å­˜å‚¨å¯ä»¥åœ¨å…¶ä»–å‡ ç§å¸¸è§çš„ä»‹è´¨ä¹‹ä¸­ï¼Œä½†æ˜¯å›¾åº“èƒ½å¤Ÿæœ€å¤§åŒ–åŠ©ç›Šæ¨¡å‹è®­ç»ƒã€æ¨¡å‹æ›´æ–°ã€çº¿ä¸Šç»“æœçš„æ›´æ–°ã€‚å½“æˆ‘ä»¬æŠŠå›¾æ•°æ®åº“ä½œä¸ºæ•°æ®çš„å•ä¸€æ•°æ®æ¥æºï¼ˆsingle source of truthï¼‰çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„åŸºäºçº¿ä¸Šã€ç¦»çº¿ã€å›¾è°±çš„æ–¹æ³•å¯ä»¥å¾ˆå®¹æ˜“è¢«é›†æˆèµ·æ¥ï¼Œä»è€Œç»„åˆæ‰€æœ‰æ–¹æ³•çš„ä¼˜åŠ¿ä¸ç»“æœï¼Œåšå‡ºæ›´æœ‰æ•ˆçš„æ¬ºè¯ˆæ£€æµ‹å¤åˆç³»ç»Ÿã€‚ åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬ä¸€æ ·åˆ†ä¸ºï¼šæ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€æ„å»ºæ£€æµ‹ç³»ç»Ÿè¿™å‡ éƒ¨åˆ†ã€‚ æ³¨ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„çš„å·¥å…·ä¸º Deep Graph libraryï¼ˆDGLï¼‰ï¼ŒNebulaGraph å›¾æ•°æ®åº“å’Œä»–ä»¬ä¹‹é—´çš„æ¡¥æ¢ï¼ŒNebula-DGLã€‚ DGL: https://www.dgl.ai/ Nebula-DGL: https://github.com/wey-gu/nebula-dgl æˆ‘ä¹Ÿæ˜¯è¿™ä¸ªåº“çš„ä½œè€… ğŸ˜ 1.5.1.1 æ•°æ®é›†æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®é›†æ˜¯ Yelp-Fraudï¼Œä»–ç›´æ¥æ¥è‡ªäºè®ºæ–‡ Enhancing Graph Neural Network-based Fraud Detectors against Camouflaged Fraudstersã€‚ è¿™ä¸ªå›¾ä¸­æœ‰ä¸€ç§ç‚¹ï¼Œä¸‰ç§å…³ç³»ï¼š é¡¶ç‚¹ï¼šæ¥è‡ª Yelp ä¸­çš„é¤å…ã€é…’åº—çš„è¯„ä»·ï¼Œæœ‰ä¸¤ç±»å±æ€§ï¼š æ¯ä¸€ä¸ªè¯„ä»·ä¸­æœ‰è¢«æ ‡æ³¨äº†çš„æ˜¯å¦æ˜¯è™šå‡ã€æ¬ºè¯ˆè¯„ä»·çš„æ ‡ç­¾ 32 ä¸ªå·²ç»è¢«å¤„ç†è¿‡çš„æ•°å­—å‹å±æ€§ è¾¹ï¼šä¸‰ç±»è¯„ä»·ä¹‹é—´çš„å…³è”å…³ç³» R-U-Rï¼šä¸¤ä¸ªè¯„ä»·ç”±åŒä¸€ä¸ªç”¨æˆ·å‘å‡º shares_user_with R-S-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒè¯„åˆ†ï¼ˆè¯„åˆ†å¯ä»¥æ˜¯1åˆ°5ï¼‰ shares_restaurant_rating_with R-T-Rï¼šä¸¤ä¸ªè¯„ä»·æ˜¯åŒé¤å…åŒæäº¤æœˆä»½ shares_restaurant_in_one_month_with åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å‡è®¾è¿™ä¸ªå›¾å·²ç»åœ¨æˆ‘ä»¬çš„ NebulaGraph é‡Œè¾¹äº†ã€‚ æ³¨ï¼Œæˆ‘å·²ç»å¸®å¤§å®¶æå‰åšå¥½äº†å°†è¿™å¼ å›¾å¯¼å…¥ NebulaGraph çš„å·¥ä½œï¼Œé•¿è¯çŸ­è¯´å°±æ˜¯ï¼š # éƒ¨ç½² NebulaGraph curl -fsSL nebula-up.siwei.io/install.sh | bash # æ‹‰å–è¿™ä¸ªæ•°æ®çš„ Repo git clone https://github.com/wey-gu/nebulagraph-yelp-frauddetection \u0026\u0026 cd nebulagraph-yelp-frauddetection # å®‰è£…ä¾èµ–ï¼Œæ‰§è¡Œæ•°æ®ä¸‹è½½ç”Ÿæˆ python3 -m pip install -r requirements.txt python3 data_download.py # å¯¼å…¥åˆ° NebulaGraph docker run --rm -ti \\ --network=nebula-net \\ -v ${PWD}/yelp_nebulagraph_importer.yaml:/root/importer.yaml \\ -v ${PWD}/data:/root \\ vesoft/nebula-importer:v3.1.0 \\ --config /root/importer.yaml è¯¦æƒ…å‚è€ƒï¼šhttps://github.com/wey-gu/nebulagraph-yelp-frauddetection 1.5.1.2 æ•°æ®å¤„ç†è¿™éƒ¨åˆ†çš„ä»»åŠ¡æ˜¯å°†å›¾è°±ä¸­å’Œé£é™©ç›¸å…³å­å›¾çš„æ‹“æ‰‘ç»“æ„è¡¨ç¤ºå’Œå…¶ä¸­æœ‰å…³çš„ç‰¹å¾ï¼ˆå±æ€§ï¼‰è¿›è¡Œå·¥ç¨‹å¤„ç†ï¼Œåºåˆ—åŒ–æˆä¸º DGL çš„å›¾å¯¹è±¡ã€‚ DGL æœ¬èº«æ”¯æŒä»ç‚¹ã€è¾¹åˆ—è¡¨ï¼ˆedgelistï¼‰å½¢å¼ CSV æ–‡ä»¶ï¼Œæˆ–è€…ä» NetworkX å’Œ SciPy çš„åºåˆ—åŒ–ç¨€ç–çš„é‚»æ¥çŸ©é˜µï¼ˆadjacency matrixï¼‰çš„æ•°æ®æ¥æ„é€ å®ƒçš„å›¾å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸå§‹çš„å›¾æ•°æ®æˆ–è€…å›¾åº“ä¸­çš„æ•°æ®å…¨é‡å¯¼å‡ºä¸ºè¿™äº›å½¢å¼ï¼Œä¸è¿‡åœ¨çœŸå®çš„ä¾‹å­ä¸­å›¾åº“ä¸­çš„æ•°æ®æ˜¯å®æ—¶å˜åŒ–çš„ï¼Œèƒ½å¤Ÿç›´æ¥åœ¨ NebulaGraph ä¸­çš„å­å›¾ä¸Šåš GNN è®­ç»ƒä¸€èˆ¬æ¥è¯´æ˜¯æ›´ç†æƒ³ã€‚å¾—ç›Šäº Nebula-DGL è¿™ä¸ªåº“ï¼Œåšè¿™ä»¶äº‹å„¿æ˜¯å¾ˆè‡ªç„¶çš„ã€‚ æ³¨ï¼ŒDGL å¤–éƒ¨æ•°æ®å‘˜å¯¼å…¥æ–‡æ¡£ï¼šhttps://docs.dgl.ai/guide/graph-external.html ç°åœ¨æˆ‘ä»¬å¼€å§‹è¿™ä¸ªæ•°æ®çš„å¯¼å…¥ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘å…ˆä»‹ç»ä¸€ä¸‹ Nebula-DGLã€‚ Nebula-DGL å¯ä»¥æ ¹æ®ç»™å®šçš„æ˜ å°„å’Œè½¬æ¢è§„åˆ™ï¼ˆYAML æ ¼å¼ï¼‰ï¼Œå°† NebulaGraph ä¸­çš„é¡¶ç‚¹ã€è¾¹ï¼Œå’Œå®ƒä»¬çš„å±æ€§æŒ‰ç…§è§„åˆ™å¤„ç†æˆä¸ºç‚¹ã€è¾¹ã€å’Œå…¶ä¸­çš„æ ‡æ³¨ï¼ˆLabelï¼‰ä¸ç‰¹å¾ï¼ˆFeatureï¼‰ï¼Œä»è€Œæ„é€ ä¸º DGL çš„å›¾å¯¹è±¡ã€‚è¿™å…¶ä¸­ï¼Œå€¼å¾—ä¸€æçš„æ˜¯å±æ€§åˆ°ç‰¹å¾çš„è½¬æ¢ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œç‰¹å¾å¯èƒ½æ˜¯æŸä¸€ä¸ªå±æ€§çš„å€¼ã€ä¸€ä¸ªæˆ–è€…å¤šä¸ªå±æ€§çš„å€¼åšä¸€å®šçš„æ•°å­¦å˜æ¢ã€äº¦æˆ–æ˜¯å­—ç¬¦å‹çš„å±æ€§æŒ‰ç…§æšä¸¾è§„åˆ™è¾“å‡ºä¸ºæ•°å­—ã€‚ç›¸åº”çš„ï¼ŒNebula-DGL åœ¨è§„åˆ™ä¸­ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é’ˆå¯¹è¿™å‡ ç§æƒ…å†µåˆ©ç”¨ filter è¿›è¡Œè¡¨è¾¾ï¼š ç‰¹å¾ç›´æ¥é€‰å–å±æ€§çš„å€¼ï¼š è¿™ä¸ªä¾‹å­é‡Œï¼ŒNebulaGraph å›¾ä¸­ follow è¿™ä¸ªè¾¹å°†è¢«æŠ½å–ï¼Œè¾¹ä¸Šçš„å±æ€§ degree çš„å€¼å°†ç›´æ¥è¢«ä½œä¸ºåä¸º degree çš„ç‰¹å¾ã€‚ edge_types: - name: follow start_vertex_tag: player end_vertex_tag: player features: - name: degree properties: - name: degree type: int nullable: False filter: type: value ç‰¹å¾ä»å±æ€§ä¸­ç»è¿‡æ•°å­¦å˜æ¢ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ serve è¾¹ä¹‹ä¸­çš„ä¸¤ä¸ªå±æ€§è¿›è¡Œ (end_year - start_year) / 30 çš„å¤„ç†ï¼Œå˜ä¸º service_time è¿™æ ·çš„ä¸€ä¸ªç‰¹å¾ã€‚ edge_types: - name: serve start_vertex_tag: player end_vertex_tag: team features: - name: service_time properties: - name: start_year type: int nullable: False - name: end_year type: int nullable: False # The variable was mapped by order of properties filter: type: function function: \"lambda start_year, end_year: (end_year - start_year) / 30\" æšä¸¾å±æ€§å€¼ä¸ºæ•°å­—ç‰¹å¾ è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ team é¡¶ç‚¹ä¸­çš„ name å±æ€§è¿›è¡Œæšä¸¾ï¼Œæ ¹æ®è¿™ä¸ªå¯¹äºæ˜¯è¥¿å²¸è¿˜æ˜¯ä¸œå²¸ï¼š vertex_tags: - name: team features: - name: coast properties: - name: name type: str nullable: False filter: # 0 stand for the east coast, 1 stand for the west coast type: enumeration enumeration: Celtics: 0 Nets: 0 Nuggets: 1 Timberwolves: 1 Thunder: 1 # ... not showing all teams here å¯ä»¥çœ‹åˆ°è¿™ä¸ªè½¬æ¢è§„åˆ™éå¸¸ç®€å•ç›´æ¥ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å‚è€ƒ Nebula-DGL çš„å®Œæ•´ä¾‹å­äº†è§£å…¨éƒ¨ç»†èŠ‚ https://github.com/wey-gu/nebula-dgl/tree/main/exampleã€‚è€Œæœ‰ä¸Šè¾¹æ•°æ®å¤„ç†è§„åˆ™çš„äº†è§£ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å¤„ç†è¿™ä¸ª Yelp å›¾æ•°æ®äº†ã€‚ é¦–å…ˆï¼Œå®šä¹‰å¦‚ä¸‹è§„åˆ™ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬æŠŠé¡¶ç‚¹ review å’Œä¸‰ç§è¾¹éƒ½å¯¹åº”è¿‡æ¥äº†ï¼ŒåŒæ—¶ï¼Œreview ä¸Šçš„å±æ€§ä¹ŸæŒ‰ç…§åŸæœ¬çš„å€¼å¯¹åº”äº†è¿‡æ¥ï¼š nebulagraph_yelp_dgl_mapper.yaml --- # If vertex id is string-typed, remap_vertex_id must be true. remap_vertex_id: True space: yelp # str or int vertex_id_type: int vertex_tags: - name: review label: name: is_fraud properties: - name: is_fraud type: int nullable: False filter: type: value features: - name: f0 properties: - name: f0 type: float nullable: False filter: type: value - na","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:5","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#æ¨ç†æ¥å£"},{"categories":["Nebula Graph"],"content":" 1.6 æ€»ç»“æ€»ç»“èµ·æ¥ï¼Œæ¬ºè¯ˆæ£€æµ‹çš„æ–¹æ³•æœ‰ï¼š åœ¨ä¸€ä¸ªäº¤æ˜“å†å²ã€é£æ§çš„å›¾è°±ä¸Šï¼Œé€šè¿‡å›¾æ¨¡å¼æŸ¥è¯¢ç›´æ¥è·å¾—é£é™©æç¤º å®šæœŸåˆ©ç”¨å›¾ç®—æ³•æ‰©å……é£é™©æ ‡æ³¨ï¼Œå†™å›å›¾åº“ å®šæœŸè®¡ç®—å›¾è°±ä¸­çš„å›¾ç‰¹å¾ï¼Œå’Œå…¶ä»–ç‰¹å¾ä¸€èµ·ç”¨ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ–¹æ³•ç¦»çº¿é¢„æµ‹é£é™© å°†å›¾è°±ä¸­çš„å±æ€§å¤„ç†æˆä¸ºç‚¹ã€è¾¹ç‰¹å¾ï¼Œç”¨å›¾ç¥ç»ç½‘ç»œæ–¹æ³•ç¦»çº¿é¢„æµ‹é£é™©ï¼Œéƒ¨åˆ†å¯ä»¥ Inductive Learning çš„æ–¹æ³•ç»“åˆå›¾åº“å¯ä»¥å®ç°åœ¨çº¿é£é™©é¢„æµ‹ Feature Image credit goes to https://unsplash.com/photos/BW0vK-FA3eg ","date":"2022-08-01","objectID":"/fraud-detection-with-nebulagraph/:1:6","series":null,"tags":["Nebula Graph","Fraud Detection","GNN","æ¬ºè¯ˆæ£€æµ‹","é‡‘èé£æ§","DGL","PyTorch"],"title":"åŸºäº NebulaGraph å›¾æ•°æ®åº“çš„æ¬ºè¯ˆæ£€æµ‹æ–¹æ³•ä¸ä»£ç ç¤ºä¾‹","uri":"/fraud-detection-with-nebulagraph/#æ€»ç»“"},{"categories":["Nebula Graph"],"content":"Nebula Graph ç”Ÿæ€ä¸­æœ‰å“ªäº› Spark é¡¹ç›®ï¼Ÿ æœ¬æ–‡ä¸ºå¤§å®¶ä»‹ç» Spark-connectorï¼ˆåŒ…æ‹¬ PySparkï¼‰ï¼Œ Nebula Algorithm å’Œ Nebula Exchangeã€‚","date":"2022-06-06","objectID":"/spark-on-nebula-graph/","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/"},{"categories":["Nebula Graph"],"content":" Nebula Graph ç”Ÿæ€ä¸­æœ‰å“ªäº› Spark é¡¹ç›®ï¼Ÿ æœ¬æ–‡ä¸ºå¤§å®¶ä»‹ç» Spark-connectorï¼ˆåŒ…æ‹¬ PySparkï¼‰ï¼Œ Nebula Algorithm å’Œ Nebula Exchangeã€‚ æœ€è¿‘æˆ‘è¯•ç€æ­å»ºäº†æ–¹ä¾¿å¤§å®¶ä¸€é”®è¯•ç©çš„ Nebula Graph ä¸­çš„ Spark ç›¸å…³çš„é¡¹ç›®ï¼Œä»Šå¤©å°±æŠŠå®ƒä»¬æ•´ç†æˆæ–‡åˆ†äº«ç»™å¤§å®¶ã€‚è€Œä¸”ï¼Œæˆ‘è¶Ÿå‡ºæ¥äº† PySpark ä¸‹çš„ Nebula Spark Connector çš„ä½¿ç”¨æ–¹å¼ï¼Œåè¾¹ä¹Ÿä¼šä¸€å¹¶è´¡çŒ®åˆ°æ–‡æ¡£é‡Œã€‚ ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:0:0","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#"},{"categories":["Nebula Graph"],"content":" 1 Nebula Graph çš„ä¸‰ä¸ª Spark å­é¡¹ç›®æˆ‘æ›¾ç»å›´ç»• Nebula Graph çš„æ‰€æœ‰æ•°æ®å¯¼å…¥æ–¹æ³•ç”»è¿‡ä¸€ä¸ªè‰å›¾ï¼Œå…¶ä¸­å·²ç»åŒ…å«äº† Spark Connectorï¼ŒNebula Exchange çš„ç®€å•ä»‹ç»ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘å°†å®ƒä»¬å’Œå¦å¤–çš„ Nebula Algorithm è¿›è¡Œç¨å¾®æ·±å…¥çš„æ¢è®¨ã€‚ TL;DR Nebula Spark Connector æ˜¯ä¸€ä¸ª Spark Libï¼Œå®ƒèƒ½è®© Spark åº”ç”¨ç¨‹åºèƒ½å¤Ÿä»¥ dataframe çš„å½¢å¼ä» Nebula Graph ä¸­è¯»å–å’Œå†™å…¥å›¾æ•°æ®ã€‚ Nebula Exchange å»ºç«‹åœ¨ Nebula Spark Connector ä¹‹ä¸Šï¼Œä½œä¸ºä¸€ä¸ª Spark Lib åŒæ—¶å¯ä»¥ç›´æ¥è¢« Spark æäº¤ JAR åŒ…æ‰§è¡Œçš„åº”ç”¨ç¨‹åºï¼Œå®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯å’Œ Nebula Graph äº¤æ¢ä¸åŒçš„æ•°æ®æºï¼ˆå¯¹äºå¼€æºç‰ˆæœ¬ï¼Œå®ƒæ˜¯å•å‘çš„ï¼šå†™å…¥ï¼Œè€Œå¯¹äºä¼ä¸šç‰ˆæœ¬ï¼Œå®ƒæ˜¯åŒå‘çš„ï¼‰ã€‚Nebula Exchange æ”¯æŒçš„å¾ˆå¤šä¸åŒç±»å‹çš„æ•°æ®æºå¦‚ï¼šMySQLã€Neo4jã€PostgreSQLã€ClickHouseã€Hive ç­‰ã€‚é™¤äº†ç›´æ¥å†™å…¥ Nebula Graphï¼Œå®ƒè¿˜å¯ä»¥é€‰æ‹©ç”Ÿæˆ SST æ–‡ä»¶ï¼Œå¹¶å°†å…¶æ³¨å…¥ Nebula Graphï¼Œä»¥ä¾¿ä½¿ç”¨ Nebula Graph é›†ç¾¤ä¹‹å¤–ç®—åŠ›å¸®åŠ©æ’åºåº•å±‚ã€‚ Nebula Algorithmï¼Œå»ºç«‹åœ¨ Nebula Spark Connector å’Œ GraphX ä¹‹ä¸Šï¼Œä¹Ÿæ˜¯ä¸€ä¸ªSpark Lib å’Œ Spark ä¸Šçš„åº”ç”¨ç¨‹åºï¼Œå®ƒç”¨æ¥åœ¨ Nebula Graph çš„å›¾ä¸Šè¿è¡Œå¸¸ç”¨çš„å›¾ç®—æ³•ï¼ˆpagerankï¼ŒLPAç­‰ï¼‰ã€‚ ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:1:0","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#nebula-graph-çš„ä¸‰ä¸ª-spark-å­é¡¹ç›®"},{"categories":["Nebula Graph"],"content":" 2 Nebula Spark Connector ä»£ç ï¼šhttps://github.com/vesoft-inc/nebula-spark-connector æ–‡æ¡£ï¼šhttps://docs.nebula-graph.io/3.1.0/nebula-spark-connector/ JAR åŒ…ï¼šhttps://repo1.maven.org/maven2/com/vesoft/nebula-spark-connector/ ä»£ç ä¾‹å­ï¼šexample ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:2:0","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#nebula-spark-connector"},{"categories":["Nebula Graph"],"content":" 2.1 Nebula Graph Spark Readerä¸ºäº†ä» Nebula Graph ä¸­è¯»å–æ•°æ®ï¼Œæ¯”å¦‚è¯» vertexï¼ŒNebula Spark Connector å°†æ‰«ææ‰€æœ‰å¸¦æœ‰ç»™å®š TAG çš„ Nebula StorageDï¼Œæ¯”å¦‚è¿™æ ·è¡¨ç¤ºæ‰«æ player è¿™ä¸ª TAG ï¼šwithLabel(\"player\")ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŒ‡å®š vertex çš„å±æ€§ï¼šwithReturnCols(List(\"name\", \"age\"))ã€‚ æŒ‡å®šå¥½æ‰€æœ‰çš„è¯» TAG ç›¸å…³çš„é…ç½®ä¹‹åï¼Œè°ƒç”¨ spark.read.nebula.loadVerticesToDF è¿”å›å¾—åˆ°çš„å°±æ˜¯æ‰«æ Nebula Graph ä¹‹åè½¬æ¢ä¸º Dataframe çš„å›¾æ•°æ®ï¼Œåƒè¿™æ ·ï¼š def readVertex(spark: SparkSession): Unit = { LOG.info(\"start to read nebula vertices\") val config = NebulaConnectionConfig .builder() .withMetaAddress(\"metad0:9559,metad1:9559,metad2:9559\") .withConenctionRetry(2) .build() val nebulaReadVertexConfig: ReadNebulaConfig = ReadNebulaConfig .builder() .withSpace(\"basketballplayer\") .withLabel(\"player\") .withNoColumn(false) .withReturnCols(List(\"name\", \"age\")) .withLimit(10) .withPartitionNum(10) .build() val vertex = spark.read.nebula(config, nebulaReadVertexConfig).loadVerticesToDF() vertex.printSchema() vertex.show(20) println(\"vertex count: \" + vertex.count()) } å†™å…¥çš„ä¾‹å­æˆ‘è¿™é‡Œä¸åˆ—å‡ºï¼Œä¸è¿‡ï¼Œå‰è¾¹ç»™å‡ºçš„ä»£ç ç¤ºä¾‹çš„é“¾æ¥é‡Œæ˜¯æœ‰æ›´è¯¦ç»†çš„ä¾‹å­ï¼Œè¿™é‡Œå€¼å¾—ä¸€æçš„æ˜¯ï¼ŒSpark Connector è¯»æ•°æ®ä¸ºäº†æ»¡è¶³å›¾åˆ†æã€å›¾è®¡ç®—çš„å¤§é‡æ•°æ®åœºæ™¯ï¼Œå’Œå¤§éƒ¨åˆ†å…¶ä»–å®¢æˆ·ç«¯éå¸¸ä¸åŒï¼Œå®ƒç›´æ¥ç»•è¿‡äº† GraphDï¼Œé€šè¿‡æ‰«æ MetaD å’Œ StorageD è·å¾—æ•°æ®ï¼Œä½†æ˜¯å†™å…¥çš„æƒ…å†µåˆ™æ˜¯é€šè¿‡ GraphD å‘èµ· nGQL DML è¯­å¥å†™å…¥çš„ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åšä¸€ä¸ªä¸Šæ‰‹ç»ƒä¹ å§ã€‚ ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:2:1","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#nebula-graph-spark-reader"},{"categories":["Nebula Graph"],"content":" 2.2 ä¸Šæ‰‹ Nebula Spark Connectorå…ˆå†³æ¡ä»¶ï¼šå‡è®¾ä¸‹é¢çš„ç¨‹åºæ˜¯åœ¨ä¸€å°æœ‰äº’è”ç½‘è¿æ¥çš„ Linux æœºå™¨ä¸Šè¿è¡Œçš„ï¼Œæœ€å¥½æ˜¯é¢„è£…äº† Docker å’Œ Docker-Composeã€‚ 2.2.1 æ‹‰èµ·ç¯å¢ƒé¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Up éƒ¨ç½²åŸºäºå®¹å™¨çš„ Nebula Graph Core v3ã€Nebula Studioã€Nebula Console å’Œ Sparkã€Hadoop ç¯å¢ƒï¼Œå¦‚æœè¿˜æ²¡å®‰è£…å¥½å®ƒä¹Ÿä¼šå°è¯•ä¸ºæˆ‘ä»¬å®‰è£… Docker å’Œ Docker-Composeã€‚ # Install Core with Spark Connector, Nebula Algorithm, Nebula Exchange curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 spark ä½ çŸ¥é“å— Nebula-UP å¯ä»¥ä¸€é”®è£…æ›´å¤šä¸œè¥¿ï¼Œå¦‚æœä½ çš„ç¯å¢ƒé…ç½®å¤§ä¸€ç‚¹ï¼ˆæ¯”å¦‚ 8 GB RAMï¼‰curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash å¯ä»¥è£…æ›´å¤šä¸œè¥¿ï¼Œä½†æ˜¯è¯·æ³¨æ„ Nebula-UP ä¸æ˜¯ä¸ºç”Ÿäº§ç¯å¢ƒå‡†å¤‡çš„ã€‚ ä¸Šè¿°è¾¹è„šæœ¬æ‰§è¡Œåï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Consoleï¼ˆNebula Graph çš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼‰æ¥è¿æ¥å®ƒã€‚ # Connect to nebula with console ~/.nebula-up/console.sh # Execute any queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" åŠ è½½ä¸€ä»½æ•°æ®è¿›å»ï¼Œå¹¶æ‰§è¡Œä¸€ä¸ªå›¾æŸ¥è¯¢ï¼š # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # ç­‰ä¸€åˆ†é’Ÿå·¦å³ # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 2.2.2 è¿›å…¥ Spark ç¯å¢ƒæ‰§è¡Œä¸‹é¢è¿™ä¸€è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥åˆ° Spark ç¯å¢ƒï¼š docker exec -it sparkmaster bash å¦‚æœæˆ‘ä»¬æƒ³æ‰§è¡Œç¼–è¯‘ï¼Œå¯ä»¥åœ¨é‡Œè¾¹å®‰è£… mvnï¼š docker exec -it sparkmaster bash # in the container shell export MAVEN_VERSION=3.5.4 export MAVEN_HOME=/usr/lib/mvn export PATH=$MAVEN_HOME/bin:$PATH wget http://archive.apache.org/dist/maven/maven-3/$MAVEN_VERSION/binaries/apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ tar -zxvf apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ rm apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ mv apache-maven-$MAVEN_VERSION /usr/lib/mvn 2.2.3 è·‘ Spark Connector çš„ä¾‹å­ 2.2.3.1 é€‰é¡¹ 1ï¼ˆæ¨èï¼‰ï¼šé€šè¿‡ PySpark è¿›å…¥ PySpark Shell ~/.nebula-up/nebula-pyspark.sh è°ƒç”¨ Nebula Spark Reader # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit of 2 df.show(n=2) è¿”å›ç»“æœä¾‹å­ ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 2.2.3.2 é€‰é¡¹ 2ï¼šç¼–è¯‘ã€æäº¤ç¤ºä¾‹ JAR åŒ… å…ˆå…‹éš† Spark Connector å’Œå®ƒç¤ºä¾‹ä»£ç çš„ä»£ç ä»“åº“ï¼Œç„¶åç¼–è¯‘ï¼š æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† master åˆ†æ”¯ï¼Œå› ä¸ºå½“ä¸‹ master åˆ†æ”¯æ˜¯å…¼å®¹ 3.x çš„ï¼Œä¸€å®šè¦ä¿è¯ spark connector å’Œæ•°æ®åº“å†…æ ¸ç‰ˆæœ¬æ˜¯åŒ¹é…çš„ï¼Œç‰ˆæœ¬å¯¹åº”å…³ç³»å‚è€ƒä»£ç ä»“åº“çš„ README.md ã€‚ cd ~/.nebula-up/nebula-up/spark git clone https://github.com/vesoft-inc/nebula-spark-connector.git docker exec -it sparkmaster bash cd /root/nebula-spark-connector æ›¿æ¢ç¤ºä¾‹é¡¹ç›®çš„ä»£ç  echo \u003e example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala vi example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala æŠŠå¦‚ä¸‹çš„ä»£ç ç²˜è´´è¿›å»ï¼Œè¿™é‡Œè¾¹æˆ‘ä»¬å¯¹å‰è¾¹åŠ è½½çš„å›¾ï¼š basketballplayer ä¸Šåšäº†é¡¶ç‚¹å’Œè¾¹çš„è¯»æ“ä½œï¼šåˆ†åˆ«è°ƒç”¨ readVertex å’Œ readEdgesã€‚ package com.vesoft.nebula.examples.connector import com.facebook.thrift.protocol.TCompactProtocol import com.vesoft.nebula.connector.connector.NebulaDataFrameReader import com.vesoft.nebula.connector.{NebulaConnectionConfig, ReadNebulaConfig} import org.apache.spark.SparkConf import org.apache.spark.sql.SparkSession import org.slf4j.LoggerFactory object NebulaSparkReaderExample { private val LOG = LoggerFactory.getLogger(this.getClass) def main(args: Array[String]): Unit = { val sparkConf = new SparkConf sparkConf .set(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\") .registerKryoClasses(Array[Class[_]](classOf[TCompactProt","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:2:2","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#ä¸Šæ‰‹-nebula-spark-connector"},{"categories":["Nebula Graph"],"content":" 2.2 ä¸Šæ‰‹ Nebula Spark Connectorå…ˆå†³æ¡ä»¶ï¼šå‡è®¾ä¸‹é¢çš„ç¨‹åºæ˜¯åœ¨ä¸€å°æœ‰äº’è”ç½‘è¿æ¥çš„ Linux æœºå™¨ä¸Šè¿è¡Œçš„ï¼Œæœ€å¥½æ˜¯é¢„è£…äº† Docker å’Œ Docker-Composeã€‚ 2.2.1 æ‹‰èµ·ç¯å¢ƒé¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Up éƒ¨ç½²åŸºäºå®¹å™¨çš„ Nebula Graph Core v3ã€Nebula Studioã€Nebula Console å’Œ Sparkã€Hadoop ç¯å¢ƒï¼Œå¦‚æœè¿˜æ²¡å®‰è£…å¥½å®ƒä¹Ÿä¼šå°è¯•ä¸ºæˆ‘ä»¬å®‰è£… Docker å’Œ Docker-Composeã€‚ # Install Core with Spark Connector, Nebula Algorithm, Nebula Exchange curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 spark ä½ çŸ¥é“å— Nebula-UP å¯ä»¥ä¸€é”®è£…æ›´å¤šä¸œè¥¿ï¼Œå¦‚æœä½ çš„ç¯å¢ƒé…ç½®å¤§ä¸€ç‚¹ï¼ˆæ¯”å¦‚ 8 GB RAMï¼‰curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash å¯ä»¥è£…æ›´å¤šä¸œè¥¿ï¼Œä½†æ˜¯è¯·æ³¨æ„ Nebula-UP ä¸æ˜¯ä¸ºç”Ÿäº§ç¯å¢ƒå‡†å¤‡çš„ã€‚ ä¸Šè¿°è¾¹è„šæœ¬æ‰§è¡Œåï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Consoleï¼ˆNebula Graph çš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼‰æ¥è¿æ¥å®ƒã€‚ # Connect to nebula with console ~/.nebula-up/console.sh # Execute any queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" åŠ è½½ä¸€ä»½æ•°æ®è¿›å»ï¼Œå¹¶æ‰§è¡Œä¸€ä¸ªå›¾æŸ¥è¯¢ï¼š # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # ç­‰ä¸€åˆ†é’Ÿå·¦å³ # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 2.2.2 è¿›å…¥ Spark ç¯å¢ƒæ‰§è¡Œä¸‹é¢è¿™ä¸€è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥åˆ° Spark ç¯å¢ƒï¼š docker exec -it sparkmaster bash å¦‚æœæˆ‘ä»¬æƒ³æ‰§è¡Œç¼–è¯‘ï¼Œå¯ä»¥åœ¨é‡Œè¾¹å®‰è£… mvnï¼š docker exec -it sparkmaster bash # in the container shell export MAVEN_VERSION=3.5.4 export MAVEN_HOME=/usr/lib/mvn export PATH=$MAVEN_HOME/bin:$PATH wget http://archive.apache.org/dist/maven/maven-3/$MAVEN_VERSION/binaries/apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ tar -zxvf apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ rm apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ mv apache-maven-$MAVEN_VERSION /usr/lib/mvn 2.2.3 è·‘ Spark Connector çš„ä¾‹å­ 2.2.3.1 é€‰é¡¹ 1ï¼ˆæ¨èï¼‰ï¼šé€šè¿‡ PySpark è¿›å…¥ PySpark Shell ~/.nebula-up/nebula-pyspark.sh è°ƒç”¨ Nebula Spark Reader # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit of 2 df.show(n=2) è¿”å›ç»“æœä¾‹å­ ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 2.2.3.2 é€‰é¡¹ 2ï¼šç¼–è¯‘ã€æäº¤ç¤ºä¾‹ JAR åŒ… å…ˆå…‹éš† Spark Connector å’Œå®ƒç¤ºä¾‹ä»£ç çš„ä»£ç ä»“åº“ï¼Œç„¶åç¼–è¯‘ï¼š æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† master åˆ†æ”¯ï¼Œå› ä¸ºå½“ä¸‹ master åˆ†æ”¯æ˜¯å…¼å®¹ 3.x çš„ï¼Œä¸€å®šè¦ä¿è¯ spark connector å’Œæ•°æ®åº“å†…æ ¸ç‰ˆæœ¬æ˜¯åŒ¹é…çš„ï¼Œç‰ˆæœ¬å¯¹åº”å…³ç³»å‚è€ƒä»£ç ä»“åº“çš„ README.md ã€‚ cd ~/.nebula-up/nebula-up/spark git clone https://github.com/vesoft-inc/nebula-spark-connector.git docker exec -it sparkmaster bash cd /root/nebula-spark-connector æ›¿æ¢ç¤ºä¾‹é¡¹ç›®çš„ä»£ç  echo \u003e example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala vi example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala æŠŠå¦‚ä¸‹çš„ä»£ç ç²˜è´´è¿›å»ï¼Œè¿™é‡Œè¾¹æˆ‘ä»¬å¯¹å‰è¾¹åŠ è½½çš„å›¾ï¼š basketballplayer ä¸Šåšäº†é¡¶ç‚¹å’Œè¾¹çš„è¯»æ“ä½œï¼šåˆ†åˆ«è°ƒç”¨ readVertex å’Œ readEdgesã€‚ package com.vesoft.nebula.examples.connector import com.facebook.thrift.protocol.TCompactProtocol import com.vesoft.nebula.connector.connector.NebulaDataFrameReader import com.vesoft.nebula.connector.{NebulaConnectionConfig, ReadNebulaConfig} import org.apache.spark.SparkConf import org.apache.spark.sql.SparkSession import org.slf4j.LoggerFactory object NebulaSparkReaderExample { private val LOG = LoggerFactory.getLogger(this.getClass) def main(args: Array[String]): Unit = { val sparkConf = new SparkConf sparkConf .set(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\") .registerKryoClasses(Array[Class[_]](classOf[TCompactProt","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:2:2","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#æ‹‰èµ·ç¯å¢ƒ"},{"categories":["Nebula Graph"],"content":" 2.2 ä¸Šæ‰‹ Nebula Spark Connectorå…ˆå†³æ¡ä»¶ï¼šå‡è®¾ä¸‹é¢çš„ç¨‹åºæ˜¯åœ¨ä¸€å°æœ‰äº’è”ç½‘è¿æ¥çš„ Linux æœºå™¨ä¸Šè¿è¡Œçš„ï¼Œæœ€å¥½æ˜¯é¢„è£…äº† Docker å’Œ Docker-Composeã€‚ 2.2.1 æ‹‰èµ·ç¯å¢ƒé¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Up éƒ¨ç½²åŸºäºå®¹å™¨çš„ Nebula Graph Core v3ã€Nebula Studioã€Nebula Console å’Œ Sparkã€Hadoop ç¯å¢ƒï¼Œå¦‚æœè¿˜æ²¡å®‰è£…å¥½å®ƒä¹Ÿä¼šå°è¯•ä¸ºæˆ‘ä»¬å®‰è£… Docker å’Œ Docker-Composeã€‚ # Install Core with Spark Connector, Nebula Algorithm, Nebula Exchange curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 spark ä½ çŸ¥é“å— Nebula-UP å¯ä»¥ä¸€é”®è£…æ›´å¤šä¸œè¥¿ï¼Œå¦‚æœä½ çš„ç¯å¢ƒé…ç½®å¤§ä¸€ç‚¹ï¼ˆæ¯”å¦‚ 8 GB RAMï¼‰curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash å¯ä»¥è£…æ›´å¤šä¸œè¥¿ï¼Œä½†æ˜¯è¯·æ³¨æ„ Nebula-UP ä¸æ˜¯ä¸ºç”Ÿäº§ç¯å¢ƒå‡†å¤‡çš„ã€‚ ä¸Šè¿°è¾¹è„šæœ¬æ‰§è¡Œåï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Consoleï¼ˆNebula Graph çš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼‰æ¥è¿æ¥å®ƒã€‚ # Connect to nebula with console ~/.nebula-up/console.sh # Execute any queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" åŠ è½½ä¸€ä»½æ•°æ®è¿›å»ï¼Œå¹¶æ‰§è¡Œä¸€ä¸ªå›¾æŸ¥è¯¢ï¼š # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # ç­‰ä¸€åˆ†é’Ÿå·¦å³ # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 2.2.2 è¿›å…¥ Spark ç¯å¢ƒæ‰§è¡Œä¸‹é¢è¿™ä¸€è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥åˆ° Spark ç¯å¢ƒï¼š docker exec -it sparkmaster bash å¦‚æœæˆ‘ä»¬æƒ³æ‰§è¡Œç¼–è¯‘ï¼Œå¯ä»¥åœ¨é‡Œè¾¹å®‰è£… mvnï¼š docker exec -it sparkmaster bash # in the container shell export MAVEN_VERSION=3.5.4 export MAVEN_HOME=/usr/lib/mvn export PATH=$MAVEN_HOME/bin:$PATH wget http://archive.apache.org/dist/maven/maven-3/$MAVEN_VERSION/binaries/apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ tar -zxvf apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ rm apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ mv apache-maven-$MAVEN_VERSION /usr/lib/mvn 2.2.3 è·‘ Spark Connector çš„ä¾‹å­ 2.2.3.1 é€‰é¡¹ 1ï¼ˆæ¨èï¼‰ï¼šé€šè¿‡ PySpark è¿›å…¥ PySpark Shell ~/.nebula-up/nebula-pyspark.sh è°ƒç”¨ Nebula Spark Reader # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit of 2 df.show(n=2) è¿”å›ç»“æœä¾‹å­ ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 2.2.3.2 é€‰é¡¹ 2ï¼šç¼–è¯‘ã€æäº¤ç¤ºä¾‹ JAR åŒ… å…ˆå…‹éš† Spark Connector å’Œå®ƒç¤ºä¾‹ä»£ç çš„ä»£ç ä»“åº“ï¼Œç„¶åç¼–è¯‘ï¼š æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† master åˆ†æ”¯ï¼Œå› ä¸ºå½“ä¸‹ master åˆ†æ”¯æ˜¯å…¼å®¹ 3.x çš„ï¼Œä¸€å®šè¦ä¿è¯ spark connector å’Œæ•°æ®åº“å†…æ ¸ç‰ˆæœ¬æ˜¯åŒ¹é…çš„ï¼Œç‰ˆæœ¬å¯¹åº”å…³ç³»å‚è€ƒä»£ç ä»“åº“çš„ README.md ã€‚ cd ~/.nebula-up/nebula-up/spark git clone https://github.com/vesoft-inc/nebula-spark-connector.git docker exec -it sparkmaster bash cd /root/nebula-spark-connector æ›¿æ¢ç¤ºä¾‹é¡¹ç›®çš„ä»£ç  echo \u003e example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala vi example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala æŠŠå¦‚ä¸‹çš„ä»£ç ç²˜è´´è¿›å»ï¼Œè¿™é‡Œè¾¹æˆ‘ä»¬å¯¹å‰è¾¹åŠ è½½çš„å›¾ï¼š basketballplayer ä¸Šåšäº†é¡¶ç‚¹å’Œè¾¹çš„è¯»æ“ä½œï¼šåˆ†åˆ«è°ƒç”¨ readVertex å’Œ readEdgesã€‚ package com.vesoft.nebula.examples.connector import com.facebook.thrift.protocol.TCompactProtocol import com.vesoft.nebula.connector.connector.NebulaDataFrameReader import com.vesoft.nebula.connector.{NebulaConnectionConfig, ReadNebulaConfig} import org.apache.spark.SparkConf import org.apache.spark.sql.SparkSession import org.slf4j.LoggerFactory object NebulaSparkReaderExample { private val LOG = LoggerFactory.getLogger(this.getClass) def main(args: Array[String]): Unit = { val sparkConf = new SparkConf sparkConf .set(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\") .registerKryoClasses(Array[Class[_]](classOf[TCompactProt","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:2:2","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#è¿›å…¥-spark-ç¯å¢ƒ"},{"categories":["Nebula Graph"],"content":" 2.2 ä¸Šæ‰‹ Nebula Spark Connectorå…ˆå†³æ¡ä»¶ï¼šå‡è®¾ä¸‹é¢çš„ç¨‹åºæ˜¯åœ¨ä¸€å°æœ‰äº’è”ç½‘è¿æ¥çš„ Linux æœºå™¨ä¸Šè¿è¡Œçš„ï¼Œæœ€å¥½æ˜¯é¢„è£…äº† Docker å’Œ Docker-Composeã€‚ 2.2.1 æ‹‰èµ·ç¯å¢ƒé¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Up éƒ¨ç½²åŸºäºå®¹å™¨çš„ Nebula Graph Core v3ã€Nebula Studioã€Nebula Console å’Œ Sparkã€Hadoop ç¯å¢ƒï¼Œå¦‚æœè¿˜æ²¡å®‰è£…å¥½å®ƒä¹Ÿä¼šå°è¯•ä¸ºæˆ‘ä»¬å®‰è£… Docker å’Œ Docker-Composeã€‚ # Install Core with Spark Connector, Nebula Algorithm, Nebula Exchange curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 spark ä½ çŸ¥é“å— Nebula-UP å¯ä»¥ä¸€é”®è£…æ›´å¤šä¸œè¥¿ï¼Œå¦‚æœä½ çš„ç¯å¢ƒé…ç½®å¤§ä¸€ç‚¹ï¼ˆæ¯”å¦‚ 8 GB RAMï¼‰curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash å¯ä»¥è£…æ›´å¤šä¸œè¥¿ï¼Œä½†æ˜¯è¯·æ³¨æ„ Nebula-UP ä¸æ˜¯ä¸ºç”Ÿäº§ç¯å¢ƒå‡†å¤‡çš„ã€‚ ä¸Šè¿°è¾¹è„šæœ¬æ‰§è¡Œåï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Consoleï¼ˆNebula Graph çš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼‰æ¥è¿æ¥å®ƒã€‚ # Connect to nebula with console ~/.nebula-up/console.sh # Execute any queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" åŠ è½½ä¸€ä»½æ•°æ®è¿›å»ï¼Œå¹¶æ‰§è¡Œä¸€ä¸ªå›¾æŸ¥è¯¢ï¼š # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # ç­‰ä¸€åˆ†é’Ÿå·¦å³ # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 2.2.2 è¿›å…¥ Spark ç¯å¢ƒæ‰§è¡Œä¸‹é¢è¿™ä¸€è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥åˆ° Spark ç¯å¢ƒï¼š docker exec -it sparkmaster bash å¦‚æœæˆ‘ä»¬æƒ³æ‰§è¡Œç¼–è¯‘ï¼Œå¯ä»¥åœ¨é‡Œè¾¹å®‰è£… mvnï¼š docker exec -it sparkmaster bash # in the container shell export MAVEN_VERSION=3.5.4 export MAVEN_HOME=/usr/lib/mvn export PATH=$MAVEN_HOME/bin:$PATH wget http://archive.apache.org/dist/maven/maven-3/$MAVEN_VERSION/binaries/apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ tar -zxvf apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ rm apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ mv apache-maven-$MAVEN_VERSION /usr/lib/mvn 2.2.3 è·‘ Spark Connector çš„ä¾‹å­ 2.2.3.1 é€‰é¡¹ 1ï¼ˆæ¨èï¼‰ï¼šé€šè¿‡ PySpark è¿›å…¥ PySpark Shell ~/.nebula-up/nebula-pyspark.sh è°ƒç”¨ Nebula Spark Reader # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit of 2 df.show(n=2) è¿”å›ç»“æœä¾‹å­ ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 2.2.3.2 é€‰é¡¹ 2ï¼šç¼–è¯‘ã€æäº¤ç¤ºä¾‹ JAR åŒ… å…ˆå…‹éš† Spark Connector å’Œå®ƒç¤ºä¾‹ä»£ç çš„ä»£ç ä»“åº“ï¼Œç„¶åç¼–è¯‘ï¼š æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† master åˆ†æ”¯ï¼Œå› ä¸ºå½“ä¸‹ master åˆ†æ”¯æ˜¯å…¼å®¹ 3.x çš„ï¼Œä¸€å®šè¦ä¿è¯ spark connector å’Œæ•°æ®åº“å†…æ ¸ç‰ˆæœ¬æ˜¯åŒ¹é…çš„ï¼Œç‰ˆæœ¬å¯¹åº”å…³ç³»å‚è€ƒä»£ç ä»“åº“çš„ README.md ã€‚ cd ~/.nebula-up/nebula-up/spark git clone https://github.com/vesoft-inc/nebula-spark-connector.git docker exec -it sparkmaster bash cd /root/nebula-spark-connector æ›¿æ¢ç¤ºä¾‹é¡¹ç›®çš„ä»£ç  echo \u003e example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala vi example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala æŠŠå¦‚ä¸‹çš„ä»£ç ç²˜è´´è¿›å»ï¼Œè¿™é‡Œè¾¹æˆ‘ä»¬å¯¹å‰è¾¹åŠ è½½çš„å›¾ï¼š basketballplayer ä¸Šåšäº†é¡¶ç‚¹å’Œè¾¹çš„è¯»æ“ä½œï¼šåˆ†åˆ«è°ƒç”¨ readVertex å’Œ readEdgesã€‚ package com.vesoft.nebula.examples.connector import com.facebook.thrift.protocol.TCompactProtocol import com.vesoft.nebula.connector.connector.NebulaDataFrameReader import com.vesoft.nebula.connector.{NebulaConnectionConfig, ReadNebulaConfig} import org.apache.spark.SparkConf import org.apache.spark.sql.SparkSession import org.slf4j.LoggerFactory object NebulaSparkReaderExample { private val LOG = LoggerFactory.getLogger(this.getClass) def main(args: Array[String]): Unit = { val sparkConf = new SparkConf sparkConf .set(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\") .registerKryoClasses(Array[Class[_]](classOf[TCompactProt","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:2:2","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#è·‘-spark-connector-çš„ä¾‹å­"},{"categories":["Nebula Graph"],"content":" 2.2 ä¸Šæ‰‹ Nebula Spark Connectorå…ˆå†³æ¡ä»¶ï¼šå‡è®¾ä¸‹é¢çš„ç¨‹åºæ˜¯åœ¨ä¸€å°æœ‰äº’è”ç½‘è¿æ¥çš„ Linux æœºå™¨ä¸Šè¿è¡Œçš„ï¼Œæœ€å¥½æ˜¯é¢„è£…äº† Docker å’Œ Docker-Composeã€‚ 2.2.1 æ‹‰èµ·ç¯å¢ƒé¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Up éƒ¨ç½²åŸºäºå®¹å™¨çš„ Nebula Graph Core v3ã€Nebula Studioã€Nebula Console å’Œ Sparkã€Hadoop ç¯å¢ƒï¼Œå¦‚æœè¿˜æ²¡å®‰è£…å¥½å®ƒä¹Ÿä¼šå°è¯•ä¸ºæˆ‘ä»¬å®‰è£… Docker å’Œ Docker-Composeã€‚ # Install Core with Spark Connector, Nebula Algorithm, Nebula Exchange curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 spark ä½ çŸ¥é“å— Nebula-UP å¯ä»¥ä¸€é”®è£…æ›´å¤šä¸œè¥¿ï¼Œå¦‚æœä½ çš„ç¯å¢ƒé…ç½®å¤§ä¸€ç‚¹ï¼ˆæ¯”å¦‚ 8 GB RAMï¼‰curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash å¯ä»¥è£…æ›´å¤šä¸œè¥¿ï¼Œä½†æ˜¯è¯·æ³¨æ„ Nebula-UP ä¸æ˜¯ä¸ºç”Ÿäº§ç¯å¢ƒå‡†å¤‡çš„ã€‚ ä¸Šè¿°è¾¹è„šæœ¬æ‰§è¡Œåï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Consoleï¼ˆNebula Graph çš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼‰æ¥è¿æ¥å®ƒã€‚ # Connect to nebula with console ~/.nebula-up/console.sh # Execute any queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" åŠ è½½ä¸€ä»½æ•°æ®è¿›å»ï¼Œå¹¶æ‰§è¡Œä¸€ä¸ªå›¾æŸ¥è¯¢ï¼š # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # ç­‰ä¸€åˆ†é’Ÿå·¦å³ # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 2.2.2 è¿›å…¥ Spark ç¯å¢ƒæ‰§è¡Œä¸‹é¢è¿™ä¸€è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥åˆ° Spark ç¯å¢ƒï¼š docker exec -it sparkmaster bash å¦‚æœæˆ‘ä»¬æƒ³æ‰§è¡Œç¼–è¯‘ï¼Œå¯ä»¥åœ¨é‡Œè¾¹å®‰è£… mvnï¼š docker exec -it sparkmaster bash # in the container shell export MAVEN_VERSION=3.5.4 export MAVEN_HOME=/usr/lib/mvn export PATH=$MAVEN_HOME/bin:$PATH wget http://archive.apache.org/dist/maven/maven-3/$MAVEN_VERSION/binaries/apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ tar -zxvf apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ rm apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ mv apache-maven-$MAVEN_VERSION /usr/lib/mvn 2.2.3 è·‘ Spark Connector çš„ä¾‹å­ 2.2.3.1 é€‰é¡¹ 1ï¼ˆæ¨èï¼‰ï¼šé€šè¿‡ PySpark è¿›å…¥ PySpark Shell ~/.nebula-up/nebula-pyspark.sh è°ƒç”¨ Nebula Spark Reader # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit of 2 df.show(n=2) è¿”å›ç»“æœä¾‹å­ ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 2.2.3.2 é€‰é¡¹ 2ï¼šç¼–è¯‘ã€æäº¤ç¤ºä¾‹ JAR åŒ… å…ˆå…‹éš† Spark Connector å’Œå®ƒç¤ºä¾‹ä»£ç çš„ä»£ç ä»“åº“ï¼Œç„¶åç¼–è¯‘ï¼š æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† master åˆ†æ”¯ï¼Œå› ä¸ºå½“ä¸‹ master åˆ†æ”¯æ˜¯å…¼å®¹ 3.x çš„ï¼Œä¸€å®šè¦ä¿è¯ spark connector å’Œæ•°æ®åº“å†…æ ¸ç‰ˆæœ¬æ˜¯åŒ¹é…çš„ï¼Œç‰ˆæœ¬å¯¹åº”å…³ç³»å‚è€ƒä»£ç ä»“åº“çš„ README.md ã€‚ cd ~/.nebula-up/nebula-up/spark git clone https://github.com/vesoft-inc/nebula-spark-connector.git docker exec -it sparkmaster bash cd /root/nebula-spark-connector æ›¿æ¢ç¤ºä¾‹é¡¹ç›®çš„ä»£ç  echo \u003e example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala vi example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala æŠŠå¦‚ä¸‹çš„ä»£ç ç²˜è´´è¿›å»ï¼Œè¿™é‡Œè¾¹æˆ‘ä»¬å¯¹å‰è¾¹åŠ è½½çš„å›¾ï¼š basketballplayer ä¸Šåšäº†é¡¶ç‚¹å’Œè¾¹çš„è¯»æ“ä½œï¼šåˆ†åˆ«è°ƒç”¨ readVertex å’Œ readEdgesã€‚ package com.vesoft.nebula.examples.connector import com.facebook.thrift.protocol.TCompactProtocol import com.vesoft.nebula.connector.connector.NebulaDataFrameReader import com.vesoft.nebula.connector.{NebulaConnectionConfig, ReadNebulaConfig} import org.apache.spark.SparkConf import org.apache.spark.sql.SparkSession import org.slf4j.LoggerFactory object NebulaSparkReaderExample { private val LOG = LoggerFactory.getLogger(this.getClass) def main(args: Array[String]): Unit = { val sparkConf = new SparkConf sparkConf .set(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\") .registerKryoClasses(Array[Class[_]](classOf[TCompactProt","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:2:2","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#é€‰é¡¹-1æ¨èé€šè¿‡-pyspark"},{"categories":["Nebula Graph"],"content":" 2.2 ä¸Šæ‰‹ Nebula Spark Connectorå…ˆå†³æ¡ä»¶ï¼šå‡è®¾ä¸‹é¢çš„ç¨‹åºæ˜¯åœ¨ä¸€å°æœ‰äº’è”ç½‘è¿æ¥çš„ Linux æœºå™¨ä¸Šè¿è¡Œçš„ï¼Œæœ€å¥½æ˜¯é¢„è£…äº† Docker å’Œ Docker-Composeã€‚ 2.2.1 æ‹‰èµ·ç¯å¢ƒé¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Up éƒ¨ç½²åŸºäºå®¹å™¨çš„ Nebula Graph Core v3ã€Nebula Studioã€Nebula Console å’Œ Sparkã€Hadoop ç¯å¢ƒï¼Œå¦‚æœè¿˜æ²¡å®‰è£…å¥½å®ƒä¹Ÿä¼šå°è¯•ä¸ºæˆ‘ä»¬å®‰è£… Docker å’Œ Docker-Composeã€‚ # Install Core with Spark Connector, Nebula Algorithm, Nebula Exchange curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 spark ä½ çŸ¥é“å— Nebula-UP å¯ä»¥ä¸€é”®è£…æ›´å¤šä¸œè¥¿ï¼Œå¦‚æœä½ çš„ç¯å¢ƒé…ç½®å¤§ä¸€ç‚¹ï¼ˆæ¯”å¦‚ 8 GB RAMï¼‰curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash å¯ä»¥è£…æ›´å¤šä¸œè¥¿ï¼Œä½†æ˜¯è¯·æ³¨æ„ Nebula-UP ä¸æ˜¯ä¸ºç”Ÿäº§ç¯å¢ƒå‡†å¤‡çš„ã€‚ ä¸Šè¿°è¾¹è„šæœ¬æ‰§è¡Œåï¼Œè®©æˆ‘ä»¬ç”¨ Nebula-Consoleï¼ˆNebula Graph çš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼‰æ¥è¿æ¥å®ƒã€‚ # Connect to nebula with console ~/.nebula-up/console.sh # Execute any queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" åŠ è½½ä¸€ä»½æ•°æ®è¿›å»ï¼Œå¹¶æ‰§è¡Œä¸€ä¸ªå›¾æŸ¥è¯¢ï¼š # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # ç­‰ä¸€åˆ†é’Ÿå·¦å³ # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 2.2.2 è¿›å…¥ Spark ç¯å¢ƒæ‰§è¡Œä¸‹é¢è¿™ä¸€è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥åˆ° Spark ç¯å¢ƒï¼š docker exec -it sparkmaster bash å¦‚æœæˆ‘ä»¬æƒ³æ‰§è¡Œç¼–è¯‘ï¼Œå¯ä»¥åœ¨é‡Œè¾¹å®‰è£… mvnï¼š docker exec -it sparkmaster bash # in the container shell export MAVEN_VERSION=3.5.4 export MAVEN_HOME=/usr/lib/mvn export PATH=$MAVEN_HOME/bin:$PATH wget http://archive.apache.org/dist/maven/maven-3/$MAVEN_VERSION/binaries/apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ tar -zxvf apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ rm apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ mv apache-maven-$MAVEN_VERSION /usr/lib/mvn 2.2.3 è·‘ Spark Connector çš„ä¾‹å­ 2.2.3.1 é€‰é¡¹ 1ï¼ˆæ¨èï¼‰ï¼šé€šè¿‡ PySpark è¿›å…¥ PySpark Shell ~/.nebula-up/nebula-pyspark.sh è°ƒç”¨ Nebula Spark Reader # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit of 2 df.show(n=2) è¿”å›ç»“æœä¾‹å­ ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 2.2.3.2 é€‰é¡¹ 2ï¼šç¼–è¯‘ã€æäº¤ç¤ºä¾‹ JAR åŒ… å…ˆå…‹éš† Spark Connector å’Œå®ƒç¤ºä¾‹ä»£ç çš„ä»£ç ä»“åº“ï¼Œç„¶åç¼–è¯‘ï¼š æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† master åˆ†æ”¯ï¼Œå› ä¸ºå½“ä¸‹ master åˆ†æ”¯æ˜¯å…¼å®¹ 3.x çš„ï¼Œä¸€å®šè¦ä¿è¯ spark connector å’Œæ•°æ®åº“å†…æ ¸ç‰ˆæœ¬æ˜¯åŒ¹é…çš„ï¼Œç‰ˆæœ¬å¯¹åº”å…³ç³»å‚è€ƒä»£ç ä»“åº“çš„ README.md ã€‚ cd ~/.nebula-up/nebula-up/spark git clone https://github.com/vesoft-inc/nebula-spark-connector.git docker exec -it sparkmaster bash cd /root/nebula-spark-connector æ›¿æ¢ç¤ºä¾‹é¡¹ç›®çš„ä»£ç  echo \u003e example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala vi example/src/main/scala/com/vesoft/nebula/examples/connector/NebulaSparkReaderExample.scala æŠŠå¦‚ä¸‹çš„ä»£ç ç²˜è´´è¿›å»ï¼Œè¿™é‡Œè¾¹æˆ‘ä»¬å¯¹å‰è¾¹åŠ è½½çš„å›¾ï¼š basketballplayer ä¸Šåšäº†é¡¶ç‚¹å’Œè¾¹çš„è¯»æ“ä½œï¼šåˆ†åˆ«è°ƒç”¨ readVertex å’Œ readEdgesã€‚ package com.vesoft.nebula.examples.connector import com.facebook.thrift.protocol.TCompactProtocol import com.vesoft.nebula.connector.connector.NebulaDataFrameReader import com.vesoft.nebula.connector.{NebulaConnectionConfig, ReadNebulaConfig} import org.apache.spark.SparkConf import org.apache.spark.sql.SparkSession import org.slf4j.LoggerFactory object NebulaSparkReaderExample { private val LOG = LoggerFactory.getLogger(this.getClass) def main(args: Array[String]): Unit = { val sparkConf = new SparkConf sparkConf .set(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\") .registerKryoClasses(Array[Class[_]](classOf[TCompactProt","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:2:2","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#é€‰é¡¹-2ç¼–è¯‘æäº¤ç¤ºä¾‹-jar-åŒ…"},{"categories":["Nebula Graph"],"content":" 3 Nebula Exchange ä»£ç ï¼šhttps://github.com/vesoft-inc/nebula-exchange/ æ–‡æ¡£ï¼šhttps://docs.nebula-graph.com.cn/3.1.0/nebula-exchange/about-exchange/ex-ug-what-is-exchange/ JAR åŒ…ï¼šhttps://github.com/vesoft-inc/nebula-exchange/releases é…ç½®ä¾‹å­ï¼š exchange-common/src/test/resources/application.conf Nebula Exchange æ˜¯ä¸€ä¸ª Spark Libï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¯ä»¥ç›´æ¥æäº¤æ‰§è¡Œçš„ Spark åº”ç”¨ï¼Œå®ƒè¢«ç”¨æ¥ä»å¤šä¸ªæ•°æ®æºè¯»å–æ•°æ®å†™å…¥ Nebula Graph æˆ–è€…è¾“å‡º Nebula Graph SST æ–‡ä»¶ã€‚ é€šè¿‡ spark-submit çš„æ–¹å¼ä½¿ç”¨ Nebula Exchange çš„æ–¹æ³•å¾ˆç›´æ¥ï¼š é¦–å…ˆåˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œè®© Exchange çŸ¥é“åº”è¯¥å¦‚ä½•è·å–å’Œå†™å…¥æ•°æ® ç„¶åç”¨æŒ‡å®šçš„é…ç½®æ–‡ä»¶è°ƒç”¨ Exchange åŒ… ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨ä¸Šä¸€ç« ä¸­åˆ›å»ºçš„ç›¸åŒç¯å¢ƒåšä¸€ä¸ªå®é™…æµ‹è¯•ã€‚ ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:3:0","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#nebula-exchange"},{"categories":["Nebula Graph"],"content":" 3.1 ä¸€é”®è¯•ç© Exchange 3.1.1 å…ˆè·‘èµ·æ¥çœ‹çœ‹å§ è¯·å‚è€ƒå‰è¾¹æ‹‰èµ·ç¯å¢ƒè¿™ä¸€ç« èŠ‚ï¼Œå…ˆä¸€é”®è£…å¥½ç¯å¢ƒã€‚ ä¸€é”®æ‰§è¡Œï¼š ~/.nebula-up/nebula-exchange-example.sh æ­å–œä½ ï¼Œå·²ç»ç¬¬ä¸€æ¬¡æ‰§è¡ŒæˆåŠŸä¸€ä¸ª Exchange çš„æ•°æ®å¯¼å…¥ä»»åŠ¡å•¦ï¼ 3.1.2 å†çœ‹çœ‹ä¸€äº›ç»†èŠ‚è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯ç”¨ Exchange ä» CSV æ–‡ä»¶è¿™ä¸€å…¶ä¸­æ”¯æŒçš„æ•°æ®æºä¸­è¯»å–æ•°æ®å†™å…¥ Nebula Graph é›†ç¾¤çš„ã€‚è¿™ä¸ª CSV æ–‡ä»¶ä¸­ç¬¬ä¸€åˆ—æ˜¯é¡¶ç‚¹ IDï¼Œç¬¬äºŒå’Œç¬¬ä¸‰åˆ—æ˜¯ â€œå§“å â€œå’Œ â€œå¹´é¾„ â€œçš„å±æ€§ï¼š player800,\"Foo Bar\",23 player801,\"Another Name\",21 å’±ä»¬å¯ä»¥è¿›åˆ° Spark ç¯å¢ƒé‡Œçœ‹çœ‹ docker exec -it sparkmaster bash cd /root å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æäº¤ Exchange ä»»åŠ¡æ—¶å€™æŒ‡å®šçš„é…ç½®æ–‡ä»¶ exchange.conf å®ƒæ˜¯ä¸€ä¸ª HOCON æ ¼å¼çš„æ–‡ä»¶ï¼š åœ¨ .nebula ä¸­æè¿°äº† Nebula Graph é›†ç¾¤çš„ç›¸å…³ä¿¡æ¯ åœ¨ .tags ä¸­æè¿°äº†å¦‚ä½•å°†å¿…å¡«å­—æ®µå¯¹åº”åˆ°æˆ‘ä»¬çš„æ•°æ®æºï¼ˆè¿™é‡Œæ˜¯ CSV æ–‡ä»¶ï¼‰ç­‰æœ‰å…³ Vertecies çš„ä¿¡æ¯ã€‚ { # Spark relation config spark: { app: { name: Nebula Exchange } master:local driver: { cores: 1 maxResultSize: 1G } executor: { memory: 1G } cores:{ max: 16 } } # Nebula Graph relation config nebula: { address:{ graph:[\"graphd:9669\"] meta:[\"metad0:9559\", \"metad1:9559\", \"metad2:9559\"] } user: root pswd: nebula space: basketballplayer # parameters for SST import, not required path:{ local:\"/tmp\" remote:\"/sst\" hdfs.namenode: \"hdfs://localhost:9000\" } # nebula client connection parameters connection { # socket connect \u0026 execute timeout, unit: millisecond timeout: 30000 } error: { # max number of failures, if the number of failures is bigger than max, then exit the application. max: 32 # failed import job will be recorded in output path output: /tmp/errors } # use google's RateLimiter to limit the requests send to NebulaGraph rate: { # the stable throughput of RateLimiter limit: 1024 # Acquires a permit from RateLimiter, unit: MILLISECONDS # if it can't be obtained within the specified timeout, then give up the request. timeout: 1000 } } # Processing tags # There are tag config examples for different dataSources. tags: [ # HDFS csv # Import mode is client, just change type.sink to sst if you want to use client import mode. { name: player type: { source: csv sink: client } path: \"file:///root/player.csv\" # if your csv file has no header, then use _c0,_c1,_c2,.. to indicate fields fields: [_c1, _c2] nebula.fields: [name, age] vertex: { field:_c0 } separator: \",\" header: false batch: 256 partition: 32 } ] } æˆ‘ä»¬åº”è¯¥èƒ½çœ‹åˆ°é‚£ä¸ª CSV æ•°æ®æºå’Œè¿™ä¸ªé…ç½®æ–‡ä»¶éƒ½åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹äº†ï¼š bash-5.0# ls -l total 24 drwxrwxr-x 2 1000 1000 4096 Jun 1 04:26 download -rw-rw-r-- 1 1000 1000 1908 Jun 1 04:23 exchange.conf -rw-rw-r-- 1 1000 1000 2593 Jun 1 04:23 hadoop.env drwxrwxr-x 7 1000 1000 4096 Jun 6 03:27 nebula-spark-connector -rw-rw-r-- 1 1000 1000 51 Jun 1 04:23 player.csv ç„¶åï¼Œå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å†æ¬¡æäº¤ä¸€ä¸‹è¿™ä¸ª Exchange ä»»åŠ¡ /spark/bin/spark-submit --master local \\ --class com.vesoft.nebula.exchange.Exchange download/nebula-exchange.jar \\ -c exchange.conf éƒ¨åˆ†è¿”å›ç»“æœ 22/06/06 03:56:26 INFO Exchange$: Processing Tag player 22/06/06 03:56:26 INFO Exchange$: field keys: _c1, _c2 22/06/06 03:56:26 INFO Exchange$: nebula keys: name, age 22/06/06 03:56:26 INFO Exchange$: Loading CSV files from file:///root/player.csv ... 22/06/06 03:56:41 INFO Exchange$: import for tag player cost time: 3.35 s 22/06/06 03:56:41 INFO Exchange$: Client-Import: batchSuccess.player: 2 22/06/06 03:56:41 INFO Exchange$: Client-Import: batchFailure.player: 0 ... æ›´å¤šçš„æ•°æ®æºï¼Œè¯·å‚è€ƒæ–‡æ¡£å’Œé…ç½®çš„ä¾‹å­ã€‚ å…³äº Exchange è¾“å‡º SST æ–‡ä»¶çš„å®è·µï¼Œä½ å¯ä»¥å‚è€ƒæ–‡æ¡£å’Œæˆ‘çš„æ—§æ–‡ Nebula Exchange SST 2.xå®è·µæŒ‡å—ã€‚ ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:3:1","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#ä¸€é”®è¯•ç©-exchange"},{"categories":["Nebula Graph"],"content":" 3.1 ä¸€é”®è¯•ç© Exchange 3.1.1 å…ˆè·‘èµ·æ¥çœ‹çœ‹å§ è¯·å‚è€ƒå‰è¾¹æ‹‰èµ·ç¯å¢ƒè¿™ä¸€ç« èŠ‚ï¼Œå…ˆä¸€é”®è£…å¥½ç¯å¢ƒã€‚ ä¸€é”®æ‰§è¡Œï¼š ~/.nebula-up/nebula-exchange-example.sh æ­å–œä½ ï¼Œå·²ç»ç¬¬ä¸€æ¬¡æ‰§è¡ŒæˆåŠŸä¸€ä¸ª Exchange çš„æ•°æ®å¯¼å…¥ä»»åŠ¡å•¦ï¼ 3.1.2 å†çœ‹çœ‹ä¸€äº›ç»†èŠ‚è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯ç”¨ Exchange ä» CSV æ–‡ä»¶è¿™ä¸€å…¶ä¸­æ”¯æŒçš„æ•°æ®æºä¸­è¯»å–æ•°æ®å†™å…¥ Nebula Graph é›†ç¾¤çš„ã€‚è¿™ä¸ª CSV æ–‡ä»¶ä¸­ç¬¬ä¸€åˆ—æ˜¯é¡¶ç‚¹ IDï¼Œç¬¬äºŒå’Œç¬¬ä¸‰åˆ—æ˜¯ â€œå§“å â€œå’Œ â€œå¹´é¾„ â€œçš„å±æ€§ï¼š player800,\"Foo Bar\",23 player801,\"Another Name\",21 å’±ä»¬å¯ä»¥è¿›åˆ° Spark ç¯å¢ƒé‡Œçœ‹çœ‹ docker exec -it sparkmaster bash cd /root å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æäº¤ Exchange ä»»åŠ¡æ—¶å€™æŒ‡å®šçš„é…ç½®æ–‡ä»¶ exchange.conf å®ƒæ˜¯ä¸€ä¸ª HOCON æ ¼å¼çš„æ–‡ä»¶ï¼š åœ¨ .nebula ä¸­æè¿°äº† Nebula Graph é›†ç¾¤çš„ç›¸å…³ä¿¡æ¯ åœ¨ .tags ä¸­æè¿°äº†å¦‚ä½•å°†å¿…å¡«å­—æ®µå¯¹åº”åˆ°æˆ‘ä»¬çš„æ•°æ®æºï¼ˆè¿™é‡Œæ˜¯ CSV æ–‡ä»¶ï¼‰ç­‰æœ‰å…³ Vertecies çš„ä¿¡æ¯ã€‚ { # Spark relation config spark: { app: { name: Nebula Exchange } master:local driver: { cores: 1 maxResultSize: 1G } executor: { memory: 1G } cores:{ max: 16 } } # Nebula Graph relation config nebula: { address:{ graph:[\"graphd:9669\"] meta:[\"metad0:9559\", \"metad1:9559\", \"metad2:9559\"] } user: root pswd: nebula space: basketballplayer # parameters for SST import, not required path:{ local:\"/tmp\" remote:\"/sst\" hdfs.namenode: \"hdfs://localhost:9000\" } # nebula client connection parameters connection { # socket connect \u0026 execute timeout, unit: millisecond timeout: 30000 } error: { # max number of failures, if the number of failures is bigger than max, then exit the application. max: 32 # failed import job will be recorded in output path output: /tmp/errors } # use google's RateLimiter to limit the requests send to NebulaGraph rate: { # the stable throughput of RateLimiter limit: 1024 # Acquires a permit from RateLimiter, unit: MILLISECONDS # if it can't be obtained within the specified timeout, then give up the request. timeout: 1000 } } # Processing tags # There are tag config examples for different dataSources. tags: [ # HDFS csv # Import mode is client, just change type.sink to sst if you want to use client import mode. { name: player type: { source: csv sink: client } path: \"file:///root/player.csv\" # if your csv file has no header, then use _c0,_c1,_c2,.. to indicate fields fields: [_c1, _c2] nebula.fields: [name, age] vertex: { field:_c0 } separator: \",\" header: false batch: 256 partition: 32 } ] } æˆ‘ä»¬åº”è¯¥èƒ½çœ‹åˆ°é‚£ä¸ª CSV æ•°æ®æºå’Œè¿™ä¸ªé…ç½®æ–‡ä»¶éƒ½åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹äº†ï¼š bash-5.0# ls -l total 24 drwxrwxr-x 2 1000 1000 4096 Jun 1 04:26 download -rw-rw-r-- 1 1000 1000 1908 Jun 1 04:23 exchange.conf -rw-rw-r-- 1 1000 1000 2593 Jun 1 04:23 hadoop.env drwxrwxr-x 7 1000 1000 4096 Jun 6 03:27 nebula-spark-connector -rw-rw-r-- 1 1000 1000 51 Jun 1 04:23 player.csv ç„¶åï¼Œå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å†æ¬¡æäº¤ä¸€ä¸‹è¿™ä¸ª Exchange ä»»åŠ¡ /spark/bin/spark-submit --master local \\ --class com.vesoft.nebula.exchange.Exchange download/nebula-exchange.jar \\ -c exchange.conf éƒ¨åˆ†è¿”å›ç»“æœ 22/06/06 03:56:26 INFO Exchange$: Processing Tag player 22/06/06 03:56:26 INFO Exchange$: field keys: _c1, _c2 22/06/06 03:56:26 INFO Exchange$: nebula keys: name, age 22/06/06 03:56:26 INFO Exchange$: Loading CSV files from file:///root/player.csv ... 22/06/06 03:56:41 INFO Exchange$: import for tag player cost time: 3.35 s 22/06/06 03:56:41 INFO Exchange$: Client-Import: batchSuccess.player: 2 22/06/06 03:56:41 INFO Exchange$: Client-Import: batchFailure.player: 0 ... æ›´å¤šçš„æ•°æ®æºï¼Œè¯·å‚è€ƒæ–‡æ¡£å’Œé…ç½®çš„ä¾‹å­ã€‚ å…³äº Exchange è¾“å‡º SST æ–‡ä»¶çš„å®è·µï¼Œä½ å¯ä»¥å‚è€ƒæ–‡æ¡£å’Œæˆ‘çš„æ—§æ–‡ Nebula Exchange SST 2.xå®è·µæŒ‡å—ã€‚ ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:3:1","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#å…ˆè·‘èµ·æ¥çœ‹çœ‹å§"},{"categories":["Nebula Graph"],"content":" 3.1 ä¸€é”®è¯•ç© Exchange 3.1.1 å…ˆè·‘èµ·æ¥çœ‹çœ‹å§ è¯·å‚è€ƒå‰è¾¹æ‹‰èµ·ç¯å¢ƒè¿™ä¸€ç« èŠ‚ï¼Œå…ˆä¸€é”®è£…å¥½ç¯å¢ƒã€‚ ä¸€é”®æ‰§è¡Œï¼š ~/.nebula-up/nebula-exchange-example.sh æ­å–œä½ ï¼Œå·²ç»ç¬¬ä¸€æ¬¡æ‰§è¡ŒæˆåŠŸä¸€ä¸ª Exchange çš„æ•°æ®å¯¼å…¥ä»»åŠ¡å•¦ï¼ 3.1.2 å†çœ‹çœ‹ä¸€äº›ç»†èŠ‚è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯ç”¨ Exchange ä» CSV æ–‡ä»¶è¿™ä¸€å…¶ä¸­æ”¯æŒçš„æ•°æ®æºä¸­è¯»å–æ•°æ®å†™å…¥ Nebula Graph é›†ç¾¤çš„ã€‚è¿™ä¸ª CSV æ–‡ä»¶ä¸­ç¬¬ä¸€åˆ—æ˜¯é¡¶ç‚¹ IDï¼Œç¬¬äºŒå’Œç¬¬ä¸‰åˆ—æ˜¯ â€œå§“å â€œå’Œ â€œå¹´é¾„ â€œçš„å±æ€§ï¼š player800,\"Foo Bar\",23 player801,\"Another Name\",21 å’±ä»¬å¯ä»¥è¿›åˆ° Spark ç¯å¢ƒé‡Œçœ‹çœ‹ docker exec -it sparkmaster bash cd /root å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æäº¤ Exchange ä»»åŠ¡æ—¶å€™æŒ‡å®šçš„é…ç½®æ–‡ä»¶ exchange.conf å®ƒæ˜¯ä¸€ä¸ª HOCON æ ¼å¼çš„æ–‡ä»¶ï¼š åœ¨ .nebula ä¸­æè¿°äº† Nebula Graph é›†ç¾¤çš„ç›¸å…³ä¿¡æ¯ åœ¨ .tags ä¸­æè¿°äº†å¦‚ä½•å°†å¿…å¡«å­—æ®µå¯¹åº”åˆ°æˆ‘ä»¬çš„æ•°æ®æºï¼ˆè¿™é‡Œæ˜¯ CSV æ–‡ä»¶ï¼‰ç­‰æœ‰å…³ Vertecies çš„ä¿¡æ¯ã€‚ { # Spark relation config spark: { app: { name: Nebula Exchange } master:local driver: { cores: 1 maxResultSize: 1G } executor: { memory: 1G } cores:{ max: 16 } } # Nebula Graph relation config nebula: { address:{ graph:[\"graphd:9669\"] meta:[\"metad0:9559\", \"metad1:9559\", \"metad2:9559\"] } user: root pswd: nebula space: basketballplayer # parameters for SST import, not required path:{ local:\"/tmp\" remote:\"/sst\" hdfs.namenode: \"hdfs://localhost:9000\" } # nebula client connection parameters connection { # socket connect \u0026 execute timeout, unit: millisecond timeout: 30000 } error: { # max number of failures, if the number of failures is bigger than max, then exit the application. max: 32 # failed import job will be recorded in output path output: /tmp/errors } # use google's RateLimiter to limit the requests send to NebulaGraph rate: { # the stable throughput of RateLimiter limit: 1024 # Acquires a permit from RateLimiter, unit: MILLISECONDS # if it can't be obtained within the specified timeout, then give up the request. timeout: 1000 } } # Processing tags # There are tag config examples for different dataSources. tags: [ # HDFS csv # Import mode is client, just change type.sink to sst if you want to use client import mode. { name: player type: { source: csv sink: client } path: \"file:///root/player.csv\" # if your csv file has no header, then use _c0,_c1,_c2,.. to indicate fields fields: [_c1, _c2] nebula.fields: [name, age] vertex: { field:_c0 } separator: \",\" header: false batch: 256 partition: 32 } ] } æˆ‘ä»¬åº”è¯¥èƒ½çœ‹åˆ°é‚£ä¸ª CSV æ•°æ®æºå’Œè¿™ä¸ªé…ç½®æ–‡ä»¶éƒ½åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹äº†ï¼š bash-5.0# ls -l total 24 drwxrwxr-x 2 1000 1000 4096 Jun 1 04:26 download -rw-rw-r-- 1 1000 1000 1908 Jun 1 04:23 exchange.conf -rw-rw-r-- 1 1000 1000 2593 Jun 1 04:23 hadoop.env drwxrwxr-x 7 1000 1000 4096 Jun 6 03:27 nebula-spark-connector -rw-rw-r-- 1 1000 1000 51 Jun 1 04:23 player.csv ç„¶åï¼Œå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å†æ¬¡æäº¤ä¸€ä¸‹è¿™ä¸ª Exchange ä»»åŠ¡ /spark/bin/spark-submit --master local \\ --class com.vesoft.nebula.exchange.Exchange download/nebula-exchange.jar \\ -c exchange.conf éƒ¨åˆ†è¿”å›ç»“æœ 22/06/06 03:56:26 INFO Exchange$: Processing Tag player 22/06/06 03:56:26 INFO Exchange$: field keys: _c1, _c2 22/06/06 03:56:26 INFO Exchange$: nebula keys: name, age 22/06/06 03:56:26 INFO Exchange$: Loading CSV files from file:///root/player.csv ... 22/06/06 03:56:41 INFO Exchange$: import for tag player cost time: 3.35 s 22/06/06 03:56:41 INFO Exchange$: Client-Import: batchSuccess.player: 2 22/06/06 03:56:41 INFO Exchange$: Client-Import: batchFailure.player: 0 ... æ›´å¤šçš„æ•°æ®æºï¼Œè¯·å‚è€ƒæ–‡æ¡£å’Œé…ç½®çš„ä¾‹å­ã€‚ å…³äº Exchange è¾“å‡º SST æ–‡ä»¶çš„å®è·µï¼Œä½ å¯ä»¥å‚è€ƒæ–‡æ¡£å’Œæˆ‘çš„æ—§æ–‡ Nebula Exchange SST 2.xå®è·µæŒ‡å—ã€‚ ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:3:1","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#å†çœ‹çœ‹ä¸€äº›ç»†èŠ‚"},{"categories":["Nebula Graph"],"content":" 4 Nebula Algorithm ä»£ç ä»“åº“ï¼š https://github.com/vesoft-inc/nebula-algorithm æ–‡æ¡£ï¼šhttps://docs.nebula-graph.com.cn/3.1.0/nebula-algorithm/ JAR åŒ…ï¼šhttps://repo1.maven.org/maven2/com/vesoft/nebula-algorithm/ ç¤ºä¾‹ä»£ç ï¼šexample/src/main/scala/com/vesoft/nebula/algorithm ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:4:0","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#nebula-algorithm"},{"categories":["Nebula Graph"],"content":" 4.1 é€šè¿‡ spark-submit æäº¤ä»»åŠ¡ æˆ‘åœ¨è¿™ä¸ªä»£ç ä»“åº“é‡Œç»™å‡ºäº†ä¾‹å­ï¼Œä»Šå¤©æˆ‘ä»¬å€ŸåŠ© Nebula-UP å¯ä»¥æ›´æ–¹ä¾¿ä½“éªŒå®ƒã€‚ å‚è€ƒå‰è¾¹æ‹‰èµ·ç¯å¢ƒè¿™ä¸€ç« èŠ‚ï¼Œå…ˆä¸€é”®è£…å¥½ç¯å¢ƒã€‚ åœ¨å¦‚ä¸Šé€šè¿‡ Nebula-UP çš„ Spark æ¨¡å¼éƒ¨ç½²äº†éœ€è¦çš„ä¾èµ–ä¹‹å åŠ è½½ LiveJournal æ•°æ®é›† ~/.nebula-up/load-LiveJournal-dataset.sh åœ¨ LiveJournal æ•°æ®é›†ä¸Šæ‰§è¡Œä¸€ä¸ª PageRank ç®—æ³•ï¼Œç»“æœè¾“å‡ºåˆ° CSV æ–‡ä»¶ä¸­ ~/.nebula-up/nebula-algo-pagerank-example.sh æ£€æŸ¥è¾“å‡ºç»“æœï¼š docker exec -it sparkmaster bash head /output/part*000.csv _id,pagerank 637100,0.9268620883822242 108150,1.1855749056722755 957460,0.923720299211093 257320,0.9967932799358413 4.1.1 é…ç½®æ–‡ä»¶è§£è¯»å®Œæ•´æ–‡ä»¶åœ¨è¿™é‡Œï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä»‹ç»ä¸€ä¸‹ä¸»è¦çš„å­—æ®µï¼š .data æŒ‡å®šäº†æºæ˜¯ Nebulaï¼Œè¡¨ç¤ºä»é›†ç¾¤è·å–å›¾æ•°æ®ï¼Œè¾“å‡ºsinkæ˜¯ csvï¼Œè¡¨ç¤ºå†™åˆ°æœ¬åœ°æ–‡ä»¶é‡Œã€‚ data: { # data source. optional of nebula,csv,json source: nebula # data sink, means the algorithm result will be write into this sink. optional of nebula,csv,text sink: csv # if your algorithm needs weight hasWeight: false } .nebula.read è§„å®šäº†è¯» Nebula Graph é›†ç¾¤çš„å¯¹åº”å…³ç³»ï¼Œè¿™é‡Œæ˜¯è¯»å–æ‰€æœ‰ edge type: follow çš„è¾¹æ•°æ®ä¸ºä¸€æ•´å¼ å›¾ nebula: { # algo's data source from Nebula. If data.source is nebula, then this nebula.read config can be valid. read: { # Nebula metad server address, multiple addresses are split by English comma metaAddress: \"metad0:9559\" # Nebula space space: livejournal # Nebula edge types, multiple labels means that data from multiple edges will union together labels: [\"follow\"] # Nebula edge property name for each edge type, this property will be as weight col for algorithm. # Make sure the weightCols are corresponding to labels. weightCols: [] } .algorithm é‡Œé…ç½®äº†æˆ‘ä»¬è¦è°ƒç”¨çš„ç®—æ³•ï¼Œå’Œç®—æ³•çš„é…ç½® algorithm: { executeAlgo: pagerank # PageRank parameter pagerank: { maxIter: 10 resetProb: 0.15 # default 0.15 } ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:4:1","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#é€šè¿‡-spark-submit-æäº¤ä»»åŠ¡"},{"categories":["Nebula Graph"],"content":" 4.1 é€šè¿‡ spark-submit æäº¤ä»»åŠ¡ æˆ‘åœ¨è¿™ä¸ªä»£ç ä»“åº“é‡Œç»™å‡ºäº†ä¾‹å­ï¼Œä»Šå¤©æˆ‘ä»¬å€ŸåŠ© Nebula-UP å¯ä»¥æ›´æ–¹ä¾¿ä½“éªŒå®ƒã€‚ å‚è€ƒå‰è¾¹æ‹‰èµ·ç¯å¢ƒè¿™ä¸€ç« èŠ‚ï¼Œå…ˆä¸€é”®è£…å¥½ç¯å¢ƒã€‚ åœ¨å¦‚ä¸Šé€šè¿‡ Nebula-UP çš„ Spark æ¨¡å¼éƒ¨ç½²äº†éœ€è¦çš„ä¾èµ–ä¹‹å åŠ è½½ LiveJournal æ•°æ®é›† ~/.nebula-up/load-LiveJournal-dataset.sh åœ¨ LiveJournal æ•°æ®é›†ä¸Šæ‰§è¡Œä¸€ä¸ª PageRank ç®—æ³•ï¼Œç»“æœè¾“å‡ºåˆ° CSV æ–‡ä»¶ä¸­ ~/.nebula-up/nebula-algo-pagerank-example.sh æ£€æŸ¥è¾“å‡ºç»“æœï¼š docker exec -it sparkmaster bash head /output/part*000.csv _id,pagerank 637100,0.9268620883822242 108150,1.1855749056722755 957460,0.923720299211093 257320,0.9967932799358413 4.1.1 é…ç½®æ–‡ä»¶è§£è¯»å®Œæ•´æ–‡ä»¶åœ¨è¿™é‡Œï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ä»‹ç»ä¸€ä¸‹ä¸»è¦çš„å­—æ®µï¼š .data æŒ‡å®šäº†æºæ˜¯ Nebulaï¼Œè¡¨ç¤ºä»é›†ç¾¤è·å–å›¾æ•°æ®ï¼Œè¾“å‡ºsinkæ˜¯ csvï¼Œè¡¨ç¤ºå†™åˆ°æœ¬åœ°æ–‡ä»¶é‡Œã€‚ data: { # data source. optional of nebula,csv,json source: nebula # data sink, means the algorithm result will be write into this sink. optional of nebula,csv,text sink: csv # if your algorithm needs weight hasWeight: false } .nebula.read è§„å®šäº†è¯» Nebula Graph é›†ç¾¤çš„å¯¹åº”å…³ç³»ï¼Œè¿™é‡Œæ˜¯è¯»å–æ‰€æœ‰ edge type: follow çš„è¾¹æ•°æ®ä¸ºä¸€æ•´å¼ å›¾ nebula: { # algo's data source from Nebula. If data.source is nebula, then this nebula.read config can be valid. read: { # Nebula metad server address, multiple addresses are split by English comma metaAddress: \"metad0:9559\" # Nebula space space: livejournal # Nebula edge types, multiple labels means that data from multiple edges will union together labels: [\"follow\"] # Nebula edge property name for each edge type, this property will be as weight col for algorithm. # Make sure the weightCols are corresponding to labels. weightCols: [] } .algorithm é‡Œé…ç½®äº†æˆ‘ä»¬è¦è°ƒç”¨çš„ç®—æ³•ï¼Œå’Œç®—æ³•çš„é…ç½® algorithm: { executeAlgo: pagerank # PageRank parameter pagerank: { maxIter: 10 resetProb: 0.15 # default 0.15 } ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:4:1","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#é…ç½®æ–‡ä»¶è§£è¯»"},{"categories":["Nebula Graph"],"content":" 4.2 ä½œä¸ºä¸€ä¸ªåº“åœ¨ Spark ä¸­è°ƒç”¨ Nebula Algoritmè¯·æ³¨æ„å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥å°† Nebula Algoritm ä½œä¸ºä¸€ä¸ªåº“è°ƒç”¨ï¼Œå®ƒçš„å¥½å¤„åœ¨äºï¼š å¯¹ç®—æ³•çš„è¾“å‡ºæ ¼å¼æœ‰æ›´å¤šçš„æ§åˆ¶/å®šåˆ¶åŠŸèƒ½ å¯ä»¥å¯¹éæ•°å­— ID çš„æƒ…å†µè¿›è¡Œè½¬æ¢ï¼Œè§è¿™é‡Œ è¿™é‡Œæˆ‘å…ˆä¸ç»™å‡ºä¾‹å­äº†ï¼Œå¦‚æœå¤§å®¶æ„Ÿå…´è¶£å¯ä»¥ç»™ Nebula-UP æéœ€æ±‚ï¼Œæˆ‘ä¹Ÿä¼šå¢åŠ ç›¸åº”çš„ä¾‹å­ã€‚ é¢˜å›¾æ¥æºï¼š Sander ","date":"2022-06-06","objectID":"/spark-on-nebula-graph/:4:2","series":null,"tags":["Nebula Graph","Spark","PySpark"],"title":"ä¸€æ–‡äº†è§£ Nebula Graph ä¸Šçš„ Spark é¡¹ç›®","uri":"/spark-on-nebula-graph/#ä½œä¸ºä¸€ä¸ªåº“åœ¨-spark-ä¸­è°ƒç”¨-nebula-algoritm"},{"categories":["Nebula Graph"],"content":"å¾—ç›Šäº Nebula çš„åŸç”Ÿ ARM64v8 çš„æ”¯æŒï¼Œåœ¨æ ‘è“æ´¾ç­‰ ARM å•æ¿ä¸Šè·‘ Nebula Graph ä¹Ÿéå¸¸å®¹æ˜“ã€‚","date":"2022-03-23","objectID":"/nebula-graph-on-pi/","series":null,"tags":["Nebula Graph","ARM","Respberry Pi"],"title":"Nebula Graph on Pi","uri":"/nebula-graph-on-pi/"},{"categories":["Nebula Graph"],"content":" å¾—ç›Šäº Nebula çš„åŸç”Ÿ ARM64v8 çš„æ”¯æŒï¼Œåœ¨æ ‘è“æ´¾ç­‰ ARM å•æ¿ä¸Šè·‘ Nebula Graph éå¸¸å®¹æ˜“ã€‚ ","date":"2022-03-23","objectID":"/nebula-graph-on-pi/:0:0","series":null,"tags":["Nebula Graph","ARM","Respberry Pi"],"title":"Nebula Graph on Pi","uri":"/nebula-graph-on-pi/#"},{"categories":["Nebula Graph"],"content":" 1 èƒŒæ™¯æœ€è¿‘ï¼Œåœ¨ Nebula Graph ç¤¾åŒº Yee è€å¸ˆçš„ï¼ˆå†ï¼‰ä¸€æ¬¡ä¿®å¤äº† Nebula Graph çš„æ„å»ºä¾èµ–çš„ ARM æ”¯æŒé—®é¢˜ï¼ˆnebula-third-party#37ï¼‰ä¹‹åï¼Œæˆ‘ä»¬åˆå¯ä»¥æ„‰å¿«åœ°åœ¨ M1 Mac ä¸Šç©è¿™ä¸ªåˆ†å¸ƒå¼å¼€æºå›¾æ•°æ®åº“äº†ã€‚ è‹¦äºæ ‘è“æ´¾çš„ä»·æ ¼ï¼Œä¸€ç›´æ²¡æ‰¾æœºä¼šæŠŠ Nebula è·‘åœ¨å°æ¿å­ä¸Šç©ç©ã€‚è‡³äºä¸ºä»€ä¹ˆè¦è·‘åœ¨æ ‘è“æ´¾ä¸Šæˆ‘çš„å›ç­”å½“ç„¶æ˜¯ Because I can åœ¨éå¸¸éå¸¸è¾¹ç¼˜è®¡ç®—çš„åœºæ™¯ä¸‹ï¼ˆè¿™é‡ŒæŒ–ä¸ªå‘ï¼Œæˆ‘ä¸€å®šè¦æ‰¾ä¸€ä¸ªè¿™æ ·çš„åœºæ™¯åˆ†äº«å‡ºæ¥ï¼‰ã€‚ ç»ˆäºï¼Œä¸€å‘¨å¤šä¹‹å‰åœ¨ @laixintao å’Œ @andelf çš„ä¸€ä¸ªè®¨è®ºä¸‹æˆ‘å†³å®šæ‰¾ä¸€ä¸ªæ ‘è“æ´¾çš„ alternativeï¼Œæœ€åä¸‹å•äº† Rock Pi 3Aï¼Œåœ¨å› ä¸ºæ·±åœ³ç–«æƒ…å½±å“ä¸‹æ‹–åˆ°äº†è¿™ä¸ªç¤¼æ‹œæ‰ç»ˆäºå‘è´§äº†ï¼ å®ƒçœ‹èµ·æ¥çœŸçš„å¾ˆæ£’ï¼ ","date":"2022-03-23","objectID":"/nebula-graph-on-pi/:1:0","series":null,"tags":["Nebula Graph","ARM","Respberry Pi"],"title":"Nebula Graph on Pi","uri":"/nebula-graph-on-pi/#èƒŒæ™¯"},{"categories":["Nebula Graph"],"content":" 2 åœ¨ ARM64 æ¿å­ä¸Šè£… Nebula Graph å›¾æ•°æ®åº“ å®é™…ä¸Š Nebula Graph åœ¨ 3.0 ä¹‹åæä¾›äº†ä¸€ä¸ªå•æœºç‰ˆï¼Œè¿™ä½¿å¾— Nebula åœ¨è¾¹ç¼˜è®¡ç®—æƒ…å†µä¸‹æœ‰äº†æ›´å°çš„ footprintï¼Œä¸è¿‡è¿™æ¬¡æˆ‘è¿˜æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬ï¼Œä¸‹æ¬¡è¯•è¯•å†ç»™å¤§å®¶åˆ†äº«ã€‚ æˆ‘åœ¨é™„å½•åˆ—å‡ºäº†å®‰è£… Ubuntu Server çš„æ­¥éª¤ï¼Œè¿™é‡Œå‡è®¾å¤§å®¶å·²ç»åœ¨æ ‘è“æ´¾æˆ–è€…å…¶ä»–å•æ¿ ARM ç”µè„‘é‡Œæ‹‰èµ·æ¥äº† 64 ä½çš„ Linux Serverã€‚ ","date":"2022-03-23","objectID":"/nebula-graph-on-pi/:2:0","series":null,"tags":["Nebula Graph","ARM","Respberry Pi"],"title":"Nebula Graph on Pi","uri":"/nebula-graph-on-pi/#åœ¨-arm64-æ¿å­ä¸Šè£…-nebula-graph-å›¾æ•°æ®åº“"},{"categories":["Nebula Graph"],"content":" 2.1 ç¬¬ 0 æ­¥ï¼Œå®‰è£… Docker å’Œ Docker-Composeè¿™é‡Œï¼Œæˆ‘å‡è®¾æ˜¯ Debian/Ubuntuï¼Œå…¶ä»–åˆ†å‘ç‰ˆç›´æ¥å‚è€ƒè¿™é‡Œå°±å¥½ã€‚ sudo apt-get update sudo apt-get install \\ ca-certificates \\ curl \\ gnupg \\ lsb-release echo \\ \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \\ $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list \u003e /dev/null sudo apt-get update sudo apt-get install docker-ce docker-ce-cli containerd.io # follow https://docs.docker.com/engine/install/linux-postinstall/ sudo groupadd docker sudo usermod -aG docker $USER exit # login again newgrp docker å®‰è£…å¥½äº† Docker ä¹‹åï¼Œå®‰è£… Composeï¼Œå®ƒ Docker å®˜æ–¹çš„æ­¥éª¤æ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºå®ƒå…¶å®æ˜¯ä¸€ä¸ª Python çš„åŒ…ï¼Œæˆ‘ä»¬é€šè¿‡ PIP å»è£…å°±å¥½äº†ã€‚ sudo apt-get install -y python3 python3-pip sudo pip3 install docker-compose ","date":"2022-03-23","objectID":"/nebula-graph-on-pi/:2:1","series":null,"tags":["Nebula Graph","ARM","Respberry Pi"],"title":"Nebula Graph on Pi","uri":"/nebula-graph-on-pi/#ç¬¬-0-æ­¥å®‰è£…-docker-å’Œ-docker-compose"},{"categories":["Nebula Graph"],"content":" 2.2 ç¬¬ 1 æ­¥ï¼Œæ‹‰èµ· Nebula Graphé¦–å…ˆï¼Œæˆ‘ä»¬å…‹éš† Nebula Docker Compose è¿™ä¸ª Repoï¼Œåœ¨ Master Branchï¼Œç”¨ Compose æŠŠæœåŠ¡æ‹‰èµ·æ¥ã€‚ git clone https://github.com/vesoft-inc/nebula-docker-compose.git \u0026\u0026 cd nebula-docker-compose docker-compose up -d ç„¶åï¼Œæˆ‘ä»¬ä¸‹è½½ Consoleï¼Œè¿ä¸Š GraphD æœåŠ¡ã€‚ wget https://github.com/vesoft-inc/nebula-console/releases/download/v3.0.0/nebula-console-linux-arm64-v3.0.0 chmod +x nebula-console-linux-arm64-v3.0.0 ./nebula-console-linux-arm64-v3.0.0 -addr localhost -port 9669 -u root -p nebula å¹¶æ¿€æ´» Storage æœåŠ¡ã€‚ ADD HOSTS \"storaged0\":9779,\"storaged1\":9779,\"storaged2\":9779; SHOW HOSTS; ","date":"2022-03-23","objectID":"/nebula-graph-on-pi/:2:2","series":null,"tags":["Nebula Graph","ARM","Respberry Pi"],"title":"Nebula Graph on Pi","uri":"/nebula-graph-on-pi/#ç¬¬-1-æ­¥æ‹‰èµ·-nebula-graph"},{"categories":["Nebula Graph"],"content":" 2.3 ç¬¬ 2 æ­¥ï¼Œç©è½¬ Nebula Graph on Piè¿™æ—¶å€™ï¼Œé€è¿‡ SHOW HOSTS çœ‹åˆ°ä¸‰ä¸ª StorageD æœåŠ¡éƒ½æ˜¯ ONLINE ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç»™ Nebula é‡ŒåŠ è½½è¿›å»æµ‹è¯•æ•°æ®é›†ã€‚ $:play basketballplayer; å·®ä¸å¤šä¸€åˆ†é’Ÿä¹‹åï¼Œæ•°æ®åº“åŠ è½½æˆåŠŸï¼Œæˆ‘ä»¬è¿›å…¥è¿™ä¸ªå›¾ç©ºé—´ï¼Œç©ä¸€ä¸‹å§ï¼ USE basketballplayer; GO FROM \"player100\" OVER follow YIELD dst(edge); Check this out andâ€¦ Happy Graphing! ","date":"2022-03-23","objectID":"/nebula-graph-on-pi/:2:3","series":null,"tags":["Nebula Graph","ARM","Respberry Pi"],"title":"Nebula Graph on Pi","uri":"/nebula-graph-on-pi/#ç¬¬-2-æ­¥ç©è½¬-nebula-graph-on-pi"},{"categories":["Nebula Graph"],"content":" 3 é™„å½•ï¼šå®‰è£… Ubuntu Server åœ¨ Rock Pi 3A ä¸Š å‡†å¤‡ä¸€ä¸ª micro SD cardï¼Œåœ¨ https://wiki.radxa.com/Rock3/downloads ä¸‹è½½é•œåƒï¼Œè§£å‹ä¸º .img æ–‡ä»¶ æŠŠé•œåƒå†™è¿› SD cardï¼Œæ¯”å¦‚ç”¨ etcher æ’å…¥ç”µæºï¼ˆ5Vï¼Œ3Aï¼‰å¯åŠ¨ï¼ feature image credit: @_louisreed ","date":"2022-03-23","objectID":"/nebula-graph-on-pi/:3:0","series":null,"tags":["Nebula Graph","ARM","Respberry Pi"],"title":"Nebula Graph on Pi","uri":"/nebula-graph-on-pi/#é™„å½•å®‰è£…-ubuntu-server-åœ¨-rock-pi-3a-ä¸Š"},{"categories":["Nebula Graph"],"content":"æˆ‘å‘ç°ç”¨ Nebula Graph çš„å›¾æŸ¥è¯¢è§£ Antfu çš„æ±‰å…œç‰¹åˆ«æœ‰æ„æ€ï¼","date":"2022-02-28","objectID":"/resolve-wordle/","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/"},{"categories":["Nebula Graph"],"content":" æˆ‘å‘ç°ç”¨ Nebula Graph çš„å›¾æŸ¥è¯¢è§£ Antfu çš„æ±‰å…œï¼ˆæœ€å¥½çš„ä¸­æ–‡æˆè¯­ç‰ˆ wordle ğŸ‘‰ğŸ» handle.antfu.meï¼‰ç‰¹åˆ«æœ‰æ„æ€ï¼Œå¾ˆé€‚åˆæ¯å¤©å†™å›¾åº“è¯­å¥çš„ä½“æ“ç»ƒä¹ ï¼Œæœ¬æ–‡æ­ç¤ºå¦‚ä½•ç”¨çŸ¥è¯†å›¾è°±ä½œå¼Šè§£æ±‰å…œğŸ˜ ","date":"2022-02-28","objectID":"/resolve-wordle/:0:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#"},{"categories":["Nebula Graph"],"content":" 1 ä»€ä¹ˆæ˜¯æ±‰å…œï¼Ÿæ±‰å…œï¼ˆhttps://handle.antfu.meï¼‰æ˜¯ç”± Vue/Vite æ ¸å¿ƒå›¢é˜Ÿçš„ Antfu çš„åˆä¸€ä¸ªéå¸¸é…·çš„ä½œå“ï¼Œä¸€ä¸ªéå¸¸ç²¾è‡´çš„æ±‰å­—ç‰ˆçš„ Wordleï¼Œä»–æ˜¯æ˜¯ä¸€ä¸ªæ¯æ—¥æŒ‘æˆ˜çš„å¡«å­—æ¸¸æˆçš„ä¸­æ–‡æˆè¯­ç‰ˆã€‚ æ¯å¤©ï¼Œæ±‰å…œä¼šå‘èµ·ä¸€ä¸ªçŒœæˆè¯­æŒ‘æˆ˜ï¼Œäººä»¬è¦åœ¨åæ¬¡å†…æ‰å¯¹å®ƒæ‰èƒ½è·èƒœï¼Œæ¯ä¸€æ­¥ä¹‹åéƒ½ä¼šæ”¶åˆ°ç›¸åº”çš„æ–‡å­—ã€å£°æ¯ã€éŸµæ¯ã€å£°è°ƒçš„åŒ¹é…æƒ…å†µçš„æç¤ºï¼Œå…¶ä¸­ï¼šç»¿è‰²è¡¨ç¤ºè¿™ä¸ªå› ç´ å­˜åœ¨å¹¶ä¸”ä½ç½®åŒ¹é…ã€æ©˜è‰²è¡¨ç¤ºè¿™ä¸ªå…ƒç´ å­˜åœ¨ä½†æ˜¯ä½ç½®ä¸å¯¹ï¼Œè¯¦ç»†çš„è§„åˆ™å¯è§å¦‚ä¸‹çš„ç½‘é¡µæˆªå›¾ï¼š æ±‰å…œçš„ä¹è¶£å°±æˆ‘ä»¬åœ¨äºåœ¨æœ‰é™çš„å°è¯•è¿‡ç¨‹ä¸­ï¼Œåœ¨å¤§è„‘ä¸­æœå¯»å¯èƒ½çš„ç­”æ¡ˆï¼Œä¸æ–­å»é€¼è¿‘çœŸç†ï¼Œä»»ä½•è¯•å›¾ä½œå¼Šã€è®¨å·§å»æ³„æ¼ç»“æœçš„è¡Œä¸ºéƒ½æ˜¯å¾ˆæ— è¶£ã€å€’èƒƒå£çš„ï¼ˆæ¯”å¦‚ä»å¼€æºçš„æ±‰å…œä»£ç é‡Œçªƒå–ä¿¡æ¯ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±åƒåœ¨åšå¤§è„‘çš„ä½“æ“ã€‚ è¯´åˆ°å¤§è„‘çš„æˆè¯­è¯æ±‡é‡ä½“æ“ï¼Œæˆ‘çªç„¶æƒ³åˆ°ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½åœ¨å¤§è„‘ä¹‹å¤–é€ ä¸€ä¸ªæ±‰è¯­æˆè¯­çŸ¥è¯†å›¾è°±ï¼Œç„¶ååŸºäºè¿™ä¸ªå›¾è°±å»åšå›¾æ•°æ®åº“æŸ¥è¯¢è¯­æ³•ä½“æ“å‘¢ï¼Ÿ ","date":"2022-02-28","objectID":"/resolve-wordle/:1:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#ä»€ä¹ˆæ˜¯æ±‰å…œ"},{"categories":["Nebula Graph"],"content":" 2 æ„é€ è§£å†³æ±‰å…œçš„æˆè¯­çŸ¥è¯†å›¾è°±","date":"2022-02-28","objectID":"/resolve-wordle/:2:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#æ„é€ è§£å†³æ±‰å…œçš„æˆè¯­çŸ¥è¯†å›¾è°±"},{"categories":["Nebula Graph"],"content":" 2.1 ä»€ä¹ˆæ˜¯çŸ¥è¯†å›¾è°±ï¼Ÿç®€å•æ¥è¯´ï¼ŒçŸ¥è¯†å›¾è°±æ˜¯ä¸€ä¸ªè¿æ¥å®ä½“ä¹‹é—´å…³è”å…³ç³»çš„ç½‘ç»œï¼Œå®ƒæœ€åˆç”± Google æå‡ºå¹¶ç”¨æ¥æ»¡è¶³æœç´¢å¼•æ“ä¸­åŸºäºçŸ¥è¯†æ¨ç†æ‰å¯è·å¾—ï¼ˆè€Œä¸æ˜¯ç½‘é¡µå€’æ’ç´¢å¼•ï¼‰çš„æœç´¢é—®é¢˜ï¼Œæ¯”å¦‚ï¼šâ€å§šæ˜å¦»å­çš„å¹´é¾„ï¼Ÿâ€œã€â€ç«ç®­é˜Ÿå¾—è¿‡å‡ æ¬¡æ€»å† å†›ï¼Ÿâ€œ è¿™é‡Œè¾¹ï¼Œæˆ‘ä»¬å…³æ³¨çš„æ¡ä»¶ã€‚åˆ° 2022 å¹´çš„ç°åœ¨ï¼ŒçŸ¥è¯†å›¾è°±å·²ç»è¢«å¹¿æ³›åº”ç”¨åœ¨æ¨èç³»ç»Ÿã€é—®ç­”ç³»ç»Ÿã€å®‰å…¨é£æ§ç­‰ç­‰æ›´å¤šæœç´¢ä¹‹å¤–çš„é¢†åŸŸã€‚ ","date":"2022-02-28","objectID":"/resolve-wordle/:2:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#ä»€ä¹ˆæ˜¯çŸ¥è¯†å›¾è°±"},{"categories":["Nebula Graph"],"content":" 2.2 ä¸ºä»€ä¹ˆéœ€è¦ç”¨çŸ¥è¯†å›¾è°±è§£å†³æ±‰å…œï¼ŸåŸå› å°±æ˜¯ï¼šbecause I can å®é™…ä¸Šï¼Œæˆ‘ä»¬åœ¨å¤§è„‘ä¸­è§£å†³å­—è°œæ¸¸æˆçš„è¿‡ç¨‹åƒæäº†å›¾è°±ç½‘ç»œä¸­çš„ä¿¡æ¯æœå¯»çš„è¿‡ç¨‹ï¼Œæ±‰å…œçš„è§£è°œåé¦ˆæç¤ºæ¡ä»¶å¤©ç„¶é€‚åˆè¢«ç”¨å›¾è°±çš„è¯­ä¹‰æ¥è¿›è¡Œè¡¨è¾¾ã€‚åœ¨æœ¬æ–‡åè¾¹ï¼Œä½ ä»¬ä¼šå‘ç°è§£è°œæ¡ä»¶ç¿»è¯‘æˆå›¾è¯­ä¹‰æ˜¯éå¸¸éå¸¸è‡ªç„¶çš„ï¼Œè¿™ä¸ªé—®é¢˜å°±åƒæ˜¯ä¸€ä¸ªå¤©ç„¶çš„ä¸ºå›¾è°±è€Œå­˜åœ¨çš„ç»ƒä¹ ä¸€æ ·ï¼Œæˆ‘ç›¸ä¿¡è¿™å’ŒçŸ¥è¯†å›¾è°±çš„ç»“æ„å’Œäººè„‘ä¸­çš„çŸ¥è¯†ç»“æ„éå¸¸æ¥è¿‘æœ‰å¾ˆå¤§çš„å…³ç³»ã€‚ ","date":"2022-02-28","objectID":"/resolve-wordle/:2:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#ä¸ºä»€ä¹ˆéœ€è¦ç”¨çŸ¥è¯†å›¾è°±è§£å†³æ±‰å…œ"},{"categories":["Nebula Graph"],"content":" 2.3 å¦‚ä½•æ„å»ºé¢å‘æ±‰å…œè§£è°œçš„çŸ¥è¯†å›¾è°±ï¼ŸçŸ¥è¯†å›¾è°±æ˜¯ç”±å®ä½“ï¼ˆé¡¶ç‚¹ï¼‰å’Œå…³ç³»ï¼ˆè¾¹ï¼‰ç»„æˆçš„ï¼Œç”¨å›¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆGraph Database MSï¼‰å¯ä»¥å¾ˆæ–¹ä¾¿è¿›è¡ŒçŸ¥è¯†çš„å…¥åº“ã€æ›´æ”¹ã€æŸ¥è¯¢ã€ç”šè‡³å¯è§†åŒ–æ¢ç´¢ã€‚ åœ¨æœ¬æ–‡é‡Œï¼Œæˆ‘å°†åˆ©ç”¨å¼€æºçš„åˆ†å¸ƒå¼å›¾æ•°æ®åº“ Nebula Graph å¼€å®è·µè¿™ä¸ªè¿‡ç¨‹ï¼Œå…·ä½“å›¾è°±ç³»ç»Ÿçš„æ­å»ºæˆ‘éƒ½ä¼šæ”¾åœ¨æ–‡æœ«ã€‚ åœ¨æœ¬ç« ï¼Œæˆ‘ä»¬åªè®¨è®ºå›¾è°±çš„å»ºæ¨¡ï¼šå¦‚ä½•é¢å‘æ±‰å…œçš„è§£è°œå»è®¾è®¡â€œå®ä½“â€ä¸â€œå…³ç³»â€ã€‚ 2.3.1 å›¾å»ºæ¨¡ 2.3.1.1 æœ€åˆçš„æƒ³æ³•é¦–å…ˆï¼Œä¸€å®šå­˜åœ¨çš„å®ä½“æ˜¯ï¼š æˆè¯­ æ±‰å­— æˆè¯­-[åŒ…å«]-\u003eæ±‰å­—ï¼Œæ¯ä¸ªæ±‰å­—-[è¯»ä½œ]-\u003eè¯»éŸ³ã€‚ å…¶æ¬¡ï¼Œå› ä¸ºè§£è°œè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°äº†å£°æ¯ã€éŸµæ¯ä»¥åŠå£°è°ƒçš„æ¡ä»¶ï¼Œè€ƒè™‘åˆ°å›¾è°±æœ¬èº«çš„é‡çº§éå¸¸å°ï¼ˆåƒçº§åˆ«ï¼‰ï¼Œè€Œä¸”å­—çš„è¯»éŸ³æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œæˆ‘æŠŠè¯»éŸ³å’Œå£°æ¯ï¼ˆåŒ…æ¶µå£°æ¯-initialå’ŒéŸµæ¯-finalï¼‰ä¹Ÿä½œä¸ºå®ä½“ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»åˆ™æ˜¯é¡ºç†æˆç« äº†ï¼š 2.3.1.2 æœ€ç»ˆçš„ç‰ˆæœ¬ç„¶è€Œï¼Œæˆ‘åœ¨åè¾¹åŸºäºå›¾è°±è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™å‘ç°æœ€åˆçš„å»ºæ¨¡ä¼šä½¿å¾—(æˆè¯­)â€“\u003e(å­—)â€“\u003e(è¯»éŸ³)æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¸¢å¤±äº†è¿™ä¸ªå­—ç‰¹å®šçš„è¯»æ³•çš„æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘æœ€ç»ˆçš„å»ºæ¨¡æ˜¯ï¼š è¿™æ ·ï¼Œçº¯æ–‡å­—çš„æ¡ä»¶åªæ¶‰åŠäº†(æˆè¯­)--\u003e(å­—) è¿™ä¸€è·³ï¼Œè€Œè¯»éŸ³ã€å£°æ¯ã€å£°è°ƒçš„æ¡ä»¶åˆ™æ˜¯å¦ä¸€æ¡å…³ç³»è·¯å¾„ï¼Œæ—¢æ²¡æœ‰æœ€åˆç‰ˆæœ¬æ¡ä»¶çš„å†—ä½™ï¼Œåˆå¯ä»¥åœ¨ä¸€ä¸ªè·¯å¾„æ¨¡å¼åŒ¹é…é‡Œå¸¦ä¸Šä¸¤ç§æ¡ä»¶ï¼ˆåè¾¹çš„ä¾‹å­é‡Œä¼šæ¶‰åŠè¿™æ ·çš„è¡¨è¾¾ï¼‰ã€‚ 2.3.2 æ„å»ºæˆè¯­çŸ¥è¯†å›¾è°±æœ‰äº†å»ºæ¨¡ã€è¿™ä¹ˆç®€å•çš„å›¾è°±çš„æ„å»ºå°±å‰©ä¸‹äº†æ•°æ®çš„æ”¶é›†ã€æ¸…æ´—å’Œå…¥åº“ã€‚ å¯¹äºæ‰€æœ‰æˆè¯­æ•°æ®å’Œä»–ä»¬çš„è¯»éŸ³ï¼Œæˆ‘ä¸€æ–¹é¢ç›´æ¥æŠ½å–äº†æ±‰å…œä»£ç å†…éƒ¨çš„æ•°æ®ã€å¦ä¸€æ–¹é¢åˆ©ç”¨ PyPinyin è¿™ä¸ªå¼€æºçš„ Python åº“å°†æ±‰å…œæ•°æ®ä¸­æ²¡æœ‰è¯»éŸ³çš„æ•°æ®è·å¾—è¯»éŸ³ï¼ŒåŒæ—¶ï¼Œæˆ‘ä¹Ÿç”¨åˆ°äº† PyPinyin é‡Œçš„å¾ˆå¤šæ–¹ä¾¿çš„å‡½æ•°æ¯”å¦‚è·å–ä¸€ä¸ªæ‹¼éŸ³çš„å£°æ¯ã€éŸµæ¯ã€‚ æ„å»ºå·¥å…·çš„ä»£ç åœ¨è¿™é‡Œï¼šhttps://github.com/wey-gu/chinese-graph æ›´å¤šä¿¡æ¯æˆ‘ä¹Ÿæ”¾åœ¨æ–‡æœ«çš„é™„å½•ä¹‹ä¸­ã€‚ ","date":"2022-02-28","objectID":"/resolve-wordle/:2:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#å¦‚ä½•æ„å»ºé¢å‘æ±‰å…œè§£è°œçš„çŸ¥è¯†å›¾è°±"},{"categories":["Nebula Graph"],"content":" 2.3 å¦‚ä½•æ„å»ºé¢å‘æ±‰å…œè§£è°œçš„çŸ¥è¯†å›¾è°±ï¼ŸçŸ¥è¯†å›¾è°±æ˜¯ç”±å®ä½“ï¼ˆé¡¶ç‚¹ï¼‰å’Œå…³ç³»ï¼ˆè¾¹ï¼‰ç»„æˆçš„ï¼Œç”¨å›¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆGraph Database MSï¼‰å¯ä»¥å¾ˆæ–¹ä¾¿è¿›è¡ŒçŸ¥è¯†çš„å…¥åº“ã€æ›´æ”¹ã€æŸ¥è¯¢ã€ç”šè‡³å¯è§†åŒ–æ¢ç´¢ã€‚ åœ¨æœ¬æ–‡é‡Œï¼Œæˆ‘å°†åˆ©ç”¨å¼€æºçš„åˆ†å¸ƒå¼å›¾æ•°æ®åº“ Nebula Graph å¼€å®è·µè¿™ä¸ªè¿‡ç¨‹ï¼Œå…·ä½“å›¾è°±ç³»ç»Ÿçš„æ­å»ºæˆ‘éƒ½ä¼šæ”¾åœ¨æ–‡æœ«ã€‚ åœ¨æœ¬ç« ï¼Œæˆ‘ä»¬åªè®¨è®ºå›¾è°±çš„å»ºæ¨¡ï¼šå¦‚ä½•é¢å‘æ±‰å…œçš„è§£è°œå»è®¾è®¡â€œå®ä½“â€ä¸â€œå…³ç³»â€ã€‚ 2.3.1 å›¾å»ºæ¨¡ 2.3.1.1 æœ€åˆçš„æƒ³æ³•é¦–å…ˆï¼Œä¸€å®šå­˜åœ¨çš„å®ä½“æ˜¯ï¼š æˆè¯­ æ±‰å­— æˆè¯­-[åŒ…å«]-\u003eæ±‰å­—ï¼Œæ¯ä¸ªæ±‰å­—-[è¯»ä½œ]-\u003eè¯»éŸ³ã€‚ å…¶æ¬¡ï¼Œå› ä¸ºè§£è°œè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°äº†å£°æ¯ã€éŸµæ¯ä»¥åŠå£°è°ƒçš„æ¡ä»¶ï¼Œè€ƒè™‘åˆ°å›¾è°±æœ¬èº«çš„é‡çº§éå¸¸å°ï¼ˆåƒçº§åˆ«ï¼‰ï¼Œè€Œä¸”å­—çš„è¯»éŸ³æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œæˆ‘æŠŠè¯»éŸ³å’Œå£°æ¯ï¼ˆåŒ…æ¶µå£°æ¯-initialå’ŒéŸµæ¯-finalï¼‰ä¹Ÿä½œä¸ºå®ä½“ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»åˆ™æ˜¯é¡ºç†æˆç« äº†ï¼š 2.3.1.2 æœ€ç»ˆçš„ç‰ˆæœ¬ç„¶è€Œï¼Œæˆ‘åœ¨åè¾¹åŸºäºå›¾è°±è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™å‘ç°æœ€åˆçš„å»ºæ¨¡ä¼šä½¿å¾—(æˆè¯­)â€“\u003e(å­—)â€“\u003e(è¯»éŸ³)æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¸¢å¤±äº†è¿™ä¸ªå­—ç‰¹å®šçš„è¯»æ³•çš„æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘æœ€ç»ˆçš„å»ºæ¨¡æ˜¯ï¼š è¿™æ ·ï¼Œçº¯æ–‡å­—çš„æ¡ä»¶åªæ¶‰åŠäº†(æˆè¯­)--\u003e(å­—) è¿™ä¸€è·³ï¼Œè€Œè¯»éŸ³ã€å£°æ¯ã€å£°è°ƒçš„æ¡ä»¶åˆ™æ˜¯å¦ä¸€æ¡å…³ç³»è·¯å¾„ï¼Œæ—¢æ²¡æœ‰æœ€åˆç‰ˆæœ¬æ¡ä»¶çš„å†—ä½™ï¼Œåˆå¯ä»¥åœ¨ä¸€ä¸ªè·¯å¾„æ¨¡å¼åŒ¹é…é‡Œå¸¦ä¸Šä¸¤ç§æ¡ä»¶ï¼ˆåè¾¹çš„ä¾‹å­é‡Œä¼šæ¶‰åŠè¿™æ ·çš„è¡¨è¾¾ï¼‰ã€‚ 2.3.2 æ„å»ºæˆè¯­çŸ¥è¯†å›¾è°±æœ‰äº†å»ºæ¨¡ã€è¿™ä¹ˆç®€å•çš„å›¾è°±çš„æ„å»ºå°±å‰©ä¸‹äº†æ•°æ®çš„æ”¶é›†ã€æ¸…æ´—å’Œå…¥åº“ã€‚ å¯¹äºæ‰€æœ‰æˆè¯­æ•°æ®å’Œä»–ä»¬çš„è¯»éŸ³ï¼Œæˆ‘ä¸€æ–¹é¢ç›´æ¥æŠ½å–äº†æ±‰å…œä»£ç å†…éƒ¨çš„æ•°æ®ã€å¦ä¸€æ–¹é¢åˆ©ç”¨ PyPinyin è¿™ä¸ªå¼€æºçš„ Python åº“å°†æ±‰å…œæ•°æ®ä¸­æ²¡æœ‰è¯»éŸ³çš„æ•°æ®è·å¾—è¯»éŸ³ï¼ŒåŒæ—¶ï¼Œæˆ‘ä¹Ÿç”¨åˆ°äº† PyPinyin é‡Œçš„å¾ˆå¤šæ–¹ä¾¿çš„å‡½æ•°æ¯”å¦‚è·å–ä¸€ä¸ªæ‹¼éŸ³çš„å£°æ¯ã€éŸµæ¯ã€‚ æ„å»ºå·¥å…·çš„ä»£ç åœ¨è¿™é‡Œï¼šhttps://github.com/wey-gu/chinese-graph æ›´å¤šä¿¡æ¯æˆ‘ä¹Ÿæ”¾åœ¨æ–‡æœ«çš„é™„å½•ä¹‹ä¸­ã€‚ ","date":"2022-02-28","objectID":"/resolve-wordle/:2:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#å›¾å»ºæ¨¡"},{"categories":["Nebula Graph"],"content":" 2.3 å¦‚ä½•æ„å»ºé¢å‘æ±‰å…œè§£è°œçš„çŸ¥è¯†å›¾è°±ï¼ŸçŸ¥è¯†å›¾è°±æ˜¯ç”±å®ä½“ï¼ˆé¡¶ç‚¹ï¼‰å’Œå…³ç³»ï¼ˆè¾¹ï¼‰ç»„æˆçš„ï¼Œç”¨å›¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆGraph Database MSï¼‰å¯ä»¥å¾ˆæ–¹ä¾¿è¿›è¡ŒçŸ¥è¯†çš„å…¥åº“ã€æ›´æ”¹ã€æŸ¥è¯¢ã€ç”šè‡³å¯è§†åŒ–æ¢ç´¢ã€‚ åœ¨æœ¬æ–‡é‡Œï¼Œæˆ‘å°†åˆ©ç”¨å¼€æºçš„åˆ†å¸ƒå¼å›¾æ•°æ®åº“ Nebula Graph å¼€å®è·µè¿™ä¸ªè¿‡ç¨‹ï¼Œå…·ä½“å›¾è°±ç³»ç»Ÿçš„æ­å»ºæˆ‘éƒ½ä¼šæ”¾åœ¨æ–‡æœ«ã€‚ åœ¨æœ¬ç« ï¼Œæˆ‘ä»¬åªè®¨è®ºå›¾è°±çš„å»ºæ¨¡ï¼šå¦‚ä½•é¢å‘æ±‰å…œçš„è§£è°œå»è®¾è®¡â€œå®ä½“â€ä¸â€œå…³ç³»â€ã€‚ 2.3.1 å›¾å»ºæ¨¡ 2.3.1.1 æœ€åˆçš„æƒ³æ³•é¦–å…ˆï¼Œä¸€å®šå­˜åœ¨çš„å®ä½“æ˜¯ï¼š æˆè¯­ æ±‰å­— æˆè¯­-[åŒ…å«]-\u003eæ±‰å­—ï¼Œæ¯ä¸ªæ±‰å­—-[è¯»ä½œ]-\u003eè¯»éŸ³ã€‚ å…¶æ¬¡ï¼Œå› ä¸ºè§£è°œè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°äº†å£°æ¯ã€éŸµæ¯ä»¥åŠå£°è°ƒçš„æ¡ä»¶ï¼Œè€ƒè™‘åˆ°å›¾è°±æœ¬èº«çš„é‡çº§éå¸¸å°ï¼ˆåƒçº§åˆ«ï¼‰ï¼Œè€Œä¸”å­—çš„è¯»éŸ³æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œæˆ‘æŠŠè¯»éŸ³å’Œå£°æ¯ï¼ˆåŒ…æ¶µå£°æ¯-initialå’ŒéŸµæ¯-finalï¼‰ä¹Ÿä½œä¸ºå®ä½“ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»åˆ™æ˜¯é¡ºç†æˆç« äº†ï¼š 2.3.1.2 æœ€ç»ˆçš„ç‰ˆæœ¬ç„¶è€Œï¼Œæˆ‘åœ¨åè¾¹åŸºäºå›¾è°±è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™å‘ç°æœ€åˆçš„å»ºæ¨¡ä¼šä½¿å¾—(æˆè¯­)â€“\u003e(å­—)â€“\u003e(è¯»éŸ³)æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¸¢å¤±äº†è¿™ä¸ªå­—ç‰¹å®šçš„è¯»æ³•çš„æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘æœ€ç»ˆçš„å»ºæ¨¡æ˜¯ï¼š è¿™æ ·ï¼Œçº¯æ–‡å­—çš„æ¡ä»¶åªæ¶‰åŠäº†(æˆè¯­)--\u003e(å­—) è¿™ä¸€è·³ï¼Œè€Œè¯»éŸ³ã€å£°æ¯ã€å£°è°ƒçš„æ¡ä»¶åˆ™æ˜¯å¦ä¸€æ¡å…³ç³»è·¯å¾„ï¼Œæ—¢æ²¡æœ‰æœ€åˆç‰ˆæœ¬æ¡ä»¶çš„å†—ä½™ï¼Œåˆå¯ä»¥åœ¨ä¸€ä¸ªè·¯å¾„æ¨¡å¼åŒ¹é…é‡Œå¸¦ä¸Šä¸¤ç§æ¡ä»¶ï¼ˆåè¾¹çš„ä¾‹å­é‡Œä¼šæ¶‰åŠè¿™æ ·çš„è¡¨è¾¾ï¼‰ã€‚ 2.3.2 æ„å»ºæˆè¯­çŸ¥è¯†å›¾è°±æœ‰äº†å»ºæ¨¡ã€è¿™ä¹ˆç®€å•çš„å›¾è°±çš„æ„å»ºå°±å‰©ä¸‹äº†æ•°æ®çš„æ”¶é›†ã€æ¸…æ´—å’Œå…¥åº“ã€‚ å¯¹äºæ‰€æœ‰æˆè¯­æ•°æ®å’Œä»–ä»¬çš„è¯»éŸ³ï¼Œæˆ‘ä¸€æ–¹é¢ç›´æ¥æŠ½å–äº†æ±‰å…œä»£ç å†…éƒ¨çš„æ•°æ®ã€å¦ä¸€æ–¹é¢åˆ©ç”¨ PyPinyin è¿™ä¸ªå¼€æºçš„ Python åº“å°†æ±‰å…œæ•°æ®ä¸­æ²¡æœ‰è¯»éŸ³çš„æ•°æ®è·å¾—è¯»éŸ³ï¼ŒåŒæ—¶ï¼Œæˆ‘ä¹Ÿç”¨åˆ°äº† PyPinyin é‡Œçš„å¾ˆå¤šæ–¹ä¾¿çš„å‡½æ•°æ¯”å¦‚è·å–ä¸€ä¸ªæ‹¼éŸ³çš„å£°æ¯ã€éŸµæ¯ã€‚ æ„å»ºå·¥å…·çš„ä»£ç åœ¨è¿™é‡Œï¼šhttps://github.com/wey-gu/chinese-graph æ›´å¤šä¿¡æ¯æˆ‘ä¹Ÿæ”¾åœ¨æ–‡æœ«çš„é™„å½•ä¹‹ä¸­ã€‚ ","date":"2022-02-28","objectID":"/resolve-wordle/:2:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#æœ€åˆçš„æƒ³æ³•"},{"categories":["Nebula Graph"],"content":" 2.3 å¦‚ä½•æ„å»ºé¢å‘æ±‰å…œè§£è°œçš„çŸ¥è¯†å›¾è°±ï¼ŸçŸ¥è¯†å›¾è°±æ˜¯ç”±å®ä½“ï¼ˆé¡¶ç‚¹ï¼‰å’Œå…³ç³»ï¼ˆè¾¹ï¼‰ç»„æˆçš„ï¼Œç”¨å›¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆGraph Database MSï¼‰å¯ä»¥å¾ˆæ–¹ä¾¿è¿›è¡ŒçŸ¥è¯†çš„å…¥åº“ã€æ›´æ”¹ã€æŸ¥è¯¢ã€ç”šè‡³å¯è§†åŒ–æ¢ç´¢ã€‚ åœ¨æœ¬æ–‡é‡Œï¼Œæˆ‘å°†åˆ©ç”¨å¼€æºçš„åˆ†å¸ƒå¼å›¾æ•°æ®åº“ Nebula Graph å¼€å®è·µè¿™ä¸ªè¿‡ç¨‹ï¼Œå…·ä½“å›¾è°±ç³»ç»Ÿçš„æ­å»ºæˆ‘éƒ½ä¼šæ”¾åœ¨æ–‡æœ«ã€‚ åœ¨æœ¬ç« ï¼Œæˆ‘ä»¬åªè®¨è®ºå›¾è°±çš„å»ºæ¨¡ï¼šå¦‚ä½•é¢å‘æ±‰å…œçš„è§£è°œå»è®¾è®¡â€œå®ä½“â€ä¸â€œå…³ç³»â€ã€‚ 2.3.1 å›¾å»ºæ¨¡ 2.3.1.1 æœ€åˆçš„æƒ³æ³•é¦–å…ˆï¼Œä¸€å®šå­˜åœ¨çš„å®ä½“æ˜¯ï¼š æˆè¯­ æ±‰å­— æˆè¯­-[åŒ…å«]-\u003eæ±‰å­—ï¼Œæ¯ä¸ªæ±‰å­—-[è¯»ä½œ]-\u003eè¯»éŸ³ã€‚ å…¶æ¬¡ï¼Œå› ä¸ºè§£è°œè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°äº†å£°æ¯ã€éŸµæ¯ä»¥åŠå£°è°ƒçš„æ¡ä»¶ï¼Œè€ƒè™‘åˆ°å›¾è°±æœ¬èº«çš„é‡çº§éå¸¸å°ï¼ˆåƒçº§åˆ«ï¼‰ï¼Œè€Œä¸”å­—çš„è¯»éŸ³æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œæˆ‘æŠŠè¯»éŸ³å’Œå£°æ¯ï¼ˆåŒ…æ¶µå£°æ¯-initialå’ŒéŸµæ¯-finalï¼‰ä¹Ÿä½œä¸ºå®ä½“ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»åˆ™æ˜¯é¡ºç†æˆç« äº†ï¼š 2.3.1.2 æœ€ç»ˆçš„ç‰ˆæœ¬ç„¶è€Œï¼Œæˆ‘åœ¨åè¾¹åŸºäºå›¾è°±è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™å‘ç°æœ€åˆçš„å»ºæ¨¡ä¼šä½¿å¾—(æˆè¯­)â€“\u003e(å­—)â€“\u003e(è¯»éŸ³)æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¸¢å¤±äº†è¿™ä¸ªå­—ç‰¹å®šçš„è¯»æ³•çš„æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘æœ€ç»ˆçš„å»ºæ¨¡æ˜¯ï¼š è¿™æ ·ï¼Œçº¯æ–‡å­—çš„æ¡ä»¶åªæ¶‰åŠäº†(æˆè¯­)--\u003e(å­—) è¿™ä¸€è·³ï¼Œè€Œè¯»éŸ³ã€å£°æ¯ã€å£°è°ƒçš„æ¡ä»¶åˆ™æ˜¯å¦ä¸€æ¡å…³ç³»è·¯å¾„ï¼Œæ—¢æ²¡æœ‰æœ€åˆç‰ˆæœ¬æ¡ä»¶çš„å†—ä½™ï¼Œåˆå¯ä»¥åœ¨ä¸€ä¸ªè·¯å¾„æ¨¡å¼åŒ¹é…é‡Œå¸¦ä¸Šä¸¤ç§æ¡ä»¶ï¼ˆåè¾¹çš„ä¾‹å­é‡Œä¼šæ¶‰åŠè¿™æ ·çš„è¡¨è¾¾ï¼‰ã€‚ 2.3.2 æ„å»ºæˆè¯­çŸ¥è¯†å›¾è°±æœ‰äº†å»ºæ¨¡ã€è¿™ä¹ˆç®€å•çš„å›¾è°±çš„æ„å»ºå°±å‰©ä¸‹äº†æ•°æ®çš„æ”¶é›†ã€æ¸…æ´—å’Œå…¥åº“ã€‚ å¯¹äºæ‰€æœ‰æˆè¯­æ•°æ®å’Œä»–ä»¬çš„è¯»éŸ³ï¼Œæˆ‘ä¸€æ–¹é¢ç›´æ¥æŠ½å–äº†æ±‰å…œä»£ç å†…éƒ¨çš„æ•°æ®ã€å¦ä¸€æ–¹é¢åˆ©ç”¨ PyPinyin è¿™ä¸ªå¼€æºçš„ Python åº“å°†æ±‰å…œæ•°æ®ä¸­æ²¡æœ‰è¯»éŸ³çš„æ•°æ®è·å¾—è¯»éŸ³ï¼ŒåŒæ—¶ï¼Œæˆ‘ä¹Ÿç”¨åˆ°äº† PyPinyin é‡Œçš„å¾ˆå¤šæ–¹ä¾¿çš„å‡½æ•°æ¯”å¦‚è·å–ä¸€ä¸ªæ‹¼éŸ³çš„å£°æ¯ã€éŸµæ¯ã€‚ æ„å»ºå·¥å…·çš„ä»£ç åœ¨è¿™é‡Œï¼šhttps://github.com/wey-gu/chinese-graph æ›´å¤šä¿¡æ¯æˆ‘ä¹Ÿæ”¾åœ¨æ–‡æœ«çš„é™„å½•ä¹‹ä¸­ã€‚ ","date":"2022-02-28","objectID":"/resolve-wordle/:2:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#æœ€ç»ˆçš„ç‰ˆæœ¬"},{"categories":["Nebula Graph"],"content":" 2.3 å¦‚ä½•æ„å»ºé¢å‘æ±‰å…œè§£è°œçš„çŸ¥è¯†å›¾è°±ï¼ŸçŸ¥è¯†å›¾è°±æ˜¯ç”±å®ä½“ï¼ˆé¡¶ç‚¹ï¼‰å’Œå…³ç³»ï¼ˆè¾¹ï¼‰ç»„æˆçš„ï¼Œç”¨å›¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆGraph Database MSï¼‰å¯ä»¥å¾ˆæ–¹ä¾¿è¿›è¡ŒçŸ¥è¯†çš„å…¥åº“ã€æ›´æ”¹ã€æŸ¥è¯¢ã€ç”šè‡³å¯è§†åŒ–æ¢ç´¢ã€‚ åœ¨æœ¬æ–‡é‡Œï¼Œæˆ‘å°†åˆ©ç”¨å¼€æºçš„åˆ†å¸ƒå¼å›¾æ•°æ®åº“ Nebula Graph å¼€å®è·µè¿™ä¸ªè¿‡ç¨‹ï¼Œå…·ä½“å›¾è°±ç³»ç»Ÿçš„æ­å»ºæˆ‘éƒ½ä¼šæ”¾åœ¨æ–‡æœ«ã€‚ åœ¨æœ¬ç« ï¼Œæˆ‘ä»¬åªè®¨è®ºå›¾è°±çš„å»ºæ¨¡ï¼šå¦‚ä½•é¢å‘æ±‰å…œçš„è§£è°œå»è®¾è®¡â€œå®ä½“â€ä¸â€œå…³ç³»â€ã€‚ 2.3.1 å›¾å»ºæ¨¡ 2.3.1.1 æœ€åˆçš„æƒ³æ³•é¦–å…ˆï¼Œä¸€å®šå­˜åœ¨çš„å®ä½“æ˜¯ï¼š æˆè¯­ æ±‰å­— æˆè¯­-[åŒ…å«]-\u003eæ±‰å­—ï¼Œæ¯ä¸ªæ±‰å­—-[è¯»ä½œ]-\u003eè¯»éŸ³ã€‚ å…¶æ¬¡ï¼Œå› ä¸ºè§£è°œè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°äº†å£°æ¯ã€éŸµæ¯ä»¥åŠå£°è°ƒçš„æ¡ä»¶ï¼Œè€ƒè™‘åˆ°å›¾è°±æœ¬èº«çš„é‡çº§éå¸¸å°ï¼ˆåƒçº§åˆ«ï¼‰ï¼Œè€Œä¸”å­—çš„è¯»éŸ³æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œæˆ‘æŠŠè¯»éŸ³å’Œå£°æ¯ï¼ˆåŒ…æ¶µå£°æ¯-initialå’ŒéŸµæ¯-finalï¼‰ä¹Ÿä½œä¸ºå®ä½“ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»åˆ™æ˜¯é¡ºç†æˆç« äº†ï¼š 2.3.1.2 æœ€ç»ˆçš„ç‰ˆæœ¬ç„¶è€Œï¼Œæˆ‘åœ¨åè¾¹åŸºäºå›¾è°±è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™å‘ç°æœ€åˆçš„å»ºæ¨¡ä¼šä½¿å¾—(æˆè¯­)â€“\u003e(å­—)â€“\u003e(è¯»éŸ³)æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¸¢å¤±äº†è¿™ä¸ªå­—ç‰¹å®šçš„è¯»æ³•çš„æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘æœ€ç»ˆçš„å»ºæ¨¡æ˜¯ï¼š è¿™æ ·ï¼Œçº¯æ–‡å­—çš„æ¡ä»¶åªæ¶‰åŠäº†(æˆè¯­)--\u003e(å­—) è¿™ä¸€è·³ï¼Œè€Œè¯»éŸ³ã€å£°æ¯ã€å£°è°ƒçš„æ¡ä»¶åˆ™æ˜¯å¦ä¸€æ¡å…³ç³»è·¯å¾„ï¼Œæ—¢æ²¡æœ‰æœ€åˆç‰ˆæœ¬æ¡ä»¶çš„å†—ä½™ï¼Œåˆå¯ä»¥åœ¨ä¸€ä¸ªè·¯å¾„æ¨¡å¼åŒ¹é…é‡Œå¸¦ä¸Šä¸¤ç§æ¡ä»¶ï¼ˆåè¾¹çš„ä¾‹å­é‡Œä¼šæ¶‰åŠè¿™æ ·çš„è¡¨è¾¾ï¼‰ã€‚ 2.3.2 æ„å»ºæˆè¯­çŸ¥è¯†å›¾è°±æœ‰äº†å»ºæ¨¡ã€è¿™ä¹ˆç®€å•çš„å›¾è°±çš„æ„å»ºå°±å‰©ä¸‹äº†æ•°æ®çš„æ”¶é›†ã€æ¸…æ´—å’Œå…¥åº“ã€‚ å¯¹äºæ‰€æœ‰æˆè¯­æ•°æ®å’Œä»–ä»¬çš„è¯»éŸ³ï¼Œæˆ‘ä¸€æ–¹é¢ç›´æ¥æŠ½å–äº†æ±‰å…œä»£ç å†…éƒ¨çš„æ•°æ®ã€å¦ä¸€æ–¹é¢åˆ©ç”¨ PyPinyin è¿™ä¸ªå¼€æºçš„ Python åº“å°†æ±‰å…œæ•°æ®ä¸­æ²¡æœ‰è¯»éŸ³çš„æ•°æ®è·å¾—è¯»éŸ³ï¼ŒåŒæ—¶ï¼Œæˆ‘ä¹Ÿç”¨åˆ°äº† PyPinyin é‡Œçš„å¾ˆå¤šæ–¹ä¾¿çš„å‡½æ•°æ¯”å¦‚è·å–ä¸€ä¸ªæ‹¼éŸ³çš„å£°æ¯ã€éŸµæ¯ã€‚ æ„å»ºå·¥å…·çš„ä»£ç åœ¨è¿™é‡Œï¼šhttps://github.com/wey-gu/chinese-graph æ›´å¤šä¿¡æ¯æˆ‘ä¹Ÿæ”¾åœ¨æ–‡æœ«çš„é™„å½•ä¹‹ä¸­ã€‚ ","date":"2022-02-28","objectID":"/resolve-wordle/:2:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#æ„å»ºæˆè¯­çŸ¥è¯†å›¾è°±"},{"categories":["Nebula Graph"],"content":" 3 å¼€å§‹çŸ¥è¯†å›¾è°±æŸ¥è¯¢ä½“æ“è‡³æ­¤ï¼Œæˆ‘å‡è®¾å’±ä»¬éƒ½å·²ç»æœ‰äº†æˆ‘å¸®å¤§å®¶æ­å»ºçš„æˆè¯­ä½œå¼ŠçŸ¥è¯†å›¾è°±äº†ï¼Œå¼€å§‹æˆ‘ä»¬çš„å›¾è°±æŸ¥è¯¢ä½“æ“å§ï¼ é¦–å…ˆï¼Œæ‰“å¼€æ±‰å…œ ğŸ‘‰ğŸ» https://handle.antfu.me/ å‡è®¾æˆ‘ä»¬æƒ³ä»ä¸€ä¸ªæˆè¯­å¼€å§‹ï¼Œå¦‚æœä½ æ²¡æœ‰æƒ³æ³•çš„è¯å¯ä»¥è¯•è¯•è¿™ä¸ªï¼š // åŒ¹é…æˆè¯­ä¸­çš„ä¸€ä¸ªç»“æœ MATCH (x:`idiom`) RETURN x LIMIT 1 // è¿”å›ç»“æœ // (\"çˆ±æ†åˆ†æ˜\" :idiom{pinyin: \"['ai4', 'zeng1', 'fen1', 'ming2']\"}) ç„¶åæˆ‘ä»¬æŠŠå®ƒå¡«åˆ°æ±‰å…œä¹‹ä¸­ï¼Œè·å¾—ç¬¬ä¸€æ¬¡å°è¯•çš„æç¤ºæ¡ä»¶ï¼š æˆ‘ä»¬è¿æ°”ä¸é”™ï¼Œå¾—åˆ°äº†ä¸‰ä¸ªä½ç½®ä¸Šçš„æ¡ä»¶ï¼ æœ‰ä¸€ä¸ªéç¬¬ä¸€ä¸ªä½ç½®çš„å­—ï¼Œæ‹¼éŸ³æ˜¯ 4 å£°ï¼ŒéŸµæ¯æ˜¯ aiï¼Œä½†ä¸æ˜¯çˆ±ï¼ˆçˆ±ï¼‰ æœ‰ä¸€ä¸ªä¸€å£°çš„å­—ï¼Œä¸åœ¨ç¬¬äºŒä¸ªä½ç½®ï¼ˆæ†ï¼‰ æœ‰ä¸€ä¸ªå­—éŸµæ¯æ˜¯ ingï¼Œä¸åœ¨ç¬¬å››ä¸ªä½ç½®ï¼ˆæ˜ï¼‰ ç¬¬å››ä¸ªå­—æ˜¯äºŒå£°ï¼ˆæ˜ï¼‰ ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹å›¾æ•°æ®åº“è¯­å¥ä½“æ“ï¼ // æœ‰ä¸€ä¸ªéç¬¬ä¸€ä¸ªä½ç½®çš„å­—ï¼Œæ‹¼éŸ³æ˜¯ 4 å£°ï¼ŒéŸµæ¯æ˜¯ aiï¼Œä½†ä¸æ˜¯çˆ± MATCH (char0:`character`)\u003c-[with_char_0:`with_character`]-(x:`idiom`)-[with_pinyin_0:`with_pinyin`]-\u003e(pinyin_0:`character_pinyin`)-[:`with_pinyin_part`]-\u003e(`final_part_0`:`pinyin_part`{part_type: \"final\"}) WHERE id(`final_part_0`) == \"ai\" AND pinyin_0.`character_pinyin`.tone == 4 AND with_pinyin_0.`position` != 0 AND with_char_0.`position` != 0 AND id(char0) != \"çˆ±\" // æœ‰ä¸€ä¸ªä¸€å£°çš„å­—ï¼Œä¸åœ¨ç¬¬äºŒä¸ªä½ç½® MATCH (x:`idiom`) -[with_pinyin_1:`with_pinyin`]-\u003e(pinyin_1:`character_pinyin`) WHERE pinyin_1.`character_pinyin`.tone == 1 AND with_pinyin_1.`position` != 1 // æœ‰ä¸€ä¸ªå­—éŸµæ¯æ˜¯ ingï¼Œä¸åœ¨ç¬¬å››ä¸ªä½ç½® MATCH (x:`idiom`) -[with_pinyin_2:`with_pinyin`]-\u003e(:`character_pinyin`)-[:`with_pinyin_part`]-\u003e(final_part_2:`pinyin_part`{part_type: \"final\"}) WHERE id(final_part_2) == \"ing\" AND with_pinyin_2.`position` != 3 // ç¬¬å››ä¸ªå­—æ˜¯äºŒå£° MATCH (x:`idiom`) -[with_pinyin_3:`with_pinyin`]-\u003e(pinyin_3:`character_pinyin`) WHERE pinyin_3.`character_pinyin`.tone == 2 AND with_pinyin_3.`position` == 3 RETURN x, count(x) as c ORDER BY c DESC åœ¨å›¾æ•°æ®åº“ä¹‹ä¸­è¿è¡Œï¼Œå¾—åˆ°äº† 7 ä¸ªç­”æ¡ˆï¼š (\"æƒŠæ„šéª‡ä¿—\" :idiom{pinyin: \"['jing1', 'yu2', 'hai4', 'su2']\"}) (\"æƒŠä¸–éª‡ä¿—\" :idiom{pinyin: \"['jing1', 'shi4', 'hai4', 'su2']\"}) (\"æƒŠè§éª‡é—»\" :idiom{pinyin: \"['jing1', 'jian4', 'hai4', 'wen2']\"}) (\"æ²½åå–ç›´\" :idiom{pinyin: \"['gu1', 'ming2', 'mai4', 'zhi2']\"}) (\"æƒŠå¿ƒéª‡ç¥\" :idiom{pinyin: \"['jing1', 'xin1', 'hai4', 'shen2']\"}) (\"è†æ£˜è½½é€”\" :idiom{pinyin: \"['jing1', 'ji2', 'zai4', 'tu2']\"}) (\"å‡ºå–çµé­‚\" :idiom{pinyin: \"['chu1', 'mai4', 'ling2', 'hun2']\"}) çœ‹èµ·æ¥ æƒŠä¸–éª‡ä¿— æ¯”è¾ƒä¸»æµï¼Œè¯•è¯•ï¼ æˆ‘ä»¬å¾ˆå¹¸è¿ï¼Œå€ŸåŠ©äºæˆè¯­ä½œå¼ŠçŸ¥è¯†å›¾è°±ï¼Œå±…ç„¶ä¸€æ¬¡å°±æ‰¾åˆ°äº†ç­”æ¡ˆï¼Œå½“ç„¶è¿™å®é™…ä¸Šå¾—ç›Šäºç¬¬ä¸€æ¬¡éšæœºé€‰å–çš„è¯å¸¦æ¥çš„é™åˆ¶æ¡ä»¶çš„ä¸ªæ•°ï¼Œä¸è¿‡åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸¤æ¬¡å°è¯•è·å¾—æœ€ç»ˆç­”æ¡ˆçš„å¯èƒ½æ€§è¿˜æ˜¯éå¸¸å¤§çš„ï¼ æ³¨ï¼Œè¿™ä¸­é—´å¾ˆé•¿çš„253åˆ†é’Ÿæ˜¯å› ä¸ºæˆ‘åœ¨æŸ¥è¯¢ä¸­å‘ç°ä¹‹å‰ä»£ç é‡Œæ„é€ çš„å›¾è°±æœ‰ç‚¹ bugï¼Œæ˜¯â€œæŠ«æ·å¸¦é”â€è¿™ä¸ªè¯å¼•èµ·çš„è¯»éŸ³å›¾è°±çš„é”™è¯¯æ•°æ®ï¼Œè¿˜å¥½åæ¥è¢«ä¿®å¤äº†ã€‚ å¤§å®¶çŸ¥é“â€œæŠ«æ·å¸¦é”â€çš„æ­£ç¡®è¯»éŸ³ä¹ˆï¼ŸğŸ˜­ æ¥ä¸‹æ¥ï¼Œæˆ‘ç»™å¤§å®¶è¯¦ç»†è§£é‡Šä¸€ä¸‹è¿™ä¸ªè¯­å¥çš„æ„æ€ã€‚ ","date":"2022-02-28","objectID":"/resolve-wordle/:3:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#å¼€å§‹çŸ¥è¯†å›¾è°±æŸ¥è¯¢ä½“æ“"},{"categories":["Nebula Graph"],"content":" 3.1 è¯­å¥çš„å«ä¹‰æˆ‘ä»¬ä»ç¬¬ä¸€ä¸ªå­—çš„æ¡ä»¶å¼€å§‹ï¼Œè¿™æ˜¯ä¸€ä¸ªæ—¢æœ‰å£°éŸ³ã€åˆæœ‰å­—å½¢ä¿¡æ¯çš„æ¡ä»¶ã€‚ å£°éŸ³ä¿¡æ¯ï¼šå­˜åœ¨ä¸€ä¸ªéŸµæ¯ä¸º ai4 çš„å‘éŸ³ï¼Œä½ç½®ä¸åœ¨ç¬¬ä¸€ä¸ªå­— æ–‡å­—ä¿¡æ¯ï¼šè¿™ä¸ªéŸµæ¯ä¸º ai4 çš„å­—ï¼Œä¸æ˜¯çˆ±å­— å¯¹äºå£°éŸ³ä¿¡æ¯æ¡ä»¶ï¼Œè½¬æ¢ä¸ºå›¾æ¨¡å¼åŒ¹é…ä¸ºï¼š(æˆè¯­)-ä¸€ä¸ªå­—å‘éŸ³-(æ‹¼éŸ³) -åŒ…å«å£°æ¯-(éŸµæ¯) WHERE æ‹¼éŸ³éŸµæ¯ä¸º ai4 AND ä½ç½®ä¸æ˜¯ç¬¬ä¸€ä¸ªã€‚ å› ä¸ºå»ºæ¨¡çš„æ—¶å€™ï¼Œå±æ€§åç§°æˆ‘ç”¨çš„æ˜¯è‹±æ–‡ï¼ˆå…¶å®ä¸­æ–‡ä¹Ÿæ˜¯æ”¯æŒçš„ï¼‰ï¼Œå®é™…ä¸Šçš„è¯­å¥ä¸ºï¼š // æœ‰ä¸€ä¸ªéç¬¬ä¸€ä¸ªä½ç½®çš„å­—ï¼Œæ‹¼éŸ³æ˜¯ 4 å£°ï¼ŒéŸµæ¯æ˜¯ ai MATCH (x:idiom)-[with_pinyin_0:with_pinyin]-\u003e(pinyin_0:`character_pinyin`)-[:`with_pinyin_part`]-\u003e(`final_part_0`:`pinyin_part`{part_type: \"final\"}) WHERE id(`final_part_0`) == \"ai\" AND pinyin_0.`character_pinyin`.tone == 4 AND with_pinyin_0.`position` != 0 // ... RETURN x ç±»ä¼¼çš„ï¼Œè¡¨ç¤ºéç¬¬ä¸€ä¸ªä½ç½®çš„å­—ï¼Œä¸æ˜¯çˆ± çš„è¡¨è¾¾æ˜¯ï¼š // æœ‰ä¸€ä¸ªéç¬¬ä¸€ä¸ªä½ç½®çš„å­—ï¼Œæ‹¼éŸ³æ˜¯ 4 å£°ï¼ŒéŸµæ¯æ˜¯ aiï¼Œä½†ä¸æ˜¯çˆ± MATCH (char0:`character`)\u003c-[with_char_0:`with_character`]-(x:`idiom`) WHERE with_char_0.`position` != 0 AND id(char0) != \"çˆ±\" // ... RETURN x, count(x) as c ORDER BY c DESC è€Œå› ä¸ºè¿™ä¸¤ä¸ªæ¡ä»¶æœ€ç»ˆæè¿°çš„æ˜¯åŒä¸€ä¸ªå­—ï¼Œæ‰€ä»¥å®ƒä»¬æ˜¯å¯ä»¥è¢«å†™åœ¨ä¸€ä¸ªè·¯å¾„ä¸‹çš„ï¼š // æœ‰ä¸€ä¸ªéç¬¬ä¸€ä¸ªä½ç½®çš„å­—ï¼Œæ‹¼éŸ³æ˜¯ 4 å£°ï¼ŒéŸµæ¯æ˜¯ aiï¼Œä½†ä¸æ˜¯çˆ± MATCH (char0:`character`)\u003c-[with_char_0:`with_character`]-(x:`idiom`)-[with_pinyin_0:`with_pinyin`]-\u003e(pinyin_0:`character_pinyin`)-[:`with_pinyin_part`]-\u003e(`final_part_0`:`pinyin_part`{part_type: \"final\"}) WHERE id(`final_part_0`) == \"ai\" AND pinyin_0.`character_pinyin`.tone == 4 AND with_pinyin_0.`position` != 0 AND with_char_0.`position` != 0 AND id(char0) != \"çˆ±\" // ... RETURN x æ›´å¤šçš„ MATCH è¯­æ³•å’Œä¾‹å­ç»†èŠ‚ï¼Œè¯·å¤§å®¶å‚è€ƒæ–‡æ¡£ï¼š MATCH https://docs.nebula-graph.com.cn/3.0.0/3.ngql-guide/7.general-query-statements/2.match/ å›¾æ¨¡å¼ https://docs.nebula-graph.com.cn/3.0.0/3.ngql-guide/1.nGQL-overview/3.graph-patterns/ nGQL å‘½ä»¤ cheatsheet https://docs.nebula-graph.com.cn/3.0.0/2.quick-start/6.cheatsheet-for-ngql-command/ ","date":"2022-02-28","objectID":"/resolve-wordle/:3:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#è¯­å¥çš„å«ä¹‰"},{"categories":["Nebula Graph"],"content":" 4 å¯è§†åŒ–å±•ç¤ºçº¿ç´¢æˆ‘ä»¬æŠŠæ¯ä¸€ä¸ªæ¡ä»¶çš„åŒ¹é…è·¯å¾„ä½œä¸ºè¾“å‡ºï¼Œåˆ©ç”¨ Nebula Graph çš„å¯è§†åŒ–èƒ½åŠ›ï¼Œå¯ä»¥å¾—åˆ°ï¼š // æœ‰ä¸€ä¸ªéç¬¬ä¸€ä¸ªä½ç½®çš„å­—ï¼Œæ‹¼éŸ³æ˜¯ 4 å£°ï¼ŒéŸµæ¯æ˜¯ aiï¼Œä½†ä¸æ˜¯çˆ± MATCH p0=(char0:`character`)\u003c-[with_char_0:`with_character`]-(x:`idiom`)-[with_pinyin_0:`with_pinyin`]-\u003e(pinyin_0:`character_pinyin`)-[:`with_pinyin_part`]-\u003e(`final_part_0`:`pinyin_part`{part_type: \"final\"}) WHERE id(`final_part_0`) == \"ai\" AND pinyin_0.`character_pinyin`.tone == 4 AND with_pinyin_0.`position` != 0 AND with_char_0.`position` != 0 AND id(char0) != \"çˆ±\" // æœ‰ä¸€ä¸ªä¸€å£°çš„å­—ï¼Œä¸åœ¨ç¬¬äºŒä¸ªä½ç½® MATCH p1=(x:`idiom`) -[with_pinyin_1:`with_pinyin`]-\u003e(pinyin_1:`character_pinyin`) WHERE pinyin_1.`character_pinyin`.tone == 1 AND with_pinyin_1.`position` != 1 // æœ‰ä¸€ä¸ªå­—éŸµæ¯æ˜¯ ingï¼Œä¸åœ¨ç¬¬å››ä¸ªä½ç½® MATCH p2=(x:`idiom`) -[with_pinyin_2:`with_pinyin`]-\u003e(:`character_pinyin`)-[:`with_pinyin_part`]-\u003e(final_part_2:`pinyin_part`{part_type: \"final\"}) WHERE id(final_part_2) == \"ing\" AND with_pinyin_2.`position` != 3 // ç¬¬å››ä¸ªå­—æ˜¯äºŒå£° MATCH p3=(x:`idiom`) -[with_pinyin_3:`with_pinyin`]-\u003e(pinyin_3:`character_pinyin`) WHERE pinyin_3.`character_pinyin`.tone == 2 AND with_pinyin_3.`position` == 3 RETURN p0,p1,p2,p3 åœ¨å¯è§†åŒ–å·¥å…·çš„ Console æ§åˆ¶å°é‡Œæ‰§è¡Œä¸Šè¾¹çš„è¯­å¥ä¹‹åï¼Œé€‰æ‹©å¯¼å…¥å›¾æ¢ç´¢ï¼Œå°±å¯ä»¥çœ‹åˆ° ","date":"2022-02-28","objectID":"/resolve-wordle/:4:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#å¯è§†åŒ–å±•ç¤ºçº¿ç´¢"},{"categories":["Nebula Graph"],"content":" 5 ä¸‹ä¸€æ­¥å¦‚æœå¤§å®¶æ˜¯ä»æœ¬æ–‡ç¬¬ä¸€æ¬¡äº†è§£åˆ° Nebula Graph å›¾æ•°æ®åº“ï¼Œé‚£ä¹ˆå¤§å®¶å¯ä»¥ä¸‹ä¸€æ­¥ä» Nebula Graph é¡¹ç›®å’Œ Nebula Graph ç¤¾åŒºçš„å®˜æ–¹ Bilibili ç«™ç‚¹ ğŸ‘‰ğŸ» https://space.bilibili.com/472621355 äº†è§£æ›´å¤šæœ‰æ„æ€çš„å…¥é—¨çŸ¥è¯†ã€‚ å¦å¤–ï¼Œè¿™é‡Œæ˜¯ Nebula Graph çš„å®˜æ–¹çº¿ä¸Šè¯•ç©ç¯å¢ƒï¼Œå¤§å®¶å¯ä»¥ç…§ç€æ–‡æ¡£ï¼Œåˆ©ç”¨è¯•ç©ç¯å¢ƒå°é²œã€‚ åè¾¹ï¼ŒNebula Graph ä¼šå¼€å±•æ¯å¤©çš„æ±‰å…œ nGQL ä½“æ“æ´»åŠ¨ï¼Œæ•¬è¯·å…³æ³¨å“ˆï¼ Happy Graphing! ","date":"2022-02-28","objectID":"/resolve-wordle/:5:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#ä¸‹ä¸€æ­¥"},{"categories":["Nebula Graph"],"content":" 6 é™„å½•ï¼šæ­å»ºæˆè¯­çŸ¥è¯†å›¾è°±","date":"2022-02-28","objectID":"/resolve-wordle/:6:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#é™„å½•æ­å»ºæˆè¯­çŸ¥è¯†å›¾è°±"},{"categories":["Nebula Graph"],"content":" 6.1 æ”¶é›†ã€ç”Ÿæˆå›¾è°±æ•°æ® $ python3 graph_data_generator.py ","date":"2022-02-28","objectID":"/resolve-wordle/:6:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#æ”¶é›†ç”Ÿæˆå›¾è°±æ•°æ®"},{"categories":["Nebula Graph"],"content":" 6.2 å¯¼å…¥æ•°æ®åˆ° Nebula Graph å›¾æ•°æ®åº“ 6.2.1 éƒ¨ç½²å›¾æ•°æ®åº“ å€ŸåŠ©äº Nebula-Up https://github.com/wey-gu/nebula-up/ ï¼Œä¸€è¡Œå°±å¯ä»¥äº†ã€‚ $ curl -fsSL nebula-up.siwei.io/install.sh | bash -s -- v3.0.0 éƒ¨ç½²æˆåŠŸçš„è¯ï¼Œä¼šçœ‹åˆ°è¿™æ ·çš„ç»“æœï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ğŸŒŒ Nebula-Graph Playground is Up now! â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ ğŸ‰ Congrats! Your Nebula is Up now! â”‚ â”‚ $ cd ~/.nebula-up â”‚ â”‚ â”‚ â”‚ ğŸŒ You can access it from browser: â”‚ â”‚ http://127.0.0.1:7001 â”‚ â”‚ http://\u003cother_interface\u003e:7001 â”‚ â”‚ â”‚ â”‚ ğŸ”¥ Or access via Nebula Console: â”‚ â”‚ $ ~/.nebula-up/console.sh â”‚ â”‚ â”‚ â”‚ To remove the playground: â”‚ â”‚ $ ~/.nebula-up/uninstall.sh â”‚ â”‚ â”‚ â”‚ ğŸš€ Have Fun! â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 6.2.2 å›¾è°±å…¥åº“ å€ŸåŠ©äº Nebula-Importer https://github.com/vesoft-inc/nebula-importer/ ï¼Œä¸€è¡Œå°±å¯ä»¥äº†ã€‚ $ docker run --rm -ti \\ --network=nebula-docker-compose_nebula-net \\ -v ${PWD}/importer_conf.yaml:/root/importer_conf.yaml \\ -v ${PWD}/output:/root \\ vesoft/nebula-importer:v3.0.0 \\ --config /root/importer_conf.yaml å¤§æ¦‚ä¸€ä¸¤åˆ†é’Ÿæ•°æ®å°±å¯¼å…¥æˆåŠŸäº†ï¼Œå‘½ä»¤ä¹Ÿä¼šæ­£å¸¸é€€å‡ºã€‚ è¿åˆ°å›¾æ•°æ®åº“çš„ console è¿›å…¥ Console çš„å®¹å™¨æ‰§è¡Œä¸‹è¾¹çš„å‘½ä»¤ï¼š $ ~/.nebula-up/console.sh # nebula-console -addr graphd -port 9669 -user root -p nebula æ£€æŸ¥ä¸€ä¸‹å¯¼å…¥çš„æ•°æ®ï¼š (root@nebula) [(none)]\u003e show spaces +--------------------+ | Name | +--------------------+ | \"chinese_idiom\" | +--------------------+ (root@nebula) [(none)]\u003e use chinese_idiom Execution succeeded (time spent 1510/2329 us) Fri, 25 Feb 2022 08:53:11 UTC (root@nebula) [chinese_idiom]\u003e MATCH p=(æˆè¯­:`idiom`) RETURN p LIMIT 2 +------------------------------------------------------------------+ | p | +------------------------------------------------------------------+ | \u003c(\"ä¸€ä¸ä¸è¯†\" :idiom{pinyin: \"['yi1', 'ding1', 'bu4', 'shi2']\"})\u003e | | \u003c(\"ä¸€ä¸ä¸æŒ‚\" :idiom{pinyin: \"['yi1', 'si1', 'bu4', 'gua4']\"})\u003e | +------------------------------------------------------------------+ (root@nebula) [chinese_idiom]\u003e SUBMIT JOB STATS +------------+ | New Job Id | +------------+ | 11 | +------------+ (root@nebula) [chinese_idiom]\u003e SHOW STATS +---------+--------------------+--------+ | Type | Name | Count | +---------+--------------------+--------+ | \"Tag\" | \"character\" | 4847 | | \"Tag\" | \"character_pinyin\" | 1336 | | \"Tag\" | \"idiom\" | 29503 | | \"Tag\" | \"pinyin_part\" | 57 | | \"Edge\" | \"with_character\" | 116090 | | \"Edge\" | \"with_pinyin\" | 5943 | | \"Edge\" | \"with_pinyin_part\" | 3290 | | \"Space\" | \"vertices\" | 35739 | | \"Space\" | \"edges\" | 125323 | +---------+--------------------+--------+ ","date":"2022-02-28","objectID":"/resolve-wordle/:6:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#å¯¼å…¥æ•°æ®åˆ°-nebula-graph-å›¾æ•°æ®åº“"},{"categories":["Nebula Graph"],"content":" 6.2 å¯¼å…¥æ•°æ®åˆ° Nebula Graph å›¾æ•°æ®åº“ 6.2.1 éƒ¨ç½²å›¾æ•°æ®åº“ å€ŸåŠ©äº Nebula-Up https://github.com/wey-gu/nebula-up/ ï¼Œä¸€è¡Œå°±å¯ä»¥äº†ã€‚ $ curl -fsSL nebula-up.siwei.io/install.sh | bash -s -- v3.0.0 éƒ¨ç½²æˆåŠŸçš„è¯ï¼Œä¼šçœ‹åˆ°è¿™æ ·çš„ç»“æœï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ğŸŒŒ Nebula-Graph Playground is Up now! â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ ğŸ‰ Congrats! Your Nebula is Up now! â”‚ â”‚ $ cd ~/.nebula-up â”‚ â”‚ â”‚ â”‚ ğŸŒ You can access it from browser: â”‚ â”‚ http://127.0.0.1:7001 â”‚ â”‚ http://:7001 â”‚ â”‚ â”‚ â”‚ ğŸ”¥ Or access via Nebula Console: â”‚ â”‚ $ ~/.nebula-up/console.sh â”‚ â”‚ â”‚ â”‚ To remove the playground: â”‚ â”‚ $ ~/.nebula-up/uninstall.sh â”‚ â”‚ â”‚ â”‚ ğŸš€ Have Fun! â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 6.2.2 å›¾è°±å…¥åº“ å€ŸåŠ©äº Nebula-Importer https://github.com/vesoft-inc/nebula-importer/ ï¼Œä¸€è¡Œå°±å¯ä»¥äº†ã€‚ $ docker run --rm -ti \\ --network=nebula-docker-compose_nebula-net \\ -v ${PWD}/importer_conf.yaml:/root/importer_conf.yaml \\ -v ${PWD}/output:/root \\ vesoft/nebula-importer:v3.0.0 \\ --config /root/importer_conf.yaml å¤§æ¦‚ä¸€ä¸¤åˆ†é’Ÿæ•°æ®å°±å¯¼å…¥æˆåŠŸäº†ï¼Œå‘½ä»¤ä¹Ÿä¼šæ­£å¸¸é€€å‡ºã€‚ è¿åˆ°å›¾æ•°æ®åº“çš„ console è¿›å…¥ Console çš„å®¹å™¨æ‰§è¡Œä¸‹è¾¹çš„å‘½ä»¤ï¼š $ ~/.nebula-up/console.sh # nebula-console -addr graphd -port 9669 -user root -p nebula æ£€æŸ¥ä¸€ä¸‹å¯¼å…¥çš„æ•°æ®ï¼š (root@nebula) [(none)]\u003e show spaces +--------------------+ | Name | +--------------------+ | \"chinese_idiom\" | +--------------------+ (root@nebula) [(none)]\u003e use chinese_idiom Execution succeeded (time spent 1510/2329 us) Fri, 25 Feb 2022 08:53:11 UTC (root@nebula) [chinese_idiom]\u003e MATCH p=(æˆè¯­:`idiom`) RETURN p LIMIT 2 +------------------------------------------------------------------+ | p | +------------------------------------------------------------------+ | \u003c(\"ä¸€ä¸ä¸è¯†\" :idiom{pinyin: \"['yi1', 'ding1', 'bu4', 'shi2']\"})\u003e | | \u003c(\"ä¸€ä¸ä¸æŒ‚\" :idiom{pinyin: \"['yi1', 'si1', 'bu4', 'gua4']\"})\u003e | +------------------------------------------------------------------+ (root@nebula) [chinese_idiom]\u003e SUBMIT JOB STATS +------------+ | New Job Id | +------------+ | 11 | +------------+ (root@nebula) [chinese_idiom]\u003e SHOW STATS +---------+--------------------+--------+ | Type | Name | Count | +---------+--------------------+--------+ | \"Tag\" | \"character\" | 4847 | | \"Tag\" | \"character_pinyin\" | 1336 | | \"Tag\" | \"idiom\" | 29503 | | \"Tag\" | \"pinyin_part\" | 57 | | \"Edge\" | \"with_character\" | 116090 | | \"Edge\" | \"with_pinyin\" | 5943 | | \"Edge\" | \"with_pinyin_part\" | 3290 | | \"Space\" | \"vertices\" | 35739 | | \"Space\" | \"edges\" | 125323 | +---------+--------------------+--------+ ","date":"2022-02-28","objectID":"/resolve-wordle/:6:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#éƒ¨ç½²å›¾æ•°æ®åº“"},{"categories":["Nebula Graph"],"content":" 6.2 å¯¼å…¥æ•°æ®åˆ° Nebula Graph å›¾æ•°æ®åº“ 6.2.1 éƒ¨ç½²å›¾æ•°æ®åº“ å€ŸåŠ©äº Nebula-Up https://github.com/wey-gu/nebula-up/ ï¼Œä¸€è¡Œå°±å¯ä»¥äº†ã€‚ $ curl -fsSL nebula-up.siwei.io/install.sh | bash -s -- v3.0.0 éƒ¨ç½²æˆåŠŸçš„è¯ï¼Œä¼šçœ‹åˆ°è¿™æ ·çš„ç»“æœï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ğŸŒŒ Nebula-Graph Playground is Up now! â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ ğŸ‰ Congrats! Your Nebula is Up now! â”‚ â”‚ $ cd ~/.nebula-up â”‚ â”‚ â”‚ â”‚ ğŸŒ You can access it from browser: â”‚ â”‚ http://127.0.0.1:7001 â”‚ â”‚ http://:7001 â”‚ â”‚ â”‚ â”‚ ğŸ”¥ Or access via Nebula Console: â”‚ â”‚ $ ~/.nebula-up/console.sh â”‚ â”‚ â”‚ â”‚ To remove the playground: â”‚ â”‚ $ ~/.nebula-up/uninstall.sh â”‚ â”‚ â”‚ â”‚ ğŸš€ Have Fun! â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 6.2.2 å›¾è°±å…¥åº“ å€ŸåŠ©äº Nebula-Importer https://github.com/vesoft-inc/nebula-importer/ ï¼Œä¸€è¡Œå°±å¯ä»¥äº†ã€‚ $ docker run --rm -ti \\ --network=nebula-docker-compose_nebula-net \\ -v ${PWD}/importer_conf.yaml:/root/importer_conf.yaml \\ -v ${PWD}/output:/root \\ vesoft/nebula-importer:v3.0.0 \\ --config /root/importer_conf.yaml å¤§æ¦‚ä¸€ä¸¤åˆ†é’Ÿæ•°æ®å°±å¯¼å…¥æˆåŠŸäº†ï¼Œå‘½ä»¤ä¹Ÿä¼šæ­£å¸¸é€€å‡ºã€‚ è¿åˆ°å›¾æ•°æ®åº“çš„ console è¿›å…¥ Console çš„å®¹å™¨æ‰§è¡Œä¸‹è¾¹çš„å‘½ä»¤ï¼š $ ~/.nebula-up/console.sh # nebula-console -addr graphd -port 9669 -user root -p nebula æ£€æŸ¥ä¸€ä¸‹å¯¼å…¥çš„æ•°æ®ï¼š (root@nebula) [(none)]\u003e show spaces +--------------------+ | Name | +--------------------+ | \"chinese_idiom\" | +--------------------+ (root@nebula) [(none)]\u003e use chinese_idiom Execution succeeded (time spent 1510/2329 us) Fri, 25 Feb 2022 08:53:11 UTC (root@nebula) [chinese_idiom]\u003e MATCH p=(æˆè¯­:`idiom`) RETURN p LIMIT 2 +------------------------------------------------------------------+ | p | +------------------------------------------------------------------+ | \u003c(\"ä¸€ä¸ä¸è¯†\" :idiom{pinyin: \"['yi1', 'ding1', 'bu4', 'shi2']\"})\u003e | | \u003c(\"ä¸€ä¸ä¸æŒ‚\" :idiom{pinyin: \"['yi1', 'si1', 'bu4', 'gua4']\"})\u003e | +------------------------------------------------------------------+ (root@nebula) [chinese_idiom]\u003e SUBMIT JOB STATS +------------+ | New Job Id | +------------+ | 11 | +------------+ (root@nebula) [chinese_idiom]\u003e SHOW STATS +---------+--------------------+--------+ | Type | Name | Count | +---------+--------------------+--------+ | \"Tag\" | \"character\" | 4847 | | \"Tag\" | \"character_pinyin\" | 1336 | | \"Tag\" | \"idiom\" | 29503 | | \"Tag\" | \"pinyin_part\" | 57 | | \"Edge\" | \"with_character\" | 116090 | | \"Edge\" | \"with_pinyin\" | 5943 | | \"Edge\" | \"with_pinyin_part\" | 3290 | | \"Space\" | \"vertices\" | 35739 | | \"Space\" | \"edges\" | 125323 | +---------+--------------------+--------+ ","date":"2022-02-28","objectID":"/resolve-wordle/:6:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#å›¾è°±å…¥åº“"},{"categories":["Nebula Graph"],"content":" 7 é™„å½•ï¼šå›¾å»ºæ¨¡çš„ Schema nGQL CREATE SPACE IF NOT EXISTS chinese_idiom(partition_num=5, replica_factor=1, vid_type=FIXED_STRING(24)); USE chinese_idiom; // åˆ›å»ºç‚¹çš„ç±»å‹ CREATE TAG idiom(pinyin string); #æˆè¯­ CREATE TAG character(); #æ±‰å­— CREATE TAG character_pinyin(tone int); #å•å­—çš„æ‹¼éŸ³ CREATE TAG pinyin_part(part_type string); #æ‹¼éŸ³çš„å£°éƒ¨ // åˆ›å»ºè¾¹çš„ç±»å‹ CREATE EDGE with_character(`position` int); #åŒ…å«æ±‰å­— CREATE EDGE with_pinyin(`position` int); #è¯»ä½œ CREATE EDGE with_pinyin_part(part_type string); #åŒ…å«å£°éƒ¨ ","date":"2022-02-28","objectID":"/resolve-wordle/:7:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","çŸ¥è¯†å›¾è°±","wordle","æ±‰å…œ"],"title":"å›¾æ•°æ®åº“ä½“æ“ï¼šç”¨ Nebula Graph æ­æˆè¯­å›¾è°±è§£æ±‰å…œ","uri":"/resolve-wordle/#é™„å½•å›¾å»ºæ¨¡çš„-schema-ngql"},{"categories":["Nebula Graph"],"content":"æ‰¾ä¸åˆ°ç´¢å¼•ï¼Ÿä¸ºä»€ä¹ˆæˆ‘è¦åˆ›å»º NebulaGraph ç´¢å¼•ï¼Ÿä»€ä¹ˆæ—¶å€™è¦ç”¨åˆ° NebulaGraph åŸç”Ÿç´¢å¼•ï¼Œä¸€æ–‡æŠŠè¿™äº›ææ¸…æ¥šã€‚","date":"2022-02-20","objectID":"/nebula-index-explained/","series":null,"tags":["Nebula Graph","ç´¢å¼•","å…¨æ–‡æœç´¢","å›¾æ•°æ®åº“"],"title":"Nebula Graph ç´¢å¼•è¯¦è§£","uri":"/nebula-index-explained/"},{"categories":["Nebula Graph"],"content":" index not foundï¼Ÿ æ‰¾ä¸åˆ°ç´¢å¼•ï¼Ÿä¸ºä»€ä¹ˆæˆ‘è¦åˆ›å»º NebulaGraph ç´¢å¼•ï¼Ÿä»€ä¹ˆæ—¶å€™è¦ç”¨åˆ° Nebula Graph åŸç”Ÿç´¢å¼•ï¼Œä¸€æ–‡æŠŠè¿™äº›ææ¸…æ¥šã€‚ updated: 3.x ä¹‹åï¼Œç¼ºä¹ç´¢å¼•é€ æˆçš„æ–°æŠ¥é”™æ˜¯ï¼š need to specify a limit number, or limit number can not push down. NebulaGraph çš„ç´¢å¼•å…¶å®å’Œä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ä¸­çš„ç´¢å¼•å¾ˆåƒï¼Œä½†æ˜¯åˆæœ‰ä¸€äº›å®¹æ˜“è®©äººç–‘æƒ‘çš„åŒºåˆ«ã€‚åˆšå¼€å§‹äº†è§£ NebulaGraph çš„åŒå­¦ä¼šç–‘æƒ‘äºï¼š ä¸æ¸…æ¥š NebulaGraph å›¾æ•°æ®åº“ä¸­çš„ç´¢å¼•åˆ°çš„æ˜¯ä»€ä¹ˆæ¦‚å¿µ æˆ‘åº”è¯¥ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ NebulaGraph ç´¢å¼• NebulaGraph ç´¢å¼•æ€ä¹ˆå½±å“åˆ°å†™å…¥æ€§èƒ½ è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬å°±æŠŠè¿™äº›é—®é¢˜å›ç­”å¥½ã€‚ ","date":"2022-02-20","objectID":"/nebula-index-explained/:0:0","series":null,"tags":["Nebula Graph","ç´¢å¼•","å…¨æ–‡æœç´¢","å›¾æ•°æ®åº“"],"title":"Nebula Graph ç´¢å¼•è¯¦è§£","uri":"/nebula-index-explained/#"},{"categories":["Nebula Graph"],"content":" 1 åˆ°åº• NebulaGraph ç´¢å¼•æ˜¯ä»€ä¹ˆç®€è€Œè¨€ä¹‹ï¼ŒNebulaGraph ç´¢å¼•æ˜¯ç”¨æ¥ï¼Œä¸”åªç”¨æ¥é’ˆå¯¹çº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢åœºæ™¯çš„ å›¾æ¸¸èµ°ï¼ˆwalkï¼‰æŸ¥è¯¢ä¸­çš„å±æ€§æ¡ä»¶è¿‡æ»¤ä¸éœ€è¦å®ƒ çº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢ï¼ˆæ³¨ï¼šéé‡‡æ ·æƒ…å†µï¼‰å¿…é¡»åˆ›å»ºç´¢å¼• ","date":"2022-02-20","objectID":"/nebula-index-explained/:1:0","series":null,"tags":["Nebula Graph","ç´¢å¼•","å…¨æ–‡æœç´¢","å›¾æ•°æ®åº“"],"title":"Nebula Graph ç´¢å¼•è¯¦è§£","uri":"/nebula-index-explained/#åˆ°åº•-nebulagraph-ç´¢å¼•æ˜¯ä»€ä¹ˆ"},{"categories":["Nebula Graph"],"content":" 1.1 çº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢æˆ‘ä»¬çŸ¥é“åœ¨ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œç´¢å¼•æ˜¯å¯¹è¡¨æ•°æ®çš„ä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹ç‰¹å®šåˆ—é‡æ’åºçš„å‰¯æœ¬ï¼Œå®ƒç”¨æ¥åŠ é€Ÿç‰¹å®šåˆ—è¿‡æ»¤æ¡ä»¶çš„è¯»æŸ¥è¯¢å¹¶å¸¦æ¥äº†é¢å¤–çš„æ•°æ®å†™å…¥ï¼ˆåŠ é€Ÿè€Œéè¿™æ ·æŸ¥è¯¢çš„å¿…é¡»å‰æï¼‰ã€‚ åœ¨ NebulaGraph å›¾æ•°æ®åº“é‡Œï¼Œç´¢å¼•åˆ™æ˜¯å¯¹ç‚¹ã€è¾¹ç‰¹å®šå±æ€§æ•°æ®é‡æ’åºçš„å‰¯æœ¬ï¼Œç”¨æ¥æä¾›çº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢ï¼ˆå¦‚ä¸‹è¾¹çš„æŸ¥è¯¢ï¼šä»åªç»™å®šäº†ç‚¹è¾¹å±æ€§æ¡ä»¶ï¼Œè€Œéç‚¹çš„ ID å‡ºå‘å»è·å–å›¾æ•°æ®ï¼‰ #### å¿…é¡» Nebula Graph ç´¢å¼•å­˜åœ¨çš„æŸ¥è¯¢ # query 0 çº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢ LOOKUP ON tag1 WHERE col1 \u003e 1 AND col2 == \"foo\" \\ YIELD tag1.col1 as col1, tag1.col3 as col3; # query 1 çº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢ MATCH (v:player { name: 'Tim Duncan' })--\u003e(v2:player) \\ RETURN v2.player.name AS Name; ä¸Šè¾¹è¿™ä¸¤ä¸ªçº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢å°±æ˜¯å­—é¢æ„æ€çš„â€æ ¹æ®ç»™å®šçš„å±æ€§æ¡ä»¶è·å–ç‚¹æˆ–è€…è¾¹æœ¬èº«â€œ ï¼Œåé¢çš„ä¾‹å­åˆ™æ˜¯ç»™å®šäº†ç‚¹çš„ IDï¼š #### ä¸åŸºäºç´¢å¼•çš„æŸ¥è¯¢ # query 2, ä»ç»™å®šçš„ç‚¹åšçš„æ¸¸èµ°æŸ¥è¯¢ vertex VID: \"player100\" GO FROM \"player100\" OVER follow REVERSELY \\ YIELD src(edge) AS id | \\ GO FROM $-.id OVER serve \\ WHERE properties($^).age \u003e 20 \\ YIELD properties($^).name AS FriendOf, properties($$).name AS Team; # query 3, ä»ç»™å®šçš„ç‚¹åšçš„æ¸¸èµ°æŸ¥è¯¢ vertex VID: \"player101\" æˆ–è€… \"player102\" MATCH (v:player { name: 'Tim Duncan' })--(v2) \\ WHERE id(v2) IN [\"player101\", \"player102\"] \\ RETURN v2.player.name AS Name; æˆ‘ä»¬ä»”ç»†çœ‹å‰è¾¹çš„ query 1 å’Œ query 3ï¼Œå°½ç®¡è¯­å¥ä¸­æ¡ä»¶éƒ½æœ‰é’ˆå¯¹ tag ä¸º player çš„è¿‡æ»¤ï¼š { name: 'Tim Duncan' } ï¼š query 3ä¹‹ä¸­ä¸éœ€è¦ç´¢å¼•ï¼Œå› ä¸ºå®ƒå¯ä»¥ï¼š æ›´ç›´æ¥çš„ä»å·²çŸ¥çš„ v2 é¡¶ç‚¹ï¼š [\"player101\", \"player102\"] å‘å¤–æ‰©å±•ã€æ¸¸èµ°ï¼ˆGetNeighbors() è·å¾—è¾¹çš„å¦ä¸€ç«¯çš„ç‚¹ï¼Œç„¶åGetVertices() å¾—åˆ°ä¸‹ä¸€è·³çš„ vï¼‰ï¼Œæ ¹æ® v.player.name è¿‡æ»¤æ‰ä¸è¦çš„æ•°æ® query 1 åˆ™ä¸åŒï¼Œå®ƒå› ä¸ºæ²¡æœ‰ä»»ä½•ç»™å®šçš„é¡¶ç‚¹ IDï¼š åªèƒ½ä»å±æ€§æ¡ä»¶å…¥æ‰‹ï¼Œ{ name: 'Tim Duncan' }ï¼Œåœ¨æŒ‰ç…§ name æ’åºäº†çš„ç´¢å¼•æ•°æ®ä¸­å…ˆæ‰¾åˆ°ç¬¦åˆçš„ç‚¹ï¼šIndexScan() å¾—åˆ° v ç„¶åå†ä» v åš GetNeighbors() è·å¾—è¾¹çš„å¦ä¸€ç«¯ çš„ v2 ï¼Œåœ¨é€šè¿‡ GetVertices() å»è·å¾—ä¸‹ä¸€è·³ v2 ä¸­çš„æ•°æ® å…¶å®ï¼Œè¿™é‡Œçš„å…³é”®å°±æ˜¯åœ¨äºæ˜¯æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ç»™å®šçš„é¡¶ç‚¹ IDï¼ˆVertex IDï¼‰ï¼Œä¸‹è¾¹ä¸¤ä¸ªæŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’é‡Œæ›´æ¸…æ™°åœ°æ¯”è¾ƒäº†ä»–ä»¬çš„åŒºåˆ«ï¼š query 1, éœ€è¦åŸºäºç´¢å¼•ï¼Œçº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢ query 3, ä»å·²çŸ¥ VIDï¼Œä¸éœ€è¦ç´¢å¼• ","date":"2022-02-20","objectID":"/nebula-index-explained/:1:1","series":null,"tags":["Nebula Graph","ç´¢å¼•","å…¨æ–‡æœç´¢","å›¾æ•°æ®åº“"],"title":"Nebula Graph ç´¢å¼•è¯¦è§£","uri":"/nebula-index-explained/#çº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢"},{"categories":["Nebula Graph"],"content":" 1.2 ä¸ºä»€ä¹ˆçº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢é‡Œå¿…é¡»è¦ç´¢å¼•å‘¢ï¼Ÿå› ä¸º NebulaGraph åœ¨å­˜å‚¨æ•°æ®çš„æ—¶å€™ï¼Œå®ƒçš„ç»“æ„æ˜¯é¢å‘åˆ†å¸ƒå¼ä¸å…³è”å…³ç³»è®¾è®¡çš„ï¼Œç±»ä¼¼è¡¨ç»“æ„æ•°æ®åº“ä¸­æ— ç´¢å¼•çš„å…¨æ‰«ææ¡ä»¶æœç´¢å®é™…ä¸Šæ›´åŠ æ˜‚è´µï¼Œæ‰€ä»¥è®¾è®¡ä¸Šè¢«æœ‰æ„ç¦æ­¢äº†ã€‚ æ³¨: å¦‚æœä¸è¿½æ±‚å…¨éƒ¨æ•°æ®ï¼Œåªè¦é‡‡æ ·ä¸€éƒ¨åˆ†ï¼Œ3.0 é‡Œä¹‹åæ˜¯æ”¯æŒä¸å¼ºåˆ¶ç´¢å¼• LIMIT çš„æƒ…å†µçš„ï¼Œå¦‚ä¸‹æŸ¥è¯¢ï¼ˆæœ‰ LIMITï¼‰ä¸éœ€è¦ç´¢å¼•ï¼š # sample vertex MATCH (v:`team`) RETURN v LIMIT 3 # or sample edge MATCH ()-[e:`follow`]-\u003e() RETURN e LIMIT 3 ","date":"2022-02-20","objectID":"/nebula-index-explained/:1:2","series":null,"tags":["Nebula Graph","ç´¢å¼•","å…¨æ–‡æœç´¢","å›¾æ•°æ®åº“"],"title":"Nebula Graph ç´¢å¼•è¯¦è§£","uri":"/nebula-index-explained/#ä¸ºä»€ä¹ˆçº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢é‡Œå¿…é¡»è¦ç´¢å¼•å‘¢"},{"categories":["Nebula Graph"],"content":" 1.3 ä¸ºä»€ä¹ˆåªæœ‰çº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹æ­£å¸¸çš„å›¾æŸ¥è¯¢ graph-queries å’Œçº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢ pure-prop-condition queriesï¼š graph-queriesï¼š å¦‚ query 2 ã€ query 3æ˜¯æ²¿ç€è¾¹ä¸€è·¯æ‰¾åˆ°ç‰¹å®šè·¯å¾„æ¡ä»¶çš„æ‰©å±•æ¸¸èµ° pure-prop-condition queriesï¼šå¦‚ query 0 and query 1 æ˜¯åªé€šè¿‡ä¸€å®šå±æ€§æ¡ä»¶ï¼ˆæˆ–è€…æ˜¯æ— é™åˆ¶æ¡ä»¶ï¼‰æ‰¾åˆ°æ»¡è¶³çš„ç‚¹ã€è¾¹ è€Œåœ¨ NebulaGraph é‡Œï¼Œgraph-queries åœ¨æ‰©å±•çš„æ—¶å€™ï¼Œå›¾çš„åŸå§‹æ•°æ®å·²ç»æŒ‰ç…§ VIDï¼ˆç‚¹å’Œè¾¹éƒ½æ˜¯ï¼‰æ’åºè¿‡äº†ï¼ˆæˆ–è€…è¯´åœ¨æ•°æ®é‡Œå·²ç»ç´¢å¼•è¿‡äº†ï¼‰ï¼Œè¿™ä¸ªæ’åºå¸¦æ¥è¿ç»­å­˜å‚¨ï¼ˆç‰©ç†ä¸Šä¸´æ¥ï¼‰ä½¿å¾—æ‰©å±•æ¸¸èµ°æœ¬èº«å°±æ˜¯ä¼˜åŒ–ã€å¾ˆå¿«çš„ã€‚ ","date":"2022-02-20","objectID":"/nebula-index-explained/:1:3","series":null,"tags":["Nebula Graph","ç´¢å¼•","å…¨æ–‡æœç´¢","å›¾æ•°æ®åº“"],"title":"Nebula Graph ç´¢å¼•è¯¦è§£","uri":"/nebula-index-explained/#ä¸ºä»€ä¹ˆåªæœ‰çº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢"},{"categories":["Nebula Graph"],"content":" 1.4 æ€»ç»“ï¼šç´¢å¼•æ˜¯ä»€ä¹ˆï¼Œç´¢å¼•ä¸æ˜¯ä»€ä¹ˆï¼Ÿç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿ NebulaGraph ç´¢å¼•æ˜¯ä¸ºäº†ä»ç»™å®šå±æ€§æ¡ä»¶æŸ¥ç‚¹ã€è¾¹çš„ä¸€ä»½å±æ€§æ•°æ®çš„æ’åºï¼Œå®ƒç”¨å†™å…¥çš„ä»£ä»·æ˜¯çš„è¿™ç§è¯»æŸ¥è¯¢æ¨¡å¼æˆä¸ºå¯èƒ½ã€‚ ç´¢å¼•ä¸æ˜¯ä»€ä¹ˆï¼Ÿ NebulaGraph ç´¢å¼•ä¸æ˜¯ç”¨æ¥åŠ é€Ÿä¸€èˆ¬å›¾æŸ¥è¯¢çš„ï¼šä»ä¸€ä¸ªç‚¹å¼€å§‹å‘å¤–æ‹“å±•çš„æŸ¥è¯¢ï¼ˆå³ä½¿æ˜¯è¿‡æ»¤å±æ€§æ¡ä»¶çš„ï¼‰ä¸ä¼šä¾èµ–åŸç”Ÿç´¢å¼•ï¼Œå› ä¸º Nebula æ•°æ®è‡ªèº«çš„å­˜å‚¨å°±æ˜¯é¢å‘è¿™ç§æŸ¥è¯¢ä¼˜åŒ–ã€æ’åºçš„ã€‚ ","date":"2022-02-20","objectID":"/nebula-index-explained/:1:4","series":null,"tags":["Nebula Graph","ç´¢å¼•","å…¨æ–‡æœç´¢","å›¾æ•°æ®åº“"],"title":"Nebula Graph ç´¢å¼•è¯¦è§£","uri":"/nebula-index-explained/#æ€»ç»“ç´¢å¼•æ˜¯ä»€ä¹ˆç´¢å¼•ä¸æ˜¯ä»€ä¹ˆ"},{"categories":["Nebula Graph"],"content":" 2 ä¸€äº› Nebula Graph ç´¢å¼•çš„è®¾è®¡ç»†èŠ‚ä¸ºäº†æ›´å¥½ç†è§£ç´¢å¼•çš„é™åˆ¶ã€ä»£ä»·ã€èƒ½åŠ›ï¼Œå’±ä»¬æ¥è§£é‡Šæ›´å¤šä»–çš„ç»†èŠ‚ NebulaGraph ç´¢å¼•æ˜¯åœ¨æœ¬åœ°ï¼ˆä¸æ˜¯åˆ†å¼€ã€ä¸­å¿ƒåŒ–ï¼‰å’Œç‚¹æ•°æ®è¢«ä¸€èµ·å­˜å‚¨ã€åˆ†ç‰‡çš„ã€‚ å®ƒåªæ”¯æŒå·¦åŒ¹é… å› ä¸ºåº•å±‚æ˜¯ RocksDB Prefix Scan æ€§èƒ½ä»£ä»·: å†™å…¥æ—¶å€™çš„è·¯å¾„ï¼šä¸åªæ˜¯å¤šä¸€åˆ†æ•°æ®ï¼Œä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼Œè¿˜æœ‰æ˜‚è´µçš„è¯»æ“ä½œ è¯»è·¯å¾„ï¼šåŸºäºè§„åˆ™çš„ä¼˜åŒ–é€‰æ‹©ç´¢å¼•ï¼ŒFan Out åˆ°æ‰€æœ‰ StorageD è¿™äº›ä¿¡æ¯ä¹Ÿåœ¨æˆ‘çš„æ‰‹ç»˜å›¾å’Œè§†é¢‘é‡Œå¯ä»¥çœ‹åˆ°ï¼š å› ä¸ºå·¦åŒ¹é…çš„è®¾è®¡ï¼Œåœ¨æœ‰æ›´å¤æ‚çš„é’ˆå¯¹çº¯å±æ€§æ¡ä»¶å‡ºå‘æŸ¥è¯¢é‡Œæ¶‰åŠåˆ°é€šé…ã€REGEXPè¿™æ ·çš„å…¨æ–‡æœç´¢æƒ…å†µï¼ŒNebula Graph æä¾›äº†å…¨æ–‡ç´¢å¼•çš„åŠŸèƒ½ï¼Œå®ƒæ˜¯åˆ©ç”¨ Raft Listener å»å¼‚æ­¥å°†æ•°æ®å†™åˆ°å¤–éƒ¨ Elasticsearch é›†ç¾¤ä¹‹ä¸­ï¼Œå¹¶åœ¨æŸ¥è¯¢çš„æ—¶å€™å»æŸ¥ ES å»åšåˆ°çš„ï¼Œè§æ–‡æ¡£ã€‚ åœ¨è¿™ä¸ªæ‰‹ç»˜å›¾ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹å‡º Write path å†™å…¥ç´¢å¼•æ•°æ®æ˜¯åŒæ­¥æ“ä½œçš„ Read path è¿™éƒ¨åˆ†ç”»äº†ä¸€ä¸ª RBO çš„ä¾‹å­ï¼ŒæŸ¥è¯¢é‡Œçš„è§„åˆ™å‡è®¾ col2 ç›¸ç­‰åŒ¹é…æ’åœ¨å·¦è¾¹çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½ä¼˜äº col1 çš„å¤§å°æ¯”è¾ƒåŒ¹é…ï¼Œæ‰€ä»¥é€‰æ‹©äº†ç¬¬äºŒä¸ªç´¢å¼• é€‰å¥½äº†ç´¢å¼•ä¹‹åï¼Œæ‰«æç´¢å¼•çš„è¯·æ±‚è¢« fan out åˆ°å­˜å‚¨èŠ‚ç‚¹ä¸Šï¼Œè¿™å…¶ä¸­æœ‰äº›è¿‡æ»¤æ¡ä»¶æ¯”å¦‚ top n æ˜¯å¯ä»¥ä¸‹æ¨çš„ ç»“è®ºï¼š å› ä¸ºå†™å…¥çš„ä»£ä»·ï¼Œåªæœ‰å¿…é¡»ç”¨ç´¢å¼•çš„æ—¶å€™é‡‡ç”¨ï¼Œå¦‚æœé‡‡æ ·æŸ¥è¯¢èƒ½æ»¡è¶³è¯»çš„è¦æ±‚ï¼Œå¯ä»¥ä¸åˆ›å»ºç´¢å¼•è€Œç”¨ LIMIT ã€‚ ç´¢å¼•æœ‰å·¦åŒ¹é…çš„é™åˆ¶ ç¬¦åˆæŸ¥è¯¢çš„é¡ºåºè¦ä»”ç»†è®¾è®¡ æœ‰æ—¶å€™éœ€è¦ä½¿ç”¨å…¨æ–‡ç´¢å¼• full-text indexã€‚ ","date":"2022-02-20","objectID":"/nebula-index-explained/:2:0","series":null,"tags":["Nebula Graph","ç´¢å¼•","å…¨æ–‡æœç´¢","å›¾æ•°æ®åº“"],"title":"Nebula Graph ç´¢å¼•è¯¦è§£","uri":"/nebula-index-explained/#ä¸€äº›-nebula-graph-ç´¢å¼•çš„è®¾è®¡ç»†èŠ‚"},{"categories":["Nebula Graph"],"content":" 3 ç´¢å¼•çš„ä½¿ç”¨å…·ä½“è¦å‚è€ƒç´¢å¼•æ–‡æ¡£ä¸€äº›è¦ç‚¹æ˜¯ï¼š åœ¨ tag æˆ–è€… edge type ä¸Šé’ˆå¯¹æƒ³è¦è¢«æ¡ä»¶åæŸ¥ç‚¹è¾¹çš„å±æ€§åˆ›å»ºç´¢å¼• CREATE INDEX åˆ›å»ºç´¢å¼•ä¹‹åçš„ç´¢å¼•éƒ¨åˆ†æ•°æ®ä¼šåŒæ­¥å†™å…¥ï¼Œä½†æ˜¯å¦‚æœåˆ›å»ºç´¢å¼•ä¹‹å‰å·²ç»æœ‰çš„ç‚¹è¾¹æ•°æ®å¯¹åº”çš„ç´¢å¼•æ˜¯éœ€è¦æ˜ç¡®æŒ‡å®šå»åˆ›å»ºçš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„ jobï¼š REBUILD INDEX è§¦å‘äº†å¼‚æ­¥çš„ REBUILD INDEX ä¹‹åï¼Œå¯ä»¥æŸ¥è¯¢çŠ¶æ€ï¼š SHOW INDEX STATUS åˆ©ç”¨åˆ°ç´¢å¼•çš„æŸ¥è¯¢å¯ä»¥æ˜¯ LOOKUPï¼Œå¹¶ä¸”å¸¸å¸¸å¯ä»¥å€ŸåŠ©ç®¡é“ç¬¦åœ¨æ­¤ä¹‹ä¸Šåšæ‹“å±•æŸ¥è¯¢ï¼ˆGraph Queryï¼‰ï¼š LOOKUP ON player \\ WHERE player.name == \"Kobe Bryant\"\\ YIELD id(vertex) AS VertexID, properties(vertex).name AS name |\\ GO FROM $-.VertexID OVER serve \\ YIELD $-.name, properties(edge).start_year, properties(edge).end_year, properties($$).name; ä¹Ÿå¯ä»¥æ˜¯ MATCH ï¼Œè¿™é‡Œè¾¹ v æ˜¯é€šè¿‡ç´¢å¼•å¾—åˆ°çš„ï¼Œè€Œ v2 åˆ™æ˜¯åœ¨æ•°æ®ï¼ˆéç´¢å¼•ï¼‰éƒ¨åˆ†æ‹“å±•æŸ¥è¯¢è·å¾—çš„ã€‚ MATCH (v:`player`{name:\"Tim Duncan\"})--(v2:`player`) \\ RETURN v2.`player`.name AS Name; å¤åˆç´¢å¼•çš„èƒ½åŠ›ä¸é™åˆ¶ ç†è§£åŸç”Ÿç´¢å¼•çš„åŒ¹é…æ˜¯å·¦åŒ¹é…èƒ½è®©æˆ‘ä»¬çŸ¥é“å¯¹äºè¶…è¿‡ä¸€ä¸ªå±æ€§çš„ç´¢å¼•ï¼šå¤åˆç´¢å¼•ï¼Œå¹¶ä¸”èƒ½å¸®åŠ©æˆ‘ä»¬ç†è§£å®ƒçš„èƒ½åŠ›æœ‰é™åˆ¶ï¼Œè¿™é‡Œè¯´å‡ ä¸ªç»“è®ºï¼š æˆ‘ä»¬åˆ›å»ºé’ˆå¯¹å¤šä¸ªå±æ€§çš„å¤åˆç´¢å¼•æ˜¯é¡ºåºæœ‰å…³çš„ æ¯”å¦‚ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒå±æ€§å¤åˆç´¢å¼• index_a: (isRisky: bool, age: int)ï¼Œå’Œ index_b: (age: int, isRisky: bool) åœ¨æ ¹æ® WHERE n.user.isRisky == true AND n.user.age \u003e 18 è¿™ä¸ªæ¡ä»¶æŸ¥è¯¢æ—¶å€™ï¼Œindex_a å› ä¸ºå·¦åŒ¹é…ä¸€ä¸ªç›¸ç­‰çš„çŸ­å­—æ®µï¼Œæ˜¾ç„¶æ•ˆç‡æ›´é«˜ã€‚ åªæœ‰å¤åˆå·¦åŒ¹é…çš„è¢«å¤åˆç´¢å¼•çš„å±æ€§çœŸå­é›†çš„è¿‡æ»¤æ¡ä»¶æ‰èƒ½è¢«åªæ”¯æŒ æ¯”å¦‚ï¼Œindex_a: (isRisky: bool, age: int)ï¼Œå’Œ index_b: (age: int, isRisky: bool) åœ¨æŸ¥è¯¢ WHERE n.user.age \u003e 18 è¿™ä¸ªè¯­å¥çš„æ—¶å€™, åªæœ‰ index_b å¤åˆæœ€å·¦åŒ¹é…ï¼Œèƒ½æ»¡è¶³è¿™ä¸ªæŸ¥è¯¢ã€‚ é’ˆå¯¹ä¸€äº›ä»å±æ€§ä½œä¸ºæŸ¥è¯¢çš„èµ·ç‚¹ï¼Œæ‰¾ç‚¹ã€è¾¹çš„æƒ…å†µï¼ŒåŸç”Ÿç´¢å¼•æ˜¯ä¸èƒ½æ»¡è¶³å…¨æ–‡æœç´¢çš„åŒ¹é…åœºæ™¯çš„ï¼Œè¿™æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥è€ƒè™‘ä½¿ç”¨ Nebula å…¨æ–‡ç´¢å¼•ï¼Œå®ƒæ˜¯ Nebula ç¤¾åŒºæ”¯æŒçš„å¼€ç®±å³ç”¨çš„å¤–ç½® Elastic Searchï¼Œé€šè¿‡é…ç½®ï¼Œåˆ›å»ºäº†å…¨æ–‡ç´¢å¼•çš„æ•°æ®ä¼šé€šè¿‡ Raft listener å¼‚æ­¥æ›´æ–°åˆ° Elastic é›†ç¾¤ä¸­ï¼Œä»–çš„æŸ¥è¯¢å…¥å£ä¹Ÿæ˜¯ LOOKUPï¼Œè¯¦ç»†çš„ä¿¡æ¯è¯·å‚è€ƒæ–‡æ¡£ã€‚ ","date":"2022-02-20","objectID":"/nebula-index-explained/:3:0","series":null,"tags":["Nebula Graph","ç´¢å¼•","å…¨æ–‡æœç´¢","å›¾æ•°æ®åº“"],"title":"Nebula Graph ç´¢å¼•è¯¦è§£","uri":"/nebula-index-explained/#ç´¢å¼•çš„ä½¿ç”¨"},{"categories":["Nebula Graph"],"content":" 4 å›é¡¾ NebulaGraph ç´¢å¼•åœ¨åªæä¾›å±æ€§æ¡ä»¶æƒ…å†µä¸‹é€šè¿‡å¯¹å±æ€§çš„æ’åºå‰¯æœ¬æ‰«ææŸ¥ç‚¹ã€è¾¹ NebulaGraph ç´¢å¼•ä¸æ˜¯ç”¨æ¥å›¾æ‹“å±•æŸ¥è¯¢çš„ NebulaGraph ç´¢å¼•æ˜¯å·¦åŒ¹é…ï¼Œä¸æ˜¯ç”¨æ¥åšæ¨¡ç³Šå…¨æ–‡æœç´¢çš„ NebulaGraph ç´¢å¼•åœ¨å†™å…¥æ—¶å€™æœ‰æ€§èƒ½ä»£ä»· è®°å¾—å¦‚æœåˆ›å»º NebulaGraph ç´¢å¼•ä¹‹å‰å·²ç»æœ‰ç›¸åº”ç‚¹è¾¹ä¸Šçš„æ•°æ®ï¼Œè¦é‡å»ºç´¢å¼• Happy Graphing! Feature image credit to Alina ","date":"2022-02-20","objectID":"/nebula-index-explained/:4:0","series":null,"tags":["Nebula Graph","ç´¢å¼•","å…¨æ–‡æœç´¢","å›¾æ•°æ®åº“"],"title":"Nebula Graph ç´¢å¼•è¯¦è§£","uri":"/nebula-index-explained/#å›é¡¾"},{"categories":["Nebula Graph"],"content":"ä¸€æ–‡äº†è§£ K8s éƒ¨ç½²çš„ Nebula Graph é›†ç¾¤çš„ Nebula-Algorithm ä½¿ç”¨æ–¹æ³•ã€‚","date":"2022-02-14","objectID":"/nebula-algo-spark-k8s/","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","Spark-Connector","Nebula-Algorithm","k8s","nebula-operator"],"title":"ä¸ºä»€ä¹ˆæˆ‘çš„ Nebula-Spark-Connectorã€Nebula-Algorithm è¿ä¸ä¸Š K8s éƒ¨ç½²çš„ Nebula Graph é›†ç¾¤ï¼Ÿ","uri":"/nebula-algo-spark-k8s/"},{"categories":["Nebula Graph"],"content":" ä¸€æ–‡äº†è§£ K8s éƒ¨ç½²çš„ Nebula Graph é›†ç¾¤çš„ Nebula-Algorithm ä½¿ç”¨æ–¹æ³•ã€‚ ","date":"2022-02-14","objectID":"/nebula-algo-spark-k8s/:0:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","Spark-Connector","Nebula-Algorithm","k8s","nebula-operator"],"title":"ä¸ºä»€ä¹ˆæˆ‘çš„ Nebula-Spark-Connectorã€Nebula-Algorithm è¿ä¸ä¸Š K8s éƒ¨ç½²çš„ Nebula Graph é›†ç¾¤ï¼Ÿ","uri":"/nebula-algo-spark-k8s/#"},{"categories":["Nebula Graph"],"content":" 1 æ­¥éª¤æœ€æ–¹ä¾¿çš„æ–¹æ³•æ˜¯å°† Nebula Algorithm/ Spark è¿è¡Œåœ¨ä¸ Nebula-Operator ç›¸åŒçš„ç½‘ç»œå‘½åç©ºé—´é‡Œï¼Œå°† show hosts meta çš„ MetaD åŸŸå:ç«¯å£ æ ¼å¼çš„åœ°å€å¡«è¿›é…ç½®é‡Œå°±å¯ä»¥äº†ã€‚ æ³¨ï¼šéœ€è¦ 2.6.2 æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬ï¼ŒSpark-Connector/Algorithm æ‰æ”¯æŒåŸŸåå½¢å¼çš„ MetaD åœ°å€ã€‚ è·å– MetaD åœ°å€ (root@nebula) [(none)]\u003e show hosts meta +------------------------------------------------------------------+------+----------+--------+--------------+---------+ | Host | Port | Status | Role | Git Info Sha | Version | +------------------------------------------------------------------+------+----------+--------+--------------+---------+ | \"nebula-metad-0.nebula-metad-headless.default.svc.cluster.local\" | 9559 | \"ONLINE\" | \"META\" | \"d113f4a\" | \"2.6.2\" | +------------------------------------------------------------------+------+----------+--------+--------------+---------+ Got 1 rows (time spent 1378/2598 us) Mon, 14 Feb 2022 08:22:33 UTC å¡«å†™ Algorithm çš„é…ç½®æ–‡ä»¶ Ref: https://github.com/vesoft-inc/nebula-algorithm/blob/master/nebula-algorithm/src/main/resources/application.conf # ... nebula: { # algo's data source from Nebula. If data.source is nebula, then this nebula.read config can be valid. read: { # Nebula metad server address, multiple addresses are split by English comma metaAddress: \"nebula-metad-0.nebula-metad-headless.default.svc.cluster.local:9559\" #... æˆ–è€…æ˜¯è°ƒç”¨ spark-connector çš„ä»£ç  Ref: https://github.com/vesoft-inc/nebula-spark-connector val config = NebulaConnectionConfig .builder() .withMetaAddress(\"nebula-metad-0.nebula-metad-headless.default.svc.cluster.local:9559\") .withConenctionRetry(2) .build() val nebulaReadVertexConfig: ReadNebulaConfig = ReadNebulaConfig .builder() .withSpace(\"foo_bar_space\") .withLabel(\"person\") .withNoColumn(false) .withReturnCols(List(\"birthday\")) .withLimit(10) .withPartitionNum(10) .build() val vertex = spark.read.nebula(config, nebulaReadVertexConfig).loadVerticesToDF() çœ‹èµ·æ¥éå¸¸ç®€å•ï¼Œé‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆç®€å•çš„è¿‡ç¨‹å´å€¼å¾—ä¸€ç¯‡æ–‡ç« å‘¢ï¼Ÿ ","date":"2022-02-14","objectID":"/nebula-algo-spark-k8s/:1:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","Spark-Connector","Nebula-Algorithm","k8s","nebula-operator"],"title":"ä¸ºä»€ä¹ˆæˆ‘çš„ Nebula-Spark-Connectorã€Nebula-Algorithm è¿ä¸ä¸Š K8s éƒ¨ç½²çš„ Nebula Graph é›†ç¾¤ï¼Ÿ","uri":"/nebula-algo-spark-k8s/#æ­¥éª¤"},{"categories":["Nebula Graph"],"content":" 1.1 å®¹æ˜“å¿½ç•¥çš„é—®é¢˜è¿™é‡Œçš„é—®é¢˜åœ¨äºï¼š a. å®ƒéšå«åœ°éœ€è¦ä¿è¯ StorageD çš„åœ°å€èƒ½è¢« spark ç¯å¢ƒè®¿é—®ï¼› b. ä½†æ˜¯è¿™äº› StorageD åœ°å€æ˜¯ä» MetaD è·å–çš„ï¼› c. Nebula K8s Operator é‡Œï¼ŒMetaD ä¸­å­˜å‚¨çš„ StorageD åœ°å€ï¼ˆæœåŠ¡å‘ç°ï¼‰çš„æ¥æºæ˜¯ StorageD çš„é…ç½®æ–‡ä»¶ï¼Œè€Œå®ƒæ˜¯ k8s çš„å†…éƒ¨åœ°å€ã€‚ ","date":"2022-02-14","objectID":"/nebula-algo-spark-k8s/:1:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","Spark-Connector","Nebula-Algorithm","k8s","nebula-operator"],"title":"ä¸ºä»€ä¹ˆæˆ‘çš„ Nebula-Spark-Connectorã€Nebula-Algorithm è¿ä¸ä¸Š K8s éƒ¨ç½²çš„ Nebula Graph é›†ç¾¤ï¼Ÿ","uri":"/nebula-algo-spark-k8s/#å®¹æ˜“å¿½ç•¥çš„é—®é¢˜"},{"categories":["Nebula Graph"],"content":" 1.2 èƒŒæ™¯çŸ¥è¯†a. çš„ç†ç”±æ¯”è¾ƒç›´æ¥ï¼Œå’Œ nebula çš„æ¶æ„æœ‰å…³ï¼šå›¾çš„æ•°æ®éƒ½å­˜åœ¨ Storage Service ä¹‹ä¸­ï¼Œé€šå¸¸ç”¨è¯­å¥çš„æŸ¥è¯¢æ˜¯é€è¿‡ Graph Service æ¥é€ä¼ ï¼Œåªéœ€è¦ GraphD çš„è¿æ¥å°±è¶³å¤Ÿï¼Œè€Œ Spark-Connector ä½¿ç”¨ Nebula Graph çš„åœºæ™¯æ˜¯æ‰«æå…¨å›¾æˆ–è€…å­å›¾ï¼Œè¿™æ—¶å€™è®¡ç®—å­˜å‚¨åˆ†ç¦»çš„è®¾è®¡ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç»•è¿‡æŸ¥è¯¢ã€è®¡ç®—å±‚ç›´æ¥é«˜æ•ˆè¯»å–å›¾æ•°æ®ã€‚ é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆéœ€è¦ã€ä¸”åªéœ€è¦ MetaD çš„åœ°å€å‘¢ï¼Ÿ è¿™ä¹Ÿæ˜¯å’Œæ¶æ„æœ‰å…³ï¼ŒMeta Service é‡ŒåŒ…å«äº†å…¨å›¾çš„åˆ†å¸ƒæ•°æ®ä¸åˆ†å¸ƒå¼çš„ Storage Service çš„å„ä¸ªåˆ†ç‰‡å’Œå®ä¾‹çš„åˆ†å¸ƒï¼Œæ‰€ä»¥ä¸€æ–¹é¢å› ä¸ºåªæœ‰ Meta æ‰æœ‰å…¨å›¾çš„ä¿¡æ¯ï¼ˆéœ€è¦ï¼‰ï¼Œå¦ä¸€æ–¹é¢å› ä¸ºä» Meta å¯ä»¥è·å¾—è¿™éƒ¨åˆ†ä¿¡æ¯ï¼ˆåªéœ€è¦ï¼‰ã€‚åˆ°è¿™é‡Œ b. çš„ç­”æ¡ˆä¹Ÿæœ‰äº†ã€‚ è¯¦ç»†çš„ Nebula Graph æ¶æ„ä¿¡æ¯å¯ä»¥å‚è€ƒåšå®¢ç³»åˆ—æ–‡ç« ï¼šnebula-graph.com.cn/tags/æ¶æ„è®¾è®¡ å¦å¤–è¯·ç¡®ä¿æ‚¨å·²ç»è¯»äº†æ¶æ„ä»‹ç»çš„æ–‡æ¡£å“¦ï¼šNebula æ¶æ„æ€»è§ˆ ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹ c. c. Nebula K8s Operator é‡Œï¼ŒMetaD ä¸­å­˜å‚¨çš„ StorageD åœ°å€ï¼ˆæœåŠ¡å‘ç°ï¼‰çš„æ¥æºæ˜¯ StorageD çš„é…ç½®æ–‡ä»¶ï¼Œè€Œå®ƒæ˜¯ k8s çš„å†…éƒ¨åœ°å€ã€‚ è¿™å’Œ Nebula Graph é‡Œçš„æœåŠ¡å‘ç°æœºåˆ¶æœ‰å…³ï¼šåœ¨ Nebula Graph é›†ç¾¤ä¸­ï¼ŒGraph Service å’Œ Storage Service éƒ½æ˜¯é€šè¿‡å¿ƒè·³å°†è‡ªå·±çš„ä¿¡æ¯ä¸ŠæŠ¥ç»™ Meta Service çš„ï¼Œè€Œè¿™å…¶ä¸­æœåŠ¡è‡ªèº«çš„åœ°å€çš„æ¥æºåˆ™æ¥è‡ªäºä»–ä»¬ç›¸åº”çš„é…ç½®æ–‡ä»¶ä¸­çš„ç½‘ç»œé…ç½®ã€‚ å…³äºæœåŠ¡è‡ªèº«çš„åœ°å€é…ç½®è¯·å‚è€ƒæ–‡æ¡£ï¼šStorage networking é…ç½® å…³äºæœåŠ¡å‘ç°è¯¦ç»†çš„ä¿¡æ¯è¯·å‚è€ƒå››ç‹çš„æ–‡ç« ï¼šå›¾æ•°æ®åº“ Nebula Graph é›†ç¾¤é€šä¿¡ï¼šä»å¿ƒè·³è¯´èµ·ã€‚ æœ€åï¼Œæˆ‘ä»¬çŸ¥é“ Nebula Operator æ˜¯ä¸€ä¸ªåœ¨ K8s é›†ç¾¤ä¸­æŒ‰ç…§é…ç½®ï¼Œè‡ªåŠ¨åˆ›å»ºã€ç»´æŠ¤ã€æ‰©ç¼©å®¹ Nebula é›†ç¾¤çš„ K8s æ§åˆ¶é¢çš„åº”ç”¨ï¼Œå®ƒéœ€è¦æŠ½è±¡ä¸€éƒ¨åˆ†å†…éƒ¨èµ„æºç›¸å…³çš„é…ç½®ï¼Œè¿™å°±åŒ…æ‹¬äº† GraphD å’Œ StorageD å®ä¾‹çš„å®é™…åœ°å€ï¼Œä»–ä»¬æ˜¯è¢«é…ç½®çš„åœ°å€å®é™…ä¸Šæ˜¯ headless service åœ°å€ã€‚ è€Œè¿™äº›åœ°å€ï¼ˆå¦‚ä¸‹ï¼‰é»˜è®¤æ˜¯æ²¡æ³•è¢« k8s å¤–éƒ¨ç½‘ç»œè®¿é—®çš„ï¼Œæ‰€ä»¥é’ˆå¯¹ GraphDã€MetaD æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åˆ›å»ºæœåŠ¡å°†å…¶æš´éœ²å‡ºæ¥ã€‚ (root@nebula) [(none)]\u003e show hosts meta +------------------------------------------------------------------+------+----------+--------+--------------+---------+ | Host | Port | Status | Role | Git Info Sha | Version | +------------------------------------------------------------------+------+----------+--------+--------------+---------+ | \"nebula-metad-0.nebula-metad-headless.default.svc.cluster.local\" | 9559 | \"ONLINE\" | \"META\" | \"d113f4a\" | \"2.6.2\" | +------------------------------------------------------------------+------+----------+--------+--------------+---------+ Got 1 rows (time spent 1378/2598 us) Mon, 14 Feb 2022 09:22:33 UTC (root@nebula) [(none)]\u003e show hosts graph +---------------------------------------------------------------+------+----------+---------+--------------+---------+ | Host | Port | Status | Role | Git Info Sha | Version | +---------------------------------------------------------------+------+----------+---------+--------------+---------+ | \"nebula-graphd-0.nebula-graphd-svc.default.svc.cluster.local\" | 9669 | \"ONLINE\" | \"GRAPH\" | \"d113f4a\" | \"2.6.2\" | +---------------------------------------------------------------+------+----------+---------+--------------+---------+ Got 1 rows (time spent 2072/3403 us) Mon, 14 Feb 2022 10:03:58 UTC (root@nebula) [(none)]\u003e show hosts storage +------------------------------------------------------------------------+------+----------+-----------+--------------+---------+ | Host | Port | Status | Role | Git Info Sha | Version | +------------------------------------------------------------------------+------+----------+-----------+--------------+---------+ | \"nebula-storaged-0.nebula-storaged-headless.default.svc.cluster.local\" | 9779 | \"ONLINE\" | \"STORAGE\" | \"d113f4a\" | \"2.6.2\" | | \"nebula-storaged-1.nebula-storaged-headless.default.svc.cluster.local\" | 9779 | \"ONLINE\" | \"STORAGE\" | \"d113f4a\" | \"2.6.2\" | | \"nebula-storaged-2.nebula-storaged-headless.default.svc.cluster.local\" | 9779 | \"ONLINE\" | \"STORAGE\" | \"d113f4a\" | \"2.6.2\" | +------------------------------------------------------------------------+------+----------+-----------+--------------+---------+ Got 3 rows (time spent 1603/2979 us) Mon, 14 Feb 2022 10:05:24 UTC ç„¶è€Œï¼Œå› ä¸ºå‰è¾¹æåˆ°çš„ Spark-Connector é€šè¿‡ Meta Service å»è·å– StorageD çš„åœ°å€ï¼Œä¸”è¿™ä¸ªåœ°å€æ˜¯æœåŠ¡å‘ç°è€Œå¾—ï¼Œæ‰€ä»¥ Spark-Connector å®é™…ä¸Šè·å–çš„ StorageD åœ°å€å°±æ˜¯ä¸Šè¾¹çš„è¿™ç§ headless çš„æœåŠ¡åœ°å€ï¼Œæ²¡æ³•ç›´æ¥ä»å¤–éƒ¨è®¿é—®ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨æœ‰æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦è®© Spark è¿è¡Œåœ¨å’Œ Nebula Cluster ç›¸åŒçš„ K8s ç½‘ç»œé‡Œï¼Œä¸€åˆ‡å°±è¿åˆƒè€Œè§£äº†ï¼Œå¦åˆ™ï¼Œæˆ‘ä»¬éœ€è¦ï¼š å°† MetaD å’Œ StorageD çš„åœ°å€åˆ©ç”¨ Ingress ç­‰æ–¹å¼å°†å…¶ L4ï¼ˆTCPï¼‰æš´éœ²å‡ºæ¥ã€‚ å¯ä»¥å‚è€ƒ Nebula Operator çš„æ–‡æ¡£ï¼šdoc/user/client_service.md é€šè¿‡åå‘ä»£ç†å’ŒDNSè®©è¿™äº› headless æœåŠ¡èƒ½è¢«è§£æåˆ°ç›¸åº”çš„ StorageDã€‚ å‚è€ƒï¼šTBD é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰æ›´æ–¹ä¾¿çš„æ–¹å¼ï¼Ÿ éå¸¸æŠ±æ­‰çš„æ˜¯ï¼Œç›®å‰æœ€æ–¹ä¾¿çš„æ–¹å¼ä¾ç„¶æ˜¯å¦‚æ–‡ç« æœ€å¼€å¤´æ‰€ä»‹ç»ï¼šè®© Spark è¿è¡Œåœ¨ Nebula Cluster å†…éƒ¨ã€‚å®é™…ä¸Šï¼Œæˆ‘åœ¨åŠªåŠ›æ¨è¿› Nebula Spark ç¤¾åŒºå»æ”¯æŒå¯ä»¥é…ç½®çš„ StorageAddresses é€‰é¡¹ï¼Œæœ‰äº†å®ƒä¹‹åï¼Œå‰è¾¹æåˆ°çš„ 2. å°±æ˜¯ä¸å¿…è¦çš„äº†ã€‚ ","date":"2022-02-14","objectID":"/nebula-algo-spark-k8s/:1:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","Spark-Connector","Nebula-Algorithm","k8s","nebula-operator"],"title":"ä¸ºä»€ä¹ˆæˆ‘çš„ Nebula-Spark-Connectorã€Nebula-Algorithm è¿ä¸ä¸Š K8s éƒ¨ç½²çš„ Nebula Graph é›†ç¾¤ï¼Ÿ","uri":"/nebula-algo-spark-k8s/#èƒŒæ™¯çŸ¥è¯†"},{"categories":["Nebula Graph"],"content":" 2 Bonusï¼šä¸€é”®ä½“éªŒ nebula-algorithm + nebula-operatorä¸ºäº†æ–¹ä¾¿åœ¨ k8s ä¸Šå°é²œ nebula-graph nebula-algorithm çš„åŒå­¦ï¼Œè¿™é‡Œæˆ‘è¦å†æ¬¡å®‰åˆ©ä¸€ä¸‹æˆ‘å†™çš„ä¸€ä¸ªå°å·¥å…· Neubla-Operator-KinDï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸€é”®åœ¨ Docker ç¯å¢ƒå†…éƒ¨å•ç‹¬éƒ¨ç½²ä¸€ä¸ª k8s é›†ç¾¤å¹¶åœ¨å…¶ä¸­éƒ¨ç½² Nebula Operator ä»¥åŠæ‰€æœ‰ä¾èµ–ï¼ˆåŒ…æ‹¬ storage providerï¼‰å¹¶éƒ¨ç½²ä¸€ä¸ªå° Nebula Cluster çš„å·¥å…·ã€‚æœ‰ç‚¹ç»•ï¼Œä¸è¿‡å¯ä»¥çœ‹ä¸‹è¾¹çš„æ­¥éª¤å“ˆï¼š ç¬¬ä¸€æ­¥ï¼Œéƒ¨ç½² K8s+Nebula-Operator+Nebula Clusterï¼š curl -sL nebula-kind.siwei.io/install.sh | bash ç¬¬äºŒæ­¥ï¼Œç…§ç€å·¥å…·æ–‡æ¡£é‡Œçš„ whatâ€™s next a. ç”¨ console è¿æ¥é›†ç¾¤ï¼Œå¹¶åŠ è½½ç¤ºä¾‹æ•°æ®é›† b. åœ¨è¿™ä¸ª k8s é‡Œè·‘ä¸€ä¸ªå›¾ç®—æ³• åˆ›å»ºä¸€ä¸ª Spark ç¯å¢ƒ kubectl create -f http://nebula-kind.siwei.io/deployment/spark.yaml kubectl wait pod --timeout=-1s --for=condition=Ready -l '!job-name' ç­‰ä¸Šè¾¹çš„ wait éƒ½ ready ä¹‹åï¼Œè¿›å…¥ spark çš„ podã€‚ kubectl exec -it deploy/spark-deployment -- bash ä¸‹è½½ nebula-algorithm æ¯”å¦‚ 2.6.2 è¿™ä¸ªç‰ˆæœ¬ï¼Œæ›´å¤šç‰ˆæœ¬è¯·å‚è€ƒ https://github.com/vesoft-inc/nebula-algorithm/ã€‚ æ³¨æ„ï¼š å®˜æ–¹å‘å¸ƒçš„ç‰ˆæœ¬åœ¨è¿™é‡Œå¯ä»¥è·å–ï¼šhttps://repo1.maven.org/maven2/com/vesoft/nebula-algorithm/ å› ä¸ºè¿™ä¸ªé—®é¢˜ https://github.com/vesoft-inc/nebula-algorithm/issues/42 åªæœ‰ 2.6.2 æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬æ‰æ”¯æŒåŸŸåè®¿é—® MetaDã€‚ # ä¸‹è½½ nebula-algorithm-2.6.2.jar wget https://repo1.maven.org/maven2/com/vesoft/nebula-algorithm/2.6.2/nebula-algorithm-2.6.2.jar # ä¸‹è½½ nebula-algorthm é…ç½®æ–‡ä»¶ wget https://github.com/vesoft-inc/nebula-algorithm/raw/v2.6/nebula-algorithm/src/main/resources/application.conf ä¿®æ”¹Then we could change the config file of nebula-algorithm on meta and graph addresses: sed -i '/^ metaAddress/c\\ metaAddress: \\\"nebula-metad-0.nebula-metad-headless.default.svc.cluster.local:9559\\\"' application.conf sed -i '/^ graphAddress/c\\ graphAddress: \\\"nebula-graphd-0.nebula-graphd-svc.default.svc.cluster.local:9669\\\"' application.conf ##### change space sed -i '/^ space/c\\ space: basketballplayer' application.conf ##### read data from nebula graph sed -i '/^ source/c\\ source: nebula' application.conf ##### execute algorithm: labelpropagation sed -i '/^ executeAlgo/c\\ executeAlgo: labelpropagation' application.conf æ‰§è¡Œ LPA ç®—æ³•åœ¨ basketballplayer å›¾ç©ºé—´ /spark/bin/spark-submit --master \"local\" --conf spark.rpc.askTimeout=6000s \\ --class com.vesoft.nebula.algorithm.Main \\ nebula-algorithm-2.6.2.jar \\ -p application.conf ç»“æœå¦‚ä¸‹ï¼š bash-5.0# ls /tmp/count/ _SUCCESS part-00000-5475f9f4-66b9-426b-b0c2-704f946e54d3-c000.csv bash-5.0# head /tmp/count/part-00000-5475f9f4-66b9-426b-b0c2-704f946e54d3-c000.csv _id,lpa 1100,1104 2200,2200 2201,2201 1101,1104 2202,2202 Happy Graphing! Picture Credit: Timelab Pro ","date":"2022-02-14","objectID":"/nebula-algo-spark-k8s/:2:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","Spark-Connector","Nebula-Algorithm","k8s","nebula-operator"],"title":"ä¸ºä»€ä¹ˆæˆ‘çš„ Nebula-Spark-Connectorã€Nebula-Algorithm è¿ä¸ä¸Š K8s éƒ¨ç½²çš„ Nebula Graph é›†ç¾¤ï¼Ÿ","uri":"/nebula-algo-spark-k8s/#bonusä¸€é”®ä½“éªŒ-nebula-algorithm--nebula-operator"},{"categories":["Nebula Graph","Mini Project"],"content":"å¦‚ä½•åˆ©ç”¨å›¾æ•°æ®åº“ä»0-1æ„å»ºä¸€ä¸ªç‰¹å®šé¢†åŸŸé—®ç­”åŠ©æ‰‹ï¼Ÿæœ¬æ–‡æ‰‹æŠŠæ‰‹å¸¦ä½ æ„å»ºä¸€ä¸ªç®€æ˜“ç‰ˆçš„ç¯®çƒé¢†åŸŸæ™ºèƒ½é—®ç­”æœºå™¨äººã€‚","date":"2021-12-30","objectID":"/siwi/","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/"},{"categories":["Nebula Graph","Mini Project"],"content":" å¦‚ä½•åˆ©ç”¨å›¾æ•°æ®åº“ä»0-1æ„å»ºä¸€ä¸ªç‰¹å®šé¢†åŸŸé—®ç­”åŠ©æ‰‹ï¼Ÿæœ¬æ–‡æ‰‹æŠŠæ‰‹å¸¦ä½ æ„å»ºä¸€ä¸ªç®€æ˜“ç‰ˆçš„ç¯®çƒé¢†åŸŸæ™ºèƒ½é—®ç­”æœºå™¨äººã€‚ ","date":"2021-12-30","objectID":"/siwi/:0:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#"},{"categories":["Nebula Graph","Mini Project"],"content":" 1 å‰è¨€ã€Œé—®ç­”æœºå™¨äººã€åœ¨æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­å¹¶ä¸å°‘è§åˆ° ï¼šæ¯”å¦‚åœ¨ä¸€äº›ç”µå•†å®¢æœã€æ™ºèƒ½é—®è¯Šã€æŠ€æœ¯æ”¯æŒç­‰äººå·¥è¾“å…¥ä¸æ²Ÿé€šç•Œé¢çš„åœºæ™¯ä¸‹ï¼Œæœºå™¨äººâ€œæ™ºèƒ½â€é—®ç­”ç³»ç»Ÿä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥åœ¨æ— éœ€äººåŠ›ã€ä¸éœ€è¦è€—è´¹ç»ˆç«¯ç”¨æˆ·å¿ƒæ™ºå»åšçŸ¥è¯†åº“ã€å•†å“æœç´¢ã€ç§‘å®¤é€‰æ‹©ç­‰ç­‰çš„æƒ…å†µä¸‹å®æ—¶ç»™å‡ºé—®é¢˜ç­”æ¡ˆã€‚ é—®ç­”æœºå™¨äººç³»ç»ŸèƒŒåçš„æŠ€æœ¯æœ‰å¤šé‡å¯èƒ½ï¼š åŸºäºæ£€ç´¢ï¼Œå…¨æ–‡æœç´¢æ¥è¿‘çš„é—®é¢˜ åŸºäºæœºå™¨å­¦ä¹ é˜…è¯»ç†è§£ åŸºäºçŸ¥è¯†å›¾è°±ï¼ˆKnowledge-Based Question Answering system: KBQAï¼‰ å…¶ä»– åŸºäºçŸ¥è¯†å›¾è°±æ„å»ºé—®ç­”ç³»ç»Ÿåœ¨ä»¥ä¸‹ä¸‰ä¸ªæƒ…å†µä¸‹å¾ˆæœ‰ä¼˜åŠ¿ï¼š å¯¹äºé¢†åŸŸç±»å‹æ˜¯ç»“æ„åŒ–æ•°æ®åœºæ™¯ï¼šç”µå•†ã€åŒ»è¯ã€ç³»ç»Ÿè¿ç»´ï¼ˆå¾®æœåŠ¡ã€æœåŠ¡å™¨ã€äº‹ä»¶ï¼‰ã€äº§å“æ”¯æŒç³»ç»Ÿç­‰ï¼Œå…¶ä¸­ä½œä¸ºé—®ç­”ç³»ç»Ÿçš„å‚è€ƒå¯¹è±¡å·²ç»æ˜¯ç»“æ„åŒ–æ•°æ®ï¼› é—®é¢˜çš„è§£ç­”è¿‡ç¨‹æ¶‰åŠå¤šè·³æŸ¥è¯¢ï¼Œæ¯”å¦‚â€œå§šæ˜çš„å¦»å­ä»Šå¹´æ˜¯æœ¬å‘½å¹´å—ï¼Ÿâ€ï¼Œâ€œä½ ä»¬å®¶çš„äº§å“ A å’Œ A+ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿâ€ï¼› ä¸ºäº†è§£å†³å…¶ä»–éœ€æ±‚ï¼ˆé£æ§ã€æ¨èã€ç®¡ç†ï¼‰ï¼Œå·²ç»æ„å»ºäº†å›¾ç»“æ„æ•°æ®ã€çŸ¥è¯†å›¾è°±çš„æƒ…å†µã€‚ ä¸ºäº†æ–¹ä¾¿è¯»è€…æœ€å¿«é€Ÿäº†è§£å¦‚ä½•æ„å»º KBQA ç³»ç»Ÿï¼Œæˆ‘å†™äº†éå¸¸ç®€é™‹çš„å° KBQA é¡¹ç›®ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä¼šå¸¦é¢†å¤§å®¶ä»å¤´åˆ°å°¾æŠŠå®ƒæ­èµ·æ¥ã€‚ ğŸ’¡ï¼šè¿™ä¸ªå°é¡¹ç›®å«åš Siwiï¼Œå®ƒçš„ä»£ç å°±åœ¨ GitHub ä¸Šï¼šgithub.com/wey-gu/nebula-siwi Siwi çš„å‘éŸ³æ˜¯ï¼š/ËˆsÉªwi/ æˆ–è€…å«ï¼šæ€äºŒä¸º ï¼Œå®ƒæ˜¯ä¸€ä¸ªèƒ½è§£ç­” NBA ç›¸å…³é—®é¢˜çš„æœºå™¨äººã€‚ æˆ‘ä»¬å¼€å§‹å§ã€‚ ","date":"2021-12-30","objectID":"/siwi/:1:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#å‰è¨€"},{"categories":["Nebula Graph","Mini Project"],"content":" 2 é¸Ÿç° TL;DRKBQA ç”¨ä¸€å¥è¯è¯´å°±æ˜¯æŠŠé—®é¢˜è§£æã€è½¬æ¢æˆåœ¨çŸ¥è¯†å›¾è°±ä¸­çš„æŸ¥è¯¢ï¼ŒæŸ¥è¯¢å¾—åˆ°ç»“æœä¹‹åè¿›è¡Œç­›é€‰ã€ç¿»è¯‘æˆç»“æœï¼ˆå¥å­ã€å¡ç‰‡æˆ–è€…ä»»ä½•æ–¹ä¾¿äººç†è§£çš„ç­”æ¡ˆæ ¼å¼ï¼‰ã€‚ ğŸ’¡ï¼šçŸ¥è¯†å›¾è°±çš„æ„å»ºå®é™…ä¸Šæ˜¯éå¸¸é‡è¦çš„è¿‡ç¨‹ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸“æ³¨åœ¨ä¸²èµ·æ¥ KBQA ç³»ç»Ÿçš„éª¨æ¶ï¼Œæˆ‘ä»¬å‡è®¾éœ€æ±‚æ˜¯åŸºäºä¸€ä¸ªå·²ç»æœ‰çš„å›¾è°±ä¹‹ä¸Šï¼Œä¸ºå…¶å¢åŠ ä¸€ä¸ª QA ç³»ç»Ÿã€‚ ã€Œé—®é¢˜åˆ°å›¾è°±æŸ¥è¯¢çš„è½¬æ¢ã€æœ‰ä¸åŒçš„æ–¹æ³•å¯ä»¥å®ç°ã€‚ å¯ä»¥æ˜¯å¯¹è¯­ä¹‰è¿›è¡Œåˆ†æï¼šç†è§£é—®é¢˜çš„æ„å›¾ï¼Œé’ˆå¯¹ä¸åŒæ„å›¾åŒ¹é…æœ€å¯èƒ½çš„é—®é¢˜ç±»å‹ï¼Œä»è€Œæ„å»ºè¿™ä¸ªç±»å‹é—®é¢˜çš„å›¾è°±æŸ¥è¯¢ï¼ŒæŸ¥å¾—ç»“æœï¼› ä¹Ÿå¯ä»¥æ˜¯åŸºäºä¿¡æ¯çš„æŠ½å–ï¼šä»é—®é¢˜ä¸­æŠ½å–ä¸»è¦çš„å®ä½“ï¼Œåœ¨å›¾è°±ä¸­è·å–å®ä½“çš„æ‰€æœ‰çŸ¥è¯†ã€å…³ç³»æ¡ç›®ï¼ˆå­å›¾ï¼‰ï¼Œå†å¯¹ç»“æœæ ¹æ®é—®é¢˜ä¸­çš„çº¦æŸæ¡ä»¶åŒ¹é…ã€æ’åºé€‰æ‹©ç»“æœã€‚ ğŸ’¡ï¼šç¾å›¢æŠ€æœ¯å›¢é˜Ÿåœ¨è¿™ç¯‡æ–‡ç« é‡Œåˆ†äº«äº†ä»–ä»¬çš„çœŸå®ä¸–ç•Œå®è·µï¼Œä¸‹å›¾æ˜¯ç¾å›¢ç»“åˆäº†æœºå™¨å­¦ä¹ å’Œ NLP çš„æ–¹æ¡ˆã€‚ è€Œåœ¨ Siwi é‡Œï¼Œæˆ‘ä»¬ä¸€åˆ‡ä»ç®€ï¼Œå•ç‹¬é€‰æ‹©äº†è¯­ä¹‰åˆ†æè¿™æ¡è·¯ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯éœ€è¦äººä¸ºå»æ ‡æ³¨æˆ–è€…ç¼–ç ä¸€äº›é—®é¢˜ç±»å‹çš„æŸ¥è¯¢æ–¹å¼ï¼Œä½†å®é™…ä¸Šåœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œå°¤å…¶å•ä¸€é¢†åŸŸå›¾è°±çš„åœºæ™¯ä¸‹åè€Œæ˜¯è½»é‡å´æ•ˆæœä¸å·®çš„æ–¹æ¡ˆï¼Œä¹Ÿæ˜¯ä¸€ä¸ªä¾¿äºæ–°æ‰‹ç†è§£ KBQA çš„åˆé€‚çš„å…¥é—¨æ–¹å¼ã€‚ é™¤äº†æ ¸å¿ƒçš„é—®ç­”éƒ¨åˆ†ï¼Œæˆ‘è¿˜ä¸º Siwi å¢åŠ äº†è¯­éŸ³è¯†åˆ«å’Œè¯­éŸ³å›ç­”ï¼ˆæ„Ÿè°¢æµè§ˆå™¨æ¥å£æ ‡å‡†çš„å‘å±•ï¼‰çš„åŠŸèƒ½ï¼Œäºæ˜¯ï¼Œè¿™ä¸ªé¡¹ç›®çš„ç»“æ„å’Œé—®ç­”è°ƒç”¨æµç¨‹å°±æ˜¯è¿™æ ·çš„äº†ï¼šä¸€ä¸ªè¯­éŸ³é—®é¢˜è‡ªä¸Šè€Œä¸‹åˆ†åˆ«ç»è¿‡ä¸‰ä¸ªéƒ¨åˆ†ï¼š åŸºäºç½‘é¡µçš„ Siwi Frontend è¯­éŸ³ã€æ–‡å­—é—®ç­”ç•Œé¢ Python Flask å®ç°çš„ Siwi Backend/API ç³»ç»Ÿ Nebula Graph å¼€æºåˆ†å¸ƒå¼é«˜æ€§èƒ½å›¾æ•°æ®åº“ä¹‹ä¸Šçš„çŸ¥è¯†å›¾è°± â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ Speech â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Frontend â”‚ Siwi, /ËˆsÉªwi/ â”‚ â”‚ â”‚ Web_Speech_API â”‚ A PoC of â”‚ â”‚ â”‚ â”‚ Dialog System â”‚ â”‚ â”‚ Vue.JS â”‚ With Graph Database â”‚ â”‚ â”‚ â”‚ Backed Knowledge Graph â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Sentence â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ Backend â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ Web API, Flask â”‚ ./app/ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ Sentence ./bot/ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ Intent matching, â”‚ ./bot/classifierâ”‚ â”‚ â”‚ â”‚ â”‚ Symentic Processing â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ Intent, Entities â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ Intent Actor â”‚ ./bot/actions â”‚ â”‚ â”‚ â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Graph Query â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Graph Database â”‚ Nebula Graph â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ğŸ’¡ï¼šå›¾æ•°æ®åº“ç›¸æ¯”äºå…¶ä»–çŸ¥è¯†å›¾è°±å­˜å‚¨ç³»ç»Ÿæ¥è¯´ï¼Œå› ä¸ºå…¶è®¾è®¡ä¸“æ³¨äºæ•°æ®å†…çš„æ•°æ®å…³ç³»ï¼Œéå¸¸æ“…é•¿å®æ—¶è·å–æµ·é‡æ•°æ®ä¸‹å®ä½“ä¹‹é—´çš„å¤æ‚å…³è”å…³ç³»ã€‚ Nebula Graph çš„åŸç”Ÿåˆ†å¸ƒå¼è®¾è®¡å’Œ share-nothing æ¶æ„ä½¿å¾—å®ƒæ“…é•¿äºå·¨å¤§æ•°æ®é‡å’Œé«˜å¹¶å‘è¯»å†™çš„åœºæ™¯ï¼ŒåŠ ä¸Šå®ƒçš„å¼€æºç¤¾åŒºç‰¹åˆ«æ´»è·ƒï¼Œå·²ç»è¢«å›½å†…å¾ˆå¤šå›¢é˜Ÿç”¨äºæ”¯æ’‘ç”Ÿäº§ä¸Šçš„å„ç§ä¸šåŠ¡ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä»–ä»¬åˆ†äº«çš„é€‰å‹ã€è½åœ°å®è·µã€‚ ","date":"2021-12-30","objectID":"/siwi/:2:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#é¸Ÿç°-tldr"},{"categories":["Nebula Graph","Mini Project"],"content":" 3 çŸ¥è¯†å›¾è°±Siwi æ„å»ºäºä¸€ä¸ªç¯®çƒç›¸å…³çš„çŸ¥è¯†å›¾è°±ä¹‹ä¸Šï¼Œå®ƒå…¶å®æ˜¯ Siwi é‡‡ç”¨çš„å¼€æºåˆ†å¸ƒå¼å›¾æ•°æ®åº“ Nebula Graph ç¤¾åŒºçš„å®˜æ–¹æ–‡æ¡£é‡Œçš„ç¤ºä¾‹æ•°æ®é›†ã€‚ åœ¨è¿™ä¸ªéå¸¸ç®€å•çš„å›¾è°±ä¹‹ä¸­ï¼Œåªæœ‰ä¸¤ç§ç‚¹ï¼š playerï¼Œçƒå‘˜ teamï¼Œçƒé˜Ÿ ä¸¤ç§å…³ç³»ï¼š serve æœå½¹äºï¼ˆæ¯”å¦‚ï¼šå§šæ˜ -æœå½¹äº-\u003e ä¼‘æ–¯é¡¿ç«ç®­ï¼‰ follow å…³æ³¨ ï¼ˆæ¯”å¦‚ï¼šå§šæ˜ -å…³æ³¨-\u003e å¥¥å°¼å°”ï¼‰ ğŸ’¡ï¼šè¿™ä¸ªæ•°æ®é›†åœ¨ Nebula ç¤¾åŒºä¸Šæœ‰ä¸€ä¸ª åœ¨çº¿ä½“éªŒ ç¯å¢ƒï¼Œä»»ä½•äººéƒ½æ— éœ€ç™»å½•ï¼Œé€šè¿‡Nebula Graph Studio å¯è§†åŒ–æ¢ç´¢ç¯®çƒå›¾è°±ã€‚ ä¸‹å›¾å°±æ˜¯è¿™ä¸ªå›¾è°±çš„å¯è§†åŒ–æ¢ç´¢æˆªå›¾ï¼Œå¯ä»¥çœ‹åˆ°å·¦è¾¹çš„ä¸­å¿ƒèŠ‚ç‚¹å‹‡å£«é˜Ÿï¼ˆWarriorsï¼‰æœ‰æœå…°ç‰¹ï¼ˆDurantï¼‰è¿˜æœ‰å…¶ä»–å‡ ä¸ªé˜Ÿå‘˜åœ¨å…¶ä¸­æœå½¹ï¼ˆserveï¼‰ï¼›é™¤äº†æœå½¹ä¹‹å¤–ï¼Œè¿˜å¯ä»¥çœ‹åˆ°é˜Ÿå‘˜å’Œé˜Ÿå‘˜ä¹‹ä¸­ä¹Ÿæœ‰å…³æ³¨ï¼ˆfollowï¼‰çš„å…³ç³»å­˜åœ¨ã€‚ æœ‰äº†è¿™ä¸ªçŸ¥è¯†å›¾è°±ï¼Œå’±ä»¬æ¥ä¸‹æ¥å°±åœ¨å®ƒä¹‹ä¸Šæ­ä¸€ä¸ªç®€å•çš„åŸºäºè¯­æ³•è§£æçš„ QA ç³»ç»Ÿå§ğŸ˜ã€‚ ","date":"2021-12-30","objectID":"/siwi/:3:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#çŸ¥è¯†å›¾è°±"},{"categories":["Nebula Graph","Mini Project"],"content":" 4 Siwi-backend â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ Backend â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Web API, Flask â”‚ ./app/ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Sentence ./bot/ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent matching, â”‚ ./bot/classifierâ”‚ â”‚ â”‚ Symentic Processing â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Intent, Entities â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent Actor â”‚ ./bot/actions â”‚ â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ Graph Query â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Graph Database â”‚ Nebula Graph â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å¦‚ä¸Šå›¾çš„è®¾è®¡æµç¨‹ï¼ŒSiwi çš„åç«¯éƒ¨åˆ†éœ€è¦æ¥æ”¶é—®å¥ï¼Œå¤„ç†ä¹‹åè®¿é—®çŸ¥è¯†å›¾è°±ï¼ˆå›¾æ•°æ®åº“ï¼‰ï¼Œç„¶åå°†å¤„ç†ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚ ","date":"2021-12-30","objectID":"/siwi/:4:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#siwi-backend"},{"categories":["Nebula Graph","Mini Project"],"content":" 4.1 æ¥æ”¶ HTTP è¯·æ±‚(app)å¯¹äºè¯·æ±‚ï¼Œå°±ç®€å•åœ°ç”¨ Flask ä½œä¸º web server æ¥æ¥æ”¶ HTTP çš„ POST è¯·æ±‚ï¼š ğŸ’¡ï¼šè¿˜ä¸ç†Ÿæ‚‰ Flask çš„åŒå­¦ï¼Œå¯ä»¥åœ¨ freeCodeCamp ä¸Šæœç´¢ä¸€ä¸‹ï¼Œæœ‰ä¸€äº›ä¸é”™çš„è¯¾ç¨‹å“ˆã€‚ ä¸‹è¾¹çš„ä»£ç å°±æ˜¯å‘Šè¯‰ Flask ï¼š å¦‚æœç”¨æˆ·å‘è¿‡æ¥ http://\u003cserver\u003e/query çš„ POST è¯·æ±‚ï¼Œæçš„é—®é¢˜å°±åœ¨è¯·æ±‚çš„ body é‡Œçš„ question çš„ Key ä¹‹ä¸‹ã€‚ å–å¾—é—®é¢˜ä¹‹åï¼Œè°ƒç”¨æŠŠè¯·æ±‚ä¼ ç»™ siwi_bot çš„ query()ï¼Œå¾—åˆ° answer ã€‚ ä»£ç æ®µï¼šsrc/siwi/app/__init__.py #... from siwi.bot import bot #... @app.route(\"/query\", methods=[\"POST\"]) def query(): request_data = request.get_json() question = request_data.get(\"question\", \"\") # \u003c----- 1. if question: answer = siwi_bot.query( request_data.get(\"question\", \"\")) # \u003c----- 2. else: answer = \"Sorry, what did you say?\" return jsonify({\"answer\": answer}) æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç° siwi_botï¼ŒçœŸæ­£å¤„ç†æé—®çš„é€»è¾‘ã€‚ ","date":"2021-12-30","objectID":"/siwi/:4:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#æ¥æ”¶-http-è¯·æ±‚app"},{"categories":["Nebula Graph","Mini Project"],"content":" 4.2 å¤„ç†è¯·æ±‚(bot) â”‚ â”‚ Sentence ./bot/ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent matching, â”‚ ./bot/classifierâ”‚ â”‚ â”‚ Symentic Processing â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Intent, Entities â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent Actor â”‚ ./bot/actions â”‚ â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å‰è¾¹æåˆ°è¿‡ï¼ŒKBQA åŸºæœ¬ä¸Šæ˜¯ a. æŠŠé—®é¢˜è§£æã€è½¬æ¢æˆåœ¨çŸ¥è¯†å›¾è°±ä¸­çš„æŸ¥è¯¢ b. æŸ¥è¯¢å¾—åˆ°ç»“æœä¹‹åè¿›è¡Œç­›é€‰ã€ç¿»è¯‘æˆç»“æœ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ a. çš„é€»è¾‘æ”¾åœ¨ classifier é‡Œï¼Œb. çš„é€»è¾‘æ”¾åœ¨ actions(actor) é‡Œã€‚ a. HTTP è¯·æ±‚çš„é—®é¢˜å¥å­ sentence ä¼ è¿‡æ¥ï¼Œç”¨ classifier è§£æå®ƒçš„æ„å›¾å’Œå¥å­å®ä½“ b. ç”¨æ„å›¾å’Œå¥å­å®ä½“æ„é€  actionï¼Œå¹¶é“¾æ¥å›¾æ•°æ®åº“æ‰§è¡Œï¼Œè·å–ç»“æœã€‚ ä»£ç æ®µï¼šsrc/siwi/bot/bot/__init__.py from siwi.bot.actions import SiwiActions from siwi.bot.classifier import SiwiClassifier class SiwiBot(): def __init__(self, connection_pool) -\u003e None: self.classifier = SiwiClassifier() self.actions = SiwiActions() self.connection_pool = connection_pool def query(self, sentence): intent = self.classifier.get(sentence) # \u003c--- a. action = self.actions.get(intent) # \u003c--- b. return action.execute(self.connection_pool) é¦–å…ˆå’±ä»¬æ¥è¿›ä¸€æ­¥å®ç°ä¸€ä¸‹ SiwiClassifier å§ã€‚ 4.2.1 è¯­ä¹‰è§£æ(classifier)classifier éœ€è¦åœ¨ get(sentence) æ–¹æ³•é‡Œå°†å¥å­ä¸­çš„å®ä½“å’Œå¥å­çš„æ„å›¾è§£æã€åˆ†ç±»å‡ºæ¥ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™é‡Œæ˜¯éœ€è¦å€ŸåŠ©æœºå™¨å­¦ä¹ ã€NLPå»åˆ†è¯ã€åˆ†ç±»å®ç°çš„ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†å±•ç¤ºè¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šåªæ˜¯å„ç§ if/ elseã€‚ æˆ‘ä»¬è¿™é‡Œå®ç°äº†ä¸‰ç±»æ„å›¾çš„é—®é¢˜ï¼š å…³ç³»ï¼ˆAï¼ŒBï¼‰ï¼šè·å¾— A å’Œ B åœ¨å›¾è°±ä¸­çš„å…³ç³»è·¯å¾„ï¼Œæ¯”å¦‚å§šæ˜å’Œæ¹–äººé˜Ÿçš„å…³ç³»æ˜¯ï¼Ÿ æœå½¹æƒ…å†µï¼šæ¯”å¦‚ä¹”çº³æ£®åœ¨å“ªé‡Œæœå½¹ï¼Ÿ å…³æ³¨æƒ…å†µï¼šæ¯”å¦‚é‚“è‚¯å…³æ³¨äº†è°ï¼Ÿ â“ å¼€æ”¾é—®é¢˜ï¼š å¦‚æœçœ‹æ•™ç¨‹çš„ä½ è§‰å¾—è¿™å‡ ä¸ªé—®é¢˜å¤ªæ²¡æ„æ€äº†ï¼Œè¿™é‡Œç•™ä¸€ä¸ªå¼€æ”¾é—®é¢˜ï¼Œä½ å¯ä»¥åœ¨ Siwi é‡Œå¸®æˆ‘ä»¬å®ç°ï¼šã€Œå…±åŒå¥½å‹ï¼ˆAï¼ŒBï¼‰è·å¾— A å’Œ B çš„ä¸€åº¦å…±åŒå¥½å‹ã€è¿™ä¸ªæ„å›¾ï¼ˆæˆ–è€…æ›´é…·çš„å…¶ä»–å¥å­ï¼‰ä¹ˆï¼Ÿæ¬¢è¿æ¥ Githubï¼šgithub.com/wey-gu/nebula-siwi/ æ PR å“¦ï¼Œçœ‹çœ‹è°å…ˆå®ç°ã€‚ ä»£ç ç‰‡æ®µï¼šsrc/siwi/bot/classfier/__init__.py class SiwiClassifier(): def get(self, sentence: str) -\u003e dict: \"\"\" Classify Sentences and Fill Slots. This should be done by NLP, here we fake one to demostrate the intent Actor --\u003e Graph DB work flow. sentense: relation: - What is the relationship between Yao Ming and Lakers? - How does Tracy McGrady and Lakers connected? serving: - Which team had Jonathon Simmons served? friendship: - Whom does Tim Duncan follow? - Who are Tracy McGrady's friends? returns: { \"entities\": entities, \"intents\": intents } \"\"\" entities = self.get_matched_entities(sentence) intents = self.get_matched_intents(sentence) return { \"entities\": entities, \"intents\": intents } è¿™é‡Œï¼Œæˆ‘æŠŠåŒ¹é…çš„è§„åˆ™ï¼ˆç­‰ä»·äº if elseâ€¦ï¼‰å†™åœ¨äº† src/siwi/bot/test/data ä¹‹ä¸‹çš„ YAML æ–‡ä»¶é‡Œï¼Œè¿™æ ·å¢åŠ  classifier ä¹‹ä¸­æ–°çš„è§„åˆ™åªéœ€è¦æ›´æ–°è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†ï¼š 4.2.1.1 æ„å›¾è¯†åˆ«(intent) def load_entity_data(self) -\u003e None: # load data from yaml files module_path = f\"{ siwi.__path__[0] }/bot/test/data\" #... with open(f\"{ module_path }/intents.yaml\", \"r\") as file: self.intents = yaml.safe_load(file)[\"intents\"] å¯¹äºæ¯ä¸€ä¸ªæ„å›¾æ¥è¯´ï¼š intents.\u003cåå­—\u003e ä»£è¡¨åå­— åå­—ä¹‹åçš„ action ä»£è¡¨åè¾¹åœ¨è¦å®ç°çš„ç›¸åº”çš„ xxxAction çš„ç±» æ¯”å¦‚ RelationshipAction å°†æ˜¯ç”¨æ¥å¤„ç†æŸ¥è¯¢å…³ç³»ï¼ˆAï¼ŒBï¼‰è¿™æ ·çš„é—®é¢˜çš„ Action ç±» keywords ä»£è¡¨åœ¨å¥å­ä¹‹ä¸­åŒ¹é…çš„å…³é”®è¯ æ¯”å¦‚é—®å¥é‡Œå‡ºç° serveï¼Œservedï¼Œserving çš„å­—çœ¼çš„æ—¶å€™ï¼Œå°†ä¼šåŒ¹é…æœå½¹çš„é—®é¢˜ ğŸ’¡ï¼šå†™ if else æ¡ä»¶æ¥å¯¹åº”æ„å›¾æ˜¯ä¸å®¹æ˜“çš„ï¼Œå› ä¸ºä¸åŒæ„å›¾ä¸å¯èƒ½æ²¡æœ‰å…³é”®è¯ç›¸äº¤çš„æƒ…å†µï¼Œæˆ‘ä»¬çš„å®ç°åªæ˜¯ä¸€ä¸ªéå¸¸ç®€é™‹ã€ä¸ä¸¥è°¨çš„æ–¹å¼ã€‚åœ¨å®é™…åœºæ™¯ä¸‹ï¼Œè®­ç»ƒæ¨¡å‹å»åšåŒ¹é…æ•ˆæœä¼šæ›´å¥½ï¼Œæœ‰æ„æ€çš„æ˜¯ï¼Œé‚£äº›åšçš„æ¯”è¾ƒå¥½çš„æ¨¡å‹çš„è¾“å…¥å’Œæˆ‘ä»¬çš„ YAML çš„æ ¼å¼æ˜¯å¾ˆç±»ä¼¼çš„ã€‚ --- intents: fallback: action: FallbackAction keywords: [] relationship: action: RelationshipAction keywords: - between - relation - relationship - related - connect - correlate serve: action: ServeAction keywords: - serve - served - serving friend: action: FollowAction keywords: - follows - followed - follow - friend - friends 4.2.1.2 å®ä½“è¯†åˆ«(entity)ç±»ä¼¼çš„ï¼Œå®ä½“è¯†åˆ«çš„éƒ¨åˆ†æœ¬è´¨ä¸Šä¹Ÿæ˜¯ if elseï¼Œåªä¸è¿‡è¿™é‡Œåˆ©ç”¨åˆ°äº†**Ahoâ€“Corasickç®—æ³•**æ¥å¸®åŠ©æœç´¢å®ä½“ï¼Œåœ¨ç”Ÿäº§ï¼ˆéç©å…·ï¼‰çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ç”¨ NLP é‡Œçš„åˆ†è¯çš„æ–¹æ³•æ¥åšã€‚ ğŸ’¡ï¼šå¤§å®¶å¯ä»¥å»äº†è§£ä¸€ä¸‹è¿™ä¸ª ACè‡ªåŠ¨æœºç®—æ³• def setup_entity_tree(self) -\u003e None: self.entity_type_map.update({ key: \"player\" for key in self.players.keys() }) self.entity_type_map.update({ key: \"team\" for key in self.teams.keys() }) self.entity_tree = ahocorasick.Automaton() for index, entity in enumerate(self.entity_type_map.keys()): self.entity_tree.add_word(entity, (index, entity)) self.entity_tree.make_automaton() #... def get_matched_entities(self, sentence: str) -\u003e dict: \"\"\" Consume a sentence to be matched with ahocorasick Returns a dict: {entity: entity_type} \"\"\" _matched = [] for item in self.entity_tree.iter(sentence): entities_matched.append(item[1][1]) return { entity: self.entity_type_map[entity] for entity in _matched } è‡³æ­¤ï¼Œæˆ‘ä»¬çš„ SiwiClassifier.get(sentence) å·²ç»èƒ½è¿”å›è§£æã€åˆ†ç±»å‡ºæ¥çš„æ„å›¾å’Œå®ä½“äº†ï¼Œè¿™æ—¶å€™ï¼Œå®ƒä»¬ä¼šè¢«ä¼ ç»™ Actions æ¥è®© siwi bot çŸ¥é“å¦‚ä½•å»æ‰§è¡ŒçŸ¥è¯†å›¾è°±çš„æŸ¥è¯¢å•¦ï¼ 4.2.2 æ„é€ å›¾è°±æŸ¥è¯¢","date":"2021-12-30","objectID":"/siwi/:4:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#å¤„ç†è¯·æ±‚bot"},{"categories":["Nebula Graph","Mini Project"],"content":" 4.2 å¤„ç†è¯·æ±‚(bot) â”‚ â”‚ Sentence ./bot/ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent matching, â”‚ ./bot/classifierâ”‚ â”‚ â”‚ Symentic Processing â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Intent, Entities â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent Actor â”‚ ./bot/actions â”‚ â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å‰è¾¹æåˆ°è¿‡ï¼ŒKBQA åŸºæœ¬ä¸Šæ˜¯ a. æŠŠé—®é¢˜è§£æã€è½¬æ¢æˆåœ¨çŸ¥è¯†å›¾è°±ä¸­çš„æŸ¥è¯¢ b. æŸ¥è¯¢å¾—åˆ°ç»“æœä¹‹åè¿›è¡Œç­›é€‰ã€ç¿»è¯‘æˆç»“æœ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ a. çš„é€»è¾‘æ”¾åœ¨ classifier é‡Œï¼Œb. çš„é€»è¾‘æ”¾åœ¨ actions(actor) é‡Œã€‚ a. HTTP è¯·æ±‚çš„é—®é¢˜å¥å­ sentence ä¼ è¿‡æ¥ï¼Œç”¨ classifier è§£æå®ƒçš„æ„å›¾å’Œå¥å­å®ä½“ b. ç”¨æ„å›¾å’Œå¥å­å®ä½“æ„é€  actionï¼Œå¹¶é“¾æ¥å›¾æ•°æ®åº“æ‰§è¡Œï¼Œè·å–ç»“æœã€‚ ä»£ç æ®µï¼šsrc/siwi/bot/bot/__init__.py from siwi.bot.actions import SiwiActions from siwi.bot.classifier import SiwiClassifier class SiwiBot(): def __init__(self, connection_pool) -\u003e None: self.classifier = SiwiClassifier() self.actions = SiwiActions() self.connection_pool = connection_pool def query(self, sentence): intent = self.classifier.get(sentence) # \u003c--- a. action = self.actions.get(intent) # \u003c--- b. return action.execute(self.connection_pool) é¦–å…ˆå’±ä»¬æ¥è¿›ä¸€æ­¥å®ç°ä¸€ä¸‹ SiwiClassifier å§ã€‚ 4.2.1 è¯­ä¹‰è§£æ(classifier)classifier éœ€è¦åœ¨ get(sentence) æ–¹æ³•é‡Œå°†å¥å­ä¸­çš„å®ä½“å’Œå¥å­çš„æ„å›¾è§£æã€åˆ†ç±»å‡ºæ¥ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™é‡Œæ˜¯éœ€è¦å€ŸåŠ©æœºå™¨å­¦ä¹ ã€NLPå»åˆ†è¯ã€åˆ†ç±»å®ç°çš„ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†å±•ç¤ºè¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šåªæ˜¯å„ç§ if/ elseã€‚ æˆ‘ä»¬è¿™é‡Œå®ç°äº†ä¸‰ç±»æ„å›¾çš„é—®é¢˜ï¼š å…³ç³»ï¼ˆAï¼ŒBï¼‰ï¼šè·å¾— A å’Œ B åœ¨å›¾è°±ä¸­çš„å…³ç³»è·¯å¾„ï¼Œæ¯”å¦‚å§šæ˜å’Œæ¹–äººé˜Ÿçš„å…³ç³»æ˜¯ï¼Ÿ æœå½¹æƒ…å†µï¼šæ¯”å¦‚ä¹”çº³æ£®åœ¨å“ªé‡Œæœå½¹ï¼Ÿ å…³æ³¨æƒ…å†µï¼šæ¯”å¦‚é‚“è‚¯å…³æ³¨äº†è°ï¼Ÿ â“ å¼€æ”¾é—®é¢˜ï¼š å¦‚æœçœ‹æ•™ç¨‹çš„ä½ è§‰å¾—è¿™å‡ ä¸ªé—®é¢˜å¤ªæ²¡æ„æ€äº†ï¼Œè¿™é‡Œç•™ä¸€ä¸ªå¼€æ”¾é—®é¢˜ï¼Œä½ å¯ä»¥åœ¨ Siwi é‡Œå¸®æˆ‘ä»¬å®ç°ï¼šã€Œå…±åŒå¥½å‹ï¼ˆAï¼ŒBï¼‰è·å¾— A å’Œ B çš„ä¸€åº¦å…±åŒå¥½å‹ã€è¿™ä¸ªæ„å›¾ï¼ˆæˆ–è€…æ›´é…·çš„å…¶ä»–å¥å­ï¼‰ä¹ˆï¼Ÿæ¬¢è¿æ¥ Githubï¼šgithub.com/wey-gu/nebula-siwi/ æ PR å“¦ï¼Œçœ‹çœ‹è°å…ˆå®ç°ã€‚ ä»£ç ç‰‡æ®µï¼šsrc/siwi/bot/classfier/__init__.py class SiwiClassifier(): def get(self, sentence: str) -\u003e dict: \"\"\" Classify Sentences and Fill Slots. This should be done by NLP, here we fake one to demostrate the intent Actor --\u003e Graph DB work flow. sentense: relation: - What is the relationship between Yao Ming and Lakers? - How does Tracy McGrady and Lakers connected? serving: - Which team had Jonathon Simmons served? friendship: - Whom does Tim Duncan follow? - Who are Tracy McGrady's friends? returns: { \"entities\": entities, \"intents\": intents } \"\"\" entities = self.get_matched_entities(sentence) intents = self.get_matched_intents(sentence) return { \"entities\": entities, \"intents\": intents } è¿™é‡Œï¼Œæˆ‘æŠŠåŒ¹é…çš„è§„åˆ™ï¼ˆç­‰ä»·äº if elseâ€¦ï¼‰å†™åœ¨äº† src/siwi/bot/test/data ä¹‹ä¸‹çš„ YAML æ–‡ä»¶é‡Œï¼Œè¿™æ ·å¢åŠ  classifier ä¹‹ä¸­æ–°çš„è§„åˆ™åªéœ€è¦æ›´æ–°è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†ï¼š 4.2.1.1 æ„å›¾è¯†åˆ«(intent) def load_entity_data(self) -\u003e None: # load data from yaml files module_path = f\"{ siwi.__path__[0] }/bot/test/data\" #... with open(f\"{ module_path }/intents.yaml\", \"r\") as file: self.intents = yaml.safe_load(file)[\"intents\"] å¯¹äºæ¯ä¸€ä¸ªæ„å›¾æ¥è¯´ï¼š intents.\u003cåå­—\u003e ä»£è¡¨åå­— åå­—ä¹‹åçš„ action ä»£è¡¨åè¾¹åœ¨è¦å®ç°çš„ç›¸åº”çš„ xxxAction çš„ç±» æ¯”å¦‚ RelationshipAction å°†æ˜¯ç”¨æ¥å¤„ç†æŸ¥è¯¢å…³ç³»ï¼ˆAï¼ŒBï¼‰è¿™æ ·çš„é—®é¢˜çš„ Action ç±» keywords ä»£è¡¨åœ¨å¥å­ä¹‹ä¸­åŒ¹é…çš„å…³é”®è¯ æ¯”å¦‚é—®å¥é‡Œå‡ºç° serveï¼Œservedï¼Œserving çš„å­—çœ¼çš„æ—¶å€™ï¼Œå°†ä¼šåŒ¹é…æœå½¹çš„é—®é¢˜ ğŸ’¡ï¼šå†™ if else æ¡ä»¶æ¥å¯¹åº”æ„å›¾æ˜¯ä¸å®¹æ˜“çš„ï¼Œå› ä¸ºä¸åŒæ„å›¾ä¸å¯èƒ½æ²¡æœ‰å…³é”®è¯ç›¸äº¤çš„æƒ…å†µï¼Œæˆ‘ä»¬çš„å®ç°åªæ˜¯ä¸€ä¸ªéå¸¸ç®€é™‹ã€ä¸ä¸¥è°¨çš„æ–¹å¼ã€‚åœ¨å®é™…åœºæ™¯ä¸‹ï¼Œè®­ç»ƒæ¨¡å‹å»åšåŒ¹é…æ•ˆæœä¼šæ›´å¥½ï¼Œæœ‰æ„æ€çš„æ˜¯ï¼Œé‚£äº›åšçš„æ¯”è¾ƒå¥½çš„æ¨¡å‹çš„è¾“å…¥å’Œæˆ‘ä»¬çš„ YAML çš„æ ¼å¼æ˜¯å¾ˆç±»ä¼¼çš„ã€‚ --- intents: fallback: action: FallbackAction keywords: [] relationship: action: RelationshipAction keywords: - between - relation - relationship - related - connect - correlate serve: action: ServeAction keywords: - serve - served - serving friend: action: FollowAction keywords: - follows - followed - follow - friend - friends 4.2.1.2 å®ä½“è¯†åˆ«(entity)ç±»ä¼¼çš„ï¼Œå®ä½“è¯†åˆ«çš„éƒ¨åˆ†æœ¬è´¨ä¸Šä¹Ÿæ˜¯ if elseï¼Œåªä¸è¿‡è¿™é‡Œåˆ©ç”¨åˆ°äº†**Ahoâ€“Corasickç®—æ³•**æ¥å¸®åŠ©æœç´¢å®ä½“ï¼Œåœ¨ç”Ÿäº§ï¼ˆéç©å…·ï¼‰çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ç”¨ NLP é‡Œçš„åˆ†è¯çš„æ–¹æ³•æ¥åšã€‚ ğŸ’¡ï¼šå¤§å®¶å¯ä»¥å»äº†è§£ä¸€ä¸‹è¿™ä¸ª ACè‡ªåŠ¨æœºç®—æ³• def setup_entity_tree(self) -\u003e None: self.entity_type_map.update({ key: \"player\" for key in self.players.keys() }) self.entity_type_map.update({ key: \"team\" for key in self.teams.keys() }) self.entity_tree = ahocorasick.Automaton() for index, entity in enumerate(self.entity_type_map.keys()): self.entity_tree.add_word(entity, (index, entity)) self.entity_tree.make_automaton() #... def get_matched_entities(self, sentence: str) -\u003e dict: \"\"\" Consume a sentence to be matched with ahocorasick Returns a dict: {entity: entity_type} \"\"\" _matched = [] for item in self.entity_tree.iter(sentence): entities_matched.append(item[1][1]) return { entity: self.entity_type_map[entity] for entity in _matched } è‡³æ­¤ï¼Œæˆ‘ä»¬çš„ SiwiClassifier.get(sentence) å·²ç»èƒ½è¿”å›è§£æã€åˆ†ç±»å‡ºæ¥çš„æ„å›¾å’Œå®ä½“äº†ï¼Œè¿™æ—¶å€™ï¼Œå®ƒä»¬ä¼šè¢«ä¼ ç»™ Actions æ¥è®© siwi bot çŸ¥é“å¦‚ä½•å»æ‰§è¡ŒçŸ¥è¯†å›¾è°±çš„æŸ¥è¯¢å•¦ï¼ 4.2.2 æ„é€ å›¾è°±æŸ¥è¯¢","date":"2021-12-30","objectID":"/siwi/:4:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#è¯­ä¹‰è§£æclassifier"},{"categories":["Nebula Graph","Mini Project"],"content":" 4.2 å¤„ç†è¯·æ±‚(bot) â”‚ â”‚ Sentence ./bot/ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent matching, â”‚ ./bot/classifierâ”‚ â”‚ â”‚ Symentic Processing â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Intent, Entities â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent Actor â”‚ ./bot/actions â”‚ â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å‰è¾¹æåˆ°è¿‡ï¼ŒKBQA åŸºæœ¬ä¸Šæ˜¯ a. æŠŠé—®é¢˜è§£æã€è½¬æ¢æˆåœ¨çŸ¥è¯†å›¾è°±ä¸­çš„æŸ¥è¯¢ b. æŸ¥è¯¢å¾—åˆ°ç»“æœä¹‹åè¿›è¡Œç­›é€‰ã€ç¿»è¯‘æˆç»“æœ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ a. çš„é€»è¾‘æ”¾åœ¨ classifier é‡Œï¼Œb. çš„é€»è¾‘æ”¾åœ¨ actions(actor) é‡Œã€‚ a. HTTP è¯·æ±‚çš„é—®é¢˜å¥å­ sentence ä¼ è¿‡æ¥ï¼Œç”¨ classifier è§£æå®ƒçš„æ„å›¾å’Œå¥å­å®ä½“ b. ç”¨æ„å›¾å’Œå¥å­å®ä½“æ„é€  actionï¼Œå¹¶é“¾æ¥å›¾æ•°æ®åº“æ‰§è¡Œï¼Œè·å–ç»“æœã€‚ ä»£ç æ®µï¼šsrc/siwi/bot/bot/__init__.py from siwi.bot.actions import SiwiActions from siwi.bot.classifier import SiwiClassifier class SiwiBot(): def __init__(self, connection_pool) -\u003e None: self.classifier = SiwiClassifier() self.actions = SiwiActions() self.connection_pool = connection_pool def query(self, sentence): intent = self.classifier.get(sentence) # \u003c--- a. action = self.actions.get(intent) # \u003c--- b. return action.execute(self.connection_pool) é¦–å…ˆå’±ä»¬æ¥è¿›ä¸€æ­¥å®ç°ä¸€ä¸‹ SiwiClassifier å§ã€‚ 4.2.1 è¯­ä¹‰è§£æ(classifier)classifier éœ€è¦åœ¨ get(sentence) æ–¹æ³•é‡Œå°†å¥å­ä¸­çš„å®ä½“å’Œå¥å­çš„æ„å›¾è§£æã€åˆ†ç±»å‡ºæ¥ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™é‡Œæ˜¯éœ€è¦å€ŸåŠ©æœºå™¨å­¦ä¹ ã€NLPå»åˆ†è¯ã€åˆ†ç±»å®ç°çš„ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†å±•ç¤ºè¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šåªæ˜¯å„ç§ if/ elseã€‚ æˆ‘ä»¬è¿™é‡Œå®ç°äº†ä¸‰ç±»æ„å›¾çš„é—®é¢˜ï¼š å…³ç³»ï¼ˆAï¼ŒBï¼‰ï¼šè·å¾— A å’Œ B åœ¨å›¾è°±ä¸­çš„å…³ç³»è·¯å¾„ï¼Œæ¯”å¦‚å§šæ˜å’Œæ¹–äººé˜Ÿçš„å…³ç³»æ˜¯ï¼Ÿ æœå½¹æƒ…å†µï¼šæ¯”å¦‚ä¹”çº³æ£®åœ¨å“ªé‡Œæœå½¹ï¼Ÿ å…³æ³¨æƒ…å†µï¼šæ¯”å¦‚é‚“è‚¯å…³æ³¨äº†è°ï¼Ÿ â“ å¼€æ”¾é—®é¢˜ï¼š å¦‚æœçœ‹æ•™ç¨‹çš„ä½ è§‰å¾—è¿™å‡ ä¸ªé—®é¢˜å¤ªæ²¡æ„æ€äº†ï¼Œè¿™é‡Œç•™ä¸€ä¸ªå¼€æ”¾é—®é¢˜ï¼Œä½ å¯ä»¥åœ¨ Siwi é‡Œå¸®æˆ‘ä»¬å®ç°ï¼šã€Œå…±åŒå¥½å‹ï¼ˆAï¼ŒBï¼‰è·å¾— A å’Œ B çš„ä¸€åº¦å…±åŒå¥½å‹ã€è¿™ä¸ªæ„å›¾ï¼ˆæˆ–è€…æ›´é…·çš„å…¶ä»–å¥å­ï¼‰ä¹ˆï¼Ÿæ¬¢è¿æ¥ Githubï¼šgithub.com/wey-gu/nebula-siwi/ æ PR å“¦ï¼Œçœ‹çœ‹è°å…ˆå®ç°ã€‚ ä»£ç ç‰‡æ®µï¼šsrc/siwi/bot/classfier/__init__.py class SiwiClassifier(): def get(self, sentence: str) -\u003e dict: \"\"\" Classify Sentences and Fill Slots. This should be done by NLP, here we fake one to demostrate the intent Actor --\u003e Graph DB work flow. sentense: relation: - What is the relationship between Yao Ming and Lakers? - How does Tracy McGrady and Lakers connected? serving: - Which team had Jonathon Simmons served? friendship: - Whom does Tim Duncan follow? - Who are Tracy McGrady's friends? returns: { \"entities\": entities, \"intents\": intents } \"\"\" entities = self.get_matched_entities(sentence) intents = self.get_matched_intents(sentence) return { \"entities\": entities, \"intents\": intents } è¿™é‡Œï¼Œæˆ‘æŠŠåŒ¹é…çš„è§„åˆ™ï¼ˆç­‰ä»·äº if elseâ€¦ï¼‰å†™åœ¨äº† src/siwi/bot/test/data ä¹‹ä¸‹çš„ YAML æ–‡ä»¶é‡Œï¼Œè¿™æ ·å¢åŠ  classifier ä¹‹ä¸­æ–°çš„è§„åˆ™åªéœ€è¦æ›´æ–°è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†ï¼š 4.2.1.1 æ„å›¾è¯†åˆ«(intent) def load_entity_data(self) -\u003e None: # load data from yaml files module_path = f\"{ siwi.__path__[0] }/bot/test/data\" #... with open(f\"{ module_path }/intents.yaml\", \"r\") as file: self.intents = yaml.safe_load(file)[\"intents\"] å¯¹äºæ¯ä¸€ä¸ªæ„å›¾æ¥è¯´ï¼š intents.\u003cåå­—\u003e ä»£è¡¨åå­— åå­—ä¹‹åçš„ action ä»£è¡¨åè¾¹åœ¨è¦å®ç°çš„ç›¸åº”çš„ xxxAction çš„ç±» æ¯”å¦‚ RelationshipAction å°†æ˜¯ç”¨æ¥å¤„ç†æŸ¥è¯¢å…³ç³»ï¼ˆAï¼ŒBï¼‰è¿™æ ·çš„é—®é¢˜çš„ Action ç±» keywords ä»£è¡¨åœ¨å¥å­ä¹‹ä¸­åŒ¹é…çš„å…³é”®è¯ æ¯”å¦‚é—®å¥é‡Œå‡ºç° serveï¼Œservedï¼Œserving çš„å­—çœ¼çš„æ—¶å€™ï¼Œå°†ä¼šåŒ¹é…æœå½¹çš„é—®é¢˜ ğŸ’¡ï¼šå†™ if else æ¡ä»¶æ¥å¯¹åº”æ„å›¾æ˜¯ä¸å®¹æ˜“çš„ï¼Œå› ä¸ºä¸åŒæ„å›¾ä¸å¯èƒ½æ²¡æœ‰å…³é”®è¯ç›¸äº¤çš„æƒ…å†µï¼Œæˆ‘ä»¬çš„å®ç°åªæ˜¯ä¸€ä¸ªéå¸¸ç®€é™‹ã€ä¸ä¸¥è°¨çš„æ–¹å¼ã€‚åœ¨å®é™…åœºæ™¯ä¸‹ï¼Œè®­ç»ƒæ¨¡å‹å»åšåŒ¹é…æ•ˆæœä¼šæ›´å¥½ï¼Œæœ‰æ„æ€çš„æ˜¯ï¼Œé‚£äº›åšçš„æ¯”è¾ƒå¥½çš„æ¨¡å‹çš„è¾“å…¥å’Œæˆ‘ä»¬çš„ YAML çš„æ ¼å¼æ˜¯å¾ˆç±»ä¼¼çš„ã€‚ --- intents: fallback: action: FallbackAction keywords: [] relationship: action: RelationshipAction keywords: - between - relation - relationship - related - connect - correlate serve: action: ServeAction keywords: - serve - served - serving friend: action: FollowAction keywords: - follows - followed - follow - friend - friends 4.2.1.2 å®ä½“è¯†åˆ«(entity)ç±»ä¼¼çš„ï¼Œå®ä½“è¯†åˆ«çš„éƒ¨åˆ†æœ¬è´¨ä¸Šä¹Ÿæ˜¯ if elseï¼Œåªä¸è¿‡è¿™é‡Œåˆ©ç”¨åˆ°äº†**Ahoâ€“Corasickç®—æ³•**æ¥å¸®åŠ©æœç´¢å®ä½“ï¼Œåœ¨ç”Ÿäº§ï¼ˆéç©å…·ï¼‰çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ç”¨ NLP é‡Œçš„åˆ†è¯çš„æ–¹æ³•æ¥åšã€‚ ğŸ’¡ï¼šå¤§å®¶å¯ä»¥å»äº†è§£ä¸€ä¸‹è¿™ä¸ª ACè‡ªåŠ¨æœºç®—æ³• def setup_entity_tree(self) -\u003e None: self.entity_type_map.update({ key: \"player\" for key in self.players.keys() }) self.entity_type_map.update({ key: \"team\" for key in self.teams.keys() }) self.entity_tree = ahocorasick.Automaton() for index, entity in enumerate(self.entity_type_map.keys()): self.entity_tree.add_word(entity, (index, entity)) self.entity_tree.make_automaton() #... def get_matched_entities(self, sentence: str) -\u003e dict: \"\"\" Consume a sentence to be matched with ahocorasick Returns a dict: {entity: entity_type} \"\"\" _matched = [] for item in self.entity_tree.iter(sentence): entities_matched.append(item[1][1]) return { entity: self.entity_type_map[entity] for entity in _matched } è‡³æ­¤ï¼Œæˆ‘ä»¬çš„ SiwiClassifier.get(sentence) å·²ç»èƒ½è¿”å›è§£æã€åˆ†ç±»å‡ºæ¥çš„æ„å›¾å’Œå®ä½“äº†ï¼Œè¿™æ—¶å€™ï¼Œå®ƒä»¬ä¼šè¢«ä¼ ç»™ Actions æ¥è®© siwi bot çŸ¥é“å¦‚ä½•å»æ‰§è¡ŒçŸ¥è¯†å›¾è°±çš„æŸ¥è¯¢å•¦ï¼ 4.2.2 æ„é€ å›¾è°±æŸ¥è¯¢","date":"2021-12-30","objectID":"/siwi/:4:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#æ„å›¾è¯†åˆ«intent"},{"categories":["Nebula Graph","Mini Project"],"content":" 4.2 å¤„ç†è¯·æ±‚(bot) â”‚ â”‚ Sentence ./bot/ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent matching, â”‚ ./bot/classifierâ”‚ â”‚ â”‚ Symentic Processing â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Intent, Entities â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent Actor â”‚ ./bot/actions â”‚ â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å‰è¾¹æåˆ°è¿‡ï¼ŒKBQA åŸºæœ¬ä¸Šæ˜¯ a. æŠŠé—®é¢˜è§£æã€è½¬æ¢æˆåœ¨çŸ¥è¯†å›¾è°±ä¸­çš„æŸ¥è¯¢ b. æŸ¥è¯¢å¾—åˆ°ç»“æœä¹‹åè¿›è¡Œç­›é€‰ã€ç¿»è¯‘æˆç»“æœ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ a. çš„é€»è¾‘æ”¾åœ¨ classifier é‡Œï¼Œb. çš„é€»è¾‘æ”¾åœ¨ actions(actor) é‡Œã€‚ a. HTTP è¯·æ±‚çš„é—®é¢˜å¥å­ sentence ä¼ è¿‡æ¥ï¼Œç”¨ classifier è§£æå®ƒçš„æ„å›¾å’Œå¥å­å®ä½“ b. ç”¨æ„å›¾å’Œå¥å­å®ä½“æ„é€  actionï¼Œå¹¶é“¾æ¥å›¾æ•°æ®åº“æ‰§è¡Œï¼Œè·å–ç»“æœã€‚ ä»£ç æ®µï¼šsrc/siwi/bot/bot/__init__.py from siwi.bot.actions import SiwiActions from siwi.bot.classifier import SiwiClassifier class SiwiBot(): def __init__(self, connection_pool) -\u003e None: self.classifier = SiwiClassifier() self.actions = SiwiActions() self.connection_pool = connection_pool def query(self, sentence): intent = self.classifier.get(sentence) # \u003c--- a. action = self.actions.get(intent) # \u003c--- b. return action.execute(self.connection_pool) é¦–å…ˆå’±ä»¬æ¥è¿›ä¸€æ­¥å®ç°ä¸€ä¸‹ SiwiClassifier å§ã€‚ 4.2.1 è¯­ä¹‰è§£æ(classifier)classifier éœ€è¦åœ¨ get(sentence) æ–¹æ³•é‡Œå°†å¥å­ä¸­çš„å®ä½“å’Œå¥å­çš„æ„å›¾è§£æã€åˆ†ç±»å‡ºæ¥ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™é‡Œæ˜¯éœ€è¦å€ŸåŠ©æœºå™¨å­¦ä¹ ã€NLPå»åˆ†è¯ã€åˆ†ç±»å®ç°çš„ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†å±•ç¤ºè¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šåªæ˜¯å„ç§ if/ elseã€‚ æˆ‘ä»¬è¿™é‡Œå®ç°äº†ä¸‰ç±»æ„å›¾çš„é—®é¢˜ï¼š å…³ç³»ï¼ˆAï¼ŒBï¼‰ï¼šè·å¾— A å’Œ B åœ¨å›¾è°±ä¸­çš„å…³ç³»è·¯å¾„ï¼Œæ¯”å¦‚å§šæ˜å’Œæ¹–äººé˜Ÿçš„å…³ç³»æ˜¯ï¼Ÿ æœå½¹æƒ…å†µï¼šæ¯”å¦‚ä¹”çº³æ£®åœ¨å“ªé‡Œæœå½¹ï¼Ÿ å…³æ³¨æƒ…å†µï¼šæ¯”å¦‚é‚“è‚¯å…³æ³¨äº†è°ï¼Ÿ â“ å¼€æ”¾é—®é¢˜ï¼š å¦‚æœçœ‹æ•™ç¨‹çš„ä½ è§‰å¾—è¿™å‡ ä¸ªé—®é¢˜å¤ªæ²¡æ„æ€äº†ï¼Œè¿™é‡Œç•™ä¸€ä¸ªå¼€æ”¾é—®é¢˜ï¼Œä½ å¯ä»¥åœ¨ Siwi é‡Œå¸®æˆ‘ä»¬å®ç°ï¼šã€Œå…±åŒå¥½å‹ï¼ˆAï¼ŒBï¼‰è·å¾— A å’Œ B çš„ä¸€åº¦å…±åŒå¥½å‹ã€è¿™ä¸ªæ„å›¾ï¼ˆæˆ–è€…æ›´é…·çš„å…¶ä»–å¥å­ï¼‰ä¹ˆï¼Ÿæ¬¢è¿æ¥ Githubï¼šgithub.com/wey-gu/nebula-siwi/ æ PR å“¦ï¼Œçœ‹çœ‹è°å…ˆå®ç°ã€‚ ä»£ç ç‰‡æ®µï¼šsrc/siwi/bot/classfier/__init__.py class SiwiClassifier(): def get(self, sentence: str) -\u003e dict: \"\"\" Classify Sentences and Fill Slots. This should be done by NLP, here we fake one to demostrate the intent Actor --\u003e Graph DB work flow. sentense: relation: - What is the relationship between Yao Ming and Lakers? - How does Tracy McGrady and Lakers connected? serving: - Which team had Jonathon Simmons served? friendship: - Whom does Tim Duncan follow? - Who are Tracy McGrady's friends? returns: { \"entities\": entities, \"intents\": intents } \"\"\" entities = self.get_matched_entities(sentence) intents = self.get_matched_intents(sentence) return { \"entities\": entities, \"intents\": intents } è¿™é‡Œï¼Œæˆ‘æŠŠåŒ¹é…çš„è§„åˆ™ï¼ˆç­‰ä»·äº if elseâ€¦ï¼‰å†™åœ¨äº† src/siwi/bot/test/data ä¹‹ä¸‹çš„ YAML æ–‡ä»¶é‡Œï¼Œè¿™æ ·å¢åŠ  classifier ä¹‹ä¸­æ–°çš„è§„åˆ™åªéœ€è¦æ›´æ–°è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†ï¼š 4.2.1.1 æ„å›¾è¯†åˆ«(intent) def load_entity_data(self) -\u003e None: # load data from yaml files module_path = f\"{ siwi.__path__[0] }/bot/test/data\" #... with open(f\"{ module_path }/intents.yaml\", \"r\") as file: self.intents = yaml.safe_load(file)[\"intents\"] å¯¹äºæ¯ä¸€ä¸ªæ„å›¾æ¥è¯´ï¼š intents.\u003cåå­—\u003e ä»£è¡¨åå­— åå­—ä¹‹åçš„ action ä»£è¡¨åè¾¹åœ¨è¦å®ç°çš„ç›¸åº”çš„ xxxAction çš„ç±» æ¯”å¦‚ RelationshipAction å°†æ˜¯ç”¨æ¥å¤„ç†æŸ¥è¯¢å…³ç³»ï¼ˆAï¼ŒBï¼‰è¿™æ ·çš„é—®é¢˜çš„ Action ç±» keywords ä»£è¡¨åœ¨å¥å­ä¹‹ä¸­åŒ¹é…çš„å…³é”®è¯ æ¯”å¦‚é—®å¥é‡Œå‡ºç° serveï¼Œservedï¼Œserving çš„å­—çœ¼çš„æ—¶å€™ï¼Œå°†ä¼šåŒ¹é…æœå½¹çš„é—®é¢˜ ğŸ’¡ï¼šå†™ if else æ¡ä»¶æ¥å¯¹åº”æ„å›¾æ˜¯ä¸å®¹æ˜“çš„ï¼Œå› ä¸ºä¸åŒæ„å›¾ä¸å¯èƒ½æ²¡æœ‰å…³é”®è¯ç›¸äº¤çš„æƒ…å†µï¼Œæˆ‘ä»¬çš„å®ç°åªæ˜¯ä¸€ä¸ªéå¸¸ç®€é™‹ã€ä¸ä¸¥è°¨çš„æ–¹å¼ã€‚åœ¨å®é™…åœºæ™¯ä¸‹ï¼Œè®­ç»ƒæ¨¡å‹å»åšåŒ¹é…æ•ˆæœä¼šæ›´å¥½ï¼Œæœ‰æ„æ€çš„æ˜¯ï¼Œé‚£äº›åšçš„æ¯”è¾ƒå¥½çš„æ¨¡å‹çš„è¾“å…¥å’Œæˆ‘ä»¬çš„ YAML çš„æ ¼å¼æ˜¯å¾ˆç±»ä¼¼çš„ã€‚ --- intents: fallback: action: FallbackAction keywords: [] relationship: action: RelationshipAction keywords: - between - relation - relationship - related - connect - correlate serve: action: ServeAction keywords: - serve - served - serving friend: action: FollowAction keywords: - follows - followed - follow - friend - friends 4.2.1.2 å®ä½“è¯†åˆ«(entity)ç±»ä¼¼çš„ï¼Œå®ä½“è¯†åˆ«çš„éƒ¨åˆ†æœ¬è´¨ä¸Šä¹Ÿæ˜¯ if elseï¼Œåªä¸è¿‡è¿™é‡Œåˆ©ç”¨åˆ°äº†**Ahoâ€“Corasickç®—æ³•**æ¥å¸®åŠ©æœç´¢å®ä½“ï¼Œåœ¨ç”Ÿäº§ï¼ˆéç©å…·ï¼‰çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ç”¨ NLP é‡Œçš„åˆ†è¯çš„æ–¹æ³•æ¥åšã€‚ ğŸ’¡ï¼šå¤§å®¶å¯ä»¥å»äº†è§£ä¸€ä¸‹è¿™ä¸ª ACè‡ªåŠ¨æœºç®—æ³• def setup_entity_tree(self) -\u003e None: self.entity_type_map.update({ key: \"player\" for key in self.players.keys() }) self.entity_type_map.update({ key: \"team\" for key in self.teams.keys() }) self.entity_tree = ahocorasick.Automaton() for index, entity in enumerate(self.entity_type_map.keys()): self.entity_tree.add_word(entity, (index, entity)) self.entity_tree.make_automaton() #... def get_matched_entities(self, sentence: str) -\u003e dict: \"\"\" Consume a sentence to be matched with ahocorasick Returns a dict: {entity: entity_type} \"\"\" _matched = [] for item in self.entity_tree.iter(sentence): entities_matched.append(item[1][1]) return { entity: self.entity_type_map[entity] for entity in _matched } è‡³æ­¤ï¼Œæˆ‘ä»¬çš„ SiwiClassifier.get(sentence) å·²ç»èƒ½è¿”å›è§£æã€åˆ†ç±»å‡ºæ¥çš„æ„å›¾å’Œå®ä½“äº†ï¼Œè¿™æ—¶å€™ï¼Œå®ƒä»¬ä¼šè¢«ä¼ ç»™ Actions æ¥è®© siwi bot çŸ¥é“å¦‚ä½•å»æ‰§è¡ŒçŸ¥è¯†å›¾è°±çš„æŸ¥è¯¢å•¦ï¼ 4.2.2 æ„é€ å›¾è°±æŸ¥è¯¢","date":"2021-12-30","objectID":"/siwi/:4:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#å®ä½“è¯†åˆ«entity"},{"categories":["Nebula Graph","Mini Project"],"content":" 4.2 å¤„ç†è¯·æ±‚(bot) â”‚ â”‚ Sentence ./bot/ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent matching, â”‚ ./bot/classifierâ”‚ â”‚ â”‚ Symentic Processing â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Intent, Entities â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Intent Actor â”‚ ./bot/actions â”‚ â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å‰è¾¹æåˆ°è¿‡ï¼ŒKBQA åŸºæœ¬ä¸Šæ˜¯ a. æŠŠé—®é¢˜è§£æã€è½¬æ¢æˆåœ¨çŸ¥è¯†å›¾è°±ä¸­çš„æŸ¥è¯¢ b. æŸ¥è¯¢å¾—åˆ°ç»“æœä¹‹åè¿›è¡Œç­›é€‰ã€ç¿»è¯‘æˆç»“æœ è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ a. çš„é€»è¾‘æ”¾åœ¨ classifier é‡Œï¼Œb. çš„é€»è¾‘æ”¾åœ¨ actions(actor) é‡Œã€‚ a. HTTP è¯·æ±‚çš„é—®é¢˜å¥å­ sentence ä¼ è¿‡æ¥ï¼Œç”¨ classifier è§£æå®ƒçš„æ„å›¾å’Œå¥å­å®ä½“ b. ç”¨æ„å›¾å’Œå¥å­å®ä½“æ„é€  actionï¼Œå¹¶é“¾æ¥å›¾æ•°æ®åº“æ‰§è¡Œï¼Œè·å–ç»“æœã€‚ ä»£ç æ®µï¼šsrc/siwi/bot/bot/__init__.py from siwi.bot.actions import SiwiActions from siwi.bot.classifier import SiwiClassifier class SiwiBot(): def __init__(self, connection_pool) -\u003e None: self.classifier = SiwiClassifier() self.actions = SiwiActions() self.connection_pool = connection_pool def query(self, sentence): intent = self.classifier.get(sentence) # \u003c--- a. action = self.actions.get(intent) # \u003c--- b. return action.execute(self.connection_pool) é¦–å…ˆå’±ä»¬æ¥è¿›ä¸€æ­¥å®ç°ä¸€ä¸‹ SiwiClassifier å§ã€‚ 4.2.1 è¯­ä¹‰è§£æ(classifier)classifier éœ€è¦åœ¨ get(sentence) æ–¹æ³•é‡Œå°†å¥å­ä¸­çš„å®ä½“å’Œå¥å­çš„æ„å›¾è§£æã€åˆ†ç±»å‡ºæ¥ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™é‡Œæ˜¯éœ€è¦å€ŸåŠ©æœºå™¨å­¦ä¹ ã€NLPå»åˆ†è¯ã€åˆ†ç±»å®ç°çš„ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†å±•ç¤ºè¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šåªæ˜¯å„ç§ if/ elseã€‚ æˆ‘ä»¬è¿™é‡Œå®ç°äº†ä¸‰ç±»æ„å›¾çš„é—®é¢˜ï¼š å…³ç³»ï¼ˆAï¼ŒBï¼‰ï¼šè·å¾— A å’Œ B åœ¨å›¾è°±ä¸­çš„å…³ç³»è·¯å¾„ï¼Œæ¯”å¦‚å§šæ˜å’Œæ¹–äººé˜Ÿçš„å…³ç³»æ˜¯ï¼Ÿ æœå½¹æƒ…å†µï¼šæ¯”å¦‚ä¹”çº³æ£®åœ¨å“ªé‡Œæœå½¹ï¼Ÿ å…³æ³¨æƒ…å†µï¼šæ¯”å¦‚é‚“è‚¯å…³æ³¨äº†è°ï¼Ÿ â“ å¼€æ”¾é—®é¢˜ï¼š å¦‚æœçœ‹æ•™ç¨‹çš„ä½ è§‰å¾—è¿™å‡ ä¸ªé—®é¢˜å¤ªæ²¡æ„æ€äº†ï¼Œè¿™é‡Œç•™ä¸€ä¸ªå¼€æ”¾é—®é¢˜ï¼Œä½ å¯ä»¥åœ¨ Siwi é‡Œå¸®æˆ‘ä»¬å®ç°ï¼šã€Œå…±åŒå¥½å‹ï¼ˆAï¼ŒBï¼‰è·å¾— A å’Œ B çš„ä¸€åº¦å…±åŒå¥½å‹ã€è¿™ä¸ªæ„å›¾ï¼ˆæˆ–è€…æ›´é…·çš„å…¶ä»–å¥å­ï¼‰ä¹ˆï¼Ÿæ¬¢è¿æ¥ Githubï¼šgithub.com/wey-gu/nebula-siwi/ æ PR å“¦ï¼Œçœ‹çœ‹è°å…ˆå®ç°ã€‚ ä»£ç ç‰‡æ®µï¼šsrc/siwi/bot/classfier/__init__.py class SiwiClassifier(): def get(self, sentence: str) -\u003e dict: \"\"\" Classify Sentences and Fill Slots. This should be done by NLP, here we fake one to demostrate the intent Actor --\u003e Graph DB work flow. sentense: relation: - What is the relationship between Yao Ming and Lakers? - How does Tracy McGrady and Lakers connected? serving: - Which team had Jonathon Simmons served? friendship: - Whom does Tim Duncan follow? - Who are Tracy McGrady's friends? returns: { \"entities\": entities, \"intents\": intents } \"\"\" entities = self.get_matched_entities(sentence) intents = self.get_matched_intents(sentence) return { \"entities\": entities, \"intents\": intents } è¿™é‡Œï¼Œæˆ‘æŠŠåŒ¹é…çš„è§„åˆ™ï¼ˆç­‰ä»·äº if elseâ€¦ï¼‰å†™åœ¨äº† src/siwi/bot/test/data ä¹‹ä¸‹çš„ YAML æ–‡ä»¶é‡Œï¼Œè¿™æ ·å¢åŠ  classifier ä¹‹ä¸­æ–°çš„è§„åˆ™åªéœ€è¦æ›´æ–°è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†ï¼š 4.2.1.1 æ„å›¾è¯†åˆ«(intent) def load_entity_data(self) -\u003e None: # load data from yaml files module_path = f\"{ siwi.__path__[0] }/bot/test/data\" #... with open(f\"{ module_path }/intents.yaml\", \"r\") as file: self.intents = yaml.safe_load(file)[\"intents\"] å¯¹äºæ¯ä¸€ä¸ªæ„å›¾æ¥è¯´ï¼š intents.\u003cåå­—\u003e ä»£è¡¨åå­— åå­—ä¹‹åçš„ action ä»£è¡¨åè¾¹åœ¨è¦å®ç°çš„ç›¸åº”çš„ xxxAction çš„ç±» æ¯”å¦‚ RelationshipAction å°†æ˜¯ç”¨æ¥å¤„ç†æŸ¥è¯¢å…³ç³»ï¼ˆAï¼ŒBï¼‰è¿™æ ·çš„é—®é¢˜çš„ Action ç±» keywords ä»£è¡¨åœ¨å¥å­ä¹‹ä¸­åŒ¹é…çš„å…³é”®è¯ æ¯”å¦‚é—®å¥é‡Œå‡ºç° serveï¼Œservedï¼Œserving çš„å­—çœ¼çš„æ—¶å€™ï¼Œå°†ä¼šåŒ¹é…æœå½¹çš„é—®é¢˜ ğŸ’¡ï¼šå†™ if else æ¡ä»¶æ¥å¯¹åº”æ„å›¾æ˜¯ä¸å®¹æ˜“çš„ï¼Œå› ä¸ºä¸åŒæ„å›¾ä¸å¯èƒ½æ²¡æœ‰å…³é”®è¯ç›¸äº¤çš„æƒ…å†µï¼Œæˆ‘ä»¬çš„å®ç°åªæ˜¯ä¸€ä¸ªéå¸¸ç®€é™‹ã€ä¸ä¸¥è°¨çš„æ–¹å¼ã€‚åœ¨å®é™…åœºæ™¯ä¸‹ï¼Œè®­ç»ƒæ¨¡å‹å»åšåŒ¹é…æ•ˆæœä¼šæ›´å¥½ï¼Œæœ‰æ„æ€çš„æ˜¯ï¼Œé‚£äº›åšçš„æ¯”è¾ƒå¥½çš„æ¨¡å‹çš„è¾“å…¥å’Œæˆ‘ä»¬çš„ YAML çš„æ ¼å¼æ˜¯å¾ˆç±»ä¼¼çš„ã€‚ --- intents: fallback: action: FallbackAction keywords: [] relationship: action: RelationshipAction keywords: - between - relation - relationship - related - connect - correlate serve: action: ServeAction keywords: - serve - served - serving friend: action: FollowAction keywords: - follows - followed - follow - friend - friends 4.2.1.2 å®ä½“è¯†åˆ«(entity)ç±»ä¼¼çš„ï¼Œå®ä½“è¯†åˆ«çš„éƒ¨åˆ†æœ¬è´¨ä¸Šä¹Ÿæ˜¯ if elseï¼Œåªä¸è¿‡è¿™é‡Œåˆ©ç”¨åˆ°äº†**Ahoâ€“Corasickç®—æ³•**æ¥å¸®åŠ©æœç´¢å®ä½“ï¼Œåœ¨ç”Ÿäº§ï¼ˆéç©å…·ï¼‰çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ç”¨ NLP é‡Œçš„åˆ†è¯çš„æ–¹æ³•æ¥åšã€‚ ğŸ’¡ï¼šå¤§å®¶å¯ä»¥å»äº†è§£ä¸€ä¸‹è¿™ä¸ª ACè‡ªåŠ¨æœºç®—æ³• def setup_entity_tree(self) -\u003e None: self.entity_type_map.update({ key: \"player\" for key in self.players.keys() }) self.entity_type_map.update({ key: \"team\" for key in self.teams.keys() }) self.entity_tree = ahocorasick.Automaton() for index, entity in enumerate(self.entity_type_map.keys()): self.entity_tree.add_word(entity, (index, entity)) self.entity_tree.make_automaton() #... def get_matched_entities(self, sentence: str) -\u003e dict: \"\"\" Consume a sentence to be matched with ahocorasick Returns a dict: {entity: entity_type} \"\"\" _matched = [] for item in self.entity_tree.iter(sentence): entities_matched.append(item[1][1]) return { entity: self.entity_type_map[entity] for entity in _matched } è‡³æ­¤ï¼Œæˆ‘ä»¬çš„ SiwiClassifier.get(sentence) å·²ç»èƒ½è¿”å›è§£æã€åˆ†ç±»å‡ºæ¥çš„æ„å›¾å’Œå®ä½“äº†ï¼Œè¿™æ—¶å€™ï¼Œå®ƒä»¬ä¼šè¢«ä¼ ç»™ Actions æ¥è®© siwi bot çŸ¥é“å¦‚ä½•å»æ‰§è¡ŒçŸ¥è¯†å›¾è°±çš„æŸ¥è¯¢å•¦ï¼ 4.2.2 æ„é€ å›¾è°±æŸ¥è¯¢","date":"2021-12-30","objectID":"/siwi/:4:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#æ„é€ å›¾è°±æŸ¥è¯¢action"},{"categories":["Nebula Graph","Mini Project"],"content":" 4.3 æµ‹è¯•ä¸€ä¸‹ 4.3.1 å¯åŠ¨å›¾æ•°æ®åº“æˆ‘ä»¬åœ¨ Nebula Graph é‡Œå»ºç«‹ï¼ˆå¯¼å…¥æ•°æ®ï¼‰ä¸€ä¸ªç¯®çƒçš„çŸ¥è¯†å›¾è°±ã€‚ ğŸ’¡ï¼šåœ¨å¯¼å…¥æ•°æ®ä¹‹å‰ï¼Œè¯·å…ˆéƒ¨ç½²ä¸€ä¸ª Nebula Graph é›†ç¾¤ã€‚æœ€ç®€ä¾¿çš„éƒ¨ç½²æ–¹å¼æ˜¯ä½¿ç”¨ Nebula-UP è¿™ä¸ªå°å·¥å…·ï¼Œåªéœ€è¦ä¸€è¡Œå‘½ä»¤å°±èƒ½åœ¨ Linux æœºå™¨ä¸ŠåŒæ—¶å¯åŠ¨ä¸€ä¸ª Nebula Graph æ ¸å¿ƒå’Œå¯è§†åŒ–å›¾æ¢ç´¢å·¥å…· Nebula Graph Studioã€‚å¦‚æœä½ æ›´æ„¿æ„ç”¨ Docker éƒ¨ç½²ï¼Œè¯·å‚è€ƒè¿™ä¸ªæ–‡æ¡£ã€‚ æœ¬æ–‡å‡è®¾æˆ‘ä»¬ä½¿ç”¨ Nebula-UP æ¥éƒ¨ç½²ä¸€ä¸ª Nebula Graphï¼š curl -fsSL nebula-up.siwei.io/install.sh | bash ä¹‹åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°è¿™æ ·çš„æç¤ºï¼š æŒ‰ç…§æç¤ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå‘½ä»¤è¿›å…¥åˆ°æœ‰ Nebula Console çš„å®¹å™¨é‡Œï¼š ğŸ’¡ï¼šNebula Console æ˜¯å‘½ä»¤è¡Œè®¿é—® Nebula Graph å›¾æ•°æ®åº“çš„å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Linuxï¼ŒWindows å’Œ macOSï¼Œä¸‹è½½åœ°å€ï¼šè¿™é‡Œ ~/.nebula-up/console.sh ç„¶åï¼Œåœ¨ # çš„æç¤ºç¬¦ä¸‹å°±è¡¨ç¤ºæˆ‘ä»¬è¿›æ¥äº†ï¼Œæˆ‘ä»¬åœ¨é‡Œè¾¹å¯ä»¥æ‰§è¡Œï¼š nebula-console -addr graphd -port 9669 -user root -p nebula è¿™æ ·å°±è¡¨ç¤ºæˆ‘ä»¬è¿æ¥ä¸Šäº† Nebula Graph å›¾æ•°æ®åº“ï¼š / # nebula-console -addr graphd -port 9669 -user root -p nebula Welcome to Nebula Graph! (root@nebula) [(none)]\u003e åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ nGQL å»æ“ä½œ Nebula Graphï¼Œä¸è¿‡æˆ‘ä»¬å…ˆé€€å‡ºæ¥ï¼Œæ‰§è¡Œ exitï¼š (root@nebula) [(none)]\u003e exit Bye root! Fri, 31 Dec 2021 04:11:28 UTC æˆ‘ä»¬åœ¨è¿™ä¸ªå®¹å™¨å†…æŠŠåŸºäº nGQL è¯­å¥çš„æ•°æ®ä¸‹è½½ä¸‹æ¥ï¼š / # wget https://docs.nebula-graph.io/2.0/basketballplayer-2.X.ngql ç„¶åé€šè¿‡ Nebula Console çš„ -f \u003cfile_path\u003e æŠŠæ•°æ®å¯¼å…¥è¿›å»ï¼š nebula-console -addr graphd -port 9669 -user root -p nebula -f basketballplayer-2.X.ngql è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å¯åŠ¨äº†ä¸€ä¸ª Nebula Graph å›¾æ•°æ®åº“ï¼Œè¿˜åœ¨é‡Œè¾¹åŠ è½½äº†ç¯®çƒçš„çŸ¥è¯†å›¾è°±ï¼ ğŸ’¡ï¼šè¿˜è®°å¾—å‰è¾¹æˆ‘ä»¬æåˆ°çš„ åœ¨çº¿ä½“éªŒ ç¯å¢ƒä¹ˆï¼Ÿç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªåˆ©ç”¨ Nebula-UP éƒ¨ç½²äº† Nebula çš„ç¯å¢ƒé‡Œå¯åŠ¨è‡ªå·±çš„ Nebula Studio å•¦ï¼ŒæŒ‰ç…§ä¸Šè¾¹ Nebula-UP çš„æç¤ºï¼šhttp://\u003cæœ¬æœºIP\u003e:7001 å°±æ˜¯å®ƒçš„åœ°å€ï¼Œç„¶åå¤§å®¶å¯ä»¥å‚è€ƒæ–‡æ¡£å’Œåœ¨çº¿ä½“éªŒä»‹ç»å»äº†è§£æ›´å¤šã€‚ 4.3.2 å¯åŠ¨ Siwi-backendå¤§å®¶å¯ä»¥ç›´æ¥ clone æˆ‘çš„ä»£ç ï¼šgit clone https://github.com/wey-gu/nebula-siwi/ ç„¶åå®‰è£…ã€å¯åŠ¨ Siwi Backendï¼š cd nebula-siwi # Install dependencies python3 -m pip install -r src/requirements.txt # Install siwi backend python3 -m build # Configure Nebula Graph Endpoint export NG_ENDPOINTS=127.0.0.1:9669 # Run Backend API server gunicorn --bind :5000 wsgi --workers 1 --threads 1 --timeout 60 å¯åŠ¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¦å¤–å¼€çª—å£ï¼Œé€šè¿‡ cURL å»å‘èµ·é—®é¢˜ç»™ backendï¼Œæ›´å¤šç»†èŠ‚å¤§å®¶å¯ä»¥å‚è€ƒ GitHub ä¸Šçš„ READMEï¼š è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å†™å¥½äº† QA ç³»ç»Ÿçš„é‡è¦çš„ä»£ç å•¦ï¼Œå¤§å®¶æ˜¯ä¸æ˜¯å¯¹ä¸€ä¸ª KBQA çš„æ„æˆæœ‰äº†æ›´æ¸…æ™°çš„æ¦‚å¿µäº†å‘¢ï¼Ÿ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸ºå®ƒå¢åŠ ä¸€ä¸ªç•Œé¢ï¼ ","date":"2021-12-30","objectID":"/siwi/:4:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#æµ‹è¯•ä¸€ä¸‹"},{"categories":["Nebula Graph","Mini Project"],"content":" 4.3 æµ‹è¯•ä¸€ä¸‹ 4.3.1 å¯åŠ¨å›¾æ•°æ®åº“æˆ‘ä»¬åœ¨ Nebula Graph é‡Œå»ºç«‹ï¼ˆå¯¼å…¥æ•°æ®ï¼‰ä¸€ä¸ªç¯®çƒçš„çŸ¥è¯†å›¾è°±ã€‚ ğŸ’¡ï¼šåœ¨å¯¼å…¥æ•°æ®ä¹‹å‰ï¼Œè¯·å…ˆéƒ¨ç½²ä¸€ä¸ª Nebula Graph é›†ç¾¤ã€‚æœ€ç®€ä¾¿çš„éƒ¨ç½²æ–¹å¼æ˜¯ä½¿ç”¨ Nebula-UP è¿™ä¸ªå°å·¥å…·ï¼Œåªéœ€è¦ä¸€è¡Œå‘½ä»¤å°±èƒ½åœ¨ Linux æœºå™¨ä¸ŠåŒæ—¶å¯åŠ¨ä¸€ä¸ª Nebula Graph æ ¸å¿ƒå’Œå¯è§†åŒ–å›¾æ¢ç´¢å·¥å…· Nebula Graph Studioã€‚å¦‚æœä½ æ›´æ„¿æ„ç”¨ Docker éƒ¨ç½²ï¼Œè¯·å‚è€ƒè¿™ä¸ªæ–‡æ¡£ã€‚ æœ¬æ–‡å‡è®¾æˆ‘ä»¬ä½¿ç”¨ Nebula-UP æ¥éƒ¨ç½²ä¸€ä¸ª Nebula Graphï¼š curl -fsSL nebula-up.siwei.io/install.sh | bash ä¹‹åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°è¿™æ ·çš„æç¤ºï¼š æŒ‰ç…§æç¤ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå‘½ä»¤è¿›å…¥åˆ°æœ‰ Nebula Console çš„å®¹å™¨é‡Œï¼š ğŸ’¡ï¼šNebula Console æ˜¯å‘½ä»¤è¡Œè®¿é—® Nebula Graph å›¾æ•°æ®åº“çš„å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Linuxï¼ŒWindows å’Œ macOSï¼Œä¸‹è½½åœ°å€ï¼šè¿™é‡Œ ~/.nebula-up/console.sh ç„¶åï¼Œåœ¨ # çš„æç¤ºç¬¦ä¸‹å°±è¡¨ç¤ºæˆ‘ä»¬è¿›æ¥äº†ï¼Œæˆ‘ä»¬åœ¨é‡Œè¾¹å¯ä»¥æ‰§è¡Œï¼š nebula-console -addr graphd -port 9669 -user root -p nebula è¿™æ ·å°±è¡¨ç¤ºæˆ‘ä»¬è¿æ¥ä¸Šäº† Nebula Graph å›¾æ•°æ®åº“ï¼š / # nebula-console -addr graphd -port 9669 -user root -p nebula Welcome to Nebula Graph! (root@nebula) [(none)]\u003e åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ nGQL å»æ“ä½œ Nebula Graphï¼Œä¸è¿‡æˆ‘ä»¬å…ˆé€€å‡ºæ¥ï¼Œæ‰§è¡Œ exitï¼š (root@nebula) [(none)]\u003e exit Bye root! Fri, 31 Dec 2021 04:11:28 UTC æˆ‘ä»¬åœ¨è¿™ä¸ªå®¹å™¨å†…æŠŠåŸºäº nGQL è¯­å¥çš„æ•°æ®ä¸‹è½½ä¸‹æ¥ï¼š / # wget https://docs.nebula-graph.io/2.0/basketballplayer-2.X.ngql ç„¶åé€šè¿‡ Nebula Console çš„ -f æŠŠæ•°æ®å¯¼å…¥è¿›å»ï¼š nebula-console -addr graphd -port 9669 -user root -p nebula -f basketballplayer-2.X.ngql è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å¯åŠ¨äº†ä¸€ä¸ª Nebula Graph å›¾æ•°æ®åº“ï¼Œè¿˜åœ¨é‡Œè¾¹åŠ è½½äº†ç¯®çƒçš„çŸ¥è¯†å›¾è°±ï¼ ğŸ’¡ï¼šè¿˜è®°å¾—å‰è¾¹æˆ‘ä»¬æåˆ°çš„ åœ¨çº¿ä½“éªŒ ç¯å¢ƒä¹ˆï¼Ÿç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªåˆ©ç”¨ Nebula-UP éƒ¨ç½²äº† Nebula çš„ç¯å¢ƒé‡Œå¯åŠ¨è‡ªå·±çš„ Nebula Studio å•¦ï¼ŒæŒ‰ç…§ä¸Šè¾¹ Nebula-UP çš„æç¤ºï¼šhttp://\u003cæœ¬æœºIP\u003e:7001 å°±æ˜¯å®ƒçš„åœ°å€ï¼Œç„¶åå¤§å®¶å¯ä»¥å‚è€ƒæ–‡æ¡£å’Œåœ¨çº¿ä½“éªŒä»‹ç»å»äº†è§£æ›´å¤šã€‚ 4.3.2 å¯åŠ¨ Siwi-backendå¤§å®¶å¯ä»¥ç›´æ¥ clone æˆ‘çš„ä»£ç ï¼šgit clone https://github.com/wey-gu/nebula-siwi/ ç„¶åå®‰è£…ã€å¯åŠ¨ Siwi Backendï¼š cd nebula-siwi # Install dependencies python3 -m pip install -r src/requirements.txt # Install siwi backend python3 -m build # Configure Nebula Graph Endpoint export NG_ENDPOINTS=127.0.0.1:9669 # Run Backend API server gunicorn --bind :5000 wsgi --workers 1 --threads 1 --timeout 60 å¯åŠ¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¦å¤–å¼€çª—å£ï¼Œé€šè¿‡ cURL å»å‘èµ·é—®é¢˜ç»™ backendï¼Œæ›´å¤šç»†èŠ‚å¤§å®¶å¯ä»¥å‚è€ƒ GitHub ä¸Šçš„ READMEï¼š è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å†™å¥½äº† QA ç³»ç»Ÿçš„é‡è¦çš„ä»£ç å•¦ï¼Œå¤§å®¶æ˜¯ä¸æ˜¯å¯¹ä¸€ä¸ª KBQA çš„æ„æˆæœ‰äº†æ›´æ¸…æ™°çš„æ¦‚å¿µäº†å‘¢ï¼Ÿ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸ºå®ƒå¢åŠ ä¸€ä¸ªç•Œé¢ï¼ ","date":"2021-12-30","objectID":"/siwi/:4:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#å¯åŠ¨å›¾æ•°æ®åº“"},{"categories":["Nebula Graph","Mini Project"],"content":" 4.3 æµ‹è¯•ä¸€ä¸‹ 4.3.1 å¯åŠ¨å›¾æ•°æ®åº“æˆ‘ä»¬åœ¨ Nebula Graph é‡Œå»ºç«‹ï¼ˆå¯¼å…¥æ•°æ®ï¼‰ä¸€ä¸ªç¯®çƒçš„çŸ¥è¯†å›¾è°±ã€‚ ğŸ’¡ï¼šåœ¨å¯¼å…¥æ•°æ®ä¹‹å‰ï¼Œè¯·å…ˆéƒ¨ç½²ä¸€ä¸ª Nebula Graph é›†ç¾¤ã€‚æœ€ç®€ä¾¿çš„éƒ¨ç½²æ–¹å¼æ˜¯ä½¿ç”¨ Nebula-UP è¿™ä¸ªå°å·¥å…·ï¼Œåªéœ€è¦ä¸€è¡Œå‘½ä»¤å°±èƒ½åœ¨ Linux æœºå™¨ä¸ŠåŒæ—¶å¯åŠ¨ä¸€ä¸ª Nebula Graph æ ¸å¿ƒå’Œå¯è§†åŒ–å›¾æ¢ç´¢å·¥å…· Nebula Graph Studioã€‚å¦‚æœä½ æ›´æ„¿æ„ç”¨ Docker éƒ¨ç½²ï¼Œè¯·å‚è€ƒè¿™ä¸ªæ–‡æ¡£ã€‚ æœ¬æ–‡å‡è®¾æˆ‘ä»¬ä½¿ç”¨ Nebula-UP æ¥éƒ¨ç½²ä¸€ä¸ª Nebula Graphï¼š curl -fsSL nebula-up.siwei.io/install.sh | bash ä¹‹åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°è¿™æ ·çš„æç¤ºï¼š æŒ‰ç…§æç¤ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå‘½ä»¤è¿›å…¥åˆ°æœ‰ Nebula Console çš„å®¹å™¨é‡Œï¼š ğŸ’¡ï¼šNebula Console æ˜¯å‘½ä»¤è¡Œè®¿é—® Nebula Graph å›¾æ•°æ®åº“çš„å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Linuxï¼ŒWindows å’Œ macOSï¼Œä¸‹è½½åœ°å€ï¼šè¿™é‡Œ ~/.nebula-up/console.sh ç„¶åï¼Œåœ¨ # çš„æç¤ºç¬¦ä¸‹å°±è¡¨ç¤ºæˆ‘ä»¬è¿›æ¥äº†ï¼Œæˆ‘ä»¬åœ¨é‡Œè¾¹å¯ä»¥æ‰§è¡Œï¼š nebula-console -addr graphd -port 9669 -user root -p nebula è¿™æ ·å°±è¡¨ç¤ºæˆ‘ä»¬è¿æ¥ä¸Šäº† Nebula Graph å›¾æ•°æ®åº“ï¼š / # nebula-console -addr graphd -port 9669 -user root -p nebula Welcome to Nebula Graph! (root@nebula) [(none)]\u003e åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ nGQL å»æ“ä½œ Nebula Graphï¼Œä¸è¿‡æˆ‘ä»¬å…ˆé€€å‡ºæ¥ï¼Œæ‰§è¡Œ exitï¼š (root@nebula) [(none)]\u003e exit Bye root! Fri, 31 Dec 2021 04:11:28 UTC æˆ‘ä»¬åœ¨è¿™ä¸ªå®¹å™¨å†…æŠŠåŸºäº nGQL è¯­å¥çš„æ•°æ®ä¸‹è½½ä¸‹æ¥ï¼š / # wget https://docs.nebula-graph.io/2.0/basketballplayer-2.X.ngql ç„¶åé€šè¿‡ Nebula Console çš„ -f æŠŠæ•°æ®å¯¼å…¥è¿›å»ï¼š nebula-console -addr graphd -port 9669 -user root -p nebula -f basketballplayer-2.X.ngql è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å¯åŠ¨äº†ä¸€ä¸ª Nebula Graph å›¾æ•°æ®åº“ï¼Œè¿˜åœ¨é‡Œè¾¹åŠ è½½äº†ç¯®çƒçš„çŸ¥è¯†å›¾è°±ï¼ ğŸ’¡ï¼šè¿˜è®°å¾—å‰è¾¹æˆ‘ä»¬æåˆ°çš„ åœ¨çº¿ä½“éªŒ ç¯å¢ƒä¹ˆï¼Ÿç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªåˆ©ç”¨ Nebula-UP éƒ¨ç½²äº† Nebula çš„ç¯å¢ƒé‡Œå¯åŠ¨è‡ªå·±çš„ Nebula Studio å•¦ï¼ŒæŒ‰ç…§ä¸Šè¾¹ Nebula-UP çš„æç¤ºï¼šhttp://\u003cæœ¬æœºIP\u003e:7001 å°±æ˜¯å®ƒçš„åœ°å€ï¼Œç„¶åå¤§å®¶å¯ä»¥å‚è€ƒæ–‡æ¡£å’Œåœ¨çº¿ä½“éªŒä»‹ç»å»äº†è§£æ›´å¤šã€‚ 4.3.2 å¯åŠ¨ Siwi-backendå¤§å®¶å¯ä»¥ç›´æ¥ clone æˆ‘çš„ä»£ç ï¼šgit clone https://github.com/wey-gu/nebula-siwi/ ç„¶åå®‰è£…ã€å¯åŠ¨ Siwi Backendï¼š cd nebula-siwi # Install dependencies python3 -m pip install -r src/requirements.txt # Install siwi backend python3 -m build # Configure Nebula Graph Endpoint export NG_ENDPOINTS=127.0.0.1:9669 # Run Backend API server gunicorn --bind :5000 wsgi --workers 1 --threads 1 --timeout 60 å¯åŠ¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¦å¤–å¼€çª—å£ï¼Œé€šè¿‡ cURL å»å‘èµ·é—®é¢˜ç»™ backendï¼Œæ›´å¤šç»†èŠ‚å¤§å®¶å¯ä»¥å‚è€ƒ GitHub ä¸Šçš„ READMEï¼š è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å†™å¥½äº† QA ç³»ç»Ÿçš„é‡è¦çš„ä»£ç å•¦ï¼Œå¤§å®¶æ˜¯ä¸æ˜¯å¯¹ä¸€ä¸ª KBQA çš„æ„æˆæœ‰äº†æ›´æ¸…æ™°çš„æ¦‚å¿µäº†å‘¢ï¼Ÿ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸ºå®ƒå¢åŠ ä¸€ä¸ªç•Œé¢ï¼ ","date":"2021-12-30","objectID":"/siwi/:4:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#å¯åŠ¨-siwi-backend"},{"categories":["Nebula Graph","Mini Project"],"content":" 5 Siwi-frontend","date":"2021-12-30","objectID":"/siwi/:5:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#siwi-frontend"},{"categories":["Nebula Graph","Mini Project"],"content":" 5.1 èŠå¤©ç•Œé¢æˆ‘ä»¬åˆ©ç”¨ Vue Bot UI è¿™ä¸ªå¯çˆ±çš„æœºå™¨äººç•Œé¢çš„ Vue å®ç°å¯ä»¥å¾ˆå®¹æ˜“æ„é€ ä¸€ä¸ª ä»£ç æ®µï¼šsrc/siwi/frontend/src/App.vue \u003ctemplate\u003e \u003cdiv id=\"app\"\u003e \u003cVueBotUI :messages=\"msg\" :options=\"botOptions\" :bot-typing=\"locking\" :input-disable=\"locking\" @msg-send=\"msgSender\" /\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e import { VueBotUI } from 'vue-bot-ui' æ³¨æ„åˆ°é‚£ä¸ªå°é£æœºæŒ‰é’®äº†å§ï¼Œå®ƒæ˜¯å‘å‡ºé—®é¢˜è¯·æ±‚çš„æŒ‰é”®ï¼Œæˆ‘ä»¬è¦åœ¨æŒ‰ä¸‹å®ƒçš„æ—¶å€™å¯¹åç«¯åšå‡ºè¯·æ±‚ã€‚ ","date":"2021-12-30","objectID":"/siwi/:5:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#èŠå¤©ç•Œé¢"},{"categories":["Nebula Graph","Mini Project"],"content":" 5.2 è®¿é—®åç«¯è¿™éƒ¨åˆ†ç”¨åˆ°äº†Axiosï¼Œå®ƒæ˜¯æµè§ˆå™¨é‡Œè®¿é—®å…¶ä»–åœ°å€çš„ HTTP å®¢æˆ·ç«¯ã€‚ åœ¨æŒ‰ä¸‹çš„æ—¶å€™ï¼Œ@msg-send=\"msgSender\" ä¼šè§¦å‘ msgSender() msgSender()å»æ„é€ axios.post(this.apiEndpoint, { \"question\": data.text }) çš„è¯·æ±‚ç»™ Siwi çš„åç«¯ åç«¯çš„ç»“æœè¢« push() åˆ°ç•Œé¢çš„èŠå¤©æ¶ˆæ¯é‡Œï¼Œæ¸²æŸ“å‡ºæ¥ this.msg.push() ä»£ç æ®µï¼šsrc/siwi/frontend/src/App.vue \u003ctemplate\u003e \u003cdiv id=\"app\"\u003e \u003cVueBotUI :messages=\"msg\" :options=\"botOptions\" :bot-typing=\"locking\" :input-disable=\"locking\" @msg-send=\"msgSender\" ---------------- 1. /\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e import { VueBotUI } from 'vue-bot-ui' import axios from \"axios\"; export default { name: 'App', components: { VueBotUI, }, methods: { msgSender(data) { this.msg.push({ agent: \"user\", type: \"text\", text: data.text, }); this.locking = true; axios.post(this.apiEndpoint, { \"question\": data.text }).then((response) =\u003e { console.log(response); ----------------- 2. this.msg.push({ ----------------- 3. agent: \"bot\", type: \"text\", text: response.data.answer, }); this.synthText = response.data.answer; this.agentSpeak = true; this.locking = false; }); }, } } ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªå›¾å½¢ç•Œé¢çš„æœºå™¨äººå•¦ï¼Œä¸è¿‡ï¼Œæ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç°ä»£æµè§ˆå™¨çš„æ¥å£ï¼Œå®ç°è¯­éŸ³è¯†åˆ«å’Œæœºå™¨äººè¯´è¯ï¼ ","date":"2021-12-30","objectID":"/siwi/:5:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#è®¿é—®åç«¯"},{"categories":["Nebula Graph","Mini Project"],"content":" 5.3 è¯­éŸ³è¯†åˆ«æˆ‘ä»¬å€ŸåŠ©äº Vue Web Speech, è¿™ä¸ªè¯­éŸ³ API çš„ VueJS çš„ç»‘å®šï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ¨æŒ‰ä¸‹ ğŸ™ï¸ çš„æ—¶å€™æ¥æ”¶äººçš„è¯­éŸ³ï¼Œå¹¶æŠŠè¯­éŸ³è½¬æ¢æˆæ–‡å­—å‘å‡ºå»ï¼Œåœ¨å›ç­”è¢«è¿”å›ä¹‹åï¼Œå®ƒï¼ˆè¿˜æ˜¯ä»–/å¥¹ğŸ˜ï¼Ÿï¼‰ä¹Ÿä¼šæŠŠå›ç­”çš„å¥å­è¯»å‡ºæ¥ç»™ç”¨æˆ·ã€‚ record åœ¨ ğŸ™ï¸ è¢«æŒ‰ä¸‹ä¹‹åï¼Œå˜æˆ ğŸ‘‚ è§¦å‘ onResults() ç›‘å¬ æŠŠè¿”å›ç»“æœå‘ç»™ this.synthText åˆæˆå™¨ï¼Œå‡†å¤‡è¯»å‡º \u003cvue-web-speech-synth\u003e æŠŠè¯­éŸ³è¯»å‡º ä»£ç æ®µï¼šsrc/siwi/frontend/src/App.vue \u003ctemplate\u003e \u003cdiv id=\"app\"\u003e \u003cbutton id=\"mic_btn\" @click=\"record = !record\"\u003e {{record?'ğŸ‘‚':'ğŸ™ï¸'}} --------------------------\u003e 1. \u003c/button\u003e \u003cvue-web-speech v-model=\"record\" @results=\"onResults\" --------------------------\u003e 1. @unrecognized=\"unrecognized\" \u003e \u003c/vue-web-speech\u003e ... \u003cvue-web-speech-synth v-model=\"agentSpeak\" :voice=\"synthVoice\" :text=\"synthText\" @list-voices=\"listVoices\" --------------------------\u003e 4. /\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e import { VueBotUI } from 'vue-bot-ui' import axios from \"axios\"; export default { name: 'App', components: { VueBotUI, }, onResults (data) { -------------------------\u003e 2. this.results = data; this.locking = true; this.msg.push({ agent: \"user\", type: \"text\", text: data[0], }); this.locking = true; console.log(data[0]); axios.post(this.apiEndpoint, { \"question\": data[0] }).then((response) =\u003e { console.log(response.data); this.msg.push({ agent: \"bot\", type: \"text\", text: response.data.answer, }); this.synthText = response.data.answer; ----------\u003e 3. this.agentSpeak = true; }); this.locking = false; }, } } \u003c/script\u003e ","date":"2021-12-30","objectID":"/siwi/:5:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#è¯­éŸ³è¯†åˆ«"},{"categories":["Nebula Graph","Mini Project"],"content":" 6 æ€»ç»“è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¼šäº†æ­å»ºè‡ªå·±çš„ç¬¬ä¸€ä¸ª KBQAï¼šçŸ¥è¯†å›¾è°±é©±åŠ¨çš„é—®ç­”ç³»ç»Ÿã€‚ å›é¡¾ä¸‹å®ƒçš„ä»£ç ç»“æ„ï¼š src/siwi å¯¹åº”åç«¯ App æ˜¯ Flask API å¤„ç†çš„éƒ¨åˆ† Bot æ˜¯å¤„ç†è¯·æ±‚ã€è®¿é—® Nebula Graph çš„éƒ¨åˆ† src/siwi_frontend æ˜¯å‰ç«¯ å¸Œæœ›å¤§å®¶åœ¨è¿™ä¸ªç®€é™‹çš„åŸºç¡€ä¹‹ä¸Šï¼Œå¤šå¤šæ¢ç´¢ï¼Œåšå‡ºæ¥æ›´åŠ æˆç†Ÿçš„èŠå¤©æœºå™¨äººï¼Œæ¬¢è¿ä½ æ¥ç»™æˆ‘é‚®ä»¶ã€ç•™è¨€å‘Šè¯‰æˆ‘å‘€ï¼Œè¿™é‡Œï¼šhttps://siwei.io/about æœ‰æˆ‘çš„è”ç³»æ–¹å¼ã€‚ . â”œâ”€â”€ README.md â”œâ”€â”€ src â”‚ â”œâ”€â”€ siwi # Siwi-API Backend â”‚ â”‚ â”œâ”€â”€ app # Web Server, take HTTP requests and calls Bot API â”‚ â”‚ â””â”€â”€ bot # Bot API â”‚ â”‚ â”œâ”€â”€ actions # Take Intent, Slots, Query Knowledge Graph here â”‚ â”‚ â”œâ”€â”€ bot # Entrypoint of the Bot API â”‚ â”‚ â”œâ”€â”€ classifier # Symentic Parsing, Intent Matching, Slot Filling â”‚ â”‚ â””â”€â”€ test # Example Data Source as equivalent/mocked module â”‚ â””â”€â”€ siwi_frontend # Browser End â”‚ â”œâ”€â”€ README.md â”‚ â”œâ”€â”€ package.json â”‚ â””â”€â”€ src â”‚ â”œâ”€â”€ App.vue # Listening to user and pass Questions to Siwi-API â”‚ â””â”€â”€ main.js â””â”€â”€ wsgi.py å¦‚æœä½ å¾ˆå–œæ¬¢è¿™æ ·çš„å°é¡¹ç›®ï¼Œæ¬¢è¿æ¥çœ‹çœ‹æˆ‘ä¹‹å‰çš„åˆ†äº«ï¼š ã€Œä»0-1ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿã€å“¦ã€‚ ğŸ’¡ï¼šä½ çŸ¥é“å—ï¼Œæˆ‘å…¶å®å€ŸåŠ©äº Katacoda å·²ç»ä¸ºå¤§å®¶æ­å»ºäº†ä¸€ä¸ªäº¤äº’å¼ä½“éªŒ Siwi + Nebula çš„éƒ¨ç½²çš„ç¯å¢ƒï¼Œå¦‚æœæ‚¨çš„ç½‘ç»œæ¡ä»¶å¤Ÿå¿«ï¼ˆKatacodaæœåŠ¡å™¨åœ¨å›½å¤–ï¼‰ï¼Œå¯ä»¥åœ¨è¿™é‡Œç‚¹ç‚¹é¼ æ ‡å°±äº¤äº’å¼ä½“éªŒå®ƒã€‚ è§†é¢‘ä»‹ç» ","date":"2021-12-30","objectID":"/siwi/:6:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#æ€»ç»“"},{"categories":["Nebula Graph","Mini Project"],"content":" 7 æ„Ÿè°¢ç”¨åˆ°çš„å¼€æºé¡¹ç›® â¤ï¸è¿™ä¸ªå°é¡¹ç›®é‡Œæˆ‘ä»¬ç”¨åˆ°äº†å¥½å¤šå¼€æºçš„é¡¹ç›®ï¼Œéå¸¸æ„Ÿè°¢è¿™äº›è´¡çŒ®è€…ä»¬çš„æ…·æ…¨ä¸æ— ç§ï¼Œå¼€æºæ˜¯ä¸æ˜¯å¾ˆé…·å‘¢ï¼Ÿ ","date":"2021-12-30","objectID":"/siwi/:7:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#æ„Ÿè°¢ç”¨åˆ°çš„å¼€æºé¡¹ç›®-"},{"categories":["Nebula Graph","Mini Project"],"content":" 7.1 Backend KGQA on MedicalKG by Huanyong Liu Flask pyahocorasick created by Wojciech MuÅ‚a PyYaml ","date":"2021-12-30","objectID":"/siwi/:7:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#backend"},{"categories":["Nebula Graph","Mini Project"],"content":" 7.2 Frontend VueJS for frontend framework Vue Bot UI, as a lovely bot UI in vue Vue Web Speech, for speech API vue wrapper Axios for browser http client Solarized for color scheme Vitesome for landing page design ","date":"2021-12-30","objectID":"/siwi/:7:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#frontend"},{"categories":["Nebula Graph","Mini Project"],"content":" 7.3 Graph Database Nebula Graph é«˜æ€§èƒ½ã€äº‘åŸç”Ÿçš„å¼€æºåˆ†å¸ƒå¼å›¾æ•°æ®åº“ ","date":"2021-12-30","objectID":"/siwi/:7:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","æ™ºèƒ½é—®ç­”","è¯­éŸ³åŠ©æ‰‹","KBQA"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ï¼Ÿ","uri":"/siwi/#graph-database"},{"categories":["Nebula Graph"],"content":"Docker éƒ¨ç½²æƒ…å†µä¸‹ä½¿ç”¨ Python Storage Client æŒ‡å—","date":"2021-12-10","objectID":"/nebula-python-storage-docker-guide/","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","python"],"title":"å¿«é€Ÿæ­å»ºè°ƒè¯• Nebula Graph Python Storage å®¢æˆ·ç«¯çš„ç¯å¢ƒ","uri":"/nebula-python-storage-docker-guide/"},{"categories":["Nebula Graph"],"content":" Python Storage Client è¿ä¸ä¸Šç¬¬ä¸€æ¬¡å®‰è£…çš„ Nebula Graphï¼Ÿ Docker éƒ¨ç½²æƒ…å†µä¸‹ä½¿ç”¨ Python Storage Client æŒ‡å— ","date":"2021-12-10","objectID":"/nebula-python-storage-docker-guide/:0:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","python"],"title":"å¿«é€Ÿæ­å»ºè°ƒè¯• Nebula Graph Python Storage å®¢æˆ·ç«¯çš„ç¯å¢ƒ","uri":"/nebula-python-storage-docker-guide/#"},{"categories":["Nebula Graph"],"content":" 1 å‰ç½®æ¡ä»¶ æ³¨æ„ï¼šä¸€ä¸ªé‡è¦çš„å‰ç½®æ¡ä»¶æ˜¯æˆ‘ä»¬çœŸçš„éœ€è¦ Storage Clientï¼Œå¦‚æœæˆ‘ä»¬åªéœ€è¦åœ¨ Python Client é‡Œé€šè¿‡ nGQL æ¥è¯·æ±‚æ•°æ®ï¼Œé‚£ä¹ˆ GraphClient æ‰æ˜¯ä½ éœ€è¦çš„ï¼Œå¯ä»¥è·³è¿‡æœ¬æ–‡ã€‚ å¯¹äºåˆšæ¥è§¦ Nebula çš„åŒå­¦ï¼Œéƒ¨ç½²é›†ç¾¤æœ€å¿«é€Ÿçš„æ–¹å¼æ˜¯ç”¨ Docker Composeï¼Œå®‰è£…éƒ¨ç½²å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼šdeploy-nebula-graph-with-docker-composeã€‚ åœ¨ docker compose up -d ä¹‹åï¼Œæˆ‘ä»¬çš„ nebula é›†ç¾¤å°±èµ·æ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ docker ps çœ‹çœ‹è¿è¡Œç€çš„å®¹å™¨ï¼š â¯ docker ps --format \"table {{.Names}}\\t{{.Ports}}\" NAMES PORTS nebula-docker-compose-graphd1-1 0.0.0.0:61852-\u003e9669/tcp, 0.0.0.0:61850-\u003e19669/tcp, 0.0.0.0:61851-\u003e19670/tcp nebula-docker-compose-graphd-1 0.0.0.0:9669-\u003e9669/tcp, 0.0.0.0:61858-\u003e19669/tcp, 0.0.0.0:61859-\u003e19670/tcp nebula-docker-compose-graphd2-1 0.0.0.0:61855-\u003e9669/tcp, 0.0.0.0:61853-\u003e19669/tcp, 0.0.0.0:61854-\u003e19670/tcp nebula-docker-compose-storaged2-1 9777-9778/tcp, 9780/tcp, 0.0.0.0:61868-\u003e9779/tcp, 0.0.0.0:61869-\u003e19779/tcp, 0.0.0.0:61870-\u003e19780/tcp nebula-docker-compose-storaged1-1 9777-9778/tcp, 9780/tcp, 0.0.0.0:61865-\u003e9779/tcp, 0.0.0.0:61866-\u003e19779/tcp, 0.0.0.0:61864-\u003e19780/tcp nebula-docker-compose-storaged0-1 9777-9778/tcp, 9780/tcp, 0.0.0.0:61845-\u003e9779/tcp, 0.0.0.0:61843-\u003e19779/tcp, 0.0.0.0:61844-\u003e19780/tcp nebula-docker-compose-metad1-1 9560/tcp, 0.0.0.0:61705-\u003e9559/tcp, 0.0.0.0:61706-\u003e19559/tcp, 0.0.0.0:61707-\u003e19560/tcp nebula-docker-compose-metad2-1 9560/tcp, 0.0.0.0:61699-\u003e9559/tcp, 0.0.0.0:61700-\u003e19559/tcp, 0.0.0.0:61701-\u003e19560/tcp nebula-docker-compose-metad0-1 9560/tcp, 0.0.0.0:61704-\u003e9559/tcp, 0.0.0.0:61702-\u003e19559/tcp, 0.0.0.0:61703-\u003e19560/tcp è¿™é‡Œè¾¹æœ‰ä¸‰ç§å®¹å™¨ ï¼š GrpahDï¼ŒæŸ¥è¯¢å¼•æ“ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ç”¨æˆ·è¿›è¡Œç™»å½•ã€è¿æ¥ã€å‘ Query è¯·æ±‚ç›´æ¥è®¿é—®çš„å”¯ä¸€ä¸€ç§æœåŠ¡ã€æ¥å£ã€‚ MetaDï¼Œå…ƒæ•°æ®æœåŠ¡ï¼Œå®ƒä¸€èˆ¬ä¸ä¼šæš´éœ²ç»™å¤–éƒ¨ï¼Œåªæœ‰ GraphD ã€StorageD ä¼šç›´æ¥è®¿é—®å®ƒã€‚ StorageDï¼Œå­˜å‚¨å¼•æ“ï¼Œå®ƒä¸€èˆ¬ä¸ä¼šæš´éœ²ç»™å¤–éƒ¨ï¼Œåªæœ‰ GraphDã€StorageD ä¼šç›´æ¥è®¿é—®å®ƒã€‚ æˆ‘ä»¬å¯ä»¥ä» Stuido Consoleï¼Œæˆ–è€… Nebula Console ï¼ˆè¿æ¥åˆ° GraphD ä¹‹åï¼‰é‡Œé€šè¿‡ SHOW HOSTS \u003cType\u003eï¼Œæ¥è·å–æ¯ç§æœåŠ¡çš„ä¿¡æ¯ï¼Œå…¶ä¸­ç¬¬ä¸€åˆ—çš„ä¿¡æ¯å°±æ˜¯ä»–ä»¬çš„ IP æˆ–è€… Hostï¼Œä¸‹è¾¹çš„ä¾‹å­æ˜¯ Docker Compose é»˜è®¤é…ç½®ä¸‹çš„æƒ…å†µã€‚ (root@nebula) [(none)]\u003e SHOW HOSTS GRAPH +-----------+------+----------+---------+--------------+---------+ | Host | Port | Status | Role | Git Info Sha | Version | +-----------+------+----------+---------+--------------+---------+ | \"graphd\" | 9669 | \"ONLINE\" | \"GRAPH\" | \"3ba41bd\" | \"2.6.0\" | +-----------+------+----------+---------+--------------+---------+ | \"graphd1\" | 9669 | \"ONLINE\" | \"GRAPH\" | \"3ba41bd\" | \"2.6.0\" | +-----------+------+----------+---------+--------------+---------+ | \"graphd2\" | 9669 | \"ONLINE\" | \"GRAPH\" | \"3ba41bd\" | \"2.6.0\" | +-----------+------+----------+---------+--------------+---------+ (root@nebula) [(none)]\u003e SHOW HOSTS META +----------+------+----------+--------+--------------+---------+ | Host | Port | Status | Role | Git Info Sha | Version | +----------+------+----------+--------+--------------+---------+ | \"metad1\" | 9559 | \"ONLINE\" | \"META\" | \"3ba41bd\" | \"2.6.0\" | +----------+------+----------+--------+--------------+---------+ | \"metad0\" | 9559 | \"ONLINE\" | \"META\" | \"3ba41bd\" | \"2.6.0\" | +----------+------+----------+--------+--------------+---------+ | \"metad2\" | 9559 | \"ONLINE\" | \"META\" | \"3ba41bd\" | \"2.6.0\" | +----------+------+----------+--------+--------------+---------+ (root@nebula) [(none)]\u003e SHOW HOSTS STORAGE +-------------+------+----------+-----------+--------------+---------+ | Host | Port | Status | Role | Git Info Sha | Version | +-------------+------+----------+-----------+--------------+---------+ | \"storaged0\" | 9779 | \"ONLINE\" | \"STORAGE\" | \"3ba41bd\" | \"2.6.0\" | +-------------+------+----------+-----------+--------------+---------+ | \"storaged1\" | 9779 | \"ONLINE\" | \"STORAGE\" | \"3ba41bd\" | \"2.6.0\" | +-------------+------+----------+-----------+--------------+---------+ | \"storaged2\" | 9779 | \"ONLINE\" | \"STORAGE\" | \"3ba41bd\" | \"2.6.0\" | +-------------+------+----------+-----------+--------------+---------+ åœ¨é»˜è®¤çš„ nebula-docker-compose çš„é…ç½®ä¸‹å„ä¸ªæœåŠ¡ä¸ºgraphd, metad1, storaged0 è¿™ç§åŸŸåçš„ Host æ ¼å¼ï¼Œè¿™å…¶å®æ˜¯å‡è®¾äº†æˆ‘ä»¬ä½¿ç”¨ Docker å¯åŠ¨çš„æœåŠ¡ä¸€èˆ¬æ˜¯ä½œä¸ºå•æœºæµ‹è¯•ä¹‹ç”¨ï¼Œé™¤äº†å…¶ä¸­çš„ graphdä¹‹å¤–ï¼Œå…¶ä»–çš„æœåŠ¡éƒ½æ²¡æœ‰æŒ‡å®šå›ºå®šçš„å¤–éƒ¨æ˜ å°„ç«¯å£ï¼ˆè§å‰è¾¹çš„ docker ps çš„ç»“æœé‡Œï¼Œå®ƒæš´éœ²åœ¨0.0.0.0:9669)ã€‚ è¿™æ„å‘³ç€ï¼Œå¦‚æœå®¢æˆ·ç«¯ä¸æ˜¯è¿è¡Œåœ¨æœ¬æœºï¼Œè®¿é—®å…¶ä»–æœåŠ¡çš„ç«¯å£éƒ½æ˜¯åŠ¨æ€çš„ï¼Œè¿™ä¼šè®©å¾ˆå¤šç¬¬ä¸€æ¬¡æƒ³ç”¨ Python Storage Client è¿æ¥æœåŠ¡çš„åŒå­¦å¡ä½ã€‚ æ‰€ä»¥æˆ‘è¿™é‡Œç»™å¤§å®¶åˆ†äº«ä¸€ä¸ªå¿«é€Ÿç”¨ Python å»è°ƒè¯• Storage Client çš„æ–¹æ³•ï¼š æœ¬è´¨ä¸Šæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ Compose çš„é…ç½®æ–‡ä»¶ã€é€šè¿‡å…¶ä»–éƒ¨ç½²æˆ–è€…é…ç½®çš„æ–¹å¼å®‰è£… Nebula æ¥ä¿è¯ Python Client èƒ½å¤Ÿ","date":"2021-12-10","objectID":"/nebula-python-storage-docker-guide/:1:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","python"],"title":"å¿«é€Ÿæ­å»ºè°ƒè¯• Nebula Graph Python Storage å®¢æˆ·ç«¯çš„ç¯å¢ƒ","uri":"/nebula-python-storage-docker-guide/#å‰ç½®æ¡ä»¶"},{"categories":["Nebula Graph"],"content":" 1.1 ç¬¬ä¸€æ­¥ï¼ŒæŠŠ Python å®¹å™¨åœ¨ nebula-docker-compose_nebula-net è¿™ä¸ªå®¹å™¨ç½‘ç»œå¯åŠ¨ä¸€ä¸ª Jupyter çš„å®¹å™¨ã€‚ è¿™é‡Œé‡‡ç”¨äº† https://github.com/jupyter/docker-stacks ç»´æŠ¤çš„ Docker Imageã€‚ docker run \\ -p 8888:8888 \\ --network nebula-docker-compose_nebula-net \\ jupyter/scipy-notebook:33add21fab64 å¯ä»¥çœ‹åˆ°å®¹å™¨äº†ï¼Œå¹¶ä¸”åœ¨ç›‘å¬ç«¯å£ï¼š8888ã€‚ [I 07:06:31.060 NotebookApp] Jupyter Notebook 6.3.0 is running at: [I 07:06:31.060 NotebookApp] http://e170a5eb4858:8888/?token=5beafb26fc6995b081c611d5d2cc96d557897b74bfdaac53 [I 07:06:31.060 NotebookApp] or http://127.0.0.1:8888/?token=5beafb26fc6995b081c611d5d2cc96d557897b74bfdaac53 è¿™æ—¶å€™æˆ‘ä»¬å¯åœ¨æµè§ˆå™¨æ‰“å¼€ http://127.0.0.1:8888/?token=5beafb26fc6995b081c611d5d2cc96d557897b74bfdaac53. åœ¨é‡Œè¾¹æ–°å»ºä¸€ä¸ª Notebookã€‚ ","date":"2021-12-10","objectID":"/nebula-python-storage-docker-guide/:1:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","python"],"title":"å¿«é€Ÿæ­å»ºè°ƒè¯• Nebula Graph Python Storage å®¢æˆ·ç«¯çš„ç¯å¢ƒ","uri":"/nebula-python-storage-docker-guide/#ç¬¬ä¸€æ­¥æŠŠ-python-å®¹å™¨"},{"categories":["Nebula Graph"],"content":" 1.2 ç¬¬äºŒæ­¥ï¼Œå®‰è£… Nebula Python SDKæˆ‘ä»¬åªéœ€è¦åœ¨ Jupyter é‡Œæ‰§è¡Œ !pip install nebula2-python==2.6.0 å°±å¯ä»¥äº†ï¼Œå…·ä½“çš„ç‰ˆæœ¬è¦æ ¹æ® Nebula Python çš„ README é‡Œçš„ç‰ˆæœ¬å¯¹åº”å…³ç³»æ¥ç»™å®šã€‚ ","date":"2021-12-10","objectID":"/nebula-python-storage-docker-guide/:1:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","python"],"title":"å¿«é€Ÿæ­å»ºè°ƒè¯• Nebula Graph Python Storage å®¢æˆ·ç«¯çš„ç¯å¢ƒ","uri":"/nebula-python-storage-docker-guide/#ç¬¬äºŒæ­¥å®‰è£…-nebula-python-sdk"},{"categories":["Nebula Graph"],"content":" 1.3 ç¬¬ä¸‰æ­¥ï¼Œå®ä¾‹åŒ– MetaCache å’Œ GraphStorageClient from nebula2.mclient import MetaCache, HostAddr from nebula2.sclient.GraphStorageClient import GraphStorageClient # Docker Compose ä¸‹é»˜è®¤ meta çš„åœ°å€æ˜¯ metad1 metad0 metad2 meta_cache = MetaCache([('metad1',9559),('metad0',9559),('metad2',9559)]) graph_storage_client = GraphStorageClient(meta_cache) ","date":"2021-12-10","objectID":"/nebula-python-storage-docker-guide/:1:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","python"],"title":"å¿«é€Ÿæ­å»ºè°ƒè¯• Nebula Graph Python Storage å®¢æˆ·ç«¯çš„ç¯å¢ƒ","uri":"/nebula-python-storage-docker-guide/#ç¬¬ä¸‰æ­¥å®ä¾‹åŒ–-metacache-å’Œ-graphstorageclient"},{"categories":["Nebula Graph"],"content":" 1.4 ç¬¬å››æ­¥ï¼Œæ‰«æ•°æ® æŒ‰ç©ºé—´ã€ç‚¹ç±»å‹æ‰«ç‚¹ resp = graph_storage_client.scan_vertex( space_name='basketballplayer', tag_name='player') while resp.has_next(): result = resp.next() for vertex_data in result: print(vertex_data) æŒ‰ç©ºé—´ã€è¾¹ç±»å‹æ‰«è¾¹ resp = graph_storage_client.scan_edge( space_name='basketballplayer', edge_name='follow') while resp.has_next(): result = resp.next() for edge_data in result: print(edge_data) Jupyter çš„è¿‡ç¨‹æˆ‘ä¹Ÿè®°å½•åœ¨è¿™ä¸ª notebook é‡Œæ–¹ä¾¿å¤§å®¶å‚è€ƒã€‚ Happy Graphing! Picture Creditï¼šBorderpolar Photographer ","date":"2021-12-10","objectID":"/nebula-python-storage-docker-guide/:1:4","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","python"],"title":"å¿«é€Ÿæ­å»ºè°ƒè¯• Nebula Graph Python Storage å®¢æˆ·ç«¯çš„ç¯å¢ƒ","uri":"/nebula-python-storage-docker-guide/#ç¬¬å››æ­¥æ‰«æ•°æ®"},{"categories":["Nebula Graph"],"content":"å¦‚ä½•å¿«é€Ÿã€å³æ—¶ã€ç¬¦åˆç›´è§‰åœ°å»å¤„ç† Nebula Java Client ä¸­çš„æ•°æ®è§£æï¼Ÿ","date":"2021-11-25","objectID":"/nebula-java-happy-parsing-guide/","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","java"],"title":"Nebula Graph çš„ Java æ•°æ®è§£æå®è·µä¸æŒ‡å¯¼","uri":"/nebula-java-happy-parsing-guide/"},{"categories":["Nebula Graph"],"content":" å¦‚ä½•å¿«é€Ÿã€å³æ—¶ã€ç¬¦åˆç›´è§‰åœ°å»å¤„ç† Nebula Java Client ä¸­çš„æ•°æ®è§£æï¼Ÿè¯»è¿™ä¸€ç¯‡å°±å¤Ÿäº†ã€‚ æ›´æ–°: 2022-Aug-10, adapted to nebulagraph 3.x ","date":"2021-11-25","objectID":"/nebula-java-happy-parsing-guide/:0:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","java"],"title":"Nebula Graph çš„ Java æ•°æ®è§£æå®è·µä¸æŒ‡å¯¼","uri":"/nebula-java-happy-parsing-guide/#"},{"categories":["Nebula Graph"],"content":" 1 å…³é”®æ­¥éª¤ï¼šå‡ è¡Œå‡†å¤‡ä¸€ä¸ªå¹²å‡€çš„äº¤äº’å¼ Nebula Java REPL ç¯å¢ƒå¤šäºäº† Java-REPL æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ï¼ˆåƒ iPython é‚£æ ·ï¼‰å»å®æ—¶äº¤äº’åœ°è°ƒè¯•ã€åˆ†æ Nebula Java å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬ç”¨å®ƒçš„ Docker é•œåƒå¯ä»¥å¾ˆå¹²å‡€çš„å»æå®šï¼š docker pull albertlatacz/java-repl docker run --rm -it \\ --network=nebula-net \\ -v ~:/root \\ albertlatacz/java-repl \\ bash apt update -y \u0026\u0026 apt install ca-certificates -y wget https://dlcdn.apache.org/maven/maven-3/3.8.6/binaries/apache-maven-3.8.6-bin.tar.gz --no-check-certificate tar xzvf apache-maven-3.8.6-bin.tar.gz wget https://github.com/vesoft-inc/nebula-java/archive/refs/tags/v3.0.0.tar.gz tar xzvf v3.0.0.tar.gz cd nebula-java-3.0.0/ ../apache-maven-3.8.6/bin/mvn dependency:copy-dependencies ../apache-maven-3.8.6/bin/mvn -B package -Dmaven.test.skip=true java -jar ../javarepl/javarepl.jar è¿™æ—¶å€™ï¼Œåœ¨æ‰§è¡Œå®Œ java -jar ../javarepl/javarepl.jar ä¹‹åï¼Œæˆ‘ä»¬å°±è¿›å…¥äº†äº¤äº’å¼çš„ Java Shellï¼ˆREPLï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ— éœ€åšç¼–è¯‘ï¼Œæ‰§è¡Œï¼Œprint è¿™æ ·çš„æ…¢åé¦ˆæ¥è°ƒè¯•å’Œç ”ç©¶æˆ‘ä»¬çš„ä»£ç äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Ÿ root@a2e26ba62bb6:/javarepl/nebula-java-3.0.0# java -jar ../javarepl/javarepl.jar Welcome to JavaREPL version 428 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_111) Type expression to evaluate, :help for more options or press tab to auto-complete. Connected to local instance at http://localhost:43707 java\u003e System.out.println(\"Hello, World!\"); Hello, World! java\u003e é¦–å…ˆæˆ‘ä»¬åœ¨ java\u003e æç¤ºç¬¦ä¸‹ï¼Œè¿™äº›æ¥æŠŠå¿…é¡»çš„ç±»è·¯å¾„å’Œå¯¼å…¥ï¼š :cp /javarepl/nebula-java-3.0.0/client/target/client-3.0.0.jar :cp /javarepl/nebula-java-3.0.0/client/target/dependency/fastjson-1.2.78.jar :cp /javarepl/nebula-java-3.0.0/client/target/dependency/slf4j-api-1.7.25.jar :cp /javarepl/nebula-java-3.0.0/client/target/dependency/slf4j-log4j12-1.7.25.jar :cp /javarepl/nebula-java-3.0.0/client/target/dependency/commons-pool2-2.2.jar :cp /javarepl/nebula-java-3.0.0/client/target/dependency/log4j-1.2.17.jar import com.alibaba.fastjson.JSON; import com.alibaba.fastjson.JSONObject; import com.vesoft.nebula.ErrorCode; import com.vesoft.nebula.client.graph.NebulaPoolConfig; import com.vesoft.nebula.client.graph.data.CASignedSSLParam; import com.vesoft.nebula.client.graph.data.HostAddress; import com.vesoft.nebula.client.graph.data.ResultSet; import com.vesoft.nebula.client.graph.data.SelfSignedSSLParam; import com.vesoft.nebula.client.graph.data.ValueWrapper; import com.vesoft.nebula.client.graph.net.NebulaPool; import com.vesoft.nebula.client.graph.net.Session; import java.io.UnsupportedEncodingException; import java.util.Arrays; import java.util.List; import java.util.concurrent.TimeUnit; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import java.lang.reflect.*; æˆ‘ä»¬å¯ä»¥ä»è¿™ Java ç¯å¢ƒè¿æ¥åˆ° Nebula Graph é‡Œï¼Œä¸‹è¾¹çš„ä¾‹å­é‡Œæˆ‘ç”¨äº†è‡ªå·±çš„ GraphD çš„ IP å’Œç«¯å£ä½œä¸ºä¾‹å­ï¼š NebulaPoolConfig nebulaPoolConfig = new NebulaPoolConfig(); nebulaPoolConfig.setMaxConnSize(10); List\u003cHostAddress\u003e addresses = Arrays.asList(new HostAddress(\"192.168.8.127\", 9669)); NebulaPool pool = new NebulaPool(); pool.init(addresses, nebulaPoolConfig); Session session = pool.getSession(\"root\", \"nebula\", false); ","date":"2021-11-25","objectID":"/nebula-java-happy-parsing-guide/:1:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","java"],"title":"Nebula Graph çš„ Java æ•°æ®è§£æå®è·µä¸æŒ‡å¯¼","uri":"/nebula-java-happy-parsing-guide/#å…³é”®æ­¥éª¤å‡ è¡Œå‡†å¤‡ä¸€ä¸ªå¹²å‡€çš„äº¤äº’å¼-nebula-java-repl-ç¯å¢ƒ"},{"categories":["Nebula Graph"],"content":" 2 é€šè¿‡è°ƒç”¨ execute æ–¹æ³•è·å¾—ä¸å¤ªå®¹æ˜“æ‡‚çš„ ResultSet å¯¹è±¡åˆšæ¥è§¦è¿™é‡Œçš„å¤§å®¶ä¸€å®šå¯¹è¿™ä¸ª ResultSet å¯¹è±¡æœ‰äº›æ„ï¼Œå€ŸåŠ©æˆ‘ä»¬çš„ç¯å¢ƒï¼Œå’±ä»¬æ¥ååˆ†é’ŸæŠŠå®ƒæé€šå§ï¼Œè¿™é‡Œæˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªç®€å•çš„è¿”å› Vertex é¡¶ç‚¹çš„ç»“æœçœ‹çœ‹ï¼š ResultSet resp = session.execute(\"USE basketballplayer;MATCH (n:player) WHERE n.name==\\\"Tim Duncan\\\" RETURN n\"); è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‚è€ƒ ResultSet çš„ä»£ç ï¼š Reference: client/graph/data/ResultSet.java å¥½å§ï¼Œå…¶å®å¯ä»¥å…ˆä¸çœ‹ï¼Œè·Ÿç€æˆ‘çš„æ•™ç¨‹å¾€ä¸‹èµ°å§ï¼Œæˆ‘ä»¬çŸ¥é“ç»“æœéƒ½æ˜¯äºŒç»´çš„è¡¨ï¼ŒResultSet æä¾›äº†å¸¸è§çš„é’ˆå¯¹è¡Œã€åˆ—çš„ä¸€äº›æ–¹æ³•ï¼Œé€šå¸¸ï¼Œæˆ‘ä»¬æ˜¯è·å–æ¯ä¸€è¡Œï¼Œç„¶åè§£æå®ƒï¼Œè€Œå…³é”®çš„é—®é¢˜æ˜¯æ¯ä¸€ä¸ªå€¼è¦æ€ä¹ˆå¤„ç†ï¼Œå¯¹å§ã€‚ java\u003e resp.isSucceeded() java.lang.Boolean res9 = true java\u003e resp.rowsSize() java.lang.Integer res16 = 1 java\u003e rows = resp.getRows() java.util.ArrayList rows = [Row ( values : [ \u003cValue vVal:Vertex ( vid : \u003cValue sVal:70 6c 61 79 65 72 31 30 30\u003e, tags : [ Tag ( name : 70 6C 61 79 65 72, props : { [B@5264a468 : \u003cValue iVal:42\u003e [B@496b8e10 : \u003cValue sVal:54 69 6d 20 44 75 6e 63 61 6e\u003e } ) ] )\u003e ] )] java\u003e row0 = resp.rowValues(0) java.lang.Iterable\u003ccom.vesoft.nebula.client.graph.data.ValueWrapper\u003e res10 = ColumnName: [n], Values: [(\"player100\" :player {name: \"Tim Duncan\", age: 42})] æˆ‘ä»¬å…¶å®å›åˆ°è¿™æ¬¡çš„ query ï¼Œå…¶å®æ˜¯è¿”å›ä¸€ä¸ª vertexï¼šé¡¶ç‚¹ï¼š (root@nebula) [basketballplayer]\u003e match (n:player) WHERE n.name == \"Tim Duncan\" return n +----------------------------------------------------+ | n | +----------------------------------------------------+ | (\"player100\" :player{age: 42, name: \"Tim Duncan\"}) | +----------------------------------------------------+ Got 1 rows (time spent 2116/44373 us) é€šè¿‡ä¸Šè¾¹çš„å‡ ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å…¶å®èƒ½å¤Ÿè·å¾—è¿™ä¸ªé¡¶ç‚¹çš„å€¼ï¼š v = Class.forName(\"com.vesoft.nebula.Value\") v.getDeclaredMethods() ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ª com.vesoft.nebula.Value çš„å€¼çš„ç±»æä¾›çš„æ–¹æ³•ç‰¹åˆ«ç‰¹åˆ«åŸå§‹ï¼Œè¿™ä¹Ÿæ˜¯è®©å¤§å®¶çŠ¯æ„çš„åŸå› ï¼Œåœ¨è¿™ä¸ªæ•™ç¨‹é‡Œæœ€é‡è¦çš„ä¸€ä¸ªå¸¦èµ°çš„ç»éªŒï¼ˆé™¤äº†åˆ©ç”¨ REPLä¹‹å¤–ï¼‰å°±æ˜¯ï¼šé™¤éå¿…è¦ï¼Œä¸è¦å»å–è¿™ä¸ªåŸå§‹çš„ç±»ï¼Œæˆ‘ä»¬åº”è¯¥å»å–å¾— ValueWrapper å°è£…ä¹‹åçš„å€¼ï¼ï¼ï¼ æ³¨æ„ï¼šå…¶å®æˆ‘ä»¬æœ‰æ›´è½»æ¾åœ°æ–¹æ³•ï¼Œå°±æ˜¯ç”¨ executeJson ç›´æ¥è·å¾— JSON stringï¼Œåˆ«æ‹…å¿ƒï¼Œä¼šåœ¨åè¾¹æåˆ°ï¼Œä¸è¿‡è¿™ä¸ªæ–¹æ³•è¦ 2.6 ä¹‹åæ‰æ”¯æŒã€‚ é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•ä½¿ç”¨ ValueWrapper å°è£…å‘¢ï¼Ÿå…¶å®ç­”æ¡ˆå·²ç»åœ¨ä¸Šè¾¹äº†ï¼Œå¤§å®¶å¯ä»¥å›å»çœ‹çœ‹ï¼Œresp.rowValues(0) çš„ç±»å‹æ­£æ˜¯ ValueWrapper çš„å¯è¿­ä»£å¯¹è±¡ï¼ æ‰€ä»¥ï¼Œæ­£ç¡®æ‰“å¼€æ–¹å¼æ˜¯è¿­å®ƒï¼è¿­å®ƒï¼è¿­å®ƒï¼å…¶å®è¿™ä¸ªå°±æ˜¯ä»£ç åº“é‡Œçš„ GraphClientExample çš„ä¸€éƒ¨åˆ†ä¾‹å­äº†ï¼Œæˆ‘ä»¬æŠŠå®ƒè¿­ä»£å–å‡ºæ¥ï¼Œæ”¾åˆ° wrappedValueList é‡Œæ…¢æ…¢æŠŠç©ï¼š import java.util.ArrayList; import java.util.List; List\u003cValueWrapper\u003e wrappedValueList = new ArrayList\u003c\u003e(); for (int i = 0; i \u003c resp.rowsSize(); i++) { ResultSet.Record record = resp.rowValues(i); for (ValueWrapper value : record.values()) { wrappedValueList.add(value); if (value.isLong()) { System.out.printf(\"%15s |\", value.asLong()); } if (value.isBoolean()) { System.out.printf(\"%15s |\", value.asBoolean()); } if (value.isDouble()) { System.out.printf(\"%15s |\", value.asDouble()); } if (value.isString()) { System.out.printf(\"%15s |\", value.asString()); } if (value.isTime()) { System.out.printf(\"%15s |\", value.asTime()); } if (value.isDate()) { System.out.printf(\"%15s |\", value.asDate()); } if (value.isDateTime()) { System.out.printf(\"%15s |\", value.asDateTime()); } if (value.isVertex()) { System.out.printf(\"%15s |\", value.asNode()); } if (value.isEdge()) { System.out.printf(\"%15s |\", value.asRelationship()); } if (value.isPath()) { System.out.printf(\"%15s |\", value.asPath()); } if (value.isList()) { System.out.printf(\"%15s |\", value.asList()); } if (value.isSet()) { System.out.printf(\"%15s |\", value.asSet()); } if (value.isMap()) { System.out.printf(\"%15s |\", value.asMap()); } } System.out.println(); } ä¸Šè¾¹è¿™äº›å¾ˆä¸‘çš„ if å°±æ˜¯å…³é”®äº†ï¼Œæˆ‘ä»¬çŸ¥é“ query çš„è¿”å›å€¼å¯èƒ½æ˜¯å¤šç§ç±»å‹çš„ï¼Œä»–ä»¬åˆ†ä¸ºï¼š å›¾è¯­ä¹‰çš„ï¼šç‚¹ã€è¾¹ã€è·¯å¾„ æ•°æ®ç±»å‹ï¼šStringï¼Œæ—¥æœŸï¼Œåˆ—è¡¨ï¼Œé›†åˆ ç­‰ç­‰ç­‰ è¿™é‡Œçš„å…³é”®æ˜¯ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ ValueWrapper ä¸ºæˆ‘ä»¬å‡†å¤‡å¥½çš„ asXxx æ–¹æ³•ï¼Œå¦‚æœè¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªé¡¶ç‚¹ï¼Œä¹ˆè¿™ä¸ª Xxx å°±æ˜¯ Nodeï¼ŒåŒç†å¦‚æœæ˜¯è¾¹çš„è¯ï¼Œè¿™ä¸ª Xxx å°±æ˜¯ Relationshipã€‚ æ‰€ä»¥ï¼Œæˆ‘ç»™å¤§å®¶çœ‹çœ‹å’±ä»¬è¿™ä¸ªè¿”å›ç‚¹ç»“æœçš„æƒ…å†µä¸‹çš„ asNode() æ–¹æ³•ï¼š java\u003e v = wrappedValueList.get(0) com.vesoft.nebula.client.graph.data.ValueWrapper v = (\"player100\" :player {name: \"Tim Duncan\", age: 42}) java\u003e v.asNode() com.vesoft.nebula.client.graph.data.Node res16 = (\"player100\" :player {name: \"Tim Duncan\", age: 42}) java\u003e node = v.asNode() com.vesoft.nebula.client.graph.data.Node node = (\"player100\" :player {name: \"Tim Duncan\", age: 42}) é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå€ŸåŠ©äº Java çš„ reflection ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªäº¤äº’ç¨‹åºé‡Œåšç±»ä¼¼äº Python é‡Œ dir() çš„äº‹æƒ…ï¼Œå®æ—¶åœ°å»è·å–ä¸€ä¸ªç±»æ”¯æŒçš„æ–¹æ³•ï¼Œåƒè¿™æ ·ï¼Œçœå»äº†æŸ¥ä»£ç ã€‚ java\u003e rClass=Class.forName(\"com.vesoft.nebula.client.graph.data.ResultSet\") java.lang.Class r = class com.vesoft.nebula.client.graph.data.ResultSet java\u003e rClass.getDeclaredMethods() java.lang.reflect.","date":"2021-11-25","objectID":"/nebula-java-happy-parsing-guide/:2:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","java"],"title":"Nebula Graph çš„ Java æ•°æ®è§£æå®è·µä¸æŒ‡å¯¼","uri":"/nebula-java-happy-parsing-guide/#é€šè¿‡è°ƒç”¨-execute-æ–¹æ³•è·å¾—ä¸å¤ªå®¹æ˜“æ‡‚çš„-resultset-å¯¹è±¡"},{"categories":["Nebula Graph"],"content":" 3 ç›´æ¥è¿”å› JSON çš„ executeJson æ–¹æ³•æœ€åï¼Œå¥½æ¶ˆæ¯æ˜¯ï¼Œä» 2.6 å¼€å§‹ï¼Œnebula å¯ä»¥ç›´æ¥è¿”å› JSON çš„ String äº†ï¼Œæˆ‘ä»¬ä¸Šè¾¹çš„çº ç»“ä¹Ÿéƒ½ä¸æ˜¯å¿…è¦çš„äº†ï¼š java\u003e String resp_json = session.executeJson(\"USE basketballplayer;MATCH (n:player) WHERE n.name==\\\"Tim Duncan\\\" RETURN n\"); java.lang.String resp_json = \" { \"errors\":[ { \"code\":0 } ], \"results\":[ { \"spaceName\":\"basketballplayer\", \"data\":[ { \"meta\":[ { \"type\":\"vertex\", \"id\":\"player100\" } ], \"row\":[ { \"player.age\":42, \"player.name\":\"Tim Duncan\" } ] } ], \"columns\":[ \"n\" ], \"errors\":{ \"code\":0 }, \"latencyInUs\":4761 } ] } \" æˆ‘ç›¸ä¿¡å¤§å®¶è‚¯å®šæ¯”æˆ‘æ›´æ“…é•¿å¤„ç† JSON çš„ç»“æœäº†å“ˆ~~ ","date":"2021-11-25","objectID":"/nebula-java-happy-parsing-guide/:3:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","java"],"title":"Nebula Graph çš„ Java æ•°æ®è§£æå®è·µä¸æŒ‡å¯¼","uri":"/nebula-java-happy-parsing-guide/#ç›´æ¥è¿”å›-json-çš„-executejson-æ–¹æ³•"},{"categories":["Nebula Graph"],"content":" 4 ç»“è®º å¦‚æœæˆ‘ä»¬æœ‰æ¡ä»¶ï¼ˆ2.6ä»¥åï¼‰ç”¨ JSONï¼Œæƒ…å†µä¼šå¾ˆå®¹æ˜“ï¼Œå¯èƒ½å¤§å®¶ä¸å¤ªéœ€è¦æœ¬æ–‡çš„æ–¹æ³•ï¼ˆä¸è¿‡æœ‰äº¤äº’ç¯å¢ƒè¿˜æ˜¯å¾ˆæ–¹ä¾¿å§ï¼Ÿï¼‰ å¦‚æœæˆ‘ä»¬ä¸å¾—ä¸å’Œ resultSet æ‰“äº¤é“ï¼Œè®°å¾—ç”¨ ValueWrapper ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ç”¨ asNode()ï¼ŒasRelationship() å’Œ asPath() ï¼Œå°è£…ä¹‹åçš„å€¼æ¯”åŸå§‹çš„å€¼å¯çˆ±å¤ªå¤šäº†ï¼ é€šè¿‡ REPL å·¥å…·ï¼Œç»“åˆ Java çš„ reflection åŠ ä¸Š æºä»£ç æœ¬èº«ï¼Œåˆ†ææ•°æ®çš„å¤„ç†å°†å˜å¾—å¼‚å¸¸é¡ºæ»‘ Happy Graphing! Picture Creditï¼šleunesmedia ","date":"2021-11-25","objectID":"/nebula-java-happy-parsing-guide/:4:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","java"],"title":"Nebula Graph çš„ Java æ•°æ®è§£æå®è·µä¸æŒ‡å¯¼","uri":"/nebula-java-happy-parsing-guide/#ç»“è®º"},{"categories":["Nebula Graph","Mini Project"],"content":"å¦‚ä½•åˆ©ç”¨å›¾æ•°æ®åº“ä»é›¶åˆ°ä¸€æ„å»ºä¸€ä¸ªå…·æœ‰è‚¡æƒåˆ†æçš„å›¾è°±ä¸çº¿ä¸Šç³»ç»Ÿå‘¢ï¼Ÿæœ¬æ–‡æ‰‹æŠŠæ‰‹å¸¦ä½ æ„å»ºä¸€ä¸ªç®€æ˜“ç‰ˆçš„è‚¡æƒç©¿é€å›¾è°±ç³»ç»Ÿã€‚","date":"2021-11-24","objectID":"/corp-rel-graph/","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/"},{"categories":["Nebula Graph","Mini Project"],"content":" å¦‚ä½•æ„å»ºä¸€ä¸ªå…·æœ‰è‚¡æƒåˆ†æçš„å›¾è°±ä¸çº¿ä¸Šç³»ç»Ÿå‘¢ï¼Ÿæœ¬æ–‡é‡Œï¼Œæˆ‘å°†åˆ©ç”¨å›¾æ•°æ®åº“ä»é›¶åˆ°ä¸€å¸¦ä½ æ„å»ºä¸€ä¸ªç®€æ˜“ç‰ˆçš„è‚¡æƒç©¿é€å›¾è°±ç³»ç»Ÿã€‚ æˆ‘ä»¬çŸ¥é“æ— è®ºæ˜¯ç›‘ç®¡éƒ¨é—¨ã€ä¼ä¸šè¿˜æ˜¯ä¸ªäººï¼Œéƒ½æœ‰éœ€æ±‚å»é’ˆå¯¹ä¸€ä¸ªä¼ä¸šã€æ³•äººåšä¸€äº›èƒŒæ™¯è°ƒæŸ¥ï¼Œè¿™äº›è°ƒæŸ¥å¯ä»¥æ˜¯æ³•å¾‹è¯‰è®¼ã€å…¬å¼€æŒè‚¡ã€ä¼ä¸šä»»èŒç­‰ç­‰å¤šç§å¤šæ ·çš„ä¿¡æ¯ã€‚è¿™äº›èƒŒæ™¯ä¿¡æ¯å¯ä»¥è¾…åŠ©æˆ‘ä»¬åšå•†ä¸šä¸Šçš„é‡è¦å†³ç­–ï¼Œè§„é¿é£é™©ï¼šæ¯”å¦‚æ ¹æ®å…¬å¸çš„è‚¡æƒå…³ç³»ï¼Œäº†è§£æ˜¯å¦å­˜åœ¨åˆ©ç›Šå†²çªæ¯”å¦‚æ˜¯å¦é€‰æ‹©ä¸ä¸€å®¶å…¬å¸è¿›è¡Œå•†ä¸šå¾€æ¥ã€‚ åœ¨æ»¡è¶³è¿™æ ·çš„å…³ç³»åˆ†æéœ€æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾€å¾€é¢ä¸´ä¸€äº›æŒ‘æˆ˜ï¼Œæ¯”å¦‚ï¼š å¦‚ä½•å°†è¿™äº›æ•°æ®çš„å…³è”å…³ç³»ä½“ç°åœ¨ç³»ç»Ÿä¹‹ä¸­ï¼Ÿä½¿å¾—å®ƒä»¬å¯ä»¥è¢«æŒ–æ˜ã€åˆ©ç”¨ å¤šç§å¼‚æ„æ•°æ®ã€æ•°æ®æºä¹‹é—´çš„å…³ç³»å¯èƒ½éšç€ä¸šåŠ¡çš„å‘å±•å¼•ç”³å‡ºæ›´å¤šçš„å˜åŒ–ï¼Œåœ¨ç»“æ„æ•°æ®åº“ä¸­ï¼Œè¿™æ„å‘³ç€ Schema å˜æ›´ åˆ†æç³»ç»Ÿéœ€è¦å°½å¯èƒ½å®æ—¶è·å–éœ€è¦çš„æŸ¥è¯¢ç»“æœï¼Œè¿™é€šå¸¸æ¶‰åŠåˆ°å¤šè·³å…³ç³»æŸ¥è¯¢ é¢†åŸŸä¸“å®¶èƒ½å¦å¿«é€Ÿçµæ´»ã€å¯è§†åŒ–è·å–åˆ†äº«ä¿¡æ¯ é‚£ä¹ˆå¦‚ä½•æ„å»ºè¿™æ ·ä¸€ä¸ªç³»ç»Ÿè§£å†³ä»¥ä¸ŠæŒ‘æˆ˜å‘¢ï¼Ÿ ","date":"2021-11-24","objectID":"/corp-rel-graph/:0:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#"},{"categories":["Nebula Graph","Mini Project"],"content":" 1 æ•°æ®å­˜åœ¨å“ªé‡Œï¼Ÿ å‰æï¼šæ•°æ®é›†å‡†å¤‡ï¼Œä¸ºäº†æ›´å¥½çš„ç»™å¤§å®¶æ¼”ç¤ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å†™äº†ä¸€ä¸ªè½®å­èƒ½éšæœºç”Ÿæˆè‚¡æƒç»“æ„ç›¸å…³çš„æ•°æ®ï¼Œç”Ÿæˆçš„æ•°æ®çš„ä¾‹å­åœ¨è¿™é‡Œã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰æ³•äººã€å…¬å¸çš„æ•°æ®ï¼Œæ›´æœ‰å…¬å¸ä¸å­å…¬å¸ä¹‹é—´çš„å…³ç³»ï¼Œå…¬å¸æŒæœ‰å…¬å¸è‚¡ä»½ï¼Œæ³•äººä»»èŒå…¬å¸ï¼Œæ³•äººæŒæœ‰å…¬å¸è‚¡ä»½å’Œæ³•äººä¹‹é—´äº²å¯†åº¦çš„å…³ç³»æ•°æ®ã€‚ æ•°æ®å­˜åœ¨å“ªé‡Œï¼Ÿè¿™æ˜¯ä¸€ä¸ªå…³é”®çš„é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬å‰§é€ä¸€ä¸‹ï¼Œç­”æ¡ˆæ˜¯ï¼šå›¾æ•°æ®åº“ã€‚ç„¶åæˆ‘ä»¬å†ç®€å•è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆè¿™æ ·ä¸€ä¸ªè‚¡æƒå›¾è°±ç³»ç»Ÿè·‘åœ¨å›¾æ•°æ®åº“ä¸Šæ˜¯æ›´å¥½çš„ã€‚ åœ¨è¿™æ ·ä¸€ä¸ªç®€å•çš„æ•°æ®æ¨¡å‹ä¹‹ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆç›´æ¥çš„åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­è¿™ä¹ˆå»ºæ¨¡ï¼š è€Œè¿™ä¹ˆå»ºæ¨¡çš„é—®é¢˜åœ¨äºï¼šè¿™ç§é€»è¾‘å…³è”çš„æ–¹å¼ä½¿å¾—æ— è®ºæ•°æ®çš„å…³è”å…³ç³»æŸ¥è¯¢è¡¨è¾¾ã€å­˜å‚¨ã€è¿˜æ˜¯å¼•å…¥æ–°çš„å…³è”å…³ç³»éƒ½ä¸æ˜¯å¾ˆé«˜æ•ˆã€‚ æŸ¥è¯¢è¡¨è¾¾ä¸é«˜æ•ˆæ˜¯å› ä¸ºå…³ç³»å‹æ•°æ®åº“æ˜¯é¢å‘è¡¨ç»“æ„è®¾è®¡çš„ï¼Œè¿™å†³å®šäº†å…³ç³»æŸ¥è¯¢è¦å†™åµŒå¥—çš„ JOINã€‚ è¿™å°±æ˜¯å‰è¾¹æåˆ°çš„æŒ‘æˆ˜ 1ï¼šèƒ½å¤Ÿè¡¨è¾¾ï¼Œä½†æ˜¯æ¯”è¾ƒå‹‰å¼ºï¼Œé‡åˆ°ç¨å¾®å¤æ‚çš„æƒ…å†µå°±å˜å¾—å¾ˆéš¾ã€‚ å­˜å‚¨ä¸é«˜æ•ˆæ˜¯å› ä¸ºè¡¨ç»“æ„è¢«è®¾è®¡çš„æ¨¡å¼æ˜¯é¢å‘æ•°æ®è®°å½•ï¼Œè€Œéæ•°æ®ä¹‹é—´çš„å…³ç³»ï¼šæˆ‘ä»¬è™½ç„¶ä¹ æƒ¯äº†å°†æ•°æ®ä¸­å®ä½“ï¼ˆæ¯”å¦‚æ³•äººï¼‰å’Œå®ä½“å…³è”ï¼ˆæ¯”å¦‚æŒæœ‰è‚¡æƒ hold_sharing_relationshipï¼‰ä»¥å¦å¤–ä¸€ä¸ªè¡¨ä¸­çš„è®°å½•æ¥è¡¨è¾¾ã€å­˜å‚¨èµ·æ¥ï¼Œè¿™é€»è¾‘ä¸Šå®Œå…¨è¡Œå¾—é€šï¼Œä½†æ˜¯åˆ°äº†å¤šè·³ã€å¤§é‡éœ€è¦è¯·æ±‚æ•°æ®å…³ç³»è·³è½¬çš„æƒ…å†µä¸‹ï¼Œè¿™æ ·è·¨è¡¨ JOIN çš„ä»£ä»·å°±æˆä¸ºäº†ç“¶é¢ˆã€‚ è¿™å°±æ˜¯å‰è¾¹æåˆ°çš„æŒ‘æˆ˜ 3ï¼šæ— æ³•åº”å¯¹å¤šæ¡æŸ¥è¯¢çš„æ€§èƒ½éœ€è¦ã€‚ å¼•å…¥æ–°çš„å…³è”å…³ç³»ä»£ä»·å¤§ï¼Œè¿˜æ˜¯å‰è¾¹æåˆ°çš„ï¼Œè¡¨ç»“æ„ä¸‹ï¼Œç”¨æ–°çš„è¡¨æ¥è¡¨è¾¾æŒæœ‰è‚¡æƒ hold_sharing_relationshipè¿™ä¸ªå…³è”å…³ç³»æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯è¿™éå¸¸ä¸çµæ´»ã€è€Œä¸”æ˜‚è´µï¼Œå®ƒæ„å‘³ç€æˆ‘ä»¬åœ¨å¼•å…¥è¿™ä¸ªå…³ç³»çš„æ—¶å€™é™å®šäº†èµ·ç‚¹ç»ˆç‚¹çš„ç±»å‹ï¼Œæ¯”å¦‚è‚¡æƒæŒæœ‰çš„å…³ç³»å¯èƒ½æ˜¯æ³•äºº-\u003eå…¬å¸ï¼Œä¹Ÿå¯èƒ½æ˜¯å…¬å¸-\u003eå…¬å¸ï¼Œéšç€ä¸šåŠ¡çš„æ¼”è¿›ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦å¼•å…¥æ”¿åºœ-\u003eå…¬å¸çš„æ–°å…³ç³»ï¼Œè€Œè¿™äº›å˜åŒ–éƒ½éœ€è¦åšæœ‰ä¸å°ä»£ä»·çš„å·¥ä½œï¼šæ”¹åŠ¨ Schemaã€‚ è¿™å°±æ˜¯å‰è¾¹æåˆ°çš„æŒ‘æˆ˜ 2ï¼šæ— æ³•åº”å¯¹ä¸šåŠ¡ä¸Šå¯¹æ•°æ®å…³ç³»ä¸Šçµæ´»å¤šå˜çš„è¦æ±‚ã€‚ å½“ä¸€ä¸ªé€šç”¨ç³»ç»Ÿæ— æ³•æ»¡è¶³ä¸å¯å¿½è§†çš„å…·ä½“éœ€æ±‚çš„æ—¶å€™ï¼Œä¸€ä¸ªæ–°çš„ç³»ç»Ÿå°±ä¼šè¯ç”Ÿï¼Œè¿™å°±æ˜¯å›¾æ•°æ®åº“ï¼Œé’ˆå¯¹è¿™æ ·çš„åœºæ™¯ï¼Œå›¾æ•°æ®åº“å¾ˆè‡ªç„¶åœ°ç‰¹åˆ«é’ˆå¯¹å…³è”å…³ç³»åœºæ™¯å»è®¾è®¡æ•´ä¸ªæ•°æ®åº“ï¼š é¢å‘å…³è”å…³ç³»è¡¨è¾¾çš„è¯­ä¹‰ã€‚ï¼ˆæŒ‘æˆ˜ 1ï¼‰ å¦‚ä¸‹è¡¨ï¼Œæˆ‘åˆ—ä¸¾äº†ä¸€ä¸ªç­‰ä»·çš„ä¸€è·³æŸ¥è¯¢åœ¨è¡¨ç»“æ„æ•°æ®åº“ä¸å›¾æ•°æ®åº“ä¸­ï¼ŒæŸ¥è¯¢è¯­å¥çš„åŒºåˆ«ã€‚å¤§å®¶åº”è¯¥å¯ä»¥çœ‹å‡ºâ€œæ‰¾åˆ°æ‰€æœ‰æŒæœ‰å’Œ p_100 å…±åŒæŒæœ‰å…¬å¸è‚¡ä»½çš„äººâ€è¿™æ ·çš„æŸ¥è¯¢è¡¨è¾¾å¯ä»¥åœ¨å›¾æ•°æ®åº“å¦‚ä½•è‡ªç„¶è¡¨è¾¾ï¼Œè¿™ä»…ä»…æ˜¯ä¸€æ¡æŸ¥è¯¢çš„åŒºåˆ«ï¼Œå¦‚æœæ˜¯å¤šè·³çš„è¯ï¼Œä»–ä»¬çš„å¤æ‚åº¦åŒºåˆ†è¿˜ä¼šæ›´æ˜æ˜¾ä¸€äº›ã€‚ è¡¨ç»“æ„æ•°æ®åº“ å›¾æ•°æ®åº“ï¼ˆå±æ€§å›¾ï¼‰ å°†å…³è”å…³ç³»å­˜å‚¨ä¸ºç‰©ç†è¿æ¥ï¼Œä»è€Œä½¿å¾—è·³è½¬æŸ¥è¯¢ä»£ä»·æœ€å°ã€‚ï¼ˆæŒ‘æˆ˜ 3ã€2ï¼‰ å›¾æ•°æ®ä¹‹ä¸­ï¼Œä»ç‚¹æ‹“å±•ï¼ˆæ‰¾åˆ°ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…³ç³»çš„å¦ä¸€å¤´ï¼‰å‡ºå»çš„ä»£ä»·æ˜¯éå¸¸å°çš„ï¼Œè¿™å› ä¸ºå›¾æ•°æ®åº“æ˜¯ä¸€ä¸ªä¸“æœ‰çš„ç³»ç»Ÿï¼Œå¾—ç›Šäºå®ƒä¸»è¦å…³å¿ƒâ€œå›¾â€ç»“æ„çš„è®¾è®¡ï¼ŒæŸ¥æ‰¾ç¡®å®šçš„å®ä½“ï¼ˆæ¯”å¦‚å’Œä¸€ä¸ªæ³•äºº A ï¼‰æ‰€æœ‰å…³è”ï¼ˆå¯èƒ½æ˜¯ä»»èŒã€äº²æˆšã€æŒæœ‰ã€ç­‰ç­‰å…³ç³»ï¼‰å…¶ä»–æ‰€æœ‰å®ä½“ï¼ˆå…¬å¸ã€æ³•äººï¼‰è¿™ä¸ªæŸ¥æ‰¾çš„ä»£ä»·æ˜¯ O(1) çš„ï¼Œå› ä¸ºå®ƒä»¬åœ¨å›¾æ•°æ®åº“çš„æ•°æ®æœºæ„é‡Œæ˜¯çœŸçš„é“¾æ¥åœ¨ä¸€èµ·çš„ã€‚ å¤§å®¶å¯ä»¥ä»ä¸‹è¡¨çš„å®šé‡å‚è€ƒæ•°æ®ä¸€çª¥å›¾æ•°æ®åº“åœ¨è¿™ç§æŸ¥è¯¢ä¸‹çš„ä¼˜åŠ¿ï¼Œè¿™ç§ä¼˜åŠ¿åœ¨å¤šè·³é«˜å¹¶å‘æƒ…å†µä¸‹çš„åŒºåˆ«æ˜¯â€œèƒ½â€ä¸â€ä¸èƒ½â€œä½œä¸ºçº¿ä¸Šç³»ç»Ÿçš„åŒºåˆ«ï¼Œæ˜¯â€œå®æ—¶â€ä¸â€œç¦»çº¿â€çš„åŒºåˆ«ã€‚ åœ¨é¢å‘å…³è”å…³ç³»çš„æ•°æ®å»ºæ¨¡å’Œæ•°æ®ç»“æ„ä¹‹ä¸‹ï¼Œå¼•å…¥æ–°çš„å®ä½“ã€å…³è”å…³ç³»çš„ä»£ä»·è¦å°å¾ˆå¤šï¼Œè¿˜æ˜¯å‰è¾¹æåˆ°çš„ä¾‹å­ï¼š åœ¨ Nebula Graph å›¾æ•°æ®ä¸­å¼•å…¥ä¸€ä¸ªæ–°çš„â€œæ”¿åºœæœºæ„â€ç±»å‹çš„å®ä½“ï¼Œå¹¶å¢åŠ æ”¿åºœæœºæ„-\u003eå…¬å¸çš„â€œæŒæœ‰è‚¡ä»½â€çš„å…³è”å…³ç³»ç›¸æ¯”äºåœ¨éå›¾æ¨¡å‹çš„æ•°æ®åº“ä¸­çš„ä»£ä»·å°å¾ˆå¤šã€‚ è¡¨ç»“æ„æ•°æ®åº“ å›¾æ•°æ®åº“ï¼ˆå±æ€§å›¾ï¼‰ 4 è·³æŸ¥è¯¢æ—¶å»¶ 1544 ç§’ 4 è·³æŸ¥è¯¢æ—¶å»¶ 1.36 ç§’ å»ºæ¨¡ç¬¦åˆç›´è§‰ï¼›å›¾æ•°æ®åº“æœ‰é¢å‘æ•°æ®è¿æ¥çš„æ•°æ®å¯è§†åŒ–èƒ½åŠ›ï¼ˆæŒ‘æˆ˜ 4ï¼‰ å¤§å®¶åœ¨ä¸‹è¡¨ç¬¬äºŒåˆ—ä¸­å¯ä»¥å¯¹æ¯”æˆ‘ä»¬æœ¬æ–‡ä¸­è¿›è¡Œçš„è‚¡æƒåˆ†ææ•°æ®åœ¨ä¸¤ç§æ•°æ®åº“ä¹‹ä¸­çš„å»ºæ¨¡çš„åŒºåˆ«ï¼Œå°¤å…¶æ˜¯åœ¨å…³å¿ƒå…³è”å…³ç³»çš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ„Ÿå—åˆ°å±æ€§å›¾çš„æ¨¡å‹å»ºç«‹æ˜¯å¾ˆç¬¦åˆäººç±»å¤§è„‘ç›´è§‰çš„ï¼Œè€Œè¿™å’Œå¤§è„‘ä¹‹ä¸­ç¥ç»å…ƒçš„ç»“æ„å¯èƒ½ä¹Ÿæœ‰ä¸€äº›å…³ç³»ã€‚ å›¾æ•°æ®åº“ä¸­å†…ç½®çš„å¯è§†åŒ–å·¥å…·æä¾›äº†ä¸€èˆ¬ç”¨æˆ·ä¾¿æ·ç†è§£æ•°æ®å…³ç³»çš„èƒ½åŠ›ï¼Œä¹Ÿç»™é¢†åŸŸä¸“å®¶ç”¨æˆ·æä¾›äº†è¡¨è¾¾è¯·æ±‚å¤æ‚æ•°æ®å…³ç³»çš„ç›´è§‚æ¥å£ã€‚ è¡¨ç»“æ„æ•°æ®åº“ å›¾æ•°æ®åº“ï¼ˆå±æ€§å›¾ï¼‰ è¡¨ç»“æ„æ•°æ®åº“ä¸å›¾æ•°æ®åº“çš„æ€»ä½“æ¯”è¾ƒï¼š è¡¨ç»“æ„æ•°æ®åº“ å›¾æ•°æ®åº“ï¼ˆå±æ€§å›¾ï¼‰ æŸ¥è¯¢ å»ºæ¨¡ æ€§èƒ½ 4 è·³æŸ¥è¯¢æ—¶å»¶ 1544 ç§’ 4 è·³æŸ¥è¯¢æ—¶å»¶ 1.36 ç§’ ç»¼ä¸Šï¼Œåœ¨æœ¬æ•™ç¨‹é‡Œï¼Œæˆ‘ä»¬å°†åˆ©ç”¨å›¾æ•°æ®åº“æ¥è¿›è¡Œæ•°æ®å­˜å‚¨ã€‚ ","date":"2021-11-24","objectID":"/corp-rel-graph/:1:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#æ•°æ®å­˜åœ¨å“ªé‡Œ"},{"categories":["Nebula Graph","Mini Project"],"content":" 2 å›¾æ•°æ®å»ºæ¨¡å‰é¢åœ¨è®¨è®ºæ•°æ®å­˜åœ¨å“ªé‡Œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å·²ç»æ­ç¤ºäº†åœ¨å›¾æ•°æ®åº“ä¸­å»ºæ¨¡çš„æ–¹å¼ï¼šæœ¬è´¨ä¸Šï¼Œåœ¨è¿™å¼ å›¾ä¸­ï¼Œå°†ä¼šæœ‰ä¸¤ç§å®ä½“ï¼š äºº å…¬å¸ å››ç§å…³ç³»ï¼š äºº â€“ä½œä¸ºäº²äººâ€“\u003eäºº äºº â€“ä½œä¸ºè§’è‰²â€“\u003e å…¬å¸ äºº æˆ–è€… å…¬å¸ â€“æŒæœ‰è‚¡ä»½â€“\u003e å…¬å¸ å…¬å¸ â€“ä½œä¸ºå­æœºæ„â€“\u003e å…¬å¸ è¿™é‡Œé¢ï¼Œå®ä½“ä¸å…³ç³»æœ¬èº«éƒ½å¯ä»¥åŒ…å«æ›´å¤šçš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯åœ¨å›¾æ•°æ®åº“é‡Œå°±æ˜¯å®ä½“ã€å…³ç³»è‡ªèº«çš„å±æ€§ã€‚å¦‚ä¸‹å›¾è¡¨ç¤ºï¼š äººçš„å±æ€§åŒ…æ‹¬ nameï¼Œage å…¬å¸çš„å±æ€§åŒ…æ‹¬ nameï¼Œlocation æŒæœ‰è‚¡ä»½ è¿™ä¸ªå…³ç³»æœ‰å±æ€§ share(ä»½é¢) ä»»èŒè¿™ä¸ªå…³ç³»æœ‰å±æ€§ roleï¼Œlevel ","date":"2021-11-24","objectID":"/corp-rel-graph/:2:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#å›¾æ•°æ®å»ºæ¨¡"},{"categories":["Nebula Graph","Mini Project"],"content":" 3 æ•°æ®å…¥åº“æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„å›¾æ•°æ®åº“å«åš Nebula Graphï¼ˆæ˜Ÿäº‘å›¾æ•°æ®åº“ï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»¥ Apache 2.0 è®¸å¯è¯å¼€æºçš„åˆ†å¸ƒå¼å›¾æ•°æ®åº“ã€‚ Nebula Graph in Github: https://github.com/vesoft-inc/nebula åœ¨å‘ Nebula Graph å¯¼å…¥æ•°æ®çš„æ—¶å€™ï¼Œå…³äºå¦‚ä½•é€‰æ‹©å·¥å…·ï¼Œè¯·å‚è€ƒè¿™ç¯‡æ–‡æ¡£å’Œè¿™ä¸ªè§†é¢‘ã€‚ è¿™é‡Œï¼Œç”±äºæ•°æ®æ ¼å¼æ˜¯ csv æ–‡ä»¶å¹¶ä¸”åˆ©ç”¨å•æœºçš„å®¢æˆ·ç«¯èµ„æºå°±è¶³å¤Ÿäº†ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨ nebula-importer æ¥å®Œæˆè¿™ä¸ªå·¥ä½œã€‚ æç¤ºï¼šåœ¨å¯¼å…¥æ•°æ®ä¹‹å‰ï¼Œè¯·å…ˆéƒ¨ç½²ä¸€ä¸ª Nebula Graph é›†ç¾¤ï¼Œæœ€ç®€ä¾¿çš„éƒ¨ç½²æ–¹å¼æ˜¯ä½¿ç”¨ nebula-up è¿™ä¸ªå°å·¥å…·ï¼Œåªéœ€è¦ä¸€è¡Œå‘½ä»¤å°±èƒ½åœ¨ Linux æœºå™¨ä¸ŠåŒæ—¶å¯åŠ¨ä¸€ä¸ª Nebula Graph æ ¸å¿ƒå’Œå¯è§†åŒ–å›¾æ¢ç´¢å·¥å…· Nebula Graph Studioã€‚å¦‚æœä½ æ›´æ„¿æ„ç”¨ Docker éƒ¨ç½²ï¼Œè¯·å‚è€ƒè¿™ä¸ªæ–‡æ¡£ã€‚ æœ¬æ–‡å‡è®¾æˆ‘ä»¬ä½¿ç”¨ Nebula-UP æ¥éƒ¨ç½²ï¼š curl -fsSL nebula-up.siwei.io/install.sh | bash è¿™é‡Œçš„æ•°æ®æ˜¯ç”Ÿæˆå™¨ç”Ÿæˆçš„ï¼Œä½ å¯ä»¥æŒ‰éœ€ç”Ÿæˆä»»æ„è§„æ¨¡éšæœºæ•°æ®é›†ï¼Œæˆ–è€…é€‰æ‹©ä¸€ä»½ç”Ÿæˆå¥½äº†çš„æ•°æ®åœ¨è¿™é‡Œ æœ‰äº†è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å¯¼å…¥äº†ã€‚ $ pip install Faker==2.0.5 pydbgen==1.0.5 $ python3 data_generator.py $ ls -l data total 1688 -rw-r--r-- 1 weyl staff 23941 Jul 14 13:28 corp.csv -rw-r--r-- 1 weyl staff 1277 Jul 14 13:26 corp_rel.csv -rw-r--r-- 1 weyl staff 3048 Jul 14 13:26 corp_share.csv -rw-r--r-- 1 weyl staff 211661 Jul 14 13:26 person.csv -rw-r--r-- 1 weyl staff 179770 Jul 14 13:26 person_corp_role.csv -rw-r--r-- 1 weyl staff 322965 Jul 14 13:26 person_corp_share.csv -rw-r--r-- 1 weyl staff 17689 Jul 14 13:26 person_rel.csv å¯¼å…¥å·¥å…· nebula-importer æ˜¯ä¸€ä¸ª golang çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½¿ç”¨æ–¹å¼å°±æ˜¯å°†å¯¼å…¥çš„ Nebula Graph è¿æ¥ä¿¡æ¯ã€æ•°æ®æºä¸­å­—æ®µçš„å«ä¹‰çš„ä¿¡æ¯å†™è¿› YAML æ ¼å¼çš„é…ç½®æ–‡ä»¶é‡Œï¼Œç„¶åé€šè¿‡å‘½ä»¤è¡Œè°ƒç”¨å®ƒã€‚å¯ä»¥å‚è€ƒæ–‡æ¡£æˆ–è€…å®ƒçš„ GitHub ä»“åº“é‡Œçš„ä¾‹å­ã€‚ è¿™é‡Œæˆ‘å·²ç»å†™å¥½äº†å‡†å¤‡å¥½äº†ä¸€ä»½ nebula-importer çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨æ•°æ®ç”Ÿæˆå™¨åŒä¸€ä¸ª repo ä¹‹ä¸‹çš„è¿™é‡Œã€‚ æœ€åï¼Œåªéœ€è¦æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å°±å¯ä»¥å¼€å§‹æ•°æ®å¯¼å…¥äº†ï¼š æ³¨æ„ï¼Œåœ¨å†™æœ¬æ–‡çš„æ—¶å€™ï¼Œnebula çš„æ–°ç‰ˆæœ¬æ˜¯ 2.6.1ï¼Œè¿™é‡Œå¯¹åº”çš„ nebula-importer æ˜¯ v2.6.0ï¼Œå¦‚æœæ‚¨å‡ºç°å¯¼å…¥é”™è¯¯å¯èƒ½æ˜¯ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œå¯ä»¥ç›¸åº”è°ƒæ•´ä¸‹è¾¹å‘½ä»¤ä¸­çš„ç‰ˆæœ¬å·ã€‚ git clone https://github.com/wey-gu/nebula-shareholding-example cp -r data_sample /tmp/data cp nebula-importer.yaml /tmp/data/ docker run --rm -ti \\ --network=nebula-docker-compose_nebula-net \\ -v /tmp/data:/root \\ vesoft/nebula-importer:v2.6.0 \\ --config /root/nebula-importer.yaml ä½ çŸ¥é“å—ï¼ŸTL;DR å®é™…ä¸Šï¼Œè¿™ä»½ importer çš„é…ç½®é‡Œå¸®æˆ‘ä»¬åšäº† Nebula Graph ä¹‹ä¸­çš„å›¾å»ºæ¨¡çš„æ“ä½œï¼Œå®ƒä»¬çš„æŒ‡ä»¤åœ¨ä¸‹è¾¹ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨å»æ‰§è¡Œäº†ã€‚ CREATE SPACE IF NOT EXISTS shareholding(partition_num=5, replica_factor=1, vid_type=FIXED_STRING(10)); USE shareholding; CREATE TAG person(name string); CREATE TAG corp(name string); CREATE TAG INDEX person_name on person(name(20)); CREATE TAG INDEX corp_name on corp(name(20)); CREATE EDGE `role_as`(role string); CREATE EDGE is_branch_of(); CREATE EDGE hold_share(share float); CREATE EDGE reletive_with(degree int); ","date":"2021-11-24","objectID":"/corp-rel-graph/:3:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#æ•°æ®å…¥åº“"},{"categories":["Nebula Graph","Mini Project"],"content":" 4 å›¾åº“ä¸­æŸ¥è¯¢æ•°æ® Tips: ä½ çŸ¥é“å—ï¼Œä½ ä¹Ÿå¯ä»¥æ— éœ€éƒ¨ç½²å®‰è£…ï¼Œé€šè¿‡ Nebula-Playground ä¹‹ä¸­ï¼Œæ‰¾åˆ°è‚¡æƒç©¿é€æ¥åœ¨çº¿è®¿é—®åŒä¸€ä»½æ•°æ®é›†ã€‚ æˆ‘ä»¬å¯ä»¥å€ŸåŠ© Nebula Graph Studio æ¥è®¿é—®æ•°æ®ï¼Œè®¿é—®æˆ‘ä»¬éƒ¨ç½² Nebula-UP çš„æœåŠ¡å™¨åœ°å€çš„ 7001 ç«¯å£å°±å¯ä»¥äº†ï¼š å‡è®¾æœåŠ¡å™¨åœ°å€ä¸º 192.168.8.127ï¼Œåˆ™æœ‰ï¼š Nebula Studio åœ°å€ï¼š192.168.8.127:7001 Nebula Graph åœ°å€ï¼š192.168.8.127:9669 é»˜è®¤ç”¨æˆ·åï¼šroot é»˜è®¤å¯†ç ï¼šnebula è®¿é—® Nebula Studioï¼š é€‰æ‹©å›¾ç©ºé—´: Shareholding ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨é‡Œè¾¹æ¢ç´¢æ¯”å¦‚ä¸€ä¸ªå…¬å¸çš„ä¸‰è·³ä»¥å†…çš„è‚¡æƒç©¿é€ï¼Œå…·ä½“çš„æ“ä½œå¯ä»¥å‚è€ƒï¼šè‚¡æƒç©¿é€åœ¨çº¿ Playground çš„ä»‹ç»ï¼š ","date":"2021-11-24","objectID":"/corp-rel-graph/:4:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#å›¾åº“ä¸­æŸ¥è¯¢æ•°æ®"},{"categories":["Nebula Graph","Mini Project"],"content":" 5 æ„å»ºä¸€ä¸ªå›¾è°±ç³»ç»Ÿ è¿™éƒ¨åˆ†çš„ä»£ç å¼€æºåœ¨ GitHub ä¸Šï¼š https://github.com/wey-gu/nebula-corp-rel-search æœ¬é¡¹ç›®çš„ Demo ä¹Ÿåœ¨ PyCon China 2021 ä¸Šçš„æ¼”è®²ä¸­æœ‰è¿‡å±•ç¤ºï¼šè§†é¢‘åœ°å€ åœ¨æ­¤åŸºç¡€ä¹‹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªæä¾›ç»™ç»ˆç«¯ç”¨æˆ·æ¥ä½¿ç”¨çš„è‚¡æƒæŸ¥è¯¢ç³»ç»Ÿäº†ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†å›¾æ•°æ®åº“ä½œä¸ºè¿™ä¸ªå›¾è°±çš„å­˜å‚¨å¼•æ“ï¼Œç†è®ºä¸Šï¼Œå¦‚æœä¸šåŠ¡å…è®¸ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨æˆ–è€…å°è£… Nebula Graph Studio æ¥æä¾›æœåŠ¡ï¼Œè¿™å®Œå…¨æ˜¯å¯è¡Œä¹Ÿæ˜¯åˆè§„çš„ï¼Œä¸è¿‡ï¼Œæœ‰ä¸€äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±å»å®ç°ç•Œé¢ã€æˆ–è€…æˆ‘ä»¬éœ€è¦å°è£…å‡ºä¸€ä¸ª API ç»™ä¸Šæ¸¸ï¼ˆå¤šç«¯ï¼‰æä¾›å›¾è°±æŸ¥è¯¢çš„åŠŸèƒ½ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä¸ºå¤§å®¶å†™äº†ä¸€ä¸ªç®€å•çš„å®ä¾‹é¡¹ç›®ï¼Œæä¾›è¿™æ ·çš„æœåŠ¡ï¼Œä»–çš„æ¶æ„ä¹Ÿå¾ˆç›´æ¥ï¼š å‰ç«¯æ¥å—ç”¨æˆ·è¦æŸ¥è¯¢çš„ç©¿é€æ³•äººã€å…¬å¸ï¼ŒæŒ‰éœ€å‘è¯·æ±‚ç»™åç«¯ï¼Œå¹¶ç”¨ D3.js å°†è¿”å›ç»“æœæ¸²æŸ“ä¸ºå…³ç³»å›¾ åç«¯æ¥å—å‰ç«¯çš„ API è¯·æ±‚ï¼Œå°†è¯·æ±‚è½¬æ¢ä¸º Graph DB çš„æŸ¥è¯¢ï¼Œå¹¶è¿”å›å‰ç«¯æœŸå¾…çš„ç»“æœ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ Frontend â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Vue.JS â”‚ â”‚ â”‚ â”‚ D3.JS â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Backend â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Flask â”‚ â”‚ â”‚ â”‚ Nebula-Python â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Graph Query â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Graph Database â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ","date":"2021-11-24","objectID":"/corp-rel-graph/:5:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#æ„å»ºä¸€ä¸ªå›¾è°±ç³»ç»Ÿ"},{"categories":["Nebula Graph","Mini Project"],"content":" 5.1 åç«¯æœåŠ¡â€“\u003eå›¾æ•°æ®åº“ è¯¦ç»†çš„æ•°æ®æ ¼å¼åˆ†æå¤§å®¶å¯ä»¥å‚è€ƒè¿™é‡Œ 5.1.1 æŸ¥è¯¢è¯­å¥æˆ‘ä»¬å‡è®¾ç”¨æˆ·è¯·æ±‚çš„å®ä½“æ˜¯ c_132 ï¼Œé‚£ä¹ˆè¯·æ±‚ 1 åˆ° 3 æ­¥çš„å…³ç³»ç©¿é€çš„è¯­æ³•æ˜¯ï¼š MATCH p=(v)-[e:`hold_share`|:`is_branch_of`|:`reletive_with`|:`role_as`*1..3]-(v2) \\ WHERE id(v) IN [\"c_132\"] RETURN p LIMIT 100 è¿™é‡Œè¾¹ ()åŒ…è£¹çš„æ˜¯å›¾ä¹‹ä¸­çš„ç‚¹ï¼Œè€Œ[] åŒ…è£¹çš„åˆ™æ˜¯ç‚¹ä¹‹é—´çš„å…³ç³»ï¼šè¾¹ï¼Œæ‰€ä»¥ï¼š (v)-[e:hold_share|:is_branch_of|:reletive_with|:role_as*1..3]-(v2) ä¹‹ä¸­çš„ï¼š (v)-[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]-(v2)åº”è¯¥æ¯”è¾ƒå¥½ç†è§£ï¼Œæ„æ€æ˜¯ä» v åˆ°v2 åšæ‹“å±•ã€‚ ç°åœ¨æˆ‘ä»¬ä»‹ç»ä¸­é—´[]åŒ…è£¹çš„éƒ¨åˆ†ï¼Œè¿™é‡Œï¼Œå®ƒçš„è¯­ä¹‰æ˜¯ï¼šç»ç”±å››ç§ç±»å‹çš„è¾¹ï¼ˆ:ä¹‹åçš„æ˜¯è¾¹çš„ç±»å‹ï¼Œ|ä»£è¡¨æˆ–è€…ï¼‰é€šè¿‡å¯å˜çš„è·³æ•°ï¼š*1..3 ï¼ˆä¸€è·³åˆ°ä¸‰è·³ï¼‰ã€‚ æ‰€ä»¥ï¼Œç®€å•æ¥è¯´æ•´ç†çœ‹å¼€ï¼Œæˆ‘ä»¬çš„æ‹“å±•çš„è·¯å¾„æ˜¯ï¼šä»ç‚¹ v å¼€å§‹ï¼Œç»ç”±å››ç§å…³ç³»ä¸€åˆ°ä¸‰è·³æ‹“å±•åˆ°ç‚¹v2ï¼Œè¿”å›æ•´ä¸ªæ‹“å±•è·¯å¾„ pï¼Œé™åˆ¶ 100 ä¸ªè·¯å¾„ç»“æœï¼Œå…¶ä¸­ v æ˜¯ c_132ã€‚ 5.1.2 Nebula Python Client/ SDKæˆ‘ä»¬å·²ç»çŸ¥é“äº†æŸ¥è¯¢è¯­å¥çš„è¯­æ³•ï¼Œé‚£ä¹ˆå°±åªéœ€è¦åœ¨åç«¯ç¨‹åºé‡Œæ ¹æ®è¯·æ±‚ã€é€šè¿‡å›¾æ•°æ®åº“çš„å®¢æˆ·ç«¯æ¥å‘å‡ºæŸ¥è¯¢è¯·æ±‚ï¼Œå¹¶å¤„ç†è¿”å›ç»“æ„å°±å¥½äº†ã€‚åœ¨ä»Šå¤©çš„ä¾‹å­ä¸­ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ Python æ¥å®ç°åç«¯çš„é€»è¾‘ï¼Œæ‰€ä»¥æˆ‘ç”¨äº† Nebula-python è¿™ä¸ªåº“ï¼Œå®ƒæ˜¯ Nebula çš„ Python Clientã€‚ ä½ çŸ¥é“ä¹ˆï¼Ÿæˆªè‡³åˆ°ç°åœ¨ï¼ŒNebula åœ¨ GitHub ä¸Šæœ‰ Javaï¼ŒGOï¼ŒPythonï¼ŒC++ï¼ŒSparkï¼ŒFlinkï¼ŒRustï¼ˆæœªGAï¼‰ï¼ŒNodeJSï¼ˆæœªGAï¼‰ çš„å®¢æˆ·ç«¯æ”¯æŒï¼Œæ›´å¤šçš„è¯­è¨€çš„å®¢æˆ·ç«¯ä¹Ÿä¼šæ…¢æ…¢è¢«å‘å¸ƒå“¦ã€‚ ä¸‹è¾¹æ˜¯ä¸€ä¸ª Python Client æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢å¹¶è¿”å›ç»“æœçš„ä¾‹å­ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨æˆ‘å®ç°è¿™ä¸ªä»£ç çš„æ—¶å€™ï¼ŒNebula Python å°šæœªæ”¯æŒè¿”å› JSON ï¼ˆé€šè¿‡session.execute_json()ï¼‰ç»“æœï¼Œå¦‚æœä½ è¦å®ç°è‡ªå·±çš„ä»£ç ï¼Œæˆ‘éå¸¸æ¨èè¯•è¯• JSON å“ˆï¼Œå°±å¯ä»¥ä¸ç”¨ä»å¯¹è±¡ä¸­ä¸€ç‚¹ç‚¹å–æ•°æ®äº†ï¼Œä¸è¿‡å€ŸåŠ© iPython/IDLE è¿™ç§ REPLï¼Œå¿«é€Ÿäº†è§£è¿”å›å¯¹è±¡çš„ç»“æ„ä¹Ÿæ²¡æœ‰é‚£ä¹ˆéº»çƒ¦ã€‚ $ python3 -m pip install nebula2-python==2.5.0 # æ³¨æ„è¿™é‡Œæˆ‘å¼•ç”¨æ—§çš„è®°å½•ï¼Œå®ƒæ˜¯ 2.5.0ï¼Œ $ ipython In [1]: from nebula2.gclient.net import ConnectionPool In [2]: from nebula2.Config import Config In [3]: config = Config() ...: config.max_connection_pool_size = 10 ...: # init connection pool ...: connection_pool = ConnectionPool() ...: # if the given servers are ok, return true, else return false ...: ok = connection_pool.init([('192.168.8.137', 9669)], config) ...: session = connection_pool.get_session('root', 'nebula') [2021-10-13 13:44:24,242]:Get connection to ('192.168.8.137', 9669) In [4]: resp = session.execute(\"use shareholding\") In [5]: query = ''' ...: MATCH p=(v)-[e:`hold_share`|:`is_branch_of`|:`reletive_with`|:`role_as`*1..3]-(v2) \\ ...: WHERE id(v) IN [\"c_132\"] RETURN p LIMIT 100 ...: ''' In [6]: resp = session.execute(query) # Note: after nebula graph 2.6.0, we could use execute_json as well In [7]: resp.col_size() Out[7]: 1 In [9]: resp.row_size() Out[10]: 100 æˆ‘ä»¬å¾€ä¸‹åˆ†æçœ‹çœ‹ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªè¯·æ±‚æœ¬è´¨ä¸Šç»“æœæ˜¯è·¯å¾„ï¼Œå®ƒæœ‰ä¸€ä¸ª .nodes() æ–¹æ³•å’Œ .relationships()æ–¹æ³•æ¥è·å¾—è·¯å¾„ä¸Šçš„ç‚¹å’Œè¾¹ï¼š In [11]: p=resp.row_values(22)[0].as_path() In [12]: p.nodes() Out[12]: [(\"c_132\" :corp{name: \"Chambers LLC\"}), (\"p_4000\" :person{name: \"Colton Bailey\"})] In [13]: p.relationships() Out[13]: [(\"p_4000\")-[:`role_as`@0{role: \"Editorial assistant\"}]-\u003e(\"c_132\")] å¯¹äºè¾¹æ¥è¯´æœ‰è¿™äº›æ–¹æ³• .edge_name(), .properties(), .start_vertex_id(), .end_vertex_id()ï¼Œè¿™é‡Œ edge_name æ˜¯è·å¾—è¾¹çš„ç±»å‹ã€‚ In [14]: rel=p.relationships()[0] In [15]: rel Out[15]: (\"p_4000\")-[:`role_as`@0{role: \"Editorial assistant\"}]-\u003e(\"c_132\") In [16]: rel.edge_name() Out[16]: '`role_as`' In [17]: rel.properties() Out[17]: {'role': \"Editorial assistant\"} In [18]: rel.start_vertex_id() Out[18]: \"p_4000\" In [19]: rel.end_vertex_id() Out[19]: \"c_132\" å¯¹äºç‚¹æ¥è¯´ï¼Œå¯ä»¥ç”¨åˆ°è¿™äº›æ–¹æ³• .tags(), properties, get_id()ï¼Œè¿™é‡Œè¾¹ tags æ˜¯è·å¾—ç‚¹çš„ç±»å‹ï¼Œå®ƒåœ¨ Nebula é‡Œå«æ ‡ç­¾tagã€‚ è¿™äº›æ¦‚å¿µå¯ä»¥åœ¨æ–‡æ¡£é‡Œè·å¾—æ›´è¯¦ç»†çš„è§£é‡Šã€‚ In [20]: node=p.nodes()[0] In [21]: node.tags() Out[21]: ['corp'] In [22]: node.properties('corp') Out[22]: {'name': \"Chambers LLC\"} In [23]: node.get_id() Out[23]: \"c_132\" ","date":"2021-11-24","objectID":"/corp-rel-graph/:5:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#åç«¯æœåŠ¡--å›¾æ•°æ®åº“"},{"categories":["Nebula Graph","Mini Project"],"content":" 5.1 åç«¯æœåŠ¡â€“\u003eå›¾æ•°æ®åº“ è¯¦ç»†çš„æ•°æ®æ ¼å¼åˆ†æå¤§å®¶å¯ä»¥å‚è€ƒè¿™é‡Œ 5.1.1 æŸ¥è¯¢è¯­å¥æˆ‘ä»¬å‡è®¾ç”¨æˆ·è¯·æ±‚çš„å®ä½“æ˜¯ c_132 ï¼Œé‚£ä¹ˆè¯·æ±‚ 1 åˆ° 3 æ­¥çš„å…³ç³»ç©¿é€çš„è¯­æ³•æ˜¯ï¼š MATCH p=(v)-[e:`hold_share`|:`is_branch_of`|:`reletive_with`|:`role_as`*1..3]-(v2) \\ WHERE id(v) IN [\"c_132\"] RETURN p LIMIT 100 è¿™é‡Œè¾¹ ()åŒ…è£¹çš„æ˜¯å›¾ä¹‹ä¸­çš„ç‚¹ï¼Œè€Œ[] åŒ…è£¹çš„åˆ™æ˜¯ç‚¹ä¹‹é—´çš„å…³ç³»ï¼šè¾¹ï¼Œæ‰€ä»¥ï¼š (v)-[e:hold_share|:is_branch_of|:reletive_with|:role_as*1..3]-(v2) ä¹‹ä¸­çš„ï¼š (v)-[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]-(v2)åº”è¯¥æ¯”è¾ƒå¥½ç†è§£ï¼Œæ„æ€æ˜¯ä» v åˆ°v2 åšæ‹“å±•ã€‚ ç°åœ¨æˆ‘ä»¬ä»‹ç»ä¸­é—´[]åŒ…è£¹çš„éƒ¨åˆ†ï¼Œè¿™é‡Œï¼Œå®ƒçš„è¯­ä¹‰æ˜¯ï¼šç»ç”±å››ç§ç±»å‹çš„è¾¹ï¼ˆ:ä¹‹åçš„æ˜¯è¾¹çš„ç±»å‹ï¼Œ|ä»£è¡¨æˆ–è€…ï¼‰é€šè¿‡å¯å˜çš„è·³æ•°ï¼š*1..3 ï¼ˆä¸€è·³åˆ°ä¸‰è·³ï¼‰ã€‚ æ‰€ä»¥ï¼Œç®€å•æ¥è¯´æ•´ç†çœ‹å¼€ï¼Œæˆ‘ä»¬çš„æ‹“å±•çš„è·¯å¾„æ˜¯ï¼šä»ç‚¹ v å¼€å§‹ï¼Œç»ç”±å››ç§å…³ç³»ä¸€åˆ°ä¸‰è·³æ‹“å±•åˆ°ç‚¹v2ï¼Œè¿”å›æ•´ä¸ªæ‹“å±•è·¯å¾„ pï¼Œé™åˆ¶ 100 ä¸ªè·¯å¾„ç»“æœï¼Œå…¶ä¸­ v æ˜¯ c_132ã€‚ 5.1.2 Nebula Python Client/ SDKæˆ‘ä»¬å·²ç»çŸ¥é“äº†æŸ¥è¯¢è¯­å¥çš„è¯­æ³•ï¼Œé‚£ä¹ˆå°±åªéœ€è¦åœ¨åç«¯ç¨‹åºé‡Œæ ¹æ®è¯·æ±‚ã€é€šè¿‡å›¾æ•°æ®åº“çš„å®¢æˆ·ç«¯æ¥å‘å‡ºæŸ¥è¯¢è¯·æ±‚ï¼Œå¹¶å¤„ç†è¿”å›ç»“æ„å°±å¥½äº†ã€‚åœ¨ä»Šå¤©çš„ä¾‹å­ä¸­ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ Python æ¥å®ç°åç«¯çš„é€»è¾‘ï¼Œæ‰€ä»¥æˆ‘ç”¨äº† Nebula-python è¿™ä¸ªåº“ï¼Œå®ƒæ˜¯ Nebula çš„ Python Clientã€‚ ä½ çŸ¥é“ä¹ˆï¼Ÿæˆªè‡³åˆ°ç°åœ¨ï¼ŒNebula åœ¨ GitHub ä¸Šæœ‰ Javaï¼ŒGOï¼ŒPythonï¼ŒC++ï¼ŒSparkï¼ŒFlinkï¼ŒRustï¼ˆæœªGAï¼‰ï¼ŒNodeJSï¼ˆæœªGAï¼‰ çš„å®¢æˆ·ç«¯æ”¯æŒï¼Œæ›´å¤šçš„è¯­è¨€çš„å®¢æˆ·ç«¯ä¹Ÿä¼šæ…¢æ…¢è¢«å‘å¸ƒå“¦ã€‚ ä¸‹è¾¹æ˜¯ä¸€ä¸ª Python Client æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢å¹¶è¿”å›ç»“æœçš„ä¾‹å­ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨æˆ‘å®ç°è¿™ä¸ªä»£ç çš„æ—¶å€™ï¼ŒNebula Python å°šæœªæ”¯æŒè¿”å› JSON ï¼ˆé€šè¿‡session.execute_json()ï¼‰ç»“æœï¼Œå¦‚æœä½ è¦å®ç°è‡ªå·±çš„ä»£ç ï¼Œæˆ‘éå¸¸æ¨èè¯•è¯• JSON å“ˆï¼Œå°±å¯ä»¥ä¸ç”¨ä»å¯¹è±¡ä¸­ä¸€ç‚¹ç‚¹å–æ•°æ®äº†ï¼Œä¸è¿‡å€ŸåŠ© iPython/IDLE è¿™ç§ REPLï¼Œå¿«é€Ÿäº†è§£è¿”å›å¯¹è±¡çš„ç»“æ„ä¹Ÿæ²¡æœ‰é‚£ä¹ˆéº»çƒ¦ã€‚ $ python3 -m pip install nebula2-python==2.5.0 # æ³¨æ„è¿™é‡Œæˆ‘å¼•ç”¨æ—§çš„è®°å½•ï¼Œå®ƒæ˜¯ 2.5.0ï¼Œ $ ipython In [1]: from nebula2.gclient.net import ConnectionPool In [2]: from nebula2.Config import Config In [3]: config = Config() ...: config.max_connection_pool_size = 10 ...: # init connection pool ...: connection_pool = ConnectionPool() ...: # if the given servers are ok, return true, else return false ...: ok = connection_pool.init([('192.168.8.137', 9669)], config) ...: session = connection_pool.get_session('root', 'nebula') [2021-10-13 13:44:24,242]:Get connection to ('192.168.8.137', 9669) In [4]: resp = session.execute(\"use shareholding\") In [5]: query = ''' ...: MATCH p=(v)-[e:`hold_share`|:`is_branch_of`|:`reletive_with`|:`role_as`*1..3]-(v2) \\ ...: WHERE id(v) IN [\"c_132\"] RETURN p LIMIT 100 ...: ''' In [6]: resp = session.execute(query) # Note: after nebula graph 2.6.0, we could use execute_json as well In [7]: resp.col_size() Out[7]: 1 In [9]: resp.row_size() Out[10]: 100 æˆ‘ä»¬å¾€ä¸‹åˆ†æçœ‹çœ‹ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªè¯·æ±‚æœ¬è´¨ä¸Šç»“æœæ˜¯è·¯å¾„ï¼Œå®ƒæœ‰ä¸€ä¸ª .nodes() æ–¹æ³•å’Œ .relationships()æ–¹æ³•æ¥è·å¾—è·¯å¾„ä¸Šçš„ç‚¹å’Œè¾¹ï¼š In [11]: p=resp.row_values(22)[0].as_path() In [12]: p.nodes() Out[12]: [(\"c_132\" :corp{name: \"Chambers LLC\"}), (\"p_4000\" :person{name: \"Colton Bailey\"})] In [13]: p.relationships() Out[13]: [(\"p_4000\")-[:`role_as`@0{role: \"Editorial assistant\"}]-\u003e(\"c_132\")] å¯¹äºè¾¹æ¥è¯´æœ‰è¿™äº›æ–¹æ³• .edge_name(), .properties(), .start_vertex_id(), .end_vertex_id()ï¼Œè¿™é‡Œ edge_name æ˜¯è·å¾—è¾¹çš„ç±»å‹ã€‚ In [14]: rel=p.relationships()[0] In [15]: rel Out[15]: (\"p_4000\")-[:`role_as`@0{role: \"Editorial assistant\"}]-\u003e(\"c_132\") In [16]: rel.edge_name() Out[16]: '`role_as`' In [17]: rel.properties() Out[17]: {'role': \"Editorial assistant\"} In [18]: rel.start_vertex_id() Out[18]: \"p_4000\" In [19]: rel.end_vertex_id() Out[19]: \"c_132\" å¯¹äºç‚¹æ¥è¯´ï¼Œå¯ä»¥ç”¨åˆ°è¿™äº›æ–¹æ³• .tags(), properties, get_id()ï¼Œè¿™é‡Œè¾¹ tags æ˜¯è·å¾—ç‚¹çš„ç±»å‹ï¼Œå®ƒåœ¨ Nebula é‡Œå«æ ‡ç­¾tagã€‚ è¿™äº›æ¦‚å¿µå¯ä»¥åœ¨æ–‡æ¡£é‡Œè·å¾—æ›´è¯¦ç»†çš„è§£é‡Šã€‚ In [20]: node=p.nodes()[0] In [21]: node.tags() Out[21]: ['corp'] In [22]: node.properties('corp') Out[22]: {'name': \"Chambers LLC\"} In [23]: node.get_id() Out[23]: \"c_132\" ","date":"2021-11-24","objectID":"/corp-rel-graph/:5:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#æŸ¥è¯¢è¯­å¥"},{"categories":["Nebula Graph","Mini Project"],"content":" 5.1 åç«¯æœåŠ¡â€“\u003eå›¾æ•°æ®åº“ è¯¦ç»†çš„æ•°æ®æ ¼å¼åˆ†æå¤§å®¶å¯ä»¥å‚è€ƒè¿™é‡Œ 5.1.1 æŸ¥è¯¢è¯­å¥æˆ‘ä»¬å‡è®¾ç”¨æˆ·è¯·æ±‚çš„å®ä½“æ˜¯ c_132 ï¼Œé‚£ä¹ˆè¯·æ±‚ 1 åˆ° 3 æ­¥çš„å…³ç³»ç©¿é€çš„è¯­æ³•æ˜¯ï¼š MATCH p=(v)-[e:`hold_share`|:`is_branch_of`|:`reletive_with`|:`role_as`*1..3]-(v2) \\ WHERE id(v) IN [\"c_132\"] RETURN p LIMIT 100 è¿™é‡Œè¾¹ ()åŒ…è£¹çš„æ˜¯å›¾ä¹‹ä¸­çš„ç‚¹ï¼Œè€Œ[] åŒ…è£¹çš„åˆ™æ˜¯ç‚¹ä¹‹é—´çš„å…³ç³»ï¼šè¾¹ï¼Œæ‰€ä»¥ï¼š (v)-[e:hold_share|:is_branch_of|:reletive_with|:role_as*1..3]-(v2) ä¹‹ä¸­çš„ï¼š (v)-[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]-(v2)åº”è¯¥æ¯”è¾ƒå¥½ç†è§£ï¼Œæ„æ€æ˜¯ä» v åˆ°v2 åšæ‹“å±•ã€‚ ç°åœ¨æˆ‘ä»¬ä»‹ç»ä¸­é—´[]åŒ…è£¹çš„éƒ¨åˆ†ï¼Œè¿™é‡Œï¼Œå®ƒçš„è¯­ä¹‰æ˜¯ï¼šç»ç”±å››ç§ç±»å‹çš„è¾¹ï¼ˆ:ä¹‹åçš„æ˜¯è¾¹çš„ç±»å‹ï¼Œ|ä»£è¡¨æˆ–è€…ï¼‰é€šè¿‡å¯å˜çš„è·³æ•°ï¼š*1..3 ï¼ˆä¸€è·³åˆ°ä¸‰è·³ï¼‰ã€‚ æ‰€ä»¥ï¼Œç®€å•æ¥è¯´æ•´ç†çœ‹å¼€ï¼Œæˆ‘ä»¬çš„æ‹“å±•çš„è·¯å¾„æ˜¯ï¼šä»ç‚¹ v å¼€å§‹ï¼Œç»ç”±å››ç§å…³ç³»ä¸€åˆ°ä¸‰è·³æ‹“å±•åˆ°ç‚¹v2ï¼Œè¿”å›æ•´ä¸ªæ‹“å±•è·¯å¾„ pï¼Œé™åˆ¶ 100 ä¸ªè·¯å¾„ç»“æœï¼Œå…¶ä¸­ v æ˜¯ c_132ã€‚ 5.1.2 Nebula Python Client/ SDKæˆ‘ä»¬å·²ç»çŸ¥é“äº†æŸ¥è¯¢è¯­å¥çš„è¯­æ³•ï¼Œé‚£ä¹ˆå°±åªéœ€è¦åœ¨åç«¯ç¨‹åºé‡Œæ ¹æ®è¯·æ±‚ã€é€šè¿‡å›¾æ•°æ®åº“çš„å®¢æˆ·ç«¯æ¥å‘å‡ºæŸ¥è¯¢è¯·æ±‚ï¼Œå¹¶å¤„ç†è¿”å›ç»“æ„å°±å¥½äº†ã€‚åœ¨ä»Šå¤©çš„ä¾‹å­ä¸­ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ Python æ¥å®ç°åç«¯çš„é€»è¾‘ï¼Œæ‰€ä»¥æˆ‘ç”¨äº† Nebula-python è¿™ä¸ªåº“ï¼Œå®ƒæ˜¯ Nebula çš„ Python Clientã€‚ ä½ çŸ¥é“ä¹ˆï¼Ÿæˆªè‡³åˆ°ç°åœ¨ï¼ŒNebula åœ¨ GitHub ä¸Šæœ‰ Javaï¼ŒGOï¼ŒPythonï¼ŒC++ï¼ŒSparkï¼ŒFlinkï¼ŒRustï¼ˆæœªGAï¼‰ï¼ŒNodeJSï¼ˆæœªGAï¼‰ çš„å®¢æˆ·ç«¯æ”¯æŒï¼Œæ›´å¤šçš„è¯­è¨€çš„å®¢æˆ·ç«¯ä¹Ÿä¼šæ…¢æ…¢è¢«å‘å¸ƒå“¦ã€‚ ä¸‹è¾¹æ˜¯ä¸€ä¸ª Python Client æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢å¹¶è¿”å›ç»“æœçš„ä¾‹å­ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨æˆ‘å®ç°è¿™ä¸ªä»£ç çš„æ—¶å€™ï¼ŒNebula Python å°šæœªæ”¯æŒè¿”å› JSON ï¼ˆé€šè¿‡session.execute_json()ï¼‰ç»“æœï¼Œå¦‚æœä½ è¦å®ç°è‡ªå·±çš„ä»£ç ï¼Œæˆ‘éå¸¸æ¨èè¯•è¯• JSON å“ˆï¼Œå°±å¯ä»¥ä¸ç”¨ä»å¯¹è±¡ä¸­ä¸€ç‚¹ç‚¹å–æ•°æ®äº†ï¼Œä¸è¿‡å€ŸåŠ© iPython/IDLE è¿™ç§ REPLï¼Œå¿«é€Ÿäº†è§£è¿”å›å¯¹è±¡çš„ç»“æ„ä¹Ÿæ²¡æœ‰é‚£ä¹ˆéº»çƒ¦ã€‚ $ python3 -m pip install nebula2-python==2.5.0 # æ³¨æ„è¿™é‡Œæˆ‘å¼•ç”¨æ—§çš„è®°å½•ï¼Œå®ƒæ˜¯ 2.5.0ï¼Œ $ ipython In [1]: from nebula2.gclient.net import ConnectionPool In [2]: from nebula2.Config import Config In [3]: config = Config() ...: config.max_connection_pool_size = 10 ...: # init connection pool ...: connection_pool = ConnectionPool() ...: # if the given servers are ok, return true, else return false ...: ok = connection_pool.init([('192.168.8.137', 9669)], config) ...: session = connection_pool.get_session('root', 'nebula') [2021-10-13 13:44:24,242]:Get connection to ('192.168.8.137', 9669) In [4]: resp = session.execute(\"use shareholding\") In [5]: query = ''' ...: MATCH p=(v)-[e:`hold_share`|:`is_branch_of`|:`reletive_with`|:`role_as`*1..3]-(v2) \\ ...: WHERE id(v) IN [\"c_132\"] RETURN p LIMIT 100 ...: ''' In [6]: resp = session.execute(query) # Note: after nebula graph 2.6.0, we could use execute_json as well In [7]: resp.col_size() Out[7]: 1 In [9]: resp.row_size() Out[10]: 100 æˆ‘ä»¬å¾€ä¸‹åˆ†æçœ‹çœ‹ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªè¯·æ±‚æœ¬è´¨ä¸Šç»“æœæ˜¯è·¯å¾„ï¼Œå®ƒæœ‰ä¸€ä¸ª .nodes() æ–¹æ³•å’Œ .relationships()æ–¹æ³•æ¥è·å¾—è·¯å¾„ä¸Šçš„ç‚¹å’Œè¾¹ï¼š In [11]: p=resp.row_values(22)[0].as_path() In [12]: p.nodes() Out[12]: [(\"c_132\" :corp{name: \"Chambers LLC\"}), (\"p_4000\" :person{name: \"Colton Bailey\"})] In [13]: p.relationships() Out[13]: [(\"p_4000\")-[:`role_as`@0{role: \"Editorial assistant\"}]-\u003e(\"c_132\")] å¯¹äºè¾¹æ¥è¯´æœ‰è¿™äº›æ–¹æ³• .edge_name(), .properties(), .start_vertex_id(), .end_vertex_id()ï¼Œè¿™é‡Œ edge_name æ˜¯è·å¾—è¾¹çš„ç±»å‹ã€‚ In [14]: rel=p.relationships()[0] In [15]: rel Out[15]: (\"p_4000\")-[:`role_as`@0{role: \"Editorial assistant\"}]-\u003e(\"c_132\") In [16]: rel.edge_name() Out[16]: '`role_as`' In [17]: rel.properties() Out[17]: {'role': \"Editorial assistant\"} In [18]: rel.start_vertex_id() Out[18]: \"p_4000\" In [19]: rel.end_vertex_id() Out[19]: \"c_132\" å¯¹äºç‚¹æ¥è¯´ï¼Œå¯ä»¥ç”¨åˆ°è¿™äº›æ–¹æ³• .tags(), properties, get_id()ï¼Œè¿™é‡Œè¾¹ tags æ˜¯è·å¾—ç‚¹çš„ç±»å‹ï¼Œå®ƒåœ¨ Nebula é‡Œå«æ ‡ç­¾tagã€‚ è¿™äº›æ¦‚å¿µå¯ä»¥åœ¨æ–‡æ¡£é‡Œè·å¾—æ›´è¯¦ç»†çš„è§£é‡Šã€‚ In [20]: node=p.nodes()[0] In [21]: node.tags() Out[21]: ['corp'] In [22]: node.properties('corp') Out[22]: {'name': \"Chambers LLC\"} In [23]: node.get_id() Out[23]: \"c_132\" ","date":"2021-11-24","objectID":"/corp-rel-graph/:5:1","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#nebula-python-client-sdk"},{"categories":["Nebula Graph","Mini Project"],"content":" 5.2 å‰ç«¯æ¸²æŸ“ç‚¹è¾¹ä¸ºå›¾ è¯¦ç»†çš„åˆ†æå¤§å®¶ä¹Ÿå¯ä»¥å‚è€ƒè¿™é‡Œ ä¸ºäº†æ–¹ä¾¿å®ç°ï¼Œæˆ‘ä»¬é‡‡ç”¨äº† Vue.js å’Œ vue-network-d3ï¼ˆD3 çš„ Vue Bindingï¼‰ã€‚ é€šè¿‡ vue-network-d3 çš„æŠ½è±¡ï¼Œèƒ½çœ‹å‡ºæ¥å–‚ç»™ä»–è¿™æ ·çš„æ•°æ®ï¼Œå°±å¯ä»¥æŠŠç‚¹è¾¹ä¿¡æ¯æ¸²æŸ“æˆå¾ˆå¥½çœ‹çš„å›¾ nodes: [ {\"id\": \"c_132\", \"name\": \"Chambers LLC\", \"tag\": \"corp\"}, {\"id\": \"p_4000\", \"name\": \"Colton Bailey\", \"tag\": \"person\"}], relationships: [ {\"source\": \"p_4000\", \"target\": \"c_132\", \"properties\": { \"role\": \"Editorial assistant\" }, \"edge\": \"`role_as`\"}] ","date":"2021-11-24","objectID":"/corp-rel-graph/:5:2","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#å‰ç«¯æ¸²æŸ“ç‚¹è¾¹ä¸ºå›¾"},{"categories":["Nebula Graph","Mini Project"],"content":" 5.3 å‰ç«¯\u003câ€“åç«¯ è¯¦ç»†ä¿¡æ¯å¯ä»¥å‚è€ƒè¿™é‡Œ æˆ‘ä»¬ä» D3 çš„åˆæ­¥ç ”ç©¶ä¸Šå¯ä»¥çŸ¥é“ï¼Œåç«¯åªéœ€è¦è¿”å›å¦‚ä¸‹çš„ JSON æ ¼å¼æ•°æ®å°±å¥½äº† Nodes: [{\"id\": \"c_132\", \"name\": \"Chambers LLC\", \"tag\": \"corp\"}, {\"id\": \"p_4000\", \"name\": \"Colton Bailey\", \"tag\": \"person\"}] Relationships: [{\"source\": \"p_4000\", \"target\": \"c_132\", \"properties\": { \"role\": \"Editorial assistant\" }, \"edge\": \"`role_as`\"}, {\"source\": \"p_1039\", \"target\": \"c_132\", \"properties\": { \"share\": \"3.0\" }, \"edge\": \"hold_share\"}] äºæ˜¯ï¼Œï¼Œç»“åˆå‰è¾¹æˆ‘ä»¬ç”¨ iPython åˆ†æ Python è¿”å›ç»“æœçœ‹ï¼Œè¿™ä¸ªé€»è¾‘å¤§æ¦‚æ˜¯ï¼š def make_graph_response(resp) -\u003e dict: nodes, relationships = list(), list() for row_index in range(resp.row_size()): path = resp.row_values(row_index)[0].as_path() _nodes = [ { \"id\": node.get_id(), \"tag\": node.tags()[0], \"name\": node.properties(node.tags()[0]).get(\"name\", \"\") } for node in path.nodes() ] nodes.extend(_nodes) _relationships = [ { \"source\": rel.start_vertex_id(), \"target\": rel.end_vertex_id(), \"properties\": rel.properties(), \"edge\": rel.edge_name() } for rel in path.relationships() ] relationships.extend(_relationships) return {\"nodes\": nodes, \"relationships\": relationships} å‰ç«¯åˆ°åç«¯çš„é€šä¿¡æ˜¯ HTTP ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å€ŸåŠ© Flaskï¼ŒæŠŠè¿™ä¸ªå‡½æ•°å°è£…æˆä¸€ä¸ª RESTful APIï¼š å‰ç«¯ç¨‹åºé€šè¿‡ HTTP POST åˆ° /api å‚è€ƒè¿™é‡Œ from flask import Flask, jsonify, request app = Flask(__name__) @app.route(\"/\") def root(): return \"Hey There?\" @app.route(\"/api\", methods=[\"POST\"]) def api(): request_data = request.get_json() entity = request_data.get(\"entity\", \"\") if entity: resp = query_shareholding(entity) data = make_graph_response(resp) else: data = dict() # tbd return jsonify(data) def parse_nebula_graphd_endpoint(): ng_endpoints_str = os.environ.get( 'NG_ENDPOINTS', '127.0.0.1:9669,').split(\",\") ng_endpoints = [] for endpoint in ng_endpoints_str: if endpoint: parts = endpoint.split(\":\") # we dont consider IPv6 now ng_endpoints.append((parts[0], int(parts[1]))) return ng_endpoints def query_shareholding(entity): query_string = ( f\"USE shareholding; \" f\"MATCH p=(v)-[e:`hold_share`|:`is_branch_of`|:`reletive_with`|:`role_as`*1..3]-(v2) \" f\"WHERE id(v) IN ['{ entity }'] RETURN p LIMIT 100\" ) session = connection_pool.get_session('root', 'nebula') resp = session.execute(query_string) return resp è¿™ä¸ªè¯·æ±‚çš„ç»“æœåˆ™æ˜¯å‰è¾¹å‰ç«¯æœŸå¾…çš„ JSONï¼Œåƒè¿™æ ·ï¼š curl --header \"Content-Type: application/json\" \\ --request POST \\ --data '{\"entity\": \"c_132\"}' \\ http://192.168.10.14:5000/api | jq { \"nodes\": [ { \"id\": \"c_132\", \"name\": \"\\\"Chambers LLC\\\"\", \"tag\": \"corp\" }, { \"id\": \"c_245\", \"name\": \"\\\"Thompson-King\\\"\", \"tag\": \"corp\" }, { \"id\": \"c_132\", \"name\": \"\\\"Chambers LLC\\\"\", \"tag\": \"corp\" }, ... } ], \"relationships\": [ { \"edge\": \"hold_share\", \"properties\": \"{'share': 0.0}\", \"source\": \"c_245\", \"target\": \"c_132\" { \"edge\": \"hold_share\", \"properties\": \"{'share': 9.0}\", \"source\": \"p_1767\", \"target\": \"c_132\" }, { \"edge\": \"hold_share\", \"properties\": \"{'share': 11.0}\", \"source\": \"p_1997\", \"target\": \"c_132\" }, ... }, { \"edge\": \"reletive_with\", \"properties\": \"{'degree': 51}\", \"source\": \"p_7283\", \"target\": \"p_4723\" } ] } ","date":"2021-11-24","objectID":"/corp-rel-graph/:5:3","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#å‰ç«¯--åç«¯"},{"categories":["Nebula Graph","Mini Project"],"content":" 5.4 æ”¾åˆ°ä¸€èµ·é¡¹ç›®çš„ä»£ç éƒ½åœ¨ GitHub ä¸Šï¼Œæœ€åå…¶å®åªæœ‰ä¸€ä¸¤ç™¾è¡Œçš„ä»£ç ï¼ŒæŠŠæ‰€æœ‰ä¸œè¥¿æ‹¼èµ·æ¥ä¹‹åçš„ä»£ç æ˜¯ï¼š â”œâ”€â”€ README.md # You could find Design Logs here â”œâ”€â”€ corp-rel-backend â”‚ â””â”€â”€ app.py # Flask App to handle Requst and calls GDB â”œâ”€â”€ corp-rel-frontend â”‚ â””â”€â”€ src â”‚ â”œâ”€â”€ App.vue â”‚ â””â”€â”€ main.js # Vue App to call Flask App and Renders Graph â””â”€â”€ requirements.txt ","date":"2021-11-24","objectID":"/corp-rel-graph/:5:4","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#æ”¾åˆ°ä¸€èµ·"},{"categories":["Nebula Graph","Mini Project"],"content":" 5.5 æœ€ç»ˆæ•ˆæœæˆ‘ä»¬åšå‡ºæ¥äº†ä¸€ä¸ªç®€é™‹ä½†æ˜¯è¶³å¤Ÿå…·æœ‰å‚è€ƒæ€§çš„å°ç³»ç»Ÿï¼Œå®ƒæ¥å—ä¸€ä¸ªç”¨æˆ·è¾“å…¥çš„å®ä½“çš„ IDï¼Œå†å›è½¦ä¹‹åï¼š å‰ç«¯ç¨‹åºæŠŠè¯·æ±‚å‘ç»™åç«¯ åç«¯æ‹¼æ¥ Nebula Graph çš„æŸ¥è¯¢è¯­å¥ï¼Œé€šè¿‡ Nebula Python å®¢æˆ·ç«¯è¯·æ±‚ Nebula Graph Nebula Graph æ¥å—è¯·æ±‚åšå‡ºç©¿é€æŸ¥è¯¢ï¼Œè¿”å›ç»“æ„ç»™åç«¯ åç«¯å°†ç»“æœæ„å»ºæˆå‰ç«¯ D3 æ¥å—çš„æ ¼å¼ï¼Œä¼ ç»™å‰ç«¯ å‰ç«¯æ¥æ”¶åˆ°å›¾ç»“æ„çš„æ•°æ®ï¼Œæ¸²æŸ“è‚¡æƒç©¿é€çš„æ•°æ®å¦‚ä¸‹ï¼š ","date":"2021-11-24","objectID":"/corp-rel-graph/:5:5","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#æœ€ç»ˆæ•ˆæœ"},{"categories":["Nebula Graph","Mini Project"],"content":" 6 æ€»ç»“ç°åœ¨ï¼Œæˆ‘ä»¬çŸ¥é“å¾—ç›Šäºå›¾æ•°æ®åº“çš„è®¾è®¡ï¼Œåœ¨å®ƒä¸Šè¾¹æ„å»ºä¸€ä¸ªæ–¹ä¾¿çš„è‚¡æƒåˆ†æç³»ç»Ÿéå¸¸è‡ªç„¶ã€é«˜æ•ˆï¼Œæˆ‘ä»¬æˆ–è€…åˆ©ç”¨å›¾æ•°æ®åº“çš„å›¾æ¢ç´¢å¯è§†åŒ–èƒ½åŠ›ã€æˆ–è€…è‡ªå·±æ­å»ºï¼Œå¯ä»¥ä¸ºç”¨æˆ·æä¾›éå¸¸é«˜æ•ˆã€ç›´è§‚çš„å¤šè·³è‚¡æƒç©¿é€åˆ†æã€‚ å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºåˆ†å¸ƒå¼å›¾æ•°æ®åº“çš„çŸ¥è¯†ï¼Œæ¬¢è¿å…³æ³¨ Nebula Graph è¿™ä¸ªå¼€æºé¡¹ç›®ï¼Œå®ƒå·²ç»è¢«å›½å†…å¾ˆå¤šå›¢é˜Ÿã€å…¬å¸è®¤å¯é€‰ä¸ºå›¾æ—¶ä»£æ•°æ®æŠ€æœ¯å­˜å‚¨å±‚çš„åˆ©å™¨ï¼Œå¤§å®¶å¯ä»¥è®¿é—®è¿™é‡Œï¼Œæˆ–è€…è¿™é‡Œï¼Œäº†è§£æ›´å¤šç›¸å…³çš„åˆ†äº«å’Œæ–‡ç« ã€‚ æœªæ¥ï¼Œæˆ‘ä¼šç»™å¤§å®¶åˆ†äº«æ›´å¤šå›¾æ•°æ®åº“ç›¸å…³çš„æ–‡ç« ã€è§†é¢‘å’Œå¼€æºç¤ºä¾‹é¡¹ç›®æ€è·¯åˆ†äº«å’Œæ•™ç¨‹ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨æˆ‘çš„ç½‘ç«™: siwei.ioã€‚ é¢˜å›¾ç‰ˆæƒï¼šfabioha ","date":"2021-11-24","objectID":"/corp-rel-graph/:6:0","series":null,"tags":["Nebula Graph","å›¾æ•°æ®åº“","è‚¡æƒç©¿é€","çŸ¥è¯†å›¾è°±"],"title":"ä»é›¶åˆ°ä¸€ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªä¼ä¸šè‚¡æƒå›¾è°±ç³»ç»Ÿï¼Ÿ","uri":"/corp-rel-graph/#æ€»ç»“"},{"categories":["Nebula Graph"],"content":"Dialog System With Graph Database Backed Knowledge Graph. åŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","date":"2021-09-18","objectID":"/nebula-siwi/","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/"},{"categories":["Nebula Graph"],"content":" ä¸€ä¸ªåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹é¡¹ç›®ã€‚ GitHub Repo: https://github.com/wey-gu/nebula-siwi/ è¿™ä¸ªé¡¹ç›®æˆ‘ä¹Ÿåšæˆäº†äº’åŠ¨æ•™ç¨‹ï¼Œå¯ä»¥æŒ‰ç…§è¿™é‡Œçš„æ­¥éª¤æ­å»ºèµ·æ¥ ğŸ‘‰ğŸ» https://siwei.io/cources/ update: å†™äº†ä¸€ç¯‡å®Œæ•´ä»‹ç» Siwi è®¾è®¡çš„æ–‡ç«  ğŸ‘‰ğŸ» https://siwei.io/siwi æ‚¨ä¹Ÿå¯ä»¥åœ¨ Nebula Playground ä¸Šç›´æ¥ç©è¿™ä¸ªæ•°æ®é›†å•¦ï¼šhttps://nebula-graph.com.cn/demo/ ","date":"2021-09-18","objectID":"/nebula-siwi/:0:0","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#"},{"categories":["Nebula Graph"],"content":" Siwi the voice assistantSiwi (/ËˆsÉªwi/) is a PoC of Dialog System With Graph Database Backed Knowledge Graph. For now, itâ€™s a demo for task-driven(not general purpose) dialog bots with KG(Knowledge Graph) leveraging Nebula Graph with the minimal/sample dataset from Nebula Graph Manual/ NGä¸­æ–‡æ‰‹å†Œ. Tips: Now you can play with the graph online without installing yourself! Nebula Playground | Nebula Playground - China Mainland Supported queries: relation: What is the relationship between Yao Ming and Lakers? How does Yao Ming and Lakers connected? serving: Which team had Yao Ming served? friendship: Whom does Tim Duncan follow? Who are Yao Mingâ€™s friends? ","date":"2021-09-18","objectID":"/nebula-siwi/:0:0","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#siwi-the-voice-assistant"},{"categories":["Nebula Graph"],"content":" 1 Deploy and TryTBD (leveraging docker and nebula-up) ","date":"2021-09-18","objectID":"/nebula-siwi/:1:0","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#deploy-and-try"},{"categories":["Nebula Graph"],"content":" 2 How does it work?This is one of the most naive pipeline for a specific domain/ single purpose chat bot built on a Knowledge Graph. ","date":"2021-09-18","objectID":"/nebula-siwi/:2:0","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#how-does-it-work"},{"categories":["Nebula Graph"],"content":" 2.1 Backend The Backend(Siwi API) is a Flask based API server: Flask API server takes questions in HTTP POST, and calls the bot API. In bot API part there are classfier(Symentic Parsing, Intent Matching, Slot Filling), and question actors(Call corresponding actions to query Knowledge Graph with intents and slots). Knowledge Graph is built on an Open-Source Graph Database: Nebula Graph ","date":"2021-09-18","objectID":"/nebula-siwi/:2:1","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#backend"},{"categories":["Nebula Graph"],"content":" 2.2 Frontend The Frontend is a VueJS Single Page Applicaiton(SPA): I reused a Vue Bot UI to showcase a chat window in this human-agent interaction, typing is supported. In addtion, leverating Chromeâ€™s Web Speech API, a button to listen to human voice is introduced ","date":"2021-09-18","objectID":"/nebula-siwi/:2:2","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#frontend"},{"categories":["Nebula Graph"],"content":" 2.3 A Query Flow â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ Speech â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Frontend â”‚ Siwi, /ËˆsÉªwi/ â”‚ â”‚ â”‚ Web_Speech_API â”‚ A PoC of â”‚ â”‚ â”‚ â”‚ Dialog System â”‚ â”‚ â”‚ Vue.JS â”‚ With Graph Database â”‚ â”‚ â”‚ â”‚ Backed Knowledge Graph â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Sentence â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Backend â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ Web API, Flask â”‚ ./app/ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ Sentence ./bot/ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Intent matching, â”‚ ./bot/classifierâ”‚ â”‚ â”‚ â”‚ â”‚ Symentic Processing â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ Intent, Entities â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Intent Actor â”‚ ./bot/actions â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Graph Query â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Graph Database â”‚ Nebula Graph â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ","date":"2021-09-18","objectID":"/nebula-siwi/:2:3","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#a-query-flow"},{"categories":["Nebula Graph"],"content":" 2.4 Source Code Tree . â”œâ”€â”€ README.md â”œâ”€â”€ src â”‚ â”œâ”€â”€ siwi # Siwi-API Backend â”‚ â”‚ â”œâ”€â”€ app # Web Server, take HTTP requests and calls Bot API â”‚ â”‚ â””â”€â”€ bot # Bot API â”‚ â”‚ â”œâ”€â”€ actions # Take Intent, Slots, Query Knowledge Graph here â”‚ â”‚ â”œâ”€â”€ bot # Entrypoint of the Bot API â”‚ â”‚ â”œâ”€â”€ classifier # Symentic Parsing, Intent Matching, Slot Filling â”‚ â”‚ â””â”€â”€ test # Example Data Source as equivalent/mocked module â”‚ â””â”€â”€ siwi_frontend # Browser End â”‚ â”œâ”€â”€ README.md â”‚ â”œâ”€â”€ package.json â”‚ â””â”€â”€ src â”‚ â”œâ”€â”€ App.vue # Listening to user and pass Questions to Siwi-API â”‚ â””â”€â”€ main.js â””â”€â”€ wsgi.py ","date":"2021-09-18","objectID":"/nebula-siwi/:2:4","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#source-code-tree"},{"categories":["Nebula Graph"],"content":" 3 Manually Run Components","date":"2021-09-18","objectID":"/nebula-siwi/:3:0","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#manually-run-components"},{"categories":["Nebula Graph"],"content":" 3.1 BackendInstall and run. # Install siwi backend python3 -m build # Configure Nebula Graph Endpoint export NG_ENDPOINTS=127.0.0.1:9669 # Run Backend API server gunicorn --bind :5000 wsgi --workers 1 --threads 1 --timeout 60 For OpenFunction/ KNative docker build -t weygu/siwi-api . docker run --rm --name siwi-api \\ --env=PORT=5000 \\ --env=NG_ENDPOINTS=127.0.0.1:9669 \\ --net=host \\ weygu/siwi-api Try it out Web API: $ curl --header \"Content-Type: application/json\" \\ --request POST \\ --data '{\"question\": \"What is the relationship between Yao Ming and Lakers?\"}' \\ http://192.168.8.128:5000/query | jq { \"answer\": \"There are at least 23 relations between Yao Ming and Lakers, one relation path is: Yao Ming follows Shaquille O'Neal serves Lakers.\" } Call Bot Python API: from nebula2.gclient.net import ConnectionPool from nebula2.Config import Config # define a config config = Config() config.max_connection_pool_size = 10 # init connection pool connection_pool = ConnectionPool() # if the given servers are ok, return true, else return false ok = connection_pool.init([('127.0.0.1', 9669)], config) # import siwi bot from siwi.bot import bot # instantiate a bot b = bot.SiwiBot(connection_pool) # make the question query b.query(\"Which team had Jonathon Simmons served?\") Then a response will be like this: In [4]: b.query(\"Which team had Jonathon Simmons serv ...: ed?\") [DEBUG] ServeAction intent: {'entities': {'Jonathon Simmons': 'player'}, 'intents': ('serve',)} [DEBUG] query for RelationshipAction: USE basketballplayer; MATCH p=(v)-[e:serve*1]-\u003e(v1) WHERE id(v) == \"player112\" RETURN p LIMIT 100; [2021-07-02 02:59:36,392]:Get connection to ('127.0.0.1', 9669) Out[4]: 'Jonathon Simmons had served 3 teams. Spurs from 2015 to 2015; 76ers from 2019 to 2019; Magic from 2017 to 2017; ' ","date":"2021-09-18","objectID":"/nebula-siwi/:3:1","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#backend-1"},{"categories":["Nebula Graph"],"content":" 3.2 FrontendReferring to siwi_frontend ","date":"2021-09-18","objectID":"/nebula-siwi/:3:2","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#frontend-1"},{"categories":["Nebula Graph"],"content":" 4 Further work Use NBA-API to fallback undefined pattern questions Wrap and manage sessions instead of get and release session per request, this is somehow costly actually. Use NLP methods to implement proper Symentic Parsing, Intent Matching, Slot Filling Build Graph to help with Intent Matching, especially for a general purpose bot Use larger Dataset i.e. from wyattowalsh/basketball ","date":"2021-09-18","objectID":"/nebula-siwi/:4:0","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#further-work"},{"categories":["Nebula Graph"],"content":" 5 Thanks to Upstream Projects â¤ï¸","date":"2021-09-18","objectID":"/nebula-siwi/:5:0","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#thanks-to-upstream-projects-"},{"categories":["Nebula Graph"],"content":" 5.1 Backend I learnt a lot from the KGQA on MedicalKG created by Huanyong Liu Flask pyahocorasick created by Wojciech MuÅ‚a PyYaml ","date":"2021-09-18","objectID":"/nebula-siwi/:5:1","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#backend-2"},{"categories":["Nebula Graph"],"content":" 5.2 Frontend VueJS for frontend framework Vue Bot UI, as a lovely bot UI in vue Vue Web Speech, for speech API vue wrapper Axios for browser http client Solarized for color scheme Vitesome for landing page design Image credit goes to https://unsplash.com/photos/0E_vhMVqL9g ","date":"2021-09-18","objectID":"/nebula-siwi/:5:2","series":null,"tags":["Nebula Graph","Know How","Intelligent assistant","å›¾æ•°æ®åº“åº”ç”¨","æ™ºèƒ½åŠ©æ‰‹"],"title":"Nebula Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹","uri":"/nebula-siwi/#frontend-2"},{"categories":["Nebula Graph"],"content":"Setup Nebula Graph Dev Env with CLion and Docker æ­å»ºåŸºäº Docker çš„ Nebula Graph CLion å¼€å‘ç¯å¢ƒ","date":"2021-09-18","objectID":"/nebula-clion/","series":null,"tags":["Nebula Graph","Dev Guide"],"title":"Nebula CLionï¼Œæ­å»ºåŸºäº Docker çš„ Nebula Graph CLion å¼€å‘ç¯å¢ƒ","uri":"/nebula-clion/"},{"categories":["Nebula Graph"],"content":" ä¹‹å‰å¡æ¯”åŒå­¦å‘æˆ‘å’¨è¯¢æ­å»º CLion ç¯å¢ƒï¼Œå¼€å‘ Nebula çš„ä¸€äº›é—®é¢˜ï¼Œæˆ‘åšäº†ä¸€äº›å·¥ä½œæ–¹ä¾¿åˆ©ç”¨ Docker åœ¨æœ¬åœ°æ­å»ºè¿™æ ·ä¸€ä¸ªç¯å¢ƒï¼Œç›¸å…³çš„ä¸œè¥¿æ”¾åœ¨ï¼šhttps://github.com/wey-gu/nebula-dev-CLion ã€‚ Related GitHub Repo: https://github.com/wey-gu/nebula-dev-CLion ","date":"2021-09-18","objectID":"/nebula-clion/:0:0","series":null,"tags":["Nebula Graph","Dev Guide"],"title":"Nebula CLionï¼Œæ­å»ºåŸºäº Docker çš„ Nebula Graph CLion å¼€å‘ç¯å¢ƒ","uri":"/nebula-clion/#"},{"categories":["Nebula Graph"],"content":" 1 Run Docker Env for Nebula-Graph with CLionBuild Docker Image git clone https://github.com/wey-gu/nebula-dev-CLion.git cd nebula-dev-CLion docker build -t wey/nebula-dev-clion:v2.0 . Run Docker Container for Nebula-Dev with CLion Integration Readiness(actually mostly Rsync \u0026 SSH). cd \u003cnebula-graph-repo-you-worked-on\u003e export DOCKER_DEFAULT_PLATFORM=linux/amd64 docker run --rm -d \\ --name nebula-dev \\ --security-opt seccomp=unconfined \\ -p 2222:22 -p 2873:873 --cap-add=ALL \\ -v $PWD:/home/nebula \\ -w /home/nebula \\ wey/nebula-dev-clion:v2.0 Verify cmake with SSH. The default password is password ssh -o StrictHostKeyChecking=no root@localhost -p 2222 # in docker cd /home/nebula mkdir build \u0026\u0026 cd build cmake -DENABLE_TESTING=OFF -DCMAKE_BUILD_TYPE=Release .. Access container w/o SSH. docker exec -it nebula-dev bash mkdir -p build \u0026\u0026 cd build cmake -DENABLE_TESTING=OFF -DCMAKE_BUILD_TYPE=Release .. ","date":"2021-09-18","objectID":"/nebula-clion/:1:0","series":null,"tags":["Nebula Graph","Dev Guide"],"title":"Nebula CLionï¼Œæ­å»ºåŸºäº Docker çš„ Nebula Graph CLion å¼€å‘ç¯å¢ƒ","uri":"/nebula-clion/#run-docker-env-for-nebula-graph-with-clion"},{"categories":["Nebula Graph"],"content":" 2 Configurations in CLion Ref: https://www.jetbrains.com/help/clion/clion-toolchains-in-docker.html#build-and-run Toolchains Add a remote host root@localhost:2222 password Put /opt/vesoft/toolset/cmake/bin/cmake as CMake CMake Toochain: Select the one created in last step Build directory: /home/nebula/build ","date":"2021-09-18","objectID":"/nebula-clion/:2:0","series":null,"tags":["Nebula Graph","Dev Guide"],"title":"Nebula CLionï¼Œæ­å»ºåŸºäº Docker çš„ Nebula Graph CLion å¼€å‘ç¯å¢ƒ","uri":"/nebula-clion/#configurations-in-clion"},{"categories":["Nebula Graph"],"content":" 3 The appendix","date":"2021-09-18","objectID":"/nebula-clion/:3:0","series":null,"tags":["Nebula Graph","Dev Guide"],"title":"Nebula CLionï¼Œæ­å»ºåŸºäº Docker çš„ Nebula Graph CLion å¼€å‘ç¯å¢ƒ","uri":"/nebula-clion/#the-appendix"},{"categories":["Nebula Graph"],"content":" 3.1 References of CMake output: [root@4c98e3f77ce8 build]# cmake -DENABLE_TESTING=OFF -DCMAKE_BUILD_TYPE=Release .. \u003e\u003e\u003e\u003e Options of Nebula Graph \u003c\u003c\u003c\u003c -- ENABLE_ASAN : OFF (Build with AddressSanitizer) -- ENABLE_BUILD_STORAGE : OFF (Whether to build storage) -- ENABLE_CCACHE : ON (Use ccache to speed up compiling) -- ENABLE_CLANG_TIDY : OFF (Enable clang-tidy if present) -- ENABLE_COMPRESSED_DEBUG_INFO : ON (Compress debug info to reduce binary size) -- ENABLE_COVERAGE : OFF (Build with coverage report) -- ENABLE_FRAME_POINTER : OFF (Build with frame pointer) -- ENABLE_FUZZY_TESTING : OFF (Enable Fuzzy tests) -- ENABLE_GDB_SCRIPT_SECTION : OFF (Add .debug_gdb_scripts section) -- ENABLE_JEMALLOC : ON (Use jemalloc as memory allocator) -- ENABLE_MODULE_FORCE_CHECKOUT : ON (Whether checkout branch of module to same as graph.) -- ENABLE_MODULE_UPDATE : OFF (Automatically update module) -- ENABLE_PACK_ONE : ON (Whether to package into one) -- ENABLE_PIC : OFF (Build with -fPIC) -- ENABLE_STATIC_ASAN : OFF (Statically link against libasan) -- ENABLE_STATIC_UBSAN : OFF (Statically link against libubsan) -- ENABLE_STRICT_ALIASING : OFF (Build with -fstrict-aliasing) -- ENABLE_TESTING : OFF (Build unit tests) -- ENABLE_TSAN : OFF (Build with ThreadSanitizer) -- ENABLE_UBSAN : OFF (Build with UndefinedBehaviourSanitizer) -- ENABLE_VERBOSE_BISON : OFF (Enable Bison to report state) -- ENABLE_WERROR : ON (Regard warnings as errors) -- CMAKE_BUILD_TYPE : Release (Choose the type of build, options are: None Debug Release RelWithDebInfo MinSizeRel ...) -- CMAKE_INSTALL_PREFIX : /usr/local/nebula (Install path prefix, prepended onto install directories.) -- CMAKE_CXX_STANDARD : 17 -- CMAKE_CXX_COMPILER : /opt/vesoft/toolset/clang/9.0.0/bin/c++ (CXX compiler) -- CMAKE_CXX_COMPILER_ID : GNU -- NEBULA_USE_LINKER : bfd -- CCACHE_DIR : /root/.ccache \u003e\u003e\u003e\u003e Configuring third party for 'Nebula Graph' \u003c\u003c\u003c\u003c -- NEBULA_THIRDPARTY_ROOT : /opt/vesoft/third-party/2.0 -- Build info of nebula third party: Package : Nebula Third Party Version : 2.0 Date : Mon Jun 28 15:07:38 UTC 2021 glibc : 2.17 Arch : x86_64 Compiler : GCC 9.2.0 C++ ABI : 11 Vendor : VEsoft Inc. -- CMAKE_INCLUDE_PATH : /opt/vesoft/third-party/2.0/include -- CMAKE_LIBRARY_PATH : /opt/vesoft/third-party/2.0/lib64;/opt/vesoft/third-party/2.0/lib -- CMAKE_PROGRAM_PATH : /opt/vesoft/third-party/2.0/bin -- GLIBC_VERSION : 2.17 -- found krb5-config here /opt/vesoft/third-party/2.0/bin/krb5-config -- Found kerberos 5 headers: /opt/vesoft/third-party/2.0/include -- Found kerberos 5 libs: /opt/vesoft/third-party/2.0/lib/libgssapi_krb5.a;/opt/vesoft/third-party/2.0/lib/libkrb5.a;/opt/vesoft/third-party/2.0/lib/libk5crypto.a;/opt/vesoft/third-party/2.0/lib/libcom_err.a;/opt/vesoft/third-party/2.0/lib/libkrb5support.a \u003e\u003e\u003e\u003e Configuring third party for 'Nebula Graph' done \u003c\u003c\u003c\u003c -- Create the pre-commit hook -- Creating pre-commit hook done \u003e\u003e\u003e\u003e Configuring Nebula Common \u003c\u003c\u003c\u003c \u003e\u003e\u003e\u003e Options of Nebula Common \u003c\u003c\u003c\u003c -- ENABLE_ASAN : OFF (Build with AddressSanitizer) -- ENABLE_CCACHE : ON (Use ccache to speed up compiling) -- ENABLE_CLANG_TIDY : OFF (Enable clang-tidy if present) -- ENABLE_COMPRESSED_DEBUG_INFO : ON (Compress debug info to reduce binary size) -- ENABLE_COVERAGE : OFF (Build with coverage report) -- ENABLE_FRAME_POINTER : OFF (Build with frame pointer) -- ENABLE_FUZZY_TESTING : OFF (Enable Fuzzy tests) -- ENABLE_GDB_SCRIPT_SECTION : OFF (Add .debug_gdb_scripts section) -- ENABLE_JEMALLOC : ON (Use jemalloc as memory allocator) -- ENABLE_PIC : OFF (Build with -fPIC) -- ENABLE_STATIC_ASAN : OFF (Statically link against libasan) -- ENABLE_STATIC_UBSAN : OFF (Statically link against libubsan) -- ENABLE_STRICT_ALIASING : OFF (Build with -fstrict-aliasing) -- ENABLE_TESTING : OFF (Build unit tests) -- ENABLE_TSAN : OFF (Build with ThreadSanitizer) -- ENABLE_UBSAN : OFF (Build with UndefinedBehaviourSanitizer) -- ENABLE_WERROR : ON (Regard warnings as errors) -- Set D_GLIBCXX_USE_CXX11_ABI to 1 -- CMAKE_BUI","date":"2021-09-18","objectID":"/nebula-clion/:3:1","series":null,"tags":["Nebula Graph","Dev Guide"],"title":"Nebula CLionï¼Œæ­å»ºåŸºäº Docker çš„ Nebula Graph CLion å¼€å‘ç¯å¢ƒ","uri":"/nebula-clion/#references-of-cmake-output"},{"categories":["courses"],"content":"Hands-on Course: Breakdown multistage relationship of Persons and Corporations leverating the Nebula Graph Database.","date":"2021-09-04","objectID":"/learn/nebula-101-shareholding/","series":null,"tags":["Nebula Graph","katacoda","shareholding","Nebula Solution","Knowledge Graph"],"title":"ä¸Šæ‰‹å®æˆ˜å›¾æ•°æ®åº“è‚¡æƒå…³ç³»ç©¿é€","uri":"/learn/nebula-101-shareholding/"},{"categories":["courses"],"content":"Walk you through in actions to do below sections exercises! Bootstrap a Nebula Graph Cluster and Studio Web App Import a graph of dataset about shareholding Exploring the shareholding data with Nebula Importer Visually Exploring the shareholding data with Nebula Studio Run Graph Algorithm on Nebula Cluster Graph Data The dataset comes from https://github.com/wey-gu/nebula-shareholding-example/tree/main/data_sample è¯¾ç¨‹å¼€æºåœ¨ https://github.com/wey-gu/katacoda-scenarios ï¼Œæ¬¢è¿æ¥åé¦ˆï¼Œè´¡çŒ® ","date":"2021-09-04","objectID":"/learn/nebula-101-shareholding/:0:0","series":null,"tags":["Nebula Graph","katacoda","shareholding","Nebula Solution","Knowledge Graph"],"title":"ä¸Šæ‰‹å®æˆ˜å›¾æ•°æ®åº“è‚¡æƒå…³ç³»ç©¿é€","uri":"/learn/nebula-101-shareholding/#"},{"categories":null,"content":" æ‚¨å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¼å›¾å¼€å§‹äº†è§£ã€å…¥é—¨å›¾æ•°æ®åº“å’Œ Nebula Graphï¼Œä¸Šè¾¹çš„åŒºåŸŸæ˜¯å…¥é—¨çš„éƒ¨åˆ†ï¼Œä¸‹è¾¹è¿˜æœ‰è¿›é˜¶çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šæŒç»­æ›´æ–°ã€ç»´æŠ¤è¿™ä¸ªå¯¼å›¾çš„~ Tips: åŠ è½½æˆåŠŸä¹‹åï¼Œç‚¹å‡» [See the board] å¯ä»¥å¼€å§‹æµè§ˆï¼ŒåŒå‡»æ”¾å¤§ç¼©å°ã€‚ æˆ–è€…ç‚¹å¯¼å›¾åŒºåŸŸå³ä¸Šè§’çš„ç®­å¤´åœ¨æ–°çš„çª—å£æ‰“å¼€ï¼Œå¯ä»¥æ›´æ–¹é¢æµè§ˆå™¨ä¸­å†…å®¹ã€‚ ","date":"2021-09-04","objectID":"/path/:0:0","series":null,"tags":null,"title":"å›¾æ•°æ®åº“å­¦ä¹ è·¯å¾„","uri":"/path/#"},{"categories":["courses"],"content":"Hands-on Course: Setup a KGQA system from scratch with Nebula Graph, VueJS, Flask on K8s.","date":"2021-09-03","objectID":"/learn/nebula-101-siwi-kgqa/","series":null,"tags":["Nebula Graph","katacoda","Dialog System","Nebula Solution"],"title":"ä¸Šæ‰‹å®æˆ˜ä»0åˆ¶ä½œä¸€ä¸ªåŸºäºå›¾è°±çš„è¯­éŸ³æ™ºèƒ½åŠ©æ‰‹","uri":"/learn/nebula-101-siwi-kgqa/"},{"categories":["courses"],"content":"A full solution walkthrough for a Knowledge Graph Dialog System. Boostrap a Nebula Cluster in K8s Scale out the Nebula Cluster in K8s way Import the basketballplayer Dataset Siwi, the Knowledge Graph Dialog System with Nebula Graph Siwi (/ËˆsÉªwi/) is a PoC of Dialog System With Graph Database Backed Knowledge Graph. The code of Siwi is here: https://github.com/wey-gu/nebula-siwi. è¯¾ç¨‹å¼€æºåœ¨ https://github.com/wey-gu/katacoda-scenarios ï¼Œæ¬¢è¿æ¥åé¦ˆï¼Œè´¡çŒ® ","date":"2021-09-03","objectID":"/learn/nebula-101-siwi-kgqa/:0:0","series":null,"tags":["Nebula Graph","katacoda","Dialog System","Nebula Solution"],"title":"ä¸Šæ‰‹å®æˆ˜ä»0åˆ¶ä½œä¸€ä¸ªåŸºäºå›¾è°±çš„è¯­éŸ³æ™ºèƒ½åŠ©æ‰‹","uri":"/learn/nebula-101-siwi-kgqa/#"},{"categories":["Nebula Graph"],"content":"A demo of Shareholding Breakthrough with Distributed open-source Graph Database: Nebula Graph. å›¾æ•°æ®åº“åº”ç”¨ç¤ºä¾‹ï¼šè‚¡æƒå…³ç³»ç©¿é€","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/"},{"categories":["Nebula Graph"],"content":" A demo of Shareholding Breakthrough with Distributed open-source Graph Database: Nebula Graph. å›¾æ•°æ®åº“åº”ç”¨ç¤ºä¾‹ï¼šè‚¡æƒå…³ç³»ç©¿é€ Related GitHub Repo: https://github.com/wey-gu/nebula-shareholding-example æ›´æ–°ï¼šåœ¨è¿™ä¸ªæ•°æ®é›†ç”Ÿæˆçš„å·¥ä½œåŸºç¡€ä¸Šï¼Œæˆ‘åˆåšäº†ä¸€ä¸ªå…¨æ ˆç¤ºä¾‹é¡¹ç›® ğŸ‘‰ğŸ» https://siwei.io/corp-rel-graph/ è¿™ä¸ªé¡¹ç›®æˆ‘ä¹Ÿåšæˆäº†äº’åŠ¨æ•™ç¨‹ï¼Œå¯ä»¥æŒ‰ç…§è¿™é‡Œçš„æ­¥éª¤æ­å»ºèµ·æ¥ ğŸ‘‰ğŸ» https://siwei.io/cources/ I created the Katacoda Interactive Env for this project ğŸ‘‰ğŸ» https://siwei.io/cources/ æ‚¨ä¹Ÿå¯ä»¥åœ¨ Nebula Playground ä¸Šç›´æ¥ç©è¿™ä¸ªæ•°æ®é›†å•¦ï¼šhttps://nebula-graph.com.cn/demo/ Now you can play with the data on Nebula Playground: https://nebula-graph.io/demo/ This is a demo of Shareholding Relationship Analysis with Distributed open-source Graph Database: Nebula Graph. ","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/:0:0","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/#"},{"categories":["Nebula Graph"],"content":" 1 Data","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/:1:0","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/#data"},{"categories":["Nebula Graph"],"content":" 1.1 Data Modeling There are various kinds of relationships when we checking companiesâ€™ shareholding breakthrough, here letâ€™s simplify it with only two kind of entities: person and corp, and with following relationship types. person can hold a corp in {share} % person can be relative with another person corp can hold another corp in {share} % corp can be a branch of another corp person can be as a role of a corp Below is the lines to reflect this graph modele in Nebula Graph, itâ€™s quite straightforward, right? CREATE TAG person(name string); CREATE TAG corp(name string); CREATE EDGE role_as(role string); CREATE EDGE is_branch_of(); CREATE EDGE hold_share(share float); CREATE EDGE reletive_with(degree int); ","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/:1:1","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/#data-modeling"},{"categories":["Nebula Graph"],"content":" 1.2 Data GenerationWe just randomly generate some data to help with this demo, you can call data_generator.py directly to generate or reuse whatâ€™s already done under data_sample folder. The generated data are records to be fit in above data model from below .csv files. $ pip install Faker==2.0.5 pydbgen==1.0.5 $ python3 data_generator.py $ ls -l data total 1688 -rw-r--r-- 1 weyl staff 23941 Jul 14 13:28 corp.csv -rw-r--r-- 1 weyl staff 1277 Jul 14 13:26 corp_rel.csv -rw-r--r-- 1 weyl staff 3048 Jul 14 13:26 corp_share.csv -rw-r--r-- 1 weyl staff 211661 Jul 14 13:26 person.csv -rw-r--r-- 1 weyl staff 179770 Jul 14 13:26 person_corp_role.csv -rw-r--r-- 1 weyl staff 322965 Jul 14 13:26 person_corp_share.csv -rw-r--r-- 1 weyl staff 17689 Jul 14 13:26 person_rel.csv ","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/:1:2","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/#data-generation"},{"categories":["Nebula Graph"],"content":" 1.3 Data ImportWith those data in .csv files, we can easily import them into a Nebula Graph Cluster with the help of Nebula-Importer. nebula-importer.yaml in this repo describes rules and configurations on how this import will be done by the importer. For Nebula Graph Database, plesae refer to Doc , Doc-CN to deploy on any Linux Servers, for study and test, you can run it via Docker following the Quick Start Chapter of the documentation. For Nebula-Importer, if you already have Docker env, you can run it as the following without installing anything. Or, if you prefer to install it, itâ€™s quite easy as itâ€™s written in Golang and you can run its single file binary quite easily, go check both Documentation and Nebula-Importer Repo: https://github.com/vesoft-inc/nebula-importer. Letâ€™s start! Below is the commands I used to import our data into a Nebula Graph Database. # put generated data \u0026 nebula-importor.yaml to nebula-importer server $ scp -r data nebula_graph_host:~ $ scp nebula-importer.yaml data nebula_graph_host:~/data $ ssh nebula_graph_host $ ls -l ${HOME}/data total 756 -rw-r--r--. 1 wei.gu wei.gu 23941 Jul 14 05:44 corp.csv -rw-r--r--. 1 wei.gu wei.gu 1277 Jul 14 05:44 corp_rel.csv -rw-r--r--. 1 wei.gu wei.gu 3048 Jul 14 05:44 corp_share.csv -rw-r--r--. 1 wei.gu wei.gu 3893 Jul 14 05:44 nebula-importer.yaml -rw-r--r--. 1 wei.gu wei.gu 211661 Jul 14 05:44 person.csv -rw-r--r--. 1 wei.gu wei.gu 179770 Jul 14 05:44 person_corp_role.csv -rw-r--r--. 1 wei.gu wei.gu 322965 Jul 14 05:44 person_corp_share.csv -rw-r--r--. 1 wei.gu wei.gu 17689 Jul 14 05:44 person_rel.csv # import data into our nebula graph database $ docker run --rm -ti \\ --network=nebula-docker-compose_nebula-net \\ -v ${HOME}/data/nebula-importer.yaml:/root/nebula-importer.yaml \\ -v ${HOME}/data:/root \\ vesoft/nebula-importer:v2 \\ --config /root/nebula-importer.yaml 2021/07/14 05:49:32 --- START OF NEBULA IMPORTER --- 2021/07/14 05:49:32 [WARN] config.go:491: Not set files[0].schema.vertex.vid.Type, reset to default value `string' ... 2021/07/14 05:49:43 [INFO] reader.go:180: Total lines of file(/root/person_corp_role.csv) is: 5000, error lines: 1287 2021/07/14 05:49:43 [INFO] statsmgr.go:61: Done(/root/person_corp_role.csv): Time(11.39s), Finished(12523), Failed(0), Latency AVG(1514us), Batches Req AVG(1824us), Rows AVG(1099.43/s) 2021/07/14 05:49:47 [INFO] statsmgr.go:61: Tick: Time(15.00s), Finished(25807), Failed(0), Latency AVG(1500us), Batches Req AVG(1805us), Rows AVG(1720.46/s) 2021/07/14 05:49:48 [INFO] reader.go:180: Total lines of file(/root/person.csv) is: 10000, error lines: 0 2021/07/14 05:49:48 [INFO] statsmgr.go:61: Done(/root/person.csv): Time(16.10s), Finished(29731), Failed(0), Latency AVG(1505us), Batches Req AVG(1810us), Rows AVG(1847.17/s) 2021/07/14 05:49:50 [INFO] reader.go:180: Total lines of file(/root/person_corp_share.csv) is: 20000, error lines: 0 2021/07/14 05:49:50 [INFO] statsmgr.go:61: Done(/root/person_corp_share.csv): Time(17.74s), Finished(36013), Failed(0), Latency AVG(1531us), Batches Req AVG(1844us), Rows AVG(2030.29/s) 2021/07/14 05:49:50 Finish import data, consume time: 18.25s 2021/07/14 05:49:51 --- END OF NEBULA IMPORTER --- ","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/:1:3","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/#data-import"},{"categories":["Nebula Graph"],"content":" 2 Corporation sharehold relationship breakthrough 2.0.1 Query in nGQLWe can query from corp: c_132 over *(all relationships) in BIDIRECT: GO 1 TO 3 STEPS FROM \"c_132\" over * BIDIRECT Below are lines I call this query in nebula-console: / # nebula-console -addr 192.168.8.128 -port 9669 -user user -password password 2021/07/14 07:07:41 [INFO] connection pool is initialized successfully Welcome to Nebula Graph! (user@nebula) [(none)]\u003e show spaces +--------------------+ | Name | +--------------------+ | \"basketballplayer\" | +--------------------+ | \"shareholding\" | +--------------------+ Got 2 rows (time spent 3851/4595 us) Wed, 14 Jul 2021 07:07:57 UTC (user@nebula) [(none)]\u003e use shareholding Execution succeeded (time spent 1822/2342 us) Wed, 14 Jul 2021 07:08:02 UTC (user@nebula) [shareholding]\u003e GO 1 TO 3 STEPS FROM \"c_132\" over * BIDIRECT +--------------+-------------------+-----------------+--------------------+ | role_as._dst | is_branch_of._dst | hold_share._dst | reletive_with._dst | +--------------+-------------------+-----------------+--------------------+ | \"p_2024\" | | | | +--------------+-------------------+-----------------+--------------------+ | \"p_4000\" | | | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_245\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"p_1039\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"p_1399\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"p_1767\" | | ... +--------------+-------------------+-----------------+--------------------+ | | | \"c_132\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_245\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_25\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_649\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_753\" | | +--------------+-------------------+-----------------+--------------------+ Got 1519 rows (time spent 12190/14702 us) Wed, 14 Jul 2021 07:08:06 UTC 2.0.2 In a Visual WayOf course, we can also be done in a visual way: Step 1, login from Nebula Graph Studio, explore with one VID: c_132: Step2, click this explored vertex dot, then you can explore from select vertices by selecting: Edge Type Direction Steps Query Limit(Optional) note, you can click the ğŸ‘ï¸ icon to add options to show fields of the graph, Step3, after click Expand, you will see all quried relations with c_132 the Chambers LLC. ","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/:2:0","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/#corporation-sharehold-relationship-breakthrough"},{"categories":["Nebula Graph"],"content":" 2 Corporation sharehold relationship breakthrough 2.0.1 Query in nGQLWe can query from corp: c_132 over *(all relationships) in BIDIRECT: GO 1 TO 3 STEPS FROM \"c_132\" over * BIDIRECT Below are lines I call this query in nebula-console: / # nebula-console -addr 192.168.8.128 -port 9669 -user user -password password 2021/07/14 07:07:41 [INFO] connection pool is initialized successfully Welcome to Nebula Graph! (user@nebula) [(none)]\u003e show spaces +--------------------+ | Name | +--------------------+ | \"basketballplayer\" | +--------------------+ | \"shareholding\" | +--------------------+ Got 2 rows (time spent 3851/4595 us) Wed, 14 Jul 2021 07:07:57 UTC (user@nebula) [(none)]\u003e use shareholding Execution succeeded (time spent 1822/2342 us) Wed, 14 Jul 2021 07:08:02 UTC (user@nebula) [shareholding]\u003e GO 1 TO 3 STEPS FROM \"c_132\" over * BIDIRECT +--------------+-------------------+-----------------+--------------------+ | role_as._dst | is_branch_of._dst | hold_share._dst | reletive_with._dst | +--------------+-------------------+-----------------+--------------------+ | \"p_2024\" | | | | +--------------+-------------------+-----------------+--------------------+ | \"p_4000\" | | | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_245\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"p_1039\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"p_1399\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"p_1767\" | | ... +--------------+-------------------+-----------------+--------------------+ | | | \"c_132\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_245\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_25\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_649\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_753\" | | +--------------+-------------------+-----------------+--------------------+ Got 1519 rows (time spent 12190/14702 us) Wed, 14 Jul 2021 07:08:06 UTC 2.0.2 In a Visual WayOf course, we can also be done in a visual way: Step 1, login from Nebula Graph Studio, explore with one VID: c_132: Step2, click this explored vertex dot, then you can explore from select vertices by selecting: Edge Type Direction Steps Query Limit(Optional) note, you can click the ğŸ‘ï¸ icon to add options to show fields of the graph, Step3, after click Expand, you will see all quried relations with c_132 the Chambers LLC. ","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/:2:0","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/#query-in-ngql"},{"categories":["Nebula Graph"],"content":" 2 Corporation sharehold relationship breakthrough 2.0.1 Query in nGQLWe can query from corp: c_132 over *(all relationships) in BIDIRECT: GO 1 TO 3 STEPS FROM \"c_132\" over * BIDIRECT Below are lines I call this query in nebula-console: / # nebula-console -addr 192.168.8.128 -port 9669 -user user -password password 2021/07/14 07:07:41 [INFO] connection pool is initialized successfully Welcome to Nebula Graph! (user@nebula) [(none)]\u003e show spaces +--------------------+ | Name | +--------------------+ | \"basketballplayer\" | +--------------------+ | \"shareholding\" | +--------------------+ Got 2 rows (time spent 3851/4595 us) Wed, 14 Jul 2021 07:07:57 UTC (user@nebula) [(none)]\u003e use shareholding Execution succeeded (time spent 1822/2342 us) Wed, 14 Jul 2021 07:08:02 UTC (user@nebula) [shareholding]\u003e GO 1 TO 3 STEPS FROM \"c_132\" over * BIDIRECT +--------------+-------------------+-----------------+--------------------+ | role_as._dst | is_branch_of._dst | hold_share._dst | reletive_with._dst | +--------------+-------------------+-----------------+--------------------+ | \"p_2024\" | | | | +--------------+-------------------+-----------------+--------------------+ | \"p_4000\" | | | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_245\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"p_1039\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"p_1399\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"p_1767\" | | ... +--------------+-------------------+-----------------+--------------------+ | | | \"c_132\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_245\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_25\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_649\" | | +--------------+-------------------+-----------------+--------------------+ | | | \"c_753\" | | +--------------+-------------------+-----------------+--------------------+ Got 1519 rows (time spent 12190/14702 us) Wed, 14 Jul 2021 07:08:06 UTC 2.0.2 In a Visual WayOf course, we can also be done in a visual way: Step 1, login from Nebula Graph Studio, explore with one VID: c_132: Step2, click this explored vertex dot, then you can explore from select vertices by selecting: Edge Type Direction Steps Query Limit(Optional) note, you can click the ğŸ‘ï¸ icon to add options to show fields of the graph, Step3, after click Expand, you will see all quried relations with c_132 the Chambers LLC. ","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/:2:0","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/#in-a-visual-way"},{"categories":["Nebula Graph"],"content":" 3 Thanks to Upstream Projects â¤ï¸ Python Faker https://github.com/joke2k/faker/ pydbgen https://github.com/tirthajyoti/pydbgen Nebula Graph https://github.com/vesoft-inc/nebula-graph ","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/:3:0","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/#thanks-to-upstream-projects-"},{"categories":["Nebula Graph"],"content":" 3.1 Tips: You can deploy nebula graph in one line with: Nebula-UP, it helps install a nebula graph with Docker Nebula-operator-KIND , it helps setup all dependencies of Nebula-K8s-Operator including a K8s in Docker, PV Provider and then install a Nebula Graph with Nebula-Operator in K8s. Image Credit goes to https://unsplash.com/photos/3fPXt37X6UQ ","date":"2021-08-28","objectID":"/nebula-holdshare-dataset/:3:1","series":null,"tags":["Nebula Graph","Know How","Shareholding Relationship Analysis","å›¾æ•°æ®åº“åº”ç”¨","è‚¡æƒç©¿é€"],"title":"Nebula Holdshare Datasetï¼Œå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€","uri":"/nebula-holdshare-dataset/#tips"},{"categories":null,"content":" è‚¡æƒç©¿é€æ•™ç¨‹ 1. ä¸Šæ‰‹å®æˆ˜å›¾æ•°æ®åº“è‚¡æƒå…³ç³»ç©¿é€ 2. ä½“éªŒ Nebula-Up ä¸€é”®éƒ¨ç½² Nebula Core + Studio é˜…è¯»å…¨æ–‡ Siwi 1. ä¸Šæ‰‹å®æˆ˜ä» 0 åˆ¶ä½œä¸€ä¸ªåŸºäºå›¾è°±çš„è¯­éŸ³æ™ºèƒ½åŠ©æ‰‹ 2. ä½“éªŒ Nebula-Kind-Operator ä¸€é”®éƒ¨ç½² K8s + Nebula Operator é˜…è¯»å…¨æ–‡ ","date":"2021-08-26","objectID":"/cources/:0:0","series":null,"tags":null,"title":"ä¸Šæ‰‹è¯¾ç¨‹","uri":"/cources/#"},{"categories":null,"content":" æ˜é‡‘æ˜¥æ‹›æ´»åŠ¨ é‚£äº›æˆ‘å¸Œæœ›è¿‡å»çš„è‡ªå·±å¯ä»¥çŸ¥é“çš„äº‹å® é˜…è¯»å…¨æ–‡ DoK Talks #116 Nebula Graph: Open Source Distributed GraphDB é˜…è¯»å…¨æ–‡ Data on K8s Community 2021 GraphDB on Kubesphere é˜…è¯»å…¨æ–‡ K8s Community Day 2021 Openfunction + GraphDB é˜…è¯»å…¨æ–‡ COScon 2021 æˆ‘çš„å¼€æºä¹‹è·¯ é˜…è¯»å…¨æ–‡ PyCon China 2021 å›¾æ•°æ®åº“è§£è°œä¸ Python çš„å›¾åº“åº”ç”¨å®è·µ é˜…è¯»å…¨æ–‡ K8s ä¸Šçš„å›¾æ•°æ®åº“ Nebula K8s Operator çš„å®ç°è§£æï¼Œå›¾æ•°æ®åº“åº”ç”¨åœ¨ K8s + OpenFunction ä¸Šçš„è½åœ°æ¼”ç¤º é˜…è¯»å…¨æ–‡ nMeetup: Nebula åº”ç”¨ä¸Šæ‰‹å®æ“ ä»å¤´å®æ“ Nebula çš„éƒ¨ç½²ï¼Œè‚¡æƒç©¿é€ï¼Œå›¾ç®—æ³•è¿ç®—ï¼Œè¯­éŸ³æ™ºèƒ½åŠ©æ‰‹ã€‚ é˜…è¯»å…¨æ–‡ How to Train your Dragon å¦‚ä½•æˆä¸ºå¼€æºå¼€å‘è€…ï¼ˆå¸ƒé“å¸ˆï¼‰ã€‚ é˜…è¯»å…¨æ–‡ ","date":"2021-08-26","objectID":"/talk/:0:0","series":null,"tags":null,"title":"æˆ‘çš„æ¼”è®²","uri":"/talk/#"},{"categories":["Nebula Graph"],"content":"Import LiveJournal Dataset into Nebula Graph and Run Nebula Algorithm å¯¼å…¥ Livejournal æ•°æ®é›†åˆ° Nebula å¹¶è¿è¡Œ Nebula Algorithm å›¾ç®—æ³•","date":"2021-08-24","objectID":"/nebula-livejournal/","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/"},{"categories":["Nebula Graph"],"content":" ä¸€ä¸ªå¯¼å…¥ Livejournal æ•°æ®é›†åˆ° Nebula Graph å›¾æ•°æ®åº“ï¼Œå¹¶æ‰§è¡Œ Nebula Algorithm å›¾ç®—æ³•çš„è¿‡ç¨‹åˆ†äº«ã€‚ Related GitHub Repo: https://github.com/wey-gu/nebula-LiveJournal ","date":"2021-08-24","objectID":"/nebula-livejournal/:0:0","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#"},{"categories":["Nebula Graph"],"content":" nebula-LiveJournalLiveJournal Dataset is a Social Network Dataset in one file with two columns(FromNodeId, ToNodeId). $ head soc-LiveJournal1.txt # Directed graph (each unordered pair of nodes is saved once): soc-LiveJournal1.txt # Directed LiveJournal friednship social network # Nodes: 4847571 Edges: 68993773 # FromNodeId ToNodeId 0 1 0 2 0 3 0 4 0 5 0 6 It could be accessed in https://snap.stanford.edu/data/soc-LiveJournal1.html. Dataset statistics Nodes 4847571 Edges 68993773 Nodes in largest WCC 4843953 (0.999) Edges in largest WCC 68983820 (1.000) Nodes in largest SCC 3828682 (0.790) Edges in largest SCC 65825429 (0.954) Average clustering coefficient 0.2742 Number of triangles 285730264 Fraction of closed triangles 0.04266 Diameter (longest shortest path) 16 90-percentile effective diameter 6.5 ","date":"2021-08-24","objectID":"/nebula-livejournal/:0:0","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#nebula-livejournal"},{"categories":["Nebula Graph"],"content":" 1 Dataset Download and Preprocessing","date":"2021-08-24","objectID":"/nebula-livejournal/:1:0","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#dataset-download-and-preprocessing"},{"categories":["Nebula Graph"],"content":" 1.1 DownloadIt is accesissiable from the official web page: $ cd nebula-livejournal/data $ wget https://snap.stanford.edu/data/soc-LiveJournal1.txt.gz Comments in data file should be removed to make the data import tool happy. ","date":"2021-08-24","objectID":"/nebula-livejournal/:1:1","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#download"},{"categories":["Nebula Graph"],"content":" 1.2 Preprocessing $ gzip -d soc-LiveJournal1.txt.gz $ sed -i '1,4d' soc-LiveJournal1.txt ","date":"2021-08-24","objectID":"/nebula-livejournal/:1:2","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#preprocessing"},{"categories":["Nebula Graph"],"content":" 2 Import dataset to Nebula Graph","date":"2021-08-24","objectID":"/nebula-livejournal/:2:0","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#import-dataset-to-nebula-graph"},{"categories":["Nebula Graph"],"content":" 2.1 With Nebula ImporterNebula-Importer is a Golang Headless import tool for Nebula Graph. You may need to edit the config file under nebula-importer/importer.yaml on Nebula Graphâ€™s address and credentialã€‚ Then, Nebula-Importer could be called in Docker as follow: $ cd nebula-livejournal $ docker run --rm -ti \\ --network=nebula-net \\ -v nebula-importer/importer.yaml:/root/importer.yaml \\ -v data/:/root \\ vesoft/nebula-importer:v2 \\ --config /root/importer.yaml Or if you have the binary nebula-importer locally: $ cd data $ \u003cpath_to_nebula-importer_binary\u003e --config ../nebula-importer/importer.yaml ","date":"2021-08-24","objectID":"/nebula-livejournal/:2:1","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#with-nebula-importer"},{"categories":["Nebula Graph"],"content":" 2.2 With Nebula ExchangeNebula-Exchange is a Spark Application to enable batch and streaming data import from multiple data sources to Nebula Graph. To be done. (You can refer to https://siwei.io/nebula-exchange-sst-2.x/) ","date":"2021-08-24","objectID":"/nebula-livejournal/:2:2","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#with-nebula-exchange"},{"categories":["Nebula Graph"],"content":" 3 Run Algorithms with Nebula GraphNebula-Algorithm is a Spark/GraphX Application to run Graph Algorithms with data consumed from files or a Nebula Graph Cluster. Supported Algorithms for now: Name Use Case PageRank page ranking, important node digging Louvain community digging, hierarchical clustering KCore community detection, financial risk control LabelPropagation community detection, consultation propagation, advertising recommendation ConnectedComponent community detection, isolated island detection StronglyConnectedComponent community detection ShortestPath path plan, network plan TriangleCount network structure analysis BetweennessCentrality important node digging, node influence calculation DegreeStatic graph structure analysis ","date":"2021-08-24","objectID":"/nebula-livejournal/:3:0","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#run-algorithms-with-nebula-graph"},{"categories":["Nebula Graph"],"content":" 3.1 Ad-hoc Spark Env setupHere I assume the Nebula Graph was bootstraped with Nebula-Up, thus nebula is running in a Docker Network named nebula-docker-compose_nebula-net. Then letâ€™s start a single server spark: docker run --name spark-master --network nebula-docker-compose_nebula-net \\ -h spark-master -e ENABLE_INIT_DAEMON=false -d \\ -v nebula-algorithm/:/root \\ bde2020/spark-master:2.4.5-hadoop2.7 Thus we could make spark application submt inside this container: docker exec -it spark-master bash cd /root/ # download Nebula-Algorithm Jar Packagem, 2.0.0 for example, for other versions, refer to nebula-algorithm github repo and documentations. wget https://repo1.maven.org/maven2/com/vesoft/nebula-algorithm/2.0.0/nebula-algorithm-2.0.0.jar ","date":"2021-08-24","objectID":"/nebula-livejournal/:3:1","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#ad-hoc-spark-env-setup"},{"categories":["Nebula Graph"],"content":" 3.2 Run AlgorithmsThere are many altorithms supported by Nebula-Algorithm, here some of their configuration files were put under nebula-algorithm as an example. Before using them, please first edit and change Nebula Graph Cluster Addresses and credentials. vim nebula-altorithm/algo-pagerank.conf Then we could enter the spark container and call corresponding algorithms as follow. Please adjust your --driver-memeory accordingly, i.e. pagerank altorithm: /spark/bin/spark-submit --master \"local\" --conf spark.rpc.askTimeout=6000s \\ --class com.vesoft.nebula.algorithm.Main \\ --driver-memory 16g nebula-algorithm-2.0.0.jar \\ -p pagerank.conf After the algorithm finished, the output will be under the path insdie the container defined in conf file: write:{ resultPath:/output/ } é¢˜å›¾ç‰ˆæƒï¼š@sigmund ","date":"2021-08-24","objectID":"/nebula-livejournal/:3:2","series":null,"tags":["Nebula Graph","LiveJournal","Nebula Algorithm","PageRank","Graph Algorithm"],"title":"Nebula LiveJournalï¼Œä¸Šæ‰‹ LiveJournal æ•°æ®é›†å¯¼å…¥ Nebula Graph ä¸å›¾ç®—æ³•æ‰§è¡Œ","uri":"/nebula-livejournal/#run-algorithms"},{"categories":["Nebula Graph"],"content":"è¿™ç¯‡æ–‡ç« å¸¦å¤§å®¶ä»¥æœ€å°æ–¹å¼ï¼Œå¿«é€Ÿè¶Ÿä¸€ä¸‹ Nebula Exchange ä¸­ SST å†™å…¥æ–¹å¼çš„æ­¥éª¤ã€‚","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/"},{"categories":["Nebula Graph"],"content":"è¿™ç¯‡æ–‡ç« å¸¦å¤§å®¶ä»¥æœ€å°æ–¹å¼ï¼Œå¿«é€Ÿè¶Ÿä¸€ä¸‹ Nebula Exchange ä¸­ SST å†™å…¥æ–¹å¼çš„æ­¥éª¤ã€‚ ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:0:0","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#"},{"categories":["Nebula Graph"],"content":" 1 ä»€ä¹ˆæ˜¯ Nebula Exchange ?ä¹‹å‰æˆ‘åœ¨ Nebula Data Import Options ä¹‹ä¸­ä»‹ç»è¿‡ï¼ŒNebula Exchange æ˜¯ä¸€ä¸ª Nebula Graph ç¤¾åŒºå¼€æºçš„ Spark Applicaitonï¼Œå®ƒä¸“é—¨ç”¨æ¥æ”¯æŒæ‰¹é‡æˆ–è€…æµå¼åœ°æŠŠæ•°æ®å¯¼å…¥ Nebula Graph Database ä¹‹ä¸­ã€‚ Nebula Exchange æ”¯æŒå¤šç§å¤šæ ·çš„æ•°æ®æºï¼ˆä» Apache Parquet, ORC, JSON, CSV, HBase, Hive MaxCompute åˆ° Neo4j, MySQL, ClickHouse, å†æœ‰ Kafka, Pulsarï¼Œæ›´å¤šçš„æ•°æ®æºä¹Ÿåœ¨ä¸æ–­å¢åŠ ä¹‹ä¸­ï¼‰ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨ Exchange å†…éƒ¨ï¼Œä»é™¤äº†ä¸åŒ Reader å¯ä»¥è¯»å–ä¸åŒæ•°æ®æºä¹‹å¤–ï¼Œåœ¨æ•°æ®ç»è¿‡ Processor å¤„ç†ä¹‹åé€šè¿‡ Writerå†™å…¥ï¼ˆsinkï¼‰ Nebula Graph å›¾æ•°æ®åº“çš„æ—¶å€™ï¼Œé™¤äº†èµ°æ­£å¸¸çš„ ServerBaseWriter çš„å†™å…¥æµç¨‹ä¹‹å¤–ï¼Œå®ƒè¿˜å¯ä»¥ç»•è¿‡æ•´ä¸ªå†™å…¥æµç¨‹ï¼Œåˆ©ç”¨ Spark çš„è®¡ç®—èƒ½åŠ›å¹¶è¡Œç”Ÿæˆåº•å±‚ RocksDB çš„ SST æ–‡ä»¶ï¼Œä»è€Œå®ç°è¶…é«˜æ€§èƒ½çš„æ•°æ®å¯¼å…¥ï¼Œè¿™ä¸ª SST æ–‡ä»¶å¯¼å…¥çš„åœºæ™¯å°±æ˜¯æœ¬æ–‡å¸¦å¤§å®¶ä¸Šæ‰‹ç†Ÿæ‚‰çš„éƒ¨åˆ†ã€‚ è¯¦ç»†ä¿¡æ¯è¯·å‚é˜…ï¼šNebula Graph æ‰‹å†Œ:ä»€ä¹ˆæ˜¯ Nebula Exchange Nebula Graph å®˜æ–¹åšå®¢ä¹Ÿæœ‰æ›´å¤š Nebula Exchange çš„å®è·µæ–‡ç«  ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:1:0","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#ä»€ä¹ˆæ˜¯-nebula-exchange-"},{"categories":["Nebula Graph"],"content":" 2 æ­¥éª¤æ¦‚è§‚ å®éªŒç¯å¢ƒ é…ç½® Exchange ç”Ÿæˆ SST æ–‡ä»¶ å†™å…¥ SST æ–‡ä»¶åˆ° Nebula Graph ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:2:0","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#æ­¥éª¤æ¦‚è§‚"},{"categories":["Nebula Graph"],"content":" 3 å®éªŒç¯å¢ƒå‡†å¤‡ä¸ºäº†æœ€å°åŒ–ä½¿ç”¨ Nebula Exchange çš„ SST åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦ï¼š æ­å»ºä¸€ä¸ª Nebula Graph é›†ç¾¤ï¼Œåˆ›å»ºå¯¼å…¥æ•°æ®çš„ Schemaï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ Docker-Compose æ–¹å¼ã€åˆ©ç”¨ Nebula-Up å¿«é€Ÿéƒ¨ç½²ï¼Œå¹¶ç®€å•ä¿®æ”¹å…¶ç½‘ç»œï¼Œä»¥æ–¹ä¾¿åŒæ ·å®¹å™¨åŒ–çš„ Exchange ç¨‹åºå¯¹å…¶è®¿é—®ã€‚ æ­å»ºå®¹å™¨åŒ–çš„ Spark è¿è¡Œç¯å¢ƒ æ­å»ºå®¹å™¨åŒ–çš„ HDFS ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:3:0","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#å®éªŒç¯å¢ƒå‡†å¤‡"},{"categories":["Nebula Graph"],"content":" 3.1 1. æ­å»º Nebula Graph é›†ç¾¤å€ŸåŠ©äº Nebula-Up æˆ‘ä»¬å¯ä»¥åœ¨ Linux ç¯å¢ƒä¸‹ä¸€é”®éƒ¨ç½²ä¸€å¥— Nebula Graph é›†ç¾¤ï¼š curl -fsSL nebula-up.siwei.io/install.sh | bash å¾…éƒ¨ç½²æˆåŠŸä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç¯å¢ƒåšä¸€äº›ä¿®æ”¹ï¼Œè¿™é‡Œæˆ‘åšçš„ä¿®æ”¹å…¶å®å°±æ˜¯ä¸¤ç‚¹ï¼š åªä¿ç•™ä¸€ä¸ª metaD æœåŠ¡ èµ·ç”¨ Docker çš„å¤–éƒ¨ç½‘ç»œ è¯¦ç»†ä¿®æ”¹çš„éƒ¨åˆ†å‚è€ƒé™„å½•ä¸€ åº”ç”¨ docker-compose çš„ä¿®æ”¹ï¼š cd ~/.nebula-up/nebula-docker-compose vim docker-compose.yaml # å‚è€ƒé™„å½•ä¸€ docker network create nebula-net # éœ€è¦åˆ›å»ºå¤–éƒ¨ç½‘ç»œ docker-compose up -d --remove-orphans ä¹‹åï¼Œæˆ‘ä»¬æ¥åˆ›å»ºè¦æµ‹è¯•çš„å›¾ç©ºé—´ï¼Œå¹¶åˆ›å»ºå›¾çš„ Schemaï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ nebula-console ï¼ŒåŒæ ·ï¼ŒNebula-Up é‡Œè‡ªå¸¦äº†å®¹å™¨åŒ–çš„ nebula-consoleã€‚ è¿›å…¥ Nebula-Console æ‰€åœ¨çš„å®¹å™¨ ~/.nebula-up/console.sh / # åœ¨ console å®¹å™¨é‡Œå‘èµ·é“¾æ¥åˆ°å›¾æ•°æ®åº“ï¼Œå…¶ä¸­ 192.168.x.y æ˜¯æˆ‘æ‰€åœ¨çš„ Linux VM çš„ç¬¬ä¸€ä¸ªç½‘å¡åœ°å€ï¼Œè¯·æ¢æˆæ‚¨çš„ / # nebula-console -addr 192.168.x.y -port 9669 -user root -p password [INFO] connection pool is initialized successfully Welcome to Nebula Graph! åˆ›å»ºå›¾ç©ºé—´ï¼ˆæˆ‘ä»¬èµ·åå­—å« sst ï¼‰ï¼Œä»¥åŠ schema create space sst(partition_num=5,replica_factor=1,vid_type=fixed_string(32)); :sleep 20 use sst create tag player(name string, age int); ç¤ºä¾‹è¾“å‡º (root@nebula) [(none)]\u003e create space sst(partition_num=5,replica_factor=1,vid_type=fixed_string(32)); Execution succeeded (time spent 1468/1918 us) (root@nebula) [(none)]\u003e :sleep 20 (root@nebula) [(none)]\u003e use sst Execution succeeded (time spent 1253/1566 us) Wed, 18 Aug 2021 08:18:13 UTC (root@nebula) [sst]\u003e create tag player(name string, age int); Execution succeeded (time spent 1312/1735 us) Wed, 18 Aug 2021 08:18:23 UTC ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:3:1","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#1-æ­å»º-nebula-graph-é›†ç¾¤"},{"categories":["Nebula Graph"],"content":" 3.2 æ­å»ºå®¹å™¨åŒ–çš„ Spark ç¯å¢ƒåˆ©ç”¨ big data europe åšçš„å·¥ä½œï¼Œè¿™ä¸ªè¿‡ç¨‹éå¸¸å®¹æ˜“ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š ç°åœ¨çš„ Nebula Exchange å¯¹ Spark çš„ç‰ˆæœ¬æœ‰è¦æ±‚ï¼Œåœ¨ç°åœ¨çš„ 2021 å¹´ 8 æœˆï¼Œæˆ‘æ˜¯ç”¨äº† spark-2.4.5-hadoop-2.7 çš„ç‰ˆæœ¬ã€‚ ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘è®© Spark è¿è¡Œåœ¨ Nebula Graph ç›¸åŒçš„æœºå™¨ä¸Šï¼Œå¹¶ä¸”æŒ‡å®šäº†è¿è¡Œåœ¨åŒä¸€ä¸ª Docker ç½‘ç»œä¸‹ docker run --name spark-master --network nebula-net \\ -h spark-master -e ENABLE_INIT_DAEMON=false -d \\ bde2020/spark-master:2.4.5-hadoop2.7 ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥åˆ°ç¯å¢ƒä¸­äº†ï¼š docker exec -it spark-master bash è¿›åˆ° Spark å®¹å™¨ä¸­ä¹‹åï¼Œå¯ä»¥åƒè¿™æ ·å®‰è£… maven: export MAVEN_VERSION=3.5.4 export MAVEN_HOME=/usr/lib/mvn export PATH=$MAVEN_HOME/bin:$PATH wget http://archive.apache.org/dist/maven/maven-3/$MAVEN_VERSION/binaries/apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ tar -zxvf apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ rm apache-maven-$MAVEN_VERSION-bin.tar.gz \u0026\u0026 \\ mv apache-maven-$MAVEN_VERSION /usr/lib/mvn è¿˜å¯ä»¥è¿™æ ·åœ¨å®¹å™¨é‡Œä¸‹è½½ nebula-exchange çš„ jar åŒ…ï¼š cd ~ wget https://repo1.maven.org/maven2/com/vesoft/nebula-exchange/2.1.0/nebula-exchange-2.1.0.jar ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:3:2","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#æ­å»ºå®¹å™¨åŒ–çš„-spark-ç¯å¢ƒ"},{"categories":["Nebula Graph"],"content":" 3.3 æ­å»ºå®¹å™¨åŒ–çš„ HDFSåŒæ ·å€ŸåŠ© big-data-euroupe çš„å·¥ä½œï¼Œè¿™éå¸¸ç®€å•ï¼Œä¸è¿‡æˆ‘ä»¬è¦åšä¸€ç‚¹ä¿®æ”¹ï¼Œè®©å®ƒçš„ docker-compose.yml æ–‡ä»¶é‡Œä½¿ç”¨ nebula-net è¿™ä¸ªä¹‹å‰åˆ›å»ºçš„ Docker ç½‘ç»œã€‚ è¯¦ç»†ä¿®æ”¹çš„éƒ¨åˆ†å‚è€ƒé™„å½•äºŒ git clone https://github.com/big-data-europe/docker-hadoop.git cd docker-hadoop vim docker-compose.yml docker-compose up -d ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:3:3","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#æ­å»ºå®¹å™¨åŒ–çš„-hdfs"},{"categories":["Nebula Graph"],"content":" 4 é…ç½®Exchangeè¿™ä¸ªé…ç½®ä¸»è¦å¡«å…¥çš„ä¿¡æ¯å°±æ˜¯ Nebula Graph é›†ç¾¤æœ¬èº«å’Œå°†è¦å†™å…¥æ•°æ®çš„ Space Nameï¼Œä»¥åŠæ•°æ®æºç›¸å…³çš„é…ç½®ï¼ˆè¿™é‡Œæˆ‘ä»¬ç”¨ csv ä½œä¸ºä¾‹å­ï¼‰ï¼Œæœ€åå†é…ç½®è¾“å‡ºï¼ˆsinkï¼‰ä¸º sst Nebula Graph GraphD åœ°å€ MetaD åœ°å€ credential Space Name æ•°æ®æº source: csv path fields etc. ink: sst è¯¦ç»†çš„é…ç½®å‚è€ƒé™„å½•äºŒ æ³¨æ„ï¼Œè¿™é‡Œ metaD çš„åœ°å€å¯ä»¥è¿™æ ·è·å–ï¼Œå¯ä»¥çœ‹åˆ° 0.0.0.0:49377-\u003e9559 è¡¨ç¤º 49377 æ˜¯å¤–éƒ¨çš„åœ°å€ã€‚ $ docker ps | grep meta 887740c15750 vesoft/nebula-metad:v2.0.0 \"./bin/nebula-metad â€¦\" 6 hours ago Up 6 hours (healthy) 9560/tcp, 0.0.0.0:49377-\u003e9559/tcp, :::49377-\u003e9559/tcp, 0.0.0.0:49376-\u003e19559/tcp, :::49376-\u003e19559/tcp, 0.0.0.0:49375-\u003e19560/tcp, :::49375-\u003e19560/tcp nebula-docker-compose_metad0_1 ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:4:0","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#é…ç½®exchange"},{"categories":["Nebula Graph"],"content":" 5 ç”ŸæˆSSTæ–‡ä»¶","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:5:0","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#ç”Ÿæˆsstæ–‡ä»¶"},{"categories":["Nebula Graph"],"content":" 5.1 å‡†å¤‡æºæ–‡ä»¶ã€é…ç½®æ–‡ä»¶ docker cp exchange-sst.conf spark-master:/root/ docker cp player.csv spark-master:/root/ å…¶ä¸­ player.csv çš„ä¾‹å­ï¼š 1100,Tim Duncan,42 1101,Tony Parker,36 1102,LaMarcus Aldridge,33 1103,Rudy Gay,32 1104,Marco Belinelli,32 1105,Danny Green,31 1106,Kyle Anderson,25 1107,Aron Baynes,32 1108,Boris Diaw,36 1109,Tiago Splitter,34 1110,Cory Joseph,27 1111,David West,38 ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:5:1","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#å‡†å¤‡æºæ–‡ä»¶é…ç½®æ–‡ä»¶"},{"categories":["Nebula Graph"],"content":" 5.2 æ‰§è¡Œ exchange ç¨‹åºè¿›å…¥ spark-master å®¹å™¨ï¼Œæäº¤æ‰§è¡Œ exchange åº”ç”¨ã€‚ docker exec -it spark-master bash cd /root/ /spark/bin/spark-submit --master local \\ --class com.vesoft.nebula.exchange.Exchange nebula-exchange-2.1.0.jar\\ -c exchange-sst.conf æ£€æŸ¥æ‰§è¡Œç»“æœï¼š spark-submit è¾“å‡ºï¼š 21/08/17 03:37:43 INFO TaskSetManager: Finished task 31.0 in stage 2.0 (TID 33) in 1093 ms on localhost (executor driver) (32/32) 21/08/17 03:37:43 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 21/08/17 03:37:43 INFO DAGScheduler: ResultStage 2 (foreachPartition at VerticesProcessor.scala:179) finished in 22.336 s 21/08/17 03:37:43 INFO DAGScheduler: Job 1 finished: foreachPartition at VerticesProcessor.scala:179, took 22.500639 s 21/08/17 03:37:43 INFO Exchange$: SST-Import: failure.player: 0 21/08/17 03:37:43 WARN Exchange$: Edge is not defined 21/08/17 03:37:43 INFO SparkUI: Stopped Spark web UI at http://spark-master:4040 21/08/17 03:37:43 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped! éªŒè¯ HDFS ä¸Šç”Ÿæˆçš„ SST æ–‡ä»¶ï¼š docker exec -it namenode /bin/bash root@2db58903fb53:/# hdfs dfs -ls /sst Found 10 items drwxr-xr-x - root supergroup 0 2021-08-17 03:37 /sst/1 drwxr-xr-x - root supergroup 0 2021-08-17 03:37 /sst/10 drwxr-xr-x - root supergroup 0 2021-08-17 03:37 /sst/2 drwxr-xr-x - root supergroup 0 2021-08-17 03:37 /sst/3 drwxr-xr-x - root supergroup 0 2021-08-17 03:37 /sst/4 drwxr-xr-x - root supergroup 0 2021-08-17 03:37 /sst/5 drwxr-xr-x - root supergroup 0 2021-08-17 03:37 /sst/6 drwxr-xr-x - root supergroup 0 2021-08-17 03:37 /sst/7 drwxr-xr-x - root supergroup 0 2021-08-17 03:37 /sst/8 drwxr-xr-x - root supergroup 0 2021-08-17 03:37 /sst/9 ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:5:2","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#æ‰§è¡Œ-exchange-ç¨‹åº"},{"categories":["Nebula Graph"],"content":" 6 å†™å…¥SSTåˆ°NebulaGraphè¿™é‡Œçš„æ“ä½œå®é™…ä¸Šéƒ½æ˜¯å‚è€ƒæ–‡æ¡£ï¼šSST å¯¼å…¥ï¼Œå¾—æ¥ã€‚å…¶ä¸­å°±æ˜¯ä» console ä¹‹ä¸­æ‰§è¡Œäº†ä¸¤æ­¥æ“ä½œï¼š Download Ingest å…¶ä¸­ Download å®é™…ä¸Šæ˜¯è§¦å‘ Nebula Graph ä»æœåŠ¡ç«¯å‘èµ· HDFS Client çš„ downloadï¼Œè·å– HDFS ä¸Šçš„ SST æ–‡ä»¶ï¼Œç„¶åæ”¾åˆ° storageD èƒ½è®¿é—®çš„æœ¬åœ°è·¯å¾„ä¸‹ï¼Œè¿™é‡Œï¼Œéœ€è¦æˆ‘ä»¬åœ¨æœåŠ¡ç«¯éƒ¨ç½² HDFS çš„ä¾èµ–ã€‚å› ä¸ºæˆ‘ä»¬æ˜¯æœ€å°å®è·µï¼Œæˆ‘å°±å·æ‡’æ‰‹åŠ¨åšäº†è¿™ä¸ª Download çš„æ“ä½œã€‚ ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:6:0","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#å†™å…¥sståˆ°nebulagraph"},{"categories":["Nebula Graph"],"content":" 6.1 æ‰‹åŠ¨ä¸‹è½½è¿™é‡Œè¾¹æ‰‹åŠ¨ä¸‹è½½æˆ‘ä»¬å°±è¦çŸ¥é“ Nebula Graph æœåŠ¡ç«¯ä¸‹è½½çš„è·¯å¾„ï¼Œå®é™…ä¸Šæ˜¯ /data/storage/nebula/\u003cspace_id\u003e/download/ï¼Œè¿™é‡Œçš„ Space ID éœ€è¦æ‰‹åŠ¨è·å–ä¸€ä¸‹ï¼š è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬çš„ Space Name æ˜¯ sstï¼Œè€Œ Space ID æ˜¯ 49ã€‚ (root@nebula) [sst]\u003e DESC space sst +----+-------+------------------+----------------+---------+------------+--------------------+-------------+-----------+ | ID | Name | Partition Number | Replica Factor | Charset | Collate | Vid Type | Atomic Edge | Group | +----+-------+------------------+----------------+---------+------------+--------------------+-------------+-----------+ | 49 | \"sst\" | 10 | 1 | \"utf8\" | \"utf8_bin\" | \"FIXED_STRING(32)\" | \"false\" | \"default\" | +----+-------+------------------+----------------+---------+------------+--------------------+-------------+-----------+ äºæ˜¯ï¼Œä¸‹è¾¹çš„æ“ä½œå°±æ˜¯æ‰‹åŠ¨æŠŠ SST æ–‡ä»¶ä» HDFS ä¹‹ä¸­ get ä¸‹æ¥ï¼Œå†æ‹·è´åˆ° storageD ä¹‹ä¸­ã€‚ docker exec -it namenode /bin/bash $ hdfs dfs -get /sst /sst exit docker cp namenode:/sst . docker exec -it nebula-docker-compose_storaged0_1 mkdir -p /data/storage/nebula/49/download/ docker exec -it nebula-docker-compose_storaged1_1 mkdir -p /data/storage/nebula/49/download/ docker exec -it nebula-docker-compose_storaged2_1 mkdir -p /data/storage/nebula/49/download/ docker cp sst nebula-docker-compose_storaged0_1:/data/storage/nebula/49/download/ docker cp sst nebula-docker-compose_storaged1_1:/data/storage/nebula/49/download/ docker cp sst nebula-docker-compose_storaged2_1:/data/storage/nebula/49/download/ ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:6:1","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#æ‰‹åŠ¨ä¸‹è½½"},{"categories":["Nebula Graph"],"content":" 6.2 SST æ–‡ä»¶å¯¼å…¥ è¿›å…¥ Nebula-Console æ‰€åœ¨çš„å®¹å™¨ ~/.nebula-up/console.sh / # åœ¨ console å®¹å™¨é‡Œå‘èµ·é“¾æ¥åˆ°å›¾æ•°æ®åº“ï¼Œå…¶ä¸­ 192.168.x.y æ˜¯æˆ‘æ‰€åœ¨çš„ Linux VM çš„ç¬¬ä¸€ä¸ªç½‘å¡åœ°å€ï¼Œè¯·æ¢æˆæ‚¨çš„ / # nebula-console -addr 192.168.x.y -port 9669 -user root -p password [INFO] connection pool is initialized successfully Welcome to Nebula Graph! æ‰§è¡Œ INGEST å¼€å§‹è®© StorageD è¯»å– SST æ–‡ä»¶ (root@nebula) [(none)]\u003e use sst (root@nebula) [sst]\u003e INGEST; æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹æ–¹æ³•å®æ—¶æŸ¥çœ‹ Nebula Graph æœåŠ¡ç«¯çš„æ—¥å¿— tail -f ~/.nebula-up/nebula-docker-compose/logs/*/* æˆåŠŸçš„ INGEST æ—¥å¿—ï¼š I0817 08:03:28.611877 169 EventListner.h:96] Ingest external SST file: column family default, the external file path /data/storage/nebula/49/download/8/8-6.sst, the internal file path /data/storage/nebula/49/data/000023.sst, the properties of the table: # data blocks=1; # entries=1; # deletions=0; # merge operands=0; # range deletions=0; raw key size=48; raw average key size=48.000000; raw value size=40; raw average value size=40.000000; data block size=75; index block size (user-key? 0, delta-value? 0)=66; filter block size=0; (estimated) table size=141; filter policy name=N/A; prefix extractor name=nullptr; column family ID=N/A; column family name=N/A; comparator name=leveldb.BytewiseComparator; merge operator name=nullptr; property collectors names=[]; SST file compression algo=Snappy; SST file compression options=window_bits=-14; level=32767; strategy=0; max_dict_bytes=0; zstd_max_train_bytes=0; enabled=0; ; creation time=0; time stamp of earliest key=0; file creation time=0; E0817 08:03:28.611912 169 StorageHttpIngestHandler.cpp:63] SSTFile ingest successfully é¢˜å›¾ç‰ˆæƒï¼šPietro Jeng ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:6:2","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#sst-æ–‡ä»¶å¯¼å…¥"},{"categories":["Nebula Graph"],"content":" 7 é™„å½•","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:7:0","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#é™„å½•"},{"categories":["Nebula Graph"],"content":" 7.1 é™„å½•ä¸€docker-compose.yaml diff --git a/docker-compose.yaml b/docker-compose.yaml index 48854de..cfeaedb 100644 --- a/docker-compose.yaml +++ b/docker-compose.yaml @@ -6,11 +6,13 @@ services: USER: root TZ: \"${TZ}\" command: - - --meta_server_addrs=metad0:9559,metad1:9559,metad2:9559 + - --meta_server_addrs=metad0:9559 - --local_ip=metad0 - --ws_ip=metad0 - --port=9559 - --ws_http_port=19559 + - --ws_storage_http_port=19779 - --data_path=/data/meta - --log_dir=/logs - --v=0 @@ -34,81 +36,14 @@ services: cap_add: - SYS_PTRACE - metad1: - image: vesoft/nebula-metad:v2.0.0 - environment: - USER: root - TZ: \"${TZ}\" - command: - - --meta_server_addrs=metad0:9559,metad1:9559,metad2:9559 - - --local_ip=metad1 - - --ws_ip=metad1 - - --port=9559 - - --ws_http_port=19559 - - --data_path=/data/meta - - --log_dir=/logs - - --v=0 - - --minloglevel=0 - healthcheck: - test: [\"CMD\", \"curl\", \"-sf\", \"http://metad1:19559/status\"] - interval: 30s - timeout: 10s - retries: 3 - start_period: 20s - ports: - - 9559 - - 19559 - - 19560 - volumes: - - ./data/meta1:/data/meta - - ./logs/meta1:/logs - networks: - - nebula-net - restart: on-failure - cap_add: - - SYS_PTRACE - - metad2: - image: vesoft/nebula-metad:v2.0.0 - environment: - USER: root - TZ: \"${TZ}\" - command: - - --meta_server_addrs=metad0:9559,metad1:9559,metad2:9559 - - --local_ip=metad2 - - --ws_ip=metad2 - - --port=9559 - - --ws_http_port=19559 - - --data_path=/data/meta - - --log_dir=/logs - - --v=0 - - --minloglevel=0 - healthcheck: - test: [\"CMD\", \"curl\", \"-sf\", \"http://metad2:19559/status\"] - interval: 30s - timeout: 10s - retries: 3 - start_period: 20s - ports: - - 9559 - - 19559 - - 19560 - volumes: - - ./data/meta2:/data/meta - - ./logs/meta2:/logs - networks: - - nebula-net - restart: on-failure - cap_add: - - SYS_PTRACE - storaged0: image: vesoft/nebula-storaged:v2.0.0 environment: USER: root TZ: \"${TZ}\" command: - - --meta_server_addrs=metad0:9559,metad1:9559,metad2:9559 + - --meta_server_addrs=metad0:9559 - --local_ip=storaged0 - --ws_ip=storaged0 - --port=9779 @@ -119,8 +54,8 @@ services: - --minloglevel=0 depends_on: - metad0 - - metad1 - - metad2 healthcheck: test: [\"CMD\", \"curl\", \"-sf\", \"http://storaged0:19779/status\"] interval: 30s @@ -146,7 +81,7 @@ services: USER: root TZ: \"${TZ}\" command: - - --meta_server_addrs=metad0:9559,metad1:9559,metad2:9559 + - --meta_server_addrs=metad0:9559 - --local_ip=storaged1 - --ws_ip=storaged1 - --port=9779 @@ -157,8 +92,8 @@ services: - --minloglevel=0 depends_on: - metad0 - - metad1 - - metad2 healthcheck: test: [\"CMD\", \"curl\", \"-sf\", \"http://storaged1:19779/status\"] interval: 30s @@ -184,7 +119,7 @@ services: USER: root TZ: \"${TZ}\" command: - - --meta_server_addrs=metad0:9559,metad1:9559,metad2:9559 + - --meta_server_addrs=metad0:9559 - --local_ip=storaged2 - --ws_ip=storaged2 - --port=9779 @@ -195,8 +130,8 @@ services: - --minloglevel=0 depends_on: - metad0 - - metad1 - - metad2 healthcheck: test: [\"CMD\", \"curl\", \"-sf\", \"http://storaged2:19779/status\"] interval: 30s @@ -222,17 +157,19 @@ services: USER: root TZ: \"${TZ}\" command: - - --meta_server_addrs=metad0:9559,metad1:9559,metad2:9559 + - --meta_server_addrs=metad0:9559 - --port=9669 - --ws_ip=graphd - --ws_http_port=19669 + - --ws_meta_http_port=19559 - --log_dir=/logs - --v=0 - --minloglevel=0 depends_on: - metad0 - - metad1 - - metad2 healthcheck: test: [\"CMD\", \"curl\", \"-sf\", \"http://graphd:19669/status\"] interval: 30s @@ -257,17 +194,19 @@ services: USER: root TZ: \"${TZ}\" command: - - --meta_server_addrs=metad0:9559,metad1:9559,metad2:9559 + - --meta_server_addrs=metad0:9559 - --port=9669 - --ws_ip=graphd1 - --ws_http_port=19669 + - --ws_meta_http_port=19559 - --log_dir=/logs - --v=0 - --minloglevel=0 depends_on: - metad0 - - metad1 - - metad2 healthcheck: test: [\"CMD\", \"curl\", \"-sf\", \"http://graphd1:19669/status\"] interval: 30s @@ -292,17 +231,21 @@ services: USER: root TZ: \"${TZ}\" command: - - --meta_server_addrs=metad0:9559,metad1:9559,metad2:9559 + - --meta_server_addrs=me","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:7:1","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#é™„å½•ä¸€"},{"categories":["Nebula Graph"],"content":" 7.2 é™„å½•äºŒhttps://github.com/big-data-europe/docker-hadoop çš„ docker-compose.yml diff --git a/docker-compose.yml b/docker-compose.yml index ed40dc6..66ff1f4 100644 --- a/docker-compose.yml +++ b/docker-compose.yml @@ -14,6 +14,8 @@ services: - CLUSTER_NAME=test env_file: - ./hadoop.env + networks: + - nebula-net datanode: image: bde2020/hadoop-datanode:2.0.0-hadoop3.2.1-java8 @@ -25,6 +27,8 @@ services: SERVICE_PRECONDITION: \"namenode:9870\" env_file: - ./hadoop.env + networks: + - nebula-net resourcemanager: image: bde2020/hadoop-resourcemanager:2.0.0-hadoop3.2.1-java8 @@ -34,6 +38,8 @@ services: SERVICE_PRECONDITION: \"namenode:9000 namenode:9870 datanode:9864\" env_file: - ./hadoop.env + networks: + - nebula-net nodemanager1: image: bde2020/hadoop-nodemanager:2.0.0-hadoop3.2.1-java8 @@ -43,6 +49,8 @@ services: SERVICE_PRECONDITION: \"namenode:9000 namenode:9870 datanode:9864 resourcemanager:8088\" env_file: - ./hadoop.env + networks: + - nebula-net historyserver: image: bde2020/hadoop-historyserver:2.0.0-hadoop3.2.1-java8 @@ -54,8 +62,14 @@ services: - hadoop_historyserver:/hadoop/yarn/timeline env_file: - ./hadoop.env + networks: + - nebula-net volumes: hadoop_namenode: hadoop_datanode: hadoop_historyserver: + +networks: + nebula-net: + external: true ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:7:2","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#é™„å½•äºŒ"},{"categories":["Nebula Graph"],"content":" 7.3 é™„å½•ä¸‰nebula-exchange-sst.conf { # Spark relation config spark: { app: { name: Nebula Exchange 2.1 } master:local driver: { cores: 1 maxResultSize: 1G } executor: { memory:1G } cores:{ max: 16 } } # Nebula Graph relation config nebula: { address:{ graph:[\"192.168.8.128:9669\"] meta:[\"192.168.8.128:49377\"] } user: root pswd: nebula space: sst # parameters for SST import, not required path:{ local:\"/tmp\" remote:\"/sst\" hdfs.namenode: \"hdfs://192.168.8.128:9000\" } # nebula client connection parameters connection { # socket connect \u0026 execute timeout, unit: millisecond timeout: 30000 } error: { # max number of failures, if the number of failures is bigger than max, then exit the application. max: 32 # failed import job will be recorded in output path output: /tmp/errors } # use google's RateLimiter to limit the requests send to NebulaGraph rate: { # the stable throughput of RateLimiter limit: 1024 # Acquires a permit from RateLimiter, unit: MILLISECONDS # if it can't be obtained within the specified timeout, then give up the request. timeout: 1000 } } # Processing tags # There are tag config examples for different dataSources. tags: [ # HDFS csv # Import mode is sst, just change type.sink to client if you want to use client import mode. { name: player type: { source: csv sink: sst } path: \"file:///root/player.csv\" # if your csv file has no header, then use _c0,_c1,_c2,.. to indicate fields fields: [_c1, _c2] nebula.fields: [name, age] vertex: { field:_c0 } separator: \",\" header: false batch: 256 partition: 32 } ] } ","date":"2021-08-18","objectID":"/nebula-exchange-sst-2.x/:7:3","series":null,"tags":["Nebula Graph","Nebula Exchange","SST"],"title":"Nebula Exchange SST 2.x Hands-on Guide","uri":"/nebula-exchange-sst-2.x/#é™„å½•ä¸‰"},{"categories":["sketches"],"content":"ä»‹ç» Nebula Graph çš„äº‘åŸç”Ÿ K8s Operator éƒ¨ç½²","date":"2021-08-06","objectID":"/sketches/nebula-operator-explained/","series":null,"tags":["Nebula Graph","K8s"],"title":"Nebula operator Explained","uri":"/sketches/nebula-operator-explained/"},{"categories":["sketches"],"content":" Nebula Graph operator explained è¿™ä¸ªæ‰‹è®°é‡Œï¼Œæˆ‘ä»‹ç»äº† Nebula Graph çš„ K8s Operator: Intro 00:00 Nebula K8s Operator Explained 0:25 How do we use Nebula Operator? 02:23 What is the difference between the Operator based Nebula Graph Cluster and the binary-based one? 03:50 How about the Performance impact when it comes to K8s-Operator deployment? 04:55 What is the easiest way to try out the nebula operator? 06:04 Outra 07:30 ref: https://github.com/vesoft-inc/nebula-operator ","date":"2021-08-06","objectID":"/sketches/nebula-operator-explained/:0:0","series":null,"tags":["Nebula Graph","K8s"],"title":"Nebula operator Explained","uri":"/sketches/nebula-operator-explained/#"},{"categories":["sketches"],"content":" 1 Bilibili ","date":"2021-08-06","objectID":"/sketches/nebula-operator-explained/:1:0","series":null,"tags":["Nebula Graph","K8s"],"title":"Nebula operator Explained","uri":"/sketches/nebula-operator-explained/#bilibili"},{"categories":["sketches"],"content":" 2 Youtube ","date":"2021-08-06","objectID":"/sketches/nebula-operator-explained/:2:0","series":null,"tags":["Nebula Graph","K8s"],"title":"Nebula operator Explained","uri":"/sketches/nebula-operator-explained/#youtube"},{"categories":["sketches"],"content":"Nebula Config Explained","date":"2021-07-26","objectID":"/sketches/nebula-config-explained/","series":null,"tags":["Nebula Graph","config"],"title":"Nebula Config Explained","uri":"/sketches/nebula-config-explained/"},{"categories":["sketches"],"content":" Nebula Graph config explained è¿™ä¸ªæ‰‹è®°å¸®åŠ©æˆ‘ä»¬ç†è§£ Nebula Graph çš„é…ç½®ç›¸å…³çš„çŸ¥è¯†ï¼š ä»‹ç» Nebula Graph ä¸‰ç§é…ç½®æ–¹å¼ï¼Œå®ƒä»¬çš„ä¼˜å…ˆçº§ã€èŒƒå›´ã€ç”Ÿæ•ˆæ¡ä»¶ 0:16 ä»‹ç» Nebula Graph åœ¨ Docker-Compose/Swarm éƒ¨ç½²æƒ…å†µä¸‹é…ç½®çš„æ–¹å¼ 03:01 ä»‹ç» Nebula Graph åœ¨ K8s Operator éƒ¨ç½²æƒ…å†µä¸‹é…ç½®çš„æ–¹å¼ 03:55 æˆ‘ä»¬æ˜¯å¦åº”è¯¥ç”¨ Local-Configï¼Ÿï¼ˆå‰§é€ï¼šåº”è¯¥ï¼‰ 05:03 ","date":"2021-07-26","objectID":"/sketches/nebula-config-explained/:0:0","series":null,"tags":["Nebula Graph","config"],"title":"Nebula Config Explained","uri":"/sketches/nebula-config-explained/#"},{"categories":["sketches"],"content":" 1 Bilibili ","date":"2021-07-26","objectID":"/sketches/nebula-config-explained/:1:0","series":null,"tags":["Nebula Graph","config"],"title":"Nebula Config Explained","uri":"/sketches/nebula-config-explained/#bilibili"},{"categories":["sketches"],"content":" 2 Youtube ","date":"2021-07-26","objectID":"/sketches/nebula-config-explained/:2:0","series":null,"tags":["Nebula Graph","config"],"title":"Nebula Config Explained","uri":"/sketches/nebula-config-explained/#youtube"},{"categories":["sketches"],"content":"Nebula Index Demystified","date":"2021-07-13","objectID":"/sketches/nebula-index-demystified/","series":null,"tags":["Nebula Graph","index"],"title":"Nebula Graph Index Demystified","uri":"/sketches/nebula-index-demystified/"},{"categories":["sketches"],"content":" Nebula Graph åŸç”Ÿç´¢å¼•è§£è°œï¼Œå¸®åŠ©å¤§å®¶æ·±å…¥äº†è§£ Nebula Graph Index åŸç”Ÿç´¢å¼•ï¼Œåˆ°åº• Nebula Graph çš„åŸç”Ÿç´¢å¼•æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Ÿä¸ºä»€ä¹ˆ Nebula Graph ç´¢å¼•å¯¹æ€§èƒ½æœ‰ä¸€äº›å½±å“ï¼Ÿå¸¦æœ‰ç´¢å¼•çš„å†™å…¥è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ Index Demystified 0:33 When should we use index? 06:37 Index v.s. Fulltext Index 07:12 Index Performance Impact 08:03 ","date":"2021-07-13","objectID":"/sketches/nebula-index-demystified/:0:0","series":null,"tags":["Nebula Graph","index"],"title":"Nebula Graph Index Demystified","uri":"/sketches/nebula-index-demystified/#"},{"categories":["sketches"],"content":" 1 Bilibili ","date":"2021-07-13","objectID":"/sketches/nebula-index-demystified/:1:0","series":null,"tags":["Nebula Graph","index"],"title":"Nebula Graph Index Demystified","uri":"/sketches/nebula-index-demystified/#bilibili"},{"categories":["sketches"],"content":" 2 Youtube ","date":"2021-07-13","objectID":"/sketches/nebula-index-demystified/:2:0","series":null,"tags":["Nebula Graph","index"],"title":"Nebula Graph Index Demystified","uri":"/sketches/nebula-index-demystified/#youtube"},{"categories":["sketches"],"content":"Nebula Graph Deployment Options","date":"2021-06-25","objectID":"/sketches/nebula-deployment-options/","series":null,"tags":["Nebula Graph","deployment"],"title":"Nebula Graph Deployment Options","uri":"/sketches/nebula-deployment-options/"},{"categories":["sketches"],"content":" Nebula Graph æœ‰å¾ˆå¤šç§åˆ†å‘ã€éƒ¨ç½²æ–¹å¼ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©å®ƒä»¬å‘¢ï¼Ÿ ","date":"2021-06-25","objectID":"/sketches/nebula-deployment-options/:0:0","series":null,"tags":["Nebula Graph","deployment"],"title":"Nebula Graph Deployment Options","uri":"/sketches/nebula-deployment-options/#"},{"categories":["sketches"],"content":" 1 Bilibili ","date":"2021-06-25","objectID":"/sketches/nebula-deployment-options/:1:0","series":null,"tags":["Nebula Graph","deployment"],"title":"Nebula Graph Deployment Options","uri":"/sketches/nebula-deployment-options/#bilibili"},{"categories":["sketches"],"content":" 2 Youtube ","date":"2021-06-25","objectID":"/sketches/nebula-deployment-options/:2:0","series":null,"tags":["Nebula Graph","deployment"],"title":"Nebula Graph Deployment Options","uri":"/sketches/nebula-deployment-options/#youtube"},{"categories":["sketches"],"content":"Nebula Graph Data Import Options","date":"2021-06-15","objectID":"/sketches/nebula-data-import-options/","series":null,"tags":["Nebula Graph","data import"],"title":"Nebula Graph Data Import Options","uri":"/sketches/nebula-data-import-options/"},{"categories":["sketches"],"content":" Nebula Graph æä¾›äº†å¥½å¤šç§æ•°æ®å¯¼å…¥çš„å·¥å…·ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿè¿™ä¸€å¼ å›¾å¸®åŠ©å¤§å®¶äº†è§£ Nebula Graph æ‰€æœ‰çš„æ•°æ®å¯¼å…¥é€‰é¡¹ã€‚ ","date":"2021-06-15","objectID":"/sketches/nebula-data-import-options/:0:0","series":null,"tags":["Nebula Graph","data import"],"title":"Nebula Graph Data Import Options","uri":"/sketches/nebula-data-import-options/#"},{"categories":["sketches"],"content":" 1 Bilibili ","date":"2021-06-15","objectID":"/sketches/nebula-data-import-options/:1:0","series":null,"tags":["Nebula Graph","data import"],"title":"Nebula Graph Data Import Options","uri":"/sketches/nebula-data-import-options/#bilibili"},{"categories":["sketches"],"content":" 2 Youtube ","date":"2021-06-15","objectID":"/sketches/nebula-data-import-options/:2:0","series":null,"tags":["Nebula Graph","data import"],"title":"Nebula Graph Data Import Options","uri":"/sketches/nebula-data-import-options/#youtube"},{"categories":["Nebula Graph"],"content":"æ— éœ€ä¾èµ–ï¼Œä¸€é”®å®‰è£…å°é²œåŸºäº Nebula Operator çš„ K8s Nebula Graph Cluster","date":"2021-06-09","objectID":"/nebula-operator-kind/","series":null,"tags":["Nebula Graph","Nebula Operator","K8s"],"title":"Nebula Operator Kindï¼Œä¸€é”®å•æœºç©è½¬ Nebula K8s é›†ç¾¤","uri":"/nebula-operator-kind/"},{"categories":["Nebula Graph"],"content":" Nebula-Kindï¼Œæ— éœ€ä¾èµ–ï¼Œä¸€é”®å®‰è£…å°é²œåŸºäº Nebula Operator çš„ K8s Nebula Graph Clusterã€‚ æ³¨ï¼š KIND æ˜¯ä¸€ä¸ª K8s çš„ SIGï¼Œä»£è¡¨ K8s in Dockerã€‚ ","date":"2021-06-09","objectID":"/nebula-operator-kind/:0:0","series":null,"tags":["Nebula Graph","Nebula Operator","K8s"],"title":"Nebula Operator Kindï¼Œä¸€é”®å•æœºç©è½¬ Nebula K8s é›†ç¾¤","uri":"/nebula-operator-kind/#"},{"categories":["Nebula Graph"],"content":" 1 Nebula-Operator-Kind æ˜¯ä»€ä¹ˆNebula Graph ä½œä¸ºäº‘åŸç”Ÿçš„åˆ†å¸ƒå¼å¼€æºå›¾æ•°æ®åº“ï¼Œæœ‰å¼€æºçš„ K8s Operator ä¾›å¤§å®¶åœ¨ K8s ä¸Šæ–¹ä¾¿çš„é€šè¿‡ CRD å»ç»´æŠ¤ã€éƒ¨ç½² Nebula Graph é›†ç¾¤ã€‚ å¯¹äºæ‰‹å¤´æ²¡æœ‰æ–¹ä¾¿çš„ K8s ç¯å¢ƒçš„åŒå­¦ï¼Œå¦‚æœæƒ³å°é²œã€å­¦ä¹  Nebula Graph çš„ K8s Operator çš„è¯ï¼Œå¯èƒ½éœ€è¦è€—è´¹ä¸€äº›ç²¾åŠ›æ‰èƒ½æ­èµ·æ¥ä¸€æ•´å¥—çš„æ§åˆ¶å¹³é¢çš„ä¾èµ–ã€‚ ä½œä¸ºä¸€ä¸ªæ‡’äººï¼Œæˆ‘åšåˆ©ç”¨ K8s in Docker(KIND)ï¼Œå’Œä¹‹å‰åš Nebula-Up çš„ shell è„šæœ¬æ¶å­ï¼Œå¿«é€Ÿçš„æäº†ä¸€ä¸ªä¸€é”®å®‰è£…å·¥å…·ï¼šNebula-Operator-Kind å®ƒèƒ½ç›´æ¥å¸®æˆ‘ä»¬ï¼š å®‰è£… Docker å®‰è£… K8s(KIND) å®‰è£… PV Provider å®‰è£… Nebula-Operator ä»¥åŠä¾èµ– å®‰è£… Nebula-Console é…ç½® nodePort ç”¨ä»¥ä¸€é”®ç›´è¿ Nebula é›†ç¾¤ å®‰è£… kubectl ç”¨æ¥ä½“éªŒ Nebula-Operator çš„ CRD é…ç½® ","date":"2021-06-09","objectID":"/nebula-operator-kind/:1:0","series":null,"tags":["Nebula Graph","Nebula Operator","K8s"],"title":"Nebula Operator Kindï¼Œä¸€é”®å•æœºç©è½¬ Nebula K8s é›†ç¾¤","uri":"/nebula-operator-kind/#nebula-operator-kind-æ˜¯ä»€ä¹ˆ"},{"categories":["Nebula Graph"],"content":" 2 å¦‚ä½•ä½¿ç”¨å®‰è£…ï¼š curl -sL nebula-kind.siwei.io/install.sh | bash æˆåŠŸä¹‹åï¼š ç”¨ ~/.nebula-kind/bin/console ä¸€è¡Œè¿æ¥é›†ç¾¤ï¼š ~/.nebula-kind/bin/console -u user -p password --address=127.0.0.1 --port=30000 ","date":"2021-06-09","objectID":"/nebula-operator-kind/:2:0","series":null,"tags":["Nebula Graph","Nebula Operator","K8s"],"title":"Nebula Operator Kindï¼Œä¸€é”®å•æœºç©è½¬ Nebula K8s é›†ç¾¤","uri":"/nebula-operator-kind/#å¦‚ä½•ä½¿ç”¨"},{"categories":["Nebula Graph"],"content":" 3 è¯¦ç»†ä¿¡æ¯Repo çš„åœ°å€æ˜¯ï¼šhttps://github.com/wey-gu/nebula-operator-kind ï¼Œé‡Œè¾¹æœ‰æ›´å¤šçš„ä¿¡æ¯ï¼Œæ¬¢è¿å¤§å®¶è¯•ç”¨ã€åé¦ˆã€PR å“ˆï¼ Updated Sept. 2021 å¦‚æœåœ¨ KubeSphere All-in-one ç¯å¢ƒå®‰è£…ï¼š curl -sL nebula-kind.siwei.io/install-ks-1.sh | bash å¦‚æœåœ¨ Minikubeã€å…¶ä»– K8s ä¹‹ä¸­å®‰è£… curl -sL nebula-kind.siwei.io/install-on-k8s.sh | bash é¢˜å›¾ç‰ˆæƒï¼šMaik Hankemann ","date":"2021-06-09","objectID":"/nebula-operator-kind/:3:0","series":null,"tags":["Nebula Graph","Nebula Operator","K8s"],"title":"Nebula Operator Kindï¼Œä¸€é”®å•æœºç©è½¬ Nebula K8s é›†ç¾¤","uri":"/nebula-operator-kind/#è¯¦ç»†ä¿¡æ¯"},{"categories":null,"content":" æ‚¨å¥½ï¼Œæˆ‘æ˜¯å¤æ€ä¸ºã€‚æˆ‘æ˜¯ä¸€ä¸ªåœ¨ä¸Šæµ·çš„è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œæˆ‘åœ¨ vesoft æ‹…ä»» NebulaGraphï¼ˆå¼€æºçš„åˆ†å¸ƒå¼å›¾æ•°æ®åº“ï¼‰çš„é¦–å¸­å¸ƒé“å¸ˆã€‚ æˆ‘çš„å·¥ä½œæ˜¯é€šè¿‡å›´ç»• NebulaGraph Database åˆ›ä½œå†…å®¹ï¼Œæ„å»ºå·¥å…·æ¥æ”¹å–„å¼€å‘è€…çš„å­¦ä¹ ã€å¼€å‘ã€ç¤¾åŒºå‚ä¸ä½“éªŒã€‚ æˆ‘åœ¨å¼€æºç¤¾åŒºå¼€æ”¾çš„å·¥ä½œï¼Œå¹¶ï¼ˆèŠ±äº†èŒä¸šç”Ÿæ¶¯ä¸­çš„å‰äº›å¹´æ„è¯†åˆ°ï¼‰çƒ­çˆ±ç”¨è‡ªå·±çš„æ€æƒ³å’Œå­¦åˆ°çš„æŠ€æœ¯å¸®åŠ©åˆ°åˆ«äººï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ç§çš„è£å¹¸å’Œå®è´µçš„æœºé‡ã€‚ 1 ","date":"2021-06-04","objectID":"/about/:0:0","series":null,"tags":null,"title":"","uri":"/about/#æ‚¨å¥½æˆ‘æ˜¯å¤æ€ä¸º"},{"categories":null,"content":" 1 æœ€è¿‘çš„å¼€æºé¡¹ç›® Nebula-Corp-Rel-Graph Nebula-Corp-Rel-Graphï¼ŒåŸºäºå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€ç³»ç»Ÿ é˜…è¯»å…¨æ–‡ Nebula-Siwi Nebula-Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ é˜…è¯»å…¨æ–‡ Nebula-Holdshare Nebula-Holdshareï¼Œå›¾æ•°æ®åº“åº”ç”¨ç¤ºä¾‹ï¼šè‚¡æƒå…³ç³»ç©¿é€ é˜…è¯»å…¨æ–‡ Nebula-KIND Nebula-Kindï¼Œæ— éœ€ä¾èµ–ï¼Œä¸€é”®å®‰è£…å°é²œåŸºäº Nebula Operator çš„ K8s Nebula Graph Clusterã€‚æ³¨ï¼š KIND æ˜¯ä¸€ä¸ª K8s çš„ SIGï¼Œä»£è¡¨ K8s in Dockerã€‚ é˜…è¯»å…¨æ–‡ Nebula-Up Nebula-upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒï¼Œæ”¯æŒ mscOSï¼ŒWindows 10ï¼ŒCentOS å’Œ Ubuntuã€‚ é˜…è¯»å…¨æ–‡ VSCode-nGQL VSCode-nGQLï¼ŒNebula Graph çš„ VS Code æ’ä»¶ï¼Œngql è¯­æ³•é«˜äº®ã€‚ é˜…è¯»å…¨æ–‡ IPython-nGQL Nebula Graph çš„ Jupyter Notebook å’Œ IPython æ’ä»¶ï¼Œæ–¹ä¾¿åœ¨ Notebook ä¹‹ä¸­åµŒå…¥ nGQL çš„ query å’Œ ç»“æœçš„è°ƒè¯•ã€‚ é˜…è¯»å…¨æ–‡ nebula-insights æœ¬æ–‡ä»‹ç»æˆ‘ä»¬å¦‚ä½•ç”¨å…¬æœ‰äº‘ Serverless æŠ€æœ¯ï¼šGoogle Cloud Schedulerï¼ŒGoogle Cloud Functions å’Œ BigQuery æ­å»ºæ•°æ®ç®¡é“ï¼Œæ”¶é›†æ¢ç´¢å¼€æºç¤¾åŒºæ´å¯Ÿã€‚å¹¶å°†å…¨éƒ¨ä»£ç å¼€æºåœ¨ GitHubã€‚ é˜…è¯»å…¨æ–‡ ","date":"2021-06-04","objectID":"/about/:1:0","series":null,"tags":null,"title":"","uri":"/about/#æœ€è¿‘çš„å¼€æºé¡¹ç›®"},{"categories":null,"content":" 2 æˆ‘çš„æ‰‹ç»˜ Nebula Operator Explained Nebula Graph K8s Operator ä»‹ç» é˜…è¯»å…¨æ–‡ Nebula Config Explained Nebula Graph é…ç½®è¯¦è§£ é˜…è¯»å…¨æ–‡ Nebula Index Demystified Nebula Graph åŸç”Ÿç´¢å¼•è§£è°œ é˜…è¯»å…¨æ–‡ Nebula Data Import Options Nebula Graph æä¾›äº†å¥½å¤šç§æ•°æ®å¯¼å…¥çš„å·¥å…·ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿ é˜…è¯»å…¨æ–‡ Nebula Deployment Options Nebula Graph æœ‰å¾ˆå¤šç§åˆ†å‘ã€éƒ¨ç½²æ–¹å¼ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©å®ƒä»¬å‘¢ï¼Ÿ é˜…è¯»å…¨æ–‡ Nebula Intro æ–°æ‰‹ç©è½¬ Nebula Graph ç³»åˆ—å¼€ç¯‡ã€‚ é˜…è¯»å…¨æ–‡ ","date":"2021-06-04","objectID":"/about/:2:0","series":null,"tags":null,"title":"","uri":"/about/#æˆ‘çš„æ‰‹ç»˜"},{"categories":null,"content":" 3 æˆ‘çš„ä¸Šæ‰‹è¯¾ç¨‹ è‚¡æƒç©¿é€æ•™ç¨‹ ä¸Šæ‰‹å®æˆ˜è‚¡æƒç”¨å›¾æ•°æ®åº“å…³ç³»ç©¿é€ é˜…è¯»å…¨æ–‡ Siwi ä¸Šæ‰‹å®æˆ˜ä» 0 åˆ¶ä½œä¸€ä¸ªåŸºäºå›¾è°±çš„è¯­éŸ³æ™ºèƒ½åŠ©æ‰‹ é˜…è¯»å…¨æ–‡ ","date":"2021-06-04","objectID":"/about/:3:0","series":null,"tags":null,"title":"","uri":"/about/#æˆ‘çš„ä¸Šæ‰‹è¯¾ç¨‹"},{"categories":null,"content":" 4 æˆ‘çš„æ¼”è®² æ˜é‡‘æ˜¥æ‹›æ´»åŠ¨ é‚£äº›æˆ‘å¸Œæœ›è¿‡å»çš„è‡ªå·±å¯ä»¥çŸ¥é“çš„äº‹å® é˜…è¯»å…¨æ–‡ DoK Talks #116 Nebula Graph: Open Source Distributed GraphDB é˜…è¯»å…¨æ–‡ Data on K8s Community 2021 GraphDB on Kubesphere é˜…è¯»å…¨æ–‡ K8s Community Day 2021 Openfunction + GraphDB é˜…è¯»å…¨æ–‡ COScon 2021 æˆ‘çš„å¼€æºä¹‹è·¯ é˜…è¯»å…¨æ–‡ PyCon China 2021 å›¾æ•°æ®åº“è§£è°œä¸ Python çš„å›¾åº“åº”ç”¨å®è·µ é˜…è¯»å…¨æ–‡ K8s ä¸Šçš„å›¾æ•°æ®åº“ Nebula K8s Operator çš„å®ç°è§£æï¼Œå›¾æ•°æ®åº“åº”ç”¨åœ¨ K8s + OpenFunction ä¸Šçš„è½åœ°æ¼”ç¤º é˜…è¯»å…¨æ–‡ nMeetup: Nebula åº”ç”¨ä¸Šæ‰‹å®æ“ ä»å¤´å®æ“ Nebula çš„éƒ¨ç½²ï¼Œè‚¡æƒç©¿é€ï¼Œå›¾ç®—æ³•è¿ç®—ï¼Œè¯­éŸ³æ™ºèƒ½åŠ©æ‰‹ã€‚ é˜…è¯»å…¨æ–‡ How to Train your Dragon å¦‚ä½•æˆä¸ºå¼€æºå¼€å‘è€…ï¼ˆå¸ƒé“å¸ˆï¼‰ã€‚ é˜…è¯»å…¨æ–‡ ","date":"2021-06-04","objectID":"/about/:4:0","series":null,"tags":null,"title":"","uri":"/about/#æˆ‘çš„æ¼”è®²"},{"categories":null,"content":" 5 è¿‡å¾€çš„ç»å†æˆ‘æ›¾åœ¨çˆ±ç«‹ä¿¡å·¥ä½œäº†è¿‘åå¹´ï¼š2011 å¹´åˆ° 2021 å¹´ã€‚ æˆ‘æ˜¯äº‘è®¡ç®—äº§å“ Cloud Execution Envrioment (CEE) 2 ç ”å‘å›¢é˜Ÿçš„ç³»ç»Ÿç»ç† 3ï¼Œæˆ‘å¤§éƒ¨åˆ†çš„å·¥ä½œæ˜¯é€šè¿‡è®¾è®¡å¼€å‘ 20 å¤šä¸ª CEE 6.6.2 å’Œ CEE 10 çš„åŠŸèƒ½ä¸æ”¹è¿›ï¼Œæ¶µç›–è®¡ç®—ã€å­˜å‚¨ã€ç½‘ç»œã€ç”Ÿå‘½å‘¨æœŸç®¡ç†å’Œå®‰å…¨ç­‰é¢†åŸŸï¼Œæ¥å¸®åŠ©çˆ±ç«‹ä¿¡ IaaS äº§å“ä¸è§£å†³æ–¹æ¡ˆä¸æ–­è¿›åŒ–ã€‚ åŒæ—¶ï¼Œæˆ‘ä¹Ÿè´Ÿè´£ CEE äº§å“åœ¨ä¸­å›½åŒºçš„å¸ƒé“ï¼ˆé¢å‘å¤–éƒ¨ä¸å†…éƒ¨ï¼‰ã€‚ æˆ‘æ›¾åœ¨ note.siwei.info è®°å½•ä¸€äº›æƒ³æ³•å’Œç¬”è®°ï¼Œä»2021å¹´æ˜¥å¤©å¼€å§‹ï¼Œæˆ‘ä¼šæŠŠæƒ³æ³•è®°å½•ä¸‹æ¥ç•™åœ¨ siwei.io ","date":"2021-06-04","objectID":"/about/:5:0","series":null,"tags":null,"title":"","uri":"/about/#è¿‡å¾€çš„ç»å†"},{"categories":null,"content":" 6 è”ç³»æˆ‘æ‚¨æœ€å¥½é€šè¿‡ twitterï¼Œé‚®ç®± wey.gu@vesoft.com æ‰¾åˆ°æˆ‘ã€‚ å¦‚æœå¿…é¡»ï¼Œæ‚¨ä¹Ÿå¯ä»¥é€šè¿‡å¾®ä¿¡æ‰¾åˆ°æˆ‘ï¼Œå¾®ä¿¡ ID å¦‚ä¸‹ï¼Œè¯·æ·»åŠ æ³¨æ˜æ‚¨çš„æ¥æ„ã€‚ echo c2l2dmVpCg== | base64 -d æˆ–è€…å’Œæˆ‘çº¦ä¸€ä¸ª Zoom Call æˆ‘å’Œ Ahmet Alp Balkan çš„ è¿™ä¸ªæ¨æ–‡ æ„ŸåŒèº«å—ï¼š Working in open source (and getting paid for it) is a privilege. Itâ€™s a career boost, makes you lots of friends across the industry, and gives you a public brand. I am one of the â€œlucky fewâ€ \u0026 thankful to Microsoft and Google who let me work on OSS nearly all my career. â€” ahmetb (@ahmetb) February 19, 2021 Â â†©ï¸ Ericssonâ€™s Telco. Infrastructure as a Service product offerring: Cloud Execution EnvironmentÂ â†©ï¸ System Manager, PDU Cloud: å·¥ä½œæè¿°Â â†©ï¸ ","date":"2021-06-04","objectID":"/about/:6:0","series":null,"tags":null,"title":"","uri":"/about/#è”ç³»æˆ‘"},{"categories":["Nebula Graph"],"content":"æœ¬æ–‡ä½œè€…åˆ†æäº† Chia Network çš„å…¨é“¾æ•°æ®ï¼Œå¹¶åšäº†å°†å…¨é“¾æ•°æ®å¯¼å…¥å›¾æ•°æ®åº“ï¼šNebula Graph ä¹‹ä¸­çš„å°è¯•ï¼Œä»è€Œå¯è§†åŒ–åœ°æ¢ç´¢äº† Chia å›¾ä¸­æ•°æ®ä¹‹é—´çš„å…³è”å…³ç³»ã€‚","date":"2021-05-26","objectID":"/nebula-chia/","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/"},{"categories":["Nebula Graph"],"content":" è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘å…¨ç½‘é¦–æ¬¡åœ°åˆ†æäº† Chia Network çš„å…¨é“¾æ•°æ®ï¼Œå¹¶åšäº†å°†å…¨é“¾æ•°æ®å¯¼å…¥å›¾æ•°æ®åº“ï¼šNebula Graph ä¹‹ä¸­çš„å°è¯•ï¼Œä»è€Œå¯è§†åŒ–åœ°æ¢ç´¢äº† Chia å›¾ä¸­æ•°æ®ä¹‹é—´çš„å…³è”å…³ç³»ã€‚ æˆ‘æŠŠæ¶‰åŠçš„ä»£ç å¼€æºåœ¨äº†è¿™é‡Œï¼šhttps://github.com/wey-gu/nebula-chia ","date":"2021-05-26","objectID":"/nebula-chia/:0:0","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#"},{"categories":["Nebula Graph"],"content":" 1 Chia æ˜¯ä»€ä¹ˆ?Chia Network æ˜¯ç”± BitTorrent çš„ä½œè€… Bram Cohen çš„å›¢é˜Ÿåœ¨ 2017 å¹´åˆ›å»ºçš„åŒºå—é“¾é¡¹ç›®ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:1:0","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#chia-æ˜¯ä»€ä¹ˆ"},{"categories":["Nebula Graph"],"content":" 1.1 ä¸ºä»€ä¹ˆå†æä¸€ä¸ªåŒºå—é“¾?Chia ç”¨äº†å…¨æ–°çš„ä¸­æœ¬èªå…±è¯†ç®—æ³•ï¼Œè¿™ä¸ªç®—æ³•é€šè¿‡ä¸å…è®¸å¹¶è¡Œè®¡ç®—ï¼Œè®©æŒ–çŸ¿ï¼ˆProof of Workï¼‰æ‰€éœ€ç®—åŠ›å’Œèƒ½è€—é™åˆ°éå¸¸ä½ï¼Œè¿™ä½¿å¾—è¶…å¤§ç»„ç»‡ã€ç©å®¶æ²¡æ³•åƒåœ¨å…¶ä»–çš„åŒºå—é“¾é¡¹ç›®é‚£æ ·æœ‰ç®—åŠ›çš„ç»å¯¹ä¼˜åŠ¿ï¼Œä¹Ÿä¸€å®šç¨‹åº¦ä¸Šè§„é¿äº†èƒ½æºçš„æµªè´¹ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:1:1","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#ä¸ºä»€ä¹ˆå†æä¸€ä¸ªåŒºå—é“¾"},{"categories":["Nebula Graph"],"content":" 1.2 å¦‚ä½•è¿æ¥Chia?æˆ‘ä»¬å¯ä»¥é€šè¿‡ Chia Network çš„å®¢æˆ·ç«¯æ¥è®¿é—®å®ƒï¼Œè¿™ä¸ªå®¢æˆ·ç«¯æ˜¯ Electron + Python çš„ç¨‹åºï¼Œå¤©ç„¶è·¨å¹³å°ï¼Œæ—¢æœ‰ GUI åˆæœ‰ CLI çš„æ–¹å¼ã€‚ 1.2.1 å®‰è£…åªéœ€è¦æŒ‰ç…§å®˜æ–¹çš„ Guide æ¥ä¸‹è½½å®‰è£…å°±å¥½ï¼Œ https://github.com/Chia-Network/chia-blockchain/wiki/INSTALLï¼Œæˆ‘åœ¨ M1 Mac ä¸‹å®‰è£…çš„æ—¶å€™è„šæœ¬å‡ºäº†ç‚¹å°é—®é¢˜ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºæ‹‰å–äºŒè¿›åˆ¶ wheel æ–‡ä»¶ç½‘ç»œå‡ºé—®é¢˜èµ°åˆ°äº†ç¼–è¯‘ wheelçš„é€»è¾‘ï¼Œè€Œé‚£é‡Œæ˜¯ä¾èµ– cargoçš„ï¼Œå¦‚æœå¤§å®¶é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥æå‰æ‰‹åŠ¨å®‰è£…ä¸€ä¸‹ rustï¼Œæˆ–è€… cherry-pick æˆ‘çš„è¿™ä¸ª PR ã€‚ 1.2.2 è¿è¡Œ æŒ‰ç…§å®˜æ–¹ guideï¼Œæ¯”å¦‚ macOS æ¥è¯´ï¼Œæœ€åä¸€æ­¥æ‰§è¡Œnpm run electron \u0026 å°±æ˜¯è¿è¡Œå®ƒçš„GUIå®¢æˆ·ç«¯ã€‚ å¦‚æœå¤§å®¶åƒæˆ‘ä¸€æ ·å–œæ¬¢ CLIï¼Œç›´æ¥åœ¨æ‰§è¡Œå®Œ . ./activate ä¹‹åå°±å¯ä»¥ chia --helpäº†å“ˆâ˜ºï¼Œé‡Œè¾¹æœ‰åªå¯åŠ¨éƒ¨åˆ†æœåŠ¡çš„æ–¹å¼ï¼ˆç›¸æ¯” GUI å¯åŠ¨æ‰€æœ‰æ¥è¯´)ã€‚ åœ¨è¿è¡Œä¹‹åï¼Œå¦‚æœä½ çš„ç½‘ç»œä¸æ˜¯å¤šå±‚ NAT çš„é‚£ç§ï¼Œç†è®ºä¸Šæ‚¨å¯ä»¥è¿åˆ° mainnet å¹¶ä¸”è‡ªåŠ¨å’Œä¸»é“¾åŒæ­¥æ•°æ®äº†ï¼Œå¦‚æœæ‚¨æ˜¯ç¬¬äºŒæ¬¡è¿è¡Œï¼Œè¿æ¥ä¸»é“¾ï¼Œä¸€å¼€å§‹å¯èƒ½æœ‰ä¸€é˜µå­åŒæ­¥çš„block æ•°æ˜¯ä¸å˜çš„ï¼Œä¹Ÿæ²¡æœ‰ peer è¿è¿‡æ¥ï¼Œä¸å¿…æƒŠæ…Œï¼Œç­‰ä¸€ä¸‹å°±å¥½äº†ã€‚ Tips: ç¬¬ä¸€æ¬¡è¿åˆ° Chia Network çš„åŒå­¦ä»¬ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé’±åŒ…ï¼ŒåŠçš„ä¿å­˜é‚£ä¸€ä¸²è¯ï¼Œå®ƒä»¬å°±æ˜¯ä½ çš„ç§é’¥å“¦ã€‚ ä¸‡ä¸€ï¼Œå¦‚æœçœŸçš„è¿ä¸ä¸Šçš„è¯ï¼Œå¯èƒ½éœ€è¦åœ¨è·¯ç”±ä¸Šé…ç½®ï¼ŒUPnPï¼Œé˜²ç«å¢™è¦å…è®¸ 8444ã€‚ 1.2.3 è®¿é—® Chia çš„æ•°æ®Chia çš„å®¢æˆ·ç«¯æŠŠæ•°æ®å­˜åœ¨äº†å‡ ä¸ª SQLite æ•°æ®åº“é‡Œï¼Œå®ƒä»¬çš„è·¯å¾„æ˜¯æˆ‘ä»¬å®‰è£…å®¢æˆ·ç«¯çš„ç”¨æˆ·çš„å®¶ç›®å½•ï¼š~/.chia/mainnet ä¸‹è¾¹å°±æ˜¯è¿è¡Œèµ·æ¥ Chia ä¹‹åç”Ÿæˆçš„ä¸»è¦çš„ä¸¤ä¸ªæ•°æ®åº“çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š ~/.chia/mainnet/db â¯ ll -h total 4350416 -rw-r--r-- 1 weyl staff 2.0G May 6 12:06 blockchain_v1_mainnet.sqlite -rw-r--r-- 1 weyl staff 64K May 6 11:17 blockchain_v1_mainnet.sqlite-shm -rw-r--r-- 1 weyl staff 20M May 6 12:10 blockchain_v1_mainnet.sqlite-wal -rw-r--r-- 1 weyl staff 1.8M May 6 11:46 peer_table_node.sqlite -rw-r--r-- 1 weyl staff 32K May 5 17:30 peer_table_node.sqlite-shm -rw-r--r-- 1 weyl staff 5.4M May 6 11:46 peer_table_node.sqlite-wal ~/.chia/mainnet/wallet/db â¯ ll -h total 3055848 -rw-r--r-- 1 weyl staff 1.4G May 7 15:32 blockchain_wallet_v1_mainnet_903996200.sqlite -rw-r--r-- 1 weyl staff 32K May 7 15:24 blockchain_wallet_v1_mainnet_903996200.sqlite-shm -rw-r--r-- 1 weyl staff 4.0M May 7 15:32 blockchain_wallet_v1_mainnet_903996200.sqlite-wal -rw-r--r-- 1 weyl staff 16K May 7 15:24 wallet_peers.sqlite ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨ SQLite Browserï¼Œä¸€ä¸ª SQlite æ•°æ®åº“ï¼ˆæ–‡ä»¶ï¼‰çš„æµè§ˆå™¨æ¥çœ‹çœ‹å®ƒã€‚ SQlite æµè§ˆå™¨çš„å®˜ç½‘æ˜¯ https://sqlitebrowser.org/ ã€‚åœ¨ä¸‹è½½ï¼Œå®‰è£…ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‚¹å‡» Open Database/æ‰“å¼€æ•°æ®åº“ é€‰æ‹©æµè§ˆä¸Šè¾¹åˆ—å‡ºæ¥çš„ä¸¤ä¸ª .sqlite æ‰©å±•åçš„æ•°æ®åº“æ–‡ä»¶ã€‚ æ‰“å¼€æ•°æ®åº“ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç¬¬ä¸€ä¸ªæ ‡ç­¾ Database Schema æ¥çœ‹çœ‹è¡¨çš„ç»“æ„ã€‚ æˆ‘ä»¬è¿˜èƒ½åƒç±»ä¼¼äº Excel ä¸€æ ·å»çœ‹è¡¨çš„æ•°æ®ï¼Œè¿˜å¯ä»¥ Filter/è¿‡æ»¤ã€Sort/æ’åºä»»æ„åˆ—ã€‚ ä¸‹ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ¥ç®€å•çœ‹çœ‹è¡¨é‡Œçš„æ•°æ®ã€‚ Tips: è¿™é‡Œè¾¹ï¼Œ~/.chia/mainnet/wallet å’Œè£¸ç›®å½• ~/.chia/mainnet ä¸‹è¾¹çš„ db é‡Œåˆ†åˆ«éƒ½æœ‰è¡¨æ–‡ä»¶ï¼Œä»–ä»¬çš„ä¿¡æ¯æ˜¯æœ‰é‡å¤çš„ï¼Œå¤§å®¶å¯ä»¥åˆ†åˆ«æ‰“å¼€çœ‹çœ‹å“¦ï¼Œå³ä½¿æ˜¯ç›¸åŒçš„è¡¨çš„åå­—ï¼Œæ¯”å¦‚ block_record å†…é‡Œçš„ä¿¡æ¯ä¹Ÿç•¥æœ‰å·®åˆ«ï¼Œå¦‚æœå¤§å®¶çŸ¥é“ä¸ºä»€ä¹ˆæœ‰è¿™æ ·çš„å·®åˆ«ï¼Œæ¬¢è¿æµè§ˆå‘Šè¯‰å¤§å®¶å“ˆï¼Œå¯èƒ½è¦ä»”ç»†ç ”ç©¶ä¸€ä¸‹å®¢æˆ·ç«¯ã€é’±åŒ…ç­‰ä»£ç æ‰è¡Œï¼Œå¹¸è¿çš„æ˜¯ï¼Œå®ƒä»¬ç›¸å¯¹æ¯”è¾ƒå¥½é˜…è¯»ï¼Œæ˜¯ Python å†™çš„ï¼š https://github.com/Chia-Network/chia-blockchain ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:1:2","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#å¦‚ä½•è¿æ¥chia"},{"categories":["Nebula Graph"],"content":" 1.2 å¦‚ä½•è¿æ¥Chia?æˆ‘ä»¬å¯ä»¥é€šè¿‡ Chia Network çš„å®¢æˆ·ç«¯æ¥è®¿é—®å®ƒï¼Œè¿™ä¸ªå®¢æˆ·ç«¯æ˜¯ Electron + Python çš„ç¨‹åºï¼Œå¤©ç„¶è·¨å¹³å°ï¼Œæ—¢æœ‰ GUI åˆæœ‰ CLI çš„æ–¹å¼ã€‚ 1.2.1 å®‰è£…åªéœ€è¦æŒ‰ç…§å®˜æ–¹çš„ Guide æ¥ä¸‹è½½å®‰è£…å°±å¥½ï¼Œ https://github.com/Chia-Network/chia-blockchain/wiki/INSTALLï¼Œæˆ‘åœ¨ M1 Mac ä¸‹å®‰è£…çš„æ—¶å€™è„šæœ¬å‡ºäº†ç‚¹å°é—®é¢˜ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºæ‹‰å–äºŒè¿›åˆ¶ wheel æ–‡ä»¶ç½‘ç»œå‡ºé—®é¢˜èµ°åˆ°äº†ç¼–è¯‘ wheelçš„é€»è¾‘ï¼Œè€Œé‚£é‡Œæ˜¯ä¾èµ– cargoçš„ï¼Œå¦‚æœå¤§å®¶é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥æå‰æ‰‹åŠ¨å®‰è£…ä¸€ä¸‹ rustï¼Œæˆ–è€… cherry-pick æˆ‘çš„è¿™ä¸ª PR ã€‚ 1.2.2 è¿è¡Œ æŒ‰ç…§å®˜æ–¹ guideï¼Œæ¯”å¦‚ macOS æ¥è¯´ï¼Œæœ€åä¸€æ­¥æ‰§è¡Œnpm run electron \u0026 å°±æ˜¯è¿è¡Œå®ƒçš„GUIå®¢æˆ·ç«¯ã€‚ å¦‚æœå¤§å®¶åƒæˆ‘ä¸€æ ·å–œæ¬¢ CLIï¼Œç›´æ¥åœ¨æ‰§è¡Œå®Œ . ./activate ä¹‹åå°±å¯ä»¥ chia --helpäº†å“ˆâ˜ºï¼Œé‡Œè¾¹æœ‰åªå¯åŠ¨éƒ¨åˆ†æœåŠ¡çš„æ–¹å¼ï¼ˆç›¸æ¯” GUI å¯åŠ¨æ‰€æœ‰æ¥è¯´)ã€‚ åœ¨è¿è¡Œä¹‹åï¼Œå¦‚æœä½ çš„ç½‘ç»œä¸æ˜¯å¤šå±‚ NAT çš„é‚£ç§ï¼Œç†è®ºä¸Šæ‚¨å¯ä»¥è¿åˆ° mainnet å¹¶ä¸”è‡ªåŠ¨å’Œä¸»é“¾åŒæ­¥æ•°æ®äº†ï¼Œå¦‚æœæ‚¨æ˜¯ç¬¬äºŒæ¬¡è¿è¡Œï¼Œè¿æ¥ä¸»é“¾ï¼Œä¸€å¼€å§‹å¯èƒ½æœ‰ä¸€é˜µå­åŒæ­¥çš„block æ•°æ˜¯ä¸å˜çš„ï¼Œä¹Ÿæ²¡æœ‰ peer è¿è¿‡æ¥ï¼Œä¸å¿…æƒŠæ…Œï¼Œç­‰ä¸€ä¸‹å°±å¥½äº†ã€‚ Tips: ç¬¬ä¸€æ¬¡è¿åˆ° Chia Network çš„åŒå­¦ä»¬ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé’±åŒ…ï¼ŒåŠçš„ä¿å­˜é‚£ä¸€ä¸²è¯ï¼Œå®ƒä»¬å°±æ˜¯ä½ çš„ç§é’¥å“¦ã€‚ ä¸‡ä¸€ï¼Œå¦‚æœçœŸçš„è¿ä¸ä¸Šçš„è¯ï¼Œå¯èƒ½éœ€è¦åœ¨è·¯ç”±ä¸Šé…ç½®ï¼ŒUPnPï¼Œé˜²ç«å¢™è¦å…è®¸ 8444ã€‚ 1.2.3 è®¿é—® Chia çš„æ•°æ®Chia çš„å®¢æˆ·ç«¯æŠŠæ•°æ®å­˜åœ¨äº†å‡ ä¸ª SQLite æ•°æ®åº“é‡Œï¼Œå®ƒä»¬çš„è·¯å¾„æ˜¯æˆ‘ä»¬å®‰è£…å®¢æˆ·ç«¯çš„ç”¨æˆ·çš„å®¶ç›®å½•ï¼š~/.chia/mainnet ä¸‹è¾¹å°±æ˜¯è¿è¡Œèµ·æ¥ Chia ä¹‹åç”Ÿæˆçš„ä¸»è¦çš„ä¸¤ä¸ªæ•°æ®åº“çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š ~/.chia/mainnet/db â¯ ll -h total 4350416 -rw-r--r-- 1 weyl staff 2.0G May 6 12:06 blockchain_v1_mainnet.sqlite -rw-r--r-- 1 weyl staff 64K May 6 11:17 blockchain_v1_mainnet.sqlite-shm -rw-r--r-- 1 weyl staff 20M May 6 12:10 blockchain_v1_mainnet.sqlite-wal -rw-r--r-- 1 weyl staff 1.8M May 6 11:46 peer_table_node.sqlite -rw-r--r-- 1 weyl staff 32K May 5 17:30 peer_table_node.sqlite-shm -rw-r--r-- 1 weyl staff 5.4M May 6 11:46 peer_table_node.sqlite-wal ~/.chia/mainnet/wallet/db â¯ ll -h total 3055848 -rw-r--r-- 1 weyl staff 1.4G May 7 15:32 blockchain_wallet_v1_mainnet_903996200.sqlite -rw-r--r-- 1 weyl staff 32K May 7 15:24 blockchain_wallet_v1_mainnet_903996200.sqlite-shm -rw-r--r-- 1 weyl staff 4.0M May 7 15:32 blockchain_wallet_v1_mainnet_903996200.sqlite-wal -rw-r--r-- 1 weyl staff 16K May 7 15:24 wallet_peers.sqlite ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨ SQLite Browserï¼Œä¸€ä¸ª SQlite æ•°æ®åº“ï¼ˆæ–‡ä»¶ï¼‰çš„æµè§ˆå™¨æ¥çœ‹çœ‹å®ƒã€‚ SQlite æµè§ˆå™¨çš„å®˜ç½‘æ˜¯ https://sqlitebrowser.org/ ã€‚åœ¨ä¸‹è½½ï¼Œå®‰è£…ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‚¹å‡» Open Database/æ‰“å¼€æ•°æ®åº“ é€‰æ‹©æµè§ˆä¸Šè¾¹åˆ—å‡ºæ¥çš„ä¸¤ä¸ª .sqlite æ‰©å±•åçš„æ•°æ®åº“æ–‡ä»¶ã€‚ æ‰“å¼€æ•°æ®åº“ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç¬¬ä¸€ä¸ªæ ‡ç­¾ Database Schema æ¥çœ‹çœ‹è¡¨çš„ç»“æ„ã€‚ æˆ‘ä»¬è¿˜èƒ½åƒç±»ä¼¼äº Excel ä¸€æ ·å»çœ‹è¡¨çš„æ•°æ®ï¼Œè¿˜å¯ä»¥ Filter/è¿‡æ»¤ã€Sort/æ’åºä»»æ„åˆ—ã€‚ ä¸‹ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ¥ç®€å•çœ‹çœ‹è¡¨é‡Œçš„æ•°æ®ã€‚ Tips: è¿™é‡Œè¾¹ï¼Œ~/.chia/mainnet/wallet å’Œè£¸ç›®å½• ~/.chia/mainnet ä¸‹è¾¹çš„ db é‡Œåˆ†åˆ«éƒ½æœ‰è¡¨æ–‡ä»¶ï¼Œä»–ä»¬çš„ä¿¡æ¯æ˜¯æœ‰é‡å¤çš„ï¼Œå¤§å®¶å¯ä»¥åˆ†åˆ«æ‰“å¼€çœ‹çœ‹å“¦ï¼Œå³ä½¿æ˜¯ç›¸åŒçš„è¡¨çš„åå­—ï¼Œæ¯”å¦‚ block_record å†…é‡Œçš„ä¿¡æ¯ä¹Ÿç•¥æœ‰å·®åˆ«ï¼Œå¦‚æœå¤§å®¶çŸ¥é“ä¸ºä»€ä¹ˆæœ‰è¿™æ ·çš„å·®åˆ«ï¼Œæ¬¢è¿æµè§ˆå‘Šè¯‰å¤§å®¶å“ˆï¼Œå¯èƒ½è¦ä»”ç»†ç ”ç©¶ä¸€ä¸‹å®¢æˆ·ç«¯ã€é’±åŒ…ç­‰ä»£ç æ‰è¡Œï¼Œå¹¸è¿çš„æ˜¯ï¼Œå®ƒä»¬ç›¸å¯¹æ¯”è¾ƒå¥½é˜…è¯»ï¼Œæ˜¯ Python å†™çš„ï¼š https://github.com/Chia-Network/chia-blockchain ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:1:2","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#å®‰è£…"},{"categories":["Nebula Graph"],"content":" 1.2 å¦‚ä½•è¿æ¥Chia?æˆ‘ä»¬å¯ä»¥é€šè¿‡ Chia Network çš„å®¢æˆ·ç«¯æ¥è®¿é—®å®ƒï¼Œè¿™ä¸ªå®¢æˆ·ç«¯æ˜¯ Electron + Python çš„ç¨‹åºï¼Œå¤©ç„¶è·¨å¹³å°ï¼Œæ—¢æœ‰ GUI åˆæœ‰ CLI çš„æ–¹å¼ã€‚ 1.2.1 å®‰è£…åªéœ€è¦æŒ‰ç…§å®˜æ–¹çš„ Guide æ¥ä¸‹è½½å®‰è£…å°±å¥½ï¼Œ https://github.com/Chia-Network/chia-blockchain/wiki/INSTALLï¼Œæˆ‘åœ¨ M1 Mac ä¸‹å®‰è£…çš„æ—¶å€™è„šæœ¬å‡ºäº†ç‚¹å°é—®é¢˜ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºæ‹‰å–äºŒè¿›åˆ¶ wheel æ–‡ä»¶ç½‘ç»œå‡ºé—®é¢˜èµ°åˆ°äº†ç¼–è¯‘ wheelçš„é€»è¾‘ï¼Œè€Œé‚£é‡Œæ˜¯ä¾èµ– cargoçš„ï¼Œå¦‚æœå¤§å®¶é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥æå‰æ‰‹åŠ¨å®‰è£…ä¸€ä¸‹ rustï¼Œæˆ–è€… cherry-pick æˆ‘çš„è¿™ä¸ª PR ã€‚ 1.2.2 è¿è¡Œ æŒ‰ç…§å®˜æ–¹ guideï¼Œæ¯”å¦‚ macOS æ¥è¯´ï¼Œæœ€åä¸€æ­¥æ‰§è¡Œnpm run electron \u0026 å°±æ˜¯è¿è¡Œå®ƒçš„GUIå®¢æˆ·ç«¯ã€‚ å¦‚æœå¤§å®¶åƒæˆ‘ä¸€æ ·å–œæ¬¢ CLIï¼Œç›´æ¥åœ¨æ‰§è¡Œå®Œ . ./activate ä¹‹åå°±å¯ä»¥ chia --helpäº†å“ˆâ˜ºï¼Œé‡Œè¾¹æœ‰åªå¯åŠ¨éƒ¨åˆ†æœåŠ¡çš„æ–¹å¼ï¼ˆç›¸æ¯” GUI å¯åŠ¨æ‰€æœ‰æ¥è¯´)ã€‚ åœ¨è¿è¡Œä¹‹åï¼Œå¦‚æœä½ çš„ç½‘ç»œä¸æ˜¯å¤šå±‚ NAT çš„é‚£ç§ï¼Œç†è®ºä¸Šæ‚¨å¯ä»¥è¿åˆ° mainnet å¹¶ä¸”è‡ªåŠ¨å’Œä¸»é“¾åŒæ­¥æ•°æ®äº†ï¼Œå¦‚æœæ‚¨æ˜¯ç¬¬äºŒæ¬¡è¿è¡Œï¼Œè¿æ¥ä¸»é“¾ï¼Œä¸€å¼€å§‹å¯èƒ½æœ‰ä¸€é˜µå­åŒæ­¥çš„block æ•°æ˜¯ä¸å˜çš„ï¼Œä¹Ÿæ²¡æœ‰ peer è¿è¿‡æ¥ï¼Œä¸å¿…æƒŠæ…Œï¼Œç­‰ä¸€ä¸‹å°±å¥½äº†ã€‚ Tips: ç¬¬ä¸€æ¬¡è¿åˆ° Chia Network çš„åŒå­¦ä»¬ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé’±åŒ…ï¼ŒåŠçš„ä¿å­˜é‚£ä¸€ä¸²è¯ï¼Œå®ƒä»¬å°±æ˜¯ä½ çš„ç§é’¥å“¦ã€‚ ä¸‡ä¸€ï¼Œå¦‚æœçœŸçš„è¿ä¸ä¸Šçš„è¯ï¼Œå¯èƒ½éœ€è¦åœ¨è·¯ç”±ä¸Šé…ç½®ï¼ŒUPnPï¼Œé˜²ç«å¢™è¦å…è®¸ 8444ã€‚ 1.2.3 è®¿é—® Chia çš„æ•°æ®Chia çš„å®¢æˆ·ç«¯æŠŠæ•°æ®å­˜åœ¨äº†å‡ ä¸ª SQLite æ•°æ®åº“é‡Œï¼Œå®ƒä»¬çš„è·¯å¾„æ˜¯æˆ‘ä»¬å®‰è£…å®¢æˆ·ç«¯çš„ç”¨æˆ·çš„å®¶ç›®å½•ï¼š~/.chia/mainnet ä¸‹è¾¹å°±æ˜¯è¿è¡Œèµ·æ¥ Chia ä¹‹åç”Ÿæˆçš„ä¸»è¦çš„ä¸¤ä¸ªæ•°æ®åº“çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š ~/.chia/mainnet/db â¯ ll -h total 4350416 -rw-r--r-- 1 weyl staff 2.0G May 6 12:06 blockchain_v1_mainnet.sqlite -rw-r--r-- 1 weyl staff 64K May 6 11:17 blockchain_v1_mainnet.sqlite-shm -rw-r--r-- 1 weyl staff 20M May 6 12:10 blockchain_v1_mainnet.sqlite-wal -rw-r--r-- 1 weyl staff 1.8M May 6 11:46 peer_table_node.sqlite -rw-r--r-- 1 weyl staff 32K May 5 17:30 peer_table_node.sqlite-shm -rw-r--r-- 1 weyl staff 5.4M May 6 11:46 peer_table_node.sqlite-wal ~/.chia/mainnet/wallet/db â¯ ll -h total 3055848 -rw-r--r-- 1 weyl staff 1.4G May 7 15:32 blockchain_wallet_v1_mainnet_903996200.sqlite -rw-r--r-- 1 weyl staff 32K May 7 15:24 blockchain_wallet_v1_mainnet_903996200.sqlite-shm -rw-r--r-- 1 weyl staff 4.0M May 7 15:32 blockchain_wallet_v1_mainnet_903996200.sqlite-wal -rw-r--r-- 1 weyl staff 16K May 7 15:24 wallet_peers.sqlite ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨ SQLite Browserï¼Œä¸€ä¸ª SQlite æ•°æ®åº“ï¼ˆæ–‡ä»¶ï¼‰çš„æµè§ˆå™¨æ¥çœ‹çœ‹å®ƒã€‚ SQlite æµè§ˆå™¨çš„å®˜ç½‘æ˜¯ https://sqlitebrowser.org/ ã€‚åœ¨ä¸‹è½½ï¼Œå®‰è£…ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‚¹å‡» Open Database/æ‰“å¼€æ•°æ®åº“ é€‰æ‹©æµè§ˆä¸Šè¾¹åˆ—å‡ºæ¥çš„ä¸¤ä¸ª .sqlite æ‰©å±•åçš„æ•°æ®åº“æ–‡ä»¶ã€‚ æ‰“å¼€æ•°æ®åº“ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç¬¬ä¸€ä¸ªæ ‡ç­¾ Database Schema æ¥çœ‹çœ‹è¡¨çš„ç»“æ„ã€‚ æˆ‘ä»¬è¿˜èƒ½åƒç±»ä¼¼äº Excel ä¸€æ ·å»çœ‹è¡¨çš„æ•°æ®ï¼Œè¿˜å¯ä»¥ Filter/è¿‡æ»¤ã€Sort/æ’åºä»»æ„åˆ—ã€‚ ä¸‹ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ¥ç®€å•çœ‹çœ‹è¡¨é‡Œçš„æ•°æ®ã€‚ Tips: è¿™é‡Œè¾¹ï¼Œ~/.chia/mainnet/wallet å’Œè£¸ç›®å½• ~/.chia/mainnet ä¸‹è¾¹çš„ db é‡Œåˆ†åˆ«éƒ½æœ‰è¡¨æ–‡ä»¶ï¼Œä»–ä»¬çš„ä¿¡æ¯æ˜¯æœ‰é‡å¤çš„ï¼Œå¤§å®¶å¯ä»¥åˆ†åˆ«æ‰“å¼€çœ‹çœ‹å“¦ï¼Œå³ä½¿æ˜¯ç›¸åŒçš„è¡¨çš„åå­—ï¼Œæ¯”å¦‚ block_record å†…é‡Œçš„ä¿¡æ¯ä¹Ÿç•¥æœ‰å·®åˆ«ï¼Œå¦‚æœå¤§å®¶çŸ¥é“ä¸ºä»€ä¹ˆæœ‰è¿™æ ·çš„å·®åˆ«ï¼Œæ¬¢è¿æµè§ˆå‘Šè¯‰å¤§å®¶å“ˆï¼Œå¯èƒ½è¦ä»”ç»†ç ”ç©¶ä¸€ä¸‹å®¢æˆ·ç«¯ã€é’±åŒ…ç­‰ä»£ç æ‰è¡Œï¼Œå¹¸è¿çš„æ˜¯ï¼Œå®ƒä»¬ç›¸å¯¹æ¯”è¾ƒå¥½é˜…è¯»ï¼Œæ˜¯ Python å†™çš„ï¼š https://github.com/Chia-Network/chia-blockchain ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:1:2","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#è¿è¡Œ"},{"categories":["Nebula Graph"],"content":" 1.2 å¦‚ä½•è¿æ¥Chia?æˆ‘ä»¬å¯ä»¥é€šè¿‡ Chia Network çš„å®¢æˆ·ç«¯æ¥è®¿é—®å®ƒï¼Œè¿™ä¸ªå®¢æˆ·ç«¯æ˜¯ Electron + Python çš„ç¨‹åºï¼Œå¤©ç„¶è·¨å¹³å°ï¼Œæ—¢æœ‰ GUI åˆæœ‰ CLI çš„æ–¹å¼ã€‚ 1.2.1 å®‰è£…åªéœ€è¦æŒ‰ç…§å®˜æ–¹çš„ Guide æ¥ä¸‹è½½å®‰è£…å°±å¥½ï¼Œ https://github.com/Chia-Network/chia-blockchain/wiki/INSTALLï¼Œæˆ‘åœ¨ M1 Mac ä¸‹å®‰è£…çš„æ—¶å€™è„šæœ¬å‡ºäº†ç‚¹å°é—®é¢˜ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºæ‹‰å–äºŒè¿›åˆ¶ wheel æ–‡ä»¶ç½‘ç»œå‡ºé—®é¢˜èµ°åˆ°äº†ç¼–è¯‘ wheelçš„é€»è¾‘ï¼Œè€Œé‚£é‡Œæ˜¯ä¾èµ– cargoçš„ï¼Œå¦‚æœå¤§å®¶é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥æå‰æ‰‹åŠ¨å®‰è£…ä¸€ä¸‹ rustï¼Œæˆ–è€… cherry-pick æˆ‘çš„è¿™ä¸ª PR ã€‚ 1.2.2 è¿è¡Œ æŒ‰ç…§å®˜æ–¹ guideï¼Œæ¯”å¦‚ macOS æ¥è¯´ï¼Œæœ€åä¸€æ­¥æ‰§è¡Œnpm run electron \u0026 å°±æ˜¯è¿è¡Œå®ƒçš„GUIå®¢æˆ·ç«¯ã€‚ å¦‚æœå¤§å®¶åƒæˆ‘ä¸€æ ·å–œæ¬¢ CLIï¼Œç›´æ¥åœ¨æ‰§è¡Œå®Œ . ./activate ä¹‹åå°±å¯ä»¥ chia --helpäº†å“ˆâ˜ºï¼Œé‡Œè¾¹æœ‰åªå¯åŠ¨éƒ¨åˆ†æœåŠ¡çš„æ–¹å¼ï¼ˆç›¸æ¯” GUI å¯åŠ¨æ‰€æœ‰æ¥è¯´)ã€‚ åœ¨è¿è¡Œä¹‹åï¼Œå¦‚æœä½ çš„ç½‘ç»œä¸æ˜¯å¤šå±‚ NAT çš„é‚£ç§ï¼Œç†è®ºä¸Šæ‚¨å¯ä»¥è¿åˆ° mainnet å¹¶ä¸”è‡ªåŠ¨å’Œä¸»é“¾åŒæ­¥æ•°æ®äº†ï¼Œå¦‚æœæ‚¨æ˜¯ç¬¬äºŒæ¬¡è¿è¡Œï¼Œè¿æ¥ä¸»é“¾ï¼Œä¸€å¼€å§‹å¯èƒ½æœ‰ä¸€é˜µå­åŒæ­¥çš„block æ•°æ˜¯ä¸å˜çš„ï¼Œä¹Ÿæ²¡æœ‰ peer è¿è¿‡æ¥ï¼Œä¸å¿…æƒŠæ…Œï¼Œç­‰ä¸€ä¸‹å°±å¥½äº†ã€‚ Tips: ç¬¬ä¸€æ¬¡è¿åˆ° Chia Network çš„åŒå­¦ä»¬ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé’±åŒ…ï¼ŒåŠçš„ä¿å­˜é‚£ä¸€ä¸²è¯ï¼Œå®ƒä»¬å°±æ˜¯ä½ çš„ç§é’¥å“¦ã€‚ ä¸‡ä¸€ï¼Œå¦‚æœçœŸçš„è¿ä¸ä¸Šçš„è¯ï¼Œå¯èƒ½éœ€è¦åœ¨è·¯ç”±ä¸Šé…ç½®ï¼ŒUPnPï¼Œé˜²ç«å¢™è¦å…è®¸ 8444ã€‚ 1.2.3 è®¿é—® Chia çš„æ•°æ®Chia çš„å®¢æˆ·ç«¯æŠŠæ•°æ®å­˜åœ¨äº†å‡ ä¸ª SQLite æ•°æ®åº“é‡Œï¼Œå®ƒä»¬çš„è·¯å¾„æ˜¯æˆ‘ä»¬å®‰è£…å®¢æˆ·ç«¯çš„ç”¨æˆ·çš„å®¶ç›®å½•ï¼š~/.chia/mainnet ä¸‹è¾¹å°±æ˜¯è¿è¡Œèµ·æ¥ Chia ä¹‹åç”Ÿæˆçš„ä¸»è¦çš„ä¸¤ä¸ªæ•°æ®åº“çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š ~/.chia/mainnet/db â¯ ll -h total 4350416 -rw-r--r-- 1 weyl staff 2.0G May 6 12:06 blockchain_v1_mainnet.sqlite -rw-r--r-- 1 weyl staff 64K May 6 11:17 blockchain_v1_mainnet.sqlite-shm -rw-r--r-- 1 weyl staff 20M May 6 12:10 blockchain_v1_mainnet.sqlite-wal -rw-r--r-- 1 weyl staff 1.8M May 6 11:46 peer_table_node.sqlite -rw-r--r-- 1 weyl staff 32K May 5 17:30 peer_table_node.sqlite-shm -rw-r--r-- 1 weyl staff 5.4M May 6 11:46 peer_table_node.sqlite-wal ~/.chia/mainnet/wallet/db â¯ ll -h total 3055848 -rw-r--r-- 1 weyl staff 1.4G May 7 15:32 blockchain_wallet_v1_mainnet_903996200.sqlite -rw-r--r-- 1 weyl staff 32K May 7 15:24 blockchain_wallet_v1_mainnet_903996200.sqlite-shm -rw-r--r-- 1 weyl staff 4.0M May 7 15:32 blockchain_wallet_v1_mainnet_903996200.sqlite-wal -rw-r--r-- 1 weyl staff 16K May 7 15:24 wallet_peers.sqlite ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨ SQLite Browserï¼Œä¸€ä¸ª SQlite æ•°æ®åº“ï¼ˆæ–‡ä»¶ï¼‰çš„æµè§ˆå™¨æ¥çœ‹çœ‹å®ƒã€‚ SQlite æµè§ˆå™¨çš„å®˜ç½‘æ˜¯ https://sqlitebrowser.org/ ã€‚åœ¨ä¸‹è½½ï¼Œå®‰è£…ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‚¹å‡» Open Database/æ‰“å¼€æ•°æ®åº“ é€‰æ‹©æµè§ˆä¸Šè¾¹åˆ—å‡ºæ¥çš„ä¸¤ä¸ª .sqlite æ‰©å±•åçš„æ•°æ®åº“æ–‡ä»¶ã€‚ æ‰“å¼€æ•°æ®åº“ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç¬¬ä¸€ä¸ªæ ‡ç­¾ Database Schema æ¥çœ‹çœ‹è¡¨çš„ç»“æ„ã€‚ æˆ‘ä»¬è¿˜èƒ½åƒç±»ä¼¼äº Excel ä¸€æ ·å»çœ‹è¡¨çš„æ•°æ®ï¼Œè¿˜å¯ä»¥ Filter/è¿‡æ»¤ã€Sort/æ’åºä»»æ„åˆ—ã€‚ ä¸‹ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ¥ç®€å•çœ‹çœ‹è¡¨é‡Œçš„æ•°æ®ã€‚ Tips: è¿™é‡Œè¾¹ï¼Œ~/.chia/mainnet/wallet å’Œè£¸ç›®å½• ~/.chia/mainnet ä¸‹è¾¹çš„ db é‡Œåˆ†åˆ«éƒ½æœ‰è¡¨æ–‡ä»¶ï¼Œä»–ä»¬çš„ä¿¡æ¯æ˜¯æœ‰é‡å¤çš„ï¼Œå¤§å®¶å¯ä»¥åˆ†åˆ«æ‰“å¼€çœ‹çœ‹å“¦ï¼Œå³ä½¿æ˜¯ç›¸åŒçš„è¡¨çš„åå­—ï¼Œæ¯”å¦‚ block_record å†…é‡Œçš„ä¿¡æ¯ä¹Ÿç•¥æœ‰å·®åˆ«ï¼Œå¦‚æœå¤§å®¶çŸ¥é“ä¸ºä»€ä¹ˆæœ‰è¿™æ ·çš„å·®åˆ«ï¼Œæ¬¢è¿æµè§ˆå‘Šè¯‰å¤§å®¶å“ˆï¼Œå¯èƒ½è¦ä»”ç»†ç ”ç©¶ä¸€ä¸‹å®¢æˆ·ç«¯ã€é’±åŒ…ç­‰ä»£ç æ‰è¡Œï¼Œå¹¸è¿çš„æ˜¯ï¼Œå®ƒä»¬ç›¸å¯¹æ¯”è¾ƒå¥½é˜…è¯»ï¼Œæ˜¯ Python å†™çš„ï¼š https://github.com/Chia-Network/chia-blockchain ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:1:2","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#è®¿é—®-chia-çš„æ•°æ®"},{"categories":["Nebula Graph"],"content":" 2 åˆ†æ Chia çš„æ•°æ®å¦‚æœå¤§å®¶ä»”ç»†çœ‹äº†ä¸Šè¾¹è¡¨ç»“æ„å®šä¹‰çš„æˆªå›¾ï¼Œå°±èƒ½æ³¨æ„åˆ°ä¸€äº›è¡¨çš„ä¸»è¦ä¿¡æ¯æ˜¯åµŒå¥—äºŒè¿›åˆ¶ KV Byteï¼Œæ‰€ä»¥åªä» SQLite å¹¶ä¸èƒ½çœ‹åˆ°æ‰€æœ‰ Chia çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ï¼ˆç”¨ä¸€ä¸ªç¼–ç¨‹è¯­è¨€æ¥ï¼‰è¯»å–è¡¨é‡Œçš„ Byteã€‚ å¹¸è¿çš„æ˜¯ï¼Œè¿™ä»¶äº‹å„¿å› ä¸º Chia æ˜¯å¼€æºçš„ï¼Œè€Œä¸”æ˜¯ Python çš„ä»£ç ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ç›´æ¥äº¤äº’å¼çš„åšã€‚ æˆ‘èŠ±äº†ä¸€ç‚¹ç‚¹æ—¶é—´åœ¨ Chia å®¢æˆ·ç«¯ä»£ç é‡Œæ‰¾åˆ°äº†éœ€è¦çš„å°è£…ç±»ï¼Œå€ŸåŠ©å®ƒï¼Œå¯ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„åˆ†æ Chia å®¢æˆ·ç«¯åœ¨æœ¬åœ°çš„å…¨é“¾æ•°æ®ã€‚ å¦‚æœæ‚¨ä¸æ„Ÿå…´è¶£ç»†èŠ‚ï¼Œå¯ä»¥ç›´æ¥çœ‹æˆ‘åˆ†æçš„ç»“è®ºã€‚ ç»“è®ºä¹‹åï¼Œæˆ‘ä¹Ÿç»™å¤§å®¶æ¼”ç¤ºä¸€ä¸‹æ˜¯æ€ä¹ˆè¯»å–å®ƒä»¬çš„ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:2:0","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#åˆ†æ-chia-çš„æ•°æ®"},{"categories":["Nebula Graph"],"content":" 2.1 TL;DR, ç»“è®ºæˆ‘ä»¬å¯ä»¥ä»è¡¨ä¸­è¯»å–åˆ°åŒºå—é“¾è®°å½•ï¼ˆBlock Record ï¼‰ï¼ŒChia å¸è®°å½•ï¼ˆCoin Recordï¼‰ã€‚ ä»åŒºå—è®°å½•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…³é”®çš„æ¶‰åŠäº¤æ˜“çš„ä¿¡æ¯ï¼š å…³è”çš„ Coin ï¼Œå…³è”çš„ Puzzleï¼ˆåœ°å€ï¼‰ï¼ŒCoin çš„å€¼(Amount) ä»å¸è®°å½•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…³é”®çš„æ¶‰åŠåŒºå—çš„ä¿¡æ¯ï¼š ç”Ÿæˆè¿™ä¸ª Coin æ‰€åœ¨åŒºå—é“¾é‡Œçš„ç´¢å¼•é«˜åº¦ï¼ˆConfirmed Indexï¼‰ å¦‚æœè¿™ä¸ªè®°å½•æ˜¯èŠ±è´¹ Coin çš„ï¼ŒèŠ±è´¹å®ƒçš„ç´¢å¼•é«˜åº¦ï¼ˆSpent Indexï¼‰ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ Coin Record â”‚ â”‚ Block Record â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Coin Name â”‚ â”‚ Height â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”¼â”€â”€â”€â–º Puzzle â”‚ â”‚ Header â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”¼â”€â”€â”€â–º Coin Parent â”‚ â”‚ Prev Header â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”¼â”€â”€â”€â–º Amount â”‚ â”‚ Block Body â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ farmer_puzzle_hash â”‚ â”‚ â”‚ â”‚ Time Stamp â”‚ â”‚ fees â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ pool_puzzle_hash â”‚ â””â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”¬â”€ Confirmed Index â”‚ â”‚ prev_transaction_block_hash â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ prev_transaction_block_height â”‚ â”‚ â”‚ â””â”€ Spent Index â”‚ â”‚ transactions_info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€ is_transaction_block â”‚ â”‚ Coinbase â”‚ â”‚ â”‚ sub_epoch_summary â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ is Peak â”‚ â”‚ â”‚ â””â”€â”€is Block â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”¼â”€â–º Sub Epoch Segment â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ","date":"2021-05-26","objectID":"/nebula-chia/:2:1","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#tldr-ç»“è®º"},{"categories":["Nebula Graph"],"content":" 2.2 å‡†å¤‡å› ä¸ºå®‰è£…å®¢æˆ·ç«¯ä¹‹åï¼Œæˆ‘ä»¬æœ¬åœ°å®é™…ä¸Šå·²ç»æœ‰äº†ç›¸å…³çš„ Python ç¯å¢ƒå’Œä¾èµ–ï¼Œåªéœ€è¦åœ¨é‡Œè¾¹è·‘èµ·æ¥å°±å¥½ã€‚ # æ³¨æ„ï¼Œæˆ‘ä»¬è¦ cd åˆ°ä¹‹å‰å®‰è£…å®¢æˆ·ç«¯æ—¶å€™å…‹éš†çš„ä»“åº“ã€‚ cd chia-blockchain # source activate è„šæœ¬æ¥åˆ‡æ¢åˆ°ä»“åº“å®‰è£…æ—¶å€™åˆ›å»ºçš„ Python è™šæ‹Ÿç¯å¢ƒï¼Œå¹¶è¿›åˆ° IPython é‡Œã€‚ source venv/bin/activate \u0026\u0026 pip install ipython \u0026\u0026 ipython ç„¶åè¯•ç€å¯¼å…¥å®¢æˆ·ç«¯é‡Œè¾¹å¸¦æœ‰çš„ Python çš„ Chia çš„å°è£…ç±»è¯•è¯•çœ‹ã€‚ In [1]: import sqlite3 ...: from chia.consensus.block_record import BlockRecord # å¯¼å…¥æˆåŠŸï¼Œæ²¡æœ‰æŠ¥é”™ In [2]: !pwd # æˆ‘çš„å®‰è£…å…‹éš†ç›®å½• /Users/weyl/chia-blockchain æ­å–œä½ åšå¥½äº†å‡†å¤‡ï¼Œæˆ‘ä»¬çœ‹çœ‹ Block Record é‡Œéƒ½æœ‰ä»€ä¹ˆã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:2:2","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#å‡†å¤‡"},{"categories":["Nebula Graph"],"content":" 2.3 Chia é“¾çš„æ•°æ® 2.3.1 åŒºå—è®°å½•åœ¨ä¸Šä¸€æ­¥çš„ IPython çª—å£ä¸‹ã€‚ # æ³¨æ„ï¼Œè¿™é‡Œçš„è·¯å¾„çš„å‰ç¼€æ˜¯æˆ‘ä»¬è‡ªå·±çš„å®¶ç›®å½•ï¼Œä¸åŒæ“ä½œç³»ç»Ÿï¼Œä¸åŒçš„ç”¨æˆ·éƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ chia_db_path = \"/Users/weyl/.chia/mainnet/db/blockchain_v1_mainnet.sqlite\" cur = con.cursor() # è¿™é‡Œæˆ‘ä»¬å–ç¬¬ 201645 é«˜çš„åŒºå— rows = list(cur.execute('SELECT * FROM block_records WHERE height = 201645')) # è¿™é‡Œ 0 è¡¨ç¤º SELECT ç»“æœçš„ç¬¬ä¸€è¡Œï¼Œ3 è¡¨ç¤ºåœ¨ BlockRecord è¿™ä¸ªè¡¨é‡Œè¾¹ï¼ŒBlock çš„äºŒè¿›åˆ¶ BLOB æ˜¯ç¬¬å››åˆ—ï¼Œå‚è€ƒæœ¬ç« åº•éƒ¨çš„è¡¨å®šä¹‰éƒ¨åˆ† block_records_201645 = BlockRecord.from_bytes(rows[0][3]) dir(block_records_201645) # å¯ä»¥æŸ¥çœ‹ä¸€äº›å±æ€§ is_transaction_blockï¼Œtimestampï¼Œreward_claims_incorporated In [174]: block_records_201645.is_transaction_block Out[174]: True In [182]: from datetime import datetime In [183]: datetime.fromtimestamp(block_records_201645.timestamp) Out[183]: datetime.datetime(2021, 4, 29, 10, 8, 1) In [190]: block_records_201645.reward_claims_incorporated[0].to_json_dict() Out[190]: {'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6', 'amount': 1750000000000} # å¯ä»¥å¿«é€Ÿ print çœ‹å¤§éƒ¨åˆ†ä¿¡æ¯ print(block_records_201645) block_records_201645 çš„æ‰“å°ç»“æœå¦‚ä¸‹ã€‚ æ³¨æ„ï¼Œè¿™é‡Œæˆ‘æˆªæ–­äº†ä¸€äº›æ•°æ® {'challenge_block_info_hash': '0x4a562f1ffa7a06fe76b1df74dbdd6bdcfbf63139a6f1fc3291c606d7c976abf6', 'challenge_vdf_output': {'data': '0x0200a6b38d6b58d17129d71737088772561f22a44ef302fe45a70a763b878f998abfe35946df720bcb5d78e214b667bce801d597b46c867928c4b8926c342375a961f36cd63ec698bc25e5ce48c45d9a2074eded0e42d24dd1b50a59e699f671f0900100'}, 'deficit': 16, 'farmer_puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba', 'fees': 0, 'finished_challenge_slot_hashes': ['0x2b1a7b4859a8d3597b8e6cbe3b27ab97212be8b19e6867f2a4d0eef26c36340f'], 'finished_infused_challenge_slot_hashes': ['0xd0185a6493b10d84e696c6fc55ec1920e8a96791a604dedfe77635da460f354d'], 'finished_reward_slot_hashes': ['0xe2bcbf560471131a7fb87ffe3f9ddde03166a9b0092a50f1ed1599715857c365'], 'header_hash': '0x2791729e1c914f9c3908a0ad895b5846c86fc4e207cc463820123e9a299c39f3', 'height': 201645, 'infused_challenge_vdf_output': None, 'overflow': True, 'pool_puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba', 'prev_hash': '0xf126ecf64473beb9ae5b84137788100feb9d731c604877c0744cdc6025f4cbeb', 'prev_transaction_block_hash': '0x7103fe2f1aa96998f9ccf6fc98561b64c5f7a98cf942335c4c927fb2eaa9325a', 'prev_transaction_block_height': 201643, 'required_iters': 95752, 'reward_claims_incorporated': [{'amount': 1750000000000, 'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6'}, {'amount': 250000000000, 'parent_coin_info': '0x3ff07eb358e8255a65c30a2dce0e5fbb000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6'}, {'amount': 1750000000000, 'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313aa', 'puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba'}, {'amount': 250000000000, 'parent_coin_info': '0x3ff07eb358e8255a65c30a2dce0e5fbb000000000000000000000000000313a8', 'puzzle_hash': '0xcf178071f6aa6cb1c92f00943424bcc8cb774449bd60058fc08e9894f49a1ca4'}], 'reward_infusion_new_challenge': '0x660886f4ab030c07755f53362ae4253dfa93ea853cbc321218f58f159c75adaa', 'signage_point_index': 63, 'sub_epoch_summary_included': None, 'sub_slot_iters': 99614720, 'timestamp': 1619662081, 'total_iters': 660123219464, 'weight': 4121254} å¦å¤–ï¼Œæˆ‘ä»¬å–çš„è¿™ä¸ªè¡¨çš„å®šä¹‰å¦‚ä¸‹ã€‚ CREATE TABLE block_records( header_hash text PRIMARY KEY, prev_hash text, height bigint, block blob, #\u003c---- sub_epoch_summary blob, is_peak tinyint, is_block tinyint) 2.3.2 Chia å¸è®°å½•ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥è·å–ä¸€ä¸ª Coin çš„è®°å½•ï¼Œè¿™é‡Œè¾¹ï¼Œä»è¡¨çš„å®šä¹‰å¯ä»¥çœ‹åˆ°ï¼Œå”¯ä¸€äºŒè¿›åˆ¶ï¼ˆä¸èƒ½ç›´æ¥ä»æ•°æ®åº“æŸ¥è¯¢ä¸­è¢«äººè¯»æ‡‚ï¼‰çš„å­—æ®µå°±æ˜¯æ˜¯å¸å€¼ï¼Œä¸å­˜åœ¨åµŒå¥—çš„ç»“æ„ï¼Œæ‰€ä»¥ä¹Ÿå¹¶ä¸éœ€è¦å°è£…çš„ç±»æ‰èƒ½çœ‹æ¸…æ¥šé‡Œè¾¹çš„ä¿¡æ¯ã€‚ CREATE TABLE coin_record( coin_name text PRIMARY KEY, confirmed_index bigint, spent_index bigint, spent int, coinbase int, puzzle_hash text, coin_parent text, amount blob, timestamp bigint) è¿™é‡Œå€¼å¾—æ³¨æ„çš„ä¿¡æ¯ä¸»è¦","date":"2021-05-26","objectID":"/nebula-chia/:2:3","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#chia-é“¾çš„æ•°æ®"},{"categories":["Nebula Graph"],"content":" 2.3 Chia é“¾çš„æ•°æ® 2.3.1 åŒºå—è®°å½•åœ¨ä¸Šä¸€æ­¥çš„ IPython çª—å£ä¸‹ã€‚ # æ³¨æ„ï¼Œè¿™é‡Œçš„è·¯å¾„çš„å‰ç¼€æ˜¯æˆ‘ä»¬è‡ªå·±çš„å®¶ç›®å½•ï¼Œä¸åŒæ“ä½œç³»ç»Ÿï¼Œä¸åŒçš„ç”¨æˆ·éƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ chia_db_path = \"/Users/weyl/.chia/mainnet/db/blockchain_v1_mainnet.sqlite\" cur = con.cursor() # è¿™é‡Œæˆ‘ä»¬å–ç¬¬ 201645 é«˜çš„åŒºå— rows = list(cur.execute('SELECT * FROM block_records WHERE height = 201645')) # è¿™é‡Œ 0 è¡¨ç¤º SELECT ç»“æœçš„ç¬¬ä¸€è¡Œï¼Œ3 è¡¨ç¤ºåœ¨ BlockRecord è¿™ä¸ªè¡¨é‡Œè¾¹ï¼ŒBlock çš„äºŒè¿›åˆ¶ BLOB æ˜¯ç¬¬å››åˆ—ï¼Œå‚è€ƒæœ¬ç« åº•éƒ¨çš„è¡¨å®šä¹‰éƒ¨åˆ† block_records_201645 = BlockRecord.from_bytes(rows[0][3]) dir(block_records_201645) # å¯ä»¥æŸ¥çœ‹ä¸€äº›å±æ€§ is_transaction_blockï¼Œtimestampï¼Œreward_claims_incorporated In [174]: block_records_201645.is_transaction_block Out[174]: True In [182]: from datetime import datetime In [183]: datetime.fromtimestamp(block_records_201645.timestamp) Out[183]: datetime.datetime(2021, 4, 29, 10, 8, 1) In [190]: block_records_201645.reward_claims_incorporated[0].to_json_dict() Out[190]: {'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6', 'amount': 1750000000000} # å¯ä»¥å¿«é€Ÿ print çœ‹å¤§éƒ¨åˆ†ä¿¡æ¯ print(block_records_201645) block_records_201645 çš„æ‰“å°ç»“æœå¦‚ä¸‹ã€‚ æ³¨æ„ï¼Œè¿™é‡Œæˆ‘æˆªæ–­äº†ä¸€äº›æ•°æ® {'challenge_block_info_hash': '0x4a562f1ffa7a06fe76b1df74dbdd6bdcfbf63139a6f1fc3291c606d7c976abf6', 'challenge_vdf_output': {'data': '0x0200a6b38d6b58d17129d71737088772561f22a44ef302fe45a70a763b878f998abfe35946df720bcb5d78e214b667bce801d597b46c867928c4b8926c342375a961f36cd63ec698bc25e5ce48c45d9a2074eded0e42d24dd1b50a59e699f671f0900100'}, 'deficit': 16, 'farmer_puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba', 'fees': 0, 'finished_challenge_slot_hashes': ['0x2b1a7b4859a8d3597b8e6cbe3b27ab97212be8b19e6867f2a4d0eef26c36340f'], 'finished_infused_challenge_slot_hashes': ['0xd0185a6493b10d84e696c6fc55ec1920e8a96791a604dedfe77635da460f354d'], 'finished_reward_slot_hashes': ['0xe2bcbf560471131a7fb87ffe3f9ddde03166a9b0092a50f1ed1599715857c365'], 'header_hash': '0x2791729e1c914f9c3908a0ad895b5846c86fc4e207cc463820123e9a299c39f3', 'height': 201645, 'infused_challenge_vdf_output': None, 'overflow': True, 'pool_puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba', 'prev_hash': '0xf126ecf64473beb9ae5b84137788100feb9d731c604877c0744cdc6025f4cbeb', 'prev_transaction_block_hash': '0x7103fe2f1aa96998f9ccf6fc98561b64c5f7a98cf942335c4c927fb2eaa9325a', 'prev_transaction_block_height': 201643, 'required_iters': 95752, 'reward_claims_incorporated': [{'amount': 1750000000000, 'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6'}, {'amount': 250000000000, 'parent_coin_info': '0x3ff07eb358e8255a65c30a2dce0e5fbb000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6'}, {'amount': 1750000000000, 'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313aa', 'puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba'}, {'amount': 250000000000, 'parent_coin_info': '0x3ff07eb358e8255a65c30a2dce0e5fbb000000000000000000000000000313a8', 'puzzle_hash': '0xcf178071f6aa6cb1c92f00943424bcc8cb774449bd60058fc08e9894f49a1ca4'}], 'reward_infusion_new_challenge': '0x660886f4ab030c07755f53362ae4253dfa93ea853cbc321218f58f159c75adaa', 'signage_point_index': 63, 'sub_epoch_summary_included': None, 'sub_slot_iters': 99614720, 'timestamp': 1619662081, 'total_iters': 660123219464, 'weight': 4121254} å¦å¤–ï¼Œæˆ‘ä»¬å–çš„è¿™ä¸ªè¡¨çš„å®šä¹‰å¦‚ä¸‹ã€‚ CREATE TABLE block_records( header_hash text PRIMARY KEY, prev_hash text, height bigint, block blob, #\u003c---- sub_epoch_summary blob, is_peak tinyint, is_block tinyint) 2.3.2 Chia å¸è®°å½•ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥è·å–ä¸€ä¸ª Coin çš„è®°å½•ï¼Œè¿™é‡Œè¾¹ï¼Œä»è¡¨çš„å®šä¹‰å¯ä»¥çœ‹åˆ°ï¼Œå”¯ä¸€äºŒè¿›åˆ¶ï¼ˆä¸èƒ½ç›´æ¥ä»æ•°æ®åº“æŸ¥è¯¢ä¸­è¢«äººè¯»æ‡‚ï¼‰çš„å­—æ®µå°±æ˜¯æ˜¯å¸å€¼ï¼Œä¸å­˜åœ¨åµŒå¥—çš„ç»“æ„ï¼Œæ‰€ä»¥ä¹Ÿå¹¶ä¸éœ€è¦å°è£…çš„ç±»æ‰èƒ½çœ‹æ¸…æ¥šé‡Œè¾¹çš„ä¿¡æ¯ã€‚ CREATE TABLE coin_record( coin_name text PRIMARY KEY, confirmed_index bigint, spent_index bigint, spent int, coinbase int, puzzle_hash text, coin_parent text, amount blob, timestamp bigint) è¿™é‡Œå€¼å¾—æ³¨æ„çš„ä¿¡æ¯ä¸»è¦","date":"2021-05-26","objectID":"/nebula-chia/:2:3","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#åŒºå—è®°å½•"},{"categories":["Nebula Graph"],"content":" 2.3 Chia é“¾çš„æ•°æ® 2.3.1 åŒºå—è®°å½•åœ¨ä¸Šä¸€æ­¥çš„ IPython çª—å£ä¸‹ã€‚ # æ³¨æ„ï¼Œè¿™é‡Œçš„è·¯å¾„çš„å‰ç¼€æ˜¯æˆ‘ä»¬è‡ªå·±çš„å®¶ç›®å½•ï¼Œä¸åŒæ“ä½œç³»ç»Ÿï¼Œä¸åŒçš„ç”¨æˆ·éƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ chia_db_path = \"/Users/weyl/.chia/mainnet/db/blockchain_v1_mainnet.sqlite\" cur = con.cursor() # è¿™é‡Œæˆ‘ä»¬å–ç¬¬ 201645 é«˜çš„åŒºå— rows = list(cur.execute('SELECT * FROM block_records WHERE height = 201645')) # è¿™é‡Œ 0 è¡¨ç¤º SELECT ç»“æœçš„ç¬¬ä¸€è¡Œï¼Œ3 è¡¨ç¤ºåœ¨ BlockRecord è¿™ä¸ªè¡¨é‡Œè¾¹ï¼ŒBlock çš„äºŒè¿›åˆ¶ BLOB æ˜¯ç¬¬å››åˆ—ï¼Œå‚è€ƒæœ¬ç« åº•éƒ¨çš„è¡¨å®šä¹‰éƒ¨åˆ† block_records_201645 = BlockRecord.from_bytes(rows[0][3]) dir(block_records_201645) # å¯ä»¥æŸ¥çœ‹ä¸€äº›å±æ€§ is_transaction_blockï¼Œtimestampï¼Œreward_claims_incorporated In [174]: block_records_201645.is_transaction_block Out[174]: True In [182]: from datetime import datetime In [183]: datetime.fromtimestamp(block_records_201645.timestamp) Out[183]: datetime.datetime(2021, 4, 29, 10, 8, 1) In [190]: block_records_201645.reward_claims_incorporated[0].to_json_dict() Out[190]: {'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6', 'amount': 1750000000000} # å¯ä»¥å¿«é€Ÿ print çœ‹å¤§éƒ¨åˆ†ä¿¡æ¯ print(block_records_201645) block_records_201645 çš„æ‰“å°ç»“æœå¦‚ä¸‹ã€‚ æ³¨æ„ï¼Œè¿™é‡Œæˆ‘æˆªæ–­äº†ä¸€äº›æ•°æ® {'challenge_block_info_hash': '0x4a562f1ffa7a06fe76b1df74dbdd6bdcfbf63139a6f1fc3291c606d7c976abf6', 'challenge_vdf_output': {'data': '0x0200a6b38d6b58d17129d71737088772561f22a44ef302fe45a70a763b878f998abfe35946df720bcb5d78e214b667bce801d597b46c867928c4b8926c342375a961f36cd63ec698bc25e5ce48c45d9a2074eded0e42d24dd1b50a59e699f671f0900100'}, 'deficit': 16, 'farmer_puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba', 'fees': 0, 'finished_challenge_slot_hashes': ['0x2b1a7b4859a8d3597b8e6cbe3b27ab97212be8b19e6867f2a4d0eef26c36340f'], 'finished_infused_challenge_slot_hashes': ['0xd0185a6493b10d84e696c6fc55ec1920e8a96791a604dedfe77635da460f354d'], 'finished_reward_slot_hashes': ['0xe2bcbf560471131a7fb87ffe3f9ddde03166a9b0092a50f1ed1599715857c365'], 'header_hash': '0x2791729e1c914f9c3908a0ad895b5846c86fc4e207cc463820123e9a299c39f3', 'height': 201645, 'infused_challenge_vdf_output': None, 'overflow': True, 'pool_puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba', 'prev_hash': '0xf126ecf64473beb9ae5b84137788100feb9d731c604877c0744cdc6025f4cbeb', 'prev_transaction_block_hash': '0x7103fe2f1aa96998f9ccf6fc98561b64c5f7a98cf942335c4c927fb2eaa9325a', 'prev_transaction_block_height': 201643, 'required_iters': 95752, 'reward_claims_incorporated': [{'amount': 1750000000000, 'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6'}, {'amount': 250000000000, 'parent_coin_info': '0x3ff07eb358e8255a65c30a2dce0e5fbb000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6'}, {'amount': 1750000000000, 'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313aa', 'puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba'}, {'amount': 250000000000, 'parent_coin_info': '0x3ff07eb358e8255a65c30a2dce0e5fbb000000000000000000000000000313a8', 'puzzle_hash': '0xcf178071f6aa6cb1c92f00943424bcc8cb774449bd60058fc08e9894f49a1ca4'}], 'reward_infusion_new_challenge': '0x660886f4ab030c07755f53362ae4253dfa93ea853cbc321218f58f159c75adaa', 'signage_point_index': 63, 'sub_epoch_summary_included': None, 'sub_slot_iters': 99614720, 'timestamp': 1619662081, 'total_iters': 660123219464, 'weight': 4121254} å¦å¤–ï¼Œæˆ‘ä»¬å–çš„è¿™ä¸ªè¡¨çš„å®šä¹‰å¦‚ä¸‹ã€‚ CREATE TABLE block_records( header_hash text PRIMARY KEY, prev_hash text, height bigint, block blob, #\u003c---- sub_epoch_summary blob, is_peak tinyint, is_block tinyint) 2.3.2 Chia å¸è®°å½•ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥è·å–ä¸€ä¸ª Coin çš„è®°å½•ï¼Œè¿™é‡Œè¾¹ï¼Œä»è¡¨çš„å®šä¹‰å¯ä»¥çœ‹åˆ°ï¼Œå”¯ä¸€äºŒè¿›åˆ¶ï¼ˆä¸èƒ½ç›´æ¥ä»æ•°æ®åº“æŸ¥è¯¢ä¸­è¢«äººè¯»æ‡‚ï¼‰çš„å­—æ®µå°±æ˜¯æ˜¯å¸å€¼ï¼Œä¸å­˜åœ¨åµŒå¥—çš„ç»“æ„ï¼Œæ‰€ä»¥ä¹Ÿå¹¶ä¸éœ€è¦å°è£…çš„ç±»æ‰èƒ½çœ‹æ¸…æ¥šé‡Œè¾¹çš„ä¿¡æ¯ã€‚ CREATE TABLE coin_record( coin_name text PRIMARY KEY, confirmed_index bigint, spent_index bigint, spent int, coinbase int, puzzle_hash text, coin_parent text, amount blob, timestamp bigint) è¿™é‡Œå€¼å¾—æ³¨æ„çš„ä¿¡æ¯ä¸»è¦","date":"2021-05-26","objectID":"/nebula-chia/:2:3","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#chia-å¸è®°å½•"},{"categories":["Nebula Graph"],"content":" 2.3 Chia é“¾çš„æ•°æ® 2.3.1 åŒºå—è®°å½•åœ¨ä¸Šä¸€æ­¥çš„ IPython çª—å£ä¸‹ã€‚ # æ³¨æ„ï¼Œè¿™é‡Œçš„è·¯å¾„çš„å‰ç¼€æ˜¯æˆ‘ä»¬è‡ªå·±çš„å®¶ç›®å½•ï¼Œä¸åŒæ“ä½œç³»ç»Ÿï¼Œä¸åŒçš„ç”¨æˆ·éƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ chia_db_path = \"/Users/weyl/.chia/mainnet/db/blockchain_v1_mainnet.sqlite\" cur = con.cursor() # è¿™é‡Œæˆ‘ä»¬å–ç¬¬ 201645 é«˜çš„åŒºå— rows = list(cur.execute('SELECT * FROM block_records WHERE height = 201645')) # è¿™é‡Œ 0 è¡¨ç¤º SELECT ç»“æœçš„ç¬¬ä¸€è¡Œï¼Œ3 è¡¨ç¤ºåœ¨ BlockRecord è¿™ä¸ªè¡¨é‡Œè¾¹ï¼ŒBlock çš„äºŒè¿›åˆ¶ BLOB æ˜¯ç¬¬å››åˆ—ï¼Œå‚è€ƒæœ¬ç« åº•éƒ¨çš„è¡¨å®šä¹‰éƒ¨åˆ† block_records_201645 = BlockRecord.from_bytes(rows[0][3]) dir(block_records_201645) # å¯ä»¥æŸ¥çœ‹ä¸€äº›å±æ€§ is_transaction_blockï¼Œtimestampï¼Œreward_claims_incorporated In [174]: block_records_201645.is_transaction_block Out[174]: True In [182]: from datetime import datetime In [183]: datetime.fromtimestamp(block_records_201645.timestamp) Out[183]: datetime.datetime(2021, 4, 29, 10, 8, 1) In [190]: block_records_201645.reward_claims_incorporated[0].to_json_dict() Out[190]: {'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6', 'amount': 1750000000000} # å¯ä»¥å¿«é€Ÿ print çœ‹å¤§éƒ¨åˆ†ä¿¡æ¯ print(block_records_201645) block_records_201645 çš„æ‰“å°ç»“æœå¦‚ä¸‹ã€‚ æ³¨æ„ï¼Œè¿™é‡Œæˆ‘æˆªæ–­äº†ä¸€äº›æ•°æ® {'challenge_block_info_hash': '0x4a562f1ffa7a06fe76b1df74dbdd6bdcfbf63139a6f1fc3291c606d7c976abf6', 'challenge_vdf_output': {'data': '0x0200a6b38d6b58d17129d71737088772561f22a44ef302fe45a70a763b878f998abfe35946df720bcb5d78e214b667bce801d597b46c867928c4b8926c342375a961f36cd63ec698bc25e5ce48c45d9a2074eded0e42d24dd1b50a59e699f671f0900100'}, 'deficit': 16, 'farmer_puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba', 'fees': 0, 'finished_challenge_slot_hashes': ['0x2b1a7b4859a8d3597b8e6cbe3b27ab97212be8b19e6867f2a4d0eef26c36340f'], 'finished_infused_challenge_slot_hashes': ['0xd0185a6493b10d84e696c6fc55ec1920e8a96791a604dedfe77635da460f354d'], 'finished_reward_slot_hashes': ['0xe2bcbf560471131a7fb87ffe3f9ddde03166a9b0092a50f1ed1599715857c365'], 'header_hash': '0x2791729e1c914f9c3908a0ad895b5846c86fc4e207cc463820123e9a299c39f3', 'height': 201645, 'infused_challenge_vdf_output': None, 'overflow': True, 'pool_puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba', 'prev_hash': '0xf126ecf64473beb9ae5b84137788100feb9d731c604877c0744cdc6025f4cbeb', 'prev_transaction_block_hash': '0x7103fe2f1aa96998f9ccf6fc98561b64c5f7a98cf942335c4c927fb2eaa9325a', 'prev_transaction_block_height': 201643, 'required_iters': 95752, 'reward_claims_incorporated': [{'amount': 1750000000000, 'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6'}, {'amount': 250000000000, 'parent_coin_info': '0x3ff07eb358e8255a65c30a2dce0e5fbb000000000000000000000000000313ab', 'puzzle_hash': '0xbbb014f41d88c74b78501b36e4863d3382bfda9ae3c4d30a1b6df72b962502b6'}, {'amount': 1750000000000, 'parent_coin_info': '0xccd5bb71183532bff220ba46c268991a000000000000000000000000000313aa', 'puzzle_hash': '0x4bc6435b409bcbabe53870dae0f03755f6aabb4594c5915ec983acf12a5d1fba'}, {'amount': 250000000000, 'parent_coin_info': '0x3ff07eb358e8255a65c30a2dce0e5fbb000000000000000000000000000313a8', 'puzzle_hash': '0xcf178071f6aa6cb1c92f00943424bcc8cb774449bd60058fc08e9894f49a1ca4'}], 'reward_infusion_new_challenge': '0x660886f4ab030c07755f53362ae4253dfa93ea853cbc321218f58f159c75adaa', 'signage_point_index': 63, 'sub_epoch_summary_included': None, 'sub_slot_iters': 99614720, 'timestamp': 1619662081, 'total_iters': 660123219464, 'weight': 4121254} å¦å¤–ï¼Œæˆ‘ä»¬å–çš„è¿™ä¸ªè¡¨çš„å®šä¹‰å¦‚ä¸‹ã€‚ CREATE TABLE block_records( header_hash text PRIMARY KEY, prev_hash text, height bigint, block blob, #\u003c---- sub_epoch_summary blob, is_peak tinyint, is_block tinyint) 2.3.2 Chia å¸è®°å½•ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥è·å–ä¸€ä¸ª Coin çš„è®°å½•ï¼Œè¿™é‡Œè¾¹ï¼Œä»è¡¨çš„å®šä¹‰å¯ä»¥çœ‹åˆ°ï¼Œå”¯ä¸€äºŒè¿›åˆ¶ï¼ˆä¸èƒ½ç›´æ¥ä»æ•°æ®åº“æŸ¥è¯¢ä¸­è¢«äººè¯»æ‡‚ï¼‰çš„å­—æ®µå°±æ˜¯æ˜¯å¸å€¼ï¼Œä¸å­˜åœ¨åµŒå¥—çš„ç»“æ„ï¼Œæ‰€ä»¥ä¹Ÿå¹¶ä¸éœ€è¦å°è£…çš„ç±»æ‰èƒ½çœ‹æ¸…æ¥šé‡Œè¾¹çš„ä¿¡æ¯ã€‚ CREATE TABLE coin_record( coin_name text PRIMARY KEY, confirmed_index bigint, spent_index bigint, spent int, coinbase int, puzzle_hash text, coin_parent text, amount blob, timestamp bigint) è¿™é‡Œå€¼å¾—æ³¨æ„çš„ä¿¡æ¯ä¸»è¦","date":"2021-05-26","objectID":"/nebula-chia/:2:3","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#puzzles-addressåœ°å€"},{"categories":["Nebula Graph"],"content":" 3 å¦‚ä½•æ¢ç´¢ Chia é“¾éšç€æˆ‘ä»¬ä¹‹å‰åˆ†æçš„ä¿¡æ¯ï¼Œè‡ªç„¶åœ°ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ Chia åŒºå—é“¾ä¸­çš„ä¿¡æ¯å–å‡ºæ¥ï¼Œç”¨å›¾ï¼ˆGraphï¼‰æ¥è¡¨ç¤ºï¼Œè¿™é‡Œçš„å›¾å¹¶ä¸æ˜¯ï¼ˆGraphicï¼‰å›¾å½¢ã€å›¾ç”»çš„æ„æ€ï¼Œæ˜¯æ•°å­¦ã€å›¾è®ºä¸­çš„å›¾ã€‚ åœ¨å›¾çš„è¯­å¢ƒä¸‹ï¼Œæœ€ä¸»è¦çš„ä¸¤ä¸ªå…ƒç´ å°±æ˜¯é¡¶ç‚¹ï¼ˆVertexï¼‰å’Œè¾¹ï¼ˆEdgeï¼‰ã€‚ é¡¶ç‚¹è¡¨ç¤ºä¸€ä¸ªå®ä½“ï¼Œè€Œè¾¹è¡¨ç¤ºå®ä½“ä¹‹é—´çš„æŸç§å…³ç³»ï¼Œè¿™ç§å…³ç³»å¯ä»¥æ˜¯å¯¹ç­‰çš„ï¼ˆæ— æ–¹å‘çš„ï¼‰ä¹Ÿå¯ä»¥æ˜¯æœ‰æ–¹å‘çš„ã€‚ è¿™é‡Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™é‡Œçš„ä¿¡æ¯æŠ½è±¡æ˜ å°„åˆ°å¦‚å›¾çš„å›¾æ¨¡å‹é‡Œï¼š Block é¡¶ç‚¹ Coin é¡¶ç‚¹ Puzzle é¡¶ç‚¹ spends è¾¹ï¼ˆBlock åˆ° Coinï¼‰ confirms è¾¹ ï¼ˆBlock åˆ° Coinï¼‰ belongs_to è¾¹ï¼ˆCoin åˆ° Puzzleï¼‰ è¿™é‡Œï¼Œæˆ‘ä»¬åº”ç”¨çš„å›¾æ˜¯ä¸€ç§å«åšå±æ€§å›¾çš„å½¢å¼ï¼Œé™¤äº†ç‚¹å’Œè¾¹çš„å…³ç³»ä¹‹å¤–ã€‚è¿™ä¸¤ç§å®ä½“ï¼ˆç‚¹ã€è¾¹ï¼‰è¿˜æœ‰å…¶ä»–ä¿¡æ¯åªå’Œå®ƒä»¬çš„ä¸€ä¸ªå®ä¾‹ç›¸å…³ï¼Œæ‰€ä»¥å†å®šä¹‰ä¸ºé¡¶ç‚¹ã€è¾¹å°±ä¸æ˜¯å¾ˆé€‚åˆï¼Œè¿™äº›ä¿¡æ¯å°±ä½œä¸ºç‚¹ã€è¾¹çš„å±æ€§ï¼ˆprepertyï¼‰å­˜åœ¨ã€‚ è¿™ç§ä¸ºäº†å¤„ç†å®ä½“ä¹‹é—´å…³è”ã€æ¶‰åŠå®ä½“ã€å…³è”çš„å±æ€§ä¿¡æ¯çš„ï¼Œä¹Ÿå°±æ˜¯\"å±æ€§å›¾\"çš„å­˜å‚¨ä¿¡æ¯çš„æ–¹å¼åœ¨è®¡ç®—æœºé¢†åŸŸè¶Šæ¥è¶Šæµè¡Œï¼Œç”šè‡³æœ‰ä¸“é—¨ä¸ºæ­¤ç»“æ„è€ŒåŸç”Ÿå¼€å‘çš„æ•°æ®åº“â€”â€”å›¾æ•°æ®åº“ï¼ˆGraph Databaseï¼‰ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬ç”¨çš„å°±æ˜¯ä¸€ä¸ªå«åš Nebula Graph çš„å›¾æ•°æ®åº“ï¼Œå®ƒæ˜¯ä¸€ä¸ªç°ä»£çš„ã€ä¸ºè¶…å¤§è§„æ¨¡åˆ†éƒ¨ç½²æ¶æ„è®¾è®¡çš„ã€åŸç”Ÿå­˜å‚¨ã€æŸ¥è¯¢ã€è®¡ç®—å›¾æ•°æ®çš„é¡¹ç›®ï¼Œæ›´æ£’çš„æ˜¯ï¼Œå®ƒæ˜¯äº§ç”Ÿäºç¤¾åŒºçš„å¼€æºäº§å“ã€‚ Tips: å®‰è£… Nebula Graph ä¸€èˆ¬æ¥è¯´ï¼Œé¢å‘è¶…å¤§è§„æ¨¡æ•°æ®çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¤©ç„¶çš„éƒ½æ˜¯ä¸å®¹æ˜“è½»é‡éƒ¨ç½²çš„ï¼Œå¤§å®¶å¦‚æœç¬¬ä¸€æ¬¡ä½¿ç”¨çš„è¯å¯ä»¥è¯•è¯•æˆ‘å†™çš„ä¸€ä¸ªå«åš nebula-up çš„å°å·¥å…·ï¼Œå¯ä»¥ä¸€è¡ŒæŒ‡ä»¤éƒ¨ç½²ä¸€ä¸ªç”¨æ¥è¯•ç”¨ã€å­¦ä¹ çš„ Nebula Graph é›†ç¾¤ï¼Œåœ°å€åœ¨è¿™é‡Œï¼š https://github.com/wey-gu/nebula-up/ ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:3:0","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#å¦‚ä½•æ¢ç´¢-chia-é“¾"},{"categories":["Nebula Graph"],"content":" 3.1 Nebula Graph å¯¼å…¥ Chia æ•°æ®åˆ°å›¾æ•°æ®åº“æˆ‘ä»¬åˆ†ä¸¤æ­¥èµ°ï¼Œç¬¬ä¸€æ­¥è¿™æŠŠ Chia Network æ•°æ®è½¬æ¢æˆ CSV æ–‡ä»¶ï¼Œç¬¬äºŒæ­¥ä½¿ç”¨ Nebula çš„ Nebula-Importer æŠŠæ•°æ®å¯¼å…¥ Nebula Graphã€‚ 3.1.1 æ•°æ®è½¬æ¢è¿™éƒ¨åˆ†çš„ä»£ç æˆ‘å¼€æºåœ¨è¿™é‡Œäº†: https://github.com/wey-gu/nebula-chia ä½¿ç”¨å®ƒåªéœ€è¦åœ¨ Chia Network çš„ python venv ä¸‹å®‰è£…å®ƒ: python3 -m pip install nebula-chia ç„¶åè°ƒç”¨ ChaiBatchConvertor å°±å¯ä»¥åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ª CSV æ–‡ä»¶ã€‚ è¿™é‡Œè¾¹æœ‰ä¸€äº›å¯ä»¥é…ç½®çš„å‚æ•°ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä»£ç  nebulachia/convertor.py from nebulachia.convertor import ChiaBatchConvertor c = ChaiBatchConvertor( block_record_limit=0, coin_record_limit=0, write_batch_size=10000) c.convert_block_record() c.convert_coin_record() ç”Ÿæˆçš„æ–‡ä»¶ï¼š $ ls -lth -rw-r--r-- 1 weyl staff 173M May 19 13:01 coin_record.csv -rw-r--r-- 1 weyl staff 77M May 19 12:59 block_record.csv è¿™é‡Œè¾¹å­—æ®µçš„å«ä¹‰å’Œç±»å‹ï¼Œå¯ä»¥å‚è€ƒä»£ç ä¸­ block_record_row å’Œ coin_record_row çš„ __doc__ In [466]: print(c.coin_record_row.__doc__) Parse row and return a CSV block coin row list. CREATE TABLE coin_record( coin_name text PRIMARY KEY, confirmed_index bigint, spent_index bigint, spent int, coinbase int, puzzle_hash text, coin_parent text, amount blob, timestamp bigint) Coin Record CSV Head: 0 1(int) 2(int) 3(bool) coin_name|confirmed_index|spent_index|spent| 4(bool) 5 6 7(int) coinbase|puzzle_hash|coin_parent|amount| 8(timestamp) timestamp| 9 10 confirmed_hash|spent_hash In [467]: print(c.block_record_row.__doc__) Parse row and return a CSV block record row list. CREATE TABLE block_records( header_hash text PRIMARY KEY, prev_hash text, height bigint, block blob, sub_epoch_summary blob, is_peak tinyint, is_block tinyint) Block Record CSV Head: 0 1 2(int) 3(bool) 4(bool) header_hash|prev_hash|height|is_peak|is_block| 5(int) deficit| 6 challenge_block_info_hash| 7 farmer_puzzle_hash| 8(int) fees| 9 prev_transaction_block_hash| 10 prev_transaction_block_height| 11 12(int) required_iters|signage_point_index| 13(timestamp) timestamp 3.1.2 æ•°æ®å¯¼å…¥æœ‰äº† CSV æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© Nebula-Importer å¯¼å…¥æ•°æ®åˆ°å›¾æ•°æ®åº“ä¸­ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å†™å¥½äº† nebula-importer çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ¶µäº†å¦‚ä¸‹ä¿¡æ¯: åœ¨ Nebula Graph ä¸­åˆ›å»ºéœ€è¦çš„æ•°æ®æ¨¡å‹ Schemaï¼Œè¿™å’Œæˆ‘ä»¬å‰è¾¹åšçš„å›¾æ˜ å°„çš„ä¿¡æ¯æ˜¯ç­‰ä»·çš„ æè¿° CSV æ–‡ä»¶ä¹‹ä¸­çš„ Column çš„æ•°æ®åˆ°å›¾æ¨¡å‹ï¼ˆç‚¹ï¼Œè¾¹ï¼Œç‚¹æˆ–è¾¹çš„å±æ€§ï¼‰æ˜ å°„å…³ç³» # è¿™é‡Œï¼Œæˆ‘çš„ csv æ–‡ä»¶å’Œ é…ç½®æ–‡ä»¶éƒ½æ”¾åœ¨ /home/wei.gu/chia ä¹‹ä¸‹ # æˆ‘ä½¿ç”¨ docker-compose é»˜è®¤é…ç½®éƒ¨ç½²çš„ Nebula Graph, # å®ƒåˆ›å»ºäº†å« nebula-docker-compose_nebula-net çš„ docker ç½‘ç»œ docker run --rm -ti \\ --network=nebula-docker-compose_nebula-net \\ -v /home/wei.gu/chia/nebula-chia.yaml:/root/nebula-chia.yaml \\ -v /home/wei.gu/chia:/root \\ vesoft/nebula-importer:v2 \\ --config /root/nebula-chia.yaml è¿™é‡Œæˆ‘å±•ç¤ºä¸€ä¸ªå¯¼å…¥çš„ç»“æœç¤ºä¾‹ï¼Œæˆ‘åœ¨å•æœºéƒ¨ç½²çš„ Nebula Graph é‡Œå¯¼å…¥äº†æˆ‘ä¸€ä¸¤å‘¨ä¹‹å‰å–çš„å…¨é‡ Chia Network æ•°æ®çš„ç»“æœã€‚ ... 2021/05/19 09:55:09 [INFO] reader.go:180: Total lines of file(/root/coin_record.csv) is: 547557, error lines: 0 2021/05/19 09:55:09 [INFO] statsmgr.go:61: Done(/root/coin_record.csv): Time(4385.88s), Finished(4512927), Failed(0), Latency AVG(1305us), Batches Req AVG(2015us), Rows AVG(1028.42/s) 2021/05/19 09:55:10 --- END OF NEBULA IMPORTER --- ","date":"2021-05-26","objectID":"/nebula-chia/:3:1","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#nebula-graph-å¯¼å…¥-chia-æ•°æ®åˆ°å›¾æ•°æ®åº“"},{"categories":["Nebula Graph"],"content":" 3.1 Nebula Graph å¯¼å…¥ Chia æ•°æ®åˆ°å›¾æ•°æ®åº“æˆ‘ä»¬åˆ†ä¸¤æ­¥èµ°ï¼Œç¬¬ä¸€æ­¥è¿™æŠŠ Chia Network æ•°æ®è½¬æ¢æˆ CSV æ–‡ä»¶ï¼Œç¬¬äºŒæ­¥ä½¿ç”¨ Nebula çš„ Nebula-Importer æŠŠæ•°æ®å¯¼å…¥ Nebula Graphã€‚ 3.1.1 æ•°æ®è½¬æ¢è¿™éƒ¨åˆ†çš„ä»£ç æˆ‘å¼€æºåœ¨è¿™é‡Œäº†: https://github.com/wey-gu/nebula-chia ä½¿ç”¨å®ƒåªéœ€è¦åœ¨ Chia Network çš„ python venv ä¸‹å®‰è£…å®ƒ: python3 -m pip install nebula-chia ç„¶åè°ƒç”¨ ChaiBatchConvertor å°±å¯ä»¥åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ª CSV æ–‡ä»¶ã€‚ è¿™é‡Œè¾¹æœ‰ä¸€äº›å¯ä»¥é…ç½®çš„å‚æ•°ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä»£ç  nebulachia/convertor.py from nebulachia.convertor import ChiaBatchConvertor c = ChaiBatchConvertor( block_record_limit=0, coin_record_limit=0, write_batch_size=10000) c.convert_block_record() c.convert_coin_record() ç”Ÿæˆçš„æ–‡ä»¶ï¼š $ ls -lth -rw-r--r-- 1 weyl staff 173M May 19 13:01 coin_record.csv -rw-r--r-- 1 weyl staff 77M May 19 12:59 block_record.csv è¿™é‡Œè¾¹å­—æ®µçš„å«ä¹‰å’Œç±»å‹ï¼Œå¯ä»¥å‚è€ƒä»£ç ä¸­ block_record_row å’Œ coin_record_row çš„ __doc__ In [466]: print(c.coin_record_row.__doc__) Parse row and return a CSV block coin row list. CREATE TABLE coin_record( coin_name text PRIMARY KEY, confirmed_index bigint, spent_index bigint, spent int, coinbase int, puzzle_hash text, coin_parent text, amount blob, timestamp bigint) Coin Record CSV Head: 0 1(int) 2(int) 3(bool) coin_name|confirmed_index|spent_index|spent| 4(bool) 5 6 7(int) coinbase|puzzle_hash|coin_parent|amount| 8(timestamp) timestamp| 9 10 confirmed_hash|spent_hash In [467]: print(c.block_record_row.__doc__) Parse row and return a CSV block record row list. CREATE TABLE block_records( header_hash text PRIMARY KEY, prev_hash text, height bigint, block blob, sub_epoch_summary blob, is_peak tinyint, is_block tinyint) Block Record CSV Head: 0 1 2(int) 3(bool) 4(bool) header_hash|prev_hash|height|is_peak|is_block| 5(int) deficit| 6 challenge_block_info_hash| 7 farmer_puzzle_hash| 8(int) fees| 9 prev_transaction_block_hash| 10 prev_transaction_block_height| 11 12(int) required_iters|signage_point_index| 13(timestamp) timestamp 3.1.2 æ•°æ®å¯¼å…¥æœ‰äº† CSV æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© Nebula-Importer å¯¼å…¥æ•°æ®åˆ°å›¾æ•°æ®åº“ä¸­ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å†™å¥½äº† nebula-importer çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ¶µäº†å¦‚ä¸‹ä¿¡æ¯: åœ¨ Nebula Graph ä¸­åˆ›å»ºéœ€è¦çš„æ•°æ®æ¨¡å‹ Schemaï¼Œè¿™å’Œæˆ‘ä»¬å‰è¾¹åšçš„å›¾æ˜ å°„çš„ä¿¡æ¯æ˜¯ç­‰ä»·çš„ æè¿° CSV æ–‡ä»¶ä¹‹ä¸­çš„ Column çš„æ•°æ®åˆ°å›¾æ¨¡å‹ï¼ˆç‚¹ï¼Œè¾¹ï¼Œç‚¹æˆ–è¾¹çš„å±æ€§ï¼‰æ˜ å°„å…³ç³» # è¿™é‡Œï¼Œæˆ‘çš„ csv æ–‡ä»¶å’Œ é…ç½®æ–‡ä»¶éƒ½æ”¾åœ¨ /home/wei.gu/chia ä¹‹ä¸‹ # æˆ‘ä½¿ç”¨ docker-compose é»˜è®¤é…ç½®éƒ¨ç½²çš„ Nebula Graph, # å®ƒåˆ›å»ºäº†å« nebula-docker-compose_nebula-net çš„ docker ç½‘ç»œ docker run --rm -ti \\ --network=nebula-docker-compose_nebula-net \\ -v /home/wei.gu/chia/nebula-chia.yaml:/root/nebula-chia.yaml \\ -v /home/wei.gu/chia:/root \\ vesoft/nebula-importer:v2 \\ --config /root/nebula-chia.yaml è¿™é‡Œæˆ‘å±•ç¤ºä¸€ä¸ªå¯¼å…¥çš„ç»“æœç¤ºä¾‹ï¼Œæˆ‘åœ¨å•æœºéƒ¨ç½²çš„ Nebula Graph é‡Œå¯¼å…¥äº†æˆ‘ä¸€ä¸¤å‘¨ä¹‹å‰å–çš„å…¨é‡ Chia Network æ•°æ®çš„ç»“æœã€‚ ... 2021/05/19 09:55:09 [INFO] reader.go:180: Total lines of file(/root/coin_record.csv) is: 547557, error lines: 0 2021/05/19 09:55:09 [INFO] statsmgr.go:61: Done(/root/coin_record.csv): Time(4385.88s), Finished(4512927), Failed(0), Latency AVG(1305us), Batches Req AVG(2015us), Rows AVG(1028.42/s) 2021/05/19 09:55:10 --- END OF NEBULA IMPORTER --- ","date":"2021-05-26","objectID":"/nebula-chia/:3:1","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#æ•°æ®è½¬æ¢"},{"categories":["Nebula Graph"],"content":" 3.1 Nebula Graph å¯¼å…¥ Chia æ•°æ®åˆ°å›¾æ•°æ®åº“æˆ‘ä»¬åˆ†ä¸¤æ­¥èµ°ï¼Œç¬¬ä¸€æ­¥è¿™æŠŠ Chia Network æ•°æ®è½¬æ¢æˆ CSV æ–‡ä»¶ï¼Œç¬¬äºŒæ­¥ä½¿ç”¨ Nebula çš„ Nebula-Importer æŠŠæ•°æ®å¯¼å…¥ Nebula Graphã€‚ 3.1.1 æ•°æ®è½¬æ¢è¿™éƒ¨åˆ†çš„ä»£ç æˆ‘å¼€æºåœ¨è¿™é‡Œäº†: https://github.com/wey-gu/nebula-chia ä½¿ç”¨å®ƒåªéœ€è¦åœ¨ Chia Network çš„ python venv ä¸‹å®‰è£…å®ƒ: python3 -m pip install nebula-chia ç„¶åè°ƒç”¨ ChaiBatchConvertor å°±å¯ä»¥åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ª CSV æ–‡ä»¶ã€‚ è¿™é‡Œè¾¹æœ‰ä¸€äº›å¯ä»¥é…ç½®çš„å‚æ•°ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä»£ç  nebulachia/convertor.py from nebulachia.convertor import ChiaBatchConvertor c = ChaiBatchConvertor( block_record_limit=0, coin_record_limit=0, write_batch_size=10000) c.convert_block_record() c.convert_coin_record() ç”Ÿæˆçš„æ–‡ä»¶ï¼š $ ls -lth -rw-r--r-- 1 weyl staff 173M May 19 13:01 coin_record.csv -rw-r--r-- 1 weyl staff 77M May 19 12:59 block_record.csv è¿™é‡Œè¾¹å­—æ®µçš„å«ä¹‰å’Œç±»å‹ï¼Œå¯ä»¥å‚è€ƒä»£ç ä¸­ block_record_row å’Œ coin_record_row çš„ __doc__ In [466]: print(c.coin_record_row.__doc__) Parse row and return a CSV block coin row list. CREATE TABLE coin_record( coin_name text PRIMARY KEY, confirmed_index bigint, spent_index bigint, spent int, coinbase int, puzzle_hash text, coin_parent text, amount blob, timestamp bigint) Coin Record CSV Head: 0 1(int) 2(int) 3(bool) coin_name|confirmed_index|spent_index|spent| 4(bool) 5 6 7(int) coinbase|puzzle_hash|coin_parent|amount| 8(timestamp) timestamp| 9 10 confirmed_hash|spent_hash In [467]: print(c.block_record_row.__doc__) Parse row and return a CSV block record row list. CREATE TABLE block_records( header_hash text PRIMARY KEY, prev_hash text, height bigint, block blob, sub_epoch_summary blob, is_peak tinyint, is_block tinyint) Block Record CSV Head: 0 1 2(int) 3(bool) 4(bool) header_hash|prev_hash|height|is_peak|is_block| 5(int) deficit| 6 challenge_block_info_hash| 7 farmer_puzzle_hash| 8(int) fees| 9 prev_transaction_block_hash| 10 prev_transaction_block_height| 11 12(int) required_iters|signage_point_index| 13(timestamp) timestamp 3.1.2 æ•°æ®å¯¼å…¥æœ‰äº† CSV æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© Nebula-Importer å¯¼å…¥æ•°æ®åˆ°å›¾æ•°æ®åº“ä¸­ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å†™å¥½äº† nebula-importer çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ¶µäº†å¦‚ä¸‹ä¿¡æ¯: åœ¨ Nebula Graph ä¸­åˆ›å»ºéœ€è¦çš„æ•°æ®æ¨¡å‹ Schemaï¼Œè¿™å’Œæˆ‘ä»¬å‰è¾¹åšçš„å›¾æ˜ å°„çš„ä¿¡æ¯æ˜¯ç­‰ä»·çš„ æè¿° CSV æ–‡ä»¶ä¹‹ä¸­çš„ Column çš„æ•°æ®åˆ°å›¾æ¨¡å‹ï¼ˆç‚¹ï¼Œè¾¹ï¼Œç‚¹æˆ–è¾¹çš„å±æ€§ï¼‰æ˜ å°„å…³ç³» # è¿™é‡Œï¼Œæˆ‘çš„ csv æ–‡ä»¶å’Œ é…ç½®æ–‡ä»¶éƒ½æ”¾åœ¨ /home/wei.gu/chia ä¹‹ä¸‹ # æˆ‘ä½¿ç”¨ docker-compose é»˜è®¤é…ç½®éƒ¨ç½²çš„ Nebula Graph, # å®ƒåˆ›å»ºäº†å« nebula-docker-compose_nebula-net çš„ docker ç½‘ç»œ docker run --rm -ti \\ --network=nebula-docker-compose_nebula-net \\ -v /home/wei.gu/chia/nebula-chia.yaml:/root/nebula-chia.yaml \\ -v /home/wei.gu/chia:/root \\ vesoft/nebula-importer:v2 \\ --config /root/nebula-chia.yaml è¿™é‡Œæˆ‘å±•ç¤ºä¸€ä¸ªå¯¼å…¥çš„ç»“æœç¤ºä¾‹ï¼Œæˆ‘åœ¨å•æœºéƒ¨ç½²çš„ Nebula Graph é‡Œå¯¼å…¥äº†æˆ‘ä¸€ä¸¤å‘¨ä¹‹å‰å–çš„å…¨é‡ Chia Network æ•°æ®çš„ç»“æœã€‚ ... 2021/05/19 09:55:09 [INFO] reader.go:180: Total lines of file(/root/coin_record.csv) is: 547557, error lines: 0 2021/05/19 09:55:09 [INFO] statsmgr.go:61: Done(/root/coin_record.csv): Time(4385.88s), Finished(4512927), Failed(0), Latency AVG(1305us), Batches Req AVG(2015us), Rows AVG(1028.42/s) 2021/05/19 09:55:10 --- END OF NEBULA IMPORTER --- ","date":"2021-05-26","objectID":"/nebula-chia/:3:1","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#æ•°æ®å¯¼å…¥"},{"categories":["Nebula Graph"],"content":" 3.2 æ¢ç´¢ Chia çš„å›¾æ•°æ® 3.2.1 ç”¨å›¾æ•°æ®åº“çš„ Querieså¯¼å…¥ Chia é“¾çš„ç½‘ç»œåˆ° Nebula Graph ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é‡Œè¾¹å¿«é€ŸæŸ¥è¯¢æ•°æ®ä¹‹é—´çš„å…³è”ã€‚ æ¯”å¦‚è¿™ä¸ªæŸ¥è¯¢è¡¨ç¤ºä»åŒºå— 524aa2013781ff4cd9d2b5dc... æŸ¥èµ·ï¼Œç»è¿‡ä¸‰ç§è¾¹ farmer_puzzle, spends, confirms åŒå‘éå†çš„ç»“æœã€‚ GO 5 STEPS FROM \\ \"524aa2013781ff4cd9d2b5dce40647b670d722e2de25bd2e2b79970a8ec435ee\" \\ OVER farmer_puzzle,spends,confirms BIDIRECT ... Got 419437 rows (time spent 735120/1170946 us) Wed, 19 May 2021 10:11:28 UTC å†æ¯”å¦‚ï¼Œè®¡ç®—ä¸€ä¸ª Puzzle åœ°å€ä¸Šçš„ä½™é¢ï¼ˆæ‰€æœ‰ coin çš„æ€»ä»·å€¼ï¼‰æ¯”å¦‚è¿™ä¸ªpuzzle bbe39134ccc32c08fdeff... GO 1 STEP FROM \"bbe39134ccc32c08fdeff4d2c19d1d1f4f7e48cdaf79d37397bc3136ce9b3cb7\" \\ OVER belongs_to REVERSELY \\ YIELD CASE $$.coin.is_spent \\ WHEN true THEN $$.coin.amount \\ WHEN false THEN -$$.coin.amount \\ END AS Amount | YIELD sum($-.Amount) 3.2.2 ç”¨ Nebula Studio å¯è§†åŒ–æ¢ç´¢Nebula Graph ä¸ºæˆ‘ä»¬æä¾›äº†å›¾å½¢åŒ–ç•Œé¢ï¼Œæœ‰äº†å®ƒï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ›´ç¬¦åˆäººè„‘çš„æ–¹å¼åœ°æŸ¥çœ‹ Chia Network ä¸­çš„æ•°æ®ã€‚ æ¯”å¦‚ï¼Œæˆ‘ä»¬è¿˜æ˜¯å›åˆ°ä¸Šè¾¹çš„é‚£ä¸ªåŒºå—ï¼Œä»è¿™é‡ŒæŸ¥è¯¢ã€‚ æˆ‘ä»¬å°±è·å¾—äº†è¿™ä¸ª block ç±»å‹çš„ä¸€ä¸ªç‚¹/ vertexã€‚æˆ‘ä»¬å¯ä»¥ä»ä»–å¼€å§‹è¿›ä¸€æ­¥æ¢ç´¢ï¼Œå…ˆé¼ æ ‡å•å‡»è¿™ä¸ªç‚¹ï¼Œåœ¨æ‹“å±•æ¡ä»¶é‡ŒæŠŠæ–¹å‘é€‰æ‹©åŒå‘ï¼Œé»˜è®¤çš„è¾¹ç±»å‹æ˜¯æ‰€æœ‰çš„è¾¹ç±»å‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠæ‰€æœ‰ æ­¥æ•°å†…ç›¸å…³è”çš„æ•°æ®ä¸€ä¸‹å­å…¨éƒ½æ‰¾å‡ºæ¥ã€‚ é€‰æ‹©å¥½æ‹“å±•æ¡ä»¶ä¹‹åï¼Œç‚¹å‡»æ‹“å±•å°±å¯ä»¥ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©äº†æ­¥æ•°ä¸º 1ï¼Œç‚¹å‡»æ‹“å±•ï¼ˆæˆ–è€…åŒå‡»è¦æ‹“å±•çš„ç‚¹ï¼‰ï¼Œä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€ŸåŒå‡»å…¶ä»–çš„ç‚¹ç»§ç»­æ‹“å±•ï¼Œè¿™æ˜¯æˆ‘é¼ æ ‡ç‚¹äº†å‡ æ¬¡ä¹‹åçœ‹åˆ°çš„æ ·å­ï¼š æˆ‘ä»¬æ¥ä¸‹æ¥å†è¯•è¯•æ‹“å±•çš„æ­¥æ•°ä¸º 2ï¼Œç‚¹å‡»æ‹“å±•ï¼ˆæˆ–è€…åŒå‡»è¦æ‹“å±•çš„ç‚¹ï¼‰ï¼Œçœ‹èµ·æ¥æ‰¾åˆ°äº†æœ‰æ„æ€çš„ä¿¡æ¯ã€‚ æˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªæœ‰å¾ˆå¤šè¾¹çš„é»‘è‰²çš„ç‚¹ã€‚ é€šè¿‡æŸ¥çœ‹è¿™ä¸ªç‚¹å’Œæˆ‘ä»¬å¼€å§‹æŸ¥çœ‹çš„ block ä¹‹é—´çš„è¾¹ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªç‚¹æ­£æ˜¯ farm è¿™ä¸ª block çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€ä¸‹è¾¹æœ‰éå¸¸å¤šçš„ coinã€‚ è¿™åªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œæœ‰äº†è¿™ä¸ªå¯¼å…¥åˆ° Nebula Graph å›¾æ•°æ®çš„åŸºç¡€ï¼Œæˆ‘ä»¬å¯ä»¥åšå¾ˆå¤šæœ‰æ„æ€çš„åˆ†æå’Œæ´å¯Ÿï¼Œå¤§å®¶å¯ä»¥è‡ªå·±è¯•è¯•çœ‹ï¼Œå¾—åˆ°æ›´æœ‰æ„æ€çš„ç»“æœåˆ†äº«ç»™å…¶ä»–åŒå­¦ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:3:2","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#æ¢ç´¢-chia-çš„å›¾æ•°æ®"},{"categories":["Nebula Graph"],"content":" 3.2 æ¢ç´¢ Chia çš„å›¾æ•°æ® 3.2.1 ç”¨å›¾æ•°æ®åº“çš„ Querieså¯¼å…¥ Chia é“¾çš„ç½‘ç»œåˆ° Nebula Graph ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é‡Œè¾¹å¿«é€ŸæŸ¥è¯¢æ•°æ®ä¹‹é—´çš„å…³è”ã€‚ æ¯”å¦‚è¿™ä¸ªæŸ¥è¯¢è¡¨ç¤ºä»åŒºå— 524aa2013781ff4cd9d2b5dc... æŸ¥èµ·ï¼Œç»è¿‡ä¸‰ç§è¾¹ farmer_puzzle, spends, confirms åŒå‘éå†çš„ç»“æœã€‚ GO 5 STEPS FROM \\ \"524aa2013781ff4cd9d2b5dce40647b670d722e2de25bd2e2b79970a8ec435ee\" \\ OVER farmer_puzzle,spends,confirms BIDIRECT ... Got 419437 rows (time spent 735120/1170946 us) Wed, 19 May 2021 10:11:28 UTC å†æ¯”å¦‚ï¼Œè®¡ç®—ä¸€ä¸ª Puzzle åœ°å€ä¸Šçš„ä½™é¢ï¼ˆæ‰€æœ‰ coin çš„æ€»ä»·å€¼ï¼‰æ¯”å¦‚è¿™ä¸ªpuzzle bbe39134ccc32c08fdeff... GO 1 STEP FROM \"bbe39134ccc32c08fdeff4d2c19d1d1f4f7e48cdaf79d37397bc3136ce9b3cb7\" \\ OVER belongs_to REVERSELY \\ YIELD CASE $$.coin.is_spent \\ WHEN true THEN $$.coin.amount \\ WHEN false THEN -$$.coin.amount \\ END AS Amount | YIELD sum($-.Amount) 3.2.2 ç”¨ Nebula Studio å¯è§†åŒ–æ¢ç´¢Nebula Graph ä¸ºæˆ‘ä»¬æä¾›äº†å›¾å½¢åŒ–ç•Œé¢ï¼Œæœ‰äº†å®ƒï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ›´ç¬¦åˆäººè„‘çš„æ–¹å¼åœ°æŸ¥çœ‹ Chia Network ä¸­çš„æ•°æ®ã€‚ æ¯”å¦‚ï¼Œæˆ‘ä»¬è¿˜æ˜¯å›åˆ°ä¸Šè¾¹çš„é‚£ä¸ªåŒºå—ï¼Œä»è¿™é‡ŒæŸ¥è¯¢ã€‚ æˆ‘ä»¬å°±è·å¾—äº†è¿™ä¸ª block ç±»å‹çš„ä¸€ä¸ªç‚¹/ vertexã€‚æˆ‘ä»¬å¯ä»¥ä»ä»–å¼€å§‹è¿›ä¸€æ­¥æ¢ç´¢ï¼Œå…ˆé¼ æ ‡å•å‡»è¿™ä¸ªç‚¹ï¼Œåœ¨æ‹“å±•æ¡ä»¶é‡ŒæŠŠæ–¹å‘é€‰æ‹©åŒå‘ï¼Œé»˜è®¤çš„è¾¹ç±»å‹æ˜¯æ‰€æœ‰çš„è¾¹ç±»å‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠæ‰€æœ‰ æ­¥æ•°å†…ç›¸å…³è”çš„æ•°æ®ä¸€ä¸‹å­å…¨éƒ½æ‰¾å‡ºæ¥ã€‚ é€‰æ‹©å¥½æ‹“å±•æ¡ä»¶ä¹‹åï¼Œç‚¹å‡»æ‹“å±•å°±å¯ä»¥ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©äº†æ­¥æ•°ä¸º 1ï¼Œç‚¹å‡»æ‹“å±•ï¼ˆæˆ–è€…åŒå‡»è¦æ‹“å±•çš„ç‚¹ï¼‰ï¼Œä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€ŸåŒå‡»å…¶ä»–çš„ç‚¹ç»§ç»­æ‹“å±•ï¼Œè¿™æ˜¯æˆ‘é¼ æ ‡ç‚¹äº†å‡ æ¬¡ä¹‹åçœ‹åˆ°çš„æ ·å­ï¼š æˆ‘ä»¬æ¥ä¸‹æ¥å†è¯•è¯•æ‹“å±•çš„æ­¥æ•°ä¸º 2ï¼Œç‚¹å‡»æ‹“å±•ï¼ˆæˆ–è€…åŒå‡»è¦æ‹“å±•çš„ç‚¹ï¼‰ï¼Œçœ‹èµ·æ¥æ‰¾åˆ°äº†æœ‰æ„æ€çš„ä¿¡æ¯ã€‚ æˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªæœ‰å¾ˆå¤šè¾¹çš„é»‘è‰²çš„ç‚¹ã€‚ é€šè¿‡æŸ¥çœ‹è¿™ä¸ªç‚¹å’Œæˆ‘ä»¬å¼€å§‹æŸ¥çœ‹çš„ block ä¹‹é—´çš„è¾¹ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªç‚¹æ­£æ˜¯ farm è¿™ä¸ª block çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€ä¸‹è¾¹æœ‰éå¸¸å¤šçš„ coinã€‚ è¿™åªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œæœ‰äº†è¿™ä¸ªå¯¼å…¥åˆ° Nebula Graph å›¾æ•°æ®çš„åŸºç¡€ï¼Œæˆ‘ä»¬å¯ä»¥åšå¾ˆå¤šæœ‰æ„æ€çš„åˆ†æå’Œæ´å¯Ÿï¼Œå¤§å®¶å¯ä»¥è‡ªå·±è¯•è¯•çœ‹ï¼Œå¾—åˆ°æ›´æœ‰æ„æ€çš„ç»“æœåˆ†äº«ç»™å…¶ä»–åŒå­¦ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:3:2","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#ç”¨å›¾æ•°æ®åº“çš„-queries"},{"categories":["Nebula Graph"],"content":" 3.2 æ¢ç´¢ Chia çš„å›¾æ•°æ® 3.2.1 ç”¨å›¾æ•°æ®åº“çš„ Querieså¯¼å…¥ Chia é“¾çš„ç½‘ç»œåˆ° Nebula Graph ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é‡Œè¾¹å¿«é€ŸæŸ¥è¯¢æ•°æ®ä¹‹é—´çš„å…³è”ã€‚ æ¯”å¦‚è¿™ä¸ªæŸ¥è¯¢è¡¨ç¤ºä»åŒºå— 524aa2013781ff4cd9d2b5dc... æŸ¥èµ·ï¼Œç»è¿‡ä¸‰ç§è¾¹ farmer_puzzle, spends, confirms åŒå‘éå†çš„ç»“æœã€‚ GO 5 STEPS FROM \\ \"524aa2013781ff4cd9d2b5dce40647b670d722e2de25bd2e2b79970a8ec435ee\" \\ OVER farmer_puzzle,spends,confirms BIDIRECT ... Got 419437 rows (time spent 735120/1170946 us) Wed, 19 May 2021 10:11:28 UTC å†æ¯”å¦‚ï¼Œè®¡ç®—ä¸€ä¸ª Puzzle åœ°å€ä¸Šçš„ä½™é¢ï¼ˆæ‰€æœ‰ coin çš„æ€»ä»·å€¼ï¼‰æ¯”å¦‚è¿™ä¸ªpuzzle bbe39134ccc32c08fdeff... GO 1 STEP FROM \"bbe39134ccc32c08fdeff4d2c19d1d1f4f7e48cdaf79d37397bc3136ce9b3cb7\" \\ OVER belongs_to REVERSELY \\ YIELD CASE $$.coin.is_spent \\ WHEN true THEN $$.coin.amount \\ WHEN false THEN -$$.coin.amount \\ END AS Amount | YIELD sum($-.Amount) 3.2.2 ç”¨ Nebula Studio å¯è§†åŒ–æ¢ç´¢Nebula Graph ä¸ºæˆ‘ä»¬æä¾›äº†å›¾å½¢åŒ–ç•Œé¢ï¼Œæœ‰äº†å®ƒï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ›´ç¬¦åˆäººè„‘çš„æ–¹å¼åœ°æŸ¥çœ‹ Chia Network ä¸­çš„æ•°æ®ã€‚ æ¯”å¦‚ï¼Œæˆ‘ä»¬è¿˜æ˜¯å›åˆ°ä¸Šè¾¹çš„é‚£ä¸ªåŒºå—ï¼Œä»è¿™é‡ŒæŸ¥è¯¢ã€‚ æˆ‘ä»¬å°±è·å¾—äº†è¿™ä¸ª block ç±»å‹çš„ä¸€ä¸ªç‚¹/ vertexã€‚æˆ‘ä»¬å¯ä»¥ä»ä»–å¼€å§‹è¿›ä¸€æ­¥æ¢ç´¢ï¼Œå…ˆé¼ æ ‡å•å‡»è¿™ä¸ªç‚¹ï¼Œåœ¨æ‹“å±•æ¡ä»¶é‡ŒæŠŠæ–¹å‘é€‰æ‹©åŒå‘ï¼Œé»˜è®¤çš„è¾¹ç±»å‹æ˜¯æ‰€æœ‰çš„è¾¹ç±»å‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠæ‰€æœ‰ æ­¥æ•°å†…ç›¸å…³è”çš„æ•°æ®ä¸€ä¸‹å­å…¨éƒ½æ‰¾å‡ºæ¥ã€‚ é€‰æ‹©å¥½æ‹“å±•æ¡ä»¶ä¹‹åï¼Œç‚¹å‡»æ‹“å±•å°±å¯ä»¥ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©äº†æ­¥æ•°ä¸º 1ï¼Œç‚¹å‡»æ‹“å±•ï¼ˆæˆ–è€…åŒå‡»è¦æ‹“å±•çš„ç‚¹ï¼‰ï¼Œä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€ŸåŒå‡»å…¶ä»–çš„ç‚¹ç»§ç»­æ‹“å±•ï¼Œè¿™æ˜¯æˆ‘é¼ æ ‡ç‚¹äº†å‡ æ¬¡ä¹‹åçœ‹åˆ°çš„æ ·å­ï¼š æˆ‘ä»¬æ¥ä¸‹æ¥å†è¯•è¯•æ‹“å±•çš„æ­¥æ•°ä¸º 2ï¼Œç‚¹å‡»æ‹“å±•ï¼ˆæˆ–è€…åŒå‡»è¦æ‹“å±•çš„ç‚¹ï¼‰ï¼Œçœ‹èµ·æ¥æ‰¾åˆ°äº†æœ‰æ„æ€çš„ä¿¡æ¯ã€‚ æˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªæœ‰å¾ˆå¤šè¾¹çš„é»‘è‰²çš„ç‚¹ã€‚ é€šè¿‡æŸ¥çœ‹è¿™ä¸ªç‚¹å’Œæˆ‘ä»¬å¼€å§‹æŸ¥çœ‹çš„ block ä¹‹é—´çš„è¾¹ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªç‚¹æ­£æ˜¯ farm è¿™ä¸ª block çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€ä¸‹è¾¹æœ‰éå¸¸å¤šçš„ coinã€‚ è¿™åªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œæœ‰äº†è¿™ä¸ªå¯¼å…¥åˆ° Nebula Graph å›¾æ•°æ®çš„åŸºç¡€ï¼Œæˆ‘ä»¬å¯ä»¥åšå¾ˆå¤šæœ‰æ„æ€çš„åˆ†æå’Œæ´å¯Ÿï¼Œå¤§å®¶å¯ä»¥è‡ªå·±è¯•è¯•çœ‹ï¼Œå¾—åˆ°æ›´æœ‰æ„æ€çš„ç»“æœåˆ†äº«ç»™å…¶ä»–åŒå­¦ã€‚ ","date":"2021-05-26","objectID":"/nebula-chia/:3:2","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#ç”¨-nebula-studio-å¯è§†åŒ–æ¢ç´¢"},{"categories":["Nebula Graph"],"content":" 4 æ€»ç»“è¿™ç¯‡æ–‡ç« é‡Œï¼Œåœ¨æˆ‘ä»¬ç®€å•ä»‹ç»äº† Chia Network ä¹‹åï¼Œæˆ‘ä»¬é¦–æ¬¡çš„å¸¦å¤§å®¶ä¸€èµ·ä»å®‰è£…ä¸€ä¸ª Chia ç»ˆç«¯ï¼Œåˆ°åˆ†æç»ˆç«¯åŒæ­¥åˆ°æœ¬åœ°çš„ Chia å…¨ç½‘æ•°æ®ï¼Œå€ŸåŠ©äº Chia ç»ˆç«¯å¼€æºçš„ Python ä»£ç åº“ï¼Œæˆ‘ä»¬åˆ†æäº†å…¨ç½‘æ•°æ®é‡Œçš„é‡è¦ä¿¡æ¯ã€‚ ä¹‹åï¼Œæˆ‘ä»¬å¼€æºäº†ä¸€ä¸ªå°å·¥å…· Nebula-Chiaï¼Œæœ‰äº†å®ƒï¼Œå°±å¯ä»¥æŠŠ Chia çš„å…¨ç½‘æ•°æ®è½¬æ¢æˆ CSV æ ¼å¼ï¼Œè¿™æ ·ï¼Œå°±å¯ä»¥å€ŸåŠ© nebula-importer æŠŠæ‰€æœ‰çš„æ•°æ®å¯¼å…¥åˆ°ä¸€ä¸ªå…ˆè¿›çš„å›¾æ•°æ®åº“ï¼ˆNebula Graphï¼‰ä¸­ã€‚ Nebula Graph çš„é¡¹ç›®åœ°å€æ˜¯ https://github.com/vesoft-inc/nebula-graph Nebula-Chia æˆ‘ä¹Ÿå¼€æºåœ¨ https://github.com/wey-gu/nebula-chia åœ¨å›¾æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†åšåŸºæœ¬ Query çš„ä¾‹å­å’Œå€ŸåŠ©å›¾æ•°æ®åº“è‡ªå¸¦çš„å¯è§†åŒ–å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ˜“åœ°è·å– Chia å…¨ç½‘æ•°æ®ä¹‹é—´å…³è”å…³ç³»ï¼Œæœ‰äº†è¿™ä¸ªä½œä¸ºåŸºç¡€ï¼Œè¿™äº›æ•°æ®ä¸­æ´å¯Ÿçš„æ½œåŠ›å’Œå¯ä»¥å°è¯•çš„æœ‰æ„æ€äº‹æƒ…å¯ä»¥æ¯”è¾ƒç›´è§‚å’Œé«˜æ•ˆåœ°è¿›ä¸€æ­¥æ¢ç´¢äº†ï¼ æ˜¯ä¸æ˜¯å¾ˆé…·ï¼Ÿ ","date":"2021-05-26","objectID":"/nebula-chia/:4:0","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#æ€»ç»“"},{"categories":["Nebula Graph"],"content":" 5 å¼•ç”¨ https://www.chia.net/faq/ https://chialisp.com/docs/ https://www.chiaexplorer.com/chia-coins https://docs.google.com/document/d/1tmRIb7lgi4QfKkNaxuKOBHRmwbVlGL4f7EsBDr_5xZE https://github.com/sipa/bech32/tree/master/ref/python https://github.com/Chia-Network/chia-blockchain/blob/main/README.md https://www.chia.net/assets/ChiaGreenPaper.pdf https://docs.nebula-graph.com.cn é¢˜å›¾ç‰ˆæƒï¼šIcons8 Team ","date":"2021-05-26","objectID":"/nebula-chia/:5:0","series":null,"tags":["Nebula Graph","Chia Network"],"title":"ç”¨å›¾æ•°æ®åº“å¯è§†åŒ–æ¢ç´¢ Chia Network åŒºå—é“¾æ•°æ®","uri":"/nebula-chia/#å¼•ç”¨"},{"categories":null,"content":" Nebula-Corp-Rel-Graph Nebula-Corp-Rel-Graphï¼ŒåŸºäºå›¾æ•°æ®åº“çš„è‚¡æƒç©¿é€ç³»ç»Ÿ é˜…è¯»å…¨æ–‡ Nebula-Siwi Nebula-Siwiï¼ŒåŸºäºå›¾æ•°æ®åº“çš„æ™ºèƒ½é—®ç­”åŠ©æ‰‹ é˜…è¯»å…¨æ–‡ Nebula-Holdshare Nebula-Holdshareï¼Œå›¾æ•°æ®åº“åº”ç”¨ç¤ºä¾‹ï¼šè‚¡æƒå…³ç³»ç©¿é€ é˜…è¯»å…¨æ–‡ Nebula-KIND Nebula-Kindï¼Œæ— éœ€ä¾èµ–ï¼Œä¸€é”®å®‰è£…å°é²œåŸºäº Nebula Operator çš„ K8s Nebula Graph Clusterã€‚æ³¨ï¼š KIND æ˜¯ä¸€ä¸ª K8s çš„ SIGï¼Œä»£è¡¨ K8s in Dockerã€‚ é˜…è¯»å…¨æ–‡ Nebula-Up Nebula-upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒï¼Œæ”¯æŒ mscOSï¼ŒWindows 10ï¼ŒCentOS å’Œ Ubuntuã€‚ é˜…è¯»å…¨æ–‡ VSCode-nGQL VSCode-nGQLï¼ŒNebula Graph çš„ VS Code æ’ä»¶ï¼Œngql è¯­æ³•é«˜äº®ã€‚ é˜…è¯»å…¨æ–‡ Nebula-Chia Nebula-Chiaï¼Œå°† Chia Network å…¨é“¾å¯¼å…¥ Nebula Graph ä¸­çš„æ¢ç´¢åˆ†äº«å’Œè½¬æ¢å·¥å…·ï¼ˆä¸€å¹¶å¼€æºå‡ºæ¥ï¼‰ã€‚ é˜…è¯»å…¨æ–‡ IPython-nGQL Nebula Graph çš„ Jupyter Notebook å’Œ IPython æ’ä»¶ï¼Œæ–¹ä¾¿åœ¨ Notebook ä¹‹ä¸­åµŒå…¥ nGQL çš„ query å’Œ ç»“æœçš„è°ƒè¯•ã€‚ é˜…è¯»å…¨æ–‡ nebula-insights æœ¬æ–‡ä»‹ç»æˆ‘ä»¬å¦‚ä½•ç”¨å…¬æœ‰äº‘ Serverless æŠ€æœ¯ï¼šGoogle Cloud Schedulerï¼ŒGoogle Cloud Functions å’Œ BigQuery æ­å»ºæ•°æ®ç®¡é“ï¼Œæ”¶é›†æ¢ç´¢å¼€æºç¤¾åŒºæ´å¯Ÿã€‚å¹¶å°†å…¨éƒ¨ä»£ç å¼€æºåœ¨ GitHubã€‚ é˜…è¯»å…¨æ–‡ ","date":"2021-05-26","objectID":"/projects/:0:0","series":null,"tags":null,"title":"ä¸ªäººé¡¹ç›®","uri":"/projects/#"},{"categories":null,"content":" Nebula Operator Explained Nebula Graph K8s Operator ä»‹ç» é˜…è¯»å…¨æ–‡ Nebula Config Explained Nebula Graph é…ç½®è¯¦è§£ é˜…è¯»å…¨æ–‡ Nebula Index Demystified Nebula Graph åŸç”Ÿç´¢å¼•è§£è°œ é˜…è¯»å…¨æ–‡ Nebula Data Import Options Nebula Graph æä¾›äº†å¥½å¤šç§æ•°æ®å¯¼å…¥çš„å·¥å…·ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿ é˜…è¯»å…¨æ–‡ Nebula Deployment Options Nebula Graph æœ‰å¾ˆå¤šç§åˆ†å‘ã€éƒ¨ç½²æ–¹å¼ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©å®ƒä»¬å‘¢ï¼Ÿ é˜…è¯»å…¨æ–‡ Nebula Intro æ–°æ‰‹ç©è½¬ Nebula Graph ç³»åˆ—å¼€ç¯‡ã€‚ é˜…è¯»å…¨æ–‡ ","date":"2021-05-26","objectID":"/sketch-notes/:0:0","series":null,"tags":null,"title":"æ‰‹ç»˜ç¬”è®°","uri":"/sketch-notes/#"},{"categories":["sketches"],"content":"Nebula Graph Core Arch.","date":"2021-05-25","objectID":"/sketches/nebula-core-arch/","series":null,"tags":["Nebula Graph","Core"],"title":"Nebula Core Arch","uri":"/sketches/nebula-core-arch/"},{"categories":["sketches"],"content":" 1 Bilibili ä¸Š ä¸‹ ","date":"2021-05-25","objectID":"/sketches/nebula-core-arch/:1:0","series":null,"tags":["Nebula Graph","Core"],"title":"Nebula Core Arch","uri":"/sketches/nebula-core-arch/#bilibili"},{"categories":["sketches"],"content":" 2 Youtube ä¸Š ä¸‹ ","date":"2021-05-25","objectID":"/sketches/nebula-core-arch/:2:0","series":null,"tags":["Nebula Graph","Core"],"title":"Nebula Core Arch","uri":"/sketches/nebula-core-arch/#youtube"},{"categories":["Nebula Graph"],"content":"VSCode-ngql æ˜¯ Nebula Graph çš„ VS Code ä¹‹ä¸­å¯¹ nGQL è¯­æ³•é«˜äº®çš„æ’ä»¶ã€‚","date":"2021-05-05","objectID":"/vscode-ngql/","series":null,"tags":["Nebula Graph","vscode","ngql"],"title":"VSCode-ngqlï¼ŒNebula Graph çš„ VSCode è¯­æ³•é«˜äº®æ’ä»¶ã€‚","uri":"/vscode-ngql/"},{"categories":["Nebula Graph"],"content":" VSCode-ngql æ˜¯ Nebula Graph çš„ VS Code ä¹‹ä¸­å¯¹ nGQL è¯­æ³•é«˜äº®çš„æ’ä»¶ã€‚ æ‚¨å¯ä»¥ä» è¿™é‡Œ ç›´æ¥ä¸‹è½½å®‰è£…è¯•ç”¨ã€‚ ","date":"2021-05-05","objectID":"/vscode-ngql/:0:0","series":null,"tags":["Nebula Graph","vscode","ngql"],"title":"VSCode-ngqlï¼ŒNebula Graph çš„ VSCode è¯­æ³•é«˜äº®æ’ä»¶ã€‚","uri":"/vscode-ngql/#"},{"categories":["Nebula Graph"],"content":" VS Code nGQL Syntax Highlight ","date":"2021-05-05","objectID":"/vscode-ngql/:0:0","series":null,"tags":["Nebula Graph","vscode","ngql"],"title":"VSCode-ngqlï¼ŒNebula Graph çš„ VSCode è¯­æ³•é«˜äº®æ’ä»¶ã€‚","uri":"/vscode-ngql/#vs-code-ngql-syntax-highlight"},{"categories":["Nebula Graph"],"content":" 1 DownloadSearch ngql from the market or click here. ","date":"2021-05-05","objectID":"/vscode-ngql/:1:0","series":null,"tags":["Nebula Graph","vscode","ngql"],"title":"VSCode-ngqlï¼ŒNebula Graph çš„ VSCode è¯­æ³•é«˜äº®æ’ä»¶ã€‚","uri":"/vscode-ngql/#download"},{"categories":["Nebula Graph"],"content":" 2 Features Highlighting all Keywords, Functions of a given .ngql file ","date":"2021-05-05","objectID":"/vscode-ngql/:2:0","series":null,"tags":["Nebula Graph","vscode","ngql"],"title":"VSCode-ngqlï¼ŒNebula Graph çš„ VSCode è¯­æ³•é«˜äº®æ’ä»¶ã€‚","uri":"/vscode-ngql/#features"},{"categories":["Nebula Graph"],"content":" 3 Release Notes","date":"2021-05-05","objectID":"/vscode-ngql/:3:0","series":null,"tags":["Nebula Graph","vscode","ngql"],"title":"VSCode-ngqlï¼ŒNebula Graph çš„ VSCode è¯­æ³•é«˜äº®æ’ä»¶ã€‚","uri":"/vscode-ngql/#release-notes"},{"categories":["Nebula Graph"],"content":" 3.1 0.0.1Initial release, only .ngql Syntax is supported. ","date":"2021-05-05","objectID":"/vscode-ngql/:3:1","series":null,"tags":["Nebula Graph","vscode","ngql"],"title":"VSCode-ngqlï¼ŒNebula Graph çš„ VSCode è¯­æ³•é«˜äº®æ’ä»¶ã€‚","uri":"/vscode-ngql/#001"},{"categories":["Nebula Graph"],"content":" 3.2 0.0.2Lower supported vscode version till ^1.50.1 ","date":"2021-05-05","objectID":"/vscode-ngql/:3:2","series":null,"tags":["Nebula Graph","vscode","ngql"],"title":"VSCode-ngqlï¼ŒNebula Graph çš„ VSCode è¯­æ³•é«˜äº®æ’ä»¶ã€‚","uri":"/vscode-ngql/#002"},{"categories":["Nebula Graph"],"content":" 4 Reference https://docs.nebula-graph.com.cn/ https://github.com/vesoft-inc/nebula-graph/blob/master/src/parser/scanner.lex ","date":"2021-05-05","objectID":"/vscode-ngql/:4:0","series":null,"tags":["Nebula Graph","vscode","ngql"],"title":"VSCode-ngqlï¼ŒNebula Graph çš„ VSCode è¯­æ³•é«˜äº®æ’ä»¶ã€‚","uri":"/vscode-ngql/#reference"},{"categories":["Big Data","Cloud"],"content":"æœ¬æ–‡ä»‹ç»æˆ‘ä»¬å¦‚ä½•ç”¨å…¬æœ‰äº‘ Serverless æŠ€æœ¯ï¼šGoogle Cloud Schedulerï¼ŒGoogle Cloud Functions å’Œ BigQuery æ­å»ºæ•°æ®ç®¡é“ï¼Œæ”¶é›†æ¢ç´¢å¼€æºç¤¾åŒºæ´å¯Ÿã€‚å¹¶å°†å…¨éƒ¨ä»£ç å¼€æºåœ¨ GitHubã€‚","date":"2021-05-03","objectID":"/nebula-insights/","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/"},{"categories":["Big Data","Cloud"],"content":" è¿™æ˜¯æˆ‘é¦–å‘åœ¨ Datawhale çš„æ–‡ç« ï¼Œä»‹ç»æˆ‘ä»¬å¦‚ä½•ç”¨å…¬æœ‰äº‘ Serverless æŠ€æœ¯ï¼šGoogle Cloud Schedulerï¼ŒGoogle Cloud Functions å’Œ BigQuery æ­å»ºæ•°æ®ç®¡é“ï¼Œæ”¶é›†æ¢ç´¢å¼€æºç¤¾åŒºæ´å¯Ÿã€‚å¹¶å°†å…¨éƒ¨ä»£ç å¼€æºåœ¨ GitHubã€‚ å¼•å­ æˆ‘ä»¬æƒ³è¦æ”¶é›†ä¸€äº›å¸®åŠ© Nebula Graph ç¤¾åŒºè¿è¥çš„ metricsï¼Œå¸Œæœ›èƒ½ä»ä¸åŒæ¥æºçš„æ•°æ®è‡ªåŠ¨åŒ–å‘¨æœŸæ€§æ”¶é›†ã€å¤„ç†ã€å¹¶æ–¹ä¾¿åœ°å±•ç°å‡ºæ¥åšæ•°æ®é©±åŠ¨åˆ†æçš„åŸºç¡€è®¾æ–½ã€‚ Nebula Graph æ˜¯ä¸€ä¸ªç°ä»£çš„å¼€æºåˆ†å¸ƒå¼å›¾æ•°æ®åº“(Graph Database)ï¼Œæ¬¢è¿åŒå­¦ä»¬ä»: å®˜ç½‘: https://nebula-graph.com.cn Bilibili: https://space.bilibili.com/472621355 GitHub:https://github.com/vesoft-inc/nebula-graph äº†è§£æˆ‘ä»¬å“ˆã€‚ ","date":"2021-05-03","objectID":"/nebula-insights/:0:0","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/#"},{"categories":["Big Data","Cloud"],"content":" 1 éœ€æ±‚ æ–¹ä¾¿å¢åŠ æ–°çš„æ•°æ® æ•°æ®æ”¶é›†æ— éœ€äººä¸ºè§¦å‘ï¼ˆè‡ªåŠ¨ã€å‘¨æœŸæ€§ï¼‰ æ¯å¤©æ•°æ®é‡ä¸è¶…è¿‡1000æ¡ æ•°æ®å¯ä»¥ç”Ÿæˆ dashboardï¼Œä¹Ÿå¯ä»¥æ”¯æŒç»Ÿè®¡åˆ†æœŸ query é«˜å¯ç”¨ï¼Œæ•°æ®å®‰å…¨ ä½é¢„ç®—ï¼Œå°½å¯èƒ½ä¸éœ€è¦è¿ç»´äººåŠ› ","date":"2021-05-03","objectID":"/nebula-insights/:1:0","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/#éœ€æ±‚"},{"categories":["Big Data","Cloud"],"content":" 1.1 éœ€æ±‚åˆ†ææˆ‘ä»¬éœ€è¦æ­å»ºä¸€ä¸ªç³»ç»Ÿèƒ½å®ç° ä¸€ä¸ªèƒ½å‘¨æœŸæ€§è§¦å‘è·å–æ•°æ®çš„äº‹ä»¶çš„æœåŠ¡: scheduler ä¸€ä¸ªè§¦å‘ä¹‹åï¼ŒæŠŠæ•°æ® ETL åˆ°æ•°æ®åº“ä¸­çš„æœåŠ¡: ETL worker ä¸€ä¸ªæ•°æ®ä»“åº“ ä¸€ä¸ªèƒ½å¤ŸæŠŠæ•°æ®åº“ä½œä¸ºæºï¼Œå…è®¸ç”¨æˆ· queryï¼Œå±•ç¤ºæ•°æ®çš„ç•Œé¢: Data-UI è¿™ä¸ªéœ€æ±‚çš„ç‰¹ç‚¹æ˜¯è™½ç„¶æ•°æ®é‡å¾ˆå°ã€ä½†æ˜¯è¦æ±‚æœåŠ¡é«˜å¯ç”¨ã€å®‰å…¨ã€‚å› ä¸ºè¿™ç§æƒ…å†µä¸‹è‡ªå»ºæœåŠ¡å™¨è¿˜éœ€è¦ä¿è¯HAå’Œæ•°æ®å®‰å…¨ä¼šä¸€å®šä¼šæ¶ˆè€—æ˜‚è´µè¿ç»´äººåŠ›ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°½é‡é¿å…åœ¨è‡ªå·±ç»´æŠ¤çš„æœåŠ¡å™¨ä¸­æ­å»º scheduler, å’Œæ•°æ®åº“ã€‚ æœ€ç»ˆï¼Œæˆ‘ä»¬é€‰æ‹©äº†å°½é‡ä½¿ç”¨å…¬æœ‰äº‘çš„ aaS çš„æ–¹æ¡ˆ: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ Google Cloud Scheduler â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º GitHub API Server â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Google Cloud Functions â”œâ”€â”€â”€â”¤ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Docker Hub API Server â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Google BigQuery â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º ... â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Aliyun OSS API â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ Google Data Studio â”‚ â”‚ â”Œâ”€â”€â” â”‚ â”‚ â”Œâ”€â”€â” â”‚ â”‚ â”Œâ”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”´â”€â”€â”´â”€â”´â”€â”€â”´â”€â”´â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜ å› ä¸ºæˆ‘ä¸ªäººæ¯”è¾ƒç†Ÿæ‚‰ Google Cloud Platform(GCP)çš„åŸå› ï¼ŒåŠ ä¸ŠGCPåœ¨å¤§æ•°æ®å¤„ç†ä¸Šæ¯”è¾ƒé¢†å…ˆï¼Œå†åŠ ä¸ŠGoogleæä¾›çš„ free tieré¢åº¦éå¸¸å¤§æ–¹ï¼Œä»¥è‡³äºåœ¨æˆ‘ä»¬è¿™ä¸ªæ•°æ®é‡ä¸‹ï¼Œæ‰€æœ‰workloadéƒ½ä¼šæ˜¯å…è´¹çš„ã€‚ è¿™ä¸ªæ–¹æ¡ˆæœ€åé€‰æ‹©äº†å…¨æ ˆ Google Cloudï¼Œç„¶è€Œï¼Œè¿™å®é™…ä¸Šåªæ˜¯ä¸€ä¸ªå‚è€ƒï¼ŒåŒå­¦ä»¬å®Œå…¨å¯ä»¥åœ¨å…¶ä»–å…¬æœ‰äº‘æä¾›å•†é‚£é‡Œæ‰¾åˆ°å¯¹åº”çš„æœåŠ¡ã€‚ è¿™é‡Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹ï¼Œ Google Cloud Scheduleræ˜¯è‡ªè§£é‡Šçš„ï¼Œä¸ç”¨å¤šä»‹ç»äº†ã€‚ è€Œ Google Cloud Functionsæ˜¯GCPçš„æ— æœåŠ¡å™¨(serverless)çš„ Function as a ServiceæœåŠ¡ï¼Œå®ƒçš„å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠæ— çŠ¶æ€çš„ event-driven çš„ workload ä»£ç æ”¾ä¸Šå»ï¼Œå®ƒæ˜¯æŒ‰éœ€ä»˜è´¹ï¼ˆpay as you go)çš„ï¼Œç±»ä¼¼çš„æœåŠ¡è¿˜æœ‰ Google Cloud Runï¼Œåè€…çš„åŒºåˆ«åœ¨äºæˆ‘ä»¬æä¾›çš„æ˜¯ä¸€ä¸ªdocker/containerï¼ˆè¿™ä½¿å¾—èƒ½æ”¯æŒçš„è¿è¡Œç¯å¢ƒå¯ä»¥ä½¿ä»»ä½•èƒ½è·‘åœ¨å®¹å™¨é‡Œçš„ä¸œè¥¿ï¼‰ï¼Œè€Œ Cloud Functionsæ˜¯æŠŠæˆ‘ä»¬çš„ä»£ç æ–‡ä»¶æ”¾ä¸Šå»ã€‚ä»–ä»¬çš„æ•ˆæœæ˜¯ç±»ä¼¼çš„ï¼Œå› ä¸ºæˆ‘å‡†å¤‡ç”¨Pythonæ¥åš ETLçš„ä¸œè¥¿ï¼ŒClouf Functionså·²ç»æ”¯æŒäº†ï¼Œæˆ‘å°±ç›´æ¥é€‰æ‹©å®ƒäº†ã€‚ åœ¨scheduleré‡Œè¾¹ï¼Œæˆ‘å®šä¹‰äº†æ¯ä¸€å¤©å®ƒå‘ä¸€ä¸ª pub/subï¼ˆç±»ä¼¼äºkafkaï¼Œè¿™é‡Œgoogleå¯ä»¥ä¿è¯è‡³å°‘å‘æˆåŠŸä¸€æ¬¡ï¼‰æ¶ˆæ¯ç»™ Cloud Functionsï¼Œç„¶å Cloud Functionsä¼šå»åš ETLçš„å·¥ä½œã€‚ è¿™é‡Œï¼Œå®é™…ä¸Šæˆ‘çš„è®¾è®¡é‡Œè¿™ä¸ªè§¦å‘çš„å‡½æ•°è°ƒä¼šæŠŠæ•°æ®ä»APIé‚£é‡Œè·å–ä¸‹æ¥ï¼Œåœ¨å†…å­˜é‡Œå¤„ç†å¥½ä¹‹åï¼Œå­˜å‚¨åˆ°åœ¨å¯¹è±¡å­˜å‚¨é‡Œä¸º JSON æ–‡ä»¶ï¼Œç„¶åå†è°ƒç”¨ Google BigQuery çš„ APIè®© BigQueryç›´æ¥ä»å¯¹å¯¹è±¡å­˜å‚¨é‡Œæ‹‰å– JSON æ–‡ä»¶ï¼Œå¯¼å…¥è®°å½•åˆ°ç›¸åº”çš„è¡¨ä¹‹ä¸­ã€‚ Google BigQuery ä½œä¸ºGCP ç‰¹åˆ«æœ‰ç«äº‰åŠ›çš„ä¸€ä¸ªäº§å“ï¼Œæ˜¯å®ƒæ•°æ®ä»“åº“ï¼ŒBigQuery å¯ä»¥æ— é™æ‰©å®¹ï¼Œæ”¯æŒæµ·é‡æ•°æ®å¯¼å…¥ï¼Œæ”¯æŒ SQL-like çš„ queryï¼Œè¿˜è‡ªå¸¦MLç®—æ³•ï¼Œé€šè¿‡SQLå°±èƒ½è°ƒç”¨è¿™äº›ç®—æ³•ã€‚å®ƒå¯ä»¥å’Œå¾ˆå¤šGCPä»¥åŠç¬¬ä¸‰æ–¹çš„ç»„ä»¶å¯ä»¥é›†æˆèµ·æ¥ã€‚ Google Data Studio æ˜¯GCPçš„æ•°æ® Insightsäº§å“ï¼Œå¦‚æœå¤§å®¶ç”¨è¿‡ Google Analytics åº”è¯¥å·²ç»ç”¨è¿‡å®ƒäº†ã€‚ ","date":"2021-05-03","objectID":"/nebula-insights/:1:1","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/#éœ€æ±‚åˆ†æ"},{"categories":["Big Data","Cloud"],"content":" 1.2 æ•°æ®çš„è·å–ï¼ŒAPIæˆ‘ä»¬ç¬¬ä¸€é˜¶æ®µæƒ³è¦æ”¶é›†çš„æ•°æ®æ¥æºæ˜¯ GitHub ä¸Šï¼Œç¤¾åŒºé¡¹ç›®çš„ç»Ÿè®¡æ•°æ®ã€Docker Hubä¸Šï¼Œç¤¾åŒºé•œåƒçš„æ‹‰å–è®¡æ•°ï¼Œä¹‹åï¼Œä¼šå¢åŠ æ›´å¤šç»´åº¦çš„æ•°æ®ã€‚ Github API, ref: https://pygithub.readthedocs.io è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨äº†ä¸€ä¸ªGithub APIçš„ä¸€ä¸ª Python å°è£…ï¼Œä¸‹è¾¹æ˜¯åœ¨ IDLE/iPython/Jupyter é‡Œå°è¯•çš„ä¾‹å­ # å®ä¾‹åŒ–ä¸€ä¸ªclient g = Github(login_or_token=token, timeout=60, retry=Retry( total=10, status_forcelist=(500, 502, 504), backoff_factor=0.3)) # é…ç½®å¥½è¦è·å–çš„repoçš„ä¿¡æ¯ org_str = \"vesoft-inc\" org = g.get_organization(org_str) repos = org.get_repos() # è¿™é‡Œreposæ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ–¹ä¾¿çœ‹åˆ°é‡Œè¾¹çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬æŠŠå®ƒ list ä¸€ä¸‹å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„repo: list(repos) [Repository(full_name=\"vesoft-inc/nebula\"), Repository(full_name=\"vesoft-inc/nebula-docs\"), Repository(full_name=\"vesoft-inc/nebula-dev-docker\"), Repository(full_name=\"vesoft-inc/github-statistics\"), Repository(full_name=\"vesoft-inc/nebula-docker-compose\"), Repository(full_name=\"vesoft-inc/nebula-go\"), Repository(full_name=\"vesoft-inc/nebula-java\"), Repository(full_name=\"vesoft-inc/nebula-python\"), Repository(full_name=\"vesoft-inc/nebula-importer\"), Repository(full_name=\"vesoft-inc/nebula-third-party\"), Repository(full_name=\"vesoft-inc/nebula-storage\"), Repository(full_name=\"vesoft-inc/nebula-graph\"), Repository(full_name=\"vesoft-inc/nebula-common\"), Repository(full_name=\"vesoft-inc/nebula-stats-exporter\"), Repository(full_name=\"vesoft-inc/nebula-web-docker\"), Repository(full_name=\"vesoft-inc/nebula-bench\"), Repository(full_name=\"vesoft-inc/nebula-console\"), Repository(full_name=\"vesoft-inc/nebula-docs-cn\"), Repository(full_name=\"vesoft-inc/nebula-chaos\"), Repository(full_name=\"vesoft-inc/nebula-clients\"), Repository(full_name=\"vesoft-inc/nebula-spark-utils\"), Repository(full_name=\"vesoft-inc/nebula-node\"), Repository(full_name=\"vesoft-inc/nebula-rust\"), Repository(full_name=\"vesoft-inc/nebula-cpp\"), Repository(full_name=\"vesoft-inc/nebula-http-gateway\"), Repository(full_name=\"vesoft-inc/nebula-flink-connector\"), Repository(full_name=\"vesoft-inc/nebula-community\"), Repository(full_name=\"vesoft-inc/nebula-br\"), Repository(full_name=\"vesoft-inc/.github\")] # repo0 æ˜¯ vesoft-inc/nebula è¿™ä¸ªrepoï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ get_clones_trafficï¼Œget_views_traffic æ¥è·å–è¿‡å»åå‡ å¤©çš„ cloneï¼Œview ç»Ÿè®¡ In [16]: repo0.get_clones_traffic() Out[16]: {'count': 362, 'uniques': 150, 'clones': [Clones(uniques=5, timestamp=2021-04-06 00:00:00, count=16), Clones(uniques=8, timestamp=2021-04-07 00:00:00, count=23), Clones(uniques=13, timestamp=2021-04-08 00:00:00, count=30), Clones(uniques=33, timestamp=2021-04-09 00:00:00, count=45), Clones(uniques=2, timestamp=2021-04-10 00:00:00, count=13), Clones(uniques=6, timestamp=2021-04-11 00:00:00, count=19), Clones(uniques=15, timestamp=2021-04-12 00:00:00, count=28), Clones(uniques=40, timestamp=2021-04-13 00:00:00, count=54), Clones(uniques=9, timestamp=2021-04-14 00:00:00, count=21), Clones(uniques=10, timestamp=2021-04-15 00:00:00, count=34), Clones(uniques=10, timestamp=2021-04-16 00:00:00, count=23), Clones(uniques=5, timestamp=2021-04-17 00:00:00, count=17), Clones(uniques=2, timestamp=2021-04-18 00:00:00, count=13), Clones(uniques=9, timestamp=2021-04-19 00:00:00, count=23), Clones(uniques=3, timestamp=2021-04-20 00:00:00, count=3)]} In [17]: repo0.get_views_traffic() Out[17]: {'count': 6019, 'uniques': 1134, 'views': [View(uniques=52, timestamp=2021-04-06 00:00:00, count=169), View(uniques=143, timestamp=2021-04-07 00:00:00, count=569), View(uniques=152, timestamp=2021-04-08 00:00:00, count=635), View(uniques=134, timestamp=2021-04-09 00:00:00, count=648), View(uniques=81, timestamp=2021-04-10 00:00:00, count=318), View(uniques=42, timestamp=2021-04-11 00:00:00, count=197), View(uniques=127, timestamp=2021-04-12 00:00:00, count=515), View(uniques=149, timestamp=2021-04-13 00:00:00, count=580), View(uniques=134, timestamp=2021-04-14 00:00:00, count=762), View(uniques=141, timestamp=2021-04-15 00:00:00, count=385), View(uniques=113, timestamp=2021-04-16 00:00:00, count=284), View(uniques=48, timestamp=2021-04-17 00:00:00, count=168), View(uniques=35, timestamp=2021-04-18 00:00:00, count=135), View(uniques=124, timestamp=2021-04-19 00:00:00, co","date":"2021-05-03","objectID":"/nebula-insights/:1:2","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/#æ•°æ®çš„è·å–api"},{"categories":["Big Data","Cloud"],"content":" 2 å®ç°","date":"2021-05-03","objectID":"/nebula-insights/:2:0","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/#å®ç°"},{"categories":["Big Data","Cloud"],"content":" 2.1 è®¡åˆ’ä»»åŠ¡è°ƒåº¦ with Cloud Schedulerå‰è¾¹æåˆ°ï¼ŒScheduler --\u003e Functions ä¸­é—´æ˜¯é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å®ç°çš„å¯é äº‹ä»¶è§¦å‘ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Google Cloud Pub/Subé‡Œåˆ›å»ºä¸€ä¸ªè®¢é˜…æ¶ˆæ¯ï¼Œåè¾¹æˆ‘ä»¬ä¼šæŠŠè¿™ä¸ªè®¢é˜…æ¶ˆæ¯ä» Scheduler å®šæœŸå‘é€ï¼Œå¹¶ä¸”åœ¨ Functionåˆ›å»ºçš„æ—¶å€™å®šä¹‰ä¸ºè§¦å‘æ¡ä»¶ã€‚ $ gcloud pubsub topics create nebula-insights-cron-topic $ gcloud pubsub subscriptions create cron-sub --topic nebula-insights-cron-topic ä»»åŠ¡çš„åˆ›å»ºéå¸¸ç›´æ¥ï¼Œåœ¨ Scheduler Web Console ä¸Šç›´æ¥å›¾å½¢åŒ–æ“ä½œå°±å¯ä»¥äº†ï¼Œè®°å¾—è¦é€‰æ‹©è§¦å‘ Pub/Sub æ¶ˆæ¯ä¸º cron-subï¼Œæ¶ˆæ¯ä¸»é¢˜ä¸º nebula-insights-cron-topic ","date":"2021-05-03","objectID":"/nebula-insights/:2:1","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/#è®¡åˆ’ä»»åŠ¡è°ƒåº¦-with-cloud-scheduler"},{"categories":["Big Data","Cloud"],"content":" 2.2 ETL Worker with Python + Google Functionså½“ Scheduler æ¯å¤©å®šæ—¶å‘é€æ¶ˆæ¯ä¹‹åï¼Œæ¥æ”¶æ–¹å°±æ˜¯æˆ‘ä»¬è¦å®šä¹‰çš„ Google Functionsäº†ï¼Œå®ƒçš„å®šä¹‰å¦‚å›¾ ç¬¬ä¸€æ­¥ï¼Œé€‰æ‹©å®ƒçš„è§¦å‘ç±»å‹ä¸º Pub/Subï¼ŒåŒæ—¶è¦å®šä¹‰æ¶ˆæ¯çš„ä¸»é¢˜å’Œåå­—ã€‚ ç¬¬äºŒæ­¥å°±æ˜¯æŠŠä»£ç æ”¾è¿›å»: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º GitHub API Server â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Google Cloud Functions â—„â”€â”€â”€â–º â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Docker Hub API Server â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Google Cloud Storage â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ ... â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Aliyun OSS API â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ Google BigQuery â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ è¿™éƒ¨åˆ†çš„é€»è¾‘å°±æ˜¯é€šè¿‡å‰è¾¹åˆ†æäº†çš„APIå–å¾—ä¿¡æ¯ï¼Œç„¶åç»„è£…æˆéœ€è¦çš„æ ¼å¼å­˜åˆ° Cloud Storage(å¯¹è±¡å­˜å‚¨ï¼‰ï¼Œç„¶åå†å¯¼å…¥åˆ° BigQueryï¼ˆæ•°ä»“ï¼‰ä¹‹ä¸­ï¼Œå…¨éƒ¨ä»£ç åœ¨GitHubä¸Š: https://github.com/wey-gu/nebula-insights/blob/main/functions/data-fetching-0/main.py å¦å¤–ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªå®˜æ–¹æ•™ç¨‹ https://cloud.google.com/scheduler/docs/tut-pub-sub ","date":"2021-05-03","objectID":"/nebula-insights/:2:2","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/#etl-worker-with-python--google-functions"},{"categories":["Big Data","Cloud"],"content":" 2.3 æ•°ä»“è¡¨ç»“æ„å®šä¹‰æ•°ä»“çš„è¡¨ç»“æ„æ¯”è¾ƒç›´æ¥ï¼Œschemaçš„å›¾è´´åœ¨ä¸‹è¾¹äº†ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒBigQueryæ”¯æŒåµŒå¥—çš„è¡¨ç»“æ„ï¼ˆè€Œä¸åƒä¸€èˆ¬å…³ç³»å‹æ•°æ®åº“é‚£æ ·éœ€è¦æŠŠè¿™æ ·çš„é€»è¾‘ç»“æ„ç”¨è¾…åŠ©è¡¨æ¥è¡¨ç¤ºï¼‰ï¼Œåœ¨æˆ‘ä»¬è¿™ä¸ªåœºæ™¯ä¸‹éå¸¸æ–¹ä¾¿ï¼Œæ¯”å¦‚releaseè¡¨ä¸­çš„ assetsçš„ä¸‰ä¸ªåµŒå¥—å­—æ®µã€‚ æ›´è¯¦ç»†çš„ä¿¡æ¯å¯ä»¥å‚è€ƒGitHubä¸Šçš„ä»‹ç»å’Œä»£ç : https://github.com/wey-gu/nebula-insights#data-etl-bigquery-and-gcs ","date":"2021-05-03","objectID":"/nebula-insights/:2:3","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/#æ•°ä»“è¡¨ç»“æ„å®šä¹‰"},{"categories":["Big Data","Cloud"],"content":" 2.4 æ•°æ®å¯è§†åŒ–åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªåŠ¨åœ¨BigQueryé‡Œå­˜æœ‰æ¯å¤©æ”¶é›†çš„ä¸åŒæ¥æºçš„ç»Ÿè®¡æ•°æ®å•¦ï¼Œæœ‰äº†å®ƒï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© Data Studio æ¥ç”Ÿæˆå„å¼å„æ ·çš„å¯è§†åŒ–è¡¨ç¤ºã€‚ å‚è€ƒ https://cloud.google.com/bigquery/docs/visualize-data-studio ","date":"2021-05-03","objectID":"/nebula-insights/:2:4","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/#æ•°æ®å¯è§†åŒ–"},{"categories":["Big Data","Cloud"],"content":" 3 æ€»ç»“è¿™æ ·ï¼Œæˆ‘ä»¬å®é™…ä¸Šä¸éœ€è¦ä»»ä½•è®¤ä¸ºç»´æŠ¤çš„æˆæœ¬å’ŒæŠ•å…¥ï¼Œå°±æ­å»ºäº†ä¸€æ•´ä¸ªæ•°æ®çš„æµæ°´çº¿ï¼Œå¹¶ä¸”åªéœ€è¦æŒ‰ç…§æ•°æ®ç”¨é‡ä»˜è´¹ï¼Œåœ¨æˆ‘ä»¬çš„æ•°æ®é‡ä¸‹ï¼ŒåŠæ—¶è€ƒè™‘æœªæ¥å¢åŠ æ•°åä¸ªæ–°çš„é‡åº¦çš„æ”¶é›†ï¼Œæˆ‘ä»¬ä¾ç„¶æ²¡æœ‰è¾¾åˆ°éœ€è¦ä»˜è´¹çš„ç”¨é‡ï¼Œæ˜¯ä¸æ˜¯å¾ˆCoolï¼Ÿ å› ä¸ºæ•°æ®åŒæ—¶å­˜åœ¨äºå¯¹è±¡å­˜å‚¨ä¸æ•°ä»“é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿éšæ—¶æŠŠæ•°æ®å¯¼å…¥ä»»æ„å…¶ä»–å¹³å°ä¸Šã€‚ BigQueryè¿˜æœ‰ä¸€äº›éå¸¸å¸¸ç”¨çš„ï¼Œè‡ªå¸¦çš„æœºå™¨å­¦ä¹ çš„åŠŸèƒ½ï¼Œåªéœ€è¦å†™ä¸€ä¸ªSQL-Likeçš„queryå°±èƒ½è§¦å‘ç„¶åè·å¾—é¢„æµ‹ç»“æœï¼Œå¦‚æœæˆ‘ä»¬ç”¨åˆ°è¿™äº›åŠŸèƒ½çš„è¯ä¹Ÿä¼šå›åˆ° datawhale ä¸ºåŒå­¦ä»¬ç»§ç»­åˆ†äº«å“ˆã€‚ ç¬¬ä¸€æ¬¡åšæ•°æ®å·¥ç¨‹æ–¹é¢çš„åˆ†äº«ï¼Œå¦‚æœæœ‰é”™è¯¯çš„åœ°æ–¹æ¬¢è¿å¤§å®¶ä¸åæŒ‡å‡ºå“ˆ~~ è°¢è°¢ï¼ ","date":"2021-05-03","objectID":"/nebula-insights/:3:0","series":null,"tags":["Nebula Graph","serverless","Cloud","FaaS"],"title":"Nebula-Insightsï¼Œæˆ‘ä»¬åŸºäº Serverless æ¶æ„çš„æ•°æ®ç®¡é“æ–¹æ¡ˆä¸ä»£ç åˆ†äº«ã€‚","uri":"/nebula-insights/#æ€»ç»“"},{"categories":["Nebula Graph"],"content":"Nebula-upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬ Nebula BRã€Exchangeã€Algorithmã€Dashboardã€Studio","date":"2021-04-26","objectID":"/nebula-up/","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/"},{"categories":["Nebula Graph"],"content":" Update: the All-in-one mode is introduced! Check here and try it! Nebula-Up is PoC utility to enable developer to bootstrap an nebula-graph cluster with nebula-graph-studio(Web UI) + nebula-graph-console(Command UI) ready out of box in an oneliner run. All required packages will handled with nebula-up as well, including Docker on Linux(Ubuntu/CentOS), Docker Desktop on macOS(including both Intel and M1 chip based), and Docker Desktop Windows. Also, itâ€™s optimized to leverage China Repo Mirrors(docker, brew, gitee, etcâ€¦) in case needed enable a smooth deployment for both Mainland China users and others. macOS and Linux with Shell: curl -fsSL nebula-up.siwei.io/install.sh | bash Note: you could specify the version of Nebula Graph like: curl -fsSL nebula-up.siwei.io/install.sh | bash -s -- v2.6 ","date":"2021-04-26","objectID":"/nebula-up/:0:0","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#"},{"categories":["Nebula Graph"],"content":" 1 All-in-one modeWith all-in-one mode, you could play with many Nebula Tools in one command, too: Supported tools: Nebula Dashboard Nebula Graph Studio Nebula Graph Console Nebula BR(backup \u0026 restore) Nebula Graph Spark utils Nebula Graph Spark Connector/PySpark Nebula Graph Algorithm Nebula Graph Exchange Nebula Graph Importer Nebula Graph Fulltext Search Nebula Bench ","date":"2021-04-26","objectID":"/nebula-up/:1:0","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#all-in-one-mode"},{"categories":["Nebula Graph"],"content":" 1.1 Install all in one # Install Nebula Core with all-in-one mode curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash ","date":"2021-04-26","objectID":"/nebula-up/:1:1","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#install-all-in-one"},{"categories":["Nebula Graph"],"content":" 1.2 Install Nebula Core and One of the coponent: # Install Core with Backup and Restore with MinIO curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 br # Install Core with Spark Connector, Nebula Algorithm, Nebula Exchange curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 spark # Install Core with Dashboard curl -fsSL nebula-up.siwei.io/all-in-one.sh | bash -s -- v3 dashboard ","date":"2021-04-26","objectID":"/nebula-up/:1:2","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#install-nebula-core-and-one-of-the-coponent"},{"categories":["Nebula Graph"],"content":" 1.3 How to play with all-in-one mode: 1.3.1 Console and Basketballplayer Dataset LoadingThen you could call Nebula Console like: # Connect to nebula with console ~/.nebula-up/console.sh # Execute queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 1.3.2 Monitor the whole cluster with Nebula DashboardVisit http://127.0.0.1:7003 with user: root, password: nebula. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the dashboard here: http://nebula-demo.siwei.io:7003 . 1.3.3 Access Nebula Graph StudioVisit http://127.0.0.1:7001 with user: root, password: nebula, host: graphd:9669(for non-all-in-one case, this should be \u003chost-ip\u003e:9669). Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the studio here: http://nebula-demo.siwei.io:7001 . 1.3.4 Query Data with Nebula Spark Connector in PySpark ShellOr play in PySpark like: ~/.nebula-up/nebula-pyspark.sh # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit 2 df.show(n=2) The output may look like: ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 1.3.5 Run Nebula ExchangeOr run an example Nebula Exchange job to import data from CSV file: ~/.nebula-up/nebula-exchange-example.sh You could check the example configuration file in ~/.nebula-up/nebula-up/spark/exchange.conf 1.3.6 Run Nebula Graph Algorithm Reference: https://github.com/wey-gu/nebula-livejournal Load LiveJournal dataset with Nebula Importer: ~/.nebula-up/load-LiveJournal-dataset.sh Run Nebula Algorithm like: ~/.nebula-up/nebula-algo-pagerank-example.sh 1.3.7 Try Backup and Restore with MinIO as Storage # Create a full backup to MinIO(Be sure to run load-basketballplayer-dataset.sh before doing so) ~/.nebula-up/nebula-br-backup-full.sh # Show all backups ~/.nebula-up/nebula-br-show.sh # Restore to a backup named BACKUP_2022_05_08_11_38_08 ~/.nebula-up/nebula-br-restore-full.sh BACKUP_2022_05_08_11_38_08 Note, you could also browser files in MinIO with from http://127.0.0.1:9001 with user: minioadmin, password: minioadmin. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the MinIO site here: http://nebula-demo.siwei.io:9001 . Windows with PowerShell(Working In Progress): iwr nebula-up.siwei.io/install.ps1 -useb | iex TBD: Finished Windows(Docker Desktop instead of the WSL 1\u00262 in initial phase) part, leveraging chocolatey package manager as homebrew was used in macOS Fully optimized for CN users, for now, git/apt/yum repo were not optimised, newly installed docker repo, brew repo were automatically optimised for CN internet access Packaging similar content into homebrew/chocolatey? CI/UT ","date":"2021-04-26","objectID":"/nebula-up/:1:3","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#how-to-play-with-all-in-one-mode"},{"categories":["Nebula Graph"],"content":" 1.3 How to play with all-in-one mode: 1.3.1 Console and Basketballplayer Dataset LoadingThen you could call Nebula Console like: # Connect to nebula with console ~/.nebula-up/console.sh # Execute queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 1.3.2 Monitor the whole cluster with Nebula DashboardVisit http://127.0.0.1:7003 with user: root, password: nebula. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the dashboard here: http://nebula-demo.siwei.io:7003 . 1.3.3 Access Nebula Graph StudioVisit http://127.0.0.1:7001 with user: root, password: nebula, host: graphd:9669(for non-all-in-one case, this should be :9669). Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the studio here: http://nebula-demo.siwei.io:7001 . 1.3.4 Query Data with Nebula Spark Connector in PySpark ShellOr play in PySpark like: ~/.nebula-up/nebula-pyspark.sh # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit 2 df.show(n=2) The output may look like: ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 1.3.5 Run Nebula ExchangeOr run an example Nebula Exchange job to import data from CSV file: ~/.nebula-up/nebula-exchange-example.sh You could check the example configuration file in ~/.nebula-up/nebula-up/spark/exchange.conf 1.3.6 Run Nebula Graph Algorithm Reference: https://github.com/wey-gu/nebula-livejournal Load LiveJournal dataset with Nebula Importer: ~/.nebula-up/load-LiveJournal-dataset.sh Run Nebula Algorithm like: ~/.nebula-up/nebula-algo-pagerank-example.sh 1.3.7 Try Backup and Restore with MinIO as Storage # Create a full backup to MinIO(Be sure to run load-basketballplayer-dataset.sh before doing so) ~/.nebula-up/nebula-br-backup-full.sh # Show all backups ~/.nebula-up/nebula-br-show.sh # Restore to a backup named BACKUP_2022_05_08_11_38_08 ~/.nebula-up/nebula-br-restore-full.sh BACKUP_2022_05_08_11_38_08 Note, you could also browser files in MinIO with from http://127.0.0.1:9001 with user: minioadmin, password: minioadmin. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the MinIO site here: http://nebula-demo.siwei.io:9001 . Windows with PowerShell(Working In Progress): iwr nebula-up.siwei.io/install.ps1 -useb | iex TBD: Finished Windows(Docker Desktop instead of the WSL 1\u00262 in initial phase) part, leveraging chocolatey package manager as homebrew was used in macOS Fully optimized for CN users, for now, git/apt/yum repo were not optimised, newly installed docker repo, brew repo were automatically optimised for CN internet access Packaging similar content into homebrew/chocolatey? CI/UT ","date":"2021-04-26","objectID":"/nebula-up/:1:3","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#console-and-basketballplayer-dataset-loading"},{"categories":["Nebula Graph"],"content":" 1.3 How to play with all-in-one mode: 1.3.1 Console and Basketballplayer Dataset LoadingThen you could call Nebula Console like: # Connect to nebula with console ~/.nebula-up/console.sh # Execute queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 1.3.2 Monitor the whole cluster with Nebula DashboardVisit http://127.0.0.1:7003 with user: root, password: nebula. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the dashboard here: http://nebula-demo.siwei.io:7003 . 1.3.3 Access Nebula Graph StudioVisit http://127.0.0.1:7001 with user: root, password: nebula, host: graphd:9669(for non-all-in-one case, this should be :9669). Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the studio here: http://nebula-demo.siwei.io:7001 . 1.3.4 Query Data with Nebula Spark Connector in PySpark ShellOr play in PySpark like: ~/.nebula-up/nebula-pyspark.sh # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit 2 df.show(n=2) The output may look like: ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 1.3.5 Run Nebula ExchangeOr run an example Nebula Exchange job to import data from CSV file: ~/.nebula-up/nebula-exchange-example.sh You could check the example configuration file in ~/.nebula-up/nebula-up/spark/exchange.conf 1.3.6 Run Nebula Graph Algorithm Reference: https://github.com/wey-gu/nebula-livejournal Load LiveJournal dataset with Nebula Importer: ~/.nebula-up/load-LiveJournal-dataset.sh Run Nebula Algorithm like: ~/.nebula-up/nebula-algo-pagerank-example.sh 1.3.7 Try Backup and Restore with MinIO as Storage # Create a full backup to MinIO(Be sure to run load-basketballplayer-dataset.sh before doing so) ~/.nebula-up/nebula-br-backup-full.sh # Show all backups ~/.nebula-up/nebula-br-show.sh # Restore to a backup named BACKUP_2022_05_08_11_38_08 ~/.nebula-up/nebula-br-restore-full.sh BACKUP_2022_05_08_11_38_08 Note, you could also browser files in MinIO with from http://127.0.0.1:9001 with user: minioadmin, password: minioadmin. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the MinIO site here: http://nebula-demo.siwei.io:9001 . Windows with PowerShell(Working In Progress): iwr nebula-up.siwei.io/install.ps1 -useb | iex TBD: Finished Windows(Docker Desktop instead of the WSL 1\u00262 in initial phase) part, leveraging chocolatey package manager as homebrew was used in macOS Fully optimized for CN users, for now, git/apt/yum repo were not optimised, newly installed docker repo, brew repo were automatically optimised for CN internet access Packaging similar content into homebrew/chocolatey? CI/UT ","date":"2021-04-26","objectID":"/nebula-up/:1:3","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#monitor-the-whole-cluster-with-nebula-dashboard"},{"categories":["Nebula Graph"],"content":" 1.3 How to play with all-in-one mode: 1.3.1 Console and Basketballplayer Dataset LoadingThen you could call Nebula Console like: # Connect to nebula with console ~/.nebula-up/console.sh # Execute queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 1.3.2 Monitor the whole cluster with Nebula DashboardVisit http://127.0.0.1:7003 with user: root, password: nebula. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the dashboard here: http://nebula-demo.siwei.io:7003 . 1.3.3 Access Nebula Graph StudioVisit http://127.0.0.1:7001 with user: root, password: nebula, host: graphd:9669(for non-all-in-one case, this should be :9669). Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the studio here: http://nebula-demo.siwei.io:7001 . 1.3.4 Query Data with Nebula Spark Connector in PySpark ShellOr play in PySpark like: ~/.nebula-up/nebula-pyspark.sh # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit 2 df.show(n=2) The output may look like: ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 1.3.5 Run Nebula ExchangeOr run an example Nebula Exchange job to import data from CSV file: ~/.nebula-up/nebula-exchange-example.sh You could check the example configuration file in ~/.nebula-up/nebula-up/spark/exchange.conf 1.3.6 Run Nebula Graph Algorithm Reference: https://github.com/wey-gu/nebula-livejournal Load LiveJournal dataset with Nebula Importer: ~/.nebula-up/load-LiveJournal-dataset.sh Run Nebula Algorithm like: ~/.nebula-up/nebula-algo-pagerank-example.sh 1.3.7 Try Backup and Restore with MinIO as Storage # Create a full backup to MinIO(Be sure to run load-basketballplayer-dataset.sh before doing so) ~/.nebula-up/nebula-br-backup-full.sh # Show all backups ~/.nebula-up/nebula-br-show.sh # Restore to a backup named BACKUP_2022_05_08_11_38_08 ~/.nebula-up/nebula-br-restore-full.sh BACKUP_2022_05_08_11_38_08 Note, you could also browser files in MinIO with from http://127.0.0.1:9001 with user: minioadmin, password: minioadmin. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the MinIO site here: http://nebula-demo.siwei.io:9001 . Windows with PowerShell(Working In Progress): iwr nebula-up.siwei.io/install.ps1 -useb | iex TBD: Finished Windows(Docker Desktop instead of the WSL 1\u00262 in initial phase) part, leveraging chocolatey package manager as homebrew was used in macOS Fully optimized for CN users, for now, git/apt/yum repo were not optimised, newly installed docker repo, brew repo were automatically optimised for CN internet access Packaging similar content into homebrew/chocolatey? CI/UT ","date":"2021-04-26","objectID":"/nebula-up/:1:3","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#access-nebula-graph-studio"},{"categories":["Nebula Graph"],"content":" 1.3 How to play with all-in-one mode: 1.3.1 Console and Basketballplayer Dataset LoadingThen you could call Nebula Console like: # Connect to nebula with console ~/.nebula-up/console.sh # Execute queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 1.3.2 Monitor the whole cluster with Nebula DashboardVisit http://127.0.0.1:7003 with user: root, password: nebula. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the dashboard here: http://nebula-demo.siwei.io:7003 . 1.3.3 Access Nebula Graph StudioVisit http://127.0.0.1:7001 with user: root, password: nebula, host: graphd:9669(for non-all-in-one case, this should be :9669). Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the studio here: http://nebula-demo.siwei.io:7001 . 1.3.4 Query Data with Nebula Spark Connector in PySpark ShellOr play in PySpark like: ~/.nebula-up/nebula-pyspark.sh # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit 2 df.show(n=2) The output may look like: ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 1.3.5 Run Nebula ExchangeOr run an example Nebula Exchange job to import data from CSV file: ~/.nebula-up/nebula-exchange-example.sh You could check the example configuration file in ~/.nebula-up/nebula-up/spark/exchange.conf 1.3.6 Run Nebula Graph Algorithm Reference: https://github.com/wey-gu/nebula-livejournal Load LiveJournal dataset with Nebula Importer: ~/.nebula-up/load-LiveJournal-dataset.sh Run Nebula Algorithm like: ~/.nebula-up/nebula-algo-pagerank-example.sh 1.3.7 Try Backup and Restore with MinIO as Storage # Create a full backup to MinIO(Be sure to run load-basketballplayer-dataset.sh before doing so) ~/.nebula-up/nebula-br-backup-full.sh # Show all backups ~/.nebula-up/nebula-br-show.sh # Restore to a backup named BACKUP_2022_05_08_11_38_08 ~/.nebula-up/nebula-br-restore-full.sh BACKUP_2022_05_08_11_38_08 Note, you could also browser files in MinIO with from http://127.0.0.1:9001 with user: minioadmin, password: minioadmin. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the MinIO site here: http://nebula-demo.siwei.io:9001 . Windows with PowerShell(Working In Progress): iwr nebula-up.siwei.io/install.ps1 -useb | iex TBD: Finished Windows(Docker Desktop instead of the WSL 1\u00262 in initial phase) part, leveraging chocolatey package manager as homebrew was used in macOS Fully optimized for CN users, for now, git/apt/yum repo were not optimised, newly installed docker repo, brew repo were automatically optimised for CN internet access Packaging similar content into homebrew/chocolatey? CI/UT ","date":"2021-04-26","objectID":"/nebula-up/:1:3","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#query-data-with-nebula-spark-connector-in-pyspark-shell"},{"categories":["Nebula Graph"],"content":" 1.3 How to play with all-in-one mode: 1.3.1 Console and Basketballplayer Dataset LoadingThen you could call Nebula Console like: # Connect to nebula with console ~/.nebula-up/console.sh # Execute queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 1.3.2 Monitor the whole cluster with Nebula DashboardVisit http://127.0.0.1:7003 with user: root, password: nebula. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the dashboard here: http://nebula-demo.siwei.io:7003 . 1.3.3 Access Nebula Graph StudioVisit http://127.0.0.1:7001 with user: root, password: nebula, host: graphd:9669(for non-all-in-one case, this should be :9669). Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the studio here: http://nebula-demo.siwei.io:7001 . 1.3.4 Query Data with Nebula Spark Connector in PySpark ShellOr play in PySpark like: ~/.nebula-up/nebula-pyspark.sh # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit 2 df.show(n=2) The output may look like: ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 1.3.5 Run Nebula ExchangeOr run an example Nebula Exchange job to import data from CSV file: ~/.nebula-up/nebula-exchange-example.sh You could check the example configuration file in ~/.nebula-up/nebula-up/spark/exchange.conf 1.3.6 Run Nebula Graph Algorithm Reference: https://github.com/wey-gu/nebula-livejournal Load LiveJournal dataset with Nebula Importer: ~/.nebula-up/load-LiveJournal-dataset.sh Run Nebula Algorithm like: ~/.nebula-up/nebula-algo-pagerank-example.sh 1.3.7 Try Backup and Restore with MinIO as Storage # Create a full backup to MinIO(Be sure to run load-basketballplayer-dataset.sh before doing so) ~/.nebula-up/nebula-br-backup-full.sh # Show all backups ~/.nebula-up/nebula-br-show.sh # Restore to a backup named BACKUP_2022_05_08_11_38_08 ~/.nebula-up/nebula-br-restore-full.sh BACKUP_2022_05_08_11_38_08 Note, you could also browser files in MinIO with from http://127.0.0.1:9001 with user: minioadmin, password: minioadmin. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the MinIO site here: http://nebula-demo.siwei.io:9001 . Windows with PowerShell(Working In Progress): iwr nebula-up.siwei.io/install.ps1 -useb | iex TBD: Finished Windows(Docker Desktop instead of the WSL 1\u00262 in initial phase) part, leveraging chocolatey package manager as homebrew was used in macOS Fully optimized for CN users, for now, git/apt/yum repo were not optimised, newly installed docker repo, brew repo were automatically optimised for CN internet access Packaging similar content into homebrew/chocolatey? CI/UT ","date":"2021-04-26","objectID":"/nebula-up/:1:3","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#run-nebula-exchange"},{"categories":["Nebula Graph"],"content":" 1.3 How to play with all-in-one mode: 1.3.1 Console and Basketballplayer Dataset LoadingThen you could call Nebula Console like: # Connect to nebula with console ~/.nebula-up/console.sh # Execute queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 1.3.2 Monitor the whole cluster with Nebula DashboardVisit http://127.0.0.1:7003 with user: root, password: nebula. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the dashboard here: http://nebula-demo.siwei.io:7003 . 1.3.3 Access Nebula Graph StudioVisit http://127.0.0.1:7001 with user: root, password: nebula, host: graphd:9669(for non-all-in-one case, this should be :9669). Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the studio here: http://nebula-demo.siwei.io:7001 . 1.3.4 Query Data with Nebula Spark Connector in PySpark ShellOr play in PySpark like: ~/.nebula-up/nebula-pyspark.sh # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit 2 df.show(n=2) The output may look like: ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 1.3.5 Run Nebula ExchangeOr run an example Nebula Exchange job to import data from CSV file: ~/.nebula-up/nebula-exchange-example.sh You could check the example configuration file in ~/.nebula-up/nebula-up/spark/exchange.conf 1.3.6 Run Nebula Graph Algorithm Reference: https://github.com/wey-gu/nebula-livejournal Load LiveJournal dataset with Nebula Importer: ~/.nebula-up/load-LiveJournal-dataset.sh Run Nebula Algorithm like: ~/.nebula-up/nebula-algo-pagerank-example.sh 1.3.7 Try Backup and Restore with MinIO as Storage # Create a full backup to MinIO(Be sure to run load-basketballplayer-dataset.sh before doing so) ~/.nebula-up/nebula-br-backup-full.sh # Show all backups ~/.nebula-up/nebula-br-show.sh # Restore to a backup named BACKUP_2022_05_08_11_38_08 ~/.nebula-up/nebula-br-restore-full.sh BACKUP_2022_05_08_11_38_08 Note, you could also browser files in MinIO with from http://127.0.0.1:9001 with user: minioadmin, password: minioadmin. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the MinIO site here: http://nebula-demo.siwei.io:9001 . Windows with PowerShell(Working In Progress): iwr nebula-up.siwei.io/install.ps1 -useb | iex TBD: Finished Windows(Docker Desktop instead of the WSL 1\u00262 in initial phase) part, leveraging chocolatey package manager as homebrew was used in macOS Fully optimized for CN users, for now, git/apt/yum repo were not optimised, newly installed docker repo, brew repo were automatically optimised for CN internet access Packaging similar content into homebrew/chocolatey? CI/UT ","date":"2021-04-26","objectID":"/nebula-up/:1:3","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#run-nebula-graph-algorithm"},{"categories":["Nebula Graph"],"content":" 1.3 How to play with all-in-one mode: 1.3.1 Console and Basketballplayer Dataset LoadingThen you could call Nebula Console like: # Connect to nebula with console ~/.nebula-up/console.sh # Execute queryies like ~/.nebula-up/console.sh -e \"SHOW HOSTS\" # Load the sample dataset ~/.nebula-up/load-basketballplayer-dataset.sh # Make a Graph Query the sample dataset ~/.nebula-up/console.sh -e 'USE basketballplayer; FIND ALL PATH FROM \"player100\" TO \"team204\" OVER * WHERE follow.degree is EMPTY or follow.degree \u003e=0 YIELD path AS p;' 1.3.2 Monitor the whole cluster with Nebula DashboardVisit http://127.0.0.1:7003 with user: root, password: nebula. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the dashboard here: http://nebula-demo.siwei.io:7003 . 1.3.3 Access Nebula Graph StudioVisit http://127.0.0.1:7001 with user: root, password: nebula, host: graphd:9669(for non-all-in-one case, this should be :9669). Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the studio here: http://nebula-demo.siwei.io:7001 . 1.3.4 Query Data with Nebula Spark Connector in PySpark ShellOr play in PySpark like: ~/.nebula-up/nebula-pyspark.sh # call Nebula Spark Connector Reader df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() # show the dataframe with limit 2 df.show(n=2) The output may look like: ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ '_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 2.4.5 /_/ Using Python version 2.7.16 (default, Jan 14 2020 07:22:06) SparkSession available as 'spark'. \u003e\u003e\u003e df = spark.read.format( ... \"com.vesoft.nebula.connector.NebulaDataSource\").option( ... \"type\", \"vertex\").option( ... \"spaceName\", \"basketballplayer\").option( ... \"label\", \"player\").option( ... \"returnCols\", \"name,age\").option( ... \"metaAddress\", \"metad0:9559\").option( ... \"partitionNumber\", 1).load() \u003e\u003e\u003e df.show(n=2) +---------+--------------+---+ |_vertexId| name|age| +---------+--------------+---+ |player105| Danny Green| 31| |player109|Tiago Splitter| 34| +---------+--------------+---+ only showing top 2 rows 1.3.5 Run Nebula ExchangeOr run an example Nebula Exchange job to import data from CSV file: ~/.nebula-up/nebula-exchange-example.sh You could check the example configuration file in ~/.nebula-up/nebula-up/spark/exchange.conf 1.3.6 Run Nebula Graph Algorithm Reference: https://github.com/wey-gu/nebula-livejournal Load LiveJournal dataset with Nebula Importer: ~/.nebula-up/load-LiveJournal-dataset.sh Run Nebula Algorithm like: ~/.nebula-up/nebula-algo-pagerank-example.sh 1.3.7 Try Backup and Restore with MinIO as Storage # Create a full backup to MinIO(Be sure to run load-basketballplayer-dataset.sh before doing so) ~/.nebula-up/nebula-br-backup-full.sh # Show all backups ~/.nebula-up/nebula-br-show.sh # Restore to a backup named BACKUP_2022_05_08_11_38_08 ~/.nebula-up/nebula-br-restore-full.sh BACKUP_2022_05_08_11_38_08 Note, you could also browser files in MinIO with from http://127.0.0.1:9001 with user: minioadmin, password: minioadmin. Note, thanks to the sponsorship of Microsoft, we have a demo site of Nebula-UP on Azure: you could visit the MinIO site here: http://nebula-demo.siwei.io:9001 . Windows with PowerShell(Working In Progress): iwr nebula-up.siwei.io/install.ps1 -useb | iex TBD: Finished Windows(Docker Desktop instead of the WSL 1\u00262 in initial phase) part, leveraging chocolatey package manager as homebrew was used in macOS Fully optimized for CN users, for now, git/apt/yum repo were not optimised, newly installed docker repo, brew repo were automatically optimised for CN internet access Packaging similar content into homebrew/chocolatey? CI/UT ","date":"2021-04-26","objectID":"/nebula-up/:1:3","series":null,"tags":["Nebula Graph","nebula-up"],"title":"Nebula-Upï¼Œä¸€é”®æ‹‰èµ·ä¸€ä¸ª Nebula æµ‹è¯•ç¯å¢ƒ","uri":"/nebula-up/#try-backup-and-restore-with-minio-as-storage"},{"categories":["Nebula Graph"],"content":"Nebula Graph çš„ Jupyter Notebook å’Œ IPython æ’ä»¶ï¼Œæ–¹ä¾¿åœ¨ Notebook ä¹‹ä¸­åµŒå…¥ nGQL çš„ query å’Œ ç»“æœçš„è°ƒè¯•ã€‚","date":"2021-03-07","objectID":"/ipython-ngql/","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/"},{"categories":["Nebula Graph"],"content":" Nebula Graph çš„ Jupyter Notebook å’Œ IPython æ’ä»¶ï¼Œæ–¹ä¾¿åœ¨ Notebook ä¹‹ä¸­åµŒå…¥ nGQL çš„ query å’Œ ç»“æœçš„è°ƒè¯•ã€‚ ipython-ngql is a python package to extend the ability to connect Nebula Graph from your Jupyter Notebook or iPython. Itâ€™s easier for data scientists to create, debug and share reusable and all-in-one Jupyter Notebooks with Nebula Graph interaction embedded. ipython-ngql is inspired by ipython-sql created by Catherine Devlin ","date":"2021-03-07","objectID":"/ipython-ngql/:0:0","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#"},{"categories":["Nebula Graph"],"content":" 1 Get Started","date":"2021-03-07","objectID":"/ipython-ngql/:1:0","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#get-started"},{"categories":["Nebula Graph"],"content":" 1.1 Installationipython-ngql could be installed either via pip or from this git repo itself. Install via pip pip install ipython-ngql Install inside the repo git clone git@github.com:wey-gu/ipython-ngql.git cd ipython-ngql python setup.py install ","date":"2021-03-07","objectID":"/ipython-ngql/:1:1","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#installation"},{"categories":["Nebula Graph"],"content":" 1.2 Load it in Jupyter Notebook or iPython %load_ext ngql ","date":"2021-03-07","objectID":"/ipython-ngql/:1:2","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#load-it-in-jupyter-notebook-or-ipython"},{"categories":["Nebula Graph"],"content":" 1.3 Connect to Nebula GraphArguments as below are needed to connect a Nebula Graph DB instance: Argument Description --address or -addr IP address of the Nebula Graph Instance --port or -P Port number of the Nebula Graph Instance --user or -u User name --password or -p Password Below is an exmple on connecting to 127.0.0.1:9669 with username: â€œuserâ€ and password: â€œpasswordâ€. %ngql --address 127.0.0.1 --port 9669 --user user --password password ","date":"2021-03-07","objectID":"/ipython-ngql/:1:3","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#connect-to-nebula-graph"},{"categories":["Nebula Graph"],"content":" 1.4 Make QueriesNow two kind of iPtython Magics are supported: Option 1: The one line stype with %ngql: %ngql GO FROM \"Tom\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id; Option 2: The multiple lines stype with %%ngql %%ngql USE pokemon_club; SHOW TAGS; SHOW HOSTS; There will be other options in future, i.e. from a .ngql file. ","date":"2021-03-07","objectID":"/ipython-ngql/:1:4","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#make-queries"},{"categories":["Nebula Graph"],"content":" 1.5 Query String with Variablesipython-ngql supports taking variables from the local namespace, with the help of Jinja2 template framework, itâ€™s supported to have queries like the below example. The actual query string should be GO FROM \"Sue\" OVER owns_pokemon ..., and \"{{ trainer }}\" was renderred as \"Sue\" by consuming the local variable trainer: In [8]: trainer = \"Sue\" In [9]: %%ngql ...: GO FROM \"{{ trainer }}\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: Out[9]: Trainer_Name 0 Jerry 1 Sue 2 Tom 3 Wey ","date":"2021-03-07","objectID":"/ipython-ngql/:1:5","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#query-string-with-variables"},{"categories":["Nebula Graph"],"content":" 1.6 Configure ngql_result_styleBy default, ipython-ngql will use pandas dataframe as output style to enable more human readable output, while itâ€™s supported to use the raw thrift data format comes from the nebula2-python itself. This can be done ad-hoc with below one line: %config IPythonNGQL.ngql_result_style=\"raw\" After above line being executed, the output will be like: ResultSet(ExecutionResponse( error_code=0, latency_in_us=2844, data=DataSet( column_names=[b'Trainer_Name'], rows=[Row( values=[Value( sVal=b'Tom')]), Row( values=[Value( sVal=b'Jerry')]), Row( values=[Value( sVal=b'Sue')]), Row( values=[Value( sVal=b'Tom')]), Row( values=[Value( sVal=b'Wey')])]), space_name=b'pokemon_club')) The result are always stored in variable _ in Jupyter Notebook, thus, to tweak the result, just refer a new var to it like: In [10]: %config IPythonNGQL.ngql_result_style=\"raw\" In [11]: %%ngql USE pokemon_club; ...: GO FROM \"Tom\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id ...: | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: ...: Out[11]: ResultSet(ExecutionResponse( error_code=0, latency_in_us=3270, data=DataSet( column_names=[b'Trainer_Name'], rows=[Row( values=[Value( sVal=b'Tom')]), Row( values=[Value( sVal=b'Jerry')]), Row( values=[Value( sVal=b'Sue')]), Row( values=[Value( sVal=b'Tom')]), Row( values=[Value( sVal=b'Wey')])]), space_name=b'pokemon_club')) In [12]: r = _ In [13]: r.column_values(key='Trainer_Name')[0]._value.value Out[13]: b'Tom' ","date":"2021-03-07","objectID":"/ipython-ngql/:1:6","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#configure-ngql_result_style"},{"categories":["Nebula Graph"],"content":" 1.7 Get HelpDonâ€™t remember anything or even relying on the cheatsheet here, oen takeaway for you: the help! In [7]: %ngql help Supported Configurations: ------------------------ \u003e How to config ngql_result_style in \"raw\", \"pandas\" %config IPythonNGQL.ngql_result_style=\"raw\" %config IPythonNGQL.ngql_result_style=\"pandas\" \u003e How to config ngql_verbose in True, False %config IPythonNGQL.ngql_verbose=True \u003e How to config max_connection_pool_size %config IPythonNGQL.max_connection_pool_size=10 Quick Start: ----------- \u003e Connect to Neubla Graph %ngql --address 127.0.0.1 --port 9669 --user user --password password \u003e Use Space %ngql USE nba \u003e Query %ngql SHOW TAGS; \u003e Multile Queries %%ngql SHOW TAGS; SHOW HOSTS; Reload ngql Magic %reload_ext ngql \u003e Variables in query, we are using Jinja2 here name = \"nba\" %ngql USE \"{{ name }}\" ","date":"2021-03-07","objectID":"/ipython-ngql/:1:7","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#get-help"},{"categories":["Nebula Graph"],"content":" 1.8 Examples 1.8.1 Jupyter NotebookPlease refer here:https://github.com/wey-gu/ipython-ngql/blob/main/examples/get_started.ipynb 1.8.2 iPython venv â¯ ipython In [1]: %load_ext ngql In [2]: %ngql --address 127.0.0.1 --port 9669 --user user --password password Connection Pool Created Out[2]: Name 0 pokemon_club In [3]: %ngql GO FROM \"Tom\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name Out[3]: Trainer_Name 0 Tom 1 Jerry 2 Sue 3 Tom 4 Wey In [4]: %%ngql ...: SHOW TAGS; ...: SHOW HOSTS; ...: ...: Out[4]: Host Port Status Leader count Leader distribution Partition distribution 0 storaged0 9779.0 ONLINE 0 No valid partition No valid partition 1 storaged1 9779.0 ONLINE 1 pokemon_club:1 pokemon_club:1 2 storaged2 9779.0 ONLINE 0 No valid partition No valid partition 3 Total NaN None 1 pokemon_club:1 pokemon_club:1 In [5]: trainer = \"Sue\" In [6]: %%ngql ...: GO FROM \"{{ trainer }}\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: Out[6]: Trainer_Name 0 Jerry 1 Sue 2 Tom 3 Wey In [7]: %ngql help Supported Configurations: ------------------------ \u003e How to config ngql_result_style in \"raw\", \"pandas\" %config IPythonNGQL.ngql_result_style=\"raw\" %config IPythonNGQL.ngql_result_style=\"pandas\" \u003e How to config ngql_verbose in True, False %config IPythonNGQL.ngql_verbose=True \u003e How to config max_connection_pool_size %config IPythonNGQL.max_connection_pool_size=10 Quick Start: ----------- \u003e Connect to Neubla Graph %ngql --address 127.0.0.1 --port 9669 --user user --password password \u003e Use Space %ngql USE nba \u003e Query %ngql SHOW TAGS; \u003e Multile Queries %%ngql SHOW TAGS; SHOW HOSTS; Reload ngql Magic %reload_ext ngql \u003e Variables in query, we are using Jinja2 here name = \"nba\" %ngql USE \"{{ name }}\" In [8]: trainer = \"Sue\" In [9]: %%ngql ...: GO FROM \"{{ trainer }}\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: ...: Out[9]: Trainer_Name 0 Jerry 1 Sue 2 Tom 3 Wey In [10]: %config IPythonNGQL.ngql_result_style=\"raw\" In [11]: %%ngql USE pokemon_club; ...: GO FROM \"Tom\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id ...: | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: ...: Out[11]: ResultSet(ExecutionResponse( error_code=0, latency_in_us=3270, data=DataSet( column_names=[b'Trainer_Name'], rows=[Row( values=[Value( sVal=b'Tom')]), Row( values=[Value( sVal=b'Jerry')]), Row( values=[Value( sVal=b'Sue')]), Row( values=[Value( sVal=b'Tom')]), Row( values=[Value( sVal=b'Wey')])]), space_name=b'pokemon_club')) In [12]: r = _ In [13]: r.column_values(key='Trainer_Name')[0]._value.value Out[13]: b'Tom' ","date":"2021-03-07","objectID":"/ipython-ngql/:1:8","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#examples"},{"categories":["Nebula Graph"],"content":" 1.8 Examples 1.8.1 Jupyter NotebookPlease refer here:https://github.com/wey-gu/ipython-ngql/blob/main/examples/get_started.ipynb 1.8.2 iPython venv â¯ ipython In [1]: %load_ext ngql In [2]: %ngql --address 127.0.0.1 --port 9669 --user user --password password Connection Pool Created Out[2]: Name 0 pokemon_club In [3]: %ngql GO FROM \"Tom\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name Out[3]: Trainer_Name 0 Tom 1 Jerry 2 Sue 3 Tom 4 Wey In [4]: %%ngql ...: SHOW TAGS; ...: SHOW HOSTS; ...: ...: Out[4]: Host Port Status Leader count Leader distribution Partition distribution 0 storaged0 9779.0 ONLINE 0 No valid partition No valid partition 1 storaged1 9779.0 ONLINE 1 pokemon_club:1 pokemon_club:1 2 storaged2 9779.0 ONLINE 0 No valid partition No valid partition 3 Total NaN None 1 pokemon_club:1 pokemon_club:1 In [5]: trainer = \"Sue\" In [6]: %%ngql ...: GO FROM \"{{ trainer }}\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: Out[6]: Trainer_Name 0 Jerry 1 Sue 2 Tom 3 Wey In [7]: %ngql help Supported Configurations: ------------------------ \u003e How to config ngql_result_style in \"raw\", \"pandas\" %config IPythonNGQL.ngql_result_style=\"raw\" %config IPythonNGQL.ngql_result_style=\"pandas\" \u003e How to config ngql_verbose in True, False %config IPythonNGQL.ngql_verbose=True \u003e How to config max_connection_pool_size %config IPythonNGQL.max_connection_pool_size=10 Quick Start: ----------- \u003e Connect to Neubla Graph %ngql --address 127.0.0.1 --port 9669 --user user --password password \u003e Use Space %ngql USE nba \u003e Query %ngql SHOW TAGS; \u003e Multile Queries %%ngql SHOW TAGS; SHOW HOSTS; Reload ngql Magic %reload_ext ngql \u003e Variables in query, we are using Jinja2 here name = \"nba\" %ngql USE \"{{ name }}\" In [8]: trainer = \"Sue\" In [9]: %%ngql ...: GO FROM \"{{ trainer }}\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: ...: Out[9]: Trainer_Name 0 Jerry 1 Sue 2 Tom 3 Wey In [10]: %config IPythonNGQL.ngql_result_style=\"raw\" In [11]: %%ngql USE pokemon_club; ...: GO FROM \"Tom\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id ...: | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: ...: Out[11]: ResultSet(ExecutionResponse( error_code=0, latency_in_us=3270, data=DataSet( column_names=[b'Trainer_Name'], rows=[Row( values=[Value( sVal=b'Tom')]), Row( values=[Value( sVal=b'Jerry')]), Row( values=[Value( sVal=b'Sue')]), Row( values=[Value( sVal=b'Tom')]), Row( values=[Value( sVal=b'Wey')])]), space_name=b'pokemon_club')) In [12]: r = _ In [13]: r.column_values(key='Trainer_Name')[0]._value.value Out[13]: b'Tom' ","date":"2021-03-07","objectID":"/ipython-ngql/:1:8","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#jupyter-notebook"},{"categories":["Nebula Graph"],"content":" 1.8 Examples 1.8.1 Jupyter NotebookPlease refer here:https://github.com/wey-gu/ipython-ngql/blob/main/examples/get_started.ipynb 1.8.2 iPython venv â¯ ipython In [1]: %load_ext ngql In [2]: %ngql --address 127.0.0.1 --port 9669 --user user --password password Connection Pool Created Out[2]: Name 0 pokemon_club In [3]: %ngql GO FROM \"Tom\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name Out[3]: Trainer_Name 0 Tom 1 Jerry 2 Sue 3 Tom 4 Wey In [4]: %%ngql ...: SHOW TAGS; ...: SHOW HOSTS; ...: ...: Out[4]: Host Port Status Leader count Leader distribution Partition distribution 0 storaged0 9779.0 ONLINE 0 No valid partition No valid partition 1 storaged1 9779.0 ONLINE 1 pokemon_club:1 pokemon_club:1 2 storaged2 9779.0 ONLINE 0 No valid partition No valid partition 3 Total NaN None 1 pokemon_club:1 pokemon_club:1 In [5]: trainer = \"Sue\" In [6]: %%ngql ...: GO FROM \"{{ trainer }}\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: Out[6]: Trainer_Name 0 Jerry 1 Sue 2 Tom 3 Wey In [7]: %ngql help Supported Configurations: ------------------------ \u003e How to config ngql_result_style in \"raw\", \"pandas\" %config IPythonNGQL.ngql_result_style=\"raw\" %config IPythonNGQL.ngql_result_style=\"pandas\" \u003e How to config ngql_verbose in True, False %config IPythonNGQL.ngql_verbose=True \u003e How to config max_connection_pool_size %config IPythonNGQL.max_connection_pool_size=10 Quick Start: ----------- \u003e Connect to Neubla Graph %ngql --address 127.0.0.1 --port 9669 --user user --password password \u003e Use Space %ngql USE nba \u003e Query %ngql SHOW TAGS; \u003e Multile Queries %%ngql SHOW TAGS; SHOW HOSTS; Reload ngql Magic %reload_ext ngql \u003e Variables in query, we are using Jinja2 here name = \"nba\" %ngql USE \"{{ name }}\" In [8]: trainer = \"Sue\" In [9]: %%ngql ...: GO FROM \"{{ trainer }}\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: ...: Out[9]: Trainer_Name 0 Jerry 1 Sue 2 Tom 3 Wey In [10]: %config IPythonNGQL.ngql_result_style=\"raw\" In [11]: %%ngql USE pokemon_club; ...: GO FROM \"Tom\" OVER owns_pokemon YIELD owns_pokemon._dst as pokemon_id ...: | GO FROM $-.pokemon_id OVER owns_pokemon REVERSELY YIELD owns_pokemon._dst AS Trainer_Name; ...: ...: Out[11]: ResultSet(ExecutionResponse( error_code=0, latency_in_us=3270, data=DataSet( column_names=[b'Trainer_Name'], rows=[Row( values=[Value( sVal=b'Tom')]), Row( values=[Value( sVal=b'Jerry')]), Row( values=[Value( sVal=b'Sue')]), Row( values=[Value( sVal=b'Tom')]), Row( values=[Value( sVal=b'Wey')])]), space_name=b'pokemon_club')) In [12]: r = _ In [13]: r.column_values(key='Trainer_Name')[0]._value.value Out[13]: b'Tom' ","date":"2021-03-07","objectID":"/ipython-ngql/:1:8","series":null,"tags":["Nebula Graph","iPython","Jupyter"],"title":"IPython-nGQL, Nebula Graph çš„ Jupyter æ’ä»¶","uri":"/ipython-ngql/#ipython"}]