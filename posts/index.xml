<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>所有文章 - siwei.io</title>
        <link>https://siwei.io/posts/</link>
        <description>所有文章 | siwei.io</description>
        <generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>weyl.gu@gmail.com (Wey Gu)</managingEditor>
            <webMaster>weyl.gu@gmail.com (Wey Gu)</webMaster><lastBuildDate>Tue, 25 Oct 2022 10:24:15 &#43;0800</lastBuildDate><atom:link href="https://siwei.io/posts/" rel="self" type="application/rss+xml" /><item>
    <title>图数据库体操：用 Nebula Graph 搭成语图谱解汉兜</title>
    <link>https://siwei.io/resolve-wordle/</link>
    <pubDate>Mon, 28 Feb 2022 19:18:59 &#43;0800</pubDate><author>
        <name>Wey Gu</name>
    </author><guid>https://siwei.io/resolve-wordle/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/resolve-wordle/featured-image.webp" referrerpolicy="no-referrer">
            </div><blockquote>
<p>我发现用 Nebula Graph 的图查询解 Antfu 的汉兜（最好的中文成语版 wordle 👉🏻 handle.antfu.me）特别有意思，很适合每天写图库语句的体操练习，本文揭示如何用知识图谱<del>作弊</del>解汉兜😁</p>
</blockquote>
<h2 id="什么是汉兜" class="headerLink">
    <a href="#%e4%bb%80%e4%b9%88%e6%98%af%e6%b1%89%e5%85%9c" class="header-mark"></a>1 什么是汉兜？</h2><p>汉兜（https://handle.antfu.me）是由 Vue/Vite 核心团队的 Antfu 的又一个非常酷的作品，一个非常精致的汉字版的 Wordle，他是是一个每日挑战的填字游戏的中文成语版。</p>
<p>每天，汉兜会发起一个猜成语挑战，人们要在十次内才对它才能获胜，每一步之后都会收到相应的文字、声母、韵母、声调的匹配情况的提示，其中：绿色表示这个因素存在并且位置匹配、橘色表示这个元素存在但是位置不对，详细的规则可见如下的网页截图：</p>
<p><a class="lightgallery" href="/resolve-wordle/handle-intro.webp" title="/resolve-wordle/handle-intro.webp" data-thumbnail="/resolve-wordle/handle-intro.webp">
        
    </a></p>
<p>汉兜的乐趣就我们在于在有限的尝试过程中，在大脑中搜寻可能的答案，不断去逼近真理，任何试图作弊、讨巧去泄漏结果的行为都是很无趣、倒胃口的（比如从开源的汉兜代码里窃取信息），这个过程就像在做大脑的体操。</p>
<p>说到大脑的成语词汇量体操，我突然想到，为什么我们不能在大脑之外造一个汉语成语知识图谱，然后基于这个图谱去做图数据库查询语法体操呢？</p>
<h2 id="构造解决汉兜的成语知识图谱" class="headerLink">
    <a href="#%e6%9e%84%e9%80%a0%e8%a7%a3%e5%86%b3%e6%b1%89%e5%85%9c%e7%9a%84%e6%88%90%e8%af%ad%e7%9f%a5%e8%af%86%e5%9b%be%e8%b0%b1" class="header-mark"></a>2 构造解决汉兜的成语知识图谱</h2><h3 id="什么是知识图谱" class="headerLink">
    <a href="#%e4%bb%80%e4%b9%88%e6%98%af%e7%9f%a5%e8%af%86%e5%9b%be%e8%b0%b1" class="header-mark"></a>2.1 什么是知识图谱？</h3><p>简单来说，知识图谱是一个连接实体之间关联关系的网络，它最初由 Google 提出并用来满足搜索引擎中基于知识推理才可获得（而不是网页倒排索引）的搜索问题，比如：”姚明妻子的年龄？“、”火箭队得过几次总冠军？“</p>
<p>这里边，我们关注的条件。到 2022 年的现在，知识图谱已经被广泛应用在推荐系统、问答系统、安全风控等等更多搜索之外的领域。</p>
<h3 id="为什么需要用知识图谱解决汉兜" class="headerLink">
    <a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81%e7%94%a8%e7%9f%a5%e8%af%86%e5%9b%be%e8%b0%b1%e8%a7%a3%e5%86%b3%e6%b1%89%e5%85%9c" class="header-mark"></a>2.2 为什么需要用知识图谱解决汉兜？</h3><p><del>原因就是：because I can</del></p>
<p>实际上，我们在大脑中解决字谜游戏的过程像极了图谱网络中的信息搜寻的过程，汉兜的解谜反馈提示条件天然适合被用图谱的语义来进行表达。在本文后边，你们会发现解谜条件翻译成图语义是非常非常自然的，这个问题就像是一个天然的为图谱而存在的练习一样，我相信这和知识图谱的结构和人脑中的知识结构非常接近有很大的关系。</p>
<h3 id="如何构建面向汉兜解谜的知识图谱" class="headerLink">
    <a href="#%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%ba%e9%9d%a2%e5%90%91%e6%b1%89%e5%85%9c%e8%a7%a3%e8%b0%9c%e7%9a%84%e7%9f%a5%e8%af%86%e5%9b%be%e8%b0%b1" class="header-mark"></a>2.3 如何构建面向汉兜解谜的知识图谱？</h3><p>知识图谱是由实体（顶点）和关系（边）组成的，用图数据库管理系统（Graph Database MS）可以很方便进行知识的入库、更改、查询、甚至可视化探索。</p>
<p>在本文里，我将利用开源的分布式图数据库 Nebula Graph 开实践这个过程，具体图谱系统的搭建我都会放在文末。</p>
<p>在本章，我们只讨论图谱的建模：如何面向汉兜的解谜去设计“实体”与“关系”。</p>
<h4 id="图建模" class="headerLink">
    <a href="#%e5%9b%be%e5%bb%ba%e6%a8%a1" class="header-mark"></a>2.3.1 图建模</h4><h5 id="最初的想法" class="headerLink">
    <a href="#%e6%9c%80%e5%88%9d%e7%9a%84%e6%83%b3%e6%b3%95" class="header-mark"></a>2.3.1.1 最初的想法</h5><p>首先，一定存在的实体是：</p>
<ul>
<li>成语</li>
<li>汉字</li>
</ul>
<p>成语-[包含]-&gt;汉字，每个汉字-[读作]-&gt;读音。</p>
<p>其次，因为解谜过程中涉及到了声母、韵母以及声调的条件，考虑到图谱本身的量级非常小（千级别），而且字的读音是一对多的关系，我把读音和声母（包涵声母-initial和韵母-final）也作为实体，他们之间的关系则是顺理成章了：</p>
<p><a class="lightgallery" href="./schema_v0.webp" title="schema_v0" data-thumbnail="./schema_v0.webp">
        
    </a></p>
<h5 id="最终的版本" class="headerLink">
    <a href="#%e6%9c%80%e7%bb%88%e7%9a%84%e7%89%88%e6%9c%ac" class="header-mark"></a>2.3.1.2 最终的版本</h5><p>然而，我在后边基于图谱进行查询的时候发现最初的建模会使得(成语)&ndash;&gt;(字)&ndash;&gt;(读音)查询过程中丢失了这个字特定的读法的条件，所以我最终的建模是：</p>
<p><a class="lightgallery" href="./schema_v1.webp" title="schema_v1" data-thumbnail="./schema_v1.webp">
        
    </a></p>
<p>这样，纯文字的条件只涉及了<code>(成语)--&gt;(字)</code> 这一跳，而读音、声母、声调的条件则是另一条关系路径，既没有最初版本条件的冗余，又可以在一个路径模式匹配里带上两种条件（后边的例子里会涉及这样的表达）。</p>
<h4 id="构建成语知识图谱" class="headerLink">
    <a href="#%e6%9e%84%e5%bb%ba%e6%88%90%e8%af%ad%e7%9f%a5%e8%af%86%e5%9b%be%e8%b0%b1" class="header-mark"></a>2.3.2 构建成语知识图谱</h4><p>有了建模、这么简单的图谱的构建就剩下了数据的收集、清洗和入库。</p>
<p>对于所有成语数据和他们的读音，我一方面直接抽取了汉兜代码内部的<a href="https://github.com/antfu/handle/" target="_blank" rel="noopener noreferrer">数据</a>、另一方面利用 <a href="https://pypinyin.readthedocs.io/" target="_blank" rel="noopener noreferrer">PyPinyin</a> 这个开源的 Python 库将汉兜数据中没有读音的数据获得读音，同时，我也用到了 PyPinyin 里的很多方便的函数比如获取一个拼音的声母、韵母。</p>
<p>构建工具的代码在这里：https://github.com/wey-gu/chinese-graph</p>
<p>更多信息我也放在文末的附录之中。</p>
<h2 id="开始知识图谱查询体操" class="headerLink">
    <a href="#%e5%bc%80%e5%a7%8b%e7%9f%a5%e8%af%86%e5%9b%be%e8%b0%b1%e6%9f%a5%e8%af%a2%e4%bd%93%e6%93%8d" class="header-mark"></a>3 开始知识图谱查询体操</h2><p>至此，我假设咱们都已经有了我帮大家搭建的成语<del>作弊</del>知识图谱了，开始我们的图谱查询体操吧！</p>
<p>首先，打开汉兜 👉🏻 <a href="https://handle.antfu.me/" target="_blank" rel="noopener noreferrer">https://handle.antfu.me/</a></p>
<p>假设我们想从一个成语开始，如果你没有想法的话可以试试这个：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">匹配成语中的一个结果</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">返回结果</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;爱憎分明&#34;</span><span class="w"> </span><span class="p">:</span><span class="n">idiom</span><span class="err">{</span><span class="n">pinyin</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;[&#39;ai4&#39;, &#39;zeng1&#39;, &#39;fen1&#39;, &#39;ming2&#39;]&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>然后我们把它填到汉兜之中，获得第一次尝试的提示条件：</p>
<p><a class="lightgallery" href="/resolve-wordle/initial_word.webp" title="/resolve-wordle/initial_word.webp" data-thumbnail="/resolve-wordle/initial_word.webp">
        
    </a></p>
<p>我们运气不错，得到了三个位置上的条件！</p>
<ul>
<li>有一个非第一个位置的字，拼音是 4 声，韵母是 ai，但不是爱（爱）</li>
<li>有一个一声的字，不在第二个位置（憎）</li>
<li>有一个字韵母是 ing，不在第四个位置（明）</li>
<li>第四个字是二声（明）</li>
</ul>
<p>下面，我们开始图数据库语句体操！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">有一个非第一个位置的字，拼音是</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">声，韵母是</span><span class="w"> </span><span class="n">ai</span><span class="err">，但不是爱</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">char0</span><span class="p">:</span><span class="o">`</span><span class="k">character</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">with_char_0</span><span class="p">:</span><span class="o">`</span><span class="n">with_character</span><span class="o">`</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">with_pinyin_0</span><span class="p">:</span><span class="o">`</span><span class="n">with_pinyin</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">pinyin_0</span><span class="p">:</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="o">`</span><span class="n">with_pinyin_part</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="o">`</span><span class="n">final_part_0</span><span class="o">`</span><span class="p">:</span><span class="o">`</span><span class="n">pinyin_part</span><span class="o">`</span><span class="err">{</span><span class="n">part_type</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;final&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="o">`</span><span class="n">final_part_0</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;ai&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">pinyin_0</span><span class="p">.</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">.</span><span class="n">tone</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_pinyin_0</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_char_0</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">char0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&#34;爱&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">有一个一声的字，不在第二个位置</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="p">[</span><span class="n">with_pinyin_1</span><span class="p">:</span><span class="o">`</span><span class="n">with_pinyin</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">pinyin_1</span><span class="p">:</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">pinyin_1</span><span class="p">.</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">.</span><span class="n">tone</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_pinyin_1</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">有一个字韵母是</span><span class="w"> </span><span class="n">ing</span><span class="err">，不在第四个位置</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="p">[</span><span class="n">with_pinyin_2</span><span class="p">:</span><span class="o">`</span><span class="n">with_pinyin</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(:</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="o">`</span><span class="n">with_pinyin_part</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">final_part_2</span><span class="p">:</span><span class="o">`</span><span class="n">pinyin_part</span><span class="o">`</span><span class="err">{</span><span class="n">part_type</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;final&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">final_part_2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;ing&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_pinyin_2</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">第四个字是二声</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="p">[</span><span class="n">with_pinyin_3</span><span class="p">:</span><span class="o">`</span><span class="n">with_pinyin</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">pinyin_3</span><span class="p">:</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">pinyin_3</span><span class="p">.</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">.</span><span class="n">tone</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_pinyin_3</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>在图数据库之中运行，得到了 7 个答案：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">(</span><span class="s2">&#34;惊愚骇俗&#34;</span> <span class="err">:idiom</span><span class="p">{</span><span class="err">pinyin:</span> <span class="nt">&#34;[&#39;jing1&#39;, &#39;yu2&#39;, &#39;hai4&#39;, &#39;su2&#39;]&#34;</span><span class="p">}</span><span class="err">)</span>
</span></span><span class="line"><span class="cl"><span class="err">(</span><span class="s2">&#34;惊世骇俗&#34;</span> <span class="err">:idiom</span><span class="p">{</span><span class="err">pinyin:</span> <span class="nt">&#34;[&#39;jing1&#39;, &#39;shi4&#39;, &#39;hai4&#39;, &#39;su2&#39;]&#34;</span><span class="p">}</span><span class="err">)</span>
</span></span><span class="line"><span class="cl"><span class="err">(</span><span class="s2">&#34;惊见骇闻&#34;</span> <span class="err">:idiom</span><span class="p">{</span><span class="err">pinyin:</span> <span class="nt">&#34;[&#39;jing1&#39;, &#39;jian4&#39;, &#39;hai4&#39;, &#39;wen2&#39;]&#34;</span><span class="p">}</span><span class="err">)</span>
</span></span><span class="line"><span class="cl"><span class="err">(</span><span class="s2">&#34;沽名卖直&#34;</span> <span class="err">:idiom</span><span class="p">{</span><span class="err">pinyin:</span> <span class="nt">&#34;[&#39;gu1&#39;, &#39;ming2&#39;, &#39;mai4&#39;, &#39;zhi2&#39;]&#34;</span><span class="p">}</span><span class="err">)</span>
</span></span><span class="line"><span class="cl"><span class="err">(</span><span class="s2">&#34;惊心骇神&#34;</span> <span class="err">:idiom</span><span class="p">{</span><span class="err">pinyin:</span> <span class="nt">&#34;[&#39;jing1&#39;, &#39;xin1&#39;, &#39;hai4&#39;, &#39;shen2&#39;]&#34;</span><span class="p">}</span><span class="err">)</span>
</span></span><span class="line"><span class="cl"><span class="err">(</span><span class="s2">&#34;荆棘载途&#34;</span> <span class="err">:idiom</span><span class="p">{</span><span class="err">pinyin:</span> <span class="nt">&#34;[&#39;jing1&#39;, &#39;ji2&#39;, &#39;zai4&#39;, &#39;tu2&#39;]&#34;</span><span class="p">}</span><span class="err">)</span>
</span></span><span class="line"><span class="cl"><span class="err">(</span><span class="s2">&#34;出卖灵魂&#34;</span> <span class="err">:idiom</span><span class="p">{</span><span class="err">pinyin:</span> <span class="nt">&#34;[&#39;chu1&#39;, &#39;mai4&#39;, &#39;ling2&#39;, &#39;hun2&#39;]&#34;</span><span class="p">}</span><span class="err">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>看起来 <code>惊世骇俗</code> 比较主流，试试！</p>
<p><a class="lightgallery" href="./D59.webp" title="汉兜 D59" data-thumbnail="./D59.webp">
        
    </a></p>
<p>我们很幸运，借助于成语<del>作弊</del>知识图谱，居然一次就找到了答案，当然这实际上得益于第一次随机选取的词带来的限制条件的个数，不过在大部分情况下，两次尝试获得最终答案的可能性还是非常大的！</p>
<blockquote>
<p>注，这中间很长的253分钟是因为我在查询中发现之前代码里构造的图谱有点 bug，是“披枷带锁”这个词引起的读音图谱的错误数据，还好后来被修复了。</p>
<p>大家知道“披枷带锁”的正确读音么？😭</p>
</blockquote>
<p>接下来，我给大家详细解释一下这个语句的意思。</p>
<h3 id="语句的含义" class="headerLink">
    <a href="#%e8%af%ad%e5%8f%a5%e7%9a%84%e5%90%ab%e4%b9%89" class="header-mark"></a>3.1 语句的含义</h3><p>我们从第一个字的条件开始，这是一个既有声音、又有字形信息的条件。</p>
<ul>
<li>声音信息：存在一个韵母为 <code>ai4</code> 的发音，位置不在第一个字</li>
<li>文字信息：这个韵母为 <code>ai4</code> 的字，不是<code>爱</code>字</li>
</ul>
<p>对于声音信息条件，转换为图模式匹配为：(成语)-一个字发音-(拼音) -包含声母-(韵母) WHERE 拼音韵母为 <code>ai4</code> AND 位置不是第一个。</p>
<p>因为建模的时候，属性名称我用的是英文（其实中文也是支持的），实际上的语句为：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">有一个非第一个位置的字，拼音是</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">声，韵母是</span><span class="w"> </span><span class="n">ai</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="n">idiom</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">with_pinyin_0</span><span class="p">:</span><span class="n">with_pinyin</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">pinyin_0</span><span class="p">:</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="o">`</span><span class="n">with_pinyin_part</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="o">`</span><span class="n">final_part_0</span><span class="o">`</span><span class="p">:</span><span class="o">`</span><span class="n">pinyin_part</span><span class="o">`</span><span class="err">{</span><span class="n">part_type</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;final&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="o">`</span><span class="n">final_part_0</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;ai&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">pinyin_0</span><span class="p">.</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">.</span><span class="n">tone</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_pinyin_0</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">x</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>类似的，表示非第一个位置的字，不是<code>爱</code> 的表达是：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">有一个非第一个位置的字，拼音是</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">声，韵母是</span><span class="w"> </span><span class="n">ai</span><span class="err">，但不是爱</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">char0</span><span class="p">:</span><span class="o">`</span><span class="k">character</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">with_char_0</span><span class="p">:</span><span class="o">`</span><span class="n">with_character</span><span class="o">`</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">with_char_0</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">char0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&#34;爱&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>而因为这两个条件最终描述的是同一个字，所以它们是可以被写在一个路径下的：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">有一个非第一个位置的字，拼音是</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">声，韵母是</span><span class="w"> </span><span class="n">ai</span><span class="err">，但不是爱</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">char0</span><span class="p">:</span><span class="o">`</span><span class="k">character</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">with_char_0</span><span class="p">:</span><span class="o">`</span><span class="n">with_character</span><span class="o">`</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">with_pinyin_0</span><span class="p">:</span><span class="o">`</span><span class="n">with_pinyin</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">pinyin_0</span><span class="p">:</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="o">`</span><span class="n">with_pinyin_part</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="o">`</span><span class="n">final_part_0</span><span class="o">`</span><span class="p">:</span><span class="o">`</span><span class="n">pinyin_part</span><span class="o">`</span><span class="err">{</span><span class="n">part_type</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;final&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="o">`</span><span class="n">final_part_0</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;ai&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">pinyin_0</span><span class="p">.</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">.</span><span class="n">tone</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_pinyin_0</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_char_0</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">char0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&#34;爱&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">x</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>更多的 <code>MATCH</code> 语法和例子细节，请大家参考文档：</p>
<ul>
<li>MATCH <a href="https://docs.nebula-graph.com.cn/3.0.0/3.ngql-guide/7.general-query-statements/2.match/" target="_blank" rel="noopener noreferrer">https://docs.nebula-graph.com.cn/3.0.0/3.ngql-guide/7.general-query-statements/2.match/</a></li>
<li>图模式 <a href="https://docs.nebula-graph.com.cn/3.0.0/3.ngql-guide/1.nGQL-overview/3.graph-patterns/" target="_blank" rel="noopener noreferrer">https://docs.nebula-graph.com.cn/3.0.0/3.ngql-guide/1.nGQL-overview/3.graph-patterns/</a></li>
<li>nGQL 命令 cheatsheet <a href="https://docs.nebula-graph.com.cn/3.0.0/2.quick-start/6.cheatsheet-for-ngql-command/" target="_blank" rel="noopener noreferrer">https://docs.nebula-graph.com.cn/3.0.0/2.quick-start/6.cheatsheet-for-ngql-command/</a></li>
</ul>
<h2 id="可视化展示线索" class="headerLink">
    <a href="#%e5%8f%af%e8%a7%86%e5%8c%96%e5%b1%95%e7%a4%ba%e7%ba%bf%e7%b4%a2" class="header-mark"></a>4 可视化展示线索</h2><p>我们把每一个条件的匹配路径作为输出，利用 Nebula Graph 的可视化能力，可以得到：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">有一个非第一个位置的字，拼音是</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">声，韵母是</span><span class="w"> </span><span class="n">ai</span><span class="err">，但不是爱</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p0</span><span class="o">=</span><span class="p">(</span><span class="n">char0</span><span class="p">:</span><span class="o">`</span><span class="k">character</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">with_char_0</span><span class="p">:</span><span class="o">`</span><span class="n">with_character</span><span class="o">`</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">with_pinyin_0</span><span class="p">:</span><span class="o">`</span><span class="n">with_pinyin</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">pinyin_0</span><span class="p">:</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="o">`</span><span class="n">with_pinyin_part</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="o">`</span><span class="n">final_part_0</span><span class="o">`</span><span class="p">:</span><span class="o">`</span><span class="n">pinyin_part</span><span class="o">`</span><span class="err">{</span><span class="n">part_type</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;final&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="o">`</span><span class="n">final_part_0</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;ai&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">pinyin_0</span><span class="p">.</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">.</span><span class="n">tone</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_pinyin_0</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_char_0</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">char0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&#34;爱&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">有一个一声的字，不在第二个位置</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="p">[</span><span class="n">with_pinyin_1</span><span class="p">:</span><span class="o">`</span><span class="n">with_pinyin</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">pinyin_1</span><span class="p">:</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">pinyin_1</span><span class="p">.</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">.</span><span class="n">tone</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_pinyin_1</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">有一个字韵母是</span><span class="w"> </span><span class="n">ing</span><span class="err">，不在第四个位置</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="p">[</span><span class="n">with_pinyin_2</span><span class="p">:</span><span class="o">`</span><span class="n">with_pinyin</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(:</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="o">`</span><span class="n">with_pinyin_part</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">final_part_2</span><span class="p">:</span><span class="o">`</span><span class="n">pinyin_part</span><span class="o">`</span><span class="err">{</span><span class="n">part_type</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;final&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">final_part_2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;ing&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_pinyin_2</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">第四个字是二声</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p3</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="p">[</span><span class="n">with_pinyin_3</span><span class="p">:</span><span class="o">`</span><span class="n">with_pinyin</span><span class="o">`</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">pinyin_3</span><span class="p">:</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">pinyin_3</span><span class="p">.</span><span class="o">`</span><span class="n">character_pinyin</span><span class="o">`</span><span class="p">.</span><span class="n">tone</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">with_pinyin_3</span><span class="p">.</span><span class="o">`</span><span class="n">position</span><span class="o">`</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">p0</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>在可视化工具的 Console 控制台里执行上边的语句之后，选择导入图探索，就可以看到</p>
<p><a class="lightgallery" href="/resolve-wordle/studio.webp" title="/resolve-wordle/studio.webp" data-thumbnail="/resolve-wordle/studio.webp">
        
    </a></p>
<h2 id="下一步" class="headerLink">
    <a href="#%e4%b8%8b%e4%b8%80%e6%ad%a5" class="header-mark"></a>5 下一步</h2><p>如果大家是从本文第一次了解到 Nebula Graph 图数据库，那么大家可以下一步从 <a href="https://github.com/vesoft-inc/nebula" target="_blank" rel="noopener noreferrer">Nebula Graph</a> 项目和 Nebula Graph 社区的官方 Bilibili 站点 👉🏻 <a href="https://space.bilibili.com/472621355" target="_blank" rel="noopener noreferrer">https://space.bilibili.com/472621355</a> 了解更多有意思的入门知识。</p>
<p>另外，<a href="https://nebula-graph.com.cn/demo/" target="_blank" rel="noopener noreferrer">这里</a>是 Nebula Graph 的官方线上试玩环境，大家可以照着<a href="https://docs.nebula-graph.com.cn/" target="_blank" rel="noopener noreferrer">文档</a>，利用试玩环境尝鲜。</p>
<p>后边，Nebula Graph 会开展每天的汉兜 nGQL 体操活动，敬请关注哈！</p>
<p>Happy Graphing!</p>
<h2 id="附录搭建成语知识图谱" class="headerLink">
    <a href="#%e9%99%84%e5%bd%95%e6%90%ad%e5%bb%ba%e6%88%90%e8%af%ad%e7%9f%a5%e8%af%86%e5%9b%be%e8%b0%b1" class="header-mark"></a>6 附录：搭建成语知识图谱</h2><h3 id="收集生成图谱数据" class="headerLink">
    <a href="#%e6%94%b6%e9%9b%86%e7%94%9f%e6%88%90%e5%9b%be%e8%b0%b1%e6%95%b0%e6%8d%ae" class="header-mark"></a>6.1 收集、生成图谱数据</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python3 graph_data_generator.py
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="导入数据到-nebula-graph-图数据库" class="headerLink">
    <a href="#%e5%af%bc%e5%85%a5%e6%95%b0%e6%8d%ae%e5%88%b0-nebula-graph-%e5%9b%be%e6%95%b0%e6%8d%ae%e5%ba%93" class="header-mark"></a>6.2 导入数据到 Nebula Graph 图数据库</h3><h4 id="部署图数据库" class="headerLink">
    <a href="#%e9%83%a8%e7%bd%b2%e5%9b%be%e6%95%b0%e6%8d%ae%e5%ba%93" class="header-mark"></a>6.2.1 部署图数据库</h4><blockquote>
<p>借助于 Nebula-Up <a href="https://github.com/wey-gu/nebula-up/" target="_blank" rel="noopener noreferrer">https://github.com/wey-gu/nebula-up/</a> ，一行就可以了。</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ curl -fsSL nebula-up.siwei.io/install.sh <span class="p">|</span> bash -s -- v3.0.0
</span></span></code></pre></td></tr></table>
</div>
</div><p>部署成功的话，会看到这样的结果：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌────────────────────────────────────────┐
</span></span><span class="line"><span class="cl">│ 🌌 Nebula-Graph Playground is Up now!  │
</span></span><span class="line"><span class="cl">├────────────────────────────────────────┤
</span></span><span class="line"><span class="cl">│                                        │
</span></span><span class="line"><span class="cl">│ 🎉 Congrats! Your Nebula is Up now!    │
</span></span><span class="line"><span class="cl">│    $ <span class="nb">cd</span> ~/.nebula-up                   │
</span></span><span class="line"><span class="cl">│                                        │
</span></span><span class="line"><span class="cl">│ 🌏 You can access it from browser:     │
</span></span><span class="line"><span class="cl">│      http://127.0.0.1:7001             │
</span></span><span class="line"><span class="cl">│      http://&lt;other_interface&gt;:7001     │
</span></span><span class="line"><span class="cl">│                                        │
</span></span><span class="line"><span class="cl">│ 🔥 Or access via Nebula Console:       │
</span></span><span class="line"><span class="cl">│    $ ~/.nebula-up/console.sh           │
</span></span><span class="line"><span class="cl">│                                        │
</span></span><span class="line"><span class="cl">│    To remove the playground:           │
</span></span><span class="line"><span class="cl">│    $ ~/.nebula-up/uninstall.sh         │
</span></span><span class="line"><span class="cl">│                                        │
</span></span><span class="line"><span class="cl">│ 🚀 Have Fun!                           │
</span></span><span class="line"><span class="cl">│                                        │
</span></span><span class="line"><span class="cl">└────────────────────────────────────────┘
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="图谱入库" class="headerLink">
    <a href="#%e5%9b%be%e8%b0%b1%e5%85%a5%e5%ba%93" class="header-mark"></a>6.2.2 图谱入库</h4><blockquote>
<p>借助于 Nebula-Importer <a href="https://github.com/vesoft-inc/nebula-importer/" target="_blank" rel="noopener noreferrer">https://github.com/vesoft-inc/nebula-importer/</a> ，一行就可以了。</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker run --rm -ti <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --network<span class="o">=</span>nebula-docker-compose_nebula-net <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/importer_conf.yaml:/root/importer_conf.yaml <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/output:/root <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    vesoft/nebula-importer:v3.0.0 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --config /root/importer_conf.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><p>大概一两分钟数据就导入成功了，命令也会正常退出。</p>
<blockquote>
<p>连到图数据库的 console</p>
</blockquote>
<p>进入 Console 的容器执行下边的命令：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ~/.nebula-up/console.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># nebula-console -addr graphd -port 9669 -user root -p nebula</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>检查一下导入的数据：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[(</span><span class="k">none</span><span class="p">)]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="n">spaces</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">--------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">Name</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">--------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;chinese_idiom&#34;</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">--------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[(</span><span class="k">none</span><span class="p">)]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">chinese_idiom</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">1510</span><span class="o">/</span><span class="mi">2329</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Fri</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="n">Feb</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">08</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">11</span><span class="w"> </span><span class="n">UTC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">chinese_idiom</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="err">成语</span><span class="p">:</span><span class="o">`</span><span class="n">idiom</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------------------------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">p</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------------------------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;一丁不识&#34;</span><span class="w"> </span><span class="p">:</span><span class="n">idiom</span><span class="err">{</span><span class="n">pinyin</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;[&#39;yi1&#39;, &#39;ding1&#39;, &#39;bu4&#39;, &#39;shi2&#39;]&#34;</span><span class="err">}</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;一丝不挂&#34;</span><span class="w"> </span><span class="p">:</span><span class="n">idiom</span><span class="err">{</span><span class="n">pinyin</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;[&#39;yi1&#39;, &#39;si1&#39;, &#39;bu4&#39;, &#39;gua4&#39;]&#34;</span><span class="err">}</span><span class="p">)</span><span class="o">&gt;</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------------------------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">chinese_idiom</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SUBMIT</span><span class="w"> </span><span class="n">JOB</span><span class="w"> </span><span class="n">STATS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">Job</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="mi">11</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">chinese_idiom</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">STATS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------+--------------------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="k">Type</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">Name</span><span class="w">               </span><span class="o">|</span><span class="w"> </span><span class="k">Count</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------+--------------------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Tag&#34;</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;character&#34;</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">4847</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Tag&#34;</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;character_pinyin&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">1336</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Tag&#34;</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;idiom&#34;</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="mi">29503</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Tag&#34;</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;pinyin_part&#34;</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">57</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Edge&#34;</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;with_character&#34;</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mi">116090</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Edge&#34;</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;with_pinyin&#34;</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">5943</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Edge&#34;</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;with_pinyin_part&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">3290</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Space&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;vertices&#34;</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="mi">35739</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Space&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;edges&#34;</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="mi">125323</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---------+--------------------+--------+
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="附录图建模的-schema-ngql" class="headerLink">
    <a href="#%e9%99%84%e5%bd%95%e5%9b%be%e5%bb%ba%e6%a8%a1%e7%9a%84-schema-ngql" class="header-mark"></a>7 附录：图建模的 Schema nGQL</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">SPACE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">chinese_idiom</span><span class="p">(</span><span class="n">partition_num</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">replica_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vid_type</span><span class="o">=</span><span class="n">FIXED_STRING</span><span class="p">(</span><span class="mi">24</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">USE</span><span class="w"> </span><span class="n">chinese_idiom</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">创建点的类型</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="n">TAG</span><span class="w"> </span><span class="n">idiom</span><span class="p">(</span><span class="n">pinyin</span><span class="w"> </span><span class="n">string</span><span class="p">);</span><span class="w"> </span><span class="o">#</span><span class="err">成语</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="n">TAG</span><span class="w"> </span><span class="nb">character</span><span class="p">();</span><span class="w"> </span><span class="o">#</span><span class="err">汉字</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="n">TAG</span><span class="w"> </span><span class="n">character_pinyin</span><span class="p">(</span><span class="n">tone</span><span class="w"> </span><span class="nb">int</span><span class="p">);</span><span class="w"> </span><span class="o">#</span><span class="err">单字的拼音</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="n">TAG</span><span class="w"> </span><span class="n">pinyin_part</span><span class="p">(</span><span class="n">part_type</span><span class="w"> </span><span class="n">string</span><span class="p">);</span><span class="w"> </span><span class="o">#</span><span class="err">拼音的声部</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">创建边的类型</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="n">EDGE</span><span class="w"> </span><span class="n">with_character</span><span class="p">(</span><span class="o">`</span><span class="k">position</span><span class="o">`</span><span class="w"> </span><span class="nb">int</span><span class="p">);</span><span class="w"> </span><span class="o">#</span><span class="err">包含汉字</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="n">EDGE</span><span class="w"> </span><span class="n">with_pinyin</span><span class="p">(</span><span class="o">`</span><span class="k">position</span><span class="o">`</span><span class="w"> </span><span class="nb">int</span><span class="p">);</span><span class="w"> </span><span class="o">#</span><span class="err">读作</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="n">EDGE</span><span class="w"> </span><span class="n">with_pinyin_part</span><span class="p">(</span><span class="n">part_type</span><span class="w"> </span><span class="n">string</span><span class="p">);</span><span class="w"> </span><span class="o">#</span><span class="err">包含声部</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div>]]></description>
</item><item>
    <title>基于 NebulaGraph 图数据库的欺诈检测方法与代码示例</title>
    <link>https://siwei.io/fraud-detection-with-nebulagraph/</link>
    <pubDate>Mon, 01 Aug 2022 01:15:05 &#43;0800</pubDate><author>
        <name>Wey Gu</name>
    </author><guid>https://siwei.io/fraud-detection-with-nebulagraph/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/fraud-detection-with-nebulagraph/featured-image.webp" referrerpolicy="no-referrer">
            </div><blockquote>
<p>本文是一个基于 NebulaGraph 上图算法、图数据库、机器学习、GNN 的 Fraud Detection 方法综述，除了基本方法思想的介绍之外，我还给大家弄了可以跑的 Playground。</p>
</blockquote>
<blockquote>
<p>值得一提的是，这还我第一次给大家介绍 Nebula-DGL 这个项目 😁。</p>
</blockquote>
<!--

[TOC]

-->
<h2 id="基于图数据库的欺诈检测方法" class="headerLink">
    <a href="#%e5%9f%ba%e4%ba%8e%e5%9b%be%e6%95%b0%e6%8d%ae%e5%ba%93%e7%9a%84%e6%ac%ba%e8%af%88%e6%a3%80%e6%b5%8b%e6%96%b9%e6%b3%95" class="header-mark"></a>1 基于图数据库的欺诈检测方法</h2><h3 id="建立图谱" class="headerLink">
    <a href="#%e5%bb%ba%e7%ab%8b%e5%9b%be%e8%b0%b1" class="header-mark"></a>1.1 建立图谱</h3><p>首先，对现有的历史数据、标注信息面向关联关系进行属性图建模。这种原始数据是多个表结构中的银行、电子商务或者保险行业里的交易事件记录、用户数据和风控标注，而建模过程就是抽象出我们关心的实体、实体间的关联关系、和其中有意义的属性。</p>
<p>一般来说，自然人、公司实体、电话号码、地址、设备（比如终端设备、网络地址、终端设备所连接的 WiFi SSID 等）、订单都是实体本身，其他信息比如风险标注（是否高风险、风险描述等）、自然人和公司实体的信息（职业、收入、学历等）都作为实体的属性来建模。</p>
<p>下图是一个可以参考的贷款反欺诈的示例建模，它来自一份作者开源的图结构数据生成项目。</p>
<blockquote>
<p>注，你可以访问 <a href="https://github.com/wey-gu/fraud-detection-datagen" target="_blank" rel="noopener noreferrer">https://github.com/wey-gu/fraud-detection-datagen</a> 获取这个开源的数据生成器代码和一份示例的数据。</p>
</blockquote>
<p><a class="lightgallery" href="https://github.com/wey-gu/fraud-detection-datagen/raw/main/images/fraud_detection_graph_model.svg" title="https://github.com/wey-gu/fraud-detection-datagen/raw/main/images/fraud_detection_graph_model.svg" data-thumbnail="https://github.com/wey-gu/fraud-detection-datagen/raw/main/images/fraud_detection_graph_model.svg">
        
    </a></p>
<h3 id="图数据库查询识别风险" class="headerLink">
    <a href="#%e5%9b%be%e6%95%b0%e6%8d%ae%e5%ba%93%e6%9f%a5%e8%af%a2%e8%af%86%e5%88%ab%e9%a3%8e%e9%99%a9" class="header-mark"></a>1.2 图数据库查询识别风险</h3><p>有了一张囊括了人、公司、历史贷款申请记录、电话、线上申请网络设备的图谱，我们可以挖掘一些有意思的信息。</p>
<p>事实上，很多值得被发现、并有效阻止从而止损的骗保行为是具有群体聚集性的。比如欺诈团伙可能是一小批人（比如3到5人）有组织地收集更大规模的身份证信息（比如30张），同时发起多个金融机构大量贷款，然后在放款后选择丢弃这批留下了违约记录的身份证，再进一步选择下一批身份证信息如法炮制。</p>
<p>这种团伙作案的方式因为利用了大量新的身份信息，完全利用历史记录去黑名单规避风险的方式是无效的。不过，借助于关联关系的视角，这些模式是一定程度上可以被及时识别出来的。</p>
<p>这些可以被识别出的规律我把它分成两种：</p>
<p>一种是风控专家可以直接用某种模式来描述的，例如：和已经被标注为高风险的实体有直接或者间接的关联关系（新订单申请人使用了和过往高风险记录相同的网络设备），这种模式对应到图谱中，通过一个图查询就可以实时给出结果。</p>
<p>另一种是隐含在数据的关联关系背后，需要通过图算法挖掘得出的一些风险提示，例如：尽管给定的实体与有限的标注高风险实体没有匹配的关联，但是它在图中形成了聚集性可能提示我们这可能是一个尚未得手的进行中的团伙贷款诈骗的其中一次申请，这种情况可以通过定期在历史数据中批量执行社区发现算法得出，并在高聚集社区中利用中心性算法给出核心实体，一并提示给风险专家进行后续评估和风险标注。</p>
<h4 id="基于图谱与专家图模式匹配的欺诈检测示例" class="headerLink">
    <a href="#%e5%9f%ba%e4%ba%8e%e5%9b%be%e8%b0%b1%e4%b8%8e%e4%b8%93%e5%ae%b6%e5%9b%be%e6%a8%a1%e5%bc%8f%e5%8c%b9%e9%85%8d%e7%9a%84%e6%ac%ba%e8%af%88%e6%a3%80%e6%b5%8b%e7%a4%ba%e4%be%8b" class="header-mark"></a>1.2.1 基于图谱与专家图模式匹配的欺诈检测示例</h4><p>在开始之前，我们利用 Nebula-UP 来一键部署一套 NebulaGraph 图数据库：</p>
<blockquote>
<p>更多请参考 <a href="https://github.com/wey-gu/nebula-up/" target="_blank" rel="noopener noreferrer">https://github.com/wey-gu/nebula-up/</a></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -fsSL nebula-up.siwei.io/install.sh <span class="p">|</span> bash
</span></span></code></pre></td></tr></table>
</div>
</div><p>首先，我们把前边建模的图谱加载到 NebulaGraph 里：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 克隆数据集代码仓库</span>
</span></span><span class="line"><span class="cl">git clone https://github.com/wey-gu/fraud-detection-datagen.git
</span></span><span class="line"><span class="cl">cp -r data_sample_numerical_vertex_id data
</span></span><span class="line"><span class="cl"><span class="c1"># 去掉表头</span>
</span></span><span class="line"><span class="cl">sed -i <span class="s1">&#39;1d&#39;</span> data/*.csv
</span></span><span class="line"><span class="cl">docker run --rm -ti <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --network<span class="o">=</span>nebula-net <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>:/root/ <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/data/:/data <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    vesoft/nebula-importer:v3.1.0 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --config /root/nebula_graph_importer.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><p>有了这样一个图谱，风控专家可以在可视化探索工具中按需探索实体之间的关系，绘制相应的风险模式：</p>
<p><a class="lightgallery" href="./viz_graph_query.webp" title="./viz_graph_query.webp" data-thumbnail="./viz_graph_query.webp">
        
    </a></p>
<p>在这个探索截图里，我们可以明显看到一个群控设备的风险模式，这个模式可以被交给图数据库开发者，抽象成可以被风控应用定期、实时查询的语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## 针对一笔交易申请关联查询
</span></span><span class="line"><span class="cl">MATCH (n) WHERE id(n) == &#34;200000010265&#34;
</span></span><span class="line"><span class="cl">OPTIONAL MATCH p_shared_d=(n)-[:used_device]-&gt;(d)&lt;-[:used_device]-(:applicant)-[:with_phone_num]-&gt;(pn:phone_num)&lt;-[e:with_phone_num]-(:applicant)
</span></span><span class="line"><span class="cl">RETURN p_shared_d
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们可以很容易在此模型之上，通过修改返回的关联设备计数，作为意向指标查询的判断 API：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## 群控指标
</span></span><span class="line"><span class="cl">MATCH (n) WHERE id(n) == &#34;200000010265&#34;
</span></span><span class="line"><span class="cl">OPTIONAL MATCH p_shared_d=(n)-[:used_device]-&gt;(d)&lt;-[:used_device]-(:applicant)-[:with_phone_num]-&gt;(pn:phone_num)&lt;-[e:with_phone_num]-(:applicant)
</span></span><span class="line"><span class="cl">RETURN count(e)
</span></span></code></pre></td></tr></table>
</div>
</div><p>如此，我们可以建立一个相对有效的风控系统，利用有限的标注数据和专家资源，去更高效控制团伙欺诈作案风险。</p>
<p>另一个利用标注风险节点的查询是找到相关联节点高风险属性的数量：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MATCH p_=(p:applicant)-[*1..2]-(p2:applicant) WHERE id(p)==&#34;200000014810&#34; AND p2.applicant.is_risky == &#34;True&#34; RETURN p_ LIMIT 100
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以从这个路径查询看到 <code>200000014810</code> 的相连接的申请人中有不少是高风险的（也能看出聚集的 device）。</p>
<p><a class="lightgallery" href="/fraud-detection-with-nebulagraph/is_risky_label.webp" title="/fraud-detection-with-nebulagraph/is_risky_label.webp" data-thumbnail="/fraud-detection-with-nebulagraph/is_risky_label.webp">
        
    </a></p>
<p>如此，我们可以定义相连高风险点数量为一个指标：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MATCH (p:applicant)-[*1..2]-(p2:applicant) WHERE id(p)==&#34;200000014810&#34; AND p2.applicant.is_risky == &#34;True&#34; RETURN count(p2)
</span></span></code></pre></td></tr></table>
</div>
</div><p>然而，在现实情况下，我们的大多数标注数据的获取还是过于昂贵，那么有没有什么方法是更有效利用有限的风险标注和图结构，来预测出风险呢？</p>
<h3 id="利用图扩充标注" class="headerLink">
    <a href="#%e5%88%a9%e7%94%a8%e5%9b%be%e6%89%a9%e5%85%85%e6%a0%87%e6%b3%a8" class="header-mark"></a>1.3 利用图扩充标注</h3><p>答案是肯定的， Xiaojin Z. 和 Zoubin G. 在论文：<a href="http://mlg.eng.cam.ac.uk/zoubin/papers/CMU-CALD-02-107.pdf" target="_blank" rel="noopener noreferrer">Learning from Labeled and Unlabeled Data with Label Propagation</a> （CMU-CALD-02-107）中，利用标签传播（Label Propagation）算法来把有限的标注信息在图上通过关联关系传播到更多实体中。</p>
<p>这样，在我们建立的图谱中，我们可以很容易地借助有限的高风险标注，去“传播”产生更多的标注信息。这些扩展出来的标注信息一方面可以在实时的图查询中给出更多的结果，另一方面，它还能作为风控专家重要的输入信息，帮助推进反欺诈调查行动的开展。</p>
<p>一般来说，我们可以通过定期离线地全图扫描数据，通过图算法扩充、更新标注，再将有效的更新标注写回到图谱之中。</p>
<blockquote>
<p>注，类似的方法还有 SIGNDiffusion，感兴趣的同学可以去了解一下。</p>
</blockquote>
<h4 id="图算法扩充欺诈风险标注的示例" class="headerLink">
    <a href="#%e5%9b%be%e7%ae%97%e6%b3%95%e6%89%a9%e5%85%85%e6%ac%ba%e8%af%88%e9%a3%8e%e9%99%a9%e6%a0%87%e6%b3%a8%e7%9a%84%e7%a4%ba%e4%be%8b" class="header-mark"></a>1.3.1 图算法扩充欺诈风险标注的示例</h4><p>下面，我给出一个可以跑通的案例：</p>
<p>这个例子中，我用到了 Yelp 这个欺诈识别的经典数据，这份数据不只会用在这个例子中，后边 GNN 方法中的案例我也会用到它，所以大家可以耐心把数据导入 NebulaGraph。</p>
<p>导入数据到图库</p>
<blockquote>
<p>生成导入的方法在这里，https://github.com/wey-gu/nebulagraph-yelp-frauddetection</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~
</span></span><span class="line"><span class="cl">git clone https://github.com/wey-gu/nebulagraph-yelp-frauddetection
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> nebulagraph-yelp-frauddetection
</span></span><span class="line"><span class="cl">python3 -m pip install -r requirements.txt
</span></span><span class="line"><span class="cl">python3 data_download.py
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 导入图库</span>
</span></span><span class="line"><span class="cl">docker run --rm -ti <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --network<span class="o">=</span>nebula-net <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/yelp_nebulagraph_importer.yaml:/root/importer.yaml <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/data:/root <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    vesoft/nebula-importer:v3.1.0 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --config /root/importer.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><p>结束之后，我们可以看一下图上的统计：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~/.nebula-up/console.sh -e <span class="s2">&#34;USE yelp; SHOW STATS&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后，我们可以看到：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">(</span>root@nebula<span class="o">)</span> <span class="o">[(</span>none<span class="o">)]</span>&gt; USE yelp<span class="p">;</span> SHOW STATS
</span></span><span class="line"><span class="cl">+---------+---------------------------------------+---------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> Type    <span class="p">|</span> Name                                  <span class="p">|</span> Count   <span class="p">|</span>
</span></span><span class="line"><span class="cl">+---------+---------------------------------------+---------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="s2">&#34;Tag&#34;</span>   <span class="p">|</span> <span class="s2">&#34;review&#34;</span>                              <span class="p">|</span> <span class="m">45954</span>   <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="s2">&#34;Edge&#34;</span>  <span class="p">|</span> <span class="s2">&#34;shares_restaurant_in_one_month_with&#34;</span> <span class="p">|</span> <span class="m">1147232</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="s2">&#34;Edge&#34;</span>  <span class="p">|</span> <span class="s2">&#34;shares_restaurant_rating_with&#34;</span>       <span class="p">|</span> <span class="m">6805486</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="s2">&#34;Edge&#34;</span>  <span class="p">|</span> <span class="s2">&#34;shares_user_with&#34;</span>                    <span class="p">|</span> <span class="m">98630</span>   <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="s2">&#34;Space&#34;</span> <span class="p">|</span> <span class="s2">&#34;vertices&#34;</span>                            <span class="p">|</span> <span class="m">45954</span>   <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="s2">&#34;Space&#34;</span> <span class="p">|</span> <span class="s2">&#34;edges&#34;</span>                               <span class="p">|</span> <span class="m">8051348</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl">+---------+---------------------------------------+---------+
</span></span><span class="line"><span class="cl">Got <span class="m">6</span> rows <span class="o">(</span><span class="nb">time</span> spent 1911/4488 us<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>目前，市面上的 LPA 标签传播算法都是用来做社区检测的，很少有实现是用来做标签拓展的（只有 SK-Learn 中有这个实现），这里，我们参考 <a href="https://datascience.stackexchange.com/users/77683/thibaud-m" target="_blank" rel="noopener noreferrer">Thibaud M</a> 给出来的实现。</p>
<blockquote>
<p>原始的讨论参考：https://datascience.stackexchange.com/a/55720/138720</p>
</blockquote>
<p>为了让这个算法跑的快一点，会从 NebulaGraph 里取一个点的子图，在这个小的子图上做标注的扩充：</p>
<p>首先，我们启动一个 Jupyter 的 Playground，</p>
<blockquote>
<p>参考 <a href="https://github.com/wey-gu/nebula-dgl" target="_blank" rel="noopener noreferrer">https://github.com/wey-gu/nebula-dgl</a> 中的 Playground 过程：</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/wey-gu/nebula-dgl.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> nebula-dgl
</span></span><span class="line"><span class="cl"><span class="c1"># 运行 Jupyter Notebook</span>
</span></span><span class="line"><span class="cl">docker run -it --name dgl -p 8888:8888 --network nebula-net <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="s2">&#34;</span><span class="nv">$PWD</span><span class="s2">&#34;</span>:/home/jovyan/work jupyter/datascience-notebook <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    start-notebook.sh --NotebookApp.token<span class="o">=</span><span class="s1">&#39;nebulagraph&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>访问：http://localhost:8888/lab/tree/work?token=nebulagraph</p>
<p>安装依赖（这些依赖在后边的 GNN 例子中也会被用到）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">!</span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vesoft</span><span class="o">-</span><span class="n">inc</span><span class="o">/</span><span class="n">nebula</span><span class="o">-</span><span class="n">python</span><span class="o">.</span><span class="n">git</span><span class="o">@</span><span class="mi">8</span><span class="n">c328c534413b04ccecfd42e64ce6491e09c6ca8</span>
</span></span><span class="line"><span class="cl"><span class="err">!</span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">.</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后，我们从图中读取一个子图，从 <code>2048</code> 这个点开始探索两步内的所有边。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">tensor</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">dgl</span> <span class="kn">import</span> <span class="n">DGLHeteroGraph</span><span class="p">,</span> <span class="n">heterograph</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">nebula3.gclient.net</span> <span class="kn">import</span> <span class="n">ConnectionPool</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">nebula3.Config</span> <span class="kn">import</span> <span class="n">Config</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">config</span><span class="o">.</span><span class="n">max_connection_pool_size</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">connection_pool</span> <span class="o">=</span> <span class="n">ConnectionPool</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">connection_pool</span><span class="o">.</span><span class="n">init</span><span class="p">([(</span><span class="s1">&#39;graphd&#39;</span><span class="p">,</span> <span class="mi">9669</span><span class="p">)],</span> <span class="n">config</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">vertex_id</span> <span class="o">=</span> <span class="mi">2048</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">connection_pool</span><span class="o">.</span><span class="n">get_session</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="s1">&#39;nebula&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">execute_json</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;USE yelp;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="sa">f</span><span class="s2">&#34;GET SUBGRAPH WITH PROP 2 STEPS FROM </span><span class="si">{</span><span class="n">vertex_id</span><span class="si">}</span><span class="s2"> YIELD VERTICES AS nodes, EDGES AS relationships;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="p">[{}])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">columns</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="p">[{}])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create node and nodedata</span>
</span></span><span class="line"><span class="cl"><span class="n">node_id_map</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># key: vertex id in NebulaGraph, value: node id in dgl_graph</span>
</span></span><span class="line"><span class="cl"><span class="n">node_idx</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">features</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[[]]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;meta&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">        <span class="n">nodeid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;meta&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">nodeid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node_id_map</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">node_id_map</span><span class="p">[</span><span class="n">nodeid</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_idx</span>
</span></span><span class="line"><span class="cl">            <span class="n">node_idx</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">features</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;row&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="sa">f</span><span class="s2">&#34;review.f</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">features</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;row&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;review.is_fraud&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rur_start</span><span class="p">,</span> <span class="n">rur_end</span><span class="p">,</span> <span class="n">rsr_start</span><span class="p">,</span> <span class="n">rsr_end</span><span class="p">,</span> <span class="n">rtr_start</span><span class="p">,</span> <span class="n">rtr_end</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;meta&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">edge</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shares_user_with&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">rur_start</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">            <span class="n">rur_end</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;dst&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">rsr_start</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">            <span class="n">rsr_end</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;dst&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">rtr_start</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">            <span class="n">rtr_end</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;dst&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">rur_start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_dict</span><span class="p">[(</span><span class="s1">&#39;review&#39;</span><span class="p">,</span> <span class="s1">&#39;shares_user_with&#39;</span><span class="p">,</span> <span class="s1">&#39;review&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rur_start</span><span class="p">),</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rur_end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">rsr_start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_dict</span><span class="p">[(</span><span class="s1">&#39;review&#39;</span><span class="p">,</span> <span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">,</span> <span class="s1">&#39;review&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rsr_start</span><span class="p">),</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rsr_end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">rtr_start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_dict</span><span class="p">[(</span><span class="s1">&#39;review&#39;</span><span class="p">,</span> <span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">,</span> <span class="s1">&#39;review&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rtr_start</span><span class="p">),</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rtr_end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># construct a dgl_graph, ref: https://docs.dgl.ai/en/0.9.x/generated/dgl.heterograph.html</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dgl_graph</span><span class="p">:</span> <span class="n">DGLHeteroGraph</span> <span class="o">=</span> <span class="n">heterograph</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># load node features to dgl_graph</span>
</span></span><span class="line"><span class="cl"><span class="n">dgl_graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="mi">32</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># heterogeneous graph to heterogeneous graph, keep ndata and edata</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">dgl</span>
</span></span><span class="line"><span class="cl"><span class="n">hg</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">to_homogeneous</span><span class="p">(</span><span class="n">dgl_graph</span><span class="p">,</span> <span class="n">ndata</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后，我们用上边提到的 Torch Label Spreading 实现，应用到我们的图上。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">abstractmethod</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BaseLabelPropagation</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Base class for label propagation models.
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Parameters
</span></span></span><span class="line"><span class="cl"><span class="s2">    ----------
</span></span></span><span class="line"><span class="cl"><span class="s2">    adj_matrix: torch.FloatTensor
</span></span></span><span class="line"><span class="cl"><span class="s2">        Adjacency matrix of the graph.
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">adj_matrix</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">norm_adj_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">n_nodes</span> <span class="o">=</span> <span class="n">adj_matrix</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot_labels</span> <span class="o">=</span> <span class="kc">None</span> 
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">labeled_mask</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@staticmethod</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@abstractmethod</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_normalize</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&#34;_normalize must be implemented&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@abstractmethod</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_propagate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&#34;_propagate must be implemented&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_one_hot_encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Get the number of classes</span>
</span></span><span class="line"><span class="cl">        <span class="n">classes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">classes</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="n">classes</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># One-hot encode labeled data instances and zero rows corresponding to unlabeled instances</span>
</span></span><span class="line"><span class="cl">        <span class="n">unlabeled_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">labels</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>  <span class="c1"># defensive copying</span>
</span></span><span class="line"><span class="cl">        <span class="n">labels</span><span class="p">[</span><span class="n">unlabeled_mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">one_hot_labels</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot_labels</span><span class="p">[</span><span class="n">unlabeled_mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">labeled_mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">unlabeled_mask</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">,</span> <span class="n">tol</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;Fits a semi-supervised learning label propagation model.
</span></span></span><span class="line"><span class="cl"><span class="s2">        
</span></span></span><span class="line"><span class="cl"><span class="s2">        labels: torch.LongTensor
</span></span></span><span class="line"><span class="cl"><span class="s2">            Tensor of size n_nodes indicating the class number of each node.
</span></span></span><span class="line"><span class="cl"><span class="s2">            Unlabeled nodes are denoted with -1.
</span></span></span><span class="line"><span class="cl"><span class="s2">        max_iter: int
</span></span></span><span class="line"><span class="cl"><span class="s2">            Maximum number of iterations allowed.
</span></span></span><span class="line"><span class="cl"><span class="s2">        tol: float
</span></span></span><span class="line"><span class="cl"><span class="s2">            Convergence tolerance: threshold to consider the system at steady state.
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_one_hot_encode</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">one_hot_labels</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">prev_predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Stop iterations if the system is considered at a steady state</span>
</span></span><span class="line"><span class="cl">            <span class="n">variation</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">prev_predictions</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">variation</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;The method stopped after </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> iterations, variation=</span><span class="si">{</span><span class="n">variation</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">prev_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">_propagate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">predict_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">indices</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LabelPropagation</span><span class="p">(</span><span class="n">BaseLabelPropagation</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">adj_matrix</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@staticmethod</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_normalize</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;Computes D^-1 * W&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">degs</span> <span class="o">=</span> <span class="n">adj_matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">degs</span><span class="p">[</span><span class="n">degs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># avoid division by 0 error</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">adj_matrix</span> <span class="o">/</span> <span class="n">degs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_propagate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">norm_adj_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Put back already known labels</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_mask</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">one_hot_labels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_mask</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LabelSpreading</span><span class="p">(</span><span class="n">BaseLabelPropagation</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">adj_matrix</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@staticmethod</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_normalize</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;Computes D^-1/2 * W * D^-1/2&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">degs</span> <span class="o">=</span> <span class="n">adj_matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">norm</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">degs</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">norm</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">norm</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">adj_matrix</span> <span class="o">*</span> <span class="n">norm</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">norm</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_propagate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">norm_adj_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">one_hot_labels</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        Parameters
</span></span></span><span class="line"><span class="cl"><span class="s2">        ----------
</span></span></span><span class="line"><span class="cl"><span class="s2">        alpha: float
</span></span></span><span class="line"><span class="cl"><span class="s2">            Clamping factor.
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nx_hg</span> <span class="o">=</span> <span class="n">hg</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">adj_matrix</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">nx_hg</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">labels</span> <span class="o">=</span> <span class="n">hg</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Create input tensors</span>
</span></span><span class="line"><span class="cl"><span class="n">adj_matrix_t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">labels_t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Learn with Label Propagation</span>
</span></span><span class="line"><span class="cl"><span class="n">label_propagation</span> <span class="o">=</span> <span class="n">LabelPropagation</span><span class="p">(</span><span class="n">adj_matrix_t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Label Propagation: &#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">label_propagation</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">labels_t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">label_propagation_output_labels</span> <span class="o">=</span> <span class="n">label_propagation</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Learn with Label Spreading</span>
</span></span><span class="line"><span class="cl"><span class="n">label_spreading</span> <span class="o">=</span> <span class="n">LabelSpreading</span><span class="p">(</span><span class="n">adj_matrix_t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Label Spreading: &#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">label_spreading</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">labels_t</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">label_spreading_output_labels</span> <span class="o">=</span> <span class="n">label_spreading</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>现在咱们看看染色的传播效果：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">color_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&#34;blue&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&#34;green&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">input_labels_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">color_map</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">)]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">lprop_labels_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">color_map</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">)]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">label_propagation_output_labels</span><span class="o">.</span><span class="n">numpy</span><span class="p">()]</span>
</span></span><span class="line"><span class="cl"><span class="n">lspread_labels_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">color_map</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">)]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">label_spreading_output_labels</span><span class="o">.</span><span class="n">numpy</span><span class="p">()]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&#34;Raw data (2 classes)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&#34;Label Propagation&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&#34;Label Spreading&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">nx_hg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">nx_hg</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">input_labels_colors</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">nx_hg</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">lprop_labels_colors</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">nx_hg</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">lspread_labels_colors</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Legend</span>
</span></span><span class="line"><span class="cl"><span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&#34;off&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">legend_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;orange&#34;</span><span class="p">,</span> <span class="s2">&#34;blue&#34;</span><span class="p">,</span> <span class="s2">&#34;green&#34;</span><span class="p">,</span> <span class="s2">&#34;red&#34;</span><span class="p">,</span> <span class="s2">&#34;cyan&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;unlabeled&#34;</span><span class="p">,</span> <span class="s2">&#34;class 0&#34;</span><span class="p">,</span> <span class="s2">&#34;class 1&#34;</span><span class="p">,</span> <span class="s2">&#34;class 2&#34;</span><span class="p">,</span> <span class="s2">&#34;class 3&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">dummy_legend</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">legend_colors</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">dummy_legend</span><span class="p">,</span> <span class="n">legend_labels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到最后画出来的结果：</p>
<p><a class="lightgallery" href="./lpa_spread_notation_matplot.webp" title="./lpa_spread_notation_matplot.webp" data-thumbnail="./lpa_spread_notation_matplot.webp">
        
    </a></p>
<p>可以看到有一些蓝色标签被 Spread 开了，实际上我的这个例子的效果并不理想（因为这个例子李，绿色的才是重要的标签），不过我给的子图实在是太小了，也本不应该奢求有好的结果，只是为了个大家演示一下这个方法。</p>
<h3 id="带有图特征的机器学习" class="headerLink">
    <a href="#%e5%b8%a6%e6%9c%89%e5%9b%be%e7%89%b9%e5%be%81%e7%9a%84%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0" class="header-mark"></a>1.4 带有图特征的机器学习</h3><p>在风控领域开始利用图的思想和能力之前，已经有很多利用机器学习的分类算法基于历史数据预测高风险行为的方法了，这些方法把记录中领域专家认为有关的信息（例如：年龄、学历、收入）作为特征，历史标注信息作为标签去训练风险预测模型。</p>
<p>那么读到的这里，我们是否会想到在这些方法的基础之上，如果把基于图结构的属性也考虑进来，作为特征去训练的模型可能更有效呢？答案也是肯定的，已经有很多论文和工程实践揭示这样的模型比未考虑图特征的算法更加有效：这些被尝试有效的图结构特征可能是实体的 PageRank 值、Degree 值或者是某一个社区发现算法得出的社区 id。</p>
<p>在生产上，我们可以定期从图谱中获得实时的全图信息，在图计算平台中分析运算获得所需特征，经过预定的数据管道，导入机器学习模型中周期获得新的风险提示，并将部分结果写回图谱方便其他系统和专家抽取、参考。</p>
<h4 id="带有图特征的机器学习欺诈检测示例" class="headerLink">
    <a href="#%e5%b8%a6%e6%9c%89%e5%9b%be%e7%89%b9%e5%be%81%e7%9a%84%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e6%ac%ba%e8%af%88%e6%a3%80%e6%b5%8b%e7%a4%ba%e4%be%8b" class="header-mark"></a>1.4.1 带有图特征的机器学习欺诈检测示例</h4><p>这里，机器学习的方法我就不演示了，就是常见的分类方法，在此之上，我们可以在数据中通过图算法获得一些新的属性，这些属性再处理一下作为新的特征。我只演示一个社区发现的方法，我们可以对全图跑一个 Louvain，得出不同节点的社区归属，然后把社区的值当做一个分类处理成为数值的特征。</p>
<p>这个例子里我们还用 <a href="https://github.com/wey-gu/fraud-detection-datagen" target="_blank" rel="noopener noreferrer">https://github.com/wey-gu/fraud-detection-datagen</a> 这个数据，在此基础上，这个例子我用到了 <a href="https://github.com/vesoft-inc/nebula-algorithm/" target="_blank" rel="noopener noreferrer">Nebula-Algorithm</a> 这个项目，它是一个 Spark 应用，可以在 NebulaGraph 图库上运行很多常用的图算法。</p>
<p>首先，我们部署 Spark 和 Nebula Algorithm，还是利用 Nebula-UP，一键部署：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -fsSL nebula-up.siwei.io/all-in-one.sh <span class="p">|</span> bash -s -- v3 spark
</span></span></code></pre></td></tr></table>
</div>
</div><p>集群起来之后，因为需要的配置文件我已经放在了 Nebula-UP 内部，我们只需要一行就可以运行算法啦！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~/.nebula-up/nebula-up/spark <span class="o">&amp;&amp;</span> ls -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it sparkmaster /spark/bin/spark-submit <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --master <span class="s2">&#34;local&#34;</span> --conf spark.rpc.askTimeout<span class="o">=</span>6000s <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --class com.vesoft.nebula.algorithm.Main <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --driver-memory 4g /root/download/nebula-algo.jar <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -p /root/louvain.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>而最终的结果就在 sparkmaster 容器内的 <code>/output</code> 里：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># docker exec -it sparkmaster bash</span>
</span></span><span class="line"><span class="cl">ls -l /output
</span></span></code></pre></td></tr></table>
</div>
</div><p>之后，我们可以对这个 Louvain 的图特征做一些处理，并开始传统的模型训练了。</p>
<h3 id="图神经网络的方法" class="headerLink">
    <a href="#%e5%9b%be%e7%a5%9e%e7%bb%8f%e7%bd%91%e7%bb%9c%e7%9a%84%e6%96%b9%e6%b3%95" class="header-mark"></a>1.5 图神经网络的方法</h3><p>然而，这些图特征的方法的问题在于：</p>
<ol>
<li>图特征并不能把关联关系，数据的局部性充分反映到我们的模型、方法里；</li>
<li>图的特征工程是很昂贵、繁琐的。</li>
</ol>
<p>在最近几年的成果中，基于 GNN 的方法通过将图结构与属性信息进行嵌入表示，使得我们能在不进行图特征抽取、特征工程、专家与工程方法的数据标注的情况下，得到相比于基于传统图特征的机器学习更好的效果。有意思的是，现在正是这些方法快速被发现、演进的时期，基于图的深度学习是之前几年最热门的机器学习研究方向之一。</p>
<p>同时，图深度学习的一些方法可以做到 Inductive Learning——模型可以在新的点、边上进行推理，这样，配合图数据库上线上的子图查询能力，在线实时的风险预测也变得很简单可行了。</p>
<h4 id="基于图表示的图神经网络欺诈检测系统示例" class="headerLink">
    <a href="#%e5%9f%ba%e4%ba%8e%e5%9b%be%e8%a1%a8%e7%a4%ba%e7%9a%84%e5%9b%be%e7%a5%9e%e7%bb%8f%e7%bd%91%e7%bb%9c%e6%ac%ba%e8%af%88%e6%a3%80%e6%b5%8b%e7%b3%bb%e7%bb%9f%e7%a4%ba%e4%be%8b" class="header-mark"></a>1.5.1 基于图表示的图神经网络欺诈检测系统示例</h4><p>利用 GNN 的方法中，图数据库并不是必须的，数据的存储可以在其他几种常见的介质之中，但是图库能够最大化助益模型训练、模型更新、线上结果的更新。当我们把图数据库作为数据的单一数据来源（single source of truth）的时候，所有的基于线上、离线、图谱的方法可以很容易被集成起来，从而组合所有方法的优势与结果，做出更有效的欺诈检测复合系统。</p>
<p>在这个示例中我们一样分为：<strong>数据处理</strong>、<strong>模型训练</strong>、<strong>构建检测系统</strong>这几部分。</p>
<blockquote>
<p>注，这里，我们使用的的工具为 Deep Graph library（DGL），NebulaGraph 图数据库和他们之间的桥梁，Nebula-DGL。</p>
<ul>
<li>DGL: <a href="https://www.dgl.ai/" target="_blank" rel="noopener noreferrer">https://www.dgl.ai/</a></li>
<li>Nebula-DGL: <a href="https://github.com/wey-gu/nebula-dgl" target="_blank" rel="noopener noreferrer">https://github.com/wey-gu/nebula-dgl</a> 我也是这个库的作者 😁</li>
</ul>
</blockquote>
<h5 id="数据集" class="headerLink">
    <a href="#%e6%95%b0%e6%8d%ae%e9%9b%86" class="header-mark"></a>1.5.1.1 数据集</h5><p>本例中，我们使用的数据集是 Yelp-Fraud，他直接来自于论文 <a href="https://paperswithcode.com/paper/enhancing-graph-neural-network-based-fraud" target="_blank" rel="noopener noreferrer">Enhancing Graph Neural Network-based Fraud Detectors against Camouflaged Fraudsters</a>。</p>
<p>这个图中有一种点，三种关系：</p>
<ul>
<li>顶点：来自 Yelp 中的餐厅、酒店的评价，有两类属性：
<ul>
<li>每一个评价中有被标注了的是否是虚假、欺诈评价的标签</li>
<li>32 个已经被处理过的数字型属性</li>
</ul>
</li>
<li>边：三类评价之间的关联关系
<ul>
<li>R-U-R：两个评价由同一个用户发出 shares_user_with</li>
<li>R-S-R：两个评价是同餐厅同评分（评分可以是1到5） shares_restaurant_rating_with</li>
<li>R-T-R：两个评价是同餐厅同提交月份 shares_restaurant_in_one_month_with</li>
</ul>
</li>
</ul>
<p>在开始之前，我们假设这个图已经在我们的 NebulaGraph 里边了。</p>
<blockquote>
<p>注，我已经帮大家提前做好了将这张图导入 NebulaGraph 的工作，长话短说就是：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 部署 NebulaGraph</span>
</span></span><span class="line"><span class="cl">curl -fsSL nebula-up.siwei.io/install.sh <span class="p">|</span> bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 拉取这个数据的 Repo</span>
</span></span><span class="line"><span class="cl">git clone https://github.com/wey-gu/nebulagraph-yelp-frauddetection <span class="o">&amp;&amp;</span> <span class="nb">cd</span> nebulagraph-yelp-frauddetection
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 安装依赖，执行数据下载生成</span>
</span></span><span class="line"><span class="cl">python3 -m pip install -r requirements.txt
</span></span><span class="line"><span class="cl">python3 data_download.py
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 导入到 NebulaGraph</span>
</span></span><span class="line"><span class="cl">docker run --rm -ti <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --network<span class="o">=</span>nebula-net <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/yelp_nebulagraph_importer.yaml:/root/importer.yaml <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/data:/root <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> vesoft/nebula-importer:v3.1.0 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span> --config /root/importer.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><p>详情参考：https://github.com/wey-gu/nebulagraph-yelp-frauddetection</p>
</blockquote>
<h5 id="数据处理" class="headerLink">
    <a href="#%e6%95%b0%e6%8d%ae%e5%a4%84%e7%90%86" class="header-mark"></a>1.5.1.2 数据处理</h5><p>这部分的任务是将图谱中和风险相关子图的拓扑结构表示和其中有关的特征（属性）进行工程处理，序列化成为 DGL 的图对象。</p>
<p>DGL 本身支持从点、边列表（edgelist）形式 CSV 文件，或者从 NetworkX 和 SciPy 的序列化稀疏的邻接矩阵（adjacency matrix）的数据来构造它的图对象，我们可以把原始的图数据或者图库中的数据全量导出为这些形式，不过在真实的例子中图库中的数据是实时变化的，能够直接在 NebulaGraph 中的子图上做 GNN 训练一般来说是更理想。得益于 Nebula-DGL 这个库，做这件事儿是很自然的。</p>
<blockquote>
<p>注，DGL 外部数据员导入文档：https://docs.dgl.ai/guide/graph-external.html</p>
</blockquote>
<p>现在我们开始这个数据的导入，在这之前，我先介绍一下 Nebula-DGL。</p>
<p>Nebula-DGL 可以根据给定的映射和转换规则（YAML 格式），将 NebulaGraph 中的顶点、边，和它们的属性按照规则处理成为点、边、和其中的标注（Label）与特征（Feature），从而构造为 DGL 的图对象。这其中，值得一提的是属性到特征的转换。我们知道，特征可能是某一个属性的值、一个或者多个属性的值做一定的数学变换、亦或是字符型的属性按照枚举规则输出为数字。相应的，Nebula-DGL 在规则中，我们都可以针对这几种情况利用 <code>filter</code> 进行表达：</p>
<ul>
<li>特征直接选取属性的值：</li>
</ul>
<p>这个例子里，NebulaGraph 图中 <code>follow</code> 这个边将被抽取，边上的属性 <code>degree</code> 的值将直接被作为名为 <code>degree</code> 的特征。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">edge_types</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">follow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">start_vertex_tag</span><span class="p">:</span><span class="w"> </span><span class="l">player</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">end_vertex_tag</span><span class="p">:</span><span class="w"> </span><span class="l">player</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">features</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">degree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">degree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="kc">False</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">filter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">value</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>特征从属性中经过数学变换</li>
</ul>
<p>这个例子中，我们把 <code>serve</code> 边之中的两个属性进行 <code>(end_year - start_year) / 30</code> 的处理，变为 <code>service_time</code> 这样的一个特征。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">edge_types</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">serve</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">start_vertex_tag</span><span class="p">:</span><span class="w"> </span><span class="l">player</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">end_vertex_tag</span><span class="p">:</span><span class="w"> </span><span class="l">team</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">features</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">service_time</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">start_year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="kc">False</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">end_year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="kc">False</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c"># The variable was mapped by order of properties</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">filter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">function</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">function</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;lambda start_year, end_year: (end_year - start_year) / 30&#34;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>枚举属性值为数字特征</li>
</ul>
<p>这个例子中，我们把 <code>team</code> 顶点中的 <code>name</code> 属性进行枚举，根据这个对于是西岸还是东岸：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">vertex_tags</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">team</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">features</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">coast</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">str</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="kc">False</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">filter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="c"># 0 stand for the east coast, 1 stand for the west coast</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">enumeration</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">enumeration</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">Celtics</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">Nets</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">Nuggets</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">Timberwolves</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">Thunder</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># ... not showing all teams here</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到这个转换规则非常简单直接，大家也可以参考 Nebula-DGL 的完整例子了解全部细节 <a href="https://github.com/wey-gu/nebula-dgl/tree/main/example" target="_blank" rel="noopener noreferrer">https://github.com/wey-gu/nebula-dgl/tree/main/example</a>。而有上边数据处理规则的了解之后，我们可以开始处理这个 Yelp 图数据了。</p>
<p>首先，定义如下规则，这里，我们把顶点 review 和三种边都对应过来了，同时，review 上的属性也按照原本的值对应了过来：</p>
<p><code>nebulagraph_yelp_dgl_mapper.yaml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># If vertex id is string-typed, remap_vertex_id must be true.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">remap_vertex_id</span><span class="p">:</span><span class="w"> </span><span class="kc">True</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">space</span><span class="p">:</span><span class="w"> </span><span class="l">yelp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># str or int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">vertex_id_type</span><span class="p">:</span><span class="w"> </span><span class="l">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">vertex_tags</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">review</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">label</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">is_fraud</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">is_fraud</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="kc">False</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">filter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">features</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">float</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="kc">False</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">filter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">float</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="kc">False</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">filter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># ...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f31</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f31</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">float</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="kc">False</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">filter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">edge_types</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">shares_user_with</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">start_vertex_tag</span><span class="p">:</span><span class="w"> </span><span class="l">review</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">end_vertex_tag</span><span class="p">:</span><span class="w"> </span><span class="l">review</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">shares_restaurant_rating_with</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">start_vertex_tag</span><span class="p">:</span><span class="w"> </span><span class="l">review</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">end_vertex_tag</span><span class="p">:</span><span class="w"> </span><span class="l">review</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">shares_restaurant_in_one_month_with</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">start_vertex_tag</span><span class="p">:</span><span class="w"> </span><span class="l">review</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">end_vertex_tag</span><span class="p">:</span><span class="w"> </span><span class="l">review</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>然后，我们在安装好 Nebula-DGL 之后只需要这几行代码就可以将 NebulaGraph 中的这张图构造为 DGL 的 <code>DGLHeteroGraph</code> 图对象：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">nebula_dgl</span> <span class="kn">import</span> <span class="n">NebulaLoader</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nebula_config</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;graph_hosts&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s1">&#39;graphd&#39;</span><span class="p">,</span> <span class="mi">9669</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s1">&#39;graphd1&#39;</span><span class="p">,</span> <span class="mi">9669</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s1">&#39;graphd2&#39;</span><span class="p">,</span> <span class="mi">9669</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;nebula_user&#34;</span><span class="p">:</span> <span class="s2">&#34;root&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;nebula_password&#34;</span><span class="p">:</span> <span class="s2">&#34;nebula&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># load feature_mapper from yaml file</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;nebulagraph_yelp_dgl_mapper.yaml&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">feature_mapper</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nebula_loader</span> <span class="o">=</span> <span class="n">NebulaLoader</span><span class="p">(</span><span class="n">nebula_config</span><span class="p">,</span> <span class="n">feature_mapper</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span> <span class="n">nebula_loader</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="模型训练" class="headerLink">
    <a href="#%e6%a8%a1%e5%9e%8b%e8%ae%ad%e7%bb%83" class="header-mark"></a>1.5.1.3 模型训练</h5><p>这里，我用 <a href="https://cs.stanford.edu/people/jure/pubs/graphsage-nips17.pdf" target="_blank" rel="noopener noreferrer">GraphSAGE</a> 算法的点分类（Node Classification）方法来举例，GraphSAGE 的原始版本是一个归纳学习（Inductive Learning）的算法，这里，归纳学习区别于它的反面： Transductive Learning ，可以把新的数据用在完全旧的图之上习得的模型，这样训练出来的模型可以进行线上增量数据的欺诈检测（而不是需要重新加载为全图训练才可以）。</p>
<p><a class="lightgallery" href="https://user-images.githubusercontent.com/1651790/182301784-21850dac-0d47-4dd5-b66f-a28b87fe9d4d.svg" title="GraphSAGE_FraudDetection" data-thumbnail="https://user-images.githubusercontent.com/1651790/182301784-21850dac-0d47-4dd5-b66f-a28b87fe9d4d.svg">
        
    </a></p>
<p>模型训练系统（左边）：</p>
<ul>
<li>输入：带有欺诈标注的历史交易图谱</li>
<li>输出：一个 GraphSAGE 的 DGL 模型</li>
</ul>
<p>线上推理系统（右边）：</p>
<ul>
<li>
<p>模型：基于带有欺诈标注的历史交易图谱基于 GraphSAGE 训练</p>
</li>
<li>
<p>输入：一笔新的交易</p>
</li>
<li>
<p>输出：这笔交易是否涉嫌欺诈</p>
</li>
</ul>
<p><strong>分割数据集</strong></p>
<p>机器学习训练的过程需要在已经有的数据、信息中分割出用来训练、验证和测试的子集，他们可以是不相交的整体数据的真子集也可以彼此有重叠，在实际的情况中，有时候我们对数据的标注常常是不充分的，所以按照标注的比例去分割数据可能更有意义一些，下边的例子是我按照点上是否标注欺诈为标准去分割数据集。</p>
<p>这里边有两个地方值得注意：</p>
<ol>
<li><code>train_test_split</code> 中的 <code>stratify=g.ndata['is_fraud']</code> 代表保持 <code>is_fraud</code> 的值的分布去分割，符合我们前边提到的思想。</li>
<li>我们分割的是 <code>idx</code> 索引，这样，可以最终获得三个集合的索引，供训练、验证和测试时候使用。同时我们还把对应集合 mask 放到图对象 <code>g</code> 里边去了。</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Split the graph into train, validation, and test sets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># features are g.ndata[&#39;f0&#39;], g.ndata[&#39;f1&#39;], g.ndata[&#39;f2&#39;], ... g.ndata[&#39;f31&#39;]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># label is in g.ndata[&#39;is_fraud&#39;]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># concatenate all features</span>
</span></span><span class="line"><span class="cl"><span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;f&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;is_fraud&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># numpy array as an index of range n</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># split based on value distribution of label: the property &#34;is_fraud&#34;, which is a binary variable.</span>
</span></span><span class="line"><span class="cl"><span class="n">X_train_and_val_idx</span><span class="p">,</span> <span class="n">X_test_idx</span><span class="p">,</span> <span class="n">y_train_and_val</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">idx</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;is_fraud&#39;</span><span class="p">],</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;is_fraud&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># split train and val</span>
</span></span><span class="line"><span class="cl"><span class="n">X_train_idx</span><span class="p">,</span> <span class="n">X_val_idx</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">X_train_and_val_idx</span><span class="p">,</span> <span class="n">y_train_and_val</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_train_and_val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># list of index to mask</span>
</span></span><span class="line"><span class="cl"><span class="n">train_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">train_mask</span><span class="p">[</span><span class="n">X_train_idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">val_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">val_mask</span><span class="p">[</span><span class="n">X_val_idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">test_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">test_mask</span><span class="p">[</span><span class="n">X_test_idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;train_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_mask</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;val_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_mask</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;test_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_mask</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>异构图转换为同构图</strong></p>
<p>GraphSAGE 是针对同构图，且边无 feature 的算法，而我们当下的 Yelp 图谱是异构的：一类点、三类边。那么，如何才能用 GraphSAGE 去建模 Yelp 图谱呢？</p>
<p>我们除了选择用其他针对异构图的 Inductive Learning 方法之外，还可想办法把同构图转换成异构图。为了在转换中不丢失重要的边类型信息，我们可以把边类型变成数值。</p>
<p>这里我给了一维的 edge feature，当然（3-1）二维也是可以的。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># shares_restaurant_in_one_month_with: 1, b&#34;001&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shares_restaurant_rating_with: 2, b&#34;010&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shares_user_with: 4, b&#34;100&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注：其实如果想用 0, 1, 2 这样的分布，转换到同构图之后的 <code>hg.edata['_TYPE']</code> 也是可以直接拿来用的，详见 <a href="https://docs.dgl.ai/en/0.9.x/generated/dgl.to_homogeneous.html" target="_blank" rel="noopener noreferrer">https://docs.dgl.ai/en/0.9.x/generated/dgl.to_homogeneous.html</a> 中的例子。</p>
</blockquote>
<p>代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># three types of edges</span>
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">g</span><span class="o">.</span><span class="n">etypes</span>
</span></span><span class="line"><span class="cl"><span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;shares_user_with&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">g</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">(</span><span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">(</span><span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">),),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;shares_user_with&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">(</span><span class="s1">&#39;shares_user_with&#39;</span><span class="p">),),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">g</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl"><span class="p">{(</span><span class="s1">&#39;review&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;review&#39;</span><span class="p">):</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="s1">&#39;review&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;review&#39;</span><span class="p">):</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>  <span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="s1">&#39;review&#39;</span><span class="p">,</span> <span class="s1">&#39;shares_user_with&#39;</span><span class="p">,</span> <span class="s1">&#39;review&#39;</span><span class="p">):</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>  <span class="o">...</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>参考：https://discuss.dgl.ai/t/how-to-convert-from-a-heterogeneous-graph-to-a-homogeneous-graph-with-data/2764</p>
</blockquote>
<p>然后将它转换为同构图，把 <code>he</code> 作为要保留的 edata：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">hg</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">to_homogeneous</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">edata</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">],</span> <span class="n">ndata</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;train_mask&#39;</span><span class="p">,</span> <span class="s1">&#39;val_mask&#39;</span><span class="p">,</span> <span class="s1">&#39;test_mask&#39;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>参考：https://docs.dgl.ai/en/latest/guide/graph-heterogeneous.html?highlight=to_homogeneous#converting-heterogeneous-graphs-to-homogeneous-graphs</p>
</blockquote>
<p>默认的 GraphSAGE 实现是没考虑 edge feature 的，我们要修改消息传递的步骤，在后边会涉及到这部分的实操。</p>
<blockquote>
<p>参考：</p>
<ul>
<li><a href="https://discuss.dgl.ai/t/frequently-asked-questions-faq/1681" target="_blank" rel="noopener noreferrer">https://discuss.dgl.ai/t/frequently-asked-questions-faq/1681</a> （问题13）</li>
<li><a href="https://discuss.dgl.ai/t/using-node-and-edge-features-in-message-passing/762" target="_blank" rel="noopener noreferrer">https://discuss.dgl.ai/t/using-node-and-edge-features-in-message-passing/762</a></li>
</ul>
</blockquote>
<p><strong>模型训练代码</strong></p>
<p>DGL 官方给出了例子在：https://github.com/dmlc/dgl/tree/master/examples/pytorch/graphsage，我在测试的时候还修复了一个小 bug。</p>
<p>因为我们处理过的同构图里是带有 edge feature 的，不能照搬官方的 GraphSAGE 例子代码，我们有两种方法来处理它：</p>
<p>a. 可以稍微改动一下 <code>SAGEConv</code>消息传递的部分，以 mean 聚合的方式为例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl">  graph.update_all(msg_fn, fn.mean(&#39;m&#39;, &#39;neigh&#39;))
</span></span><span class="line"><span class="cl"><span class="gi">+ graph.update_all(fn.copy_e(&#39;he&#39;, &#39;m&#39;), fn.mean(&#39;m&#39;, &#39;neigh&#39;))
</span></span></span><span class="line"><span class="cl"><span class="gi"></span><span class="gd">- h_neigh = graph.dstdata[&#39;neigh&#39;]
</span></span></span><span class="line"><span class="cl"><span class="gd"></span><span class="gi">+ h_neigh = torch.cat((graph.dstdata[&#39;neigh&#39;], graph.dstdata[&#39;neigh_e&#39;].reshape(-1, 1)), 1)
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这个处理中，除了上边消息传递部分增加 edge feature 之外，还需要注意 feature 维度的处理。</p>
<p>b. 把边参数作为边权重 ，以 mean 聚合为例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"><span class="gd">- graph.update_all(msg_fn, fn.mean(&#39;m&#39;, &#39;neigh&#39;))
</span></span></span><span class="line"><span class="cl"><span class="gd"></span><span class="gi">+ # consdier datatype with different weight, g.edata[&#39;he&#39;] as weight here
</span></span></span><span class="line"><span class="cl"><span class="gi">+ g.update_all(fn.u_mul_e(&#39;h&#39;, &#39;he&#39;, &#39;m&#39;), fn.mean(&#39;m&#39;, &#39;h&#39;))
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>下边，我们以把边的类型作为权重的方式，<code>mean</code>作为聚合的情况为例来实操：</p>
<p>我们来继承，并覆盖<code>SAGEConv</code>：</p>
<blockquote>
<p>我们其实只是修改了 Message Passing 的部分。</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">dgl</span> <span class="kn">import</span> <span class="n">function</span> <span class="k">as</span> <span class="n">fn</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">dgl.utils</span> <span class="kn">import</span> <span class="n">check_eq_shape</span><span class="p">,</span> <span class="n">expand_as_pair</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SAGEConv</span><span class="p">(</span><span class="n">dglnn</span><span class="o">.</span><span class="n">SAGEConv</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">feat</span><span class="p">,</span> <span class="n">edge_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="sa">r</span><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">        Description
</span></span></span><span class="line"><span class="cl"><span class="s2">        -----------
</span></span></span><span class="line"><span class="cl"><span class="s2">        Compute GraphSAGE layer.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">        Parameters
</span></span></span><span class="line"><span class="cl"><span class="s2">        ----------
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph : DGLGraph
</span></span></span><span class="line"><span class="cl"><span class="s2">            The graph.
</span></span></span><span class="line"><span class="cl"><span class="s2">        feat : torch.Tensor or pair of torch.Tensor
</span></span></span><span class="line"><span class="cl"><span class="s2">            If a torch.Tensor is given, it represents the input feature of shape
</span></span></span><span class="line"><span class="cl"><span class="s2">            :math:`(N, D_</span><span class="si">{in}</span><span class="s2">)`
</span></span></span><span class="line"><span class="cl"><span class="s2">            where :math:`D_</span><span class="si">{in}</span><span class="s2">` is size of input feature, :math:`N` is the number of nodes.
</span></span></span><span class="line"><span class="cl"><span class="s2">            If a pair of torch.Tensor is given, the pair must contain two tensors of shape
</span></span></span><span class="line"><span class="cl"><span class="s2">            :math:`(N_</span><span class="si">{in}</span><span class="s2">, D_{in_</span><span class="si">{src}</span><span class="s2">})` and :math:`(N_</span><span class="si">{out}</span><span class="s2">, D_{in_</span><span class="si">{dst}</span><span class="s2">})`.
</span></span></span><span class="line"><span class="cl"><span class="s2">        edge_weight : torch.Tensor, optional
</span></span></span><span class="line"><span class="cl"><span class="s2">            Optional tensor on the edge. If given, the convolution will weight
</span></span></span><span class="line"><span class="cl"><span class="s2">            with regard to the message.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">        Returns
</span></span></span><span class="line"><span class="cl"><span class="s2">        -------
</span></span></span><span class="line"><span class="cl"><span class="s2">        torch.Tensor
</span></span></span><span class="line"><span class="cl"><span class="s2">            The output feature of shape :math:`(N_</span><span class="si">{dst}</span><span class="s2">, D_</span><span class="si">{out}</span><span class="s2">)`
</span></span></span><span class="line"><span class="cl"><span class="s2">            where :math:`N_</span><span class="si">{dst}</span><span class="s2">` is the number of destination nodes in the input graph,
</span></span></span><span class="line"><span class="cl"><span class="s2">            :math:`D_</span><span class="si">{out}</span><span class="s2">` is the size of the output feature.
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_compatibility_check</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">graph</span><span class="o">.</span><span class="n">local_scope</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">feat_src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feat_drop</span><span class="p">(</span><span class="n">feat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">                <span class="n">feat_dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feat_drop</span><span class="p">(</span><span class="n">feat</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">feat_src</span> <span class="o">=</span> <span class="n">feat_dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feat_drop</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">is_block</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">feat_dst</span> <span class="o">=</span> <span class="n">feat_src</span><span class="p">[:</span><span class="n">graph</span><span class="o">.</span><span class="n">number_of_dst_nodes</span><span class="p">()]</span>
</span></span><span class="line"><span class="cl">            <span class="n">msg_fn</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">copy_src</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">edge_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">assert</span> <span class="n">edge_weight</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">graph</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="s1">&#39;_edge_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_weight</span>
</span></span><span class="line"><span class="cl">                <span class="n">msg_fn</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">u_mul_e</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;_edge_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">h_self</span> <span class="o">=</span> <span class="n">feat_dst</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># Handle the case of graphs without edges</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;neigh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">feat_dst</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_in_src_feats</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">feat_dst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># Determine whether to apply linear transformation before message passing A(XW)</span>
</span></span><span class="line"><span class="cl">            <span class="n">lin_before_mp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_in_src_feats</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_out_feats</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># Message Passing</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggre_type</span> <span class="o">==</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">srcdata</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc_neigh</span><span class="p">(</span><span class="n">feat_src</span><span class="p">)</span> <span class="k">if</span> <span class="n">lin_before_mp</span> <span class="k">else</span> <span class="n">feat_src</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># graph.update_all(msg_fn, fn.mean(&#39;m&#39;, &#39;neigh&#39;))</span>
</span></span><span class="line"><span class="cl">                <span class="c1">#########################################################################</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># consdier datatype with different weight, g.edata[&#39;he&#39;] as weight here</span>
</span></span><span class="line"><span class="cl">                <span class="n">g</span><span class="o">.</span><span class="n">update_all</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">u_mul_e</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;he&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">fn</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="c1">#########################################################################</span>
</span></span><span class="line"><span class="cl">                <span class="n">h_neigh</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;neigh&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="ow">not</span> <span class="n">lin_before_mp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">h_neigh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc_neigh</span><span class="p">(</span><span class="n">h_neigh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggre_type</span> <span class="o">==</span> <span class="s1">&#39;gcn&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">check_eq_shape</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">srcdata</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc_neigh</span><span class="p">(</span><span class="n">feat_src</span><span class="p">)</span> <span class="k">if</span> <span class="n">lin_before_mp</span> <span class="k">else</span> <span class="n">feat_src</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>  <span class="c1"># heterogeneous</span>
</span></span><span class="line"><span class="cl">                    <span class="n">graph</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc_neigh</span><span class="p">(</span><span class="n">feat_dst</span><span class="p">)</span> <span class="k">if</span> <span class="n">lin_before_mp</span> <span class="k">else</span> <span class="n">feat_dst</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">is_block</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">graph</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">srcdata</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">][:</span><span class="n">graph</span><span class="o">.</span><span class="n">num_dst_nodes</span><span class="p">()]</span>
</span></span><span class="line"><span class="cl">                    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">graph</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">srcdata</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">update_all</span><span class="p">(</span><span class="n">msg_fn</span><span class="p">,</span> <span class="n">fn</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;neigh&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">update_all</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">copy_e</span><span class="p">(</span><span class="s1">&#39;he&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">fn</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;neigh&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># divide in_degrees</span>
</span></span><span class="line"><span class="cl">                <span class="n">degs</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">in_degrees</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">feat_dst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">h_neigh</span> <span class="o">=</span> <span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;neigh&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">graph</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">degs</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="ow">not</span> <span class="n">lin_before_mp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">h_neigh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc_neigh</span><span class="p">(</span><span class="n">h_neigh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggre_type</span> <span class="o">==</span> <span class="s1">&#39;pool&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">srcdata</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc_pool</span><span class="p">(</span><span class="n">feat_src</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">update_all</span><span class="p">(</span><span class="n">msg_fn</span><span class="p">,</span> <span class="n">fn</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;neigh&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">update_all</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">copy_e</span><span class="p">(</span><span class="s1">&#39;he&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">fn</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;neigh&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">h_neigh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc_neigh</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;neigh&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggre_type</span> <span class="o">==</span> <span class="s1">&#39;lstm&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">srcdata</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feat_src</span>
</span></span><span class="line"><span class="cl">                <span class="n">graph</span><span class="o">.</span><span class="n">update_all</span><span class="p">(</span><span class="n">msg_fn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lstm_reducer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">h_neigh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc_neigh</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;neigh&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Aggregator type </span><span class="si">{}</span><span class="s1"> not recognized.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_aggre_type</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># GraphSAGE GCN does not require fc_self.</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggre_type</span> <span class="o">==</span> <span class="s1">&#39;gcn&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">rst</span> <span class="o">=</span> <span class="n">h_neigh</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">rst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc_self</span><span class="p">(</span><span class="n">h_self</span><span class="p">)</span> <span class="o">+</span> <span class="n">h_neigh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># bias term</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">rst</span> <span class="o">=</span> <span class="n">rst</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># activation</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">rst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">(</span><span class="n">rst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># normalization</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">rst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">rst</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>定义模型</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SAGE</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_size</span><span class="p">,</span> <span class="n">hid_size</span><span class="p">,</span> <span class="n">out_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># three-layer GraphSAGE-mean</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dglnn</span><span class="o">.</span><span class="n">SAGEConv</span><span class="p">(</span><span class="n">in_size</span><span class="p">,</span> <span class="n">hid_size</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dglnn</span><span class="o">.</span><span class="n">SAGEConv</span><span class="p">(</span><span class="n">hid_size</span><span class="p">,</span> <span class="n">hid_size</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dglnn</span><span class="o">.</span><span class="n">SAGEConv</span><span class="p">(</span><span class="n">hid_size</span><span class="p">,</span> <span class="n">out_size</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">hid_size</span> <span class="o">=</span> <span class="n">hid_size</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">out_size</span> <span class="o">=</span> <span class="n">out_size</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">h</span> <span class="o">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span> <span class="n">blocks</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">            <span class="n">h</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">l</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">h</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">inference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;Conduct layer-wise inference to get all the node embeddings.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">feat</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">sampler</span> <span class="o">=</span> <span class="n">MultiLayerFullNeighborSampler</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">prefetch_node_feats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">g</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">device</span><span class="p">),</span> <span class="n">sampler</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">buffer_device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">pin_memory</span> <span class="o">=</span> <span class="p">(</span><span class="n">buffer_device</span> <span class="o">!=</span> <span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">g</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">hid_size</span> <span class="k">if</span> <span class="n">l</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_size</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">device</span><span class="o">=</span><span class="n">buffer_device</span><span class="p">,</span> <span class="n">pin_memory</span><span class="o">=</span><span class="n">pin_memory</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">feat</span> <span class="o">=</span> <span class="n">feat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">input_nodes</span><span class="p">,</span> <span class="n">output_nodes</span><span class="p">,</span> <span class="n">blocks</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">dataloader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">x</span> <span class="o">=</span> <span class="n">feat</span><span class="p">[</span><span class="n">input_nodes</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">h</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># len(blocks) = 1</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">l</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># by design, our output nodes are contiguous</span>
</span></span><span class="line"><span class="cl">                <span class="n">y</span><span class="p">[</span><span class="n">output_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">output_nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">buffer_device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">feat</span> <span class="o">=</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">y</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>定义训练、推理的函数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">y_hats</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">it</span><span class="p">,</span> <span class="p">(</span><span class="n">input_nodes</span><span class="p">,</span> <span class="n">output_nodes</span><span class="p">,</span> <span class="n">blocks</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataloader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">=</span> <span class="n">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">srcdata</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">y_hats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">MF</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">y_hats</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ys</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">layerwise_infer</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">inference</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span> <span class="c1"># pred in buffer_device</span>
</span></span><span class="line"><span class="cl">        <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">label</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">][</span><span class="n">nid</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">MF</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">train_idx</span><span class="p">,</span> <span class="n">val_idx</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># create sampler &amp; dataloader</span>
</span></span><span class="line"><span class="cl">    <span class="n">sampler</span> <span class="o">=</span> <span class="n">NeighborSampler</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  <span class="c1"># fanout for [layer-0, layer-1, layer-2]</span>
</span></span><span class="line"><span class="cl">                              <span class="n">prefetch_node_feats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                              <span class="n">prefetch_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">use_uva</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">train_idx</span><span class="p">,</span> <span class="n">sampler</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                  <span class="n">batch_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                  <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                  <span class="n">use_uva</span><span class="o">=</span><span class="n">use_uva</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">val_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">val_idx</span><span class="p">,</span> <span class="n">sampler</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                <span class="n">batch_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                <span class="n">use_uva</span><span class="o">=</span><span class="n">use_uva</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">opt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">total_loss</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">it</span><span class="p">,</span> <span class="p">(</span><span class="n">input_nodes</span><span class="p">,</span> <span class="n">output_nodes</span><span class="p">,</span> <span class="n">blocks</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">=</span> <span class="n">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">srcdata</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">y</span> <span class="o">=</span> <span class="n">blocks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">y_hat</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">total_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">acc</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Epoch </span><span class="si">{:05d}</span><span class="s2"> | Loss </span><span class="si">{:.4f}</span><span class="s2"> | Accuracy </span><span class="si">{:.4f}</span><span class="s2"> &#34;</span>
</span></span><span class="line"><span class="cl">              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">total_loss</span> <span class="o">/</span> <span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">acc</span><span class="o">.</span><span class="n">item</span><span class="p">()))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>从 NebulaGraph 中加载图到 DGL，得到的是一个异构图（一类点、三类边）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">nebula_dgl</span> <span class="kn">import</span> <span class="n">NebulaLoader</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nebula_config</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;graph_hosts&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s1">&#39;graphd&#39;</span><span class="p">,</span> <span class="mi">9669</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s1">&#39;graphd1&#39;</span><span class="p">,</span> <span class="mi">9669</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s1">&#39;graphd2&#39;</span><span class="p">,</span> <span class="mi">9669</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;nebula_user&#34;</span><span class="p">:</span> <span class="s2">&#34;root&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;nebula_password&#34;</span><span class="p">:</span> <span class="s2">&#34;nebula&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;nebulagraph_yelp_dgl_mapper.yaml&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">     <span class="n">feature_mapper</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nebula_loader</span> <span class="o">=</span> <span class="n">NebulaLoader</span><span class="p">(</span><span class="n">nebula_config</span><span class="p">,</span> <span class="n">feature_mapper</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span> <span class="n">nebula_loader</span><span class="o">.</span><span class="n">load</span><span class="p">()</span> <span class="c1"># This will take you some time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 作为穷人，我们用 CPU</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>分出训练、验证、测试集，然后转换成同构图。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Split the graph into train, validation and test sets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># features are g.ndata[&#39;f0&#39;], g.ndata[&#39;f1&#39;], g.ndata[&#39;f2&#39;], ... g.ndata[&#39;f31&#39;]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># label is in g.ndata[&#39;is_fraud&#39;]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># concatenate all features</span>
</span></span><span class="line"><span class="cl"><span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;is_fraud&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># numpy array as index of range n</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># features.append(idx)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># concatenate one dim with index of node</span>
</span></span><span class="line"><span class="cl"><span class="c1"># feature_and_idx = torch.stack(features, dim=1)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># split based on value distribution of label: the property &#34;is_fraud&#34;, which is a binary variable.</span>
</span></span><span class="line"><span class="cl"><span class="n">X_train_and_val_idx</span><span class="p">,</span> <span class="n">X_test_idx</span><span class="p">,</span> <span class="n">y_train_and_val</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">idx</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;is_fraud&#39;</span><span class="p">],</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;is_fraud&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># split train and val</span>
</span></span><span class="line"><span class="cl"><span class="n">X_train_idx</span><span class="p">,</span> <span class="n">X_val_idx</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">X_train_and_val_idx</span><span class="p">,</span> <span class="n">y_train_and_val</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_train_and_val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># list of index to mask</span>
</span></span><span class="line"><span class="cl"><span class="n">train_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">train_mask</span><span class="p">[</span><span class="n">X_train_idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">val_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">val_mask</span><span class="p">[</span><span class="n">X_val_idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">test_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">test_mask</span><span class="p">[</span><span class="n">X_test_idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;train_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_mask</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;val_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_mask</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;test_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_mask</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># shares_restaurant_in_one_month_with: 1, b&#34;001&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shares_restaurant_rating_with: 2, b&#34;010&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shares_user_with: 4, b&#34;100&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># set edata of shares_restaurant_in_one_month_with to n of 1 tensor array</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">g</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">(</span><span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">(</span><span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">),),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;shares_user_with&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">(</span><span class="s1">&#39;shares_user_with&#39;</span><span class="p">),),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># heterogeneous graph to heterogeneous graph, keep ndata and edata</span>
</span></span><span class="line"><span class="cl"><span class="n">hg</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">to_homogeneous</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">edata</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">],</span> <span class="n">ndata</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;train_mask&#39;</span><span class="p">,</span> <span class="s1">&#39;val_mask&#39;</span><span class="p">,</span> <span class="s1">&#39;test_mask&#39;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>训练、测试模型！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># create GraphSAGE model</span>
</span></span><span class="line"><span class="cl"><span class="n">in_size</span> <span class="o">=</span> <span class="n">hg</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">out_size</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">SAGE</span><span class="p">(</span><span class="n">in_size</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">out_size</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># model training</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Training...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">train</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">hg</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">X_train_idx</span><span class="p">,</span> <span class="n">X_val_idx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># test the model</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">acc</span> <span class="o">=</span> <span class="n">layerwise_infer</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">hg</span><span class="p">,</span> <span class="n">X_test_idx</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test Accuracy </span><span class="si">{:.4f}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">acc</span><span class="o">.</span><span class="n">item</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 运行结果</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Test Accuracy 0.9996</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>有了模型之后，我们可以把它序列化成文件，在需要的时候，只需要把模型的形式和这个序列化文件再加载成一个 pyTorch 就可以用它进行推理了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># save model</span>
</span></span><span class="line"><span class="cl"><span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="s2">&#34;fraud_d.model&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># load model</span>
</span></span><span class="line"><span class="cl"><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">SAGE</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&#34;fraud_d.model&#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后，我们如何把模型放到我们的线上欺诈检测系统里呢？</p>
<h5 id="推理接口" class="headerLink">
    <a href="#%e6%8e%a8%e7%90%86%e6%8e%a5%e5%8f%a3" class="header-mark"></a>1.5.1.4 推理接口</h5><p>前边提到过， GraphSAGE 是最简单的支持 Inductive Learning 的模型，而上边我们的训练推理过程实际上还不是这样的我们的测试和训练的图是同一张，虽然标注了训练的点的索引，但实际上是整张图作为输入的。为了做到Inductive Learning 我们只需要把训练和测试分成两个无交集的子图来做训练和最终测试：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Inductive Learning, our test dataset are new nodes and new edges</span>
</span></span><span class="line"><span class="cl"><span class="n">hg_train</span> <span class="o">=</span> <span class="n">hg</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">X_train_idx</span><span class="p">,</span> <span class="n">X_val_idx</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># model training</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Training...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">train</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">hg_train</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">X_train_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">X_train_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hg_train</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># test the model</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">hg_test</span> <span class="o">=</span> <span class="n">hg</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">X_test_idx</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sg_X_test_idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">hg_test</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">acc</span> <span class="o">=</span> <span class="n">layerwise_infer</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">hg_test</span><span class="p">,</span> <span class="n">sg_X_test_idx</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test Accuracy </span><span class="si">{:.4f}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">acc</span><span class="o">.</span><span class="n">item</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 运行结果</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Test Accuracy 0.9990</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到，我们上边的代码里，测试所用到的图和训练的图是完全不同的两组数据，这使得我们的线上系统可以是之前完全没有遇到的数据，我们只要把对新来的一个交易请求数据写进 NebulaGraph，然后再从这个点获取一个线上系统可以返回的小子图，就可以把它作为模型推理的输入，获得子图的标签了！</p>
<p><strong>新的交易请求</strong>：</p>
<p>还记得我们前边画的线上推理系统的流程图么？</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">      ┌─────────────────────┐                          ┌─────────────────┐      
</span></span><span class="line"><span class="cl">      │                     │                          │                 │
</span></span><span class="line"><span class="cl">─────▶│ Transaction Record  ├──────2. Fraud Risk ─────▶│  Inference API  │◀────┐
</span></span><span class="line"><span class="cl">      │                     │◀────Prediction with ─────┤                 │     │
</span></span><span class="line"><span class="cl">      │                     │        Sub Graph         │                 │     │
</span></span><span class="line"><span class="cl">      └─────────────────────┘                          └─────────────────┘     │
</span></span><span class="line"><span class="cl">           │           ▲                                        │              │
</span></span><span class="line"><span class="cl">           │           │                                        │              │
</span></span><span class="line"><span class="cl">       0. Insert   1. Get New                              3.req: Node         │
</span></span><span class="line"><span class="cl">         Record    Record Sub                            Classification        │
</span></span><span class="line"><span class="cl">           │         Graph                                      │              │
</span></span><span class="line"><span class="cl">           ▼           │                                        │              │
</span></span><span class="line"><span class="cl">┌──────────────────────┴─────────────────┐ ┌────────────────────┘      3.resp: │
</span></span><span class="line"><span class="cl">│┌──────────────────────────────────────┐│ │                          Predicted│
</span></span><span class="line"><span class="cl">││   Graph of Historical Transactions   ││ │                             Risk  │
</span></span><span class="line"><span class="cl">│└──────────────────────────────────────┘│ │                                   │
</span></span><span class="line"><span class="cl">│                   .─.              .   │ │                                   │
</span></span><span class="line"><span class="cl">│                  (   )◀───────────( )  │ │                                   │
</span></span><span class="line"><span class="cl">│                   `─&#39;              &#39;   │ │      ┌──────────────────────┐     │
</span></span><span class="line"><span class="cl">│  .       .─.       ╲             ◁     │ │      │ GNN Model Λ          │     │
</span></span><span class="line"><span class="cl">│ ( )◀────(   )       ╲           ╱      │ │  ┌───┴─┐        ╱ ╲      ┌──┴──┐  │
</span></span><span class="line"><span class="cl">│  &#39;       `─&#39;         ╲       . ╱       │ │  ├─────┤       ╱   ╲     ├─────┤  │
</span></span><span class="line"><span class="cl">│  ╲       ◀            ╲     ( )        │ └─▶├─────┼─────▶▕     ─────├─────┤──┘
</span></span><span class="line"><span class="cl">│   ╲  .  ╱              ◁     &#39;         │    ├─────┤       ╲   ╱     ├─────┤   
</span></span><span class="line"><span class="cl">│    ◀( )╱               .─.         .─. │    └───┬─┘        ╲ ╱      └──┬──┘   
</span></span><span class="line"><span class="cl">│      &#39;                (   )◀──────(   )│        │           V          │      
</span></span><span class="line"><span class="cl">│                        `─&#39;         `─&#39; │        └──────────────────────┘      
</span></span><span class="line"><span class="cl">└────────────────────────────────────────┘        
</span></span></code></pre></td></tr></table>
</div>
</div><p>现在，我们假设这个新的交易请求已经发起了，这条交易记录已经被更新在图谱里了，咱们随便取一个点作为这样的请求吧</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MATCH (n:review) RETURN n LIMIT 1
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
</span></span><span class="line"><span class="cl">| n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
</span></span><span class="line"><span class="cl">+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
</span></span><span class="line"><span class="cl">| (2048 :review{f0: 0.0, f1: 0.08034700155258179, f10: 0.3952670097351074, f11: 0.18671999871730804, f12: 0.2836120128631592, f13: 0.2843089997768402, f14: 0.38148200511932373, f15: 0.3816460072994232, f16: 0.9999740123748779, f17: 0.6430919766426086, f18: 0.9999740123748779, f19: 0.5051100254058838, f2: 0.12382200360298157, f20: 0.4940490126609802, f21: 0.7766339778900146, f22: 0.7705119848251343, f23: 0.9480599761009216, f24: 0.4032529890537262, f25: 0.12437800318002701, f26: 0.3184080123901367, f27: 0.5223879814147949, f28: 0.4278610050678253, f29: 0.343284010887146, f3: 0.42868199944496155, f30: 0.37313398718833923, f31: 0.328357994556427, f4: 0.9999849796295166, f5: 0.9999849796295166, f6: 0.9999849796295166, f7: 0.4850809872150421, f8: 0.454602986574173, f9: 0.8863419890403748, is_fraud: 0}) |
</span></span><span class="line"><span class="cl">+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
</span></span></code></pre></td></tr></table>
</div>
</div><p>好，它是 2048 这个点。它的下一步是 <code>1. Get New Record Subgraph</code> 我们来获取它的子图：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-SQL" data-lang="SQL"><span class="line"><span class="cl"><span class="k">GET</span><span class="w"> </span><span class="n">SUBGRAPH</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">PROP</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">2048</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">VERTICES</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="n">EDGES</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">relationships</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到返回的结果其实还是很多的，不过对于 NebulaGraph 来说，这个子图结果返回是在 10 ms 左右获取的，这里我就不贴出来了，如果我们在 NebulaGraph Studio 或者 Explorer 中可以把结果渲染出来（可视化展示的 Query 可以去掉 <code>WITH PROP</code> ，可以给浏览器省点内存），结果就更容易让人脑理解了：</p>
<p><a class="lightgallery" href="./subgraph_console_view.webp" title="./subgraph_console_view.webp" data-thumbnail="./subgraph_console_view.webp">
        
    </a></p>
<p><a class="lightgallery" href="./subgraph_viz.webp" title="./subgraph_viz.webp" data-thumbnail="./subgraph_viz.webp">
        
    </a></p>
<p>现在我们就来实现这一步的代码吧，它的输入是点的 id：<code>vertex_id</code>。输出是一个 <code>dgl_graph</code>，用来传给推理接口。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># get SUBGRAPH of one node</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">tensor</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">dgl</span> <span class="kn">import</span> <span class="n">DGLHeteroGraph</span><span class="p">,</span> <span class="n">heterograph</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">nebula3.gclient.net</span> <span class="kn">import</span> <span class="n">ConnectionPool</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">nebula3.Config</span> <span class="kn">import</span> <span class="n">Config</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">config</span><span class="o">.</span><span class="n">max_connection_pool_size</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">connection_pool</span> <span class="o">=</span> <span class="n">ConnectionPool</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">connection_pool</span><span class="o">.</span><span class="n">init</span><span class="p">([(</span><span class="s1">&#39;graphd&#39;</span><span class="p">,</span> <span class="mi">9669</span><span class="p">)],</span> <span class="n">config</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">vertex_id</span> <span class="o">=</span> <span class="mi">2048</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">connection_pool</span><span class="o">.</span><span class="n">get_session</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="s1">&#39;nebula&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">execute_json</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;USE yelp;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="sa">f</span><span class="s2">&#34;GET SUBGRAPH WITH PROP 2 STEPS FROM </span><span class="si">{</span><span class="n">vertex_id</span><span class="si">}</span><span class="s2"> YIELD VERTICES AS nodes, EDGES AS relationships;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="p">[{}])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里我用到了 Nebula-Python 这个 NebulaGraph 的 Python SDK/Client，通过 <code>execute_json</code> 执行获得了这个交易的子图。下一步，咱们需要把它构造成一个 <code>dgl_graph</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># create node and nodedata</span>
</span></span><span class="line"><span class="cl"><span class="n">node_id_map</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># key: vertex id in NebulaGraph, value: node id in dgl_graph</span>
</span></span><span class="line"><span class="cl"><span class="n">node_idx</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">features</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[[]]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;meta&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">        <span class="n">nodeid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;meta&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">nodeid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node_id_map</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">node_id_map</span><span class="p">[</span><span class="n">nodeid</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_idx</span>
</span></span><span class="line"><span class="cl">            <span class="n">node_idx</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">features</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;row&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="sa">f</span><span class="s2">&#34;review.f</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">features</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;row&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;review.is_fraud&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">- R-U-R：两个评价由同一个用户发出 shares_user_with
</span></span></span><span class="line"><span class="cl"><span class="s2">- R-S-R：两个评价是同餐厅同评分（评分可以是1到5） shares_restaurant_rating_with
</span></span></span><span class="line"><span class="cl"><span class="s2">- R-T-R：两个评价是同餐厅同提交月份 shares_restaurant_in_one_month_with
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">rur_start</span><span class="p">,</span> <span class="n">rur_end</span><span class="p">,</span> <span class="n">rsr_start</span><span class="p">,</span> <span class="n">rsr_end</span><span class="p">,</span> <span class="n">rtr_start</span><span class="p">,</span> <span class="n">rtr_end</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;meta&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">edge</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shares_user_with&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">rur_start</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">            <span class="n">rur_end</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;dst&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">rsr_start</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">            <span class="n">rsr_end</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;dst&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">rtr_start</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">            <span class="n">rtr_end</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;dst&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">rur_start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_dict</span><span class="p">[(</span><span class="s1">&#39;review&#39;</span><span class="p">,</span> <span class="s1">&#39;shares_user_with&#39;</span><span class="p">,</span> <span class="s1">&#39;review&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rur_start</span><span class="p">),</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rur_end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">rsr_start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_dict</span><span class="p">[(</span><span class="s1">&#39;review&#39;</span><span class="p">,</span> <span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">,</span> <span class="s1">&#39;review&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rsr_start</span><span class="p">),</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rsr_end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">rtr_start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_dict</span><span class="p">[(</span><span class="s1">&#39;review&#39;</span><span class="p">,</span> <span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">,</span> <span class="s1">&#39;review&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rtr_start</span><span class="p">),</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rtr_end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># construct a dgl_graph</span>
</span></span><span class="line"><span class="cl"><span class="n">dgl_graph</span><span class="p">:</span> <span class="n">DGLHeteroGraph</span> <span class="o">=</span> <span class="n">heterograph</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>实际上我就是按照 DGL 文档：https://docs.dgl.ai/en/0.9.x/generated/dgl.heterograph.html，中的方式去构造 <code>data_dict</code>，然后用 <code>heterograph()</code> 就把结果转换为想要的 dgl_graph 了，其中 <code>node_id_map</code> 是 NebulaGraph 之中 Vertex_ID 到这个对象中 node_id 的字典。</p>
<p>最后，我们再把 node feature 也加载进去。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># load node features to dgl_graph</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">dgl_graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="sa">f</span><span class="s2">&#34;f</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">dgl_graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="mi">32</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>在开始推理之前，我们还需要把它转换成同构图，和前边完全一样：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># to homogeneous graph</span>
</span></span><span class="line"><span class="cl"><span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dgl_graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="sa">f</span><span class="s2">&#34;f</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dgl_graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dgl_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">dgl_graph</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">(</span><span class="s1">&#39;shares_restaurant_in_one_month_with&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">dgl_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">dgl_graph</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">(</span><span class="s1">&#39;shares_restaurant_rating_with&#39;</span><span class="p">),),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">dgl_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;shares_user_with&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">dgl_graph</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">(</span><span class="s1">&#39;shares_user_with&#39;</span><span class="p">),),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># heterogeneous graph to heterogeneous graph, keep ndata and edata</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">dgl</span>
</span></span><span class="line"><span class="cl"><span class="n">hg</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">to_homogeneous</span><span class="p">(</span><span class="n">dgl_graph</span><span class="p">,</span> <span class="n">edata</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">],</span> <span class="n">ndata</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后，我们的推理接口就是：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">do_inference</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">node_idx</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">inference</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span> <span class="c1"># pred in buffer_device</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">pred</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们可以调用一个一下试试推理我们这个新的点：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">node_idx</span> <span class="o">=</span> <span class="n">node_id_map</span><span class="p">[</span><span class="n">vertex_id</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">4096</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">do_inference</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">hg</span><span class="p">,</span> <span class="n">node_idx</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>当然，我们也能在这个小子图上计算他的正确率：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_inference</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">inference</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span> <span class="c1"># pred in buffer_device</span>
</span></span><span class="line"><span class="cl">        <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">label</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">][</span><span class="n">nid</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">MF</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">node_idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">node_id_map</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl"><span class="n">acc</span> <span class="o">=</span> <span class="n">test_inference</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">hg</span><span class="p">,</span> <span class="n">node_idx</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test Accuracy </span><span class="si">{:.4f}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">acc</span><span class="o">.</span><span class="n">item</span><span class="p">()))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">In</span> <span class="p">[</span><span class="mi">307</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">test_inference</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span>     <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span>     <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span>         <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">inference</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span> <span class="c1"># pred in buffer</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span> <span class="n">_device</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span>         <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span>         <span class="n">label</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">][</span><span class="n">nid</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span>         <span class="k">return</span> <span class="n">MF</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span> <span class="n">node_idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">node_id_map</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span> <span class="n">acc</span> <span class="o">=</span> <span class="n">test_inference</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">hg</span><span class="p">,</span> <span class="n">node_idx</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Test Accuracy </span><span class="si">{:.4f}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">acc</span><span class="o">.</span><span class="n">item</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">     <span class="o">...</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="mi">100</span><span class="o">%|</span><span class="err">████████████████████████████████████████████████</span><span class="o">|</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span> <span class="p">[</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">&lt;</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="mf">130.31</span><span class="n">it</span><span class="o">/</span><span class="n">s</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="mi">100</span><span class="o">%|</span><span class="err">████████████████████████████████████████████████</span><span class="o">|</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span> <span class="p">[</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">&lt;</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="mf">152.29</span><span class="n">it</span><span class="o">/</span><span class="n">s</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="mi">100</span><span class="o">%|</span><span class="err">████████████████████████████████████████████████</span><span class="o">|</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span> <span class="p">[</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">&lt;</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="mf">173.55</span><span class="n">it</span><span class="o">/</span><span class="n">s</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Test</span> <span class="n">Accuracy</span> <span class="mf">0.9688</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这个示例项目的代码在：<a href="https://github.com/wey-gu/NebulaGraph-Fraud-Detection-GNN" target="_blank" rel="noopener noreferrer">github.com/wey-gu/NebulaGraph-Fraud-Detection-GNN</a> ，如有问题欢迎留言、ISSUE。</p>
<h3 id="总结" class="headerLink">
    <a href="#%e6%80%bb%e7%bb%93" class="header-mark"></a>1.6 总结</h3><p>总结起来，欺诈检测的方法有：</p>
<ul>
<li>在一个交易历史、风控的图谱上，通过图模式查询直接获得风险提示</li>
<li>定期利用图算法扩充风险标注，写回图库</li>
<li>定期计算图谱中的图特征，和其他特征一起用传统机器学习方法离线预测风险</li>
<li>将图谱中的属性处理成为点、边特征，用图神经网络方法离线预测风险，部分可以 Inductive Learning 的方法结合图库可以实现在线风险预测</li>
</ul>
<blockquote>
<p>Feature Image credit goes to <a href="https://unsplash.com/photos/BW0vK-FA3eg" target="_blank" rel="noopener noreferrer">https://unsplash.com/photos/BW0vK-FA3eg</a></p>
</blockquote>]]></description>
</item><item>
    <title>NebulaGraph 内核贡献开发指南</title>
    <link>https://siwei.io/nebulagraph-hacking-guide/</link>
    <pubDate>Sun, 23 Oct 2022 14:57:07 &#43;0800</pubDate><author>
        <name>Wey Gu</name>
    </author><guid>https://siwei.io/nebulagraph-hacking-guide/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/nebulagraph-hacking-guide/featured-image.webp" referrerpolicy="no-referrer">
            </div><blockquote>
<p>如何 build NebulaGraph？如何为 NebulaGraph 内核做贡献？从本章作为切入点就够了。</p>
</blockquote>
<h2 id="nebulagraph-的架构简介" class="headerLink">
    <a href="#nebulagraph-%e7%9a%84%e6%9e%b6%e6%9e%84%e7%ae%80%e4%bb%8b" class="header-mark"></a>1 NebulaGraph 的架构简介</h2><p>为了方便对 NebulaGraph 尚未了解的读者也能快速直接从贡献代码为起点了解它，我把开发、贡献内核代码入手所需要的基本架构知识也在这里以最小信息量的形式总结一下，作为前导知识，请资深的 NebulaGraph 玩家直接跳过这一章节。</p>
<h3 id="服务进程" class="headerLink">
    <a href="#%e6%9c%8d%e5%8a%a1%e8%bf%9b%e7%a8%8b" class="header-mark"></a>1.1 服务、进程</h3><p>NebulaGraph 的架构和 Google Spanner, TiDB 很相似，核心部分只有三种服务、进程：Graph 服务、Meta 服务和 Storage 服务。它们之间彼此通过 TCP 之上的 Thrift RPC 协议进行通信。</p>
<p><a class="lightgallery" href="https://docs-cdn.nebula-graph.com.cn/docs-2.0/1.introduction/2.nebula-graph-architecture/nebula-graph-architecture-1.png" title="https://docs-cdn.nebula-graph.com.cn/docs-2.0/1.introduction/2.nebula-graph-architecture/nebula-graph-architecture-1.png" data-thumbnail="https://docs-cdn.nebula-graph.com.cn/docs-2.0/1.introduction/2.nebula-graph-architecture/nebula-graph-architecture-1.png">
        
    </a></p>
<h3 id="计算层与存储层" class="headerLink">
    <a href="#%e8%ae%a1%e7%ae%97%e5%b1%82%e4%b8%8e%e5%ad%98%e5%82%a8%e5%b1%82" class="header-mark"></a>1.2 计算层与存储层</h3><p>NebulaGraph 是存储与计算分离的架构，它的 Meta 服务和 Storage 服务共同组成了存储层，Graph 服务是内核提供的计算层。</p>
<p>这样的设计使得 NebulaGraph 的集群部署可以灵活按需分配计算、存储的资源，比如我们可以为同一个集群中创建不同配置的两组 Graph 服务实例、用来面向不同类型的业务。</p>
<p>同时，计算层解耦于存储层使得在 NebulaGraph 之上的构建不同的特定计算层成为可能，比如 NebulaGraph Algorithm、NebulaGraph Analytics 就是在 NebulaGraph 之上构建了异构的另一个计算层，如果需要，任何人也可以定制自己的专属计算层，从而满足统一图基础存储之上的复合、多样的计算需求。</p>
<h4 id="graph-service-nebula-graphd" class="headerLink">
    <a href="#graph-service-nebula-graphd" class="header-mark"></a>1.2.1 Graph Service: nebula-graphd</h4><p>Graph 服务是对外接受图库登录、图查询请求、集群管理操作、schema 定义所直接连接的服务，他的进程名字叫 graphd，表示 nebula graph daemon。</p>
<p>Graph 服务的每一个进程是无状态的，这使得横向扩缩 Graph 服务的实例非常灵活、简单。</p>
<p>Graph 服务也叫 Query Engine，其内部和传统的数据库系统的设计非常相似，分为：解析、校验、计划、执行几部分。</p>
<p><a class="lightgallery" href="https://docs-cdn.nebula-graph.com.cn/docs-2.0/1.introduction/2.nebula-graph-architecture/query-engine-architecture.png" title="https://docs-cdn.nebula-graph.com.cn/docs-2.0/1.introduction/2.nebula-graph-architecture/query-engine-architecture.png" data-thumbnail="https://docs-cdn.nebula-graph.com.cn/docs-2.0/1.introduction/2.nebula-graph-architecture/query-engine-architecture.png">
        
    </a></p>
<h4 id="meta-service-nebula-metad" class="headerLink">
    <a href="#meta-service-nebula-metad" class="header-mark"></a>1.2.2 Meta Service: nebula-metad</h4><p>Meta 服务顾名思义负责元数据管理，进程名字叫 metad。这些元数据包括：</p>
<ul>
<li>所有的图空间、Schema 定义</li>
<li>用户鉴权、授权信息</li>
<li>集群服务的发现与服务的分布</li>
<li>图空间中的数据分布</li>
</ul>
<p>Meta 服务的进程可以单实例部署，在非单机部署的场景下，为了数据、服务的高 SLA ，我们可以奇数多个实例的部署，通常来说 3 个 nebula-metad 就足够了，三个 nebula-metad 通过 RAFT 共识协议构成一个集群提供服务。</p>
<p><a class="lightgallery" href="https://docs-cdn.nebula-graph.com.cn/docs-2.0/1.introduction/2.nebula-graph-architecture/meta-architecture1.png" title="https://docs-cdn.nebula-graph.com.cn/docs-2.0/1.introduction/2.nebula-graph-architecture/meta-architecture1.png" data-thumbnail="https://docs-cdn.nebula-graph.com.cn/docs-2.0/1.introduction/2.nebula-graph-architecture/meta-architecture1.png">
        
    </a></p>
<h4 id="storage-service-nebula-storaged" class="headerLink">
    <a href="#storage-service-nebula-storaged" class="header-mark"></a>1.2.3 Storage Service: nebula-storaged</h4><p>Storage 服务存储所有的图数据，进程名字叫 storaged。storaged 分布式地存储图数据，为 Graph 内部的图查询执行期提供底层的图语义存储接口，方便 Storage 客户端通过 Thrift RPC 协议面向涉及的 storaged 示例进行图语义的读写。</p>
<p>当 NebulaGraph 中图空间的副本数大于 1 的时候，每一个分区都会在不同 storaged 示例上有副本，副本之间则通过 RAFT 协议协调同步与读写。</p>
<p><a class="lightgallery" href="https://www-cdn.nebula-graph.com.cn/nebula-blog/nebula-reading-storage-architecture.png" title="https://www-cdn.nebula-graph.com.cn/nebula-blog/nebula-reading-storage-architecture.png" data-thumbnail="https://www-cdn.nebula-graph.com.cn/nebula-blog/nebula-reading-storage-architecture.png">
        
    </a></p>
<blockquote>
<p>参考 <a href="https://docs.nebula-graph.com.cn/master/1.introduction/3.nebula-graph-architecture/1.architecture-overview/" target="_blank" rel="noopener noreferrer">文档：架构介绍</a>，了解更多详情；</p>
<p>推荐阅读社区官方播客的架构系列文章：<a href="https://www.nebula-graph.com.cn/tags/%E6%9E%B6%E6%9E%84%E7%B3%BB%E5%88%97" target="_blank" rel="noopener noreferrer">nebula-graph.com.cn/tags/架构系列</a>。</p>
</blockquote>
<h3 id="进程间通信服务发现机制" class="headerLink">
    <a href="#%e8%bf%9b%e7%a8%8b%e9%97%b4%e9%80%9a%e4%bf%a1%e6%9c%8d%e5%8a%a1%e5%8f%91%e7%8e%b0%e6%9c%ba%e5%88%b6" class="header-mark"></a>1.3 进程间通信、服务发现机制</h3><p>graphd、metad、storaged 之间通过 Thrift 协议进行远程调用（RPC），下边给一些例子：</p>
<p>graphd 会通过 metaclient 调用 metad</p>
<ul>
<li>将自己报告为一个正在运行的服务，以便被发现</li>
<li>为用户（使用 graphclient ）登录进行 RPC 调用</li>
<li>当它处理 nGQL 查询时，获取图形存储分布情况</li>
</ul>
<p>graphd 会通过 storageclient 调用 storaged</p>
<ul>
<li>在处理 nGQL 时，在它从 metad 获得所需的元信息后，进行图形数据的读/写</li>
</ul>
<p>storaged 会通过  metaclient调用 metad</p>
<ul>
<li>将自己报告为一个正在运行的服务，以便被发现</li>
</ul>
<p>当然有状态的存储引擎内部也有集群同步的流量与通信</p>
<ul>
<li>
<p>storaged 与其他 storaged 有 RAFT 连接</p>
</li>
<li>
<p>metad 与其他 metad 实例有 RAFT 连接</p>
</li>
</ul>
<h2 id="开发环境搭建" class="headerLink">
    <a href="#%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba" class="header-mark"></a>2 开发环境搭建</h2><p>接下来我们开始 NebulaGraph 的构建、开发环境的部分。</p>
<p>NebulaGraph 只支持在 GNU/Linux 分支中构建，目前来说，最方便的方式是在社区预先提供好了依赖的容器镜像的基础上在容器内部构建、调试 NebulaGraph 代码的更改和 Debug。</p>
<h3 id="创建一个容器化的-nebulagraph-集群" class="headerLink">
    <a href="#%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa%e5%ae%b9%e5%99%a8%e5%8c%96%e7%9a%84-nebulagraph-%e9%9b%86%e7%be%a4" class="header-mark"></a>2.1 创建一个容器化的 NebulaGraph 集群</h3><p>为了更方便地调试代码，我习惯提前创建一个 NebulaGraph Docker 环境，我们可以使用官方的 Docker-Compose 方式部署，也可以使用我在官方 Docker-Compose 基础之上弄的一键部署工具：nebula-up.siwei.io。</p>
<p>以 nebula-up 为例：</p>
<p>在我们的 Linux 开发服务器中执行 <code>curl -fsSL nebula-up.siwei.io/install.sh | bash</code> 就可以了。</p>
<h3 id="代码获取" class="headerLink">
    <a href="#%e4%bb%a3%e7%a0%81%e8%8e%b7%e5%8f%96" class="header-mark"></a>2.2 代码获取</h3><p>NebulaGraph 的代码仓库托管在 GitHub 之上，我们可以在有互联网的地方直接克隆下来：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone git@github.com:vesoft-inc/nebula.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> nebula
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="创建开发容器" class="headerLink">
    <a href="#%e5%88%9b%e5%bb%ba%e5%bc%80%e5%8f%91%e5%ae%b9%e5%99%a8" class="header-mark"></a>2.3 创建开发容器</h3><p>有了 NebulaGraph 集群，我们可以借助 <a href="https://github.com/vesoft-inc/nebula-dev-docker/" target="_blank" rel="noopener noreferrer">https://github.com/vesoft-inc/nebula-dev-docker/</a> 提供的开箱即用开发容器镜像，搭建开发环境：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TAG</span><span class="o">=</span>ubuntu2004
</span></span><span class="line"><span class="cl">docker run -ti <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --network nebula-net <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --security-opt <span class="nv">seccomp</span><span class="o">=</span>unconfined <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v <span class="s2">&#34;</span><span class="nv">$PWD</span><span class="s2">&#34;</span>:/home/nebula <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -w /home/nebula <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --name nebula_dev <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  vesoft/nebula-dev:<span class="nv">$TAG</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  bash
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>这其中，<code>-v &quot;$PWD&quot;</code> 表示当前的 NebulaGraph 代码本地的路径会被映射到开发容器内部的 <code>/home/nebula</code>，而启动的容器名字是 <code>nebula_dev</code>。</p>
</blockquote>
<p>待这个容器启动之后，我们会自动进入到这个容器的 bash shell 之中，如果我们输入 <code>exit</code> 退出容器，它会被关闭，如果我们想再次启动容器，只需要执行：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker start nebula_dev
</span></span></code></pre></td></tr></table>
</div>
</div><p>之后，我们的编译、Debug、测试工作都在 <code>nebula_dev</code> 容器内部进行，在容器是运行状态的情况下，可以随时新建一个容器内部的 bash shell 进程：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -ti nebula_dev bash
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注，为了保持编译环境是最新的，我们可以定期删除、拉取、重建这个开发容器，以保持环境与代码相匹配。</p>
</blockquote>
<h3 id="编译环境" class="headerLink">
    <a href="#%e7%bc%96%e8%af%91%e7%8e%af%e5%a2%83" class="header-mark"></a>2.4 编译环境</h3><p>在 <code>nebula_dev</code> 这个容器内部，我们可以进行代码编译：</p>
<p>进入编译容器</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -ti nebula_dev bash
</span></span></code></pre></td></tr></table>
</div>
</div><p>用 CMake 准备 makefile，第一次构建的时候，为了节省时间、内存，我关闭了测试（<code>-DENABLE_TESTING=OFF</code>）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
</span></span><span class="line"><span class="cl">cmake -DCMAKE_CXX_COMPILER<span class="o">=</span><span class="nv">$TOOLSET_CLANG_DIR</span>/bin/g++ -DCMAKE_C_COMPILER<span class="o">=</span><span class="nv">$TOOLSET_CLANG_DIR</span>/bin/gcc -DENABLE_WERROR<span class="o">=</span>OFF -DCMAKE_BUILD_TYPE<span class="o">=</span>Debug -DENABLE_TESTING<span class="o">=</span>OFF ..
</span></span></code></pre></td></tr></table>
</div>
</div><p>开始编译，根据服务器的空闲 CPU 个数和内存量力而行，比如我在自己 72 核心的服务器上准备允许同时运行 64 个 job，则运行：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make -j64
</span></span></code></pre></td></tr></table>
</div>
</div><p>第一次构建的时间会慢一些，在 make 成功之后，我们也可以执行 <code>make install</code> 把二进制安装到像生产安装时候一样的路径：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@1827b82e88bf:/home/nebula/build# make install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root@1827b82e88bf:/home/nebula/build# ls /usr/local/nebula/bin
</span></span><span class="line"><span class="cl">db_dump  db_upgrader  meta_dump  nebula-graphd  nebula-metad  nebula-storaged
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root@1827b82e88bf:/home/nebula/build# ls /usr/local/nebula/
</span></span><span class="line"><span class="cl">bin  etc  pids  scripts  share
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="调试-nebulagraph" class="headerLink">
    <a href="#%e8%b0%83%e8%af%95-nebulagraph" class="header-mark"></a>3 调试 NebulaGraph</h2><p>以 GraphD 调试为例。</p>
<h3 id="安装依赖" class="headerLink">
    <a href="#%e5%ae%89%e8%a3%85%e4%be%9d%e8%b5%96" class="header-mark"></a>3.1 安装依赖</h3><p>安装一些后边会方便 Debug 额外用到的依赖</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 装一个 ping，测试一下 nebula-up 安装的集群可以访问</span>
</span></span><span class="line"><span class="cl">apt update <span class="o">&amp;&amp;</span> apt install iputils-ping -y
</span></span><span class="line"><span class="cl"><span class="c1"># ping graphd 试试看</span>
</span></span><span class="line"><span class="cl">ping graphd -c <span class="m">4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 安装 gdb gdb-dashboard</span>
</span></span><span class="line"><span class="cl">apt install gdb -y
</span></span><span class="line"><span class="cl">wget -P ~ https://git.io/.gdbinit
</span></span><span class="line"><span class="cl">pip install pygments
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="准备客户端" class="headerLink">
    <a href="#%e5%87%86%e5%a4%87%e5%ae%a2%e6%88%b7%e7%ab%af" class="header-mark"></a>3.2 准备客户端</h3><p>准备一个 NebulaGraph 的命令行客户端：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 新开一个 nebula_dev 的 shell</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -ti nebula_dev bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 下载 nebula-console 二进制文件，并赋予可执行权限，命名为 nebula-console 并安装到 /usr/bin/ 下</span>
</span></span><span class="line"><span class="cl">wget https://github.com/vesoft-inc/nebula-console/releases/download/v3.2.0/nebula-console-linux-amd64-v3.2.0
</span></span><span class="line"><span class="cl">chmod +x nebula-console*
</span></span><span class="line"><span class="cl">mv nebula-console* /usr/bin/nebula-console
</span></span></code></pre></td></tr></table>
</div>
</div><p>连接到前边我们 nebula-up 准备的集群之上，加载 basketballplayer 这个测试数据：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nebula-console -u root -p nebula --address<span class="o">=</span>graphd --port<span class="o">=</span><span class="m">9669</span>
</span></span><span class="line"><span class="cl">:play basketballplayer<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nb">exit</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="gdb-运行-graphd" class="headerLink">
    <a href="#gdb-%e8%bf%90%e8%a1%8c-graphd" class="header-mark"></a>3.3 gdb 运行 graphd</h3><p>我们用 gdb 执行刚刚编译的 nebula-graphd 二进制，让他成为一个新的 graphd 服务，名字就叫 <code>nebula_dev</code>。</p>
<p>首先启动 gdb</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 新开一个 nebula_dev 的 shell</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -ti nebula_dev bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /usr/local/nebula/
</span></span><span class="line"><span class="cl">mkdir -p /home/nebula/build/log
</span></span><span class="line"><span class="cl">gdb bin/nebula-graphd
</span></span></code></pre></td></tr></table>
</div>
</div><p>在 gdb 内部执行设置必要的参数</p>
<p>跟随 fork 的子进程</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-makefile" data-lang="makefile"><span class="line"><span class="cl"><span class="err">set</span> <span class="err">follow-fork-mode</span> <span class="err">child</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>设置待调试 graphd 的启动参数（配置）：</p>
<ul>
<li>meta_server_addrs 填已经启动的集群的所有 metad 的地址</li>
<li>local_ip 和 ws_ip 填本容器的域名，port 是 graphd 监听端口</li>
<li>log_dir 是输出日志的目录，v 和 minloglevel 是日志的输出等级</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-makefile" data-lang="makefile"><span class="line"><span class="cl"><span class="err">set</span> <span class="err">args</span> <span class="nv">--flagfile</span><span class="o">=</span>/usr/local/nebula/etc/nebula-graphd.conf.default <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --meta_server_addrs<span class="o">=</span>metad0:9559,metad1:9559,metad2:9559 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --port<span class="o">=</span><span class="m">9669</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --local_ip<span class="o">=</span>nebula_dev <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --ws_ip<span class="o">=</span>nebula_dev <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --ws_http_port<span class="o">=</span><span class="m">19669</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --log_dir<span class="o">=</span>/home/nebula/build/log <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --v<span class="o">=</span><span class="m">4</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --minloglevel<span class="o">=</span><span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果我们想加断点在 <code>src/common/function/FunctionManager.cpp</code> 2783 行，可以再执行：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-makefile" data-lang="makefile"><span class="line"><span class="cl"><span class="nf">b /home/nebula/src/common/function/FunctionManager.cpp</span><span class="o">:</span>2783
</span></span></code></pre></td></tr></table>
</div>
</div><p>配置前边安装的 gdb-dashboard，一个开源的 gdb 界面插件。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-makefile" data-lang="makefile"><span class="line"><span class="cl"><span class="c"># 设定在 gdb 界面上展示 代码、历史、回调栈、变量、表达几个部分，详细参考 https://github.com/cyrus-and/gdb-dashboard
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="err">dashboard</span> <span class="err">-layout</span> <span class="err">source</span> <span class="err">history</span> <span class="err">stack</span> <span class="err">variables</span> <span class="err">expressions</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后我们让进程通过 gdb 跑起来吧：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-makefile" data-lang="makefile"><span class="line"><span class="cl"><span class="err">run</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>之后，我们就可以在这个窗口/shell 会话下调试 graphd 程序了。</p>
<h2 id="修改-nebulagraph-代码" class="headerLink">
    <a href="#%e4%bf%ae%e6%94%b9-nebulagraph-%e4%bb%a3%e7%a0%81" class="header-mark"></a>4 修改 NebulaGraph 代码</h2><p>这里，我以 <a href="https://github.com/vesoft-inc/nebula/issues/3513" target="_blank" rel="noopener noreferrer">#3513</a> 这个 issue 为例子，快速介绍一下代码修改的过程。</p>
<h3 id="读代码" class="headerLink">
    <a href="#%e8%af%bb%e4%bb%a3%e7%a0%81" class="header-mark"></a>4.1 读代码</h3><p>这个 issue 表达的内容是在有一小部分用户决定把 JSON 以 String 的形式存储在 NebulaGraph 中的属性里，因为这种方式比较罕见且不被推崇，NebulaGraph 没有直接支持对 JSON String 直接解析的方法。</p>
<p>本来这个功能是等到很希望得到支持的同学过来亲自去实现的，而在 Issue 中，刚好有一位新手贡献者在里边回复求助如何能开始参与这个贡献。接着这个契机，我去参与讨论看了一下这个功能可以实现成什么样子，最终讨论的结果是可以做成和 MySQL 中的 <code>JSON_EXTRACT</code> 函数那样，但是改为只接受 JSON String，无需处理输出路径参数。</p>
<p>这个任务一句话来说就是为 NebulaGraph 引入一个解析 JSON String 为 Map 的函数。那么，应该大概如何实现这个功能呢？</p>
<h4 id="在哪里修改" class="headerLink">
    <a href="#%e5%9c%a8%e5%93%aa%e9%87%8c%e4%bf%ae%e6%94%b9" class="header-mark"></a>4.1.1 在哪里修改</h4><p>很自然，引入新的函数的更改肯定有很多，所以我们只需要找到之前增加新函数的 PR 就可以快速知道在哪些地方修改了。</p>
<blockquote>
<p>当然我们可以自底向上去了解 NebulaGraph 整体的代码结构，然后一点点找到函数处理的位置，事实上有的时候我们也不得不这么做，这时候除了代码本身，一些面向贡献者的文章可能会帮助我们事半功倍对整体有一个了解，NebulaGraph 官方博客里就有这样的一个系列文章，推荐大家在贡献的时候也去通读一下：<a href="https://www.nebula-graph.com.cn/posts/nebula-graph-source-code-reading-00" target="_blank" rel="noopener noreferrer">nebula-graph.com.cn/posts/nebula-graph-source-code-reading-00</a>。</p>
</blockquote>
<p>于是，我从 <a href="https://github.com/vesoft-inc/nebula/pull/4526" target="_blank" rel="noopener noreferrer">#4526</a> 这个 PR 里了解到所有函数入口都被统一管理在 <a href="https://github.com/vesoft-inc/nebula/blob/master/src/common/function/FunctionManager.cpp" target="_blank" rel="noopener noreferrer">src/common/function/FunctionManager.cpp</a> 之中，通过搜索、理解其中其他某一个函数的关键词之后可以很容易理解一个函数实体的关键词、输入输出数据类型、以及它的处理逻辑的代码在哪里实现。</p>
<p>同时，我注意到在同一个目录下，<code>src/common/function/test/FunctionManagerTest.cpp</code> 之中则是所有这些函数的单元测试代码，用同样的方式也可以知道新加的一个函数需要如何在里边实现基于 gtest 的单元测试。</p>
<h3 id="开始改代码" class="headerLink">
    <a href="#%e5%bc%80%e5%a7%8b%e6%94%b9%e4%bb%a3%e7%a0%81" class="header-mark"></a>4.2 开始改代码</h3><blockquote>
<p>注：在修改代码之前，请确保自己在最新的 master 分支之上创建一个单独的分支，这里的例子中，我把分支名字叫 <code>fn_JSON_EXTRACT</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git checkout master
</span></span><span class="line"><span class="cl">git pull
</span></span><span class="line"><span class="cl">git checkout -b fn_JSON_EXTRACT
</span></span></code></pre></td></tr></table>
</div>
</div></blockquote>
<p>通过 Google 了解与交叉验证 NebulaGraph 内部使用的 utils 库，我知道我应该用 <code>folly::parseJson</code> 把字符串读成 <code>folly::dynamic</code> 然后再 cast 成 NebulaGraph 内置的 Map() 类型，然后，借助于 StackOverflow/GitHub Copilot，我终于完成了第一个版本的代码修改。</p>
<h3 id="调试代码" class="headerLink">
    <a href="#%e8%b0%83%e8%af%95%e4%bb%a3%e7%a0%81" class="header-mark"></a>4.3 调试代码</h3><p>接下来，我兴冲冲地改好了第一版的代码，信心满满地开始编译！实际上因为是 CPP 新手，即使在 Copilot 的加持下，我的代码还是花了好几次修改才通过编译。</p>
<p>然后，我开始用 GDB 把修改了的 GraphD 启动起来，用 console 发起 <code>JSON_EXTRACT</code> 的函数调用，先调通了期待中的效果，并试着跑几种异常的输入，在发现新问题、修改、编译、调试的几轮循环下让代码达到了期望的状态，这时候，我知道我要把代码提交到 GitHub 请项目的资深贡献者帮忙 review 啦！</p>
<h2 id="提交-pr" class="headerLink">
    <a href="#%e6%8f%90%e4%ba%a4-pr" class="header-mark"></a>5 提交 PR</h2><p>PR（Pull Request）是 GitHub 中方便多人代码协作、代码审查中的一种方式，它通过把一个 repo 下的分支与这个审查协作的实例（PR）做映射，得到一个项目下唯一的 PR 号码之后，生成单独的网页，在这个网页下，我们可以做不同贡献者之间的交流和后续的代码更新，这个过程中代码提交者们可以一直在这个分支上不断提交代码直到代码的状态被各方同意之后，就可以合并（merge）到目的分支中。</p>
<p>这个过程可以分为：</p>
<ul>
<li>创建 GitHub 上远程的个人开发分支</li>
<li>基于分支创建目标项目仓库中的 PR</li>
<li>在 PR 中协作、讨论、不断再次提交到开发分支直到多方达到合并、或者关闭的共识</li>
</ul>
<h3 id="提交到个人远程分支" class="headerLink">
    <a href="#%e6%8f%90%e4%ba%a4%e5%88%b0%e4%b8%aa%e4%ba%ba%e8%bf%9c%e7%a8%8b%e5%88%86%e6%94%af" class="header-mark"></a>5.1 提交到个人远程分支</h3><p>这一步骤里，我们要把当前的本地提交的 commit，提交到自己的 GitHub 分叉之中。</p>
<h4 id="commit-本地修改" class="headerLink">
    <a href="#commit-%e6%9c%ac%e5%9c%b0%e4%bf%ae%e6%94%b9" class="header-mark"></a>5.1.1 commit 本地修改</h4><p>首先，我们确认一下本地的修改是否都是期待中的：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 先确定修改的文件</span>
</span></span><span class="line"><span class="cl">$ git status
</span></span><span class="line"><span class="cl"><span class="c1"># 再看看修改的内容</span>
</span></span><span class="line"><span class="cl">$ git diff
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后，把它们 commit（提交在本地仓库）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 添加所有当前目录（. 这个点表示当前目录）修改过的文件为待 commit</span>
</span></span><span class="line"><span class="cl">$ git add .
</span></span><span class="line"><span class="cl"><span class="c1"># 然后我们可以看一下状态，这些修改的文件状态已经不同了</span>
</span></span><span class="line"><span class="cl">$ git status
</span></span><span class="line"><span class="cl"><span class="c1"># 最后，提交在本地仓库，并用 -m 参数指定单行的 commit message</span>
</span></span><span class="line"><span class="cl">$ git commit -m <span class="s2">&#34;feat: introduce function JSON_EXTRACT&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="提交到自己远程的分支" class="headerLink">
    <a href="#%e6%8f%90%e4%ba%a4%e5%88%b0%e8%87%aa%e5%b7%b1%e8%bf%9c%e7%a8%8b%e7%9a%84%e5%88%86%e6%94%af" class="header-mark"></a>5.1.2 提交到自己远程的分支</h4><p>在提交之前，要确保自己的 GitHub 账号之下确实存在 NebulaGraph 代码仓库的分叉（fork），比如我的 GitHub 账号是 wey-gu，我访问，那么我对 <a href="https://github.com/vesoft-inc/nebula" target="_blank" rel="noopener noreferrer">https://github.com/vesoft-inc/nebula</a> 的分叉应该就是 <a href="https://github.com/wey-gu/nebula" target="_blank" rel="noopener noreferrer">https://github.com/wey-gu/nebula</a> 。</p>
<p>如果还没有自己的分叉，可以直接在  <a href="https://github.com/vesoft-inc/nebula" target="_blank" rel="noopener noreferrer">https://github.com/vesoft-inc/nebula</a> 上点击右上角的 Fork，创建自己的分叉仓库。</p>
<p>当远程的个人分叉存在之后，我们可以把代码提交上去了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 添加一个新的远程仓库叫 wey</span>
</span></span><span class="line"><span class="cl">git remote add wey git@github.com:wey-gu/nebula.git
</span></span><span class="line"><span class="cl"><span class="c1"># 提交 JSON_EXTRACT 分支到 wey 这个 remote 仓库</span>
</span></span><span class="line"><span class="cl">git push wey JSON_EXTRACT
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="在个人远程分叉分支上创建-pr" class="headerLink">
    <a href="#%e5%9c%a8%e4%b8%aa%e4%ba%ba%e8%bf%9c%e7%a8%8b%e5%88%86%e5%8f%89%e5%88%86%e6%94%af%e4%b8%8a%e5%88%9b%e5%bb%ba-pr" class="header-mark"></a>5.1.3 在个人远程分叉分支上创建 PR</h4><p>这时候，我们访问这个远程分支：https://github.com/wey-gu/nebula/tree/fn_JSON_EXTRACT ，就能找到 Open PR 的入口：</p>
<p><a class="lightgallery" href="https://user-images.githubusercontent.com/1651790/197544575-c04a06cf-b867-409c-832e-f3d893fea784.png" title="https://user-images.githubusercontent.com/1651790/197544575-c04a06cf-b867-409c-832e-f3d893fea784.png" data-thumbnail="https://user-images.githubusercontent.com/1651790/197544575-c04a06cf-b867-409c-832e-f3d893fea784.png">
        
    </a></p>
<p>然后点击 Open pull request 按钮，就进入到创建 PR 的界面了，这和在一般的论坛里提交一个帖子是很类似的：</p>
<p><a class="lightgallery" href="https://user-images.githubusercontent.com/1651790/197545824-93706cc7-32a9-4638-84eb-26573106aa28.png" title="https://user-images.githubusercontent.com/1651790/197545824-93706cc7-32a9-4638-84eb-26573106aa28.png" data-thumbnail="https://user-images.githubusercontent.com/1651790/197545824-93706cc7-32a9-4638-84eb-26573106aa28.png">
        
    </a></p>
<p>提交之后，我们可以等待、或者邀请其他人来做代码的审查（review），往往其他的贡献者都能从他们的角度给出一些代码修改的建议和提示，我们需要经过几轮的代码修改、讨论之后使得代码达到最佳的状态。</p>
<p>而这些审查者中除了社区的贡献者（人类）之外，还有一些自动化的机器人，他们会在代码库中自动化的通过持续集成（CI）的方式运行一些自动化的审查工作，可能包括以下几种：</p>
<ul>
<li>CLA：Contributor License Agreement（贡献者许可协议），这是一个要 PR 作者在首次提交代码到项目时签署的协议，因为代码将被提交到公共空间，这份协议的签署意味着作者同意代码被分享、复用、修改这件事情。</li>
<li>lint：代码风格检查，这也是最常见的 CI 任务</li>
<li>test：各种层面的测试检查任务</li>
</ul>
<p>通常来说，这些所有的自动化审查机器人所代表的任务也需要全都通过，代码的状态才能被认为是可以合并的，而不出意外，我首次提交的代码果然有测试的失败。</p>
<p><a class="lightgallery" href="https://user-images.githubusercontent.com/1651790/197549538-4bba79b5-6b0a-42f4-b287-55061c08cbe8.png" title="https://user-images.githubusercontent.com/1651790/197549538-4bba79b5-6b0a-42f4-b287-55061c08cbe8.png" data-thumbnail="https://user-images.githubusercontent.com/1651790/197549538-4bba79b5-6b0a-42f4-b287-55061c08cbe8.png">
        
    </a></p>
<h3 id="调试-ci-测试代码" class="headerLink">
    <a href="#%e8%b0%83%e8%af%95-ci-%e6%b5%8b%e8%af%95%e4%bb%a3%e7%a0%81" class="header-mark"></a>5.2 调试 CI 测试代码</h3><p>NebulaGraph 里所有的 CI 测试代码也都能在本地被触发，并且（显然）都有被单独触发的方式，我们需要掌握它们而不是在每次修改一个小的测试修复之后提交到服务器上等着 CI 做全量的运行（这样常常几十分钟就这么浪费掉了）。</p>
<h4 id="ctest" class="headerLink">
    <a href="#ctest" class="header-mark"></a>5.2.1 CTest</h4><p>在这个距离的 PR 提交中，我修改的函数代码同一层级下的单元测试 CTest 就有问题，问题可能是测试代码本身造成、我们的修改破坏了原来的测试用例导致、亦或者是我们自己的测试用例发现了代码修改本身的问题。</p>
<p>这次，我们要根据 CTest 失败的报错进行排查和代码修改，然后编译代码，在本地运行一下这个失败的用例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 我们需要进入到我们的编译容器内部的 build 目录下</span>
</span></span><span class="line"><span class="cl">$ docker <span class="nb">exec</span> -ti nebula_dev bash
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> build
</span></span><span class="line"><span class="cl"><span class="c1"># 在 -DENABLE_TESTING=ON 之中编译，如果之前的编译 job 数下内存已经跑满了的话，这次可以把 job 数调小一点，因为开启测试会占用更多内存</span>
</span></span><span class="line"><span class="cl">$ cmake -DCMAKE_CXX_COMPILER<span class="o">=</span><span class="nv">$TOOLSET_CLANG_DIR</span>/bin/g++ -DCMAKE_C_COMPILER<span class="o">=</span><span class="nv">$TOOLSET_CLANG_DIR</span>/bin/gcc -DENABLE_WERROR<span class="o">=</span>OFF -DCMAKE_BUILD_TYPE<span class="o">=</span>Debug -DENABLE_TESTING<span class="o">=</span>ON ..
</span></span><span class="line"><span class="cl">$ make -j <span class="m">48</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 可以看到编译成功了 CTest 的单元测试二进制可执行文件</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [100%] Linking CXX executable ../../../../bin/test/function_manager_test</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [100%] Built target function_manager_test</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行重新修改过的单元测试！</span>
</span></span><span class="line"><span class="cl">$ bin/test/function_manager_test
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[==========]</span> Running <span class="m">11</span> tests from <span class="m">1</span> <span class="nb">test</span> suite.
</span></span><span class="line"><span class="cl"><span class="o">[</span>----------<span class="o">]</span> Global <span class="nb">test</span> environment set-up.
</span></span><span class="line"><span class="cl"><span class="o">[</span>----------<span class="o">]</span> <span class="m">11</span> tests from FunctionManagerTest
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.testNull
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.testNull <span class="o">(</span><span class="m">0</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.functionCall
</span></span><span class="line"><span class="cl">W20221020 23:35:18.579897 <span class="m">28679</span> Map.cpp:77<span class="o">]</span> JSON_EXTRACT nested layer 1: Map can be populated only by Bool, Double, Int, String value and null, now trying to parse from: object
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.functionCall <span class="o">(</span><span class="m">2</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.time
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.time <span class="o">(</span><span class="m">0</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.returnType
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.returnType <span class="o">(</span><span class="m">0</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.SchemaRelated
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.SchemaRelated <span class="o">(</span><span class="m">0</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.ScalarFunctionTest
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.ScalarFunctionTest <span class="o">(</span><span class="m">0</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.ListFunctionTest
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.ListFunctionTest <span class="o">(</span><span class="m">0</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.duplicateEdgesORVerticesInPath
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.duplicateEdgesORVerticesInPath <span class="o">(</span><span class="m">0</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.ReversePath
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.ReversePath <span class="o">(</span><span class="m">0</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.DataSetRowCol
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.DataSetRowCol <span class="o">(</span><span class="m">0</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> RUN      <span class="o">]</span> FunctionManagerTest.PurityTest
</span></span><span class="line"><span class="cl"><span class="o">[</span>       OK <span class="o">]</span> FunctionManagerTest.PurityTest <span class="o">(</span><span class="m">0</span> ms<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>----------<span class="o">]</span> <span class="m">11</span> tests from FunctionManagerTest <span class="o">(</span><span class="m">5</span> ms total<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>----------<span class="o">]</span> Global <span class="nb">test</span> environment tear-down
</span></span><span class="line"><span class="cl"><span class="o">[==========]</span> <span class="m">11</span> tests from <span class="m">1</span> <span class="nb">test</span> suite ran. <span class="o">(</span><span class="m">5</span> ms total<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>  PASSED  <span class="o">]</span> <span class="m">11</span> tests.
</span></span></code></pre></td></tr></table>
</div>
</div><p>成功！</p>
<p>于是，我把新的更改提交到远程分支上，在 PR 的网页中，可以看到 CI 已经在新的提交的触发下重新编译、执行了，过一会儿果然都 pass 了，于是我兴高采烈地等待着两位以上的审查者帮忙批准代码，然后合并它！</p>
<p>但是，我收到了新的建议：</p>
<p><a class="lightgallery" href="https://user-images.githubusercontent.com/1651790/197553025-82f1e7e5-b8a8-4729-a9b8-0f13a34adfed.png" title="https://user-images.githubusercontent.com/1651790/197553025-82f1e7e5-b8a8-4729-a9b8-0f13a34adfed.png" data-thumbnail="https://user-images.githubusercontent.com/1651790/197553025-82f1e7e5-b8a8-4729-a9b8-0f13a34adfed.png">
        
    </a></p>
<p>另一位贡献者请我添加 TCK 的测试用例。</p>
<h4 id="tck" class="headerLink">
    <a href="#tck" class="header-mark"></a>5.2.2 TCK</h4><p>TCK 的全称是 The Cypher Technology Compatibility Kit，它是 NebulaGraph 从 OpenCypher 社区继承演进而来的一套测试框架，我们用 Python 做了测试用例格式兼容的实现。</p>
<p>它的优雅在于，我们可以像写英语一样去描述我们想实现的端到端功能测试用例，像这样！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-tcl" data-lang="tcl"><span class="line"><span class="cl"><span class="c"># tests/tck/features/function/json_extract.feature
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">Feature</span><span class="o">:</span> json_extract Function
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">Background</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nv">Test</span> json_extract function
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">Scenario</span><span class="o">:</span> Test Positive Cases
</span></span><span class="line"><span class="cl">    <span class="nv">When</span> executing query:
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">      YIELD JSON_EXTRACT(&#39;{&#34;</span><span class="nv">a</span><span class="s2">&#34;: &#34;</span>foo<span class="s2">&#34;, &#34;</span>b<span class="s2">&#34;: 0.2, &#34;</span>c<span class="s2">&#34;: true}&#39;) AS result;
</span></span></span><span class="line"><span class="cl"><span class="s2">      &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">Then</span> the result should be<span class="err">,</span> <span class="ow">in</span> any order:
</span></span><span class="line"><span class="cl">      <span class="o">|</span> <span class="nv">result</span>                      <span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="o">|</span> <span class="k">{</span><span class="nv">a</span><span class="o">:</span> <span class="s2">&#34;foo&#34;</span><span class="err">,</span> b: <span class="mf">0.2</span><span class="err">,</span> c: true<span class="k">}</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="nv">When</span> executing query:
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">      YIELD JSON_EXTRACT(&#39;{&#34;</span><span class="nv">a</span><span class="s2">&#34;: 1, &#34;</span>b<span class="s2">&#34;: {}, &#34;</span>c<span class="s2">&#34;: {&#34;</span>d<span class="s2">&#34;: true}}&#39;) AS result;
</span></span></span><span class="line"><span class="cl"><span class="s2">      &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">Then</span> the result should be<span class="err">,</span> <span class="ow">in</span> any order:
</span></span><span class="line"><span class="cl">      <span class="o">|</span> <span class="nv">result</span>                      <span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="o">|</span> <span class="k">{</span><span class="nv">a</span><span class="o">:</span> <span class="mi">1</span><span class="err">,</span> b: <span class="k">{}</span><span class="err">,</span> c: <span class="k">{</span><span class="nv">d</span><span class="o">:</span> true<span class="k">}}</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="nv">When</span> executing query:
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">      YIELD JSON_EXTRACT(&#39;{}&#39;) AS result;
</span></span></span><span class="line"><span class="cl"><span class="s2">      &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">Then</span> the result should be<span class="err">,</span> <span class="ow">in</span> any order:
</span></span><span class="line"><span class="cl">      <span class="o">|</span> <span class="nv">result</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="o">|</span> <span class="k">{}</span>     <span class="o">|</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>在添加了自己的一个新的 tck 测试用例文本文件之后，我们只需要在测试文件中临时增加标签，并在执行的时候指定标签，就可以单独执行新增的 tck 测试用例了：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 还是在编译容器内部，进入到 tests 目录下</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ../tests
</span></span><span class="line"><span class="cl"><span class="c1"># 安装 tck 测试所需依赖</span>
</span></span><span class="line"><span class="cl">python3 -m pip install -r requirements.txt
</span></span><span class="line"><span class="cl">python3 -m pip install nebula3-python<span class="o">==</span>3.1.0
</span></span><span class="line"><span class="cl"><span class="c1"># 运行一个单独为 tck 测试准备的集群</span>
</span></span><span class="line"><span class="cl">make <span class="nv">CONTAINERIZED</span><span class="o">=</span><span class="nb">true</span> <span class="nv">ENABLE_SSL</span><span class="o">=</span><span class="nb">true</span> <span class="nv">CA_SIGNED</span><span class="o">=</span><span class="nb">true</span> up
</span></span><span class="line"><span class="cl"><span class="c1"># 给 tests/tck/features/function/json_extract.feature 以@开头第一行加上标签，比如 @wey</span>
</span></span><span class="line"><span class="cl">vi tests/tck/features/function/json_extract.feature
</span></span><span class="line"><span class="cl"><span class="c1"># 执行 pytest (包含 tck 用例)，因为制定了 -m &#34;wey&#34;，只有 tests/tck/features/function/json_extract.feature 会被执行</span>
</span></span><span class="line"><span class="cl">python3 -m pytest -m <span class="s2">&#34;wey&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 关闭 pytest 所依赖的集群</span>
</span></span><span class="line"><span class="cl">make <span class="nv">CONTAINERIZED</span><span class="o">=</span><span class="nb">true</span> <span class="nv">ENABLE_SSL</span><span class="o">=</span><span class="nb">true</span> <span class="nv">CA_SIGNED</span><span class="o">=</span><span class="nb">true</span> down
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>延伸阅读：</p>
<ul>
<li>基于 BDD 理论的 Nebula 集成测试框架重构，https://nebula-graph.com.cn/posts/bdd-testing-practice</li>
<li>如何向 NebulaGraph 增加一个测试用例，https://nebula-graph.com.cn/posts/bdd-testing-practice-add-test-case</li>
</ul>
</blockquote>
<h3 id="邀请再次-review" class="headerLink">
    <a href="#%e9%82%80%e8%af%b7%e5%86%8d%e6%ac%a1-review" class="header-mark"></a>5.3 邀请再次 review</h3><p>待我们把需要的测试调通、再次提交 PR 并且 CI 用例全都通过之后，我们可以再次邀请之前帮助审查代码的同学做做最后的查看，如果一切都顺利，代码就会被合并了！</p>
<p><a class="lightgallery" href="https://user-images.githubusercontent.com/1651790/197557709-2c851a03-d001-4fc9-bc5a-b858219fbded.png" title="https://user-images.githubusercontent.com/1651790/197557709-2c851a03-d001-4fc9-bc5a-b858219fbded.png" data-thumbnail="https://user-images.githubusercontent.com/1651790/197557709-2c851a03-d001-4fc9-bc5a-b858219fbded.png">
        
    </a></p>
<blockquote>
<p>题图来自 <a href="https://unsplash.com/photos/TGEWJXylgJk" target="_blank" rel="noopener noreferrer">Jon</a></p>
</blockquote>]]></description>
</item><item>
    <title>基于图数据库的推荐系统</title>
    <link>https://siwei.io/recommendation-system-with-graphdb/</link>
    <pubDate>Tue, 25 Oct 2022 10:24:15 &#43;0800</pubDate><author>
        <name>Wey Gu</name>
    </author><guid>https://siwei.io/recommendation-system-with-graphdb/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/recommendation-system-with-graphdb/featured-image.webp" referrerpolicy="no-referrer">
            </div><h2 id="基于图数据库的推荐系统" class="headerLink">
    <a href="#%e5%9f%ba%e4%ba%8e%e5%9b%be%e6%95%b0%e6%8d%ae%e5%ba%93%e7%9a%84%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f" class="header-mark"></a>1 基于图数据库的推荐系统</h2><blockquote>
<p>本文是一个基于 NebulaGraph 上图算法、图数据库、机器学习、GNN 的推荐系统方法综述，大部分介绍的方法提供了 Playground 供大家学习。</p>
</blockquote>
<!--

[TOC]

-->
<h3 id="基本概念" class="headerLink">
    <a href="#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" class="header-mark"></a>1.1 基本概念</h3><p>推荐系统诞生的初衷是解决互联网时代才面临的信息量过载问题，从最初的 Amazon 图书推荐、商品推荐，到电影、音乐、视频、新闻推荐，如今大多数网站、App 中都有至少一个基于推荐系统生成的供用户选择的物品列表界面。而这些物品的推荐基本都是基于用户喜好、物品的特征、用户与物品交互历史和其他相关上下文去做的。</p>
<p>一个推荐系统会包含以下几个部分：</p>
<ul>
<li>数据、特征的处理</li>
<li>从特征出发，生成推荐列表</li>
<li>过滤、排序推荐列表</li>
</ul>
<p>这其中，过滤的核心方法主要有两种：基于内容的过滤（Content-Based Filtering）、与协同过滤（Collaborative Filtering）。</p>
<h4 id="基于内容的过滤" class="headerLink">
    <a href="#%e5%9f%ba%e4%ba%8e%e5%86%85%e5%ae%b9%e7%9a%84%e8%bf%87%e6%bb%a4" class="header-mark"></a>1.1.1 基于内容的过滤</h4><p>内容过滤方法的本质是给用户的偏好做画像，同时对所有待推荐的物品计算特征，做用户的画像与待推荐物品特征之间的距离运算，过滤得到相近的物品。</p>
<blockquote>
<p>ref: <a href="https://www.ise.bgu.ac.il/faculty/liorr/recsyshb/chContent.pdf" target="_blank" rel="noopener noreferrer">https://www.ise.bgu.ac.il/faculty/liorr/recsyshb/chContent.pdf</a></p>
</blockquote>
<p>内容过滤的方法的好处有：</p>
<ul>
<li>清晰的可解释性，无论是对用户的画像分析，还是对物品的运算本身天然带来了排序、过滤的可解释性</li>
<li>用户数据输入的独立性，对给定的待推荐用户来说，只需要单独分析他们的画像和历史评分就足够了</li>
<li>规避新物品冷启动问题，对于新的添加的物品，即使没有任何历史的用户评价，也可以做出推荐</li>
</ul>
<p>同时，基于内容过滤的挑战与劣势也有：</p>
<ul>
<li>特征提取，提取待推荐物品的特征并非总是很容易地，比如照片、视频等非纯文本的物品，而且往往这些物品的特征提取依赖领域专家知识，比如电影推荐系统中需要抽离出导演、电影分类等领域知识作为特征</li>
<li>不擅长突破舒适圈，发掘用户的潜在新兴趣点</li>
<li>存在新用户冷启动问题，对少有信息作为用户画像的用户来说，缺少做进一步物品画像、特种距离运算的输入</li>
</ul>
<h4 id="基于协同过滤" class="headerLink">
    <a href="#%e5%9f%ba%e4%ba%8e%e5%8d%8f%e5%90%8c%e8%bf%87%e6%bb%a4" class="header-mark"></a>1.1.2 基于协同过滤</h4><p>协同过滤方法本质是协同用户与系统之间的交互行为去给出推荐物品。</p>
<p>协同过滤的方法又分为<strong>基于记忆</strong>（memory-based）的与<strong>基于模型</strong>（model-based）的。</p>
<p>前者主要有物品与物品之间的协同过滤（ItemCF）和用户与用户之间的协同过滤（UserCF），ItemCF 简单来说是推荐和用户之前选择过的物品类似的物品：根据行为找物品之间的相似性，UserCF 则推荐与之有共同爱好的用户喜欢的物品：根据行为找用户之间的相似性；</p>
<p>而后者基于展现用户喜好的历史实践信息、利用统计与机器学习方法训练模型，对新的用户偏好进行推理。</p>
<p>协同过滤的方法的好处有：</p>
<ul>
<li>无需对非结构化物品进行特征分析，因为协同过滤关注的是用户和物品之间的协同交互，这绕过了对物品领域知识处理的需求</li>
<li>对用户的个性化更强，更细，基于行为的分析使得对用户偏好的划分本质上是连续的（相比来说，对用户做画像的方法则是离散的），这样的推荐结果会更加“千人千面”，同时，也会蕴含内容过滤、有限的画像角度之下的“惊喜”推荐</li>
</ul>
<p>而它的缺点有：</p>
<ul>
<li>有新用户和新物件上的冷启动问题，因为它们身上都缺少历史喜好行为的信息</li>
</ul>
<blockquote>
<p>ref: <a href="https://coek.info/pdf-a-dynamic-collaborative-filtering-system-via-a-weighted-clustering-approach-.html" target="_blank" rel="noopener noreferrer">https://coek.info/pdf-a-dynamic-collaborative-filtering-system-via-a-weighted-clustering-approach-.html</a></p>
</blockquote>
<p>从以上两种主要的过滤方式的优劣中我们可以看到，它们之中存在互补的地方，比如新物件的冷启动上，基于内容的过滤有优势，对于个性化、惊喜推荐角度，协同过滤有优势。所以，在真实世界中，推荐系统在大多演化地比上边的归类复杂得多，而且常常是多种方法的融合。</p>
<h3 id="基于图的个性推荐" class="headerLink">
    <a href="#%e5%9f%ba%e4%ba%8e%e5%9b%be%e7%9a%84%e4%b8%aa%e6%80%a7%e6%8e%a8%e8%8d%90" class="header-mark"></a>1.2 基于图的个性推荐</h3><p>图技术、图数据库技术在推荐系统中的应用是多方面的，本章我们就从图数据库的出发点上给出多种应用的例子。</p>
<h4 id="建立图谱" class="headerLink">
    <a href="#%e5%bb%ba%e7%ab%8b%e5%9b%be%e8%b0%b1" class="header-mark"></a>1.2.1 建立图谱</h4><p>在开始之前，我简单介绍一下本文使用的图数据集。</p>
<p>为了给出更接近实际情况的例子，我从两个公开的数据集 <a href="https://www.omdb.org/en/us/content/Help:DataDownload" target="_blank" rel="noopener noreferrer">OMDB</a> 和 <a href="https://grouplens.org/datasets/movielens/" target="_blank" rel="noopener noreferrer">MovieLens</a> 中分别抽取了需要的信息，组成了一个既包含电影的卡司（导演、演员）和类型、又包含用户对电影评分记录的知识图谱。</p>
<p>它的 Scehma 如下：</p>
<ul>
<li>
<p>顶点：</p>
<ul>
<li>
<p>user(user_id)</p>
</li>
<li>
<p>movie(name)</p>
</li>
<li>
<p>person(name, birthdate)</p>
</li>
<li>
<p>genre(name)</p>
</li>
</ul>
</li>
<li>
<p>边：</p>
<ul>
<li>
<p>watched(rate(double))</p>
</li>
<li>
<p>with_genre</p>
</li>
<li>
<p>directed_by</p>
</li>
<li>
<p>acted_by</p>
</li>
</ul>
</li>
</ul>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/schema_0.webp" title="schema_0" data-thumbnail="/recommendation-system-with-graphdb/schema_0.webp">
        
    </a></p>
<p>这个数据的准备、ETL 过程会在另外的文章里详细介绍，在进入下一章节之前，我们可以用 Nebula-Up 一键搭起一个测试的 NebulaGraph 单机集群，然后参考数据集的 GitHub 仓库，一键导入所需数据：</p>
<blockquote>
<p>注：</p>
<ul>
<li>
<p>Nebula-UP：https://github.com/wey-gu/nebula-up</p>
</li>
<li>
<p>数据集仓库：https://github.com/wey-gu/movie-recommendation-dataset</p>
</li>
</ul>
</blockquote>
<p>过程最简单的操作过程为：</p>
<ul>
<li>用 Nebula-Up 安装 NebulaGraph</li>
<li>克隆 movie-recommendation-dataset</li>
<li>导入数据集 NebulaGraph</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -fsSL nebula-up.siwei.io/install.sh <span class="p">|</span> bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git clone https://github.com/wey-gu/movie-recommendation-dataset.git <span class="o">&amp;&amp;</span> <span class="nb">cd</span> movie-recommendation-dataset
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker run --rm -ti <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --network<span class="o">=</span>nebula-net <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>:/root/ <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/dbt_project/to_nebulagraph/:/data <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    vesoft/nebula-importer:v3.2.0 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --config /root/nebula-importer.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="基于内容的过滤-1" class="headerLink">
    <a href="#%e5%9f%ba%e4%ba%8e%e5%86%85%e5%ae%b9%e7%9a%84%e8%bf%87%e6%bb%a4-1" class="header-mark"></a>1.2.2 基于内容的过滤</h4><p>CBF 的思想是利用领域知识、历史记录、元数据分别对用户和物件做画像、打标签，最终根据用户的标签与待推荐物件之间的距离评分排序给出推荐。</p>
<p>对用户的画像不涉及其他用户的信息，但是输入的特征可能来源于元数据（生日、国籍、性别、年龄），历史记录（评论、打分、购买、浏览）等等，在这些基础之上对用户进行标签标注、分类、聚类。</p>
<p>对物件的画像输入的特征可能是基于语言处理（NLP、TF-IDF、LFM）、专家标注、多媒体处理（视觉到文字再NLP、音频风格处理、音频到文字再NLP）等。</p>
<p>有了用户画像与物件的画像特征、对用户涉及的画像进行相关画像物件中新对象的近似度计算，再评分加权，就可以获得最终的推荐排序了。这其中的近似度计算可以是常见的 KNN，余弦相似，Jaccard 相似等各种方法。</p>
<p>CBF 的方法中没有限定具体实现方式，如前边介绍，可能是基于机器学习、elasticsearch、图谱等不同的方法。这里为切合本章的主题，我给出一个基于图数据库、图谱上的 CBF 的例子，做一个电影推荐系统，能让读者理解这个方法的思想的同时熟悉图数据库、知识图谱的方法。</p>
<p>这其中用户的特征我们直接利用历史电影评价记录，而推荐物件：电影，的画像则来自于领域中的知识。这些知识有：电影风格、电影的卡斯、导演。近似度这里我们就采用图谱中基于关系的 Jaccard 相似度算法。</p>
<h5 id="jaccard-index" class="headerLink">
    <a href="#jaccard-index" class="header-mark"></a>1.2.2.1 Jaccard Index</h5><p><a href="https://en.wikipedia.org/wiki/Jaccard_index" target="_blank" rel="noopener noreferrer">Jaccard Index</a> 是一个描述两个集合距离的定义公式，非常简单、符合直觉地取两者的交集与并集测度的比例，它的定义记为：
$$
J(A,B)= \frac {|A\cap B|}{|A\cup B|}
$$
这里，我们把交集理解为 A 与 B 共同连接的点（有共同的导演、电影类型、演员），并集理解为这几种关系下与 A 或者 B 直连的所有点，而测度就直接用数量表示。</p>
<h5 id="cbf-方法在-nebulagraph-中的实现" class="headerLink">
    <a href="#cbf-%e6%96%b9%e6%b3%95%e5%9c%a8-nebulagraph-%e4%b8%ad%e7%9a%84%e5%ae%9e%e7%8e%b0" class="header-mark"></a>1.2.2.2 CBF 方法在 NebulaGraph 中的实现</h5><p>CBF 方法分如下几步：</p>
<ul>
<li>找出推荐用户评分过的电影</li>
<li>从用户评分过的电影，经由导演卡司、电影类型找到新的待推荐电影</li>
<li>对看过的电影与新的电影，藉由导演、卡司、电影类型的关系，在图上做 Jaccard 相似性运算，得出每一对看过的电影和待推荐新电影之间的 Jaccard 系数</li>
<li>把用户对看过电影的评分作为加权系数，针对其到每一个新电影之间的 Jaccard 系数加权评分，获得排序后的推荐电影列表</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">用户</span><span class="w"> </span><span class="n">u_124</span><span class="w"> </span><span class="err">看过的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">根据电影的标注关系找到备选推荐电影，刨除看过的，把评分、交集关联链路的数量传下去</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">recomm</span><span class="p">,</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="nf">COLLECT</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="o">-----------------------------------------------</span><span class="c1">--
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">// 针对每一对 m 和 recomm：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">//</span><span class="w"> </span><span class="err">开始计算看过的电影，集合</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">的部分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">set_a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算推荐电影，集合</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="err">的部分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">set_a</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">set_b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">得到并集数量</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="nf">toFloat</span><span class="p">(</span><span class="n">intersection_size</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">toSet</span><span class="p">(</span><span class="n">set_a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">set_b</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">A_U_B</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">得到每一对</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="err">和</span><span class="w"> </span><span class="n">recomm</span><span class="w"> </span><span class="err">的</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A_N_B</span><span class="o">/</span><span class="n">A_U_B</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="o">/</span><span class="nf">size</span><span class="p">(</span><span class="n">A_U_B</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">jaccard_index</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="o">-----------------------------------------------</span><span class="c1">--
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">// 得到每一个被推荐的电影 recomm_id，经由不同看过电影推荐链路的相似度 = 评分 * jaccard_index
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">WITH</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">rate</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">jaccard_index</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">score</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">对每一个</span><span class="w"> </span><span class="n">recomm_id</span><span class="w"> </span><span class="err">按照</span><span class="w"> </span><span class="n">m_id</span><span class="w"> </span><span class="err">加权求得相似度的和，为总的推荐程度评分，降序排列</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>上边查询的执行结果截取出来是：</p>
<table>
<thead>
<tr>
<th style="text-align:left">recomm_id</th>
<th style="text-align:left">sim_score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1891</td>
<td style="text-align:left">0.2705882352941177</td>
</tr>
<tr>
<td style="text-align:left">1892</td>
<td style="text-align:left">0.22278481012658227</td>
</tr>
<tr>
<td style="text-align:left">1894</td>
<td style="text-align:left">0.15555555555555556</td>
</tr>
<tr>
<td style="text-align:left">808</td>
<td style="text-align:left">0.144</td>
</tr>
<tr>
<td style="text-align:left">1895</td>
<td style="text-align:left">0.13999999999999999</td>
</tr>
<tr>
<td style="text-align:left">85</td>
<td style="text-align:left">0.12631578947368421</td>
</tr>
<tr>
<td style="text-align:left">348</td>
<td style="text-align:left">0.12413793103448277</td>
</tr>
<tr>
<td style="text-align:left">18746</td>
<td style="text-align:left">0.11666666666666668</td>
</tr>
<tr>
<td style="text-align:left">628</td>
<td style="text-align:left">0.11636363636363636</td>
</tr>
<tr>
<td style="text-align:left">3005</td>
<td style="text-align:left">0.10566037735849057</td>
</tr>
</tbody>
</table>
<h5 id="可视化分析" class="headerLink">
    <a href="#%e5%8f%af%e8%a7%86%e5%8c%96%e5%88%86%e6%9e%90" class="header-mark"></a>1.2.2.3 可视化分析</h5><p>我们把整个过程中的一些步骤的查询修改一下为 <code>p=xxx</code> 的方式，并渲染出来，会更加方便理解</p>
<ul>
<li>
<p>用户 u_124 看过的、评分过的电影</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">用户</span><span class="w"> </span><span class="n">u_124</span><span class="w"> </span><span class="err">看过的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="/recommendation-system-with-graphdb/CBF_step0.webp" title="CBF_step0" data-thumbnail="/recommendation-system-with-graphdb/CBF_step0.webp">
        
    </a></p>
</li>
<li>
<p>下一步找到这些看过的电影在相同的演员、导演、电影类型的关系上，图谱关联的所有其他电影</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">用户</span><span class="w"> </span><span class="n">u_124</span><span class="w"> </span><span class="err">看过的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">根据电影的标注关系找到备选推荐电影，刨除看过的，把评分、交集关联链路的数量传下去</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="nf">COLLECT</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">500</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到用户看过电影经由演员、类型扩散出好多新的电影</p>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/CBF_step1.webp" title="CBF_step1" data-thumbnail="/recommendation-system-with-graphdb/CBF_step1.webp">
        
    </a></p>
</li>
<li>
<p>在得到这些待推荐电影以及推荐路径之后，通过 Jaccard 系数与用户在路径第一条边上的评分综合评定之后，得到了最终的结果，这里我们把结果再可视化一下：取得它们和用户之间的路径并渲染出来</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">用户</span><span class="w"> </span><span class="n">u_124</span><span class="w"> </span><span class="err">看过的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">根据电影的标注关系找到备选推荐电影，刨除看过的，把评分、交集关联链路的数量传下去</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">recomm</span><span class="p">,</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="nf">COLLECT</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="o">-----------------------------------------------</span><span class="c1">--
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">// 针对每一对 m 和 recomm：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">//</span><span class="w"> </span><span class="err">开始计算看过的电影，集合</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">的部分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">set_a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算推荐电影，集合</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="err">的部分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">set_a</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">set_b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">得到并集数量</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="nf">toFloat</span><span class="p">(</span><span class="n">intersection_size</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">toSet</span><span class="p">(</span><span class="n">set_a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">set_b</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">A_U_B</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">得到每一对</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="err">和</span><span class="w"> </span><span class="n">recomm</span><span class="w"> </span><span class="err">的</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A_N_B</span><span class="o">/</span><span class="n">A_U_B</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="o">/</span><span class="nf">size</span><span class="p">(</span><span class="n">A_U_B</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">jaccard_index</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="o">-----------------------------------------------</span><span class="c1">--
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">// 得到每一个被推荐的电影 recomm_id，经由不同看过电影推荐链路的相似度 = 评分 * jaccard_index
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">WITH</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">rate</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">jaccard_index</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">score</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">对每一个</span><span class="w"> </span><span class="n">recomm_id</span><span class="w"> </span><span class="err">按照</span><span class="w"> </span><span class="n">m_id</span><span class="w"> </span><span class="err">加权求得相似度的和，为总的推荐程度评分，降序排列</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="n">recomm_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">recomm_ids</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">directed_by</span><span class="o">|</span><span class="n">acted_by</span><span class="o">|</span><span class="n">with_genre</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">recomm_ids</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>哇，我们可以很清晰地看到推荐的理由路径（喜欢星战，进而由多条共同的类型、演员、导演引导出未观看的几部星战电影），这其实就是 CBF 的优势之一：天然具有较好的可解释性。</p>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/CBF_step2.webp" title="CBF_step2" data-thumbnail="/recommendation-system-with-graphdb/CBF_step2.webp">
        
    </a></p>
</li>
</ul>
<h4 id="基于记忆的协同过滤" class="headerLink">
    <a href="#%e5%9f%ba%e4%ba%8e%e8%ae%b0%e5%bf%86%e7%9a%84%e5%8d%8f%e5%90%8c%e8%bf%87%e6%bb%a4" class="header-mark"></a>1.2.3 基于记忆的协同过滤</h4><p>前边我们提过了，协同过滤主要可以分为两种：</p>
<ul>
<li>User-User CF 是基于多个用户对物件的历史行为，判定用户之间的相似性，然后根据相似用户的选择推荐新的物件。</li>
<li>Item-Item CF 则是判断物件之间的相似性，给用户推荐他喜欢的物品相似的物品。</li>
</ul>
<p>这里，ItemCF 看起来和前边的 CBF 有些类似，他们的核心区别在于 CBF 找到相似物件的方式是基于物件的“内容”本身，是一些领域知识的画像，而 ItemCF 的协同则是考虑用户对物件的历史行为。</p>
<h5 id="itemcf" class="headerLink">
    <a href="#itemcf" class="header-mark"></a>1.2.3.1 ItemCF</h5><p>这个方法分如下几步：</p>
<ul>
<li>找出推荐用户评分过的电影</li>
<li>经由用户的高评分电影，找到其他给出高评分用户所看过的新的高评分电影</li>
<li>对看过的电影与新的电影，藉由用户的评分，在图上做 Jaccard 相似性运算，得出每一对看过的电影和待推荐新电影之间的 Jaccard 系数</li>
<li>把用户对看过电影的评分作为加权系数，针对其到每一个新电影之间的 Jaccard 系数加权评分，获得排序后的推荐电影列表</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">用户</span><span class="w"> </span><span class="n">u_124</span><span class="w"> </span><span class="err">看过的并给出高评分的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">根据同样也看过这些电影，并给出高评分的用户，得出待推荐的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">intersection</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">3</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">recomm</span><span class="p">,</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="nf">COLLECT</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="o">-----------------------------------------------</span><span class="c1">--
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">// 针对每一对 m 和 recomm：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">//</span><span class="w"> </span><span class="err">开始计算看过的电影，集合</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">的部分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">intersection</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">set_a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算推荐电影，集合</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="err">的部分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">intersection</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">set_a</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">set_b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">得到并集数量</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="nf">toFloat</span><span class="p">(</span><span class="n">intersection_size</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">toSet</span><span class="p">(</span><span class="n">set_a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">set_b</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">A_U_B</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">得到每一对</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="err">和</span><span class="w"> </span><span class="n">recomm</span><span class="w"> </span><span class="err">的</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A_N_B</span><span class="o">/</span><span class="n">A_U_B</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="o">/</span><span class="nf">size</span><span class="p">(</span><span class="n">A_U_B</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">jaccard_index</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="o">-----------------------------------------------</span><span class="c1">--
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">// 得到每一个被推荐的电影 recomm_id，经由不同看过电影推荐链路的相似度 = 评分 * jaccard_index
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">WITH</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">rate</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">jaccard_index</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">score</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">对每一个</span><span class="w"> </span><span class="n">recomm_id</span><span class="w"> </span><span class="err">按照</span><span class="w"> </span><span class="n">m_id</span><span class="w"> </span><span class="err">加权求得相似度的和，为总的推荐程度评分，降序排列，只取正值</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>结果：</p>
<table>
<thead>
<tr>
<th style="text-align:left">recomm_id</th>
<th style="text-align:left">sim_score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">832</td>
<td style="text-align:left">0.8428369424692955</td>
</tr>
<tr>
<td style="text-align:left">114707</td>
<td style="text-align:left">0.7913842214590154</td>
</tr>
<tr>
<td style="text-align:left">64957</td>
<td style="text-align:left">0.6924673321504288</td>
</tr>
<tr>
<td style="text-align:left">120880</td>
<td style="text-align:left">0.5775219768736295</td>
</tr>
<tr>
<td style="text-align:left">807</td>
<td style="text-align:left">0.497532028328161</td>
</tr>
<tr>
<td style="text-align:left">473</td>
<td style="text-align:left">0.4748322300870322</td>
</tr>
<tr>
<td style="text-align:left">52797</td>
<td style="text-align:left">0.2311965559170528</td>
</tr>
<tr>
<td style="text-align:left">12768</td>
<td style="text-align:left">0.19642857142857142</td>
</tr>
<tr>
<td style="text-align:left">167058</td>
<td style="text-align:left">0.19642857142857142</td>
</tr>
</tbody>
</table>
<h5 id="可视化分析-itemcf" class="headerLink">
    <a href="#%e5%8f%af%e8%a7%86%e5%8c%96%e5%88%86%e6%9e%90-itemcf" class="header-mark"></a>1.2.3.2 可视化分析 ItemCF</h5><p>同样，我们把整个过程中的一些步骤的查询修改一下为 <code>p=xxx</code> 的方式，并渲染出来，看看可以看出什么有意思的的洞察。</p>
<ul>
<li>
<p>找出推荐用户评分过的电影</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">用户</span><span class="w"> </span><span class="n">u_124</span><span class="w"> </span><span class="err">看过的并给出高评分的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>它们是：</p>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/ItemCF_step0.webp" title="ItemCF_step0" data-thumbnail="/recommendation-system-with-graphdb/ItemCF_step0.webp">
        
    </a></p>
</li>
<li>
<p>经由用户的高评分电影，找到其他给出高评分用户所看过的新的高评分电影，修改结果为路径</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">用户</span><span class="w"> </span><span class="n">u_124</span><span class="w"> </span><span class="err">看过的并给出高评分的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">根据同样也看过这些电影，并给出高评分的用户，得出待推荐的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">intersection</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">3</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="nf">COLLECT</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">200</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到待推荐的电影在路径的右边末端，中间连接着的都是其他用户的推荐记录，它的模式和 CBF 真的很像，只不过关联的关系不是具体的内容，而是行为。</p>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/ItemCF_step1.webp" title="ItemCF_step1" data-thumbnail="/recommendation-system-with-graphdb/ItemCF_step1.webp">
        
    </a></p>
</li>
<li>
<p>在对看过的电影与新的电影，藉由用户的评分，在图上做 Jaccard 相似性运算，得出每一对看过的电影和待推荐新电影之间的 Jaccard 系数之后。把用户对看过电影的评分作为加权系数，针对其到每一个新电影之间的 Jaccard 系数加权评分，获得排序后的推荐电影列表，我们同样改造一下最终的查询为路径，并渲染前 500 条路径：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">用户</span><span class="w"> </span><span class="n">u_124</span><span class="w"> </span><span class="err">看过的并给出高评分的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">根据同样也看过这些电影，并给出高评分的用户，得出待推荐的电影</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">intersection</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">3</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">recomm</span><span class="p">,</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="nf">COLLECT</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">intersection_size</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="o">-----------------------------------------------</span><span class="c1">--
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">// 针对每一对 m 和 recomm：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">//</span><span class="w"> </span><span class="err">开始计算看过的电影，集合</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">的部分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">intersection</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">set_a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算推荐电影，集合</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="err">的部分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">intersection</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">set_a</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">intersection</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">set_b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">得到并集数量</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="nf">toFloat</span><span class="p">(</span><span class="n">intersection_size</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">intersection_size</span><span class="p">,</span><span class="w"> </span><span class="nf">toSet</span><span class="p">(</span><span class="n">set_a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">set_b</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">A_U_B</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">得到每一对</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="err">和</span><span class="w"> </span><span class="n">recomm</span><span class="w"> </span><span class="err">的</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A_N_B</span><span class="o">/</span><span class="n">A_U_B</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">intersection_size</span><span class="o">/</span><span class="nf">size</span><span class="p">(</span><span class="n">A_U_B</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">jaccard_index</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">Jaccard</span><span class="w"> </span><span class="k">index</span><span class="o">-----------------------------------------------</span><span class="c1">--
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">
</span></span></span><span class="line"><span class="cl"><span class="c1">// 得到每一个被推荐的电影 recomm_id，经由不同看过电影推荐链路的相似度 = 评分 * jaccard_index
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">WITH</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="n">m_id</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">rate</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">jaccard_index</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">score</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">对每一个</span><span class="w"> </span><span class="n">recomm_id</span><span class="w"> </span><span class="err">按照</span><span class="w"> </span><span class="n">m_id</span><span class="w"> </span><span class="err">加权求得相似度的和，为总的推荐程度评分，降序排列，只取正值</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">recomm_id</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">recomm_id</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="n">recomm_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">recomm_ids</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">intersection</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">recomm_ids</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="mi">500</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>可以看出最北推荐的两个电影是被几乎所有看过并给出中高评分的用户共同看过的中高评分电影</p>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/ItemCF_step2.webp" title="ItemCF_step2" data-thumbnail="/recommendation-system-with-graphdb/ItemCF_step2.webp">
        
    </a></p>
</li>
</ul>
<h5 id="关于高评分" class="headerLink">
    <a href="#%e5%85%b3%e4%ba%8e%e9%ab%98%e8%af%84%e5%88%86" class="header-mark"></a>1.2.3.3 关于”高评分“</h5><p>这其中还有很多可以进一步优化的点，比如其中写死了“高评分”是高于 3 的评分，这样有时候不免有失客观，一个可能更合理可行的方式是针对每一个用户，取得这个用户所有评分的平均值，然后取得与平均值相差的比例或者绝对值判定高低。此外，我们在通过 Jaccard 相似性判断每一个看过的电影和对应推荐电影的相似性的时候，并没有考虑这条关联关系：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">intersection</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>之中 e0 与 e1 的评分数值的因素，只是过滤了低评分的关系，这里也有做的更加细致的提升空间。</p>
<p>实际上， Pearson Correlation Coefficient 就是这样一种考虑了关系中的数值进行相似性运算的方法。</p>
<h5 id="pearson-correlation-coefficient" class="headerLink">
    <a href="#pearson-correlation-coefficient" class="header-mark"></a>1.2.3.4 Pearson Correlation Coefficient</h5><p><a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" target="_blank" rel="noopener noreferrer">Pearson Correlation Coefficient</a> （PCC）的定义为：
$$
r_{xy} =\frac{\sum ^n _{i=1}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum ^n _{i=1}(x_i - \bar{x})^2} \sqrt{\sum ^n _{i=1}(y_i - \bar{y})^2}}
$$
相比 Jaccard Index，它把对象之间关系中的数值与自身和所有对象的数值的平均值的差进行累加运算，在考虑了数值比重的同事考虑了数值基于对象自身的相对差异。</p>
<h5 id="usercf" class="headerLink">
    <a href="#usercf" class="header-mark"></a>1.2.3.5 UserCF</h5><p>接下来我们就利用 Pearson Correlation Coefficient 来举例 UserCF 方法。</p>
<p>基于用户的协同过滤方法分如下几步：</p>
<ul>
<li>找出和推荐用户同样给出评分过的电影的用户</li>
<li>运算 Pearson Correlation Coefficient 得到和推荐用户兴趣接近的用户</li>
<li>通过兴趣接近用户得到高评分未观看电影</li>
<li>根据观看用户的 Pearson Correlation Coefficient 加权，排序得推荐电影列表</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">找出和用户</span><span class="w"> </span><span class="n">u_2</span><span class="w"> </span><span class="err">看过相同电影的用户</span><span class="p">,</span><span class="w"> </span><span class="err">得电影评分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">u_sim</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_2&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u_sim</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&#34;u_2&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="err">{</span><span class="n">e0</span><span class="p">:</span><span class="w"> </span><span class="n">e0</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">:</span><span class="w"> </span><span class="n">e1</span><span class="err">}</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">u_2</span><span class="w"> </span><span class="err">和这些用户的</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="nf">avg</span><span class="p">(</span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u_mean</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u_sim</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="n">u_mean</span><span class="p">,</span><span class="w"> </span><span class="nf">avg</span><span class="p">(</span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u_sim_mean</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e_</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">UNWIND</span><span class="w"> </span><span class="n">e_</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">e</span><span class="p">.</span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_mean</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_sim_mean</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">numerator</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="nf">exp2</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_mean</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="nf">exp2</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_sim_mean</span><span class="p">)))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">denominator</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">denominator</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">取</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="err">最大的</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="err">个相似用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">取相似用户给出高评分的新电影，根据相似用户个数对用户相似程度</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="err">加权，获得推荐列表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u_sim</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">recomm</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">pearson_cc</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>结果：</p>
<table>
<thead>
<tr>
<th style="text-align:left">recomm</th>
<th style="text-align:left">sim_score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">(&ldquo;120880&rdquo; :movie{name: &ldquo;I The Movie&rdquo;})</td>
<td style="text-align:left">33.018868012270396</td>
</tr>
<tr>
<td style="text-align:left">(&ldquo;167058&rdquo; :movie{name: &ldquo;We&rdquo;})</td>
<td style="text-align:left">22.38531462958867</td>
</tr>
<tr>
<td style="text-align:left">(&ldquo;12768&rdquo; :movie{name: &ldquo;We&rdquo;})</td>
<td style="text-align:left">22.38531462958867</td>
</tr>
<tr>
<td style="text-align:left">(&ldquo;55207&rdquo; :movie{name: &ldquo;Silence&rdquo;})</td>
<td style="text-align:left">22.342886447570585</td>
</tr>
<tr>
<td style="text-align:left">(&ldquo;170339&rdquo; :movie{name: &ldquo;Silence&rdquo;})</td>
<td style="text-align:left">22.342886447570585</td>
</tr>
<tr>
<td style="text-align:left">(&ldquo;114707&rdquo; :movie{name: &ldquo;Raid&rdquo;})</td>
<td style="text-align:left">21.384280909249796</td>
</tr>
<tr>
<td style="text-align:left">(&ldquo;10&rdquo; :movie{name: &ldquo;Star Wars&rdquo;})</td>
<td style="text-align:left">19.51546960750133</td>
</tr>
<tr>
<td style="text-align:left">(&ldquo;11&rdquo; :movie{name: &ldquo;Star Wars&rdquo;})</td>
<td style="text-align:left">19.515469607501327</td>
</tr>
<tr>
<td style="text-align:left">(&ldquo;64957&rdquo; :movie{name: &ldquo;Mat&rdquo;})</td>
<td style="text-align:left">18.142639694676603</td>
</tr>
<tr>
<td style="text-align:left">(&ldquo;187689&rdquo; :movie{name: &ldquo;Sin&rdquo;})</td>
<td style="text-align:left">18.078111338733557</td>
</tr>
</tbody>
</table>
<h5 id="可视化分析-usercf" class="headerLink">
    <a href="#%e5%8f%af%e8%a7%86%e5%8c%96%e5%88%86%e6%9e%90-usercf" class="header-mark"></a>1.2.3.6 可视化分析 UserCF</h5><p>再看看 UserCF 的可视化结果吧：</p>
<ul>
<li>
<p>找出和推荐用户同样给出评分过的电影的用户</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">找出和用户</span><span class="w"> </span><span class="n">u_2</span><span class="w"> </span><span class="err">看过相同电影的用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">u_sim</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_2&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u_sim</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&#34;u_2&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="/recommendation-system-with-graphdb/UserCF_step0.webp" title="UserCF_step0" data-thumbnail="/recommendation-system-with-graphdb/UserCF_step0.webp">
        
    </a></p>
</li>
<li>
<p>运算 Pearson Correlation Coefficient 得到和推荐用户兴趣接近的用户，输出这些接近的用户</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">找出和用户</span><span class="w"> </span><span class="n">u_2</span><span class="w"> </span><span class="err">看过相同电影的用户</span><span class="p">,</span><span class="w"> </span><span class="err">得电影评分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">u_sim</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_2&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u_sim</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&#34;u_2&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="err">{</span><span class="n">e0</span><span class="p">:</span><span class="w"> </span><span class="n">e0</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">:</span><span class="w"> </span><span class="n">e1</span><span class="err">}</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">u_2</span><span class="w"> </span><span class="err">和这些用户的</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="nf">avg</span><span class="p">(</span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u_mean</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u_sim</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="n">u_mean</span><span class="p">,</span><span class="w"> </span><span class="nf">avg</span><span class="p">(</span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u_sim_mean</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e_</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">UNWIND</span><span class="w"> </span><span class="n">e_</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">e</span><span class="p">.</span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_mean</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_sim_mean</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">numerator</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="nf">exp2</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_mean</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="nf">exp2</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_sim_mean</span><span class="p">)))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">denominator</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">denominator</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">取</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="err">最大的</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="err">个相似用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">u_sim</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>我们给他们标记一下颜色：</p>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/UserCF_step1.webp" title="UserCF_step1" data-thumbnail="/recommendation-system-with-graphdb/UserCF_step1.webp">
        
    </a></p>
</li>
<li>
<p>通过兴趣接近用户得到高评分未观看电影，根据观看用户的 Pearson Correlation Coefficient 加权，排序得推荐电影列表。我们把结果输出为这些相似用户的高评分电影路径：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">找出和用户</span><span class="w"> </span><span class="n">u_2</span><span class="w"> </span><span class="err">看过相同电影的用户</span><span class="p">,</span><span class="w"> </span><span class="err">得电影评分</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">u_sim</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;u_2&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">u_sim</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&#34;u_2&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="nf">collect</span><span class="p">(</span><span class="nf">id</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="nf">COLLECT</span><span class="p">(</span><span class="err">{</span><span class="n">e0</span><span class="p">:</span><span class="w"> </span><span class="n">e0</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">:</span><span class="w"> </span><span class="n">e1</span><span class="err">}</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">计算</span><span class="w"> </span><span class="n">u_2</span><span class="w"> </span><span class="err">和这些用户的</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e0</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="nf">avg</span><span class="p">(</span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u_mean</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">u_sim</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="n">u_mean</span><span class="p">,</span><span class="w"> </span><span class="nf">avg</span><span class="p">(</span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u_sim_mean</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e_</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">UNWIND</span><span class="w"> </span><span class="n">e_</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">e</span><span class="p">.</span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_mean</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_sim_mean</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">numerator</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="nf">exp2</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">e0</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_mean</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="nf">exp2</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u_sim_mean</span><span class="p">)))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">denominator</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">denominator</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">取</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="err">最大的</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="err">个相似用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">u_sim</span><span class="p">,</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="p">,</span><span class="w"> </span><span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">取相似用户给出高评分的新电影，根据相似用户个数对用户相似程度</span><span class="w"> </span><span class="n">pearson_cc</span><span class="w"> </span><span class="err">加权，获得推荐列表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">MATCH</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="n">u_sim</span><span class="p">:</span><span class="o">`</span><span class="k">user</span><span class="o">`</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e1</span><span class="p">:</span><span class="n">watched</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">recomm</span><span class="p">:</span><span class="o">`</span><span class="n">movie</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="n">recomm</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">watched_movies_id</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">e1</span><span class="p">.</span><span class="n">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">recomm</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">pearson_cc</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">sim_score</span><span class="w"> </span><span class="k">DESC</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>得到的结果，我们增量渲染到画布上可以得到：这些 UserCF 推荐而得的电影在路径末端：</p>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/UserCF_step2.webp" title="UserCF_step2" data-thumbnail="/recommendation-system-with-graphdb/UserCF_step2.webp">
        
    </a></p>
<p>在可视化中，相似用户的高评分未观看电影被推荐的思想是不是一目了然了呢？</p>
</li>
</ul>
<h4 id="混合的方法" class="headerLink">
    <a href="#%e6%b7%b7%e5%90%88%e7%9a%84%e6%96%b9%e6%b3%95" class="header-mark"></a>1.2.4 混合的方法</h4><p>在真实世界中，真正达到最好效果的方法通常是结合所有信息的不同方法，共同工作的，这样既可以使得不同角度的有用信息得到充分利用，又能弥补单一方法在不同数据量、不同阶段的弱点。</p>
<p>结合的方法在工程上可以千差万别，这里就不展开了，不过在下边介绍另一类方法的时候，我们会举例一种混合的方式：基于模型。</p>
<h4 id="基于模型的方法" class="headerLink">
    <a href="#%e5%9f%ba%e4%ba%8e%e6%a8%a1%e5%9e%8b%e7%9a%84%e6%96%b9%e6%b3%95" class="header-mark"></a>1.2.5 基于模型的方法</h4><p>直觉上，我们知道除了正向的明确通过基于内容的（电影的领域知识、关系）、协同的（用户与用户、用户与电影之间的交互关系）的算法，也可以把这些信息作为机器学习中的输入特征，用统计学的方法得到一个模型，用来预测用户可能喜欢的物件（电影），这就是基于模型的方法。</p>
<p>基于模型的方法可以很自然地把把以上几种方法的信息同时纳入为特征，这样，它本质上也是混合过滤方法的一种实现了。</p>
<p>基于模型、机器学习的推荐系统方法有很多，这里，因为我们着重以图、图数据库的出发点介绍，我就举例其中的一种方法：基于图神经网络（GNN）。</p>
<p>GNN 的方法可以将图谱中的内容信息（导演、演员、类型）和协同信息（用户-用户、电影-电影、用户-电影之间的相互关系）以知识的方式嵌入，并且方法中的消息传递方式保有了图中的局部性（locality），这使得它可能成为一个非常新颖、有效的推荐系统模型方法。</p>
<h5 id="gnn--图数据库的推荐系统" class="headerLink">
    <a href="#gnn--%e5%9b%be%e6%95%b0%e6%8d%ae%e5%ba%93%e7%9a%84%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f" class="header-mark"></a>1.2.5.1 GNN + 图数据库的推荐系统</h5><p><strong>为什么需要图数据库</strong>？</p>
<p>GNN 的方法中，图数据库只是一个可选项，而我给的 GNN 方法的示例中，图数据库的关键作用是它带来了实时性的可能。</p>
<p>一个实时性推荐系统要求在秒级响应下利用 GNN 训练模型从近实时的输入数据中进行推理，这给我们提出的要求是：</p>
<ul>
<li>输入数据可以实时、近实时获取</li>
<li>推理运算可以实时完成</li>
</ul>
<p>而利用归纳型（Inductive model）的模型从图数据库中实时获取新的数据子图作为推理输入是一个满足这样要求可行的设计方式。</p>
<p>下边是简单的流程图：</p>
<ul>
<li>左边是模型训练，在图谱的二分图（user 和 item）之上建模
<ul>
<li>用户和物件（movie）之间的关系除了交互关系之外，还有预先处理的关系，这些关系被查询获得后再写回图数据库中供后续消费使用，关系有：
<ul>
<li>用户间“相似”关系</li>
<li>物件间不同（共同演员、类型、导演）关系</li>
</ul>
</li>
<li>利用 Nebula-DGL 将图中需要的点、边序列化为 DGL 可以消费的对象</li>
<li>在 DGL 中分割训练、测试、验证集，利用 PinSAGE 模型训练。</li>
<li>导出模型给推荐系统使用</li>
</ul>
</li>
</ul>
<blockquote>
<p>注：</p>
<ul>
<li>
<p>DGL 是非常流行的图深度学习矿建，项目官网：https://www.dgl.ai</p>
</li>
<li>
<p>Nebula-DGL 是一个 NebulaGraph 到 DGL 的连接器，项目地址：https://github.com/wey-gu/nebula-dgl</p>
</li>
<li>
<p>PinSAGE 参考 <a href="https://arxiv.org/abs/1806.01973" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/1806.01973</a> 论文，DGL 中的 PinSAGE 实现其实并不是归纳型，需要做一些修改才可以。</p>
</li>
</ul>
</blockquote>
<ul>
<li>右边是导出的模型作为推理接口的推荐系统
<ul>
<li>基于图库的实时图谱上一直会有实时的数据更新，节点增减</li>
<li>当给定的用户推荐请求过来的时候，图库中以该用户为起点的子图会被获取（1.）、作为输入发送给推理接口（2.）</li>
<li>推理接口把子图输入给之前训练的模型，获得该用户在子图中关联的新物件中的评分排序（3.）作为推荐结果</li>
</ul>
</li>
</ul>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/PinSAGE_RecommendationSystem.svg" title="PinSAGE_RecommendationSystem" data-thumbnail="/recommendation-system-with-graphdb/PinSAGE_RecommendationSystem.svg">
        
    </a></p>
<p>篇幅关系，本章我就不给出端到端的实例代码了，后续有机会我会尽量做一个 demo 出来的。</p>
<h3 id="推荐系统可解释性" class="headerLink">
    <a href="#%e6%8e%a8%e8%8d%90%e7%b3%bb%e7%bb%9f%e5%8f%af%e8%a7%a3%e9%87%8a%e6%80%a7" class="header-mark"></a>1.3 推荐系统可解释性</h3><p>在结束本章之前，再举一个图数据库在推荐系统中的典型应用：推荐理由。</p>
<p>下图是美团、大众点评中的一个常见的搜索、推荐结果，现代推荐系统的复杂度是非常大的，一方面由很多方法自身的特性决定，另一方面最终的推荐可能是多个系统协同获得最终结果排名，这使得我们很难对推荐结果进行解释。</p>
<p>得益于被推荐用户和物件、以及他们的各种各样画像最终形成的知识图谱，我们只需要在图谱中对推荐结果进行“路径查找”就可以获得很有意义的解释，像是如下截图的“在北京喜欢北京菜的山东老乡都说这家店很赞”就是这样获得的解释。</p>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/reasoning.webp" title="reasoning" data-thumbnail="/recommendation-system-with-graphdb/reasoning.webp">
        
    </a></p>
<blockquote>
<p>图片来源：https://tech.meituan.com/2021/04/01/nebula-graph-practice-in-meituan.html</p>
</blockquote>
<h4 id="可解释性的例子" class="headerLink">
    <a href="#%e5%8f%af%e8%a7%a3%e9%87%8a%e6%80%a7%e7%9a%84%e4%be%8b%e5%ad%90" class="header-mark"></a>1.3.1 可解释性的例子</h4><p>咱们回到电影推荐的图谱上，我们在前边的算法中曾经获得过用户 <code>u_124</code> 的推荐电影 <code>1891</code>（星球大战：），那么我们可以通过这一个查询获得它的推荐解释：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">FIND</span><span class="w"> </span><span class="n">NOLOOP</span><span class="w"> </span><span class="n">PATH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s2">&#34;1891&#34;</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">BIDIRECT</span><span class="w"> </span><span class="n">UPTO</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">STEPS</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>我们可以很快获得 20 条路径：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">moviegraph</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">FIND</span><span class="w"> </span><span class="n">NOLOOP</span><span class="w"> </span><span class="n">PATH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;u_124&#34;</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s2">&#34;1891&#34;</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">BIDIRECT</span><span class="w"> </span><span class="n">UPTO</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">STEPS</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+-----------------------------------------------------------------------------------------------------+</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">p</span><span class="w">                                                                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+-----------------------------------------------------------------------------------------------------+</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_49&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_17&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_10281&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;p_4&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;p_3&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;p_24342&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;p_2&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;832&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_1110&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_1110&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;p_13463&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;p_12248&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;47981&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_10219&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;p_6&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;497&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_104&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;120880&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_104&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_104&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;p_130&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">acted_by</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;497&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_50&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11635&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_50&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="o">&lt;</span><span class="p">(</span><span class="s2">&#34;u_124&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">watched</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;11&#34;</span><span class="p">)</span><span class="o">-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="s2">&#34;g_50&#34;</span><span class="p">)</span><span class="o">&lt;-</span><span class="p">[:</span><span class="n">with_genre</span><span class="o">@</span><span class="mi">0</span><span class="w"> </span><span class="err">{}</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="s2">&#34;1891&#34;</span><span class="p">)</span><span class="o">&gt;</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+-----------------------------------------------------------------------------------------------------+</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Got</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="nf">rows</span><span class="w"> </span><span class="p">(</span><span class="kt">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">267151</span><span class="o">/</span><span class="mi">278139</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Wed</span><span class="p">,</span><span class="w"> </span><span class="mi">09</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">19</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">56</span><span class="w"> </span><span class="n">CST</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>我们在结果可视化中可以很容易看出这个推荐的结果可以是：</p>
<ul>
<li>曾经喜欢的星战电影的大部分演职人员都也参与了这部和同样是“奥斯卡获奖”且“经典”的电影。</li>
</ul>
<p><a class="lightgallery" href="/recommendation-system-with-graphdb/reasoning_movie.webp" title="reasoning_movie" data-thumbnail="/recommendation-system-with-graphdb/reasoning_movie.webp">
        
    </a></p>
<h3 id="总结" class="headerLink">
    <a href="#%e6%80%bb%e7%bb%93" class="header-mark"></a>1.4 总结</h3><p>现在，我们知道图数据库作为推荐系统中信息的最终形式：知识存在，可以适用在不同类型方法上，尽管很多方法中，图库不一定是最终落地系统方案的最流行选择，图数据库所带来的可视化洞察的潜力还是非常大的。</p>
<p>同时，构建的综合知识图谱上的解释、推理能力与一些实时要求高的图方法中（比如 GNN的基于模型方法），能起到带来独一无二的作用。</p>
<p>题图版权：<a href="https://unsplash.com/@charlesdeluvio" target="_blank" rel="noopener noreferrer">charlesdeluvio</a></p>]]></description>
</item><item>
    <title>nGQL 简明教程，第二期 nGQL 执行计划详解与调优</title>
    <link>https://siwei.io/ngql-execution-plan/</link>
    <pubDate>Tue, 06 Sep 2022 10:25:05 &#43;0800</pubDate><author>
        <name>Wey Gu</name>
    </author><guid>https://siwei.io/ngql-execution-plan/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/ngql-execution-plan/featured-image.webp" referrerpolicy="no-referrer">
            </div><blockquote>
<p>本文旨在帮助 NebulaGraph 新手快速了解查询语句调优，读懂查询计划。</p>
</blockquote>
<p>很长时间以来，NebulaGraph 社区里最热门之一的话题都是“我如何表达这样的查询最好？“，”我这个查询还有优化空间吗？“这一类的。今天，我就试着介绍一下如何理解查询语句的执行与优化过程，帮助大家脚踩在地上去写自己的查询语句。</p>
<p>同时，这篇文章也是 <a href="https://www.siwei.io/ngql-tutorial/" target="_blank" rel="noopener noreferrer">nGQL 简明教程系列</a>的第二期，通过本文了解面向性能去写查询语句之后，我们在进行图建模的过程（第三期的内容）中也能有更多支撑。</p>
<h2 id="一个查询的一生" class="headerLink">
    <a href="#%e4%b8%80%e4%b8%aa%e6%9f%a5%e8%af%a2%e7%9a%84%e4%b8%80%e7%94%9f" class="header-mark"></a>1 一个查询的一生</h2><p>先从一个查询语句从进入 NebulaGraph 一直到返回查询结果的全过程。</p>
<p>在开始之前，推荐阅读如下源码解读、架构设计的文章：</p>
<blockquote>
<p>参考文章</p>
<ul>
<li><a href="https://nebula-graph.com.cn/posts/nebula-graph-architecture-overview" target="_blank" rel="noopener noreferrer">https://nebula-graph.com.cn/posts/nebula-graph-architecture-overview</a></li>
<li><a href="https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-01" target="_blank" rel="noopener noreferrer">https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-01</a></li>
<li><a href="https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-02" target="_blank" rel="noopener noreferrer">https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-02</a></li>
<li><a href="https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-03" target="_blank" rel="noopener noreferrer">https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-03</a></li>
<li><a href="https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-04" target="_blank" rel="noopener noreferrer">https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-04</a></li>
<li><a href="https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-05" target="_blank" rel="noopener noreferrer">https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-05</a></li>
<li><a href="https://nebula-graph.com.cn/posts/how-indexing-works-in-nebula-graph" target="_blank" rel="noopener noreferrer">https://nebula-graph.com.cn/posts/how-indexing-works-in-nebula-graph</a></li>
</ul>
</blockquote>
<p>简单来说，一个查询语句被从 GraphClient 发送给 GraphD 之后，经历了：</p>
<ul>
<li>在 Parser 中被解析成抽象语法树(AST)</li>
<li>在 Validator, Planner 中被写成执行计划图，图中的每一个顶点 PlanNode 对应着一种算子</li>
<li>通过 Optimizer 中的优化规则（RBO）改写执行计划图</li>
<li>优化过的计划图被执行引擎从图的叶子节点开始执行直到根部</li>
</ul>
<p>的过程：</p>
<p><a class="lightgallery" href="/ngql-execution-plan/code-reading-qe-planner-arch.png" title="img" data-thumbnail="/ngql-execution-plan/code-reading-qe-planner-arch.png">
        
    </a></p>
<p>举一个例子，在查年龄大于 34 岁的三跳好友的语句被查询之后</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">GO</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">STEPS</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="err">$$</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">34</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="err">$$</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="err">$$</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>语句经过了解析、验证、优化之后，最终的执行计划是， <code>Start -&gt; Loop -&gt; Start -&gt; GetNeighbors -&gt; Project -&gt; Dedup -&gt; Loop -&gt; GetNeighbors -&gt; Project -&gt; GetVertices -&gt; Project -&gt; LeftJoin -&gt; Filter -&gt; Project -&gt; Dedup -&gt; Sort</code>，或者如下图所示。</p>
<p><a class="lightgallery" href="/ngql-execution-plan/go_n_steps.svg" title="go_n_steps" data-thumbnail="/ngql-execution-plan/go_n_steps.svg">
        
    </a></p>
<p>了解这个优化过程和最终执行计划意味着什么是调优查询、面向性能设计图建模的关键。</p>
<blockquote>
<p>这个计划图由添加了 <code>PROFILE FORMAT=&quot;DOT&quot;</code> 的执行结果中的 <code>digraph</code> 部分，借助 graphviz 渲染而得，的https://dreampuf.github.io/GraphvizOnline 是一个方便的线上渲染的工具。</p>
<p>另外，值得注意的是，<code>FORMAT=&quot;DOT&quot;</code> 省略之后的输出结果是表格形式的，并且，有更多信息会展示出来，后边我们会解读。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">PROFILE</span><span class="w"> </span><span class="n">FORMAT</span><span class="o">=</span><span class="s2">&#34;DOT&#34;</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">STEPS</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="err">$$</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">34</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="err">$$</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="err">$$</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-----------------+-----+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-----------------+-----+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Tony Parker&#34;</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mi">36</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Manu Ginobili&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">41</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;Tim Duncan&#34;</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mi">42</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-----------------+-----+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Got</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">8885</span><span class="o">/</span><span class="mi">19871</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">1391</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">plan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">digraph</span><span class="w"> </span><span class="n">exec_plan</span><span class="w"> </span><span class="err">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">rankdir</span><span class="o">=</span><span class="n">BT</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Sort_14&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{Sort_14|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">age</span><span class="err">\</span><span class="s2">&#34;\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__Sort_14</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __Dedup_13}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Dedup_13&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Sort_14&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Dedup_13&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{Dedup_13|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">age</span><span class="err">\</span><span class="s2">&#34;\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__Dedup_13</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __Project_12}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Project_12&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Dedup_13&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Project_12&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{Project_12|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">age</span><span class="err">\</span><span class="s2">&#34;\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__Project_12</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __Filter_11}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Filter_11&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Project_12&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Filter_11&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{Filter_11|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\&#34;</span><span class="n">JOIN_DST_VID</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">__COL_0</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">__COL_1</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">DST_VID</span><span class="err">\</span><span class="s2">&#34;\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__Filter_11</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __LeftJoin_10}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;LeftJoin_10&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Filter_11&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;LeftJoin_10&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{LeftJoin_10|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\&#34;</span><span class="n">JOIN_DST_VID</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">__COL_0</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">__COL_1</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">DST_VID</span><span class="err">\</span><span class="s2">&#34;\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__LeftJoin_10</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: \{\&#34;</span><span class="n">rightVar</span><span class="err">\</span><span class="s2">&#34;:\{\&#34;</span><span class="n">__Project_9</span><span class="err">\</span><span class="s2">&#34;:0\},\&#34;</span><span class="n">leftVar</span><span class="err">\</span><span class="s2">&#34;:\{\&#34;</span><span class="n">__Project_7</span><span class="err">\</span><span class="s2">&#34;:0\}\}}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Project_9&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;LeftJoin_10&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Project_9&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{Project_9|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\&#34;</span><span class="n">__COL_0</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">__COL_1</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">DST_VID</span><span class="err">\</span><span class="s2">&#34;\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__Project_9</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __GetVertices_8}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;GetVertices_8&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Project_9&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;GetVertices_8&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{GetVertices_8|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__GetVertices_8</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __Project_7}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Project_7&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;GetVertices_8&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Project_7&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{Project_7|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\&#34;</span><span class="n">JOIN_DST_VID</span><span class="err">\</span><span class="s2">&#34;\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__Project_7</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __GetNeighbors_6}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;GetNeighbors_6&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Project_7&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;GetNeighbors_6&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{GetNeighbors_6|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__GetNeighbors_6</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __VAR_0}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Loop_5&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;GetNeighbors_6&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Loop_5&#34;</span><span class="p">[</span><span class="n">shape</span><span class="o">=</span><span class="n">diamond</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Dedup_4&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Loop_5&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Loop_5&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Start_1&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;Do&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="o">=</span><span class="n">dashed</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Start_0&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Loop_5&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Dedup_4&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{Dedup_4|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__VAR_0</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __Project_3}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Project_3&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Dedup_4&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Project_3&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{Project_3|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\&#34;</span><span class="n">_vid</span><span class="err">\</span><span class="s2">&#34;\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__Project_3</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __GetNeighbors_2}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;GetNeighbors_2&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;Project_3&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;GetNeighbors_2&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{GetNeighbors_2|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__GetNeighbors_2</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: __VAR_0}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Start_1&#34;</span><span class="o">-&gt;</span><span class="s2">&#34;GetNeighbors_2&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Start_1&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{Start_1|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__Start_1</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: }&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="s2">&#34;Start_0&#34;</span><span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;{Start_0|outputVar: \{\&#34;</span><span class="n">colNames</span><span class="err">\</span><span class="s2">&#34;:\[\],\&#34;</span><span class="k">type</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">DATASET</span><span class="err">\</span><span class="s2">&#34;,\&#34;</span><span class="n">name</span><span class="err">\</span><span class="s2">&#34;:\&#34;</span><span class="n">__Start_0</span><span class="err">\</span><span class="s2">&#34;\}|inputVar: }&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">Mrecord</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div></blockquote>
<h3 id="查询计划" class="headerLink">
    <a href="#%e6%9f%a5%e8%af%a2%e8%ae%a1%e5%88%92" class="header-mark"></a>1.1 查询计划</h3><p>为了理解一个查询在整个生命周期中，如何反应到执行层面，以及它们的性能代价是多少，我们从认识它的执行计划开始入手。</p>
<p>以前边的图的拓展的 GO 语句为例，它的整个过程经历了如下节点</p>
<ul>
<li>GetNeighbors 是执行计划中最重要的节点，GetNeighbors 算子会在运行期访问存储服务，拿到通过起点和指定边类型一步拓展后终点的 id</li>
<li>多步拓展通过 Loop 节点实现，Start 到 Loop 之间是 Loop 子计划，当满足条件时 Loop 子计划会被循环执行，最后一步拓展节点在 Loop 外实现</li>
<li>Project 节点用来获取当前拓展的终点 id</li>
<li>Dedup 节点对终点 id 进行去重后作为下一步拓展的起点</li>
<li>GetVertices 节点负责取终点 tag 的属性</li>
<li>Filter 做条件过滤</li>
<li>LeftJoin 的作用是合并 GetNeightbors 和 GetVertices 的结果</li>
<li>Sort 做排序</li>
</ul>
<p>而这些节点就是不同的算子。</p>
<h2 id="认识算子" class="headerLink">
    <a href="#%e8%ae%a4%e8%af%86%e7%ae%97%e5%ad%90" class="header-mark"></a>2 认识算子</h2><p>在 NebulaGraph 博客的代码解读文章中已经有很多算子被提及、解释过，这里列举其中部分常见的算子：</p>
<blockquote>
<p>注：这里没有提及 GET SUBGRAPH/ FIND PATH 中的算子。</p>
</blockquote>
<table>
<thead>
<tr>
<th>算子</th>
<th>介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>GetNeighbor</td>
<td>根据指定的 vid ，从存储层获取起始点和边的属性</td>
</tr>
<tr>
<td>Traverse</td>
<td>仅用于MATCH 匹配 <code>()-[e:0..n]-()</code> 模式，获取拓展过程中的起始点和边的属性</td>
</tr>
<tr>
<td>AppendVertices</td>
<td>仅用于MATCH ，和 Traverse 配合获取点的属性</td>
</tr>
<tr>
<td>GetEdge</td>
<td>获取边的属性</td>
</tr>
<tr>
<td>GetVertices</td>
<td>获取点的属性，FETCH PROP 或者 GO 语句中。</td>
</tr>
<tr>
<td>ScanEdge</td>
<td>全表扫描边，例如 <code>MATCH ()-[e]-&gt;() RETURN e LIMIT 3 </code></td>
</tr>
<tr>
<td>ScanVertices</td>
<td>全表扫描点，例如 <code>MATCH (v) return v LIMIT 3</code></td>
</tr>
<tr>
<td>IndexScan</td>
<td>MATCH 语句中找到起始点的索引查询</td>
</tr>
<tr>
<td>TagIndexPrefixScan</td>
<td>LOOKUP 语句中前缀扫描 <code>LOOKUP ON player where player.name == &quot;Steve Nash&quot; YIELD player.name</code></td>
</tr>
<tr>
<td>TagIndexRangeScan</td>
<td>LOOKUP 语句中范围扫描 <code>LOOKUP ON player where player.name &gt; &quot;S&quot; YIELD player.name</code></td>
</tr>
<tr>
<td>TagIndexFullScan</td>
<td>LOOKUP 语句中全扫描 <code>LOOKUP ON player YIELD player.name</code></td>
</tr>
<tr>
<td>Filter</td>
<td>按条件过滤，例如 WHERE 语句</td>
</tr>
<tr>
<td>Project</td>
<td>获取上一步算子的列</td>
</tr>
<tr>
<td>Dedup</td>
<td>去重</td>
</tr>
<tr>
<td>LeftJoin</td>
<td>合并结果</td>
</tr>
<tr>
<td>LIMIT</td>
<td>限制输出行数</td>
</tr>
</tbody>
</table>
<p>从这些算子的含义中已经可以更加具体的知道图数据库查询落到查询引擎（GraphD）内部的最小所需操作了，而性能调优的关键就在于如何规划、优化一个查询如何被拆解为算子的执行计划。</p>
<h2 id="认识优化规则" class="headerLink">
    <a href="#%e8%ae%a4%e8%af%86%e4%bc%98%e5%8c%96%e8%a7%84%e5%88%99" class="header-mark"></a>3 认识优化规则</h2><p>对于任何给定的查询，执行计划并不是唯一确定的，相反，在最简单、直接的计划基础之上，优化器（Optimizer）会进行很多性能上的优化。</p>
<p>NebulaGraph 目前的优化器是完全的基于规则的优化（RBO），这些预设的规则的代码都在 <a href="https://github.com/vesoft-inc/nebula/tree/master/src/graph/optimizer" target="_blank" rel="noopener noreferrer">src/graph/optimizer</a> 的 <code>rules</code> 里边，它们都是针对执行计划模式的修改规则，之前 Shylock 在<a href="https://nebula-graph.com.cn/posts/nebula-graph-source-code-reading-04" target="_blank" rel="noopener noreferrer">这篇文章</a>里给过源码层面的介绍，大家可以去读一下。</p>
<p>值得庆幸的是，今年，大部分优化规则的代码里增加了很多好理解的 asciiart 图形注释，结合优化规则的命名本身的自解释性，我们可以很快速去大概理解优化规则的匹配规则和转换逻辑。</p>
<p>首先，这些规则的转换(transform)代码都在 <code>.cpp</code> 文件里，asciiart 图形注释在同名对应的 <code>.h</code> 里！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls src/graph/optimizer/rule/*.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/CollapseProjectRule.h                      src/graph/optimizer/rule/PushFilterDownLeftJoinRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/CombineFilterRule.h                        src/graph/optimizer/rule/PushFilterDownNodeRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/EdgeIndexFullScanRule.h                    src/graph/optimizer/rule/PushFilterDownProjectRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/EliminateAppendVerticesRule.h              src/graph/optimizer/rule/PushFilterDownScanVerticesRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/EliminateRowCollectRule.h                  src/graph/optimizer/rule/PushLimitDownGetNeighborsRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/GeoPredicateEdgeIndexScanRule.h            src/graph/optimizer/rule/PushLimitDownIndexScanRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/GeoPredicateIndexScanBaseRule.h            src/graph/optimizer/rule/PushLimitDownProjectRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/GeoPredicateTagIndexScanRule.h             src/graph/optimizer/rule/PushLimitDownScanAppendVerticesRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/GetEdgesTransformAppendVerticesLimitRule.h src/graph/optimizer/rule/PushLimitDownScanEdgesAppendVerticesRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/GetEdgesTransformRule.h                    src/graph/optimizer/rule/PushLimitDownScanEdgesRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/GetEdgesTransformUtils.h                   src/graph/optimizer/rule/PushStepLimitDownGetNeighborsRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/IndexFullScanBaseRule.h                    src/graph/optimizer/rule/PushStepSampleDownGetNeighborsRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/IndexScanRule.h                            src/graph/optimizer/rule/PushTopNDownIndexScanRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/MergeGetNbrsAndDedupRule.h                 src/graph/optimizer/rule/PushVFilterDownScanVerticesRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/MergeGetNbrsAndProjectRule.h               src/graph/optimizer/rule/RemoveNoopProjectRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/MergeGetVerticesAndDedupRule.h             src/graph/optimizer/rule/RemoveProjectDedupBeforeGetDstBySrcRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/MergeGetVerticesAndProjectRule.h           src/graph/optimizer/rule/TagIndexFullScanRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/OptimizeEdgeIndexScanByFilterRule.h        src/graph/optimizer/rule/TopNRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/OptimizeTagIndexScanByFilterRule.h         src/graph/optimizer/rule/UnionAllEdgeIndexScanRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/PushEFilterDownRule.h                      src/graph/optimizer/rule/UnionAllIndexScanBaseRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/PushFilterDownAggregateRule.h              src/graph/optimizer/rule/UnionAllTagIndexScanRule.h
</span></span><span class="line"><span class="cl">src/graph/optimizer/rule/PushFilterDownGetNbrsRule.h
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="getedgestransformrule" class="headerLink">
    <a href="#getedgestransformrule" class="header-mark"></a>3.1 GetEdgesTransformRule</h3><p>我们看下这个规则名字的意思是转换 <code>GetEdges</code> 的规则，看起来不够明确，再看看 <code>GetEdgesTransformRule.h</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//  Convert [[ScanVertices]] to [[ScanEdges]] in certain cases
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Required conditions:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   1. Match the pattern
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Benefits:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   1. Avoid doing Traverse to optimize performance
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Quey example:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   1. match ()-[e]-&gt;() return e limit 3
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Tranformation:
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Before:
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |      Project      |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |       Limit       |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |      Traverse     |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |    ScanVertices   |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  After:
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |      Project      |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |       Limit       |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |      Project      |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |      ScanEdges    |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>结合 <code>.cpp</code> 中 <code>GetEdgesTransformRule::match</code> 和 <code>GetEdgesTransformRule::transform</code> 的代码，我们可以确定这个优化规则是将 <code>MATCH ()-[e]-&gt;() RETURN e LIMIT 3</code> 原本按照 <code>ScanVertices</code> 去扫描顶点的起点转变为 <code>ScanEdges</code>。</p>
<p>这个规则的背景是没有点、边索引的 LIMIT 情况下，无起点 VID/属性条件的查询是可以通过扫点边数据下推 LIMIT 的，这个扫描边的查询因为只需要返回边，所以直接扫描边是更高效的。</p>
<h3 id="pushlimitdownscanedgesrule" class="headerLink">
    <a href="#pushlimitdownscanedgesrule" class="header-mark"></a>3.2 PushLimitDownScanEdgesRule</h3><p>我们看看这个规则，在 <code>PushLimitDownScanEdgesRule.h</code> 里有注释</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">//  Embedding limit to [[ScanEdges]]
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Required conditions:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   1. Match the pattern
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Benefits:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   1. Limit data early to optimize performance
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Transformation:
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Before:
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |      Limit      |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |    (limit=3)    |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |    ScanEdges      |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  After:
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |      Limit      |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |    (limit=3)    |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |    ScanEdges      |
</span></span></span><span class="line"><span class="cl"><span class="c1">// |     (limit=3)     |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这个规则很简单，当 ScanEdges 算子的下游是 Limit 算子的时候，把 Limit 的过滤条件嵌入到 ScanEdges 之中。这一步的意义是什么呢？这里涉及到一个优化规则里常见的概念，<strong>计算下推</strong>。</p>
<h4 id="计算下推" class="headerLink">
    <a href="#%e8%ae%a1%e7%ae%97%e4%b8%8b%e6%8e%a8" class="header-mark"></a>3.2.1 计算下推</h4><p>在计算存储分离的数据库系统中，涉及到读取数据的算子需要从存储层远程捞取数据再做进一步处理。而这个 RPC 的数据传输常常成为性能的瓶颈。然而，如果下一步计算要做的事情是对数据的按条件剪枝，例如 Filter、 Limit、TopN 等等，这时候，让这些剪枝条件在存储层捞数据的时候就考虑到，则可以大大减少数据传输的量。</p>
<p>PushLimitDownScanEdgesRule.h 的优化规则就是一个典型的 Limit 下推（Push Down）的规则。</p>
<h3 id="pushlimitdownprojectrule" class="headerLink">
    <a href="#pushlimitdownprojectrule" class="header-mark"></a>3.3 PushLimitDownProjectRule</h3><p>类似的，我们看看这个规则，<code>PushLimitDownProjectRule.h</code> 里有这样一段注释，这个规则只是把 Project 算子 之后的 Limit 算子的顺序调换了一下，我们可以想象在这个变换之后，Limit 就和 ScanEdges 等其他可以下推 Limit 的算子相邻了，然后例如 <code>PushLimitDownScanEdgesRule</code> 的规则变换也可以做了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">//  Push [[Limit]] down [[Project]]
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Required conditions:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   1. Match the pattern
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Benefits:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   1. Limit data early to optimize performance
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Tranformation:
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Before:
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |      Limit      |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |    (limit=3)    |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |      Project      |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  After:
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">// |      Project      |
</span></span></span><span class="line"><span class="cl"><span class="c1">// +---------+---------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |      Limit      |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |    (limit=3)    |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pushfilterdowngetnbrsrule" class="headerLink">
    <a href="#pushfilterdowngetnbrsrule" class="header-mark"></a>3.4 PushFilterDownGetNbrsRule</h3><p>再介绍一个 Filter 下推的例子，从规则注释里的转换图示可以读出，当 GetNeighbors 之后再双条件交集 Filter 的时候，取一个条件下推到 GetNeighbors，再进行另一个条件的 Filter。这个规则既减少了 GetNeighbors 数据传输的量和 Filter 输入的运算量、又少了一次集合运算。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">//  Embed the [[Filter]] into [[GetNeighbors]]
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Required conditions:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   1. Match the pattern
</span></span></span><span class="line"><span class="cl"><span class="c1">//   2. Filter contains subexpressions that meet pushdown conditions
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Benefits:
</span></span></span><span class="line"><span class="cl"><span class="c1">//   1. Filter data early to optimize performance
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Tranformation:
</span></span></span><span class="line"><span class="cl"><span class="c1">//  Before:
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +------------------+------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |                Filter               |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |($^.player.age&gt;3 and $$.player.age&lt;4)|
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +------------------+------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//                     |
</span></span></span><span class="line"><span class="cl"><span class="c1">//              +------+------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//              | GetNeighbors|
</span></span></span><span class="line"><span class="cl"><span class="c1">//              +------+------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  After:
</span></span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |    Filter       |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |($$.player.age&lt;4)|
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//           |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |  GetNeighbors   |
</span></span></span><span class="line"><span class="cl"><span class="c1">//  |($^.player.age&gt;3)|
</span></span></span><span class="line"><span class="cl"><span class="c1">//  +--------+--------+
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="下一步" class="headerLink">
    <a href="#%e4%b8%8b%e4%b8%80%e6%ad%a5" class="header-mark"></a>3.4.1 下一步</h4><ul>
<li>感兴趣的同学可以试着进一步看看所有的规则。</li>
<li>可以试着在多个 GraphD 的集群上，更改其中一个 GraphD 的配置，关闭 <code>enable_optimizer</code>，把同一个 Query 分别在开启了优化和关闭优化的 GraphD 中执行，比较执行计划的区别。</li>
<li>如果你发现可以更优化的规则给到大家，欢迎来论坛、github 提交优化建议、或者 PR！</li>
</ul>
<p>简单的介绍就到这里，接下来我们从一些实例出发来进一步实操执行计划调优吧。</p>
<h2 id="ngql-执行计划调优解读实例" class="headerLink">
    <a href="#ngql-%e6%89%a7%e8%a1%8c%e8%ae%a1%e5%88%92%e8%b0%83%e4%bc%98%e8%a7%a3%e8%af%bb%e5%ae%9e%e4%be%8b" class="header-mark"></a>4 nGQL 执行计划调优解读实例</h2><p>希望这些具体问题能够给大家带来启发。</p>
<h3 id="观察基于索引与数据的扫描" class="headerLink">
    <a href="#%e8%a7%82%e5%af%9f%e5%9f%ba%e4%ba%8e%e7%b4%a2%e5%bc%95%e4%b8%8e%e6%95%b0%e6%8d%ae%e7%9a%84%e6%89%ab%e6%8f%8f" class="header-mark"></a>4.1 观察基于索引与数据的扫描</h3><p>我在<a href="https://www.siwei.io/nebula-index-explained/" target="_blank" rel="noopener noreferrer">索引详解</a>中解释过 NebulaGraph 的索引和传统数据库中索引的区别，简单来说，因为以类似于邻接表的方式存储数据，NebulaGraph 里需要明确指定额外创建索引来解决全扫描或者根据属性条件扫描点、边的类似于表结构数据库中的场景。</p>
<p>另外，在无过滤条件 Limit 采样扫描的场景下，NebulaGraph 从 v3.0 以后允许了无索引的查询情形（因为点边数据扫描支持了 Limit 下推，不再像之前那么昂贵），在没有索引可以被选择的情况下，planner 也会选择直接扫点或者边的数据，这个差别可以从 <code>explain</code>, <code>profile</code> 中看出来。</p>
<p>这里用 <a href="https://docs.nebula-graph.com.cn/3.2.0/3.ngql-guide/1.nGQL-overview/1.overview/#basketballplayer" target="_blank" rel="noopener noreferrer">Basketballplayer</a> 数据集中自带的索引来距离，注意到其中只在 player 这个 TAG 上有两个索引：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">TAG</span><span class="w"> </span><span class="n">INDEXES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------+----------+----------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="k">Index</span><span class="w"> </span><span class="n">Name</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="k">By</span><span class="w"> </span><span class="n">Tag</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">Columns</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------+----------+----------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;player_index_0&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;player&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[]</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;player_index_1&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;player&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">]</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------+----------+----------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Got</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">2440</span><span class="o">/</span><span class="mi">19653</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="无索引查询" class="headerLink">
    <a href="#%e6%97%a0%e7%b4%a2%e5%bc%95%e6%9f%a5%e8%af%a2" class="header-mark"></a>4.1.1 无索引查询</h4><p>先看一个没有索引的场景的查询：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">PROFILE</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">:</span><span class="n">team</span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-----------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-----------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;team206&#34;</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-----------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Got</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">3637</span><span class="o">/</span><span class="mi">17551</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">265</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------+--------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w">                                      </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------+--------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">16</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">29</span><span class="n">us</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;id(n)&#34;</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__DataCollect_8&#34;</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Limit_13</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;id($-.n)&#34;</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------+--------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Limit</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">17</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="n">us</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Limit_13&#34;</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__AppendVertices_17</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="k">offset</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="k">count</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------+--------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">AppendVertices</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">18</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="err">{</span><span class="w">                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">244</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">1124</span><span class="n">us</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged0&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">257</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">779</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged2&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">190</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">870</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">        </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">total_rpc</span><span class="p">:</span><span class="w"> </span><span class="mi">1024</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                 </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged1&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">195</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">879</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__AppendVertices_17&#34;</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                   </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__ScanVertices_18</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">_vid</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">props</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">vertex_filter</span><span class="p">:</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">if_track_previous_path</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------+--------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ScanVertices</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mi">3</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="err">{</span><span class="w">                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">1586</span><span class="n">us</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged2&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">532</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1303</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">       </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="p">,</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged1&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">480</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1318</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">       </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;team._tag&#34;</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">total_rpc</span><span class="p">:</span><span class="w"> </span><span class="mi">1502</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                 </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged0&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">506</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1382</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__ScanVertices_18&#34;</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">team</span><span class="p">.</span><span class="n">_tag</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">team</span><span class="p">.</span><span class="n">_tag</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">EMPTY</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">props</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------+--------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">          </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">27</span><span class="n">us</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_3&#34;</span><span class="w">                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                     </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------+--------------------------------------------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这个例子里我们关注从 Storage 里取数据的算子，以及算子取得数据的行数：</p>
<ul>
<li>ScanVertices，扫描点（其中 <code>limit: 1 </code>）</li>
<li>rows: 3，扫描得到 3 行数据</li>
</ul>
<p>首先，ScanVertices 比较好理解，在没有索引的情况下，只能去扫描点数据（非索引）了，limit : 1 表示它也被下推了，不会取全量数据。</p>
<p>其次，rows: 3 ，为什么不是 1 呢？这是因为数据分别在 3 个 storage 之中，同时被扫描，所以只能在每一个里边都 limit 1 才能保证最终数据能满足需求，而这里刚好三个 storage 中都有数据分布，最终得到的数据量就是 3 了。</p>
<h4 id="有索引查询limit-无下推" class="headerLink">
    <a href="#%e6%9c%89%e7%b4%a2%e5%bc%95%e6%9f%a5%e8%af%a2limit-%e6%97%a0%e4%b8%8b%e6%8e%a8" class="header-mark"></a>4.1.2 有索引查询，LIMIT 无下推</h4><p>下边我们来查 player 上的数据，前边的 <code>SHOW TAG INDEXES</code> 里看到，player 上是存在索引的，</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">PROFILE</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">:</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;player127&#34;</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Got</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">4053</span><span class="o">/</span><span class="mi">19496</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">181</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w">                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">9</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="n">us</span><span class="w">                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;id(n)&#34;</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__DataCollect_7&#34;</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Limit_9</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;id($-.n)&#34;</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Limit</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">3</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="n">us</span><span class="w">                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Limit_9&#34;</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__AppendVertices_3</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="k">offset</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="k">count</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">AppendVertices</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="err">{</span><span class="w">                                                                                                                                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">390</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">1140</span><span class="n">us</span><span class="w">                                                                                                                  </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">total_rpc</span><span class="p">:</span><span class="w"> </span><span class="mi">933</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                                                    </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged1&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">208</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">718</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                          </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged0&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">118</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">693</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                          </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged2&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">241</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">664</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                          </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__AppendVertices_3&#34;</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                                                                                                                     </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__IndexScan_1</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="n">_vid</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">props</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">vertex_filter</span><span class="p">:</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">_tag</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">if_track_previous_path</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IndexScan</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="err">{</span><span class="w">                                                                                                                                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">1567</span><span class="n">us</span><span class="w">                                                                                                                    </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged1&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">499</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1266</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                         </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged0&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">441</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1321</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                         </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">storage_detail</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="n">IndexLimitNode</span><span class="p">(</span><span class="k">limit</span><span class="o">=</span><span class="mi">9223372036854775807</span><span class="p">):</span><span class="mi">263</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="n">IndexProjectionNode</span><span class="p">(</span><span class="n">projectColumn</span><span class="o">=</span><span class="p">[</span><span class="n">_vid</span><span class="p">]):</span><span class="mi">267</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="n">IndexVertexScanNode</span><span class="p">(</span><span class="n">IndexID</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="n">Path</span><span class="o">=</span><span class="p">()):</span><span class="mi">271</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="err">}</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged2&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">487</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1256</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                         </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__IndexScan_1&#34;</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                                                                                                                     </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="mi">9223372036854775807</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">schemaId</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">isEdge</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">returnCols</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;_vid&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">indexCtx</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;columnHints&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;filter&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;index_id&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">          </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="n">us</span><span class="w">                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_2&#34;</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>可以看出：</p>
<ul>
<li>捞数据的算子是 <code>IndexScan</code>，Limit 并没有下推 <code>limit: 9223372036854775807</code></li>
<li>取得的数据行数是 <code>rows: 52</code></li>
</ul>
<p>所以，由于当前 NebulaGraph 社区版并没有进行 MATCH 带索引查询的 Limit 下推，反而这种无条件查询比有索引的情况下更加昂贵。</p>
<blockquote>
<p>注：MATCH 起点查询策略的代码在 <code>src/graph/planner/PlannersRegister.cpp</code> ，感兴趣的话可以去读读看。</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">PlannersRegister</span><span class="o">::</span><span class="n">registerMatch</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">auto</span><span class="o">&amp;</span> <span class="n">planners</span> <span class="o">=</span> <span class="n">Planner</span><span class="o">::</span><span class="n">plannersMap</span><span class="p">()[</span><span class="n">Sentence</span><span class="o">::</span><span class="n">Kind</span><span class="o">::</span><span class="n">kMatch</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">planners</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MatchPlanner</span><span class="o">::</span><span class="n">match</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">MatchPlanner</span><span class="o">::</span><span class="n">make</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">auto</span><span class="o">&amp;</span> <span class="n">startVidFinders</span> <span class="o">=</span> <span class="n">StartVidFinder</span><span class="o">::</span><span class="n">finders</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// MATCH(n) WHERE id(n) = value RETURN n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">startVidFinders</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="o">&amp;</span><span class="n">VertexIdSeek</span><span class="o">::</span><span class="n">make</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// MATCH (n)-[]-(l), (l)-[]-(m) return n,l,m
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// MATCH (n)-[]-(l) MATCH (l)-[]-(m) return n,l,m
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">startVidFinders</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ArgumentFinder</span><span class="o">::</span><span class="n">make</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// MATCH(n:Tag{prop:value}) RETURN n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// MATCH(n:Tag) WHERE n.prop = value RETURN n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">startVidFinders</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="o">&amp;</span><span class="n">PropIndexSeek</span><span class="o">::</span><span class="n">make</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// seek by tag or edge(index)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// MATCH(n: tag) RETURN n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// MATCH(s)-[:edge]-&gt;(e) RETURN e
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">startVidFinders</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="o">&amp;</span><span class="n">LabelIndexSeek</span><span class="o">::</span><span class="n">make</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Scan the start vertex directly
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// Now we hard code the order of match rules before CBO,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// put scan rule at the last for we assume it&#39;s most inefficient
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">startVidFinders</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ScanSeek</span><span class="o">::</span><span class="n">make</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="有索引查询limit-下推" class="headerLink">
    <a href="#%e6%9c%89%e7%b4%a2%e5%bc%95%e6%9f%a5%e8%af%a2limit-%e4%b8%8b%e6%8e%a8" class="header-mark"></a>4.1.3 有索引查询，LIMIT 下推</h4><p>值得庆幸的是，现在 LOOKUP 里里等价的查询中的索引查询算子是支持 Limit 下推的优化规则的：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">PROFILE</span><span class="w"> </span><span class="n">LOOKUP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">player</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">n</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;player114&#34;</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">-------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Got</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">9643</span><span class="o">/</span><span class="mi">37744</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">217</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+------------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">             </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w">                                                                                                                                                    </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+------------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">8</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">9</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">31</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">33</span><span class="n">us</span><span class="w">                                                                                                                  </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__DataCollect_4&#34;</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Limit_6</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;id(VERTEX) AS n&#34;</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+------------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Limit</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">43</span><span class="n">us</span><span class="w">                                                                                                                  </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="p">,</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;player._tag&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;player.age&#34;</span><span class="p">,</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;player.name&#34;</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Limit_6&#34;</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__TagIndexFullScan_10</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="k">offset</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="k">count</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+------------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">TagIndexFullScan</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="err">{</span><span class="w">                                                                                                                                                                 </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">8540</span><span class="n">us</span><span class="w">                                                                                                                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged2&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">369</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">951</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="p">,</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged1&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">383</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">8198</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                     </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;player._tag&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged0&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">483</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1181</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                     </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;player.age&#34;</span><span class="p">,</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">storage_detail</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="n">IndexLimitNode</span><span class="p">(</span><span class="k">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span><span class="mi">319</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="n">IndexProjectionNode</span><span class="p">(</span><span class="n">projectColumn</span><span class="o">=</span><span class="p">[</span><span class="n">_vid</span><span class="p">,</span><span class="n">_tag</span><span class="p">,</span><span class="n">age</span><span class="p">,</span><span class="n">name</span><span class="p">]):</span><span class="mi">321</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="n">IndexVertexScanNode</span><span class="p">(</span><span class="n">IndexID</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="n">Path</span><span class="o">=</span><span class="p">()):</span><span class="mi">346</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="err">}</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;player.name&#34;</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                                                                                                                 </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__TagIndexFullScan_10&#34;</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">schemaId</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">isEdge</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">returnCols</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;_vid&#34;</span><span class="p">,</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;_tag&#34;</span><span class="p">,</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">indexCtx</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;columnHints&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;filter&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;index_id&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+------------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">            </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="n">us</span><span class="w">                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_0&#34;</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+------------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>我们可以看到：</p>
<ul>
<li>数据捞取算子是 TagIndexFullScan，有 Limit:1 下推</li>
<li>因为索引扫描是所有分区 fanout 扫描（区别于ScanVertices 只是所有 storage 扫描，LOOKUP 的算子扫的更细），这里 Limit:1 下推扫得的数据量是 rows: 10</li>
</ul>
<p>综上，我们对无 VID 的起点查询的不同情况有了具体的认识。</p>
<h3 id="观察-filter-下推" class="headerLink">
    <a href="#%e8%a7%82%e5%af%9f-filter-%e4%b8%8b%e6%8e%a8" class="header-mark"></a>4.2 观察 filter 下推</h3><p>我们先看看这个查询，它沿着给定起点向外图扩展的查询，根据边的属性条件过滤，返回目的点 ID：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">GO</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">properties</span><span class="p">(</span><span class="n">edge</span><span class="p">).</span><span class="n">degree</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">follow</span><span class="p">.</span><span class="n">_dst</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>它的执行计划是：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">explain</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">properties</span><span class="p">(</span><span class="n">edge</span><span class="p">).</span><span class="n">degree</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">follow</span><span class="p">.</span><span class="n">_dst</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">959</span><span class="o">/</span><span class="mi">7917</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">369</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;follow._dst&#34;</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_3&#34;</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Filter_2</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;follow._dst&#34;</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Filter</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Filter_2&#34;</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__GetNeighbors_1</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">condition</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">properties</span><span class="p">(</span><span class="n">EDGE</span><span class="p">).</span><span class="n">degree</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">isStable</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">GetNeighbors</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__GetNeighbors_1&#34;</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_0</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="k">COLUMN</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="n">OUT_EDGE</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">        </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_0&#34;</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到，这个计划里，GetNeighboors 算子取得了所有的 player100 的出边（以及边属性），然后再通过单独 Filter 算子。</p>
<p>我们关注：</p>
<ul>
<li><code>filter: </code>是空的</li>
<li><code>properties(EDGE).degree&gt;1</code> 作为 Filter 算子的条件。</li>
</ul>
<p>这里，我们有没有可能把 Filter 下推呢？答案是可以的，只要在 WHERE 条件中提供边类型的信息，优化条件就可以把它下推到 GetNeighbors 算子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">explain</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">follow</span><span class="p">.</span><span class="n">degree</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">follow</span><span class="p">.</span><span class="n">_dst</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">664</span><span class="o">/</span><span class="mi">6650</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">161</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;follow._dst&#34;</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_3&#34;</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Filter_2</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;follow._dst&#34;</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">GetNeighbors</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Filter_2&#34;</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_0</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">follow</span><span class="p">.</span><span class="n">degree</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="k">COLUMN</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="n">OUT_EDGE</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">        </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_0&#34;</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+----------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这时候 <code>WHERE follow.degree &gt; 1</code> 把 follow 这个信息传递给了优化规则，让它可以：</p>
<ul>
<li>在 GetNeighbors 算子里提供 <code>filter: (follow.degree&gt;1)</code> 的信息</li>
<li>去掉 Filter 算子</li>
</ul>
<p>这样，优化之后的查询不仅少了一个 GraphD 里的算子执行过程，GetNeighbors 捞取的数据也因为传递了 filter 参数可能比全量的数据少了。</p>
<p>在这个例子中，我们应该可以感性推得这样的一个规律：显示表达尽可能多的已知信息往往是有帮助的。事实上，这个结论是有客观的道理的，在规则优化、数据查询的时候，模糊的查询常常是更昂贵的，而确定的信息总会带来更多的剪枝、过滤、短路可能，并且这些信息在查询中越明确、越早提供也会越好。下边是另一个例子：</p>
<h3 id="优化原则减少模糊增加确定越早越好" class="headerLink">
    <a href="#%e4%bc%98%e5%8c%96%e5%8e%9f%e5%88%99%e5%87%8f%e5%b0%91%e6%a8%a1%e7%b3%8a%e5%a2%9e%e5%8a%a0%e7%a1%ae%e5%ae%9a%e8%b6%8a%e6%97%a9%e8%b6%8a%e5%a5%bd" class="header-mark"></a>4.3 优化原则：减少模糊，增加确定，越早越好</h3><p>这里我给出三对查询的比较：</p>
<ol>
<li><code>GO FROM &quot;player100&quot; OVER follow YIELD dst(edge)</code> 对比 <code>GO FROM &quot;player100&quot; OVER follow YIELD follow._dst</code></li>
<li><code>MATCH (:player)-[e]-(:player) RETURN e</code> 与 <code>MATCH (:player)-[e:follow]-(:player) RETURN e</code></li>
</ol>
<p>在 1. 中，两者的差异不像前文中给出的算子有不同，这次的区别在于算子传递的数据量有不同，<code>dst(edge)</code> 的表达里，我们一方面没有给出 edge 的类型，另一方面是针对整个 edge 做了函数 <code>dst()</code> 的运算，这使得 <code>GetNeighbors</code> 算子的 <code>edgeProps</code> 输出是所有的属性，反观 <code>follow._dst</code> 的表达使得 <code>edgeProps</code> 输出只有边的 _dst，这印证了在我们已知返回 follow 边的属性的情况下，提早（而不是等到语句解析到 dst(edge) 之后）而且直接用 <code>follow._dst</code> 表达带来了数据传输上的优化。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">explain</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">dst</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">600</span><span class="o">/</span><span class="mi">7625</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">101</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;dst(EDGE)&#34;</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_2&#34;</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__GetNeighbors_1</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;dst(EDGE)&#34;</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">GetNeighbors</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__GetNeighbors_1&#34;</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_0</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="k">COLUMN</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="n">OUT_EDGE</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">        </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_0&#34;</span><span class="w">        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">14</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">27</span><span class="w"> </span><span class="n">CST</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">explain</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">follow</span><span class="p">.</span><span class="n">_dst</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">549</span><span class="o">/</span><span class="mi">5971</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">91</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;follow._dst&#34;</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_2&#34;</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__GetNeighbors_1</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;follow._dst&#34;</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">GetNeighbors</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__GetNeighbors_1&#34;</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_0</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="k">COLUMN</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="n">OUT_EDGE</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">        </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_0&#34;</span><span class="w">        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">14</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">42</span><span class="w"> </span><span class="n">CST</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>类似的，在 2. 中，两个查询的 Traverse 算子的返回属性也是不同的，两者在存储层做数据扫描的时候代价是不同的（同样注意 edgeProps 的区别），而写查询的我们，在当前的 basketballplayer 的图中，清楚地知道 player 与 player 之间，只有一种边，那就是 follow，在这个信息被写入查询中的时候，我们就获得了更高效地查询计划。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span><span class="lnt">450
</span><span class="lnt">451
</span><span class="lnt">452
</span><span class="lnt">453
</span><span class="lnt">454
</span><span class="lnt">455
</span><span class="lnt">456
</span><span class="lnt">457
</span><span class="lnt">458
</span><span class="lnt">459
</span><span class="lnt">460
</span><span class="lnt">461
</span><span class="lnt">462
</span><span class="lnt">463
</span><span class="lnt">464
</span><span class="lnt">465
</span><span class="lnt">466
</span><span class="lnt">467
</span><span class="lnt">468
</span><span class="lnt">469
</span><span class="lnt">470
</span><span class="lnt">471
</span><span class="lnt">472
</span><span class="lnt">473
</span><span class="lnt">474
</span><span class="lnt">475
</span><span class="lnt">476
</span><span class="lnt">477
</span><span class="lnt">478
</span><span class="lnt">479
</span><span class="lnt">480
</span><span class="lnt">481
</span><span class="lnt">482
</span><span class="lnt">483
</span><span class="lnt">484
</span><span class="lnt">485
</span><span class="lnt">486
</span><span class="lnt">487
</span><span class="lnt">488
</span><span class="lnt">489
</span><span class="lnt">490
</span><span class="lnt">491
</span><span class="lnt">492
</span><span class="lnt">493
</span><span class="lnt">494
</span><span class="lnt">495
</span><span class="lnt">496
</span><span class="lnt">497
</span><span class="lnt">498
</span><span class="lnt">499
</span><span class="lnt">500
</span><span class="lnt">501
</span><span class="lnt">502
</span><span class="lnt">503
</span><span class="lnt">504
</span><span class="lnt">505
</span><span class="lnt">506
</span><span class="lnt">507
</span><span class="lnt">508
</span><span class="lnt">509
</span><span class="lnt">510
</span><span class="lnt">511
</span><span class="lnt">512
</span><span class="lnt">513
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">explain</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(:</span><span class="n">player</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">-</span><span class="p">(:</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">1122</span><span class="o">/</span><span class="mi">10251</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">287</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">9</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;e&#34;</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_6&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__AppendVertices_4</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;$-.e[0] AS e&#34;</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">AppendVertices</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">8</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__VAR_0&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;e&#34;</span><span class="p">,</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__VAR_1&#34;</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__AppendVertices_4&#34;</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Traverse_3</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">_tag</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">EMPTY</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="n">none_direct_dst</span><span class="p">(</span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">e</span><span class="p">)</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">props</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">59</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;geo&#34;</span><span class="p">,</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;email&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;phone_num&#34;</span><span class="p">,</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;birthday&#34;</span><span class="p">,</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">61</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">62</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;uuid&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">66</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertex_filter</span><span class="p">:</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">if_track_previous_path</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">8</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Traverse</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__VAR_0&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;e&#34;</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Traverse_3&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__IndexScan_1</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="n">_vid</span><span class="w">                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="k">BOTH</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">71</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">71</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">70</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">53</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">68</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;start_year&#34;</span><span class="p">,</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;end_year&#34;</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">52</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;start_year&#34;</span><span class="p">,</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;end_year&#34;</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">52</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">67</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">67</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">69</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">69</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">steps</span><span class="p">:</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertex</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">if_track_previous_path</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">_tag</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IndexScan</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="w">                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__IndexScan_1&#34;</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="mi">9223372036854775807</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">schemaId</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">isEdge</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">returnCols</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;_vid&#34;</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">indexCtx</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;columnHints&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;filter&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;index_id&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">54</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">          </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_2&#34;</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">14</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">31</span><span class="w"> </span><span class="n">CST</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">explain</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(:</span><span class="n">player</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">e</span><span class="p">:</span><span class="n">follow</span><span class="p">]</span><span class="o">-</span><span class="p">(:</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">936</span><span class="o">/</span><span class="mi">7830</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">284</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">9</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;e&#34;</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_6&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__AppendVertices_4</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;$-.e[0] AS e&#34;</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">AppendVertices</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">8</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__VAR_0&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;e&#34;</span><span class="p">,</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__VAR_1&#34;</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__AppendVertices_4&#34;</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Traverse_3</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">_tag</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">EMPTY</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="n">none_direct_dst</span><span class="p">(</span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">e</span><span class="p">)</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">props</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">59</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;geo&#34;</span><span class="p">,</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;email&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;phone_num&#34;</span><span class="p">,</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;birthday&#34;</span><span class="p">,</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">61</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">62</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;uuid&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">66</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertex_filter</span><span class="p">:</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">if_track_previous_path</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">8</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Traverse</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__VAR_0&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;e&#34;</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Traverse_3&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__IndexScan_1</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="n">_vid</span><span class="w">                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="k">BOTH</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">53</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">steps</span><span class="p">:</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertex</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">if_track_previous_path</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">_tag</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IndexScan</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="w">                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__IndexScan_1&#34;</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="mi">9223372036854775807</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">schemaId</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">isEdge</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">returnCols</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;_vid&#34;</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">indexCtx</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;columnHints&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;filter&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;index_id&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">54</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">          </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_2&#34;</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+----------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">14</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">54</span><span class="w"> </span><span class="n">CST</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="小练习等价的多种表达的代价" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%83%e4%b9%a0%e7%ad%89%e4%bb%b7%e7%9a%84%e5%a4%9a%e7%a7%8d%e8%a1%a8%e8%be%be%e7%9a%84%e4%bb%a3%e4%bb%b7" class="header-mark"></a>4.4 小练习：等价的多种表达的代价</h3><p>这是一个用户提的一个问题：如何表达两点之间是否存在直连边？</p>
<p>对于这么简单的表达，大家应该直接能想到应该有好多方法表达：</p>
<ul>
<li>GO</li>
<li>FIND PATH</li>
<li>MATCH</li>
<li>FETCH PROP</li>
</ul>
<p>这里，利用 FETCH PROP 表达双向边，似乎是两个查询，我们先省略掉，对于剩下的三个表达，哪一种更适合呢？我们先写出来看看</p>
<ul>
<li><code>GO FROM &quot;player100&quot; over * BIDIRECT WHERE id($$) == &quot;player101&quot; YIELD edge AS e</code></li>
<li><code>FIND ALL PATH FROM &quot;player100&quot; TO &quot;player101&quot; OVER * BIDIRECT UPTO 1 STEPS YIELD path AS p</code></li>
<li><code>MATCH (n)--(m) WHERE id(n) == &quot;player100&quot; AND id(m) == &quot;player101&quot; RETURN count(*)</code></li>
</ul>
<h4 id="gomatch-与-find-path" class="headerLink">
    <a href="#gomatch-%e4%b8%8e-find-path" class="header-mark"></a>4.4.1 GO/MATCH 与 FIND PATH</h4><p>他们都能获得我们想要的信息，感觉上，MATCH 和 GO 会比 FIND PATH 的查询更快一些，因为它们都是从单一起点拓展，而 FIND PATH 是从两端同时查询，在一跳的情况下，这其实是冗余的动作。验证一下的话，我们可以看到</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">explain</span><span class="w"> </span><span class="n">FIND</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">PATH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s2">&#34;player101&#34;</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">BIDIRECT</span><span class="w"> </span><span class="n">UPTO</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">STEPS</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>中果然有两个 GetNeighbors 算子。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">explain</span><span class="w"> </span><span class="n">FIND</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">PATH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s2">&#34;player101&#34;</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">BIDIRECT</span><span class="w"> </span><span class="n">UPTO</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">STEPS</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">818</span><span class="o">/</span><span class="mi">16537</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">229</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">DataCollect</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="mi">8</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;p&#34;</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__DataCollect_9&#34;</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_path&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__ProduceAllPaths_5&#34;</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">distinct</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">kind</span><span class="p">:</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">PATHS</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">8</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Loop</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="mi">7</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Loop_8&#34;</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_1</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">condition</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="o">++</span><span class="p">(</span><span class="err">$</span><span class="n">__VAR_2</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">loopBody</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ProduceAllPaths</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="w">          </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">branch</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="p">,</span><span class="w"> </span><span class="n">nodeId</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_path&#34;</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__ProduceAllPaths_5&#34;</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;rightVar&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__GetNeighbors_4&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;leftVar&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__GetNeighbors_3&#34;</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">LeftNextVidVar</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__VAR_0&#34;</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">RightNextVidVar</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__VAR_1&#34;</span><span class="w">        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">noloop</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">steps</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">GetNeighbors</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__GetNeighbors_3&#34;</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_0</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="k">COLUMN</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="n">OUT_EDGE</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">52</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">53</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">67</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">68</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">69</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">70</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">71</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">52</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">67</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">69</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">71</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">PassThrough</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__PassThrough_2&#34;</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Start_1</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">           </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_1&#34;</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">GetNeighbors</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__GetNeighbors_4&#34;</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_1</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="k">COLUMN</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="n">OUT_EDGE</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">52</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">67</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">69</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">71</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">52</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">53</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">67</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">68</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">69</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">70</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">71</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="mi">6</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__VAR_1&#34;</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_1</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;COLUMN[0] AS _vid&#34;</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__VAR_0&#34;</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_0</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;COLUMN[0] AS _vid&#34;</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">           </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_0&#34;</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+-----------------+--------------+----------------+------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">15</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">36</span><span class="w"> </span><span class="n">CST</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="go-与-match" class="headerLink">
    <a href="#go-%e4%b8%8e-match" class="header-mark"></a>4.4.2 GO 与 MATCH</h4><p>一般来说，如果表达能力等价，GO 都是更推荐的查询，这是因为在 MATCH 查询中，做边拓展的算子 Traverse 默认不只取边上的信息，还会同时取两端的信息。我们可以通过 explain 和 profile 来对比两个查询：</p>
<ul>
<li><code>GO FROM &quot;player100&quot; over * BIDIRECT WHERE id($$) == &quot;player101&quot; YIELD edge AS e</code></li>
<li><code>MATCH (n)--(m) WHERE id(n) == &quot;player100&quot; AND id(m) == &quot;player101&quot; RETURN count(*)</code></li>
</ul>
<p>可以看到，尽管我们只想返回 <code>count(*)</code>，在查询计划中，Traverse 算子仍然包涵了所有的点属性获取（vertexProps）。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">explain</span><span class="w">  </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="c1">--(m) WHERE id(n) == &#34;player100&#34; AND id(m) == &#34;player101&#34; RETURN count(*)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">1340</span><span class="o">/</span><span class="mi">8307</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">424</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+-------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+-------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">8</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Aggregate</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="w">           </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;count(*)&#34;</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Aggregate_8&#34;</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Filter_7</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">groupKeys</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">groupItems</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;expr&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;count(*)&#34;</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+-------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">9</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="p">,</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;m&#34;</span><span class="w">                                                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Filter_7&#34;</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Filter_9</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;$-.n AS n&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;$-.m AS m&#34;</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+-------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Filter</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="p">,</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__VAR_0&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;m&#34;</span><span class="w">                                                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Filter_9&#34;</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__AppendVertices_5</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">condition</span><span class="p">:</span><span class="w"> </span><span class="p">((</span><span class="n">id</span><span class="p">(</span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">n</span><span class="p">)</span><span class="o">==</span><span class="s2">&#34;player100&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">m</span><span class="p">)</span><span class="o">==</span><span class="s2">&#34;player101&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">isStable</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+-------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">AppendVertices</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="p">,</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__VAR_0&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;m&#34;</span><span class="w">                                                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__AppendVertices_5&#34;</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Traverse_4</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="n">none_direct_dst</span><span class="p">(</span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">__VAR_0</span><span class="p">)</span><span class="w">                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">props</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">59</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;geo&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;email&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;phone_num&#34;</span><span class="p">,</span><span class="w">                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;birthday&#34;</span><span class="p">,</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">61</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">62</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;uuid&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">66</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertex_filter</span><span class="p">:</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">if_track_previous_path</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+-------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Traverse</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="p">,</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__VAR_0&#34;</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Traverse_4&#34;</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Dedup_2</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="o">-</span><span class="p">.</span><span class="n">_vid</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="k">BOTH</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">59</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;geo&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;email&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;phone_num&#34;</span><span class="p">,</span><span class="w">                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;birthday&#34;</span><span class="p">,</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">61</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">62</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;uuid&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">66</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">71</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">71</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">70</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">53</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">68</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">52</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">52</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">67</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">67</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">69</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">69</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">steps</span><span class="p">:</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertex</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">if_track_previous_path</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+-------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Dedup</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="w">                                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Dedup_2&#34;</span><span class="w">                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_1</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+-------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">PassThrough</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mi">3</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="w">                                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__VAR_1&#34;</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+-------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">          </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_3&#34;</span><span class="w">                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+----------------+-------------------------------------------------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>反观 GO 的查询，GetNeighbors 算子只需要沿着起点进行边边扫描就可以了，然而，这个查询的计划里居然还有 GetVertices 算子取获取点的属性，这看起来完全是不必要的。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">explain</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">BIDIRECT</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="err">$$</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;player101&#34;</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">1549</span><span class="o">/</span><span class="mi">16916</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">751</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">6</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;e&#34;</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_7&#34;</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Filter_6</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;EDGE AS e&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Filter</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;EDGE&#34;</span><span class="p">,</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;JOIN_DST_VID&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;$$&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;DST_VID&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Filter_6&#34;</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__LeftJoin_5</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">condition</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="err">$$</span><span class="p">)</span><span class="o">==</span><span class="s2">&#34;player101&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">isStable</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">LeftJoin</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;EDGE&#34;</span><span class="p">,</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;JOIN_DST_VID&#34;</span><span class="p">,</span><span class="w">              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;$$&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;DST_VID&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__LeftJoin_5&#34;</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;rightVar&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__Project_4&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;leftVar&#34;</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;__Project_2&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">hashKeys</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;COLUMN[-1]&#34;</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">probeKeys</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;COLUMN[-1]&#34;</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">kind</span><span class="p">:</span><span class="w"> </span><span class="n">LeftJoin</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">3</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;$$&#34;</span><span class="p">,</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;DST_VID&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_4&#34;</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__GetVertices_3</span><span class="w">        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;$$ AS $$&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;COLUMN[0] AS DST_VID&#34;</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">GetVertices</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__GetVertices_3&#34;</span><span class="w">      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Project_2</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="mi">9223372036854775807</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="k">COLUMN</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">props</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">66</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;uuid&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;geo&#34;</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">59</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;birthday&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;email&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;phone_num&#34;</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">61</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">62</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;EDGE&#34;</span><span class="p">,</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;JOIN_DST_VID&#34;</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_2&#34;</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__GetNeighbors_1</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;EDGE AS EDGE&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;*._dst AS JOIN_DST_VID&#34;</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">GetNeighbors</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__GetNeighbors_1&#34;</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_0</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="k">COLUMN</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="n">OUT_EDGE</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;end_year&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;start_year&#34;</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">52</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">53</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">67</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">68</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">69</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">70</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">71</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;end_year&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;start_year&#34;</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">52</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">67</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">69</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">71</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">        </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_0&#34;</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">15</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="w"> </span><span class="n">CST</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="更优的-go-表达" class="headerLink">
    <a href="#%e6%9b%b4%e4%bc%98%e7%9a%84-go-%e8%a1%a8%e8%be%be" class="header-mark"></a>4.4.3 更优的 GO 表达</h4><p>下面，我们看看还有没有优化的余地，这里，我们用到了 <code>$$</code> 的引用属性，它是一个很好的语义表达，方便我们取得探索的对端（无论哪种方向）的点的信息，注意，正是因为 <code>$$</code> 可以潜在用来取得点的属性（比如 <code>$$.player.age</code>），所以优化规则里，我们对 <code>$$</code> 的函数 <code>id()</code> 中引入了 GetVertices 的算子，所以，在没有优化计划让这个表达做更优化的执行计划之前，我们可以按照”减少模糊，增加确定“的思路，把这里的潜在涉及取点属性的表达绕过。</p>
<blockquote>
<p>了解更多 nGQL 中的引用属性，见文档：https://docs.nebula-graph.com.cn/3.2.0/3.ngql-guide/4.variable-and-composite-queries/3.property-reference/</p>
</blockquote>
<p>从前边提到的架构设计文章里我们知道，一个边中已经存储了起点终点的 ID 的信息，当我们只关心边是否存在，不关心对端顶点属性的时候，这个查询可以只扫边就可以了。</p>
<blockquote>
<p>参考边在 RocksDB 中的数据结构，https://nebula-graph.com.cn/posts/nebula-graph-storage-engine-overview</p>
</blockquote>
<p><a class="lightgallery" href="https://www-cdn.nebula-graph.com.cn/nebula-blog/Architecture0105.png" title="image" data-thumbnail="https://www-cdn.nebula-graph.com.cn/nebula-blog/Architecture0105.png">
        
    </a></p>
<p>所以，绕开 <code>id($$)</code> 这个表达的另一个方法就是用 <code>edge</code>，这里双向探索的情况下，等价的表达是 <code>dst(edge) == &quot;player101&quot; OR src(edge) == &quot;player101&quot;</code>，所以，这句查询可以改写成：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"><span class="gd">- GO FROM &#34;player100&#34; over * BIDIRECT WHERE id($$) == &#34;player101&#34; YIELD edge as e
</span></span></span><span class="line"><span class="cl"><span class="gd"></span><span class="gi">+ GO FROM &#34;player100&#34; over * BIDIRECT WHERE dst(edge) == &#34;player101&#34; OR src(edge) == &#34;player101&#34; YIELD edge AS e
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>我们看看优化之后的查询计划：<code>GetNeighbors-&gt;Filter-&gt;Project</code>，显然，它是最优的了！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">explain</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">BIDIRECT</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">dst</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;player101&#34;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">src</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;player101&#34;</span><span class="w"> </span><span class="n">YIELD</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">1060</span><span class="o">/</span><span class="mi">6717</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">402</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+--------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+--------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;e&#34;</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_3&#34;</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Filter_2</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;EDGE AS e&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+--------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Filter</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Filter_2&#34;</span><span class="w">                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__GetNeighbors_1</span><span class="w">                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">condition</span><span class="p">:</span><span class="w"> </span><span class="p">((</span><span class="n">dst</span><span class="p">(</span><span class="n">EDGE</span><span class="p">)</span><span class="o">==</span><span class="s2">&#34;player101&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">(</span><span class="n">EDGE</span><span class="p">)</span><span class="o">==</span><span class="s2">&#34;player101&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">isStable</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+--------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">GetNeighbors</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="w">            </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__GetNeighbors_1&#34;</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__VAR_0</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="k">COLUMN</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeDirection</span><span class="p">:</span><span class="w"> </span><span class="n">OUT_EDGE</span><span class="w">                                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">vertexProps</span><span class="p">:</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">edgeProps</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;end_year&#34;</span><span class="p">,</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;start_year&#34;</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">52</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">53</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">67</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">68</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">69</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">70</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">71</span><span class="w">                                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;end_year&#34;</span><span class="p">,</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;start_year&#34;</span><span class="w">                                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">52</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;degree&#34;</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">67</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;time&#34;</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">69</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_dst&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_rank&#34;</span><span class="p">,</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_src&#34;</span><span class="p">,</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_type&#34;</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">71</span><span class="w">                                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                                                               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">statProps</span><span class="p">:</span><span class="w">                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                                                            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">random</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+--------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">        </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">                                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_0&#34;</span><span class="w">                                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+--------------+--------------+----------------+--------------------------------------------------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="索引的命中" class="headerLink">
    <a href="#%e7%b4%a2%e5%bc%95%e7%9a%84%e5%91%bd%e4%b8%ad" class="header-mark"></a>4.5 索引的命中</h3><p>在本篇结束之前，我还想再给一个索引查询的例子，首先，假设环境里只存在 player() 和 player.name 上的索引，没有 player.age 上的索引。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">TAG</span><span class="w"> </span><span class="n">INDEXES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------+----------+----------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="k">Index</span><span class="w"> </span><span class="n">Name</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="k">By</span><span class="w"> </span><span class="n">Tag</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">Columns</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------+----------+----------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;player_index_0&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;player&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[]</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;player_index_1&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;player&#34;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">]</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------+----------+----------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Got</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">2440</span><span class="o">/</span><span class="mi">19653</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>再次强调一下，在 NebulaGraph 中，只有无 ID 条件的起点才涉及索引，而这类起点查询其实是一个典型的非图库查询。相反，点的拓展是无关 NebulaGraph 索引的。</p>
<p>这里的例子也是只涉及起点查询，类似于 <code>SELECT * FROM player WHERE ...</code> 的表达，这三个查询</p>
<ol>
<li>
<p><code> MATCH (n:player) WHERE n.player.age &gt; 50 RETURN n</code></p>
</li>
<li>
<p><code>MATCH (n:player) WHERE n.player.name &gt; &quot;T&quot; RETURN n</code></p>
</li>
<li>
<p><code>MATCH (n:team) WHERE n.team.name &gt; &quot;T&quot; RETURN n</code></p>
</li>
</ol>
<p>之中只有 1.，2. 是允许的查询，3. 因为查询涉及数据全扫描而被 NebulaGraph 禁止，因为不存在 team 之中的索引，这样的全扫描是很昂贵的：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">:</span><span class="n">team</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">team</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s2">&#34;T&#34;</span><span class="w"> </span><span class="k">RETURN</span><span class="w"> </span><span class="n">n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">[</span><span class="n">ERROR</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1005</span><span class="p">)]:</span><span class="w"> </span><span class="n">IndexNotFound</span><span class="p">:</span><span class="w"> </span><span class="k">No</span><span class="w"> </span><span class="k">valid</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="k">found</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>而 1. 与 2. 的情况又有不同，1. 中的过滤条件 <code>n.player.age &gt; 50</code> 涉及未被索引的字段，这个过滤是无法被下推到 IndexScan 算子的，这意味着所有的 player 都会被扫描到 GraphD 中，然后再进一步进行 Filter 算子的过滤计算。</p>
<blockquote>
<p>索引设计的文章参考：https://nebula-graph.com.cn/posts/how-indexing-works-in-nebula-graph，如下是文中介绍的点索引在 RocksDB 中的数据结构。</p>
<p><a class="lightgallery" href="https://www-cdn.nebula-graph.com.cn/nebula-blog/Index04.png" title="vertex-index-format" data-thumbnail="https://www-cdn.nebula-graph.com.cn/nebula-blog/Index04.png">
        
    </a></p>
</blockquote>
<p>通过两个查询的 profile 分析，我们可以很清楚地看到：</p>
<ul>
<li>IndexScan 在 1. 查询中没有 columnHints 信息，扫描的行数为 rows: 52（这是所有的 player 顶点数量）</li>
<li>IndexScan 在 2. 查询中有 columnHints 信息，扫描的行数只有 rows: 6</li>
</ul>
<p>所以，我们在真的需要这种从属性反查图探索起点的时候，要根据实际查询需求去斟酌索引的创建。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">:</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="k">RETURN</span><span class="w"> </span><span class="n">n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">---+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">+</span><span class="c1">---+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Empty</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">8468</span><span class="o">/</span><span class="mi">25278</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">442</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w">                                                                                                                                                         </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="n">us</span><span class="w">                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_6&#34;</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Filter_5</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;$n&#34;</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Filter</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="mi">9</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">74</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">75</span><span class="n">us</span><span class="w">                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Filter_5&#34;</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Project_4</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">condition</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">age</span><span class="o">&gt;</span><span class="mi">50</span><span class="p">)</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">isStable</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">AppendVertices</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">7</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="err">{</span><span class="w">                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">841</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">4481</span><span class="n">us</span><span class="w">                                                                                                                   </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">total_rpc</span><span class="p">:</span><span class="w"> </span><span class="mi">4018</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                                                    </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged1&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">1591</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">2868</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                         </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged0&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">1532</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">2672</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                         </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged2&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">2510</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">3733</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                         </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_4&#34;</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__IndexScan_1</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">_tag</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="n">_vid</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">props</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">59</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;geo&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;email&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;phone_num&#34;</span><span class="p">,</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;birthday&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">61</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">62</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;uuid&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">66</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">vertex_filter</span><span class="p">:</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">if_track_previous_path</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IndexScan</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="err">{</span><span class="w">                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">2475</span><span class="n">us</span><span class="w">                                                                                                                     </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged2&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">640</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1968</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                          </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged1&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">709</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">2040</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                          </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged0&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">599</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">2075</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                          </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">storage_detail</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="n">IndexLimitNode</span><span class="p">(</span><span class="k">limit</span><span class="o">=</span><span class="mi">9223372036854775807</span><span class="p">):</span><span class="mi">318</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="n">IndexProjectionNode</span><span class="p">(</span><span class="n">projectColumn</span><span class="o">=</span><span class="p">[</span><span class="n">_vid</span><span class="p">]):</span><span class="mi">317</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="n">IndexVertexScanNode</span><span class="p">(</span><span class="n">IndexID</span><span class="o">=</span><span class="mi">54</span><span class="p">,</span><span class="w"> </span><span class="n">Path</span><span class="o">=</span><span class="p">()):</span><span class="mi">320</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="err">}</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__IndexScan_1&#34;</span><span class="w">        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="mi">9223372036854775807</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">schemaId</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">isEdge</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">returnCols</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;_vid&#34;</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">indexCtx</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;columnHints&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;filter&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;index_id&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">54</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">          </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span><span class="n">us</span><span class="w">                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_2&#34;</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                        </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">15</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">31</span><span class="w"> </span><span class="n">CST</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">root</span><span class="o">@</span><span class="n">nebula</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">basketballplayer</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">:</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s2">&#34;T&#34;</span><span class="w"> </span><span class="k">RETURN</span><span class="w"> </span><span class="n">n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">n</span><span class="w">                                                                                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;player127&#34;</span><span class="w"> </span><span class="p">:</span><span class="n">player</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Vince Carter&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">                                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;player109&#34;</span><span class="w"> </span><span class="p">:</span><span class="n">player</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">34</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Tiago Splitter&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">                                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;player100&#34;</span><span class="w"> </span><span class="p">:</span><span class="n">actor</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Tim Duncan X&#34;</span><span class="err">}</span><span class="w"> </span><span class="p">:</span><span class="n">player</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Tim Duncan&#34;</span><span class="err">}</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;player101&#34;</span><span class="w"> </span><span class="p">:</span><span class="n">player</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Tony Parker&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">                                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;player133&#34;</span><span class="w"> </span><span class="p">:</span><span class="n">player</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">38</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Yao Ming&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">                                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;player114&#34;</span><span class="w"> </span><span class="p">:</span><span class="n">player</span><span class="err">{</span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="mi">39</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Tracy McGrady&#34;</span><span class="err">}</span><span class="p">)</span><span class="w">                                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Got</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="mi">5438</span><span class="o">/</span><span class="mi">13004</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Execution</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="p">(</span><span class="n">optimize</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">333</span><span class="w"> </span><span class="n">us</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">profiling</span><span class="w"> </span><span class="k">data</span><span class="w">                                                                                                                                                                       </span><span class="o">|</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">info</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Project</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">24</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">26</span><span class="n">us</span><span class="w">                                                                                                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_6&#34;</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Filter_5</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">columns</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;$n&#34;</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Filter</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="mi">9</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="n">us</span><span class="w">                                                                                                                                     </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Filter_5&#34;</span><span class="w">           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__Project_4</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">condition</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">player</span><span class="p">.</span><span class="n">name</span><span class="o">&gt;</span><span class="s2">&#34;T&#34;</span><span class="p">)</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">isStable</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">AppendVertices</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">7</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="err">{</span><span class="w">                                                                                                                                                                                    </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">488</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">2146</span><span class="n">us</span><span class="w">                                                                                                                                  </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged1&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">395</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1461</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;n&#34;</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged0&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">375</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1291</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged2&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">607</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1615</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">total_rpc</span><span class="p">:</span><span class="w"> </span><span class="mi">1860</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                                                                  </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Project_4&#34;</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                                                                                                                                    </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w"> </span><span class="n">__IndexScan_1</span><span class="w">          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">_tag</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">src</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="n">_vid</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">props</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">59</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;geo&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;age&#34;</span><span class="p">,</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;email&#34;</span><span class="p">,</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;phone_num&#34;</span><span class="p">,</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;birthday&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">61</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;address&#34;</span><span class="p">,</span><span class="w">                 </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">62</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;uuid&#34;</span><span class="p">,</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="p">,</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;props&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="s2">&#34;_tag&#34;</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;tagId&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">66</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">vertex_filter</span><span class="p">:</span><span class="w">                   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">if_track_previous_path</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IndexScan</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="err">{</span><span class="w">                                                                                                                                                                                    </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">1966</span><span class="n">us</span><span class="w">                                                                                                                                    </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged2&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">431</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1564</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                                        </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;_vid&#34;</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged1&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">443</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1561</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="p">],</span><span class="w">                             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="s2">&#34;storaged0&#34;</span><span class="p">:</span><span class="mi">9779</span><span class="w"> </span><span class="k">exec</span><span class="o">/</span><span class="n">total</span><span class="p">:</span><span class="w"> </span><span class="mi">413</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">/</span><span class="mi">1696</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="w">                                                                                                                                        </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">storage_detail</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="n">IndexLimitNode</span><span class="p">(</span><span class="k">limit</span><span class="o">=</span><span class="mi">9223372036854775807</span><span class="p">):</span><span class="mi">269</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="n">IndexProjectionNode</span><span class="p">(</span><span class="n">projectColumn</span><span class="o">=</span><span class="p">[</span><span class="n">_vid</span><span class="p">]):</span><span class="mi">269</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="n">IndexVertexScanNode</span><span class="p">(</span><span class="n">IndexID</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span><span class="w"> </span><span class="n">Path</span><span class="o">=</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;T&#34;</span><span class="p">,</span><span class="n">INF</span><span class="p">])):</span><span class="mi">272</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="err">}</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__IndexScan_1&#34;</span><span class="w">        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                                                                                                                                                                    </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">inputVar</span><span class="p">:</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="k">space</span><span class="p">:</span><span class="w"> </span><span class="mi">49</span><span class="w">                        </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">dedup</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="k">limit</span><span class="p">:</span><span class="w"> </span><span class="mi">9223372036854775807</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">filter</span><span class="p">:</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">orderBy</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">schemaId</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">isEdge</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">returnCols</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;_vid&#34;</span><span class="w">                         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">indexCtx</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">{</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;columnHints&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="err">{</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">         </span><span class="s2">&#34;includeEnd&#34;</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="p">,</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">         </span><span class="s2">&#34;includeBegin&#34;</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="p">,</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">         </span><span class="s2">&#34;endValue&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__EMPTY__&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">         </span><span class="s2">&#34;beginValue&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;T&#34;</span><span class="p">,</span><span class="w">       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">         </span><span class="s2">&#34;scanType&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;RANGE&#34;</span><span class="p">,</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">         </span><span class="s2">&#34;column&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w">         </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">       </span><span class="err">}</span><span class="w">                          </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="p">],</span><span class="w">                           </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;filter&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">     </span><span class="s2">&#34;index_id&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">55</span><span class="w">               </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="err">}</span><span class="w">                              </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="p">]</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Start</span><span class="w">          </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">ver</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">rows</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">execTime</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">totalTime</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span><span class="n">us</span><span class="w">                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="n">outputVar</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;colNames&#34;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;type&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DATASET&#34;</span><span class="p">,</span><span class="w">             </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w">   </span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;__Start_2&#34;</span><span class="w">            </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                                                                                                                                                                                      </span><span class="o">|</span><span class="w"> </span><span class="err">}</span><span class="w">                                </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----+----------------+--------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="小结" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93" class="header-mark"></a>5 小结</h2><p>在理解了 NebulaGraph 的基本架构设计、存储格式、查询的简单调用流程和常见的优化规则之后，结合 PROFILE/EXPLAIN，我们可以一点点去设计更适合不同场景的图建模与图查询。</p>
<p>优化原则：减少模糊，增加确定，越早越好。</p>
<p>欢迎大家在本文的评论区讨论、提供更多优化查询的例子。</p>
<blockquote>
<p>Feature image generated with OpenAI Dall-E, with the keyword &ldquo;make potions for the nebula magic&rdquo; and Outpainting.</p>
<p>Raw <a href="/ngql-execution-plan/DALL%C2%B7E-make-potions-for-the-nebula-magic.png" rel="">image</a></p>
</blockquote>]]></description>
</item></channel>
</rss>
